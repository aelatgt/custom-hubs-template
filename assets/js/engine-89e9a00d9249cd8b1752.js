(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{1019:function(e,t,n){var r=n(1020),i=!1;function a(e,t,n,a){if(t=t||[],!e||function(e,t,n){if(e.itemSize!==n)return!0;if(!e.array)return!0;var r=e.array.length;return Array.isArray(t)&&Array.isArray(t[0])?r!==t.length*n:r!==t.length}(e,t,n)){t=r(t,a);var o=e&&"function"!=typeof e.setArray;return e&&!o||(o&&!i&&(i=!0,console.warn(["A WebGL buffer is being updated with a new size or itemSize, ","however this version of ThreeJS only supports fixed-size buffers.","\nThe old buffer may still be kept in memory.\n","To avoid memory leaks, it is recommended that you dispose ","your geometries and create new ones, or update to ThreeJS r82 or newer.\n","See here for discussion:\n","https://github.com/mrdoob/three.js/pull/9631"].join(""))),e=new THREE.BufferAttribute(t,n)),e.itemSize=n,e.needsUpdate=!0,"function"==typeof e.setArray&&e.setArray(t),e}return r(t,e.array),e.needsUpdate=!0,null}e.exports.attr=function(e,t,n,r,i){"number"!=typeof r&&(r=3);"string"!=typeof i&&(i="float32");if(Array.isArray(n)&&Array.isArray(n[0])&&n[0].length!==r)throw new Error("Nested vertex array has unexpected size; expected "+r+" but found "+n[0].length);var o=a(e.getAttribute(t),n,r,i);o&&e.addAttribute(t,o)},e.exports.index=function(e,t,n,r){"number"!=typeof n&&(n=1);"string"!=typeof r&&(r="uint16");var i=!e.index&&"function"!=typeof e.setIndex,o=a(i?e.getAttribute("index"):e.index,t,n,r);o&&(i?e.addAttribute("index",o):e.index=o)}},1021:function(e,t){e.exports.pages=function(e){var t=new Float32Array(4*e.length*1),n=0;return e.forEach((function(e){var r=e.data.page||0;t[n++]=r,t[n++]=r,t[n++]=r,t[n++]=r})),t},e.exports.uvs=function(e,t,n,r){var i=new Float32Array(4*e.length*2),a=0;return e.forEach((function(e){var o=e.data,s=o.x+o.width,c=o.y+o.height,l=o.x/t,u=o.y/n,h=s/t,d=c/n;r&&(u=(n-o.y)/n,d=(n-c)/n),i[a++]=l,i[a++]=u,i[a++]=l,i[a++]=d,i[a++]=h,i[a++]=d,i[a++]=h,i[a++]=u})),i},e.exports.positions=function(e){var t=new Float32Array(4*e.length*2),n=0;return e.forEach((function(e){var r=e.data,i=e.position[0]+r.xoffset,a=e.position[1]+r.yoffset,o=r.width,s=r.height;t[n++]=i,t[n++]=a,t[n++]=i,t[n++]=a+s,t[n++]=i+o,t[n++]=a+s,t[n++]=i+o,t[n++]=a})),t}},1022:function(e,t){var n={min:[0,0],max:[0,0]};function r(e){var t=e.length/2;n.min[0]=e[0],n.min[1]=e[1],n.max[0]=e[0],n.max[1]=e[1];for(var r=0;r<t;r++){var i=e[2*r+0],a=e[2*r+1];n.min[0]=Math.min(i,n.min[0]),n.min[1]=Math.min(a,n.min[1]),n.max[0]=Math.max(i,n.max[0]),n.max[1]=Math.max(a,n.max[1])}}e.exports.computeBox=function(e,t){r(e),t.min.set(n.min[0],n.min[1],0),t.max.set(n.max[0],n.max[1],0)},e.exports.computeSphere=function(e,t){r(e);var i=n.min[0],a=n.min[1],o=n.max[0]-i,s=n.max[1]-a,c=Math.sqrt(o*o+s*s);t.center.set(i+o/2,a+s/2,0),t.radius=c/2}},1027:function(e,t){THREE.OrbitControls=function(e,t){var n,r,i,a,o;this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:THREE.MOUSE.LEFT,MIDDLE:THREE.MOUSE.MIDDLE,RIGHT:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return f.phi},this.getAzimuthalAngle=function(){return f.theta},this.saveState=function(){s.target0.copy(s.target),s.position0.copy(s.object.position),s.zoom0=s.object.zoom},this.reset=function(){s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.zoom=s.zoom0,s.object.updateProjectionMatrix(),s.dispatchEvent(c),s.update(),d=h.NONE},this.update=(n=new THREE.Vector3,r=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),i=r.clone().inverse(),a=new THREE.Vector3,o=new THREE.Quaternion,function(){var e=s.object.position;return n.copy(e).sub(s.target),n.applyQuaternion(r),f.setFromVector3(n),s.autoRotate&&d===h.NONE&&C(2*Math.PI/60/60*s.autoRotateSpeed),f.theta+=m.theta,f.phi+=m.phi,f.theta=Math.max(s.minAzimuthAngle,Math.min(s.maxAzimuthAngle,f.theta)),f.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,f.phi)),f.makeSafe(),f.radius*=g,f.radius=Math.max(s.minDistance,Math.min(s.maxDistance,f.radius)),s.target.add(v),n.setFromSpherical(f),n.applyQuaternion(i),e.copy(s.target).add(n),s.object.lookAt(s.target),!0===s.enableDamping?(m.theta*=1-s.dampingFactor,m.phi*=1-s.dampingFactor,v.multiplyScalar(1-s.dampingFactor)):(m.set(0,0,0),v.set(0,0,0)),g=1,!!(y||a.distanceToSquared(s.object.position)>p||8*(1-o.dot(s.object.quaternion))>p)&&(s.dispatchEvent(c),a.copy(s.object.position),o.copy(s.object.quaternion),y=!1,!0)}),this.dispose=function(){s.domElement.removeEventListener("contextmenu",q,!1),s.domElement.removeEventListener("mousedown",N,!1),s.domElement.removeEventListener("wheel",z,!1),s.domElement.removeEventListener("touchstart",j,!1),s.domElement.removeEventListener("touchend",W,!1),s.domElement.removeEventListener("touchmove",G,!1),document.removeEventListener("mousemove",F,!1),document.removeEventListener("mouseup",U,!1),window.removeEventListener("keydown",V,!1)};var s=this,c={type:"change"},l={type:"start"},u={type:"end"},h={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY_PAN:4},d=h.NONE,p=1e-6,f=new THREE.Spherical,m=new THREE.Spherical,g=1,v=new THREE.Vector3,y=!1,b=new THREE.Vector2,x=new THREE.Vector2,w=new THREE.Vector2,E=new THREE.Vector2,M=new THREE.Vector2,A=new THREE.Vector2,T=new THREE.Vector2,_=new THREE.Vector2,S=new THREE.Vector2;function L(){return Math.pow(.95,s.zoomSpeed)}function C(e){m.theta-=e}function R(e){m.phi-=e}var P,O=(P=new THREE.Vector3,function(e,t){P.setFromMatrixColumn(t,0),P.multiplyScalar(-e),v.add(P)}),D=function(){var e=new THREE.Vector3;return function(t,n){!0===s.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(s.object.up,e)),e.multiplyScalar(t),v.add(e)}}(),I=function(){var e=new THREE.Vector3;return function(t,n){var r=s.domElement===document?s.domElement.body:s.domElement;if(s.object.isPerspectiveCamera){var i=s.object.position;e.copy(i).sub(s.target);var a=e.length();a*=Math.tan(s.object.fov/2*Math.PI/180),O(2*t*a/r.clientHeight,s.object.matrix),D(2*n*a/r.clientHeight,s.object.matrix)}else s.object.isOrthographicCamera?(O(t*(s.object.right-s.object.left)/s.object.zoom/r.clientWidth,s.object.matrix),D(n*(s.object.top-s.object.bottom)/s.object.zoom/r.clientHeight,s.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),s.enablePan=!1)}}();function B(e){s.object.isPerspectiveCamera?g/=e:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom*e)),s.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function k(e){s.object.isPerspectiveCamera?g*=e:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/e)),s.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function H(e){E.set(e.clientX,e.clientY)}function N(e){if(!1!==s.enabled){switch(e.preventDefault(),s.domElement.focus?s.domElement.focus():window.focus(),e.button){case s.mouseButtons.LEFT:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===s.enablePan)return;H(e),d=h.PAN}else{if(!1===s.enableRotate)return;!function(e){b.set(e.clientX,e.clientY)}(e),d=h.ROTATE}break;case s.mouseButtons.MIDDLE:if(!1===s.enableZoom)return;!function(e){T.set(e.clientX,e.clientY)}(e),d=h.DOLLY;break;case s.mouseButtons.RIGHT:if(!1===s.enablePan)return;H(e),d=h.PAN}d!==h.NONE&&(document.addEventListener("mousemove",F,!1),document.addEventListener("mouseup",U,!1),s.dispatchEvent(l))}}function F(e){if(!1!==s.enabled)switch(e.preventDefault(),d){case h.ROTATE:if(!1===s.enableRotate)return;!function(e){x.set(e.clientX,e.clientY),w.subVectors(x,b).multiplyScalar(s.rotateSpeed);var t=s.domElement===document?s.domElement.body:s.domElement;C(2*Math.PI*w.x/t.clientHeight),R(2*Math.PI*w.y/t.clientHeight),b.copy(x),s.update()}(e);break;case h.DOLLY:if(!1===s.enableZoom)return;!function(e){_.set(e.clientX,e.clientY),S.subVectors(_,T),S.y>0?B(L()):S.y<0&&k(L()),T.copy(_),s.update()}(e);break;case h.PAN:if(!1===s.enablePan)return;!function(e){M.set(e.clientX,e.clientY),A.subVectors(M,E).multiplyScalar(s.panSpeed),I(A.x,A.y),E.copy(M),s.update()}(e)}}function U(e){!1!==s.enabled&&(document.removeEventListener("mousemove",F,!1),document.removeEventListener("mouseup",U,!1),s.dispatchEvent(u),d=h.NONE)}function z(e){!1===s.enabled||!1===s.enableZoom||d!==h.NONE&&d!==h.ROTATE||(e.preventDefault(),e.stopPropagation(),s.dispatchEvent(l),function(e){e.deltaY<0?k(L()):e.deltaY>0&&B(L()),s.update()}(e),s.dispatchEvent(u))}function V(e){!1!==s.enabled&&!1!==s.enableKeys&&!1!==s.enablePan&&function(e){var t=!1;switch(e.keyCode){case s.keys.UP:I(0,s.keyPanSpeed),t=!0;break;case s.keys.BOTTOM:I(0,-s.keyPanSpeed),t=!0;break;case s.keys.LEFT:I(s.keyPanSpeed,0),t=!0;break;case s.keys.RIGHT:I(-s.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),s.update())}(e)}function j(e){if(!1!==s.enabled){switch(e.preventDefault(),e.touches.length){case 1:if(!1===s.enableRotate)return;!function(e){b.set(e.touches[0].pageX,e.touches[0].pageY)}(e),d=h.TOUCH_ROTATE;break;case 2:if(!1===s.enableZoom&&!1===s.enablePan)return;!function(e){if(s.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);T.set(0,r)}if(s.enablePan){var i=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);E.set(i,a)}}(e),d=h.TOUCH_DOLLY_PAN;break;default:d=h.NONE}d!==h.NONE&&s.dispatchEvent(l)}}function G(e){if(!1!==s.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===s.enableRotate)return;if(d!==h.TOUCH_ROTATE)return;!function(e){x.set(e.touches[0].pageX,e.touches[0].pageY),w.subVectors(x,b).multiplyScalar(s.rotateSpeed);var t=s.domElement===document?s.domElement.body:s.domElement;C(2*Math.PI*w.x/t.clientHeight),R(2*Math.PI*w.y/t.clientHeight),b.copy(x),s.update()}(e);break;case 2:if(!1===s.enableZoom&&!1===s.enablePan)return;if(d!==h.TOUCH_DOLLY_PAN)return;!function(e){if(s.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);_.set(0,r),S.set(0,Math.pow(_.y/T.y,s.zoomSpeed)),B(S.y),T.copy(_)}if(s.enablePan){var i=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);M.set(i,a),A.subVectors(M,E).multiplyScalar(s.panSpeed),I(A.x,A.y),E.copy(M)}s.update()}(e);break;default:d=h.NONE}}function W(e){!1!==s.enabled&&(s.dispatchEvent(u),d=h.NONE)}function q(e){!1!==s.enabled&&e.preventDefault()}s.domElement.addEventListener("contextmenu",q,!1),s.domElement.addEventListener("mousedown",N,!1),s.domElement.addEventListener("wheel",z,!1),s.domElement.addEventListener("touchstart",j,!1),s.domElement.addEventListener("touchend",W,!1),s.domElement.addEventListener("touchmove",G,!1),window.addEventListener("keydown",V,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}})},113:function(e,t,n){var r,i;n(837);var a=e.exports.knownTags={};function o(e,t,n,r){t.forEach((function(t){!function(e,t,n,r){var i=n[t],a=r[t];if(!i||!a)return;if(i===a)return;e[t]={value:function(){return a.apply(this,arguments),i.apply(this,arguments)},writable:window.debug}}(e,t,n,r)}))}function s(e,t){Object.getOwnPropertyNames(e).forEach((function(n){var r;t[n]||(r=Object.getOwnPropertyDescriptor(e,n),t[n]={value:e[n],writable:r.writable})}))}e.exports.isNode=function(e){return e.tagName.toLowerCase()in a||e.isNode},e.exports.registerElement=function(e,t){var n=Object.getPrototypeOf(t.prototype),c=t,l=r&&n===r.prototype,u=i&&n===i.prototype;return(l||u)&&function(e){a[e.toLowerCase()]=!0}(e),l&&(c=function(e){var t={};return o(t,["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"],e,r.prototype),s(e,t),t}(t.prototype),c={prototype:Object.create(n,c)}),u&&(c=function(e){var t={};return o(t,["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"],e,r.prototype),o(t,["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"],e,i.prototype),s(e,t),t}(t.prototype),c={prototype:Object.create(n,c)}),Object.getOwnPropertyNames(c.prototype).forEach((function(e){var t=c.prototype[e];"function"==typeof t&&(t.displayName=e)})),document.registerElement(e,c)},e.exports.wrapMethods=o,r=n(171),i=n(224)},114:function(e,t,n){var r=n(22).components,i=n(89).shaders,a=n(24),o={};function s(e){var t=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();"fog"===e&&(t="material-fog"),"visible"===e&&(t="material-visible"),o[t]="material."+e}Object.keys(r.material.schema).forEach(s),Object.keys(i.standard.schema).forEach(s),e.exports=function(){return{defaultComponents:{material:{}},mappings:a.extend({},o)}}},1223:function(e,t,n){"use strict";n.r(t),n.d(t,"Pathfinding",(function(){return u})),n.d(t,"PathfindingHelper",(function(){return d}));var r=function(){};r.computeCentroids=function(e){var t,n,r;for(t=0,n=e.faces.length;t<n;t++)(r=e.faces[t]).centroid=new THREE.Vector3(0,0,0),r.centroid.add(e.vertices[r.a]),r.centroid.add(e.vertices[r.b]),r.centroid.add(e.vertices[r.c]),r.centroid.divideScalar(3)},r.roundNumber=function(e,t){return Number(e.toFixed(t))},r.sample=function(e){return e[Math.floor(Math.random()*e.length)]},r.mergeVertexIds=function(e,t){var n=[];if(e.forEach((function(e){t.indexOf(e)>=0&&n.push(e)})),n.length<2)return[];n.includes(e[0])&&n.includes(e[e.length-1])&&e.push(e.shift()),n.includes(t[0])&&n.includes(t[t.length-1])&&t.push(t.shift()),n=[],e.forEach((function(e){t.includes(e)&&n.push(e)}));for(var r=n[1],i=n[0],a=e.slice();a[0]!==r;)a.push(a.shift());for(var o=0,s=t.slice();s[0]!==i;)if(s.push(s.shift()),o++>10)throw new Error("Unexpected state");return s.shift(),s.pop(),a.concat(s)},r.setPolygonCentroid=function(e,t){var n=new THREE.Vector3,r=t.vertices;e.vertexIds.forEach((function(e){n.add(r[e])})),n.divideScalar(e.vertexIds.length),e.centroid.copy(n)},r.cleanPolygon=function(e,t){for(var n=[],r=t.vertices,i=0;i<e.vertexIds.length;i++){var a,o,s,c=r[e.vertexIds[i]];0===i?(a=e.vertexIds[1],o=e.vertexIds[e.vertexIds.length-1]):i===e.vertexIds.length-1?(a=e.vertexIds[0],o=e.vertexIds[e.vertexIds.length-2]):(a=e.vertexIds[i+1],o=e.vertexIds[i-1]),s=r[o];var l=r[a].clone().sub(c),u=s.clone().sub(c),h=l.angleTo(u);if(h>Math.PI-.01&&h<Math.PI+.01){var d=[];e.neighbours.forEach((function(t){t.vertexIds.includes(e.vertexIds[i])||d.push(t)})),e.neighbours=d}else n.push(e.vertexIds[i])}e.vertexIds=n,this.setPolygonCentroid(e,t)},r.isConvex=function(e,t){var n=t.vertices;if(e.vertexIds.length<3)return!1;for(var r=!0,i=[],a=0;a<e.vertexIds.length;a++){var o,s,c=n[e.vertexIds[a]];0===a?(o=n[e.vertexIds[1]],s=n[e.vertexIds[e.vertexIds.length-1]]):a===e.vertexIds.length-1?(o=n[e.vertexIds[0]],s=n[e.vertexIds[e.vertexIds.length-2]]):(o=n[e.vertexIds[a+1]],s=n[e.vertexIds[a-1]]);var l=o.clone().sub(c),u=s.clone().sub(c),h=l.angleTo(u);if(h===Math.PI||0===h)return!1;var d=l.cross(u).y;i.push(d)}return i.forEach((function(e){0===e&&(r=!1)})),i.forEach(i[0]>0?function(e){e<0&&(r=!1)}:function(e){e>0&&(r=!1)}),r},r.distanceToSquared=function(e,t){var n=e.x-t.x,r=e.y-t.y,i=e.z-t.z;return n*n+r*r+i*i},r.isPointInPoly=function(e,t){for(var n=!1,r=-1,i=e.length,a=i-1;++r<i;a=r)(e[r].z<=t.z&&t.z<e[a].z||e[a].z<=t.z&&t.z<e[r].z)&&t.x<(e[a].x-e[r].x)*(t.z-e[r].z)/(e[a].z-e[r].z)+e[r].x&&(n=!n);return n},r.isVectorInPolygon=function(e,t,n){var r=1e5,i=-1e5,a=[];return t.vertexIds.forEach((function(e){r=Math.min(n[e].y,r),i=Math.max(n[e].y,i),a.push(n[e])})),!!(e.y<i+.5&&e.y>r-.5&&this.isPointInPoly(a,e))},r.triarea2=function(e,t,n){return(n.x-e.x)*(t.z-e.z)-(t.x-e.x)*(n.z-e.z)},r.vequal=function(e,t){return this.distanceToSquared(e,t)<1e-5};var i=function(e){this.content=[],this.scoreFunction=e};i.prototype.push=function(e){this.content.push(e),this.sinkDown(this.content.length-1)},i.prototype.pop=function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.bubbleUp(0)),e},i.prototype.remove=function(e){var t=this.content.indexOf(e),n=this.content.pop();t!==this.content.length-1&&(this.content[t]=n,this.scoreFunction(n)<this.scoreFunction(e)?this.sinkDown(t):this.bubbleUp(t))},i.prototype.size=function(){return this.content.length},i.prototype.rescoreElement=function(e){this.sinkDown(this.content.indexOf(e))},i.prototype.sinkDown=function(e){for(var t=this.content[e];e>0;){var n=(e+1>>1)-1,r=this.content[n];if(!(this.scoreFunction(t)<this.scoreFunction(r)))break;this.content[n]=t,this.content[e]=r,e=n}},i.prototype.bubbleUp=function(e){for(var t=this.content.length,n=this.content[e],r=this.scoreFunction(n);;){var i=e+1<<1,a=i-1,o=null,s=void 0;if(a<t&&(s=this.scoreFunction(this.content[a]))<r&&(o=a),i<t&&this.scoreFunction(this.content[i])<(null===o?r:s)&&(o=i),null===o)break;this.content[e]=this.content[o],this.content[o]=n,e=o}};var a=function(){};a.init=function(e){for(var t=0;t<e.length;t++){var n=e[t];n.f=0,n.g=0,n.h=0,n.cost=1,n.visited=!1,n.closed=!1,n.parent=null}},a.cleanUp=function(e){for(var t=0;t<e.length;t++){var n=e[t];delete n.f,delete n.g,delete n.h,delete n.cost,delete n.visited,delete n.closed,delete n.parent}},a.heap=function(){return new i((function(e){return e.f}))},a.search=function(e,t,n){this.init(e);var r=this.heap();for(r.push(t);r.size()>0;){var i=r.pop();if(i===n){for(var a=i,o=[];a.parent;)o.push(a),a=a.parent;return this.cleanUp(o),o.reverse()}i.closed=!0;for(var s=this.neighbours(e,i),c=0,l=s.length;c<l;c++){var u=s[c];if(!u.closed){var h=i.g+u.cost,d=u.visited;if(!d||h<u.g){if(u.visited=!0,u.parent=i,!u.centroid||!n.centroid)throw new Error("Unexpected state");u.h=u.h||this.heuristic(u.centroid,n.centroid),u.g=h,u.f=u.g+u.h,d?r.rescoreElement(u):r.push(u)}}}}return[]},a.heuristic=function(e,t){return r.distanceToSquared(e,t)},a.neighbours=function(e,t){for(var n=[],r=0;r<t.neighbours.length;r++)n.push(e[t.neighbours[r]]);return n};var o=1,s=function(){};s.buildZone=function(e){var t=this,n=this._buildNavigationMesh(e),r={};r.vertices=n.vertices;var i=this._buildPolygonGroups(n);return r.groups=new Array(i.length),i.forEach((function(e,n){var i={};e.forEach((function(e,t){i[e.id]=t}));var a=new Array(e.length);e.forEach((function(e,n){var r=[];e.neighbours.forEach((function(e){return r.push(i[e.id])}));var o=[];e.neighbours.forEach((function(n){return o.push(t._getSharedVerticesInOrder(e,n))})),a[n]={id:n,neighbours:r,vertexIds:e.vertexIds,centroid:e.centroid,portals:o}})),r.groups[n]=a})),r},s._buildNavigationMesh=function(e){return r.computeCentroids(e),e.mergeVertices(),this._buildPolygonsFromGeometry(e)},s._buildPolygonGroups=function(e){var t=[],n=function(e){e.neighbours.forEach((function(t){void 0===t.group&&(t.group=e.group,n(t))}))};return e.polygons.forEach((function(e){void 0!==e.group?t[e.group].push(e):(e.group=t.length,n(e),t.push([e]))})),t},s._buildPolygonNeighbours=function(e,t){var n=new Set,r=t[e.vertexIds[1]],i=t[e.vertexIds[2]];return t[e.vertexIds[0]].forEach((function(t){t!==e&&(r.includes(t)||i.includes(t))&&n.add(t)})),r.forEach((function(t){t!==e&&i.includes(t)&&n.add(t)})),n},s._buildPolygonsFromGeometry=function(e){for(var t=this,n=[],r=e.vertices,i=e.faceVertexUvs,a=new Array(r.length),s=0;s<r.length;s++)a[s]=[];return e.faces.forEach((function(e){var t={id:o++,vertexIds:[e.a,e.b,e.c],centroid:e.centroid,normal:e.normal,neighbours:null};n.push(t),a[e.a].push(t),a[e.b].push(t),a[e.c].push(t)})),n.forEach((function(e){e.neighbours=t._buildPolygonNeighbours(e,a)})),{polygons:n,vertices:r,faceVertexUvs:i}},s._getSharedVerticesInOrder=function(e,t){var n=e.vertexIds,r=t.vertexIds,i=new Set;if(n.forEach((function(e){r.includes(e)&&i.add(e)})),i.size<2)return[];i.has(n[0])&&i.has(n[n.length-1])&&n.push(n.shift()),i.has(r[0])&&i.has(r[r.length-1])&&r.push(r.shift());var a=[];return n.forEach((function(e){r.includes(e)&&a.push(e)})),a};var c=function(){this.portals=[]};c.prototype.push=function(e,t){void 0===t&&(t=e),this.portals.push({left:e,right:t})},c.prototype.stringPull=function(){var e,t,n,i=this.portals,a=[],o=0,s=0,c=0;t=i[0].left,n=i[0].right,a.push(e=i[0].left);for(var l=1;l<i.length;l++){var u=i[l].left,h=i[l].right;if(r.triarea2(e,n,h)<=0){if(!(r.vequal(e,n)||r.triarea2(e,t,h)>0)){a.push(t),t=e=t,n=e,s=o=s,c=o,l=o;continue}n=h,c=l}if(r.triarea2(e,t,u)>=0){if(!(r.vequal(e,t)||r.triarea2(e,n,u)<0)){a.push(n),t=e=n,n=e,s=o=c,c=o,l=o;continue}t=u,s=l}}return 0!==a.length&&r.vequal(a[a.length-1],i[i.length-1].left)||a.push(i[i.length-1].left),this.path=a,a};var l,u=function(){this.zones={}};u.createZone=function(e){return e.isGeometry?console.warn("[three-pathfinding]: Use THREE.BufferGeometry, not THREE.Geometry, to create zone."):e=(new THREE.Geometry).fromBufferGeometry(e),s.buildZone(e)},u.prototype.setZoneData=function(e,t){this.zones[e]=t},u.prototype.getRandomNode=function(e,t,n,i){if(!this.zones[e])return new THREE.Vector3;n=n||null,i=i||0;var a=[];return this.zones[e].groups[t].forEach((function(e){n&&i?r.distanceToSquared(n,e.centroid)<i*i&&a.push(e.centroid):a.push(e.centroid)})),r.sample(a)||new THREE.Vector3},u.prototype.getClosestNode=function(e,t,n,i){void 0===i&&(i=!1);var a=this.zones[t].vertices,o=null,s=1/0;return this.zones[t].groups[n].forEach((function(t){var n=r.distanceToSquared(t.centroid,e);n<s&&(!i||r.isVectorInPolygon(e,t,a))&&(o=t,s=n)})),o},u.prototype.findPath=function(e,t,n,r){var i=this.zones[n].groups[r],o=this.zones[n].vertices,s=this.getClosestNode(e,n,r,!0),l=this.getClosestNode(t,n,r,!0);if(!s||!l)return null;var u=a.search(i,s,l),h=function(e,t){for(var n=0;n<e.neighbours.length;n++)if(e.neighbours[n]===t.id)return e.portals[n]},d=new c;d.push(e);for(var p=0;p<u.length;p++){var f=u[p+1];if(f){var m=h(u[p],f);d.push(o[m[0]],o[m[1]])}}d.push(t),d.stringPull();var g=d.path.map((function(e){return new THREE.Vector3(e.x,e.y,e.z)}));return g.shift(),g},u.prototype.getGroup=(l=new THREE.Plane,function(e,t,n){if(void 0===n&&(n=!1),!this.zones[e])return null;for(var i=null,a=Math.pow(50,2),o=this.zones[e],s=0;s<o.groups.length;s++)for(var c=0,u=o.groups[s];c<u.length;c+=1){var h=u[c];if(n&&(l.setFromCoplanarPoints(o.vertices[h.vertexIds[0]],o.vertices[h.vertexIds[1]],o.vertices[h.vertexIds[2]]),Math.abs(l.distanceToPoint(t))<.01&&r.isPointInPoly([o.vertices[h.vertexIds[0]],o.vertices[h.vertexIds[1]],o.vertices[h.vertexIds[2]]],t)))return s;var d=r.distanceToSquared(h.centroid,t);d<a&&(i=s,a=d)}return i}),u.prototype.clampStep=function(){var e,t,n=new THREE.Vector3,r=new THREE.Plane,i=new THREE.Triangle,a=new THREE.Vector3,o=new THREE.Vector3;return function(s,c,l,u,h,d){var p=this.zones[u].vertices,f=this.zones[u].groups[h],m=[l],g={};g[l.id]=0,e=void 0,o.set(0,0,0),t=1/0,r.setFromCoplanarPoints(p[l.vertexIds[0]],p[l.vertexIds[1]],p[l.vertexIds[2]]),r.projectPoint(c,n),a.copy(n);for(var v=m.pop();v;v=m.pop()){i.set(p[v.vertexIds[0]],p[v.vertexIds[1]],p[v.vertexIds[2]]),i.closestPointToPoint(a,n),n.distanceToSquared(a)<t&&(e=v,o.copy(n),t=n.distanceToSquared(a));var y=g[v];if(!(y>2))for(var b=0;b<v.neighbours.length;b++){var x=f[v.neighbours[b]];x.id in g||(m.push(x),g[x.id]=y+1)}}return d.copy(o),e}}();var h={PLAYER:new THREE.Color(15631215).convertGammaToLinear(2.2).getHex(),TARGET:new THREE.Color(14469912).convertGammaToLinear(2.2).getHex(),PATH:new THREE.Color(41903).convertGammaToLinear(2.2).getHex(),WAYPOINT:new THREE.Color(41903).convertGammaToLinear(2.2).getHex(),CLAMPED_STEP:new THREE.Color(14472114).convertGammaToLinear(2.2).getHex(),CLOSEST_NODE:new THREE.Color(4417387).convertGammaToLinear(2.2).getHex()},d=function(e){function t(){var t=this;e.call(this),this._playerMarker=new THREE.Mesh(new THREE.SphereGeometry(.25,32,32),new THREE.MeshBasicMaterial({color:h.PLAYER})),this._targetMarker=new THREE.Mesh(new THREE.BoxGeometry(.3,.3,.3),new THREE.MeshBasicMaterial({color:h.TARGET})),this._nodeMarker=new THREE.Mesh(new THREE.BoxGeometry(.1,.8,.1),new THREE.MeshBasicMaterial({color:h.CLOSEST_NODE})),this._stepMarker=new THREE.Mesh(new THREE.BoxGeometry(.1,1,.1),new THREE.MeshBasicMaterial({color:h.CLAMPED_STEP})),this._pathMarker=new THREE.Object3D,this._pathLineMaterial=new THREE.LineBasicMaterial({color:h.PATH,linewidth:2}),this._pathPointMaterial=new THREE.MeshBasicMaterial({color:h.WAYPOINT}),this._pathPointGeometry=new THREE.SphereBufferGeometry(.08),this._markers=[this._playerMarker,this._targetMarker,this._nodeMarker,this._stepMarker,this._pathMarker],this._markers.forEach((function(e){e.visible=!1,t.add(e)}))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.setPath=function(e){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);e=[this._playerMarker.position].concat(e);for(var t=new THREE.Geometry,n=0;n<e.length;n++)t.vertices.push(e[n].clone().add(new THREE.Vector3(0,.2,0)));this._pathMarker.add(new THREE.Line(t,this._pathLineMaterial));for(var r=0;r<e.length-1;r++){var i=new THREE.Mesh(this._pathPointGeometry,this._pathPointMaterial);i.position.copy(e[r]),i.position.y+=.2,this._pathMarker.add(i)}return this._pathMarker.visible=!0,this},t.prototype.setPlayerPosition=function(e){return this._playerMarker.position.copy(e),this._playerMarker.visible=!0,this},t.prototype.setTargetPosition=function(e){return this._targetMarker.position.copy(e),this._targetMarker.visible=!0,this},t.prototype.setNodePosition=function(e){return this._nodeMarker.position.copy(e),this._nodeMarker.visible=!0,this},t.prototype.setStepPosition=function(e){return this._stepMarker.position.copy(e),this._stepMarker.visible=!0,this},t.prototype.reset=function(){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);return this._markers.forEach((function(e){e.visible=!1})),this},t}(THREE.Object3D)},13:function(e,t){e.exports={GRAVITY:-9.8,MAX_INTERVAL:4/60,ITERATIONS:10,ACTIVATION_STATE:{ACTIVE_TAG:"active",ISLAND_SLEEPING:"islandSleeping",WANTS_DEACTIVATION:"wantsDeactivation",DISABLE_DEACTIVATION:"disableDeactivation",DISABLE_SIMULATION:"disableSimulation"},COLLISION_FLAG:{STATIC_OBJECT:1,KINEMATIC_OBJECT:2,NO_CONTACT_RESPONSE:4,CUSTOM_MATERIAL_CALLBACK:8,CHARACTER_OBJECT:16,DISABLE_VISUALIZE_OBJECT:32,DISABLE_SPU_COLLISION_PROCESSING:64},TYPE:{STATIC:"static",DYNAMIC:"dynamic",KINEMATIC:"kinematic"},SHAPE:{BOX:"box",CYLINDER:"cylinder",SPHERE:"sphere",CAPSULE:"capsule",CONE:"cone",HULL:"hull",HACD:"hacd",VHACD:"vhacd",MESH:"mesh",HEIGHTFIELD:"heightfield"},FIT:{ALL:"all",MANUAL:"manual"},CONSTRAINT:{LOCK:"lock",FIXED:"fixed",SPRING:"spring",SLIDER:"slider",HINGE:"hinge",CONE_TWIST:"coneTwist",POINT_TO_POINT:"pointToPoint"}}},152:function(e,t,n){e.exports={AFRAME_INJECTED:"aframe-injected",DEFAULT_CAMERA_HEIGHT:1.6,DEFAULT_HANDEDNESS:"right",keyboardevent:n(826)}},159:function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return h}));n(418);var r=n(560),i=n.n(r),a=n(561),o=n.n(a),s=n(562),c=n.n(s);const l=i.a,u=o.a,h=c.a},170:function(e,t){e.exports=function(e,t){return Function.bind.apply(e,[t].concat(Array.prototype.slice.call(arguments,2)))}},171:function(e,t,n){var r,i,a,o,s=n(113).registerElement,c=n(113).isNode,l=n(24),u=l.debug("core:a-node:warn"),h=l.debug("core:a-node:error");e.exports=s("a-node",{prototype:Object.create(window.HTMLElement.prototype,{createdCallback:{value:function(){this.computedMixinStr="",this.hasLoaded=!1,this.isNode=!0,this.mixinEls=[]},writable:window.debug},attachedCallback:{value:function(){var e;this.sceneEl=this.closestScene(),this.sceneEl||u("You are attempting to attach <"+this.tagName+"> outside of an A-Frame scene. Append this element to `<a-scene>` instead."),this.hasLoaded=!1,this.emit("nodeready",void 0,!1),this.isMixin||(e=this.getAttribute("mixin"))&&this.updateMixins(e)},writable:window.debug},attributeChangedCallback:{value:function(e,t,n){n!==this.computedMixinStr&&("mixin"!==e||this.isMixin||this.updateMixins(n,t))}},closestScene:{value:function(){for(var e=this;e&&!e.isScene;)e=e.parentElement;return e}},closest:{value:function(e){for(var t=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector,n=this;n&&!t.call(n,e);)n=n.parentElement;return n}},detachedCallback:{value:function(){this.hasLoaded=!1}},load:{value:function(e,t){var n,r=this;this.hasLoaded||(t=t||c,n=this.getChildren().filter(t).map((function(e){return new Promise((function(t){if(e.hasLoaded)return t();e.addEventListener("loaded",t)}))})),Promise.all(n).then((function(){r.hasLoaded=!0,e&&e(),r.emit("loaded",void 0,!1)})).catch((function(e){h("Failure loading node: ",e)})))},writable:!0},getChildren:{value:function(){return Array.prototype.slice.call(this.children,0)}},updateMixins:{value:(i=[],a=[],o={},function(e,t){var n,r,s;for(i.length=0,a.length=0,r=e?l.split(e.trim(),/\s+/):i,s=t?l.split(t.trim(),/\s+/):a,o.newMixinIds=r,o.oldMixinIds=s,n=0;n<s.length;n++)-1===r.indexOf(s[n])&&this.unregisterMixin(s[n]);for(this.computedMixinStr="",this.mixinEls.length=0,n=0;n<r.length;n++)this.registerMixin(document.getElementById(r[n]));return this.computedMixinStr&&(this.computedMixinStr=this.computedMixinStr.trim(),window.HTMLElement.prototype.setAttribute.call(this,"mixin",this.computedMixinStr)),o})},registerMixin:{value:function(e){var t,n,r;if(e){if(r=e.getAttribute("mixin"))for(t=l.split(r.trim(),/\s+/),n=0;n<t.length;n++)this.registerMixin(document.getElementById(t[n]));this.computedMixinStr=this.computedMixinStr+" "+e.id,this.mixinEls.push(e)}}},setAttribute:{value:function(e,t){"mixin"===e&&this.updateMixins(t),window.HTMLElement.prototype.setAttribute.call(this,e,t)}},unregisterMixin:{value:function(e){var t,n=this.mixinEls;for(t=0;t<n.length;++t)if(e===n[t].id){n.splice(t,1);break}}},emit:{value:(r={},function(e,t,n,i){void 0===n&&(n=!0),r.bubbles=!!n,r.detail=t,i&&(r=l.extend({},i,r)),this.dispatchEvent(new CustomEvent(e,r))}),writable:window.debug}})})},19:function(e,t,n){(function(t){var r=t.THREE=n(5);r.TextureLoader&&(r.TextureLoader.prototype.crossOrigin="anonymous"),r.ImageLoader&&(r.ImageLoader.prototype.crossOrigin="anonymous"),r.Cache&&(r.Cache.enabled=!0),n(820),n(286),n(821),n(822),r.DRACOLoader.prototype.crossOrigin="anonymous",r.GLTFLoader.prototype.crossOrigin="anonymous",r.MTLLoader.prototype.crossOrigin="anonymous",r.OBJLoader.prototype.crossOrigin="anonymous",e.exports=r}).call(this,n(44))},195:function(e,t,n){var r,i=n(24),a=n(838),o=i.debug,s=a.isValidDefaultValue,c=a.propertyTypes,l=o("core:schema:warn");function u(e){return"type"in e?"string"==typeof e.type:"default"in e}function h(e,t){var n,r,i=e.default,a=e.type;return e.type?"bool"===e.type?a="boolean":"float"===e.type&&(a="number"):a=void 0===i||"boolean"!=typeof i&&"number"!=typeof i?Array.isArray(i)?"array":"string":typeof i,(r=c[a])||l("Unknown property type for component `"+t+"`: "+a),n=!!e.parse,e.parse=e.parse||r.parse,e.stringify=e.stringify||r.stringify,e.type=a,"default"in e?n||s(a,i)||l("Default value `"+i+"` does not match type `"+a+"` in component `"+t+"`"):e.default=r.default,e}function d(e,t){return null!=e&&""!==e||(e=t.default,Array.isArray(e)&&(e=e.slice())),t.parse(e,t.default)}function p(e,t){return"object"!=typeof e?e:t&&null!==e?t.stringify(e):JSON.stringify(e)}e.exports.isSingleProperty=u,e.exports.process=function(e,t){var n;if(u(e))return h(e,t);for(n in e)e[n]=h(e[n],t);return e},e.exports.processPropertyDefinition=h,e.exports.parseProperties=(r=[],function(e,t,n,i,a){var o,s,c,u;for(s in r.length=0,n?e:t)n&&void 0===e[s]||r.push(s);if(null===e||"object"!=typeof e)return e;for(s in e)void 0===e[s]||t[s]||a||l("Unknown property `"+s+"` for component/system `"+i+"`.");for(o=0;o<r.length;o++){if(c=t[s=r[o]],u=e[s],!t[s])return;e[s]=d(u,c)}return e}),e.exports.parseProperty=d,e.exports.stringifyProperties=function(e,t){var n,r,i,a,o={};for(n in e)r=t[n],"object"==typeof(a=i=e[n])&&(a=p(i,r),r||l("Unknown component property: "+n)),o[n]=a;return o},e.exports.stringifyProperty=p},22:function(e,t,n){var r=n(195),i=n(287),a=n(88),o=n(24),s=e.exports.components={},c=r.parseProperties,l=r.parseProperty,u=r.process,h=r.isSingleProperty,d=r.stringifyProperties,p=r.stringifyProperty,f=o.styleParser,m=o.debug("core:component:warn"),g=document.currentScript,v=new RegExp("[A-Z]+"),y={},b=e.exports.Component=function(e,t,n){var r=this;this.el=e,this.id=n,this.attrName=this.name+(n?"__"+n:""),this.evtDetail={id:this.id,name:this.name},this.initialized=!1,this.isSingleProperty=h(this.schema),this.isSinglePropertyObject=this.isSingleProperty&&A(l(void 0,this.schema))&&!(this.schema.default instanceof window.HTMLElement),this.isObjectBased=!this.isSingleProperty||this.isSinglePropertyObject,this.el.components[this.attrName]=this,this.objectPool=y[this.name],this.attrValue=void 0,this.nextData=this.isObjectBased?this.objectPool.use():void 0,this.oldData=this.isObjectBased?this.objectPool.use():void 0,this.previousOldData=this.isObjectBased?this.objectPool.use():void 0,this.parsingAttrValue=this.isObjectBased?this.objectPool.use():void 0,this.throttledEmitComponentChanged=o.throttle((function(){e.emit("componentchanged",r.evtDetail,!1)}),200),this.updateProperties(t)};if(b.prototype={schema:{},init:function(){},update:function(e){},updateSchema:void 0,tick:void 0,tock:void 0,play:function(){},pause:function(){},remove:function(){},parse:function(e,t){var n=this.schema;return this.isSingleProperty?l(e,n):c(f.parse(e),n,!0,this.name,t)},stringify:function(e){var t=this.schema;return"string"==typeof e?e:this.isSingleProperty?p(e,t):(e=d(e,t),f.stringify(e))},updateCachedAttrValue:function(e,t){var n,r,i;if(void 0!==e){if(null===e)return this.isObjectBased&&this.attrValue&&this.objectPool.recycle(this.attrValue),void(this.attrValue=void 0);if(e instanceof Object&&!(e instanceof window.HTMLElement)?(r=this.objectPool.use(),n=o.extend(r,e)):n=this.parseAttrValueForCache(e),this.isObjectBased&&!t&&this.attrValue)for(i in this.attrValue)void 0===n[i]&&(n[i]=this.attrValue[i]);this.isObjectBased&&!this.attrValue&&(this.attrValue=this.objectPool.use()),o.objectPool.clearObject(this.attrValue),this.attrValue=E(this.attrValue,n,this.isObjectBased),o.objectPool.clearObject(r)}},parseAttrValueForCache:function(e){var t;return"string"!=typeof e?e:(this.isSingleProperty?"string"==typeof(t=this.schema.parse(e))&&(t=e):(o.objectPool.clearObject(this.parsingAttrValue),t=f.parse(e,this.parsingAttrValue)),t)},flushToDOM:function(e){var t=e?this.data:this.attrValue;t&&window.HTMLElement.prototype.setAttribute.call(this.el,this.attrName,this.stringify(t))},updateProperties:function(e,t){this.el.hasLoaded?(null!==e&&(e=this.parseAttrValueForCache(e)),this.updateCachedAttrValue(e,t),this.initialized?(this.updateComponent(e,t),this.callUpdateHandler()):this.initComponent()):this.updateCachedAttrValue(e)},initComponent:function(){var e,t=this.el;this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!1,!0)),this.data=this.buildData(this.attrValue),t.initializingComponents[this.name]||(t.initializingComponents[this.name]=!0,this.init(),this.initialized=!0,delete t.initializingComponents[this.name],this.oldData=E(this.oldData,this.data,this.isObjectBased),e=this.isObjectBased?this.objectPool.use():void 0,this.update(e),this.isObjectBased&&this.objectPool.recycle(e),t.isPlaying&&this.play(),t.emit("componentinitialized",this.evtDetail,!1))},updateComponent:function(e,t){var n,r;if(t)return this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),void(this.data=this.buildData(this.attrValue,!0,!1));if(this.isSingleProperty)return this.isObjectBased&&l(e,this.schema),void(this.data=e);if(c(e,this.schema,!0,this.name),this.schemaChangeKeys.length)for(n in e)if(this.schema[n].schemaChange){r=!0;break}if(r)return this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),void(this.data=this.buildData(this.attrValue,!0,!1));for(n in e)void 0!==e[n]&&(this.data[n]=e[n])},callUpdateHandler:function(){var e;this.previousOldData instanceof Object&&o.objectPool.clearObject(this.previousOldData),this.isObjectBased?w(this.previousOldData,this.oldData):this.previousOldData=this.oldData,e=!o.deepEqual(this.oldData,this.data),(this.isPositionRotationScale||e)&&(this.oldData instanceof Object&&o.objectPool.clearObject(this.oldData),this.oldData=E(this.oldData,this.data,this.isObjectBased),this.update(this.previousOldData),this.throttledEmitComponentChanged())},handleMixinUpdate:function(){this.data=this.buildData(this.attrValue),this.callUpdateHandler()},resetProperty:function(e){if(this.isObjectBased){if(!(e in this.attrValue))return;delete this.attrValue[e],this.data[e]=this.schema[e].default}else this.attrValue=this.schema.default,this.data=this.schema.default;this.updateProperties(this.attrValue)},extendSchema:function(e){var t;t=o.extend({},s[this.name].schema),o.extend(t,e),this.schema=u(t),this.el.emit("schemachanged",this.evtDetail)},buildData:function(e,t,n){var r,i,a,s,u,h,d,p=this.nextData,f=this.schema,m=this.el.mixinEls;if(r=e&&e.constructor===Array?e.length:null!=e,this.isObjectBased&&o.objectPool.clearObject(p),this.isSingleProperty)i=this.isObjectBased?w(p,f.default):T(f.default)?o.clone(f.default):f.default;else for(s in i=(d=!t&&this.attrValue)instanceof Object?w(p,d):p,f)a=f[s].default,void 0===i[s]&&(i[s]=T(a)?o.clone(a):a);for(h=0;h<m.length;h++)(u=m[h].getAttribute(this.attrName))&&(i=E(i,u,this.isObjectBased));if(r){if(this.isSingleProperty)return A(e)?(w(this.parsingAttrValue,e),l(this.parsingAttrValue,f)):l(e,f);i=E(i,e,this.isObjectBased)}else if(this.isSingleProperty)return l(i,f);return c(i,f,void 0,this.name,n)}},window.debug)var x=e.exports.registrationOrderWarnings={};function w(e,t){var n,r;for(r in t)void 0!==t[r]&&(n=t[r],e[r]=T(n)?o.clone(n):n);return e}function E(e,t,n){var r;if(n&&t.constructor===Object){for(r in t)void 0!==t[r]&&(t[r]&&t[r].constructor===Object?e[r]=o.clone(t[r]):e[r]=t[r]);return e}return t}function M(e){return e.tick||e.tock}function A(e){return e&&e.constructor===Object&&!(e instanceof window.HTMLElement)}function T(e){return e&&(e.constructor===Object||e.constructor===Array)&&!(e instanceof window.HTMLElement)}e.exports.registerComponent=function(e,t){var n,r,c,l,d,p,f,w={};if(document.currentScript&&document.currentScript!==g&&i.forEach((function(t){t.hasLoaded||document.currentScript.compareDocumentPosition(t)!==Node.DOCUMENT_POSITION_FOLLOWING&&(m("The component `"+e+"` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization."),window.debug&&(x[e]=!0))})),!0===v.test(e)&&m("The component name `"+e+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+e.toLowerCase()+"`"),-1!==e.indexOf("__"))throw new Error("The component name `"+e+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");if(Object.keys(t).forEach((function(e){w[e]={value:t[e],writable:!0}})),s[e])throw new Error("The component `"+e+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");if(((n=function(e,t,n){b.call(this,e,t,n)}).prototype=Object.create(b.prototype,w)).name=e,n.prototype.isPositionRotationScale="position"===e||"rotation"===e||"scale"===e,n.prototype.constructor=n,n.prototype.system=a&&a.systems[e],n.prototype.play=(d=n.prototype.play,function(){var e=this.el.sceneEl,t=this.el.isPlaying&&!this.isPlaying;this.initialized&&t&&(d.call(this),this.isPlaying=!0,M(this)&&e.addBehavior(this))}),n.prototype.pause=(p=n.prototype.pause,function(){var e=this.el.sceneEl;this.isPlaying&&(p.call(this),this.isPlaying=!1,M(this)&&e.removeBehavior(this))}),n.prototype.remove=(f=n.prototype.remove,function(){f.call(this),this.objectPool.recycle(this.attrValue),this.objectPool.recycle(this.oldData),this.objectPool.recycle(this.parsingAttrValue),this.attrValue=this.oldData=this.parsingAttrValue=void 0}),c=o.extend(u(n.prototype.schema,n.prototype.name)),!(l=h(n.prototype.schema)))for(r in n.prototype.schemaChangeKeys=[],c)c[r].schemaChange&&n.prototype.schemaChangeKeys.push(r);return y[e]=o.objectPool.createPool(),s[e]={Component:n,dependencies:n.prototype.dependencies,isSingleProp:l,multiple:n.prototype.multiple,name:e,parse:n.prototype.parse,parseAttrValueForCache:n.prototype.parseAttrValueForCache,schema:c,stringify:n.prototype.stringify,type:n.prototype.type},n}},223:function(e,t,n){if(window.hasNativeWebVRImplementation=!!window.navigator.getVRDisplays||!!window.navigator.getVRDevices,window.hasNativeWebXRImplementation=void 0!==navigator.xr,!window.hasNativeWebXRImplementation&&!window.hasNativeWebVRImplementation){var r=n(810)(window.navigator.userAgent)?1/window.devicePixelRatio:1,i=n(811),a={BUFFER_SCALE:r,CARDBOARD_UI_DISABLED:!0,ROTATE_INSTRUCTIONS_DISABLED:!0};window.webvrpolyfill=new i(a)}var o=n(24),s=o.debug,c=s("A-Frame:error"),l=s("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&l("Put the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML."),"file:"===window.location.protocol&&c("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/0.5.0/introduction/getting-started.html#using-a-local-server."),n(828),o.device.isBrowserEnvironment&&(n(829),n(830));var u=n(831).AScene,h=n(22).components,d=n(22).registerComponent,p=n(54).registerGeometry,f=n(67).registerPrimitive,m=n(89).registerShader,g=n(88).registerSystem,v=n(89).shaders,y=n(88).systems,b=window.THREE=n(19);n(840),n(876),n(891),n(897);var x=n(171),w=n(224);n(905),n(906),n(907),n(908),n(910),console.log("A-Frame Version: https://github.com/MozillaReality/aframe"),console.log("three Version: https://github.com/MozillaReality/three.js"),e.exports=window.AFRAME={AComponent:n(22).Component,AEntity:w,ANode:x,ANIME:n(923),AScene:u,components:h,geometries:n(54).geometries,registerComponent:d,registerElement:n(113).registerElement,registerGeometry:p,registerPrimitive:f,registerShader:m,registerSystem:g,primitives:{getMeshMixin:n(114),primitives:n(67).primitives},scenes:n(287),schema:n(195),shaders:v,systems:y,THREE:b,utils:o,version:"hubs/master"}},224:function(e,t,n){var r,i,a,o=n(171),s=n(22).components,c=n(113).registerElement,l=n(19),u=n(24),h=u.debug("core:a-entity:debug"),d=u.debug("core:a-entity:warn"),p=["position","rotation","scale","visible"],f={once:!0},m=Object.create(o.prototype,{createdCallback:{value:function(){this.components={},this.initializingComponents={},this.componentsToUpdate={},this.isEntity=!0,this.isPlaying=!1,this.object3D=new l.Group,this.object3D.el=this,this.object3DMap={},this.parentEl=null,this.rotationObj={},this.states=[]}},attributeChangedCallback:{value:function(e,t,n){var r=this.components[e];r&&r.justInitialized&&""===n?delete r.justInitialized:(r||null!==n)&&this.setEntityAttribute(e,t,n)}},attachedCallback:{value:function(){var e,t=this.sceneEl,n=this;this.addToParent(),this.isScene||(t?!(e=t.querySelector("a-assets"))||e.hasLoaded?this.load():e.addEventListener("loaded",(function(){n.load()})):this.load())}},detachedCallback:{value:function(){var e;if(this.parentEl){for(e in this.components)this.removeComponent(e);this.isScene||(this.removeFromParent(),o.prototype.detachedCallback.call(this),this.object3D.el=null)}}},getObject3D:{value:function(e){return this.object3DMap[e]}},setObject3D:{value:function(e,t){var n,r=this;if(!(t instanceof l.Object3D))throw new Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");(n=this.getObject3D(e))&&this.object3D.remove(n),t.el=this,t.children.length&&t.traverse((function(e){e.el=r})),this.object3D.add(t),this.object3DMap[e]=t,this.emit("object3dset",{object:t,type:e})}},removeObject3D:{value:function(e){var t=this.getObject3D(e);t?(this.object3D.remove(t),delete this.object3DMap[e],this.emit("object3dremove",{type:e})):d("Tried to remove `Object3D` of type:",e,"which was not defined.")}},getOrCreateObject3D:{value:function(e,t){var n=this.getObject3D(e);return!n&&t&&(n=new t,this.setObject3D(e,n)),d("`getOrCreateObject3D` has been deprecated. Use `setObject3D()` and `object3dset` event instead."),n}},add:{value:function(e){if(!e.object3D)throw new Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(e.object3D),this.emit("child-attached",{el:e})}},addToParent:{value:function(){var e=this.parentEl=this.parentNode;e&&e.add&&!this.attachedToParent&&(e.add(this),this.attachedToParent=!0)}},removeFromParent:{value:function(){var e=this.parentEl;this.parentEl.remove(this),this.attachedToParent=!1,this.parentEl=null,e.emit("child-detached",{el:this})}},load:{value:function(){var e=this;!this.hasLoaded&&this.parentEl&&o.prototype.load.call(this,(function(){e.parentEl&&(e.updateComponents(),(e.isScene||e.parentEl.isPlaying)&&e.play())}))},writable:window.debug},remove:{value:function(e){this.object3D.remove(e.object3D)}},getChildEntities:{value:function(){for(var e=this.children,t=[],n=0;n<e.length;n++){var i=e[n];i instanceof r&&t.push(i)}return t}},initComponent:{value:function(e,t,n){var r,i,a,o;if(o=(a=u.split(e,"__"))[0],i=a.length>2?a.slice(1).join("__"):a[1],s[o]&&(g(this,e)||void 0!==t||n)&&!(e in this.components)){if(this.initComponentDependencies(o),i&&!s[o].multiple)throw new Error("Trying to initialize multiple components of type `"+o+"`. There can only be one component of this type per entity.");r=new s[o].Component(this,t,i),this.isPlaying&&r.play(),this.hasAttribute(e)||(r.justInitialized=!0,window.HTMLElement.prototype.setAttribute.call(this,e,"")),h("Component initialized: %s",e)}},writable:window.debug},initComponentDependencies:{value:function(e){var t,n;if(s[e]&&(t=s[e].dependencies))for(n=0;n<t.length;n++)this.initComponent(t[n],window.HTMLElement.prototype.getAttribute.call(this,t[n])||void 0,!0)}},removeComponent:{value:function(e){var t;(t=this.components[e])&&(t.initialized?(t.pause(),t.remove(),delete this.components[e],this.emit("componentremoved",t.evtDetail)):this.addEventListener("componentinitialized",(function t(n){n.detail.name===e&&(this.removeComponent(e),this.removeEventListener("componentinitialized",t))})))},writable:window.debug},updateComponents:{value:function(){var e,t,n,r,i=this.componentsToUpdate;if(this.hasLoaded){for(n=0;n<this.mixinEls.length;n++)for(r in this.mixinEls[n].componentCache)y(r)&&(i[r]=!0);if(this.getExtraComponents)for(r in t=this.getExtraComponents())y(r)&&(i[r]=!0);for(n=0;n<this.attributes.length;++n)r=this.attributes[n].name,-1===p.indexOf(r)&&y(r)&&(i[r]=!0);for(n=0;n<p.length;n++)r=p[n],this.hasAttribute(r)&&this.updateComponent(r,this.getDOMAttribute(r));for(r in i)e=v(this.getDOMAttribute(r),t&&t[r]),this.updateComponent(r,e),delete i[r]}},writable:window.debug},updateComponent:{value:function(e,t,n){var r=this.components[e];if(r)return null!==t||g(this,e)?void r.updateProperties(t,n):void this.removeComponent(e);this.initComponent(e,t,!1)}},removeAttribute:{value:function(e,t){var n=this.components[e];n&&void 0===t&&this.removeComponent(e),n&&void 0!==t?n.resetProperty(t):("mixin"===e&&this.mixinUpdate(""),window.HTMLElement.prototype.removeAttribute.call(this,e))}},play:{value:function(){var e,t,n;if(!this.isPlaying&&this.hasLoaded){for(n in this.isPlaying=!0,this.components)this.components[n].play();for(e=this.getChildEntities(),t=0;t<e.length;t++)e[t].play();this.emit("play")}},writable:!0},pause:{value:function(){var e,t,n;if(this.isPlaying){for(n in this.isPlaying=!1,this.components)this.components[n].pause();for(e=this.getChildEntities(),t=0;t<e.length;t++)e[t].pause();this.emit("pause")}},writable:!0},setEntityAttribute:{value:function(e,t,n){if(s[e]||this.components[e])this.updateComponent(e,n);else if("mixin"===e){if(n===this.computedMixinStr)return;this.mixinUpdate(n,t)}}},mixinUpdate:{value:(a=[],function(e,t){var n,r,i,o,s=this;if(this.hasLoaded){for(t=t||this.getAttribute("mixin"),i=this.updateMixins(e,t),a.length=0,o=0;o<this.mixinEls.length;o++)for(n in this.mixinEls[o].componentCache)-1===a.indexOf(n)&&(this.components[n]?this.components[n].handleMixinUpdate():this.initComponent(n,null),a.push(n));for(o=0;o<i.oldMixinIds.length;o++)if(r=document.getElementById(i.oldMixinIds[o]))for(n in r.componentCache)-1===a.indexOf(n)&&this.components[n]&&(this.getDOMAttribute(n)?this.components[n].handleMixinUpdate():this.removeComponent(n))}else this.addEventListener("loaded",(function(){s.mixinUpdate(e,t)}),f)})},setAttribute:{value:(i={},function(e,t,n){var r,a,c,l,h;if(c=(l=e.indexOf("__"))>0?e.substring(0,l):e,!s[c])return"mixin"===e&&this.mixinUpdate(t),void o.prototype.setAttribute.call(this,e,t);if(!this.components[e]&&this.hasAttribute(e)&&this.updateComponent(e,window.HTMLElement.prototype.getAttribute.call(this,e)),void 0!==n&&"string"==typeof t&&t.length>0&&"string"==typeof u.styleParser.parse(t)){for(h in i)delete i[h];(r=i)[t]=n,a=!1}else r=t,a=!0===n;this.updateComponent(e,r,a),this.sceneEl&&this.sceneEl.getAttribute("debug")&&this.components[e].flushToDOM()}),writable:window.debug},flushToDOM:{value:function(e){var t,n,r,i=this.components,a=this.children;for(r in i)i[r].flushToDOM();if(e)for(n=0;n<a.length;++n)(t=a[n]).flushToDOM&&t.flushToDOM(e)}},getAttribute:{value:function(e){var t,n,r,i,a;return"position"===e?this.object3D.position:"rotation"===e?(n=this,r=l.Math.radToDeg,i=n.object3D.rotation,(a=n.rotationObj).x=r(i.x),a.y=r(i.y),a.z=r(i.z),a):"scale"===e?this.object3D.scale:"visible"===e?this.object3D.visible:(t=this.components[e])?t.data:window.HTMLElement.prototype.getAttribute.call(this,e)},writable:window.debug},getDOMAttribute:{value:function(e){var t=this.components[e];return t?t.attrValue:window.HTMLElement.prototype.getAttribute.call(this,e)},writable:window.debug},addState:{value:function(e){this.is(e)||(this.states.push(e),this.emit("stateadded",e))}},removeState:{value:function(e){var t=this.states.indexOf(e);-1!==t&&(this.states.splice(t,1),this.emit("stateremoved",e))}},is:{value:function(e){return-1!==this.states.indexOf(e)}},inspect:{value:function(){this.sceneEl.components.inspector.openInspector(this)}}});function g(e,t){return!(!e.components[t]||!e.components[t].attrValue)||function(e,t){var n,r=!1;for(n=0;n<t.length&&!(r=t[n].hasAttribute(e));++n);return r}(t,e.mixinEls)}function v(e,t){return t?t.constructor===Object?u.extend(t,u.styleParser.parse(e||{})):e||t:e}function y(e){return-1!==e.indexOf("__")&&(e=u.split(e,"__")[0]),!!s[e]}r=c("a-entity",{prototype:m}),e.exports=r},24:function(e,t,n){var r=n(99),i=n(813),a=n(815),o=n(60),s=n(816),c=r("utils:warn");e.exports.bind=n(170),e.exports.coordinates=n(361),e.exports.debug=r,e.exports.device=a,e.exports.entity=n(817),e.exports.forceCanvasResizeSafariMobile=n(818),e.exports.isIE11=n(819),e.exports.material=n(362),e.exports.objectPool=s,e.exports.split=n(823).split,e.exports.styleParser=n(824),e.exports.trackedControls=n(825),e.exports.checkHeadsetConnected=function(){return c("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`"),a.checkHeadsetConnected(arguments)},e.exports.isGearVR=e.exports.device.isGearVR=function(){c("`utils.isGearVR` has been deprecated, use `utils.device.isMobileVR`")},e.exports.isIOS=function(){return c("`utils.isIOS` has moved to `utils.device.isIOS`"),a.isIOS(arguments)},e.exports.isOculusGo=e.exports.device.isOculusGo=function(){c("`utils.isOculusGo` has been deprecated, use `utils.device.isMobileVR`")},e.exports.isMobile=function(){return c("`utils.isMobile has moved to `utils.device.isMobile`"),a.isMobile(arguments)},e.exports.throttle=function(t,n,r){var i;return r&&(t=e.exports.bind(t,r)),function(){var e=Date.now(),r=void 0===i?n:e-i;(void 0===i||r>=n)&&(i=e,t.apply(null,arguments))}},e.exports.throttleTick=function(t,n,r){var i;return r&&(t=e.exports.bind(t,r)),function(e,r){var a=void 0===i?r:e-i;(void 0===i||a>=n)&&(i=e,t(e,a))}},e.exports.debounce=function(e,t,n){var r;return function(){var i=this,a=arguments,o=function(){r=null,n||e.apply(i,a)},s=n&&!r;clearTimeout(r),r=setTimeout(o,t),s&&e.apply(i,a)}},e.exports.extend=o,e.exports.extendDeep=i,e.exports.clone=function(e){return JSON.parse(JSON.stringify(e))};var l,u,h=(l=s.createPool((function(){return[]})),function(e,t){var n,r,i,a,o,s;if(void 0===e||void 0===t||null===e||null===t||!(e&&t&&e.constructor===Object&&t.constructor===Object||e.constructor===Array&&t.constructor===Array))return e===t;for(n in r=l.use(),i=l.use(),r.length=0,i.length=0,e)r.push(n);for(n in t)i.push(n);if(r.length!==i.length)return l.recycle(r),l.recycle(i),!1;for(a=0;a<r.length;++a)if(o=e[r[a]],s=t[r[a]],"object"==typeof o||"object"==typeof s||Array.isArray(o)&&Array.isArray(s)){if(o===s)continue;if(!h(o,s))return l.recycle(r),l.recycle(i),!1}else if(o!==s)return l.recycle(r),l.recycle(i),!1;return l.recycle(r),l.recycle(i),!0});e.exports.deepEqual=h,e.exports.diff=(u=[],function(e,t,n){var r,i,a,o,s,c,l;for(s in o=n||{},u.length=0,e)u.push(s);if(!t)return o;for(a in t)-1===u.indexOf(a)&&u.push(a);for(c=0;c<u.length;c++)r=e[s=u[c]],i=t[s],((l=r&&i&&r.constructor===Object&&i.constructor===Object)&&!h(r,i)||!l&&r!==i)&&(o[s]=i);return o}),e.exports.shouldCaptureKeyEvent=function(e){return!e.metaKey&&document.activeElement===document.body},e.exports.splitString=function(e,t){void 0===t&&(t=" ");var n=new RegExp(t,"g");return(e=(e||"").replace(n,t)).split(t)},e.exports.getElData=function(e,t){t=t||{};var n={};return Object.keys(t).forEach((function(t){e.hasAttribute(t)&&(n[t]=e.getAttribute(t))})),n},e.exports.getUrlParameter=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},e.exports.isIframed=function(){return window.top!==window.self},e.exports.findAllScenes=function(e){for(var t=[],n=e.getElementsByTagName("*"),r=0,i=n.length;r<i;r++)n[r].isScene&&t.push(n[r]);return t},e.exports.srcLoader=n(827)},286:function(e,t){THREE.GLTFLoader=function(){function e(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.dracoLoader=null,this.revokeObjectURLs=!0}function t(){var e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype={constructor:e,crossOrigin:"anonymous",load:function(e,t,n,r){this._load(e,t,n,r,!1)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setDRACOLoader:function(e){return this.dracoLoader=e,this},parse:function(e,t,n,r){this._parse(e,t,n,r,!1)},createParser:function(e,t,n,r){this._load(e,t,n,r,!0)},_load:function(e,t,n,r,i){var a,o=this;a=void 0!==this.resourcePath?this.resourcePath:void 0!==this.path?this.path:THREE.LoaderUtils.extractUrlBase(e),o.manager.itemStart(e);var s=function(t){r?r(t):console.error(t),o.manager.itemError(e),o.manager.itemEnd(e)},c=new THREE.FileLoader(o.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),"use-credentials"===o.crossOrigin&&c.setWithCredentials(!0),c.load(e,(function(n){try{o._parse(n,a,(function(n){t(n),o.manager.itemEnd(e)}),s,i)}catch(e){s(e)}}),n,s)},_parse:function(e,t,s,c,p){var f,m={};if("string"==typeof e)f=e;else if(THREE.LoaderUtils.decodeText(new Uint8Array(e,0,4))===o){try{m[n.KHR_BINARY_GLTF]=new l(e)}catch(e){return void(c&&c(e))}f=m[n.KHR_BINARY_GLTF].content}else f=THREE.LoaderUtils.decodeText(new Uint8Array(e));var g=JSON.parse(f);if(void 0===g.asset||g.asset.version[0]<2)c&&c(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead."));else{if(g.extensionsUsed)for(var v=0;v<g.extensionsUsed.length;++v){var y=g.extensionsUsed[v],b=g.extensionsRequired||[];switch(y){case n.KHR_LIGHTS_PUNCTUAL:m[y]=new i(g);break;case n.KHR_MATERIALS_UNLIT:m[y]=new a;break;case n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:m[y]=new d;break;case n.KHR_DRACO_MESH_COMPRESSION:m[y]=new u(g,this.dracoLoader);break;case n.MSFT_TEXTURE_DDS:m[n.MSFT_TEXTURE_DDS]=new r;break;case n.KHR_TEXTURE_TRANSFORM:m[n.KHR_TEXTURE_TRANSFORM]=new h;break;default:b.indexOf(y)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+y+'".')}}var x=new F(g,m,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager,revokeObjectURLs:this.revokeObjectURLs});p?s(x):x.parse(s,c)}}};var n={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function r(){if(!THREE.DDSLoader)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=n.MSFT_TEXTURE_DDS,this.ddsLoader=new THREE.DDSLoader}function i(e){this.name=n.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[n.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function a(){this.name=n.KHR_MATERIALS_UNLIT}i.prototype.loadLight=function(e){var t,n=this.lightDefs[e],r=new THREE.Color(16777215);void 0!==n.color&&r.fromArray(n.color);var i=void 0!==n.range?n.range:0;switch(n.type){case"directional":(t=new THREE.DirectionalLight(r)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new THREE.PointLight(r)).distance=i;break;case"spot":(t=new THREE.SpotLight(r)).distance=i,n.spot=n.spot||{},n.spot.innerConeAngle=void 0!==n.spot.innerConeAngle?n.spot.innerConeAngle:0,n.spot.outerConeAngle=void 0!==n.spot.outerConeAngle?n.spot.outerConeAngle:Math.PI/4,t.angle=n.spot.outerConeAngle,t.penumbra=1-n.spot.innerConeAngle/n.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+n.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==n.intensity&&(t.intensity=n.intensity),t.name=n.name||"light_"+e,Promise.resolve(t)},a.prototype.getMaterialType=function(){return THREE.MeshBasicMaterial},a.prototype.extendParams=function(e,t,n){var r=[];e.color=new THREE.Color(1,1,1),e.opacity=1;var i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){var a=i.baseColorFactor;e.color.fromArray(a),e.opacity=a[3]}void 0!==i.baseColorTexture&&r.push(n.assignTexture(e,"map",i.baseColorTexture))}return Promise.all(r)};var o="glTF",s=1313821514,c=5130562;function l(e){this.name=n.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,12);if(this.header={magic:THREE.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==o)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");for(var r=new DataView(e,12),i=0;i<r.byteLength;){var a=r.getUint32(i,!0);i+=4;var l=r.getUint32(i,!0);if(i+=4,l===s){var u=new Uint8Array(e,12+i,a);this.content=THREE.LoaderUtils.decodeText(u)}else if(l===c){var h=12+i;this.body=e.slice(h,h+a)}i+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function u(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=n.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t}function h(){this.name=n.KHR_TEXTURE_TRANSFORM}function d(){return{name:n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return THREE.ShaderMaterial},extendParams:function(e,t,n){var r=t.extensions[this.name],i=THREE.ShaderLib.standard,a=THREE.UniformsUtils.clone(i.uniforms),o=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),s=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),c=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),l=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),u=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),h=i.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",o).replace("#include <metalnessmap_pars_fragment>",s).replace("#include <roughnessmap_fragment>",c).replace("#include <metalnessmap_fragment>",l).replace("#include <lights_physical_fragment>",u);delete a.roughness,delete a.metalness,delete a.roughnessMap,delete a.metalnessMap,a.specular={value:(new THREE.Color).setHex(1118481)},a.glossiness={value:.5},a.specularMap={value:null},a.glossinessMap={value:null},e.vertexShader=i.vertexShader,e.fragmentShader=h,e.uniforms=a,e.defines={STANDARD:""},e.color=new THREE.Color(1,1,1),e.opacity=1;var d=[];if(Array.isArray(r.diffuseFactor)){var p=r.diffuseFactor;e.color.fromArray(p),e.opacity=p[3]}if(void 0!==r.diffuseTexture&&d.push(n.assignTexture(e,"map",r.diffuseTexture)),e.emissive=new THREE.Color(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new THREE.Color(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){var f=r.specularGlossinessTexture;d.push(n.assignTexture(e,"glossinessMap",f)),d.push(n.assignTexture(e,"specularMap",f))}return Promise.all(d)},createMaterial:function(e){var t=new THREE.ShaderMaterial({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},cloneMaterial:function(e){var t=e.clone();t.isGLTFSpecularGlossinessMaterial=!0;for(var n=this.specularGlossinessParams,r=0,i=n.length;r<i;r++){var a=e[n[r]];t[n[r]]=a&&a.isColor?a.clone():a}return t},refreshUniforms:function(e,t,n,r,i,a){if(!0===i.isGLTFSpecularGlossinessMaterial){var o,s=i.uniforms,c=i.defines;s.opacity.value=i.opacity,s.diffuse.value.copy(i.color),s.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),s.map.value=i.map,s.specularMap.value=i.specularMap,s.alphaMap.value=i.alphaMap,s.lightMap.value=i.lightMap,s.lightMapIntensity.value=i.lightMapIntensity,s.aoMap.value=i.aoMap,s.aoMapIntensity.value=i.aoMapIntensity,i.map?o=i.map:i.specularMap?o=i.specularMap:i.displacementMap?o=i.displacementMap:i.normalMap?o=i.normalMap:i.bumpMap?o=i.bumpMap:i.glossinessMap?o=i.glossinessMap:i.alphaMap?o=i.alphaMap:i.emissiveMap&&(o=i.emissiveMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),s.uvTransform.value.copy(o.matrix)),i.envMap&&(s.envMap.value=i.envMap,s.envMapIntensity.value=i.envMapIntensity,s.flipEnvMap.value=i.envMap.isCubeTexture?-1:1,s.reflectivity.value=i.reflectivity,s.refractionRatio.value=i.refractionRatio,s.maxMipLevel.value=e.properties.get(i.envMap).__maxMipLevel),s.specular.value.copy(i.specular),s.glossiness.value=i.glossiness,s.glossinessMap.value=i.glossinessMap,s.emissiveMap.value=i.emissiveMap,s.bumpMap.value=i.bumpMap,s.normalMap.value=i.normalMap,s.displacementMap.value=i.displacementMap,s.displacementScale.value=i.displacementScale,s.displacementBias.value=i.displacementBias,null!==s.glossinessMap.value&&void 0===c.USE_GLOSSINESSMAP&&(c.USE_GLOSSINESSMAP="",c.USE_ROUGHNESSMAP=""),null===s.glossinessMap.value&&void 0!==c.USE_GLOSSINESSMAP&&(delete c.USE_GLOSSINESSMAP,delete c.USE_ROUGHNESSMAP)}}}}function p(e,t,n,r){THREE.Interpolant.call(this,e,t,n,r)}u.prototype.decodePrimitive=function(e,t){var n=this.json,r=this.dracoLoader,i=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},s={},c={};for(var l in a){var u=_[l]||l.toLowerCase();o[u]=a[l]}for(l in e.attributes){u=_[l]||l.toLowerCase();if(void 0!==a[l]){var h=n.accessors[e.attributes[l]],d=E[h.componentType];c[u]=d,s[u]=!0===h.normalized}}return t.getDependency("bufferView",i).then((function(e){return new Promise((function(t){r.decodeDracoFile(e,(function(e){for(var n in e.attributes){var r=e.attributes[n],i=s[n];void 0!==i&&(r.normalized=i)}t(e)}),o,c)}))}))},h.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},p.prototype=Object.create(THREE.Interpolant.prototype),p.prototype.constructor=p,p.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r*3+r,a=0;a!==r;a++)t[a]=n[i+a];return t},p.prototype.beforeStart_=p.prototype.copySampleValue_,p.prototype.afterEnd_=p.prototype.copySampleValue_,p.prototype.interpolate_=function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=2*o,c=3*o,l=r-t,u=(n-t)/l,h=u*u,d=h*u,p=e*c,f=p-c,m=-2*d+3*h,g=d-h,v=1-m,y=g-h+u,b=0;b!==o;b++){var x=a[f+b+o],w=a[f+b+s]*l,E=a[p+b+o],M=a[p+b]*l;i[b]=v*x+y*w+m*E+g*M}return i};var f,m=0,g=1,v=2,y=3,b=4,x=5,w=6,E={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},M={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipMapNearestFilter,9985:THREE.LinearMipMapNearestFilter,9986:THREE.NearestMipMapLinearFilter,9987:THREE.LinearMipMapLinearFilter},A={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},T={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},S={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},L={CUBICSPLINE:void 0,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete},C="OPAQUE",R="MASK",P="BLEND",O={"image/png":THREE.RGBAFormat,"image/jpeg":THREE.RGBFormat};function D(e,t){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e}function I(e,t,n){for(var r in n.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=n.extensions[r])}function B(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function k(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){var i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length){e.morphTargetDictionary={};for(n=0,r=i.length;n<r;n++)e.morphTargetDictionary[i[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function H(e){for(var t="",n=Object.keys(e).sort(),r=0,i=n.length;r<i;r++)t+=n[r]+":"+e[n[r]]+";";return t}function N(e){if(e.isInterleavedBufferAttribute){for(var t=e.count,n=e.itemSize,r=e.array.slice(0,t*n),i=0,a=0;i<t;++i)r[a++]=e.getX(i),n>=2&&(r[a++]=e.getY(i)),n>=3&&(r[a++]=e.getZ(i)),n>=4&&(r[a++]=e.getW(i));return new THREE.BufferAttribute(r,n,e.normalized)}return e.clone()}function F(e,n,r){this.json=e||{},this.extensions=n||{},this.options=r||{revokeObjectURLs:!0},this.cache=new t,this.primitiveCache={},this.textureLoader=new THREE.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new THREE.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function U(e,t,n){var r=t.attributes,i=[];function a(t,r){return n.getDependency("accessor",t).then((function(t){e.addAttribute(r,t)}))}for(var o in r){var s=_[o]||o.toLowerCase();s in e.attributes||i.push(a(r[o],s))}if(void 0!==t.indices&&!e.index){var c=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));i.push(c)}return B(e,t),Promise.all(i).then((function(){return void 0!==t.targets?function(e,t,n){for(var r=!1,i=!1,a=0,o=t.length;a<o;a++){if(void 0!==(l=t[a]).POSITION&&(r=!0),void 0!==l.NORMAL&&(i=!0),r&&i)break}if(!r&&!i)return Promise.resolve(e);var s=[],c=[];for(a=0,o=t.length;a<o;a++){var l=t[a];if(r){var u=void 0!==l.POSITION?n.getDependency("accessor",l.POSITION):e.attributes.position;s.push(u)}if(i){u=void 0!==l.NORMAL?n.getDependency("accessor",l.NORMAL):e.attributes.normal;c.push(u)}}return Promise.all([Promise.all(s),Promise.all(c)]).then((function(n){for(var a=n[0],o=n[1],s=0,c=a.length;s<c;s++)e.attributes.position!==a[s]&&(a[s]=N(a[s]));for(s=0,c=o.length;s<c;s++)e.attributes.normal!==o[s]&&(o[s]=N(o[s]));for(s=0,c=t.length;s<c;s++){var l=t[s],u="morphTarget"+s;if(r&&void 0!==l.POSITION){var h=a[s];h.name=u;for(var d=e.attributes.position,p=0,f=h.count;p<f;p++)h.setXYZ(p,h.getX(p)+d.getX(p),h.getY(p)+d.getY(p),h.getZ(p)+d.getZ(p))}if(i&&void 0!==l.NORMAL){var m=o[s];m.name=u;var g=e.attributes.normal;for(p=0,f=m.count;p<f;p++)m.setXYZ(p,m.getX(p)+g.getX(p),m.getY(p)+g.getY(p),m.getZ(p)+g.getZ(p))}}return r&&(e.morphAttributes.position=a),i&&(e.morphAttributes.normal=o),e}))}(e,t.targets,n):e}))}return F.prototype.parse=function(e,t){var n=this,r=this.json,i=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then((function(t){var a={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};I(i,a,r),e(a),n.cache.removeAll()})).catch(t)},F.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[],r={},i={},a=0,o=t.length;a<o;a++)for(var s=t[a].joints,c=0,l=s.length;c<l;c++)e[s[c]].isBone=!0;for(var u=0,h=e.length;u<h;u++){var d=e[u];void 0!==d.mesh&&(void 0===r[d.mesh]&&(r[d.mesh]=i[d.mesh]=0),r[d.mesh]++,void 0!==d.skin&&(n[d.mesh].isSkinnedMesh=!0))}this.json.meshReferences=r,this.json.meshUses=i},F.prototype.getDependency=function(e,t){var r=e+":"+t,i=this.cache.get(r);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this.loadNode(t);break;case"mesh":i=this.loadMesh(t);break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this.loadBufferView(t);break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this.loadMaterial(t);break;case"texture":i=this.loadTexture(t);break;case"skin":i=this.loadSkin(t);break;case"animation":i=this.loadAnimation(t);break;case"camera":i=this.loadCamera(t);break;case"light":i=this.extensions[n.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,i)}return i},F.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var n=this,r=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(r.map((function(t,r){return n.getDependency(e,r)}))),this.cache.add(e,t)}return t},F.prototype.loadBuffer=function(e){var t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[n.KHR_BINARY_GLTF].body);var i=this.options;return new Promise((function(e,n){r.load(D(t.uri,i.path),e,void 0,(function(){n(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},F.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)}))},F.prototype.loadAccessor=function(e){var t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);var i=[];return void 0!==r.bufferView?i.push(this.getDependency("bufferView",r.bufferView)):i.push(null),void 0!==r.sparse&&(i.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(i).then((function(e){var i,a,o=e[0],s=T[r.type],c=E[r.componentType],l=c.BYTES_PER_ELEMENT,u=l*s,h=r.byteOffset||0,d=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,p=!0===r.normalized;if(d&&d!==u){var f="InterleavedBuffer:"+r.bufferView+":"+r.componentType,m=t.cache.get(f);m||(i=new c(o),m=new THREE.InterleavedBuffer(i,d/l),t.cache.add(f,m)),a=new THREE.InterleavedBufferAttribute(m,s,h/l,p)}else i=null===o?new c(r.count*s):new c(o,h,r.count*s),a=new THREE.BufferAttribute(i,s,p);if(void 0!==r.sparse){var g=T.SCALAR,v=E[r.sparse.indices.componentType],y=r.sparse.indices.byteOffset||0,b=r.sparse.values.byteOffset||0,x=new v(e[1],y,r.sparse.count*g),w=new c(e[2],b,r.sparse.count*s);null!==o&&a.setArray(a.array.slice());for(var M=0,A=x.length;M<A;M++){var _=x[M];if(a.setX(_,w[M*s]),s>=2&&a.setY(_,w[M*s+1]),s>=3&&a.setZ(_,w[M*s+2]),s>=4&&a.setW(_,w[M*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return a}))},F.prototype.loadTexture=function(e){var t,r=this,i=this.json,a=this.options,o=this.textureLoader,s=window.URL||window.webkitURL,c=i.textures[e],l=c.extensions||{},u=(t=l[n.MSFT_TEXTURE_DDS]?i.images[l[n.MSFT_TEXTURE_DDS].source]:i.images[c.source]).uri,h=!1;return void 0!==t.bufferView&&(u=r.getDependency("bufferView",t.bufferView).then((function(e){h=!0;var n=new Blob([e],{type:t.mimeType});return u=s.createObjectURL(n)}))),Promise.resolve(u).then((function(e){var t=THREE.Loader.Handlers.get(e);return t||(t=l[n.MSFT_TEXTURE_DDS]?r.extensions[n.MSFT_TEXTURE_DDS].ddsLoader:o),new Promise((function(n,r){t.load(D(e,a.path),n,void 0,r)}))})).then((function(e){!0===h&&a.revokeObjectURLs&&s.revokeObjectURL(u),e.flipY=!1,void 0!==c.name&&(e.name=c.name),t.mimeType in O&&(e.format=O[t.mimeType]);var n=(i.samplers||{})[c.sampler]||{};return e.magFilter=M[n.magFilter]||THREE.LinearFilter,e.minFilter=M[n.minFilter]||THREE.LinearMipMapLinearFilter,e.wrapS=A[n.wrapS]||THREE.RepeatWrapping,e.wrapT=A[n.wrapT]||THREE.RepeatWrapping,e}))},F.prototype.assignTexture=function(e,t,r){var i=this;return this.getDependency("texture",r.index).then((function(a){if(!a.isCompressedTexture)switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":a.format=THREE.RGBFormat}if(i.extensions[n.KHR_TEXTURE_TRANSFORM]){var o=void 0!==r.extensions?r.extensions[n.KHR_TEXTURE_TRANSFORM]:void 0;o&&(a=i.extensions[n.KHR_TEXTURE_TRANSFORM].extendTexture(a,o))}e[t]=a}))},F.prototype.assignFinalMaterial=function(e){var t=e.geometry,r=e.material,i=this.extensions,a=void 0!==t.attributes.tangent,o=void 0!==t.attributes.color,s=void 0===t.attributes.normal,c=!0===e.isSkinnedMesh,l=Object.keys(t.morphAttributes).length>0,u=l&&void 0!==t.morphAttributes.normal;if(e.isPoints){var h="PointsMaterial:"+r.uuid,d=this.cache.get(h);d||(d=new THREE.PointsMaterial,THREE.Material.prototype.copy.call(d,r),d.color.copy(r.color),d.map=r.map,d.lights=!1,this.cache.add(h,d)),r=d}else if(e.isLine){h="LineBasicMaterial:"+r.uuid;var p=this.cache.get(h);p||(p=new THREE.LineBasicMaterial,THREE.Material.prototype.copy.call(p,r),p.color.copy(r.color),p.lights=!1,this.cache.add(h,p)),r=p}if(a||o||s||c||l){h="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(h+="specular-glossiness:"),c&&(h+="skinning:"),a&&(h+="vertex-tangents:"),o&&(h+="vertex-colors:"),s&&(h+="flat-shading:"),l&&(h+="morph-targets:"),u&&(h+="morph-normals:");var f=this.cache.get(h);f||(f=r.isGLTFSpecularGlossinessMaterial?i[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(r):r.clone(),c&&(f.skinning=!0),a&&(f.vertexTangents=!0),o&&(f.vertexColors=THREE.VertexColors),s&&(f.flatShading=!0),l&&(f.morphTargets=!0),u&&(f.morphNormals=!0),this.cache.add(h,f)),r=f}r.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&(console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap."),t.addAttribute("uv2",new THREE.BufferAttribute(t.attributes.uv.array,2))),r.isGLTFSpecularGlossinessMaterial&&(e.onBeforeRender=i[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms),e.material=r},F.prototype.loadMaterial=function(e){var t,r=this.json,i=this.extensions,a=r.materials[e],o={},s=a.extensions||{},c=[];if(s[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var l=i[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=l.getMaterialType(),c.push(l.extendParams(o,a,this))}else if(s[n.KHR_MATERIALS_UNLIT]){var u=i[n.KHR_MATERIALS_UNLIT];t=u.getMaterialType(),c.push(u.extendParams(o,a,this))}else{t=THREE.MeshStandardMaterial;var h=a.pbrMetallicRoughness||{};if(o.color=new THREE.Color(1,1,1),o.opacity=1,Array.isArray(h.baseColorFactor)){var d=h.baseColorFactor;o.color.fromArray(d),o.opacity=d[3]}void 0!==h.baseColorTexture&&c.push(this.assignTexture(o,"map",h.baseColorTexture)),o.metalness=void 0!==h.metallicFactor?h.metallicFactor:1,o.roughness=void 0!==h.roughnessFactor?h.roughnessFactor:1,void 0!==h.metallicRoughnessTexture&&(c.push(this.assignTexture(o,"metalnessMap",h.metallicRoughnessTexture)),c.push(this.assignTexture(o,"roughnessMap",h.metallicRoughnessTexture)))}!0===a.doubleSided&&(o.side=THREE.DoubleSide);var p=a.alphaMode||C;return p===P?o.transparent=!0:(o.transparent=!1,p===R&&(o.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&t!==THREE.MeshBasicMaterial&&(c.push(this.assignTexture(o,"normalMap",a.normalTexture)),o.normalScale=new THREE.Vector2(1,1),void 0!==a.normalTexture.scale&&o.normalScale.set(a.normalTexture.scale,a.normalTexture.scale)),void 0!==a.occlusionTexture&&t!==THREE.MeshBasicMaterial&&(c.push(this.assignTexture(o,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(o.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&t!==THREE.MeshBasicMaterial&&(o.emissive=(new THREE.Color).fromArray(a.emissiveFactor)),void 0!==a.emissiveTexture&&t!==THREE.MeshBasicMaterial&&c.push(this.assignTexture(o,"emissiveMap",a.emissiveTexture)),Promise.all(c).then((function(){var e;return e=t===THREE.ShaderMaterial?i[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(o):new t(o),void 0!==a.name&&(e.name=a.name),e.map&&(e.map.encoding=THREE.sRGBEncoding),e.emissiveMap&&(e.emissiveMap.encoding=THREE.sRGBEncoding),e.specularMap&&(e.specularMap.encoding=THREE.sRGBEncoding),e.map&&e.map===e.emissiveMap&&(e.transparent||e.alphaTest>0)&&(e.map.format=THREE.RGBAFormat),B(e,a),a.extensions&&I(i,e,a),e}))},F.prototype.loadGeometries=function(e){var t=this,r=this.extensions,i=this.primitiveCache;function a(e){return r[n.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return U(n,e,t)}))}for(var o,s,c=[],l=0,u=e.length;l<u;l++){var h,d=e[l],p=(s=void 0,(s=(o=d).extensions&&o.extensions[n.KHR_DRACO_MESH_COMPRESSION])?"draco:"+s.bufferView+":"+s.indices+":"+H(s.attributes):o.indices+":"+H(o.attributes)+":"+o.mode),f=i[p];if(f)c.push(f.promise);else h=d.extensions&&d.extensions[n.KHR_DRACO_MESH_COMPRESSION]?a(d):U(new THREE.BufferGeometry,d,t),i[p]={primitive:d,promise:h},c.push(h)}return Promise.all(c)},F.prototype.loadMesh=function(e){for(var t=this,n=this.json.meshes[e],r=n.primitives,i=[],a=0,o=r.length;a<o;a++){var s=void 0===r[a].material?f=f||new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:THREE.FrontSide}):this.getDependency("material",r[a].material);i.push(s)}return Promise.all(i).then((function(i){return t.loadGeometries(r).then((function(a){for(var o=[],s=0,c=a.length;s<c;s++){var l,u=a[s],h=r[s],d=i[s];if(h.mode===b||h.mode===x||h.mode===w||void 0===h.mode)!0!==(l=!0===n.isSkinnedMesh?new THREE.SkinnedMesh(u,d):new THREE.Mesh(u,d)).isSkinnedMesh||l.geometry.attributes.skinWeight.normalized||l.normalizeSkinWeights(),h.mode===x?l.drawMode=THREE.TriangleStripDrawMode:h.mode===w&&(l.drawMode=THREE.TriangleFanDrawMode);else if(h.mode===g)l=new THREE.LineSegments(u,d);else if(h.mode===y)l=new THREE.Line(u,d);else if(h.mode===v)l=new THREE.LineLoop(u,d);else{if(h.mode!==m)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+h.mode);l=new THREE.Points(u,d)}Object.keys(l.geometry.morphAttributes).length>0&&k(l,n),l.name=n.name||"mesh_"+e,a.length>1&&(l.name+="_"+s),B(l,n),t.assignFinalMaterial(l),o.push(l)}if(1===o.length)return o[0];var p=new THREE.Group;for(s=0,c=o.length;s<c;s++)p.add(o[s]);return p}))}))},F.prototype.loadCamera=function(e){var t,n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new THREE.PerspectiveCamera(THREE.Math.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new THREE.OrthographicCamera(r.xmag/-2,r.xmag/2,r.ymag/2,r.ymag/-2,r.znear,r.zfar)),void 0!==n.name&&(t.name=n.name),B(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},F.prototype.loadSkin=function(e){var t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return n.inverseBindMatrices=e,n}))},F.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],n=[],r=[],i=[],a=[],o=[],s=0,c=t.channels.length;s<c;s++){var l=t.channels[s],u=t.samplers[l.sampler],h=l.target,d=void 0!==h.node?h.node:h.id,f=void 0!==t.parameters?t.parameters[u.input]:u.input,m=void 0!==t.parameters?t.parameters[u.output]:u.output;n.push(this.getDependency("node",d)),r.push(this.getDependency("accessor",f)),i.push(this.getDependency("accessor",m)),a.push(u),o.push(h)}return Promise.all([Promise.all(n),Promise.all(r),Promise.all(i),Promise.all(a),Promise.all(o)]).then((function(n){for(var r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],c=[],l=0,u=r.length;l<u;l++){var h=r[l],d=i[l],f=a[l],m=o[l],g=s[l];if(void 0!==h){var v;switch(h.updateMatrix(),h.matrixAutoUpdate=!0,S[g.path]){case S.weights:v=THREE.NumberKeyframeTrack;break;case S.rotation:v=THREE.QuaternionKeyframeTrack;break;case S.position:case S.scale:default:v=THREE.VectorKeyframeTrack}var y=void 0!==m.interpolation?L[m.interpolation]:THREE.InterpolateLinear,b=[];S[g.path]===S.weights?h.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&b.push(e.uuid)})):b.push(h.uuid);var x=f.array;if(f.normalized){var w;if(x.constructor===Int8Array)w=1/127;else if(x.constructor===Uint8Array)w=1/255;else if(x.constructor==Int16Array)w=1/32767;else{if(x.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");w=1/65535}for(var E=new Float32Array(x.length),M=0,A=x.length;M<A;M++)E[M]=x[M]*w;x=E}for(M=0,A=b.length;M<A;M++){var T=new v(b[M]+"."+S[g.path],d.array,x,y);"CUBICSPLINE"===m.interpolation&&(T.createInterpolant=function(e){return new p(this.times,this.values,this.getValueSize()/3,e)},T.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),c.push(T)}}}var _=void 0!==t.name?t.name:"animation_"+e;return new THREE.AnimationClip(_,void 0,c)}))},F.prototype.loadNode=function(e){var t=this.json,r=this.extensions,i=this,a=t.meshReferences,o=t.meshUses,s=t.nodes[e];return(!0===s.isBone?Promise.resolve(new THREE.Bone):void 0!==s.mesh?i.getDependency("mesh",s.mesh).then((function(e){var t;if(a[s.mesh]>1){var n=o[s.mesh]++;(t=e.clone()).name+="_instance_"+n,t.onBeforeRender=e.onBeforeRender;for(var r=0,i=t.children.length;r<i;r++)t.children[r].name+="_instance_"+n,t.children[r].onBeforeRender=e.children[r].onBeforeRender}else t=e;return void 0!==s.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,n=s.weights.length;t<n;t++)e.morphTargetInfluences[t]=s.weights[t]})),t})):void 0!==s.camera?i.getDependency("camera",s.camera):s.extensions&&s.extensions[n.KHR_LIGHTS_PUNCTUAL]&&void 0!==s.extensions[n.KHR_LIGHTS_PUNCTUAL].light?i.getDependency("light",s.extensions[n.KHR_LIGHTS_PUNCTUAL].light):Promise.resolve(new THREE.Object3D)).then((function(e){if(void 0!==s.name&&(e.userData.name=s.name,e.name=THREE.PropertyBinding.sanitizeNodeName(s.name)),B(e,s),s.extensions&&I(r,e,s),void 0!==s.matrix){var t=new THREE.Matrix4;t.fromArray(s.matrix),e.applyMatrix(t)}else void 0!==s.translation&&e.position.fromArray(s.translation),void 0!==s.rotation&&e.quaternion.fromArray(s.rotation),void 0!==s.scale&&e.scale.fromArray(s.scale);return e}))},F.prototype.loadScene=function(){function e(t,n,r,i){var a=r.nodes[t];return i.getDependency("node",t).then((function(e){return void 0===a.skin?e:i.getDependency("skin",a.skin).then((function(e){for(var n=[],r=0,a=(t=e).joints.length;r<a;r++)n.push(i.getDependency("node",t.joints[r]));return Promise.all(n)})).then((function(n){for(var r=!0===e.isGroup?e.children:[e],i=0,a=r.length;i<a;i++){for(var o=r[i],s=[],c=[],l=0,u=n.length;l<u;l++){var h=n[l];if(h){s.push(h);var d=new THREE.Matrix4;void 0!==t.inverseBindMatrices&&d.fromArray(t.inverseBindMatrices.array,16*l),c.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[l])}o.bind(new THREE.Skeleton(s,c),o.matrixWorld)}return e}));var t})).then((function(t){n.add(t);var o=[];if(a.children)for(var s=a.children,c=0,l=s.length;c<l;c++){var u=s[c];o.push(e(u,t,r,i))}return Promise.all(o)}))}return function(t){var n=this.json,r=this.extensions,i=this.json.scenes[t],a=new THREE.Scene;void 0!==i.name&&(a.name=i.name),B(a,i),i.extensions&&I(r,a,i);for(var o=i.nodes||[],s=[],c=0,l=o.length;c<l;c++)s.push(e(o[c],a,n,this));return Promise.all(s).then((function(){return a}))}}(),e}()},287:function(e,t){e.exports=[]},313:function(e,t,n){"use strict";const r=t.TYPE={BOX:"box",CYLINDER:"cylinder",SPHERE:"sphere",CAPSULE:"capsule",CONE:"cone",HULL:"hull",HACD:"hacd",VHACD:"vhacd",MESH:"mesh",HEIGHTFIELD:"heightfield"},i=t.FIT={ALL:"all",MANUAL:"manual"},a=(t.HEIGHTFIELD_DATA_TYPE={short:"short",float:"float"},THREE.Object3D.prototype.hasOwnProperty("updateMatrices"));function o(e){e.fit=e.hasOwnProperty("fit")?e.fit:i.ALL,e.type=e.type||r.HULL,e.minHalfExtent=e.hasOwnProperty("minHalfExtent")?e.minHalfExtent:0,e.maxHalfExtent=e.hasOwnProperty("maxHalfExtent")?e.maxHalfExtent:Number.POSITIVE_INFINITY,e.cylinderAxis=e.cylinderAxis||"y",e.margin=e.hasOwnProperty("margin")?e.margin:.01,e.includeInvisible=!!e.hasOwnProperty("includeInvisible")&&e.includeInvisible,e.offset||(e.offset=new THREE.Vector3),e.orientation||(e.orientation=new THREE.Quaternion)}t.createCollisionShapes=function(e,t){switch(t.type){case r.BOX:return[this.createBoxShape(e,t)];case r.CYLINDER:return[this.createCylinderShape(e,t)];case r.CAPSULE:return[this.createCapsuleShape(e,t)];case r.CONE:return[this.createConeShape(e,t)];case r.SPHERE:return[this.createSphereShape(e,t)];case r.HULL:return[this.createHullShape(e,t)];case r.HACD:return this.createHACDShapes(e,t);case r.VHACD:return this.createVHACDShapes(e,t);case r.MESH:return[this.createTriMeshShape(e,t)];case r.HEIGHTFIELD:return[this.createHeightfieldTerrainShape(e,t)];default:return console.warn(t.type+" is not currently supported"),[]}},t.createBoxShape=function(e,t){t.type=r.BOX,o(t),t.fit===i.ALL&&(t.halfExtents=h(e,d(e,t),t.minHalfExtent,t.maxHalfExtent));const n=new Ammo.btVector3(t.halfExtents.x,t.halfExtents.y,t.halfExtents.z),a=new Ammo.btBoxShape(n);return Ammo.destroy(n),s(a,t,l(e,t)),a},t.createCylinderShape=function(e,t){t.type=r.CYLINDER,o(t),t.fit===i.ALL&&(t.halfExtents=h(e,d(e,t),t.minHalfExtent,t.maxHalfExtent));const n=new Ammo.btVector3(t.halfExtents.x,t.halfExtents.y,t.halfExtents.z),a=(()=>{switch(t.cylinderAxis){case"y":return new Ammo.btCylinderShape(n);case"x":return new Ammo.btCylinderShapeX(n);case"z":return new Ammo.btCylinderShapeZ(n)}return null})();return Ammo.destroy(n),s(a,t,l(e,t)),a},t.createCapsuleShape=function(e,t){t.type=r.CAPSULE,o(t),t.fit===i.ALL&&(t.halfExtents=h(e,d(e,t),t.minHalfExtent,t.maxHalfExtent));const{x:n,y:a,z:c}=t.halfExtents,u=(()=>{switch(t.cylinderAxis){case"y":return new Ammo.btCapsuleShape(Math.max(n,c),2*a);case"x":return new Ammo.btCapsuleShapeX(Math.max(a,c),2*n);case"z":return new Ammo.btCapsuleShapeZ(Math.max(n,a),2*c)}return null})();return s(u,t,l(e,t)),u},t.createConeShape=function(e,t){t.type=r.CONE,o(t),t.fit===i.ALL&&(t.halfExtents=h(e,d(e,t),t.minHalfExtent,t.maxHalfExtent));const{x:n,y:a,z:c}=t.halfExtents,u=(()=>{switch(t.cylinderAxis){case"y":return new Ammo.btConeShape(Math.max(n,c),2*a);case"x":return new Ammo.btConeShapeX(Math.max(a,c),2*n);case"z":return new Ammo.btConeShapeZ(Math.max(n,a),2*c)}return null})();return s(u,t,l(e,t)),u},t.createSphereShape=function(e,t){let n;t.type=r.SPHERE,o(t),n=t.fit!==i.MANUAL||isNaN(t.sphereRadius)?u(e,t,d(e,t)):t.sphereRadius;const a=new Ammo.btSphereShape(n);return s(a,t,l(e,t)),a},t.createHullShape=function(){const e=new THREE.Vector3,t=new THREE.Vector3;return function(n,a){if(a.type=r.HULL,o(a),a.fit===i.MANUAL)return console.warn("cannot use fit: manual with type: hull"),null;const u=d(n,a),h=new Ammo.btVector3,p=new Ammo.btConvexHullShape;p.setMargin(a.margin),t.addVectors(u.max,u.min).multiplyScalar(.5);let f=0;c(n,a,e=>{f+=e.attributes.position.array.length/3});const m=a.hullMaxVertices||1e5;f>m&&console.warn(`too many vertices for hull shape; sampling ~${m} from ~${f} vertices`);const g=Math.min(1,m/f);c(n,a,(n,r)=>{const i=n.attributes.position.array;for(let n=0;n<i.length;n+=3)Math.random()<=g&&(e.set(i[n],i[n+1],i[n+2]).applyMatrix4(r).sub(t),h.setValue(e.x,e.y,e.z),p.addPoint(h,n===i.length-3))});let v=p;if(p.getNumVertices()>=100){const e=new Ammo.btShapeHull(p);e.buildHull(a.margin),Ammo.destroy(p),v=new Ammo.btConvexHullShape(Ammo.getPointer(e.getVertexPointer()),e.numVertices()),Ammo.destroy(e)}return Ammo.destroy(h),s(v,a,l(n,a)),v}}(),t.createHACDShapes=function(){const e=new THREE.Vector3,t=new THREE.Vector3;return function(n,a){if(a.type=r.HACD,o(a),a.fit===i.MANUAL)return console.warn("cannot use fit: manual with type: hacd"),[];if(!Ammo.hasOwnProperty("HACD"))return console.warn("HACD unavailable in included build of Ammo.js. Visit https://github.com/mozillareality/ammo.js for the latest version."),[];const u=d(n),h=l(n,a);let p=0,f=0;t.addVectors(u.max,u.min).multiplyScalar(.5),c(n,a,e=>{p+=e.attributes.position.array.length/3,e.index?f+=e.index.array.length/3:f+=e.attributes.position.array.length/9});const m=new Ammo.HACD;a.hasOwnProperty("compacityWeight")&&m.SetCompacityWeight(a.compacityWeight),a.hasOwnProperty("volumeWeight")&&m.SetVolumeWeight(a.volumeWeight),a.hasOwnProperty("nClusters")&&m.SetNClusters(a.nClusters),a.hasOwnProperty("nVerticesPerCH")&&m.SetNVerticesPerCH(a.nVerticesPerCH),a.hasOwnProperty("concavity")&&m.SetConcavity(a.concavity);const g=Ammo._malloc(3*p*8),v=Ammo._malloc(3*f*4);m.SetPoints(g),m.SetTriangles(v),m.SetNPoints(p),m.SetNTriangles(f);const y=g/8,b=v/4;c(n,a,(n,r)=>{const i=n.attributes.position.array,a=n.index?n.index.array:null;for(let n=0;n<i.length;n+=3)e.set(i[n+0],i[n+1],i[n+2]).applyMatrix4(r).sub(t),Ammo.HEAPF64[y+n+0]=e.x,Ammo.HEAPF64[y+n+1]=e.y,Ammo.HEAPF64[y+n+2]=e.z;if(a)for(let e=0;e<a.length;e++)Ammo.HEAP32[b+e]=a[e];else for(let e=0;e<i.length/3;e++)Ammo.HEAP32[b+e]=e}),m.Compute(),Ammo._free(g),Ammo._free(v);const x=m.GetNClusters(),w=[];for(let e=0;e<x;e++){const t=new Ammo.btConvexHullShape;t.setMargin(a.margin);const n=m.GetNPointsCH(e),r=m.GetNTrianglesCH(e),i=Ammo._malloc(3*n*8),o=Ammo._malloc(3*r*4);m.GetCH(e,i,o);const c=i/8;for(let e=0;e<n;e++){const r=new Ammo.btVector3,i=Ammo.HEAPF64[c+3*e+0],a=Ammo.HEAPF64[c+3*e+1],o=Ammo.HEAPF64[c+3*e+2];r.setValue(i,a,o),t.addPoint(r,e===n-1),Ammo.destroy(r)}s(t,a,h),w.push(t)}return w}}(),t.createVHACDShapes=function(){const e=new THREE.Vector3,t=new THREE.Vector3;return function(n,a){if(a.type=r.VHACD,o(a),a.fit===i.MANUAL)return console.warn("cannot use fit: manual with type: vhacd"),[];if(!Ammo.hasOwnProperty("VHACD"))return console.warn("VHACD unavailable in included build of Ammo.js. Visit https://github.com/mozillareality/ammo.js for the latest version."),[];const u=d(n,a),h=l(n,a);let p=0,f=0;t.addVectors(u.max,u.min).multiplyScalar(.5),c(n,a,e=>{p+=e.attributes.position.count,e.index?f+=e.index.count/3:f+=e.attributes.position.count/3});const m=new Ammo.VHACD,g=new Ammo.Parameters;a.hasOwnProperty("resolution")&&g.set_m_resolution(a.resolution),a.hasOwnProperty("depth")&&g.set_m_depth(a.depth),a.hasOwnProperty("concavity")&&g.set_m_concavity(a.concavity),a.hasOwnProperty("planeDownsampling")&&g.set_m_planeDownsampling(a.planeDownsampling),a.hasOwnProperty("convexhullDownsampling")&&g.set_m_convexhullDownsampling(a.convexhullDownsampling),a.hasOwnProperty("alpha")&&g.set_m_alpha(a.alpha),a.hasOwnProperty("beta")&&g.set_m_beta(a.beta),a.hasOwnProperty("gamma")&&g.set_m_gamma(a.gamma),a.hasOwnProperty("pca")&&g.set_m_pca(a.pca),a.hasOwnProperty("mode")&&g.set_m_mode(a.mode),a.hasOwnProperty("maxNumVerticesPerCH")&&g.set_m_maxNumVerticesPerCH(a.maxNumVerticesPerCH),a.hasOwnProperty("minVolumePerCH")&&g.set_m_minVolumePerCH(a.minVolumePerCH),a.hasOwnProperty("convexhullApproximation")&&g.set_m_convexhullApproximation(a.convexhullApproximation),a.hasOwnProperty("oclAcceleration")&&g.set_m_oclAcceleration(a.oclAcceleration);const v=Ammo._malloc(3*p*8),y=Ammo._malloc(3*f*4);let b=v/8,x=y/4;c(n,a,(n,r)=>{const i=n.attributes.position.array,a=n.index?n.index.array:null;for(let n=0;n<i.length;n+=3)e.set(i[n+0],i[n+1],i[n+2]).applyMatrix4(r).sub(t),Ammo.HEAPF64[b+0]=e.x,Ammo.HEAPF64[b+1]=e.y,Ammo.HEAPF64[b+2]=e.z,b+=3;if(a)for(let e=0;e<a.length;e++)Ammo.HEAP32[x]=a[e],x++;else for(let e=0;e<i.length/3;e++)Ammo.HEAP32[x]=e,x++}),m.Compute(v,3,p,y,3,f,g),Ammo._free(v),Ammo._free(y);const w=m.GetNConvexHulls(),E=[],M=new Ammo.ConvexHull;for(let e=0;e<w;e++){m.GetConvexHull(e,M);const t=M.get_m_nPoints(),n=(M.get_m_points(),new Ammo.btConvexHullShape);n.setMargin(a.margin);for(let e=0;e<t;e++){const r=new Ammo.btVector3,i=M.get_m_points(3*e+0),a=M.get_m_points(3*e+1),o=M.get_m_points(3*e+2);r.setValue(i,a,o),n.addPoint(r,e===t-1),Ammo.destroy(r)}s(n,a,h),E.push(n)}return Ammo.destroy(M),Ammo.destroy(m),E}}(),t.createTriMeshShape=function(){const e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3;return function(a,u){if(u.type=r.MESH,o(u),u.fit===i.MANUAL)return console.warn("cannot use fit: manual with type: mesh"),null;const h=l(a,u),d=new Ammo.btVector3,p=new Ammo.btVector3,f=new Ammo.btVector3,m=new Ammo.btTriangleMesh(!0,!1);c(a,u,(r,i)=>{const a=r.attributes.position.array;if(r.index)for(let o=0;o<r.index.count;o+=3){const s=3*r.index.array[o],c=3*r.index.array[o+1],l=3*r.index.array[o+2];e.set(a[s],a[s+1],a[s+2]).applyMatrix4(i),t.set(a[c],a[c+1],a[c+2]).applyMatrix4(i),n.set(a[l],a[l+1],a[l+2]).applyMatrix4(i),d.setValue(e.x,e.y,e.z),p.setValue(t.x,t.y,t.z),f.setValue(n.x,n.y,n.z),m.addTriangle(d,p,f,!1)}else for(let r=0;r<a.length;r+=9)e.set(a[r+0],a[r+1],a[r+2]).applyMatrix4(i),t.set(a[r+3],a[r+4],a[r+5]).applyMatrix4(i),n.set(a[r+6],a[r+7],a[r+8]).applyMatrix4(i),d.setValue(e.x,e.y,e.z),p.setValue(t.x,t.y,t.z),f.setValue(n.x,n.y,n.z),m.addTriangle(d,p,f,!1)});const g=new Ammo.btVector3(h.x,h.y,h.z);m.setScaling(g),Ammo.destroy(g);const v=new Ammo.btBvhTriangleMeshShape(m,!0,!0);return v.resources=[m],Ammo.destroy(d),Ammo.destroy(p),Ammo.destroy(f),s(v,u),v}}(),t.createHeightfieldTerrainShape=function(e,t){if(o(t),t.fit===i.ALL)return console.warn("cannot use fit: all with type: heightfield"),null;const n=t.heightfieldDistance||1,r=t.heightfieldData||[],a=t.heightScale||0,c=t.hasOwnProperty("upAxis")?t.upAxis:1,l=(()=>{switch(t.heightDataType){case"short":return Ammo.PHY_SHORT;case"float":default:return Ammo.PHY_FLOAT}})(),u=!t.hasOwnProperty("flipQuadEdges")||t.flipQuadEdges,h=r.length,d=h>0?r[0].length:0,p=Ammo._malloc(h*d*4),f=p/4;let m=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,v=0;for(let e=0;e<h;e++)for(let t=0;t<d;t++){const n=r[e][t];Ammo.HEAPF32[f+v]=n,v++,m=Math.min(m,n),g=Math.max(g,n)}const y=new Ammo.btHeightfieldTerrainShape(d,h,p,a,m,g,c,l,u),b=new Ammo.btVector3(n,1,n);return y.setLocalScaling(b),Ammo.destroy(b),y.heightfieldData=p,s(y,t),y};const s=function(e,t,n){e.type=t.type,e.setMargin(t.margin),e.destroy=()=>{for(let t of e.resources||[])Ammo.destroy(t);e.heightfieldData&&Ammo._free(e.heightfieldData),Ammo.destroy(e)};const r=new Ammo.btTransform,i=new Ammo.btQuaternion;if(r.setIdentity(),r.getOrigin().setValue(t.offset.x,t.offset.y,t.offset.z),i.setValue(t.orientation.x,t.orientation.y,t.orientation.z,t.orientation.w),r.setRotation(i),Ammo.destroy(i),n){const t=new Ammo.btVector3(n.x,n.y,n.z);e.setLocalScaling(t),Ammo.destroy(t)}e.localTransform=r},c=function(){const e=new THREE.Matrix4,t=new THREE.Matrix4,n=new THREE.BufferGeometry;return function(r,i,o){t.getInverse(r.matrixWorld),r.traverse(s=>{!s.isMesh||THREE.Sky&&s.__proto__==THREE.Sky.prototype||!(i.includeInvisible||s.el&&s.el.object3D.visible||s.visible)||(s===r?e.identity():(a&&s.updateMatrices(),e.multiplyMatrices(t,s.matrixWorld)),o(s.geometry.isBufferGeometry?s.geometry:n.fromGeometry(s.geometry),e))})}}(),l=function(e,t){const n=new THREE.Vector3(1,1,1);return t.fit===i.ALL&&n.setFromMatrixScale(e.matrixWorld),n},u=function(){const e=new THREE.Vector3,t=new THREE.Vector3;return function(n,r,i){let a=0,{x:o,y:s,z:l}=i.getCenter(t);return c(n,r,(t,n)=>{const r=t.attributes.position.array;for(let t=0;t<r.length;t+=3){e.set(r[t],r[t+1],r[t+2]).applyMatrix4(n);const i=o-e.x,c=s-e.y,u=l-e.z;a=Math.max(a,i*i+c*c+u*u)}}),Math.sqrt(a)}}(),h=function(e,t,n,r){return(new THREE.Vector3).subVectors(t.max,t.min).multiplyScalar(.5).clampScalar(n,r)},d=function(){const e=new THREE.Vector3;return function(t,n){const r=new THREE.Box3;let i=1/0,a=1/0,o=1/0,s=-1/0,l=-1/0,u=-1/0;return r.min.set(0,0,0),r.max.set(0,0,0),c(t,n,(t,n)=>{const r=t.attributes.position.array;for(let t=0;t<r.length;t+=3)e.set(r[t],r[t+1],r[t+2]).applyMatrix4(n),e.x<i&&(i=e.x),e.y<a&&(a=e.y),e.z<o&&(o=e.z),e.x>s&&(s=e.x),e.y>l&&(l=e.y),e.z>u&&(u=e.z)}),r.min.set(i,a,o),r.max.set(s,l,u),r}}()},324:function(e,t,n){"use strict";var r=n(5),i=new r.Vector3,a=new r.Vector3,o=new r.Vector3,s=new r.Vector2,c=new r.Vector2,l=new r.Vector2,u=new r.Vector3,h=new r.Vector3;function d(e,t,n,d,p,f,m,g){i.fromBufferAttribute(d,f),a.fromBufferAttribute(d,m),o.fromBufferAttribute(d,g);var v=function(e,t,n,i,a,o,s,c){if(null===(t.side===r.BackSide?i.intersectTriangle(s,o,a,!0,c):i.intersectTriangle(a,o,s,t.side!==r.DoubleSide,c)))return null;h.copy(c),h.applyMatrix4(e.matrixWorld);var l=n.ray.origin.distanceTo(h);return l<n.near||l>n.far?null:{distance:l,point:h.clone(),object:e}}(e,e.material,t,n,i,a,o,u);if(v){p&&(s.fromBufferAttribute(p,f),c.fromBufferAttribute(p,m),l.fromBufferAttribute(p,g),v.uv=r.Triangle.getUV(u,i,a,o,s,c,l,new r.Vector2));var y=new r.Vector3;v.face=new r.Face3(f,m,g,r.Triangle.getNormal(i,a,o,y)),v.faceIndex=f}return v}function p(e,t,n,r,i,a){const o=3*i,s=t.index.getX(o),c=t.index.getX(o+1),l=t.index.getX(o+2),u=d(e,n,r,t.attributes.position,t.attributes.uv,s,c,l);return u?(u.faceIndex=i,a&&a.push(u),u):null}function f(e,t){return t.min.x=e[0],t.min.y=e[1],t.min.z=e[2],t.max.x=e[3],t.max.y=e[4],t.max.z=e[5],t}function m(e){let t=-1,n=-1/0;for(let r=0;r<3;r++){const i=e[r+3]-e[r];i>n&&(n=i,t=r)}return t}class g{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let n=1/0,r=-1/0;for(let i=0,a=e.length;i<a;i++){const a=e[i][t];n=Math.min(a,n),r=Math.max(a,r)}this.min=n,this.max=r}setFromPoints(e,t){let n=1/0,r=-1/0;for(let i=0,a=t.length;i<a;i++){const a=t[i],o=e.dot(a);n=Math.min(o,n),r=Math.max(o,r)}this.min=n,this.max=r}isSeparated(e){return this.min>e.max||e.min>this.max}}g.prototype.setFromBox=function(){const e=new r.Vector3;return function(t,n){const r=n.min,i=n.max;let a=1/0,o=-1/0;for(let n=0;n<=1;n++)for(let s=0;s<=1;s++)for(let c=0;c<=1;c++){e.x=r.x*n+i.x*(1-n),e.y=r.y*s+i.y*(1-s),e.z=r.z*c+i.z*(1-c);const l=t.dot(e);a=Math.min(l,a),o=Math.max(l,o)}this.min=a,this.max=o}}();!function(){const e=new g}();const v=function(){const e=new r.Vector3,t=new r.Vector3,n=new r.Vector3;return function(r,i,a){const o=r.start,s=e,c=i.start,l=t;n.subVectors(o,c),e.subVectors(r.end,i.start),t.subVectors(i.end,i.start);const u=n.dot(l),h=l.dot(s),d=l.dot(l),p=n.dot(s),f=s.dot(s)*d-h*h;let m,g;m=0!==f?(u*h-p*d)/f:0,g=(u+m*h)/d,a.x=m,a.y=g}}(),y=function(){const e=new r.Vector2,t=new r.Vector3,n=new r.Vector3;return function(r,i,a,o){v(r,i,e);let s=e.x,c=e.y;if(s>=0&&s<=1&&c>=0&&c<=1)return r.at(s,a),void i.at(c,o);if(s>=0&&s<=1)return c<0?i.at(0,o):i.at(1,o),void r.closestPointToPoint(o,!0,a);if(c>=0&&c<=1)return s<0?r.at(0,a):r.at(1,a),void i.closestPointToPoint(a,!0,o);{let e,l;e=s<0?r.start:r.end,l=c<0?i.start:i.end;const u=t,h=n;return r.closestPointToPoint(l,!0,t),i.closestPointToPoint(e,!0,n),u.distanceToSquared(l)<=h.distanceToSquared(e)?(a.copy(u),void o.copy(l)):(a.copy(e),void o.copy(h))}}}(),b=function(){const e=new r.Vector3,t=new r.Vector3,n=new r.Plane,i=new r.Line3;return function(r,a){const{radius:o,center:s}=r,{a:c,b:l,c:u}=a;if(i.start=c,i.end=l,i.closestPointToPoint(s,!0,e).distanceTo(s)<=o)return!0;if(i.start=c,i.end=u,i.closestPointToPoint(s,!0,e).distanceTo(s)<=o)return!0;if(i.start=l,i.end=u,i.closestPointToPoint(s,!0,e).distanceTo(s)<=o)return!0;const h=a.getPlane(n);if(Math.abs(h.distanceToPoint(s))<=o){const e=h.projectPoint(s,t);if(a.containsPoint(e))return!0}return!1}}();class x extends r.Triangle{constructor(...e){super(...e),this.isSeparatingAxisTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new r.Vector3),this.satBounds=new Array(4).fill().map(()=>new g),this.points=[this.a,this.b,this.c],this.sphere=new r.Sphere}}x.prototype.update=function(){const e=new Array(3);return function(){const t=this.a,n=this.b,r=this.c;e[0]=this.a,e[1]=this.b,e[2]=this.c;const i=this.satAxes,a=this.satBounds,o=i[0],s=a[0];this.getNormal(o),s.setFromPoints(o,e);const c=i[1],l=a[1];c.subVectors(t,n),l.setFromPoints(c,e);const u=i[2],h=a[2];u.subVectors(n,r),h.setFromPoints(u,e);const d=i[3],p=a[3];d.subVectors(r,t),p.setFromPoints(d,e),this.sphere.setFromPoints(this.points)}}(),x.prototype.intersectsTriangle=function(){const e=new x,t=new Array(3),n=new Array(3),i=new g,a=new g,o=new r.Vector3;return function(r){r.isSeparatingAxisTriangle||(e.copy(r),e.update(),r=e);const s=this.satBounds,c=this.satAxes;n[0]=r.a,n[1]=r.b,n[2]=r.c;for(let e=0;e<4;e++){const t=s[e],r=c[e];if(i.setFromPoints(r,n),t.isSeparated(i))return!1}const l=r.satBounds,u=r.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let e=0;e<4;e++){const n=l[e],r=u[e];if(i.setFromPoints(r,t),n.isSeparated(i))return!1}for(let e=0;e<4;e++){const r=c[e];for(let e=0;e<4;e++){const s=u[e];if(o.crossVectors(r,s),i.setFromPoints(o,t),a.setFromPoints(o,n),i.isSeparated(a))return!1}}return!0}}(),x.prototype.distanceToPoint=function(){const e=new r.Vector3;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),x.prototype.distanceToTriangle=function(){const e=new r.Vector3,t=new r.Vector3,n=["a","b","c"],i=new r.Line3,a=new r.Line3;return function(r,o=null,s=null){if(this.intersectsTriangle(r))return(o||s)&&(this.getMidpoint(e),r.closestPointToPoint(e,t),this.closestPointToPoint(t,e),o&&o.copy(e),s&&s.copy(t)),0;let c=1/0;for(let t=0;t<3;t++){let i;const a=n[t],l=r[a];this.closestPointToPoint(l,e),i=l.distanceToSquared(e),i<c&&(c=i,o&&o.copy(e),s&&s.copy(l));const u=this[a];r.closestPointToPoint(u,e),i=u.distanceToSquared(e),i<c&&(c=i,o&&o.copy(u),s&&s.copy(e))}for(let l=0;l<3;l++){const u=n[l],h=n[(l+1)%3];i.set(this[u],this[h]);for(let l=0;l<3;l++){const u=n[l],h=n[(l+1)%3];a.set(r[u],r[h]),y(i,a,e,t);const d=e.distanceToSquared(t);d<c&&(c=d,o&&o.copy(e),s&&s.copy(t))}}return Math.sqrt(c)}}();class w extends r.Box3{constructor(...e){super(...e),this.isOrientedBox=!0,this.matrix=new r.Matrix4,this.invMatrix=new r.Matrix4,this.points=new Array(8).fill().map(()=>new r.Vector3),this.satAxes=new Array(3).fill().map(()=>new r.Vector3),this.satBounds=new Array(3).fill().map(()=>new g),this.alignedSatBounds=new Array(3).fill().map(()=>new g),this.sphere=new r.Sphere}set(e,t,n){super.set(e,t),this.matrix=n}copy(e){super.copy(e),this.matrix.copy(e.matrix)}}w.prototype.update=function(){const e=this.matrix,t=this.min,n=this.max,r=this.points;for(let i=0;i<=1;i++)for(let a=0;a<=1;a++)for(let o=0;o<=1;o++){const s=r[1*i|2*a|4*o];s.x=i?n.x:t.x,s.y=a?n.y:t.y,s.z=o?n.z:t.z,s.applyMatrix4(e)}this.sphere.setFromPoints(this.points);const i=this.satBounds,a=this.satAxes,o=r[0];for(let e=0;e<3;e++){const t=a[e],n=i[e],s=r[1<<e];t.subVectors(o,s),n.setFromPoints(t,r)}const s=this.alignedSatBounds;s[0].setFromPointsField(r,"x"),s[1].setFromPointsField(r,"y"),s[2].setFromPointsField(r,"z"),this.invMatrix.getInverse(this.matrix)},w.prototype.intersectsBox=function(){const e=new g;return function(t){if(!t.intersectsSphere(this.sphere))return!1;const n=t.min,r=t.max,i=this.satBounds,a=this.satAxes,o=this.alignedSatBounds;if(e.min=n.x,e.max=r.x,o[0].isSeparated(e))return!1;if(e.min=n.y,e.max=r.y,o[1].isSeparated(e))return!1;if(e.min=n.z,e.max=r.z,o[2].isSeparated(e))return!1;for(let n=0;n<3;n++){const r=a[n],o=i[n];if(e.setFromBox(r,t),o.isSeparated(e))return!1}return!0}}(),w.prototype.intersectsTriangle=function(){const e=new x,t=new Array(3),n=new g,i=new g,a=new r.Vector3;return function(r){r.isSeparatingAxisTriangle||(e.copy(r),e.update(),r=e);const o=this.satBounds,s=this.satAxes;t[0]=r.a,t[1]=r.b,t[2]=r.c;for(let e=0;e<3;e++){const r=o[e],i=s[e];if(n.setFromPoints(i,t),r.isSeparated(n))return!1}const c=r.satBounds,l=r.satAxes,u=this.points;for(let e=0;e<3;e++){const t=c[e],r=l[e];if(n.setFromPoints(r,u),t.isSeparated(n))return!1}for(let e=0;e<3;e++){const r=s[e];for(let e=0;e<4;e++){const o=l[e];if(a.crossVectors(r,o),n.setFromPoints(a,t),i.setFromPoints(a,u),n.isSeparated(i))return!1}}return!0}}(),w.prototype.closestPointToPoint=function(e,t){return t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t},w.prototype.distanceToPoint=function(){const e=new r.Vector3;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),w.prototype.distanceToBox=function(){const e=["x","y","z"],t=new Array(12).fill().map(()=>new r.Line3),n=new Array(12).fill().map(()=>new r.Line3),i=new r.Vector3,a=new r.Vector3;return function(r,o=0,s=null,c=null){if(this.intersectsBox(r))return(s||c)&&(r.getCenter(a),this.closestPointToPoint(a,i),r.closestPointToPoint(i,a),s&&s.copy(i),c&&c.copy(a)),0;const l=o*o,u=r.min,h=r.max,d=this.points;let p=1/0;for(let e=0;e<8;e++){const t=d[e];a.copy(t).clamp(u,h);const n=t.distanceToSquared(a);if(n<p&&(p=n,s&&s.copy(t),c&&c.copy(a),n<l))return Math.sqrt(n)}let f=0;for(let r=0;r<3;r++)for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){const o=(r+1)%3,s=(r+2)%3,c=1<<r|i<<o|a<<s,l=d[i<<o|a<<s],p=d[c];t[f].set(l,p);const m=e[r],g=e[o],v=e[s],y=n[f],b=y.start,x=y.end;b[m]=u[m],b[g]=i?u[g]:h[g],b[v]=a?u[v]:h[g],x[m]=h[m],x[g]=i?u[g]:h[g],x[v]=a?u[v]:h[g],f++}for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)for(let n=0;n<=1;n++){a.x=e?h.x:u.x,a.y=t?h.y:u.y,a.z=n?h.z:u.z,this.closestPointToPoint(a,i);const r=a.distanceToSquared(i);if(r<p&&(p=r,s&&s.copy(i),c&&c.copy(a),r<l))return Math.sqrt(r)}for(let e=0;e<12;e++){const r=t[e];for(let e=0;e<12;e++){const t=n[e];y(r,t,i,a);const o=i.distanceToSquared(a);if(o<p&&(p=o,s&&s.copy(i),c&&c.copy(a),o<l))return Math.sqrt(o)}}return Math.sqrt(p)}}();const E=new r.Box3,M=new r.Vector3,A=["x","y","z"];function T(e,t,n,r){const i=e.a,a=e.b,o=e.c;let s=n.getX(t);i.x=r.getX(s),i.y=r.getY(s),i.z=r.getZ(s),s=n.getX(t+1),a.x=r.getX(s),a.y=r.getY(s),a.z=r.getZ(s),s=n.getX(t+2),o.x=r.getX(s),o.y=r.getY(s),o.z=r.getZ(s)}class _{constructor(){}intersectRay(e,t){return f(this.boundingData,E),e.intersectBox(E,t)}raycast(e,t,n,r){this.count?function(e,t,n,r,i,a,o){for(let s=i,c=i+a;s<c;s++)p(e,t,n,r,s,o)}(e,e.geometry,t,n,this.offset,this.count,r):(this.left.intersectRay(n,M)&&this.left.raycast(e,t,n,r),this.right.intersectRay(n,M)&&this.right.raycast(e,t,n,r))}raycastFirst(e,t,n){if(this.count)return function(e,t,n,r,i,a){let o=1/0,s=null;for(let c=i,l=i+a;c<l;c++){const i=p(e,t,n,r,c);i&&i.distance<o&&(s=i,o=i.distance)}return s}(e,e.geometry,t,n,this.offset,this.count);{const r=this.splitAxis,i=A[r];let a,o;n.direction[i]>=0?(a=this.left,o=this.right):(a=this.right,o=this.left);const s=a.intersectRay(n,M)?a.raycastFirst(e,t,n):null;if(s){const e=n.origin[i],t=e-s.point[i],a=e-o.boundingData[r],c=e-o.boundingData[r+3],l=t*t;if(l<=a*a&&l<=c*c)return s}const c=o.intersectRay(n,M)?o.raycastFirst(e,t,n):null;return s&&c?s.distance<=c.distance?s:c:s||c||null}}}_.prototype.shapecast=function(){const e=new x,t=new r.Box3,n=new r.Box3;return function(r,i,a=null,o=null){if(this.count&&a){const t=r.geometry,n=t.index,i=t.attributes.position,o=this.offset;for(let t=3*o,r=3*(this.count+o);t<r;t+=3)if(T(e,t,n,i),e.update(),a(e,t,t+1,t+2))return!0;return!1}{const e=this.left,s=this.right;let c,l,u,h,d=e,p=s;if(o&&(u=t,h=n,f(d.boundingData,u),f(p.boundingData,h),c=o(u),l=o(h),l<c)){d=s,p=e;const t=c;c=l,l=t;const n=u;u=h,h=n}return u||(u=t,f(d.boundingData,u)),i(u,!!d.count,c,d)&&d.shapecast(r,i,a,o)?!0:(h||(h=n,f(p.boundingData,h)),!(!i(h,!!p.count,l,p)||!p.shapecast(r,i,a,o)))}}}(),_.prototype.intersectsGeometry=function(){const e=new x,t=new x,n=new r.Mesh,i=new r.Matrix4,a=new w,o=new w;return function(r,s,c,l=null){if(null===l&&(s.boundingBox||s.computeBoundingBox(),a.set(s.boundingBox.min,s.boundingBox.max,c),a.update(),l=a),!this.count){const e=this.left,t=this.right;return f(e.boundingData,E),l.intersectsBox(E)&&e.intersectsGeometry(r,s,c,l)?!0:(f(t.boundingData,E),!(!l.intersectsBox(E)||!t.intersectsGeometry(r,s,c,l)))}{const a=r.geometry,l=a.index,u=a.attributes.position,h=s.index,d=s.attributes.position,p=this.offset,m=this.count;if(i.getInverse(c),s.boundsTree){f(this.boundingData,o),o.matrix.copy(i),o.update(),n.geometry=s;const e=s.boundsTree.shapecast(n,e=>o.intersectsBox(e),(function(e){e.a.applyMatrix4(c),e.b.applyMatrix4(c),e.c.applyMatrix4(c),e.update();for(let n=3*p,r=3*(m+p);n<r;n+=3)if(T(t,n,l,u),t.update(),e.intersectsTriangle(t))return!0;return!1}));return n.geometry=null,e}for(let n=3*p,r=m+3*p;n<r;n+=3){T(e,n,l,u),e.a.applyMatrix4(i),e.b.applyMatrix4(i),e.c.applyMatrix4(i),e.update();for(let n=0,r=h.count;n<r;n+=3)if(T(t,n,h,d),t.update(),e.intersectsTriangle(t))return!0}}}}(),_.prototype.intersectsBox=function(){const e=new w;return function(t,n,r){return e.set(n.min,n.max,r),e.update(),this.shapecast(t,t=>e.intersectsBox(t),t=>e.intersectsTriangle(t))}}(),_.prototype.intersectsSphere=function(e,t){return this.shapecast(e,e=>t.intersectsBox(e),e=>b(t,e))},_.prototype.closestPointToPoint=function(){const e=new r.Vector3;return function(t,n,r=null,i=0,a=1/0){let o=1/0;return this.shapecast(t,(e,t,n)=>n<o&&n<a,t=>{t.closestPointToPoint(n,e);const a=n.distanceTo(e);return a<o&&(r&&r.copy(e),o=a),a<i},e=>e.distanceToPoint(n)),o}}(),_.prototype.closestPointToGeometry=function(){const e=new x,t=new w,n=new r.Vector3,i=new r.Vector3;return function(r,a,o,s=null,c=null,l=0,u=1/0){a.boundingBox||a.computeBoundingBox(),t.set(a.boundingBox.min,a.boundingBox.max,o),t.update();const h=a.attributes.position,d=a.index;let p,f;s&&(p=n),c&&(f=i);let m=1/0;return this.shapecast(r,(e,t,n)=>n<m&&n<u,t=>{const n=t.sphere;for(let r=0,i=d.count;r<i;r+=3){T(e,r,d,h),e.a.applyMatrix4(o),e.b.applyMatrix4(o),e.c.applyMatrix4(o),e.sphere.setFromPoints(e.points);const i=e.sphere;if(i.center.distanceTo(n.center)-i.radius-n.radius>m)continue;e.update();const a=t.distanceToTriangle(e,p,f);if(a<m&&(s&&s.copy(p),c&&c.copy(f),m=a),a<l)return!0}return!1},e=>t.distanceToBox(e,Math.min(m,u))),m}}();const S=["x","y","z"];const L=new r.Box3;class C{constructor(e,t){if(this.geo=e,this.options=t,this.bounds=function(e){const t=e.attributes.position.array,n=e.index.array,r=n.length/3,i=new Float32Array(6*r);for(let e=0;e<r;e++){const r=3*n[3*e+0],a=3*n[3*e+1],o=3*n[3*e+2];for(let n=0;n<3;n++){const s=t[r+n],c=t[a+n],l=t[o+n],u=Math.min(s,c,l),h=(Math.max(s,c,l)-u)/2;i[6*e+2*n+0]=u+h,i[6*e+2*n+1]=h}}return i}(e),this.sahplanes=null,2===t.strategy){const t=e.index.count/3;this.sahplanes=[new Array(t),new Array(t),new Array(t)];for(let e=0;e<t;e++)for(let t=0;t<3;t++)this.sahplanes[t][e]={p:this.bounds[6*e+2*t],tri:e}}}getAverage(e,t,n){let r=0;const i=this.bounds;for(let a=e,o=e+t;a<o;a++)r+=i[6*a+2*n];return r/t}getBounds(e,t,n){let r=1/0,i=1/0,a=1/0,o=-1/0,s=-1/0,c=-1/0;const l=this.bounds;for(let n=e,u=e+t;n<u;n++){const e=l[6*n+0],t=l[6*n+1];r=Math.min(r,e-t),o=Math.max(o,e+t);const u=l[6*n+2],h=l[6*n+3];i=Math.min(i,u-h),s=Math.max(s,u+h);const d=l[6*n+4],p=l[6*n+5];a=Math.min(a,d-p),c=Math.max(c,d+p)}return n[0]=r,n[1]=i,n[2]=a,n[3]=o,n[4]=s,n[5]=c,n}partition(e,t,n){let r=e,i=e+t-1;const a=n.pos,o=2*n.axis,s=this.geo.index.array,c=this.bounds,l=this.sahplanes;for(;;){for(;r<=i&&c[6*r+o]<a;)r++;for(;r<=i&&c[6*i+o]>=a;)i--;if(!(r<i))return r;for(let e=0;e<3;e++){let t=s[3*r+e];s[3*r+e]=s[3*i+e],s[3*i+e]=t;let n=c[6*r+2*e+0];c[6*r+2*e+0]=c[6*i+2*e+0],c[6*i+2*e+0]=n;let a=c[6*r+2*e+1];c[6*r+2*e+1]=c[6*i+2*e+1],c[6*i+2*e+1]=a}if(l)for(let e=0;e<3;e++){let t=l[e][r];l[e][r]=l[e][i],l[e][i]=t}r++,i--}}getOptimalSplit(e,t,n,r){let i=-1,a=0;if(0===r)i=m(e),-1!==i&&(a=(e[i+3]+e[i])/2);else if(1===r)i=m(e),-1!==i&&(a=this.getAverage(t,n,i));else if(2===r){const r=3,o=1,s=f(e,L),c=[s.max.x-s.min.x,s.max.y-s.min.y,s.max.z-s.min.z],l=2*(c[0]*c[1]+c[0]*c[2]+c[1]*c[2]),u=[[],[],[]];for(let e=t,r=t+n;e<r;e++)for(let t=0;t<3;t++)u[t].push(this.sahplanes[t][e]);u.forEach(e=>e.sort((e,t)=>e.p-t.p));const h=(e,t,n,i,a)=>r+o*(t/e*n+i/e*a);i=-1;let d=o*n;for(let e=0;e<3;e++){const t=(e+1)%3,r=(e+2)%3,o=s.min[S[e]],p=s.max[S[e]],f=u[e];let m=0,g=n;for(let n=0;n<f.length;n++){const s=f[n];m++,g--;const u=s.p-o,v=p-s.p;let y=c[t],b=c[t],x=c[r],w=c[r];const E=h(l,2*(y*x+y*u+x*u),m,2*(b*w+b*v+w*v),g);E<d&&(i=e,a=s.p,d=E)}}}return{axis:i,pos:a}}}class R{constructor(e,t={}){if(!e.isBufferGeometry)throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e.attributes.position.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the position attribute.");if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.");(t=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0},t)).strategy=Math.max(0,Math.min(2,t.strategy)),this._roots=this._buildTree(e,t)}_ensureIndex(e){if(!e.index){const t=e.attributes.position.count,n=new(t>65535?Uint32Array:Uint16Array)(t);e.setIndex(new r.BufferAttribute(n,1));for(let e=0;e<t;e++)n[e]=e}}_getRootIndexRanges(e){if(!e.groups||!e.groups.length)return[{offset:0,count:e.index.count/3}];const t=[],n=new Set;for(const t of e.groups)n.add(t.start),n.add(t.start+t.count);const r=Array.from(n.values()).sort((e,t)=>e-t);for(let e=0;e<r.length-1;e++){const n=r[e],i=r[e+1];t.push({offset:n/3,count:(i-n)/3})}return t}_buildTree(e,t){this._ensureIndex(e);const n=new C(e,t);let i=!1;const a=(e,r,o,s=0)=>{if(s>=t.maxDepth&&(i=!0),o<=t.maxLeafTris||s>=t.maxDepth)return e.offset=r,e.count=o,e;const c=n.getOptimalSplit(e.boundingData,r,o,t.strategy);if(-1===c.axis)return e.offset=r,e.count=o,e;const l=n.partition(r,o,c);if(l===r||l===r+o)e.offset=r,e.count=o;else{e.splitAxis=c.axis;const t=e.left=new _,i=r,u=l-r;t.boundingData=n.getBounds(i,u,new Float32Array(6)),a(t,i,u,s+1);const h=e.right=new _,d=l,p=o-u;h.boundingData=n.getBounds(d,p,new Float32Array(6)),a(h,d,p,s+1)}return e},o=[],s=this._getRootIndexRanges(e);if(1===s.length){const t=new _,r=s[0];null!=e.boundingBox?t.boundingData=function(e){const t=new Float32Array(6);return t[0]=e.min.x,t[1]=e.min.y,t[2]=e.min.z,t[3]=e.max.x,t[4]=e.max.y,t[5]=e.max.z,t}(e.boundingBox):t.boundingData=n.getBounds(r.offset,r.count,new Float32Array(6)),a(t,r.offset,r.count),o.push(t)}else for(let e of s){const t=new _;t.boundingData=n.getBounds(e.offset,e.count,new Float32Array(6)),a(t,e.offset,e.count),o.push(t)}if(i&&t.verbose&&(console.warn(`MeshBVH: Max depth of ${t.maxDepth} reached when generating BVH. Consider increasing maxDepth.`),console.warn(this,e)),null==e.boundingBox){const t=new r.Box3;e.boundingBox=new r.Box3;for(let n of o)e.boundingBox.union(f(n.boundingData,t))}return o}raycast(e,t,n,r){for(const i of this._roots)i.raycast(e,t,n,r)}raycastFirst(e,t,n){let r=null;for(const i of this._roots){const a=i.raycastFirst(e,t,n);null!=a&&(null==r||a.distance<r.distance)&&(r=a)}return r}intersectsGeometry(e,t,n){for(const r of this._roots)if(r.intersectsGeometry(e,t,n))return!0;return!1}shapecast(e,t,n=null,r=null){for(const i of this._roots)if(i.shapecast(e,t,n,r))return!0;return!1}intersectsBox(e,t,n){for(const r of this._roots)if(r.intersectsBox(e,t,n))return!0;return!1}intersectsSphere(e,t){for(const n of this._roots)if(n.intersectsSphere(e,t))return!0;return!1}closestPointToGeometry(e,t,n,r,i,a,o){let s=1/0;for(const c of this._roots){const l=c.closestPointToGeometry(e,t,n,r,i,a,o);if(l<s&&(s=l),l<a)return l}return s}distanceToGeometry(e,t,n,r,i){return this.closestPointToGeometry(e,t,n,null,null,r,i)}closestPointToPoint(e,t,n,r,i){let a=1/0;for(const o of this._roots){const s=o.closestPointToPoint(e,t,n,r,i);if(s<a&&(a=s),s<r)return s}return a}distanceToPoint(e,t,n,r){return this.closestPointToPoint(e,t,null,n,r)}}new r.LineBasicMaterial({color:65416,transparent:!0,opacity:.3}),(new r.Box3Helper).geometry;new r.Box3;r.Object3D;r.Object3D;n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return R}));const P=new r.Ray,O=new r.Matrix4,D=r.Mesh.prototype.raycast;function I(e,t){if(this.geometry.boundsTree){if(void 0===this.material)return;if(O.getInverse(this.matrixWorld),P.copy(e.ray).applyMatrix4(O),!0===e.firstHitOnly){const n=this.geometry.boundsTree.raycastFirst(this,e,P);n&&t.push(n)}else this.geometry.boundsTree.raycast(this,e,P,t)}else D.call(this,e,t)}},361:function(e,t,n){var r=n(99),i=n(60),a=r("utils:coordinates:warn"),o=["x","y","z","w"],s=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;e.exports.regex=s;var c=/\s+/g;function l(e){return s.test(e)}function u(e){return null!=e&&e.constructor===String?parseFloat(e,10):e}e.exports.parse=function(e,t){var n,r,a,s,l,h,d,p,f;if(e&&e instanceof Object)return h=void 0===e.x?t&&t.x:e.x,d=void 0===e.y?t&&t.y:e.y,p=void 0===e.z?t&&t.z:e.z,f=void 0===e.w?t&&t.w:e.w,null!=h&&(e.x=u(h)),null!=d&&(e.y=u(d)),null!=p&&(e.z=u(p)),null!=f&&(e.w=u(f)),e;if(null==e)return"object"==typeof t?i({},t):t;for(n=e.trim().split(c),l={},s=0;s<o.length;s++)if(a=o[s],n[s])l[a]=parseFloat(n[s],10);else{if(void 0===(r=t&&t[a]))continue;l[a]=u(r)}return l},e.exports.stringify=function(e){var t;return"object"!=typeof e?e:(t=e.x+" "+e.y,null!=e.z&&(t+=" "+e.z),null!=e.w&&(t+=" "+e.w),t)},e.exports.isCoordinates=l,e.exports.isCoordinate=function(e){return a("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`"),l(e)},e.exports.toVector3=function(e){return new THREE.Vector3(e.x,e.y,e.z)}},362:function(e,t,n){var r=n(19),i=["application/x-mpegurl","application/vnd.apple.mpegurl"],a=new Set(["emissiveMap","envMap","map","specularMap"]);function o(e,t){t&&(e.emit("materialtextureloaded",{src:t.image,texture:t}),t.image&&"VIDEO"===t.image.tagName&&(t.image.addEventListener("loadeddata",(function(){e.components&&e.components.material&&(t.needsCorrectionBGRA&&t.needsCorrectionFlipY&&-1!==["standard","flat"].indexOf(e.components.material.data.shader)&&e.setAttribute("material","shader","ios10hls"),e.emit("materialvideoloadeddata",{src:t.image,texture:t}))})),t.image.addEventListener("ended",(function(){e.emit("materialvideoended",{src:t.image,texture:t})}))))}e.exports.updateMapMaterialFromData=function(e,t,n,i){var s=n.el,c=n.material,l=s.sceneEl.systems.renderer,u=i[t];if(n.materialSrcs||(n.materialSrcs={}),!u)return delete n.materialSrcs[e],void h(null);function h(t){c[e]=t,t&&a.has(e)&&l.applyColorCorrection(t),c.needsUpdate=!0,o(s,t)}u!==n.materialSrcs[e]&&(n.materialSrcs[e]=u,u instanceof r.Texture?h(u):s.sceneEl.systems.material.loadTexture(u,{src:u,repeat:i.repeat,offset:i.offset,npot:i.npot},(function(t){if(n.materialSrcs[e]!==u)return;h(t)})))},e.exports.updateMap=function(t,n){return e.exports.updateMapMaterialFromData("map","src",t,n)},e.exports.updateDistortionMap=function(e,t,n){var r=e;"ambientOcclusion"===e&&(r="ao");var i=t.el,s=t.material,c=i.sceneEl.systems.renderer,l=n[e+"Map"],u={};if(u.src=l,u.offset=n[e+"TextureOffset"],u.repeat=n[e+"TextureRepeat"],u.wrap=n[e+"TextureWrap"],l){if(l===t[e+"TextureSrc"])return;return t[e+"TextureSrc"]=l,void i.sceneEl.systems.material.loadTexture(l,u,h)}function h(e){var t=r+"Map";s[t]=e,e&&a.has(t)&&c.applyColorCorrection(e),s.needsUpdate=!0,o(i,e)}s.map&&h(null)},e.exports.handleTextureEvents=o,e.exports.isHLS=function(e,t){return!(!t||!i.includes(t.toLowerCase()))||!!(e&&e.toLowerCase().indexOf(".m3u8")>0)}},363:function(e,t,n){var r=n(114),i=n(54).geometries,a=n(54).geometryNames,o=n(67).registerPrimitive,s=n(24),c=e.exports={};function l(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}a.forEach((function(e){var t=i[e],n=l(e),a={};Object.keys(t.schema).forEach((function(e){a[l(e)]="geometry."+e}));var u="a-"+n,h=o(u,s.extendDeep({},r(),{defaultComponents:{geometry:{primitive:e}},mappings:a}));c[u]=h}))},441:function(e,t,n){e.exports=function(){return n(225)('!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/custom-hubs-template/",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var i=\n/*!\n * ZipLoader\n * (c) 2017 @yomotsu\n * Released under the MIT License.\n * \n * ZipLoader uses the library pako released under the MIT license :\n * https://github.com/nodeca/pako/blob/master/LICENSE\n */\nfunction(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)i(n,r)&&(e[r]=n[r])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,n,i,r){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),r);else for(var a=0;a<i;a++)e[r+a]=t[n+a]},flattenChunks:function(e){var t,n,i,r,a,o;for(i=0,t=0,n=e.length;t<n;t++)i+=e[t].length;for(o=new Uint8Array(i),r=0,t=0,n=e.length;t<n;t++)a=e[t],o.set(a,r),r+=a.length;return o}},a={arraySet:function(e,t,n,i,r){for(var a=0;a<i;a++)e[r+a]=t[n+a]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,r)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,a))},t.setTyped(n)}));i.assign,i.shrinkBuf,i.setTyped,i.Buf8,i.Buf16,i.Buf32;var r=function(e,t,n,i){for(var r=65535&e|0,a=e>>>16&65535|0,o=0;0!==n;){n-=o=n>2e3?2e3:n;do{a=a+(r=r+t[i++]|0)|0}while(--o);r%=65521,a%=65521}return r|a<<16|0};var a=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();var o=function(e,t,n,i){var r=a,o=i+n;e^=-1;for(var s=i;s<o;s++)e=e>>>8^r[255&(e^t[s])];return-1^e},s=function(e,t){var n,i,r,a,o,s,f,l,d,u,c,h,w,p,b,m,v,k,g,y,x,_,B,A,S;n=e.state,i=e.next_in,A=e.input,r=i+(e.avail_in-5),a=e.next_out,S=e.output,o=a-(t-e.avail_out),s=a+(e.avail_out-257),f=n.dmax,l=n.wsize,d=n.whave,u=n.wnext,c=n.window,h=n.hold,w=n.bits,p=n.lencode,b=n.distcode,m=(1<<n.lenbits)-1,v=(1<<n.distbits)-1;e:do{w<15&&(h+=A[i++]<<w,w+=8,h+=A[i++]<<w,w+=8),k=p[h&m];t:for(;;){if(h>>>=g=k>>>24,w-=g,0===(g=k>>>16&255))S[a++]=65535&k;else{if(!(16&g)){if(0==(64&g)){k=p[(65535&k)+(h&(1<<g)-1)];continue t}if(32&g){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}y=65535&k,(g&=15)&&(w<g&&(h+=A[i++]<<w,w+=8),y+=h&(1<<g)-1,h>>>=g,w-=g),w<15&&(h+=A[i++]<<w,w+=8,h+=A[i++]<<w,w+=8),k=b[h&v];n:for(;;){if(h>>>=g=k>>>24,w-=g,!(16&(g=k>>>16&255))){if(0==(64&g)){k=b[(65535&k)+(h&(1<<g)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(x=65535&k,w<(g&=15)&&(h+=A[i++]<<w,(w+=8)<g&&(h+=A[i++]<<w,w+=8)),(x+=h&(1<<g)-1)>f){e.msg="invalid distance too far back",n.mode=30;break e}if(h>>>=g,w-=g,x>(g=a-o)){if((g=x-g)>d&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(_=0,B=c,0===u){if(_+=l-g,g<y){y-=g;do{S[a++]=c[_++]}while(--g);_=a-x,B=S}}else if(u<g){if(_+=l+u-g,(g-=u)<y){y-=g;do{S[a++]=c[_++]}while(--g);if(_=0,u<y){y-=g=u;do{S[a++]=c[_++]}while(--g);_=a-x,B=S}}}else if(_+=u-g,g<y){y-=g;do{S[a++]=c[_++]}while(--g);_=a-x,B=S}for(;y>2;)S[a++]=B[_++],S[a++]=B[_++],S[a++]=B[_++],y-=3;y&&(S[a++]=B[_++],y>1&&(S[a++]=B[_++]))}else{_=a-x;do{S[a++]=S[_++],S[a++]=S[_++],S[a++]=S[_++],y-=3}while(y>2);y&&(S[a++]=S[_++],y>1&&(S[a++]=S[_++]))}break}}break}}while(i<r&&a<s);i-=y=w>>3,h&=(1<<(w-=y<<3))-1,e.next_in=i,e.next_out=a,e.avail_in=i<r?r-i+5:5-(i-r),e.avail_out=a<s?s-a+257:257-(a-s),n.hold=h,n.bits=w},f=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],c=function(e,t,n,r,a,o,s,c){var h,w,p,b,m,v,k,g,y,x=c.bits,_=0,B=0,A=0,S=0,U=0,C=0,j=0,O=0,T=0,R=0,z=null,E=0,L=new i.Buf16(16),D=new i.Buf16(16),P=null,H=0;for(_=0;_<=15;_++)L[_]=0;for(B=0;B<r;B++)L[t[n+B]]++;for(U=x,S=15;S>=1&&0===L[S];S--);if(U>S&&(U=S),0===S)return a[o++]=20971520,a[o++]=20971520,c.bits=1,0;for(A=1;A<S&&0===L[A];A++);for(U<A&&(U=A),O=1,_=1;_<=15;_++)if(O<<=1,(O-=L[_])<0)return-1;if(O>0&&(0===e||1!==S))return-1;for(D[1]=0,_=1;_<15;_++)D[_+1]=D[_]+L[_];for(B=0;B<r;B++)0!==t[n+B]&&(s[D[t[n+B]]++]=B);if(0===e?(z=P=s,v=19):1===e?(z=f,E-=257,P=l,H-=257,v=256):(z=d,P=u,v=-1),R=0,B=0,_=A,m=o,C=U,j=0,p=-1,b=(T=1<<U)-1,1===e&&T>852||2===e&&T>592)return 1;for(;;){k=_-j,s[B]<v?(g=0,y=s[B]):s[B]>v?(g=P[H+s[B]],y=z[E+s[B]]):(g=96,y=0),h=1<<_-j,A=w=1<<C;do{a[m+(R>>j)+(w-=h)]=k<<24|g<<16|y|0}while(0!==w);for(h=1<<_-1;R&h;)h>>=1;if(0!==h?(R&=h-1,R+=h):R=0,B++,0==--L[_]){if(_===S)break;_=t[n+s[B]]}if(_>U&&(R&b)!==p){for(0===j&&(j=U),m+=A,O=1<<(C=_-j);C+j<S&&!((O-=L[C+j])<=0);)C++,O<<=1;if(T+=1<<C,1===e&&T>852||2===e&&T>592)return 1;a[p=R&b]=U<<24|C<<16|m-o|0}}return 0!==R&&(a[m+R]=_-j<<24|64<<16|0),c.bits=U,0};function h(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function p(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32(852),t.distcode=t.distdyn=new i.Buf32(592),t.sane=1,t.back=-1,0):-2}function b(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,p(e)):-2}function m(e,t){var n,i;return e&&e.state?(i=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?-2:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,b(e))):-2}function v(e,t){var n,i;return e?(i=new w,e.state=i,i.window=null,0!==(n=m(e,t))&&(e.state=null),n):-2}var k,g,y=!0;function x(e){if(y){var t;for(k=new i.Buf32(512),g=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(c(1,e.lens,0,288,k,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;c(2,e.lens,0,32,g,0,e.work,{bits:5}),y=!1}e.lencode=k,e.lenbits=9,e.distcode=g,e.distbits=5}function _(e,t,n,r){var a,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new i.Buf8(o.wsize)),r>=o.wsize?(i.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((a=o.wsize-o.wnext)>r&&(a=r),i.arraySet(o.window,t,n-r,a,o.wnext),(r-=a)?(i.arraySet(o.window,t,n-r,r,0),o.wnext=r,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}var B={inflateReset:b,inflateReset2:m,inflateResetKeep:p,inflateInit:function(e){return v(e,15)},inflateInit2:v,inflate:function(e,t){var n,a,f,l,d,u,w,p,b,m,v,k,g,y,B,A,S,U,C,j,O,T,R,z,E=0,L=new i.Buf8(4),D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(n=e.state).mode&&(n.mode=13),d=e.next_out,f=e.output,w=e.avail_out,l=e.next_in,a=e.input,u=e.avail_in,p=n.hold,b=n.bits,m=u,v=w,T=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;b<16;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(2&n.wrap&&35615===p){n.check=0,L[0]=255&p,L[1]=p>>>8&255,n.check=o(n.check,L,2,0),p=0,b=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&p)<<8)+(p>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&p)){e.msg="unknown compression method",n.mode=30;break}if(b-=4,O=8+(15&(p>>>=4)),0===n.wbits)n.wbits=O;else if(O>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<O,e.adler=n.check=1,n.mode=512&p?10:12,p=0,b=0;break;case 2:for(;b<16;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(n.flags=p,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=p>>8&1),512&n.flags&&(L[0]=255&p,L[1]=p>>>8&255,n.check=o(n.check,L,2,0)),p=0,b=0,n.mode=3;case 3:for(;b<32;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}n.head&&(n.head.time=p),512&n.flags&&(L[0]=255&p,L[1]=p>>>8&255,L[2]=p>>>16&255,L[3]=p>>>24&255,n.check=o(n.check,L,4,0)),p=0,b=0,n.mode=4;case 4:for(;b<16;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}n.head&&(n.head.xflags=255&p,n.head.os=p>>8),512&n.flags&&(L[0]=255&p,L[1]=p>>>8&255,n.check=o(n.check,L,2,0)),p=0,b=0,n.mode=5;case 5:if(1024&n.flags){for(;b<16;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}n.length=p,n.head&&(n.head.extra_len=p),512&n.flags&&(L[0]=255&p,L[1]=p>>>8&255,n.check=o(n.check,L,2,0)),p=0,b=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((k=n.length)>u&&(k=u),k&&(n.head&&(O=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),i.arraySet(n.head.extra,a,l,k,O)),512&n.flags&&(n.check=o(n.check,a,k,l)),u-=k,l+=k,n.length-=k),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===u)break e;k=0;do{O=a[l+k++],n.head&&O&&n.length<65536&&(n.head.name+=String.fromCharCode(O))}while(O&&k<u);if(512&n.flags&&(n.check=o(n.check,a,k,l)),u-=k,l+=k,O)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===u)break e;k=0;do{O=a[l+k++],n.head&&O&&n.length<65536&&(n.head.comment+=String.fromCharCode(O))}while(O&&k<u);if(512&n.flags&&(n.check=o(n.check,a,k,l)),u-=k,l+=k,O)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;b<16;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(p!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}p=0,b=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;b<32;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}e.adler=n.check=h(p),p=0,b=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=d,e.avail_out=w,e.next_in=l,e.avail_in=u,n.hold=p,n.bits=b,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){p>>>=7&b,b-=7&b,n.mode=27;break}for(;b<3;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}switch(n.last=1&p,b-=1,3&(p>>>=1)){case 0:n.mode=14;break;case 1:if(x(n),n.mode=20,6===t){p>>>=2,b-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}p>>>=2,b-=2;break;case 14:for(p>>>=7&b,b-=7&b;b<32;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if((65535&p)!=(p>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&p,p=0,b=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(k=n.length){if(k>u&&(k=u),k>w&&(k=w),0===k)break e;i.arraySet(f,a,l,k,d),u-=k,l+=k,w-=k,d+=k,n.length-=k;break}n.mode=12;break;case 17:for(;b<14;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(n.nlen=257+(31&p),p>>>=5,b-=5,n.ndist=1+(31&p),p>>>=5,b-=5,n.ncode=4+(15&p),p>>>=4,b-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;b<3;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}n.lens[D[n.have++]]=7&p,p>>>=3,b-=3}for(;n.have<19;)n.lens[D[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,R={bits:n.lenbits},T=c(0,n.lens,0,19,n.lencode,0,n.work,R),n.lenbits=R.bits,T){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;A=(E=n.lencode[p&(1<<n.lenbits)-1])>>>16&255,S=65535&E,!((B=E>>>24)<=b);){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(S<16)p>>>=B,b-=B,n.lens[n.have++]=S;else{if(16===S){for(z=B+2;b<z;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(p>>>=B,b-=B,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}O=n.lens[n.have-1],k=3+(3&p),p>>>=2,b-=2}else if(17===S){for(z=B+3;b<z;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}b-=B,O=0,k=3+(7&(p>>>=B)),p>>>=3,b-=3}else{for(z=B+7;b<z;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}b-=B,O=0,k=11+(127&(p>>>=B)),p>>>=7,b-=7}if(n.have+k>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;k--;)n.lens[n.have++]=O}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,R={bits:n.lenbits},T=c(1,n.lens,0,n.nlen,n.lencode,0,n.work,R),n.lenbits=R.bits,T){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,R={bits:n.distbits},T=c(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,R),n.distbits=R.bits,T){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(u>=6&&w>=258){e.next_out=d,e.avail_out=w,e.next_in=l,e.avail_in=u,n.hold=p,n.bits=b,s(e,v),d=e.next_out,f=e.output,w=e.avail_out,l=e.next_in,a=e.input,u=e.avail_in,p=n.hold,b=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;A=(E=n.lencode[p&(1<<n.lenbits)-1])>>>16&255,S=65535&E,!((B=E>>>24)<=b);){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(A&&0==(240&A)){for(U=B,C=A,j=S;A=(E=n.lencode[j+((p&(1<<U+C)-1)>>U)])>>>16&255,S=65535&E,!(U+(B=E>>>24)<=b);){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}p>>>=U,b-=U,n.back+=U}if(p>>>=B,b-=B,n.back+=B,n.length=S,0===A){n.mode=26;break}if(32&A){n.back=-1,n.mode=12;break}if(64&A){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&A,n.mode=22;case 22:if(n.extra){for(z=n.extra;b<z;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}n.length+=p&(1<<n.extra)-1,p>>>=n.extra,b-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;A=(E=n.distcode[p&(1<<n.distbits)-1])>>>16&255,S=65535&E,!((B=E>>>24)<=b);){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(0==(240&A)){for(U=B,C=A,j=S;A=(E=n.distcode[j+((p&(1<<U+C)-1)>>U)])>>>16&255,S=65535&E,!(U+(B=E>>>24)<=b);){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}p>>>=U,b-=U,n.back+=U}if(p>>>=B,b-=B,n.back+=B,64&A){e.msg="invalid distance code",n.mode=30;break}n.offset=S,n.extra=15&A,n.mode=24;case 24:if(n.extra){for(z=n.extra;b<z;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}n.offset+=p&(1<<n.extra)-1,p>>>=n.extra,b-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===w)break e;if(k=v-w,n.offset>k){if((k=n.offset-k)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}k>n.wnext?(k-=n.wnext,g=n.wsize-k):g=n.wnext-k,k>n.length&&(k=n.length),y=n.window}else y=f,g=d-n.offset,k=n.length;k>w&&(k=w),w-=k,n.length-=k;do{f[d++]=y[g++]}while(--k);0===n.length&&(n.mode=21);break;case 26:if(0===w)break e;f[d++]=n.length,w--,n.mode=21;break;case 27:if(n.wrap){for(;b<32;){if(0===u)break e;u--,p|=a[l++]<<b,b+=8}if(v-=w,e.total_out+=v,n.total+=v,v&&(e.adler=n.check=n.flags?o(n.check,f,v,d-v):r(n.check,f,v,d-v)),v=w,(n.flags?p:h(p))!==n.check){e.msg="incorrect data check",n.mode=30;break}p=0,b=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;b<32;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(p!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}p=0,b=0}n.mode=29;case 29:T=1;break e;case 30:T=-3;break e;case 31:return-4;case 32:default:return-2}return e.next_out=d,e.avail_out=w,e.next_in=l,e.avail_in=u,n.hold=p,n.bits=b,(n.wsize||v!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&_(e,e.output,e.next_out,v-e.avail_out)?(n.mode=31,-4):(m-=e.avail_in,v-=e.avail_out,e.total_in+=m,e.total_out+=v,n.total+=v,n.wrap&&v&&(e.adler=n.check=n.flags?o(n.check,f,v,e.next_out-v):r(n.check,f,v,e.next_out-v)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===m&&0===v||4===t)&&0===T&&(T=-5),T)},inflateEnd:function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},inflateGetHeader:function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?-2:(n.head=t,t.done=!1,0):-2},inflateSetDictionary:function(e,t){var n,i=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?-2:11===n.mode&&r(1,t,i,0)!==n.check?-3:_(e,t,i,i)?(n.mode=31,-4):(n.havedict=1,0):-2},inflateInfo:"pako inflate (from Nodeca project)"},A=!0,S=!0;try{String.fromCharCode.apply(null,[0])}catch(e){A=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){S=!1}for(var U=new i.Buf8(256),C=0;C<256;C++)U[C]=C>=252?6:C>=248?5:C>=240?4:C>=224?3:C>=192?2:1;U[254]=U[254]=1;function j(e,t){if(t<65537&&(e.subarray&&S||!e.subarray&&A))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var n="",r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n}var O=function(e){var t,n,r,a,o,s=e.length,f=0;for(a=0;a<s;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),f+=n<128?1:n<2048?2:n<65536?3:4;for(t=new i.Buf8(f),o=0,a=0;o<f;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},T=function(e){for(var t=new i.Buf8(e.length),n=0,r=t.length;n<r;n++)t[n]=e.charCodeAt(n);return t},R=function(e,t){var n,i,r,a,o=t||e.length,s=new Array(2*o);for(i=0,n=0;n<o;)if((r=e[n++])<128)s[i++]=r;else if((a=U[r])>4)s[i++]=65533,n+=a-1;else{for(r&=2===a?31:3===a?15:7;a>1&&n<o;)r=r<<6|63&e[n++],a--;a>1?s[i++]=65533:r<65536?s[i++]=r:(r-=65536,s[i++]=55296|r>>10&1023,s[i++]=56320|1023&r)}return j(s,i)},z=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0?t:0===n?t:n+U[e[n]]>t?n:t},E=0,L=2,D=4,P=0,H=1,I=2,N=-5,J={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};var M=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};var $=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},G=Object.prototype.toString;function V(e){if(!(this instanceof V))return new V(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new M,this.strm.avail_out=0;var n=B.inflateInit2(this.strm,t.windowBits);if(n!==P)throw new Error(J[n]);this.header=new $,B.inflateGetHeader(this.strm,this.header)}function q(e,t){var n=new V(t);if(n.push(e,!0),n.err)throw n.msg||J[n.err];return n.result}V.prototype.push=function(e,t){var n,r,a,o,s,f,l=this.strm,d=this.options.chunkSize,u=this.options.dictionary,c=!1;if(this.ended)return!1;r=t===~~t?t:!0===t?D:E,"string"==typeof e?l.input=T(e):"[object ArrayBuffer]"===G.call(e)?l.input=new Uint8Array(e):l.input=e,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new i.Buf8(d),l.next_out=0,l.avail_out=d),(n=B.inflate(l,E))===I&&u&&(f="string"==typeof u?O(u):"[object ArrayBuffer]"===G.call(u)?new Uint8Array(u):u,n=B.inflateSetDictionary(this.strm,f)),n===N&&!0===c&&(n=P,c=!1),n!==H&&n!==P)return this.onEnd(n),this.ended=!0,!1;l.next_out&&(0!==l.avail_out&&n!==H&&(0!==l.avail_in||r!==D&&r!==L)||("string"===this.options.to?(a=z(l.output,l.next_out),o=l.next_out-a,s=R(l.output,a),l.next_out=o,l.avail_out=d-o,o&&i.arraySet(l.output,l.output,a,o,0),this.onData(s)):this.onData(i.shrinkBuf(l.output,l.next_out)))),0===l.avail_in&&0===l.avail_out&&(c=!0)}while((l.avail_in>0||0===l.avail_out)&&n!==H);return n===H&&(r=D),r===D?(n=B.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===P):r!==L||(this.onEnd(P),l.avail_out=0,!0)},V.prototype.onData=function(e){this.chunks.push(e)},V.prototype.onEnd=function(e){e===P&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var F={Inflate:V,inflate:q,inflateRaw:function(e,t){return(t=t||{}).raw=!0,q(e,t)},ungzip:q};var K=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataView=new DataView(t),this.position=0}return e.prototype.skip=function(e){this.position+=e},e.prototype.readBytes=function(e){var t=4===e?"getUint32":2===e?"getUint16":"getUint8",n=this.position;return this.position+=e,this.dataView[t](n,!0)},e}(),X=function(e){for(var t=new K(e),n={};;){var i=t.readBytes(4);if(67324752!==i){if(33639248!==i)break;W(t)}else{var r=Q(t);n[r.name]={buffer:r.buffer}}}return n},Q=function(e){var t=0,n=void 0;e.skip(4);var i=e.readBytes(2);e.skip(8);var r=e.readBytes(4);e.skip(4);var a=e.readBytes(2),o=e.readBytes(2),s=[],f=new Uint8Array(r);for(t=0;t<a;t++)s.push(String.fromCharCode(e.readBytes(1)));for(e.skip(o),t=0;t<r;t++)f[t]=e.readBytes(1);switch(i){case 0:n=f;break;case 8:n=new Uint8Array(F.inflate(f,{raw:!0}));break;default:console.log(s.join("")+": unsupported compression type"),n=f}return{name:s.join(""),buffer:n}},W=function(e){e.skip(24);var t=e.readBytes(2),n=e.readBytes(2),i=e.readBytes(2);e.skip(12),e.skip(t),e.skip(n),e.skip(i)};var Y="function"==typeof Promise?Promise:function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(){};return t((function(){n()})),{then:function(e){n=e}}};var Z=0,ee=void 0,te=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=Z,this._listeners={},this.url=t,this.files=null,Z++}return e.unzip=function(t){return new Y((function(n){var i=new e,r=new FileReader;r.onload=function(e){var t=e.target.result;i.files=X(t),n(i)},t instanceof Blob&&r.readAsArrayBuffer(t)}))},e.prototype.load=function(){var e=this;return new Y((function(t){var n=Date.now(),i=new XMLHttpRequest;i.open("GET",e.url,!0),i.responseType="arraybuffer",i.onprogress=function(t){e.dispatch({type:"progress",loaded:t.loaded,total:t.total,elapsedTime:Date.now()-n})},i.onload=function(){e.files=X(i.response),e.dispatch({type:"load",elapsedTime:Date.now()-n}),t()},i.send()}))},e.prototype.extractAsBlobUrl=function(e,t){if(this.files[e].url)return this.files[e].url;var n=new Blob([this.files[e].buffer],{type:t});return this.files[e].url=URL.createObjectURL(n),this.files[e].url},e.prototype.extractAsText=function(e){var t=this.files[e].buffer;if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var n="",i=0,r=t.length;i<r;i++)n+=String.fromCharCode(t[i]);return decodeURIComponent(escape(n))},e.prototype.extractAsJSON=function(e){return JSON.parse(this.extractAsText(e))},e.prototype.loadThreeJSON=function(e){var t=this,n=this.extractAsJSON(e),i=e.replace(/\\/.+\\.json$/,"/"),r="__ziploader_"+this._id+"__",a=new RegExp(r);return-1!==!ee.Loader.Handlers.handlers.indexOf(a)&&ee.Loader.Handlers.add(a,{load:function(e){return t.loadThreeTexture(e.replace(a,""))}}),ee.JSONLoader.prototype.parse(n,r+i)},e.prototype.loadThreeTexture=function(e){var t=new ee.Texture,n=/\\.jpg$/.test(e)?"image/jpeg":/\\.png$/.test(e)?"image/png":/\\.gif$/.test(e)?"image/gif":void 0,i=new Blob([this.files[e].buffer],{type:n});return t.image=new Image,t.image.addEventListener("load",(function e(){t.needsUpdate=!0,t.image.removeEventListener("load",e),URL.revokeObjectURL(t.image.src)})),t.image.src=URL.createObjectURL(i),t},e.prototype.on=function(e,t){this._listeners[e]||(this._listeners[e]=[]),-1===this._listeners[e].indexOf(t)&&this._listeners[e].push(t)},e.prototype.off=function(e,t){var n=this._listeners[e];if(n){var i=n.indexOf(t);-1!==i&&n.splice(i,1)}},e.prototype.dispatch=function(e){var t=this._listeners[e.type];if(t){e.target=this;for(var n=t.length,i=0;i<n;i++)t[i].call(this,e)}},e.prototype.clear=function(e){if(e)return URL.revokeObjectURL(this.files[e].url),void delete this.files[e];for(var t in this.files)URL.revokeObjectURL(this.files[t].url);if(delete this.files,ee){var n="__ziploader_"+this._id+"__";ee.Loader.Handlers.handlers.some((function(e,t){if(e instanceof RegExp&&e.source===n)return ee.Loader.Handlers.handlers.splice(t,2),!0}))}},e.install=function(e){e.THREE&&(ee=e.THREE)},e}();function ne(e,t,n,i,r,a,o){try{var s=e[a](o),f=s.value}catch(e){return void n(e)}s.done?t(f):Promise.resolve(f).then(i,r)}function ie(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var a=e.apply(t,n);function o(e){ne(a,i,r,o,s,"next",e)}function s(e){ne(a,i,r,o,s,"throw",e)}o(void 0)}))}}function re(){return(re=ie((function*(e){const t=new te(e);return t.load().then(()=>{const e={};for(const n in t.files)e[n]=t.extractAsBlobUrl(n);const n=JSON.parse(t.extractAsText("scene.gltf"));return n.buffers&&n.buffers.forEach(t=>t.uri=e[t.uri]),n.images&&n.images.forEach(t=>t.uri=e[t.uri]),e["scene.gtlf"]=URL.createObjectURL(new Blob([JSON.stringify(n,null,2)],{type:"text/plain"})),e})}))).apply(this,arguments)}self.onmessage=function(){var e=ie((function*(e){try{const t=yield function(e){return re.apply(this,arguments)}(e.data.payload);self.postMessage({id:e.data.id,result:t})}catch(t){self.postMessage({id:e.data.id,err:t.message})}}));return function(t){return e.apply(this,arguments)}}()}]);\n//# sourceMappingURL=sketchfab-zip.worker-eb1a0551b7696fe6c6d3.js.map',"/assets/js/sketchfab-zip.worker-eb1a0551b7696fe6c6d3.js")}},457:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){null==e&&(e=Math),this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(var t=0;t<256;t++)this.p[t]=Math.floor(256*e.random());this.perm=[];for(t=0;t<512;t++)this.perm[t]=this.p[255&t];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]};r.prototype.dot=function(e,t,n){return e[0]*t+e[1]*n},r.prototype.dot3=function(e,t,n,r){return e[0]*t+e[1]*n+e[2]*r},r.prototype.dot4=function(e,t,n,r,i){return e[0]*t+e[1]*n+e[2]*r+e[3]*i},r.prototype.noise=function(e,t){var n,r,i=(e+t)*(.5*(Math.sqrt(3)-1)),a=Math.floor(e+i),o=Math.floor(t+i),s=(3-Math.sqrt(3))/6,c=(a+o)*s,l=e-(a-c),u=t-(o-c);l>u?(n=1,r=0):(n=0,r=1);var h=l-n+s,d=u-r+s,p=l-1+2*s,f=u-1+2*s,m=255&a,g=255&o,v=this.perm[m+this.perm[g]]%12,y=this.perm[m+n+this.perm[g+r]]%12,b=this.perm[m+1+this.perm[g+1]]%12,x=.5-l*l-u*u,w=.5-h*h-d*d,E=.5-p*p-f*f;return 70*((x<0?0:(x*=x)*x*this.dot(this.grad3[v],l,u))+(w<0?0:(w*=w)*w*this.dot(this.grad3[y],h,d))+(E<0?0:(E*=E)*E*this.dot(this.grad3[b],p,f)))},r.prototype.noise3d=function(e,t,n){var r,i,a,o,s,c,l=(e+t+n)*(1/3),u=Math.floor(e+l),h=Math.floor(t+l),d=Math.floor(n+l),p=1/6,f=(u+h+d)*p,m=e-(u-f),g=t-(h-f),v=n-(d-f);m>=g?g>=v?(r=1,i=0,a=0,o=1,s=1,c=0):m>=v?(r=1,i=0,a=0,o=1,s=0,c=1):(r=0,i=0,a=1,o=1,s=0,c=1):g<v?(r=0,i=0,a=1,o=0,s=1,c=1):m<v?(r=0,i=1,a=0,o=0,s=1,c=1):(r=0,i=1,a=0,o=1,s=1,c=0);var y=m-r+p,b=g-i+p,x=v-a+p,w=m-o+2*p,E=g-s+2*p,M=v-c+2*p,A=m-1+.5,T=g-1+.5,_=v-1+.5,S=255&u,L=255&h,C=255&d,R=this.perm[S+this.perm[L+this.perm[C]]]%12,P=this.perm[S+r+this.perm[L+i+this.perm[C+a]]]%12,O=this.perm[S+o+this.perm[L+s+this.perm[C+c]]]%12,D=this.perm[S+1+this.perm[L+1+this.perm[C+1]]]%12,I=.6-m*m-g*g-v*v,B=.6-y*y-b*b-x*x,k=.6-w*w-E*E-M*M,H=.6-A*A-T*T-_*_;return 32*((I<0?0:(I*=I)*I*this.dot3(this.grad3[R],m,g,v))+(B<0?0:(B*=B)*B*this.dot3(this.grad3[P],y,b,x))+(k<0?0:(k*=k)*k*this.dot3(this.grad3[O],w,E,M))+(H<0?0:(H*=H)*H*this.dot3(this.grad3[D],A,T,_)))},r.prototype.noise4d=function(e,t,n,r){var i,a,o,s,c,l,u,h,d,p,f,m,g=this.grad4,v=this.simplex,y=this.perm,b=(Math.sqrt(5)-1)/4,x=(5-Math.sqrt(5))/20,w=(e+t+n+r)*b,E=Math.floor(e+w),M=Math.floor(t+w),A=Math.floor(n+w),T=Math.floor(r+w),_=(E+M+A+T)*x,S=e-(E-_),L=t-(M-_),C=n-(A-_),R=r-(T-_),P=(S>L?32:0)+(S>C?16:0)+(L>C?8:0)+(S>R?4:0)+(L>R?2:0)+(C>R?1:0),O=S-(i=v[P][0]>=3?1:0)+x,D=L-(a=v[P][1]>=3?1:0)+x,I=C-(o=v[P][2]>=3?1:0)+x,B=R-(s=v[P][3]>=3?1:0)+x,k=S-(c=v[P][0]>=2?1:0)+2*x,H=L-(l=v[P][1]>=2?1:0)+2*x,N=C-(u=v[P][2]>=2?1:0)+2*x,F=R-(h=v[P][3]>=2?1:0)+2*x,U=S-(d=v[P][0]>=1?1:0)+3*x,z=L-(p=v[P][1]>=1?1:0)+3*x,V=C-(f=v[P][2]>=1?1:0)+3*x,j=R-(m=v[P][3]>=1?1:0)+3*x,G=S-1+4*x,W=L-1+4*x,q=C-1+4*x,X=R-1+4*x,Y=255&E,K=255&M,J=255&A,Z=255&T,Q=y[Y+y[K+y[J+y[Z]]]]%32,$=y[Y+i+y[K+a+y[J+o+y[Z+s]]]]%32,ee=y[Y+c+y[K+l+y[J+u+y[Z+h]]]]%32,te=y[Y+d+y[K+p+y[J+f+y[Z+m]]]]%32,ne=y[Y+1+y[K+1+y[J+1+y[Z+1]]]]%32,re=.6-S*S-L*L-C*C-R*R,ie=.6-O*O-D*D-I*I-B*B,ae=.6-k*k-H*H-N*N-F*F,oe=.6-U*U-z*z-V*V-j*j,se=.6-G*G-W*W-q*q-X*X;return 27*((re<0?0:(re*=re)*re*this.dot4(g[Q],S,L,C,R))+(ie<0?0:(ie*=ie)*ie*this.dot4(g[$],O,D,I,B))+(ae<0?0:(ae*=ae)*ae*this.dot4(g[ee],k,H,N,F))+(oe<0?0:(oe*=oe)*oe*this.dot4(g[te],U,z,V,j))+(se<0?0:(se*=se)*se*this.dot4(g[ne],G,W,q,X)))}},478:function(e,t,n){e.exports=function(){return n(225)('!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/custom-hubs-template/",r(r.s=0)}([function(e,t){self.onmessage=e=>{try{const t=function(e){let t=0;const r=[];let n=null;const o=[],a=[];let s=0;if(71!==e[0]||73!==e[1]||70!==e[2]||56!==e[3]||57!==e[4]||97!==e[5])throw new Error("parseGIF: no GIF89a");{t+=+!!(128&e[10])*Math.pow(2,1+(7&e[10]))*3+13;const u=e.subarray(0,t);for(;e[t]&&59!==e[t];){const l=t,f=e[t];if(33===f){const o=e[++t];if(-1===[1,254,249,255].indexOf(o))throw new Error("parseGIF: unknown label");for(249===o&&r.push(10*(e[t+3]+(e[t+4]<<8))),255===o&&(s=e[t+15]+(e[t+16]<<8));e[++t];)t+=e[t];249===o&&(n=e.subarray(l,t+1),a.push(n[3]>>2&7))}else{if(44!==f)throw new Error("parseGIF: unknown blockId");{for(t+=9,t+=+!!(128&e[t])*(3*Math.pow(2,1+(7&e[t])))+1;e[++t];)t+=e[t];const r=e.subarray(l,t+1);o.push(URL.createObjectURL(new Blob([u,n,r])))}}t++}}return{delayTimes:r,loopCnt:s,frames:o,disposals:a}}(new Uint8Array(e.data.payload));self.postMessage({id:e.data.id,result:t})}catch(t){self.postMessage({id:e.data.id,err:t.message})}}}]);\n//# sourceMappingURL=gifparsing.worker-87610e8cce63251061e3.js.map',"/assets/js/gifparsing.worker-87610e8cce63251061e3.js")}},483:function(e,t,n){var r=n(1011),i=n(1015),a=n(1016),o=n(1019),s=n(60),c=n(1021),l=n(1022),u=THREE.BufferGeometry;function h(e){u.call(this),"string"==typeof e&&(e={text:e}),this._opt=s({},e),e&&this.update(e)}e.exports=function(e){return new h(e)},i(h,u),h.prototype.update=function(e){if("string"==typeof e&&(e={text:e}),!(e=s({},this._opt,e)).font)throw new TypeError("must specify a { font } in options");this.layout=r(e);var t=!1!==e.flipY,n=e.font,i=n.common.scaleW,l=n.common.scaleH,u=this.layout.glyphs.filter((function(e){var t=e.data;return t.width*t.height>0}));this.visibleGlyphs=u;var h=c.positions(u),d=c.uvs(u,i,l,t),p=a({clockwise:!0,type:"uint16",count:u.length});if(o.index(this,p,1,"uint16"),o.attr(this,"position",h,2),o.attr(this,"uv",d,2),!e.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(e.multipage){var f=c.pages(u);o.attr(this,"page",f,1)}},h.prototype.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var e=this.attributes.position.array,t=this.attributes.position.itemSize;if(!e||!t||e.length<2)return this.boundingSphere.radius=0,void this.boundingSphere.center.set(0,0,0);l.computeSphere(e,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')},h.prototype.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var e=this.boundingBox,t=this.attributes.position.array,n=this.attributes.position.itemSize;!t||!n||t.length<2?e.makeEmpty():l.computeBox(t,e)}},5:function(e,t,n){"use strict";function r(){}n.r(t),n.d(t,"ACESFilmicToneMapping",(function(){return ue})),n.d(t,"AddEquation",(function(){return O})),n.d(t,"AddOperation",(function(){return ie})),n.d(t,"AdditiveBlending",(function(){return L})),n.d(t,"AlphaFormat",(function(){return Ue})),n.d(t,"AlwaysDepth",(function(){return K})),n.d(t,"AmbientLight",(function(){return Rc})),n.d(t,"AmbientLightProbe",(function(){return il})),n.d(t,"AnimationClip",(function(){return Fs})),n.d(t,"AnimationLoader",(function(){return qs})),n.d(t,"AnimationMixer",(function(){return _l})),n.d(t,"AnimationObjectGroup",(function(){return Al})),n.d(t,"AnimationUtils",(function(){return _s})),n.d(t,"ArcCurve",(function(){return ec})),n.d(t,"ArrayCamera",(function(){return wa})),n.d(t,"ArrowHelper",(function(){return cu})),n.d(t,"Audio",(function(){return ll})),n.d(t,"AudioAnalyser",(function(){return hl})),n.d(t,"AudioContext",(function(){return $c})),n.d(t,"AudioListener",(function(){return cl})),n.d(t,"AudioLoader",(function(){return el})),n.d(t,"AxesHelper",(function(){return lu})),n.d(t,"AxisHelper",(function(){return Bu})),n.d(t,"BackSide",(function(){return b})),n.d(t,"BasicDepthPacking",(function(){return Nt})),n.d(t,"BasicShadowMap",(function(){return m})),n.d(t,"BinaryTextureLoader",(function(){return Uu})),n.d(t,"Bone",(function(){return Ga})),n.d(t,"BooleanKeyframeTrack",(function(){return Os})),n.d(t,"BoundingBoxHelper",(function(){return ku})),n.d(t,"Box2",(function(){return jl})),n.d(t,"Box3",(function(){return gn})),n.d(t,"Box3Helper",(function(){return ou})),n.d(t,"BoxBufferGeometry",(function(){return ur})),n.d(t,"BoxGeometry",(function(){return lr})),n.d(t,"BoxHelper",(function(){return au})),n.d(t,"BufferAttribute",(function(){return Kn})),n.d(t,"BufferGeometry",(function(){return cr})),n.d(t,"BufferGeometryLoader",(function(){return kc})),n.d(t,"ByteType",(function(){return Ce})),n.d(t,"Cache",(function(){return zs})),n.d(t,"Camera",(function(){return ba})),n.d(t,"CameraHelper",(function(){return iu})),n.d(t,"CanvasRenderer",(function(){return Vu})),n.d(t,"CanvasTexture",(function(){return $a})),n.d(t,"CatmullRomCurve3",(function(){return oc})),n.d(t,"CineonToneMapping",(function(){return le})),n.d(t,"CircleBufferGeometry",(function(){return ps})),n.d(t,"CircleGeometry",(function(){return ds})),n.d(t,"ClampToEdgeWrapping",(function(){return xe})),n.d(t,"Clock",(function(){return sl})),n.d(t,"ClosedSplineCurve3",(function(){return Ou})),n.d(t,"Color",(function(){return Cn})),n.d(t,"ColorKeyframeTrack",(function(){return Ds})),n.d(t,"CompressedTexture",(function(){return Qa})),n.d(t,"CompressedTextureLoader",(function(){return Xs})),n.d(t,"ConeBufferGeometry",(function(){return hs})),n.d(t,"ConeGeometry",(function(){return us})),n.d(t,"CubeCamera",(function(){return ol})),n.d(t,"CubeGeometry",(function(){return lr})),n.d(t,"CubeReflectionMapping",(function(){return de})),n.d(t,"CubeRefractionMapping",(function(){return pe})),n.d(t,"CubeTexture",(function(){return Wr})),n.d(t,"CubeTextureLoader",(function(){return Js})),n.d(t,"CubeUVReflectionMapping",(function(){return ve})),n.d(t,"CubeUVRefractionMapping",(function(){return ye})),n.d(t,"CubicBezierCurve",(function(){return uc})),n.d(t,"CubicBezierCurve3",(function(){return hc})),n.d(t,"CubicInterpolant",(function(){return Ls})),n.d(t,"CullFaceBack",(function(){return u})),n.d(t,"CullFaceFront",(function(){return h})),n.d(t,"CullFaceFrontBack",(function(){return d})),n.d(t,"CullFaceNone",(function(){return l})),n.d(t,"Curve",(function(){return Qs})),n.d(t,"CurvePath",(function(){return yc})),n.d(t,"CustomBlending",(function(){return P})),n.d(t,"CylinderBufferGeometry",(function(){return ls})),n.d(t,"CylinderGeometry",(function(){return cs})),n.d(t,"Cylindrical",(function(){return Vl})),n.d(t,"DataTexture",(function(){return mn})),n.d(t,"DataTexture2DArray",(function(){return qr})),n.d(t,"DataTexture3D",(function(){return Xr})),n.d(t,"DataTextureLoader",(function(){return Ys})),n.d(t,"DefaultLoadingManager",(function(){return js})),n.d(t,"DepthFormat",(function(){return qe})),n.d(t,"DepthStencilFormat",(function(){return Xe})),n.d(t,"DepthTexture",(function(){return eo})),n.d(t,"DirectionalLight",(function(){return Cc})),n.d(t,"DirectionalLightHelper",(function(){return ru})),n.d(t,"DirectionalLightShadow",(function(){return Lc})),n.d(t,"DiscreteInterpolant",(function(){return Rs})),n.d(t,"DodecahedronBufferGeometry",(function(){return fo})),n.d(t,"DodecahedronGeometry",(function(){return po})),n.d(t,"DoubleSide",(function(){return x})),n.d(t,"DstAlphaFactor",(function(){return j})),n.d(t,"DstColorFactor",(function(){return W})),n.d(t,"DynamicBufferAttribute",(function(){return Eu})),n.d(t,"EdgesGeometry",(function(){return ss})),n.d(t,"EdgesHelper",(function(){return Hu})),n.d(t,"EllipseCurve",(function(){return $s})),n.d(t,"EqualDepth",(function(){return Q})),n.d(t,"EquirectangularReflectionMapping",(function(){return fe})),n.d(t,"EquirectangularRefractionMapping",(function(){return me})),n.d(t,"Euler",(function(){return kn})),n.d(t,"EventDispatcher",(function(){return r})),n.d(t,"ExtrudeBufferGeometry",(function(){return Xo})),n.d(t,"ExtrudeGeometry",(function(){return qo})),n.d(t,"Face3",(function(){return Bn})),n.d(t,"Face4",(function(){return uu})),n.d(t,"FaceColors",(function(){return A})),n.d(t,"FaceNormalsHelper",(function(){return nu})),n.d(t,"FileLoader",(function(){return Ws})),n.d(t,"FlatShading",(function(){return w})),n.d(t,"Float32Attribute",(function(){return Ru})),n.d(t,"Float32BufferAttribute",(function(){return rr})),n.d(t,"Float64Attribute",(function(){return Pu})),n.d(t,"Float64BufferAttribute",(function(){return ir})),n.d(t,"FloatType",(function(){return Ie})),n.d(t,"Fog",(function(){return Ba})),n.d(t,"FogExp2",(function(){return Ia})),n.d(t,"Font",(function(){return Kc})),n.d(t,"FontLoader",(function(){return Zc})),n.d(t,"FrontFaceDirectionCCW",(function(){return f})),n.d(t,"FrontFaceDirectionCW",(function(){return p})),n.d(t,"FrontSide",(function(){return y})),n.d(t,"Frustum",(function(){return bn})),n.d(t,"GammaEncoding",(function(){return Ot})),n.d(t,"Geometry",(function(){return Yn})),n.d(t,"GeometryUtils",(function(){return zu})),n.d(t,"GreaterDepth",(function(){return ee})),n.d(t,"GreaterEqualDepth",(function(){return $})),n.d(t,"GridHelper",(function(){return $l})),n.d(t,"Group",(function(){return ya})),n.d(t,"HalfFloatType",(function(){return Be})),n.d(t,"HemisphereLight",(function(){return Ec})),n.d(t,"HemisphereLightHelper",(function(){return Zl})),n.d(t,"HemisphereLightProbe",(function(){return rl})),n.d(t,"IcosahedronBufferGeometry",(function(){return ho})),n.d(t,"IcosahedronGeometry",(function(){return uo})),n.d(t,"ImageBitmapLoader",(function(){return Xc})),n.d(t,"ImageLoader",(function(){return Ks})),n.d(t,"ImageUtils",(function(){return cn})),n.d(t,"ImmediateRenderObject",(function(){return Wl})),n.d(t,"InstancedBufferAttribute",(function(){return Bc})),n.d(t,"InstancedBufferGeometry",(function(){return Ic})),n.d(t,"InstancedInterleavedBuffer",(function(){return Hl})),n.d(t,"Int16Attribute",(function(){return _u})),n.d(t,"Int16BufferAttribute",(function(){return $n})),n.d(t,"Int32Attribute",(function(){return Lu})),n.d(t,"Int32BufferAttribute",(function(){return tr})),n.d(t,"Int8Attribute",(function(){return Mu})),n.d(t,"Int8BufferAttribute",(function(){return Jn})),n.d(t,"IntType",(function(){return Oe})),n.d(t,"InterleavedBuffer",(function(){return Ha})),n.d(t,"InterleavedBufferAttribute",(function(){return Na})),n.d(t,"Interpolant",(function(){return Ss})),n.d(t,"InterpolateDiscrete",(function(){return wt})),n.d(t,"InterpolateLinear",(function(){return Et})),n.d(t,"InterpolateSmooth",(function(){return Mt})),n.d(t,"JSONLoader",(function(){return ju})),n.d(t,"KeyframeTrack",(function(){return Ps})),n.d(t,"LOD",(function(){return za})),n.d(t,"LatheBufferGeometry",(function(){return rs})),n.d(t,"LatheGeometry",(function(){return ns})),n.d(t,"Layers",(function(){return Hn})),n.d(t,"LensFlare",(function(){return Wu})),n.d(t,"LessDepth",(function(){return J})),n.d(t,"LessEqualDepth",(function(){return Z})),n.d(t,"Light",(function(){return wc})),n.d(t,"LightProbe",(function(){return nl})),n.d(t,"LightProbeHelper",(function(){return Ql})),n.d(t,"LightShadow",(function(){return Mc})),n.d(t,"Line",(function(){return qa})),n.d(t,"Line3",(function(){return Gl})),n.d(t,"LineBasicMaterial",(function(){return Wa})),n.d(t,"LineCurve",(function(){return dc})),n.d(t,"LineCurve3",(function(){return pc})),n.d(t,"LineDashedMaterial",(function(){return As})),n.d(t,"LineLoop",(function(){return Ya})),n.d(t,"LinePieces",(function(){return du})),n.d(t,"LineSegments",(function(){return Xa})),n.d(t,"LineStrip",(function(){return hu})),n.d(t,"LinearEncoding",(function(){return Rt})),n.d(t,"LinearFilter",(function(){return Te})),n.d(t,"LinearInterpolant",(function(){return Cs})),n.d(t,"LinearMipMapLinearFilter",(function(){return Se})),n.d(t,"LinearMipMapNearestFilter",(function(){return _e})),n.d(t,"LinearToneMapping",(function(){return oe})),n.d(t,"Loader",(function(){return Qc})),n.d(t,"LoaderUtils",(function(){return Dc})),n.d(t,"LoadingManager",(function(){return Vs})),n.d(t,"LogLuvEncoding",(function(){return It})),n.d(t,"LoopOnce",(function(){return yt})),n.d(t,"LoopPingPong",(function(){return xt})),n.d(t,"LoopRepeat",(function(){return bt})),n.d(t,"LuminanceAlphaFormat",(function(){return Ge})),n.d(t,"LuminanceFormat",(function(){return je})),n.d(t,"MOUSE",(function(){return c})),n.d(t,"Material",(function(){return fr})),n.d(t,"MaterialLoader",(function(){return Oc})),n.d(t,"Math",(function(){return Vt})),n.d(t,"Matrix3",(function(){return qt})),n.d(t,"Matrix4",(function(){return xn})),n.d(t,"MaxEquation",(function(){return k})),n.d(t,"Mesh",(function(){return Pr})),n.d(t,"MeshBasicMaterial",(function(){return Rr})),n.d(t,"MeshDepthMaterial",(function(){return ha})),n.d(t,"MeshDistanceMaterial",(function(){return da})),n.d(t,"MeshFaceMaterial",(function(){return pu})),n.d(t,"MeshLambertMaterial",(function(){return Es})),n.d(t,"MeshMatcapMaterial",(function(){return Ms})),n.d(t,"MeshNormalMaterial",(function(){return ws})),n.d(t,"MeshPhongMaterial",(function(){return bs})),n.d(t,"MeshPhysicalMaterial",(function(){return ys})),n.d(t,"MeshStandardMaterial",(function(){return vs})),n.d(t,"MeshToonMaterial",(function(){return xs})),n.d(t,"MinEquation",(function(){return B})),n.d(t,"MirroredRepeatWrapping",(function(){return we})),n.d(t,"MixOperation",(function(){return re})),n.d(t,"MultiMaterial",(function(){return fu})),n.d(t,"MultiplyBlending",(function(){return R})),n.d(t,"MultiplyOperation",(function(){return ne})),n.d(t,"NearestFilter",(function(){return Ee})),n.d(t,"NearestMipMapLinearFilter",(function(){return Ae})),n.d(t,"NearestMipMapNearestFilter",(function(){return Me})),n.d(t,"NeverDepth",(function(){return Y})),n.d(t,"NoBlending",(function(){return _})),n.d(t,"NoColors",(function(){return M})),n.d(t,"NoToneMapping",(function(){return ae})),n.d(t,"NormalBlending",(function(){return S})),n.d(t,"NotEqualDepth",(function(){return te})),n.d(t,"NumberKeyframeTrack",(function(){return Is})),n.d(t,"Object3D",(function(){return Gn})),n.d(t,"ObjectLoader",(function(){return Nc})),n.d(t,"ObjectSpaceNormalMap",(function(){return zt})),n.d(t,"OctahedronBufferGeometry",(function(){return lo})),n.d(t,"OctahedronGeometry",(function(){return co})),n.d(t,"OneFactor",(function(){return N})),n.d(t,"OneMinusDstAlphaFactor",(function(){return G})),n.d(t,"OneMinusDstColorFactor",(function(){return q})),n.d(t,"OneMinusSrcAlphaFactor",(function(){return V})),n.d(t,"OneMinusSrcColorFactor",(function(){return U})),n.d(t,"OrthographicCamera",(function(){return Sc})),n.d(t,"PCFShadowMap",(function(){return g})),n.d(t,"PCFSoftShadowMap",(function(){return v})),n.d(t,"ParametricBufferGeometry",(function(){return ro})),n.d(t,"ParametricGeometry",(function(){return no})),n.d(t,"Particle",(function(){return gu})),n.d(t,"ParticleBasicMaterial",(function(){return bu})),n.d(t,"ParticleSystem",(function(){return vu})),n.d(t,"ParticleSystemMaterial",(function(){return xu})),n.d(t,"Path",(function(){return bc})),n.d(t,"PerspectiveCamera",(function(){return xa})),n.d(t,"Plane",(function(){return yn})),n.d(t,"PlaneBufferGeometry",(function(){return dr})),n.d(t,"PlaneGeometry",(function(){return hr})),n.d(t,"PlaneHelper",(function(){return su})),n.d(t,"PointCloud",(function(){return mu})),n.d(t,"PointCloudMaterial",(function(){return yu})),n.d(t,"PointLight",(function(){return _c})),n.d(t,"PointLightHelper",(function(){return Kl})),n.d(t,"Points",(function(){return Ja})),n.d(t,"PointsMaterial",(function(){return Ka})),n.d(t,"PolarGridHelper",(function(){return eu})),n.d(t,"PolyhedronBufferGeometry",(function(){return ao})),n.d(t,"PolyhedronGeometry",(function(){return io})),n.d(t,"PositionalAudio",(function(){return ul})),n.d(t,"PositionalAudioHelper",(function(){return tu})),n.d(t,"PropertyBinding",(function(){return Ml})),n.d(t,"PropertyMixer",(function(){return dl})),n.d(t,"QuadraticBezierCurve",(function(){return fc})),n.d(t,"QuadraticBezierCurve3",(function(){return mc})),n.d(t,"Quaternion",(function(){return Gt})),n.d(t,"QuaternionKeyframeTrack",(function(){return ks})),n.d(t,"QuaternionLinearInterpolant",(function(){return Bs})),n.d(t,"REVISION",(function(){return s})),n.d(t,"RGBADepthPacking",(function(){return Ft})),n.d(t,"RGBAFormat",(function(){return Ve})),n.d(t,"RGBA_ASTC_10x10_Format",(function(){return mt})),n.d(t,"RGBA_ASTC_10x5_Format",(function(){return dt})),n.d(t,"RGBA_ASTC_10x6_Format",(function(){return pt})),n.d(t,"RGBA_ASTC_10x8_Format",(function(){return ft})),n.d(t,"RGBA_ASTC_12x10_Format",(function(){return gt})),n.d(t,"RGBA_ASTC_12x12_Format",(function(){return vt})),n.d(t,"RGBA_ASTC_4x4_Format",(function(){return it})),n.d(t,"RGBA_ASTC_5x4_Format",(function(){return at})),n.d(t,"RGBA_ASTC_5x5_Format",(function(){return ot})),n.d(t,"RGBA_ASTC_6x5_Format",(function(){return st})),n.d(t,"RGBA_ASTC_6x6_Format",(function(){return ct})),n.d(t,"RGBA_ASTC_8x5_Format",(function(){return lt})),n.d(t,"RGBA_ASTC_8x6_Format",(function(){return ut})),n.d(t,"RGBA_ASTC_8x8_Format",(function(){return ht})),n.d(t,"RGBA_PVRTC_2BPPV1_Format",(function(){return nt})),n.d(t,"RGBA_PVRTC_4BPPV1_Format",(function(){return tt})),n.d(t,"RGBA_S3TC_DXT1_Format",(function(){return Je})),n.d(t,"RGBA_S3TC_DXT3_Format",(function(){return Ze})),n.d(t,"RGBA_S3TC_DXT5_Format",(function(){return Qe})),n.d(t,"RGBDEncoding",(function(){return Ht})),n.d(t,"RGBEEncoding",(function(){return Dt})),n.d(t,"RGBEFormat",(function(){return We})),n.d(t,"RGBFormat",(function(){return ze})),n.d(t,"RGBM16Encoding",(function(){return kt})),n.d(t,"RGBM7Encoding",(function(){return Bt})),n.d(t,"RGB_ETC1_Format",(function(){return rt})),n.d(t,"RGB_PVRTC_2BPPV1_Format",(function(){return et})),n.d(t,"RGB_PVRTC_4BPPV1_Format",(function(){return $e})),n.d(t,"RGB_S3TC_DXT1_Format",(function(){return Ke})),n.d(t,"RawShaderMaterial",(function(){return gs})),n.d(t,"RawUniformsGroup",(function(){return kl})),n.d(t,"Ray",(function(){return Lr})),n.d(t,"Raycaster",(function(){return Nl})),n.d(t,"RectAreaLight",(function(){return Pc})),n.d(t,"RectAreaLightHelper",(function(){return Jl})),n.d(t,"RedFormat",(function(){return Ye})),n.d(t,"ReinhardToneMapping",(function(){return se})),n.d(t,"RepeatWrapping",(function(){return be})),n.d(t,"ReverseSubtractEquation",(function(){return I})),n.d(t,"RingBufferGeometry",(function(){return ts})),n.d(t,"RingGeometry",(function(){return es})),n.d(t,"Scene",(function(){return ka})),n.d(t,"SceneUtils",(function(){return Gu})),n.d(t,"ShaderChunk",(function(){return wn})),n.d(t,"ShaderLib",(function(){return On})),n.d(t,"ShaderMaterial",(function(){return Sr})),n.d(t,"ShadowMaterial",(function(){return ms})),n.d(t,"Shape",(function(){return xc})),n.d(t,"ShapeBufferGeometry",(function(){return as})),n.d(t,"ShapeGeometry",(function(){return is})),n.d(t,"ShapePath",(function(){return Yc})),n.d(t,"ShapeUtils",(function(){return jo})),n.d(t,"ShortType",(function(){return Re})),n.d(t,"Skeleton",(function(){return ja})),n.d(t,"SkeletonHelper",(function(){return Yl})),n.d(t,"SkinnedMesh",(function(){return Va})),n.d(t,"SmoothShading",(function(){return E})),n.d(t,"Sphere",(function(){return vn})),n.d(t,"SphereBufferGeometry",(function(){return $o})),n.d(t,"SphereGeometry",(function(){return Qo})),n.d(t,"Spherical",(function(){return zl})),n.d(t,"SphericalHarmonics3",(function(){return tl})),n.d(t,"SphericalReflectionMapping",(function(){return ge})),n.d(t,"Spline",(function(){return Iu})),n.d(t,"SplineCurve",(function(){return gc})),n.d(t,"SplineCurve3",(function(){return Du})),n.d(t,"SpotLight",(function(){return Tc})),n.d(t,"SpotLightHelper",(function(){return Xl})),n.d(t,"SpotLightShadow",(function(){return Ac})),n.d(t,"Sprite",(function(){return Ua})),n.d(t,"SpriteMaterial",(function(){return Fa})),n.d(t,"SrcAlphaFactor",(function(){return z})),n.d(t,"SrcAlphaSaturateFactor",(function(){return X})),n.d(t,"SrcColorFactor",(function(){return F})),n.d(t,"StereoCamera",(function(){return al})),n.d(t,"StringKeyframeTrack",(function(){return Hs})),n.d(t,"SubtractEquation",(function(){return D})),n.d(t,"SubtractiveBlending",(function(){return C})),n.d(t,"TangentSpaceNormalMap",(function(){return Ut})),n.d(t,"TetrahedronBufferGeometry",(function(){return so})),n.d(t,"TetrahedronGeometry",(function(){return oo})),n.d(t,"TextBufferGeometry",(function(){return Zo})),n.d(t,"TextGeometry",(function(){return Jo})),n.d(t,"Texture",(function(){return un})),n.d(t,"TextureLoader",(function(){return Zs})),n.d(t,"TorusBufferGeometry",(function(){return xo})),n.d(t,"TorusGeometry",(function(){return bo})),n.d(t,"TorusKnotBufferGeometry",(function(){return yo})),n.d(t,"TorusKnotGeometry",(function(){return vo})),n.d(t,"Triangle",(function(){return Cr})),n.d(t,"TriangleFanDrawMode",(function(){return Ct})),n.d(t,"TriangleStripDrawMode",(function(){return Lt})),n.d(t,"TrianglesDrawMode",(function(){return St})),n.d(t,"TubeBufferGeometry",(function(){return go})),n.d(t,"TubeGeometry",(function(){return mo})),n.d(t,"UVMapping",(function(){return he})),n.d(t,"Uint16Attribute",(function(){return Su})),n.d(t,"Uint16BufferAttribute",(function(){return er})),n.d(t,"Uint32Attribute",(function(){return Cu})),n.d(t,"Uint32BufferAttribute",(function(){return nr})),n.d(t,"Uint8Attribute",(function(){return Au})),n.d(t,"Uint8BufferAttribute",(function(){return Zn})),n.d(t,"Uint8ClampedAttribute",(function(){return Tu})),n.d(t,"Uint8ClampedBufferAttribute",(function(){return Qn})),n.d(t,"Uncharted2ToneMapping",(function(){return ce})),n.d(t,"Uniform",(function(){return Sl})),n.d(t,"UniformsGroup",(function(){return Bl})),n.d(t,"UniformsLib",(function(){return Pn})),n.d(t,"UniformsUtils",(function(){return Sn})),n.d(t,"UnsignedByteType",(function(){return Le})),n.d(t,"UnsignedInt248Type",(function(){return Fe})),n.d(t,"UnsignedIntType",(function(){return De})),n.d(t,"UnsignedShort4444Type",(function(){return ke})),n.d(t,"UnsignedShort5551Type",(function(){return He})),n.d(t,"UnsignedShort565Type",(function(){return Ne})),n.d(t,"UnsignedShortType",(function(){return Pe})),n.d(t,"Vector2",(function(){return jt})),n.d(t,"Vector3",(function(){return Wt})),n.d(t,"Vector4",(function(){return hn})),n.d(t,"VectorKeyframeTrack",(function(){return Ns})),n.d(t,"Vertex",(function(){return wu})),n.d(t,"VertexColors",(function(){return T})),n.d(t,"VertexNormalsHelper",(function(){return ql})),n.d(t,"VideoTexture",(function(){return Za})),n.d(t,"WebGLMultisampleRenderTarget",(function(){return pn})),n.d(t,"WebGLRenderTarget",(function(){return dn})),n.d(t,"WebGLRenderTargetCube",(function(){return fn})),n.d(t,"WebGLRenderer",(function(){return Da})),n.d(t,"WebGLUtils",(function(){return va})),n.d(t,"WireframeGeometry",(function(){return to})),n.d(t,"WireframeHelper",(function(){return Nu})),n.d(t,"WrapAroundEnding",(function(){return _t})),n.d(t,"XHRLoader",(function(){return Fu})),n.d(t,"ZeroCurvatureEnding",(function(){return At})),n.d(t,"ZeroFactor",(function(){return H})),n.d(t,"ZeroSlopeEnding",(function(){return Tt})),n.d(t,"sRGBEncoding",(function(){return Pt})),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t}),Object.assign(r.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e)}}}});var i,a,o,s="106dev",c={LEFT:0,MIDDLE:1,RIGHT:2},l=0,u=1,h=2,d=3,p=0,f=1,m=0,g=1,v=2,y=0,b=1,x=2,w=1,E=2,M=0,A=1,T=2,_=0,S=1,L=2,C=3,R=4,P=5,O=100,D=101,I=102,B=103,k=104,H=200,N=201,F=202,U=203,z=204,V=205,j=206,G=207,W=208,q=209,X=210,Y=0,K=1,J=2,Z=3,Q=4,$=5,ee=6,te=7,ne=0,re=1,ie=2,ae=0,oe=1,se=2,ce=3,le=4,ue=5,he=300,de=301,pe=302,fe=303,me=304,ge=305,ve=306,ye=307,be=1e3,xe=1001,we=1002,Ee=1003,Me=1004,Ae=1005,Te=1006,_e=1007,Se=1008,Le=1009,Ce=1010,Re=1011,Pe=1012,Oe=1013,De=1014,Ie=1015,Be=1016,ke=1017,He=1018,Ne=1019,Fe=1020,Ue=1021,ze=1022,Ve=1023,je=1024,Ge=1025,We=Ve,qe=1026,Xe=1027,Ye=1028,Ke=33776,Je=33777,Ze=33778,Qe=33779,$e=35840,et=35841,tt=35842,nt=35843,rt=36196,it=37808,at=37809,ot=37810,st=37811,ct=37812,lt=37813,ut=37814,ht=37815,dt=37816,pt=37817,ft=37818,mt=37819,gt=37820,vt=37821,yt=2200,bt=2201,xt=2202,wt=2300,Et=2301,Mt=2302,At=2400,Tt=2401,_t=2402,St=0,Lt=1,Ct=2,Rt=3e3,Pt=3001,Ot=3007,Dt=3002,It=3003,Bt=3004,kt=3005,Ht=3006,Nt=3200,Ft=3201,Ut=0,zt=1,Vt={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var e=[],t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16);return function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]+"-"+e[255&n]+e[n>>8&255]+"-"+e[n>>16&15|64]+e[n>>24&255]+"-"+e[63&r|128]+e[r>>8&255]+"-"+e[r>>16&255]+e[r>>24&255]+e[255&i]+e[i>>8&255]+e[i>>16&255]+e[i>>24&255]).toUpperCase()}}(),clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Vt.DEG2RAD},radToDeg:function(e){return e*Vt.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};function jt(e,t){this.x=e||0,this.y=t||0}function Gt(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==r?r:1}function Wt(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}function qt(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(jt.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(jt.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}}),Object.assign(Gt,{slerp:function(e,t,n,r){return n.copy(e).slerp(t,r)},slerpFlat:function(e,t,n,r,i,a,o){var s=n[r+0],c=n[r+1],l=n[r+2],u=n[r+3],h=i[a+0],d=i[a+1],p=i[a+2],f=i[a+3];if(u!==f||s!==h||c!==d||l!==p){var m=1-o,g=s*h+c*d+l*p+u*f,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var b=Math.sqrt(y),x=Math.atan2(b,g*v);m=Math.sin(m*x)/b,o=Math.sin(o*x)/b}var w=o*v;if(s=s*m+h*w,c=c*m+d*w,l=l*m+p*w,u=u*m+f*w,m===1-o){var E=1/Math.sqrt(s*s+c*c+l*l+u*u);s*=E,c*=E,l*=E,u*=E}}e[t]=s,e[t+1]=c,e[t+2]=l,e[t+3]=u}}),Object.defineProperties(Gt.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(Gt.prototype,{isQuaternion:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,a=e.order,o=Math.cos,s=Math.sin,c=o(n/2),l=o(r/2),u=o(i/2),h=s(n/2),d=s(r/2),p=s(i/2);return"XYZ"===a?(this._x=h*l*u+c*d*p,this._y=c*d*u-h*l*p,this._z=c*l*p+h*d*u,this._w=c*l*u-h*d*p):"YXZ"===a?(this._x=h*l*u+c*d*p,this._y=c*d*u-h*l*p,this._z=c*l*p-h*d*u,this._w=c*l*u+h*d*p):"ZXY"===a?(this._x=h*l*u-c*d*p,this._y=c*d*u+h*l*p,this._z=c*l*p+h*d*u,this._w=c*l*u-h*d*p):"ZYX"===a?(this._x=h*l*u-c*d*p,this._y=c*d*u+h*l*p,this._z=c*l*p-h*d*u,this._w=c*l*u+h*d*p):"YZX"===a?(this._x=h*l*u+c*d*p,this._y=c*d*u+h*l*p,this._z=c*l*p-h*d*u,this._w=c*l*u-h*d*p):"XZY"===a&&(this._x=h*l*u-c*d*p,this._y=c*d*u-h*l*p,this._z=c*l*p+h*d*u,this._w=c*l*u+h*d*p),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,n=e.elements,r=n[0],i=n[4],a=n[8],o=n[1],s=n[5],c=n[9],l=n[2],u=n[6],h=n[10],d=r+s+h;return d>0?(t=.5/Math.sqrt(d+1),this._w=.25/t,this._x=(u-c)*t,this._y=(a-l)*t,this._z=(o-i)*t):r>s&&r>h?(t=2*Math.sqrt(1+r-s-h),this._w=(u-c)/t,this._x=.25*t,this._y=(i+o)/t,this._z=(a+l)/t):s>h?(t=2*Math.sqrt(1+s-r-h),this._w=(a-l)/t,this._x=(i+o)/t,this._y=.25*t,this._z=(c+u)/t):(t=2*Math.sqrt(1+h-r-s),this._w=(o-i)/t,this._x=(a+l)/t,this._y=(c+u)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(e,t){var n=e.dot(t)+1;return n<1e-6?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(Vt.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,r=e._y,i=e._z,a=e._w,o=t._x,s=t._y,c=t._z,l=t._w;return this._x=n*l+a*o+r*c-i*s,this._y=r*l+a*s+i*o-n*c,this._z=i*l+a*c+n*s-r*o,this._w=a*l-n*o-r*s-i*c,this.onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,a=this._w,o=a*e._w+n*e._x+r*e._y+i*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;var s=1-o*o;if(s<=Number.EPSILON){var c=1-t;return this._w=c*a+t*this._w,this._x=c*n+t*this._x,this._y=c*r+t*this._y,this._z=c*i+t*this._z,this.normalize()}var l=Math.sqrt(s),u=Math.atan2(l,o),h=Math.sin((1-t)*u)/l,d=Math.sin(t*u)/l;return this._w=a*h+this._w*d,this._x=n*h+this._x*d,this._y=r*h+this._y*d,this._z=i*h+this._z*d,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(Wt.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:(a=new Gt,function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(a.setFromEuler(e))}),applyAxisAngle:function(){var e=new Gt;return function(t,n){return this.applyQuaternion(e.setFromAxisAngle(t,n))}}(),applyMatrix3:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z,s=e.w,c=s*t+a*r-o*n,l=s*n+o*t-i*r,u=s*r+i*n-a*t,h=-i*t-a*n-o*r;return this.x=c*s+h*-i+l*-o-u*-a,this.y=l*s+h*-a+u*-i-c*-o,this.z=u*s+h*-o+c*-a-l*-i,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,r=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:(i=new Wt,function(e){return i.copy(this).projectOnVector(e),this.sub(i)}),reflect:function(){var e=new Wt;return function(t){return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(Vt.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(qt.prototype,{isMatrix3:!0,set:function(e,t,n,r,i,a,o,s,c){var l=this.elements;return l[0]=e,l[1]=r,l[2]=o,l[3]=t,l[4]=i,l[5]=s,l[6]=n,l[7]=a,l[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var e=new Wt;return function(t){for(var n=0,r=t.count;n<r;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.applyMatrix3(this),t.setXYZ(n,e.x,e.y,e.z);return t}}(),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[3],s=n[6],c=n[1],l=n[4],u=n[7],h=n[2],d=n[5],p=n[8],f=r[0],m=r[3],g=r[6],v=r[1],y=r[4],b=r[7],x=r[2],w=r[5],E=r[8];return i[0]=a*f+o*v+s*x,i[3]=a*m+o*y+s*w,i[6]=a*g+o*b+s*E,i[1]=c*f+l*v+u*x,i[4]=c*m+l*y+u*w,i[7]=c*g+l*b+u*E,i[2]=h*f+d*v+p*x,i[5]=h*m+d*y+p*w,i[8]=h*g+d*b+p*E,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],c=e[7],l=e[8];return t*a*l-t*o*c-n*i*l+n*o*s+r*i*c-r*a*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=e.elements,r=this.elements,i=n[0],a=n[1],o=n[2],s=n[3],c=n[4],l=n[5],u=n[6],h=n[7],d=n[8],p=d*c-l*h,f=l*u-d*s,m=h*s-c*u,g=i*p+a*f+o*m;if(0===g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return r[0]=p*y,r[1]=(o*h-d*a)*y,r[2]=(l*a-o*c)*y,r[3]=f*y,r[4]=(d*i-o*u)*y,r[5]=(o*s-l*i)*y,r[6]=m*y,r[7]=(a*u-h*i)*y,r[8]=(c*i-a*s)*y,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,r,i,a,o){var s=Math.cos(i),c=Math.sin(i);this.set(n*s,n*c,-n*(s*a+c*o)+a+e,-r*c,r*s,-r*(-c*a+s*o)+o+t,0,0,1)},scale:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){var t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],a=r[3],o=r[6],s=r[1],c=r[4],l=r[7];return r[0]=t*i+n*s,r[3]=t*a+n*c,r[6]=t*o+n*l,r[1]=-n*i+t*s,r[4]=-n*a+t*c,r[7]=-n*o+t*l,this},translate:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});var Xt,Yt,Kt,Jt,Zt,Qt,$t,en,tn,nn,rn,an,on,sn,cn={getDataURL:function(e){var t;if("undefined"==typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===o&&(o=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),o.width=e.width,o.height=e.height;var n=o.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=o}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},ln=0;function un(e,t,n,r,i,a,o,s,c,l){Object.defineProperty(this,"id",{value:ln++}),this.uuid=Vt.generateUUID(),this.name="",this.image=void 0!==e?e:un.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:un.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:xe,this.wrapT=void 0!==r?r:xe,this.magFilter=void 0!==i?i:Te,this.minFilter=void 0!==a?a:Se,this.anisotropy=void 0!==c?c:1,this.format=void 0!==o?o:Ve,this.type=void 0!==s?s:Le,this.offset=new jt(0,0),this.repeat=new jt(1,1),this.center=new jt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new qt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:Rt,this.version=0,this.onUpdate=null}function hn(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==r?r:1}function dn(e,t,n){this.width=e,this.height=t,this.scissor=new hn(0,0,e,t),this.scissorTest=!1,this.viewport=new hn(0,0,e,t),n=n||{},this.texture=new un(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:Te,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function pn(e,t,n){dn.call(this,e,t,n),this.samples=4}function fn(e,t,n){dn.call(this,e,t,n)}function mn(e,t,n,r,i,a,o,s,c,l,u,h){un.call(this,null,a,o,s,c,l,r,i,u,h),this.image={data:e,width:t,height:n},this.magFilter=void 0!==c?c:Ee,this.minFilter=void 0!==l?l:Ee,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function gn(e,t){this.min=void 0!==e?e:new Wt(1/0,1/0,1/0),this.max=void 0!==t?t:new Wt(-1/0,-1/0,-1/0)}function vn(e,t){this.center=void 0!==e?e:new Wt,this.radius=void 0!==t?t:0}function yn(e,t){this.normal=void 0!==e?e:new Wt(1,0,0),this.constant=void 0!==t?t:0}function bn(e,t,n,r,i,a){this.planes=[void 0!==e?e:new yn,void 0!==t?t:new yn,void 0!==n?n:new yn,void 0!==r?r:new yn,void 0!==i?i:new yn,void 0!==a?a:new yn]}function xn(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}un.DEFAULT_IMAGE=void 0,un.DEFAULT_MAPPING=he,un.prototype=Object.assign(Object.create(r.prototype),{constructor:un,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=Vt.generateUUID()),!t&&void 0===e.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var a=0,o=r.length;a<o;a++)i.push(cn.getDataURL(r[a]))}else i=cn.getDataURL(r);e.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return t||(e.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==he)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case be:e.x=e.x-Math.floor(e.x);break;case xe:e.x=e.x<0?0:1;break;case we:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case be:e.y=e.y-Math.floor(e.y);break;case xe:e.y=e.y<0?0:1;break;case we:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(un.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(hn.prototype,{isVector4:!0,set:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,r,i,a=e.elements,o=a[0],s=a[4],c=a[8],l=a[1],u=a[5],h=a[9],d=a[2],p=a[6],f=a[10];if(Math.abs(s-l)<.01&&Math.abs(c-d)<.01&&Math.abs(h-p)<.01){if(Math.abs(s+l)<.1&&Math.abs(c+d)<.1&&Math.abs(h+p)<.1&&Math.abs(o+u+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(o+1)/2,g=(u+1)/2,v=(f+1)/2,y=(s+l)/4,b=(c+d)/4,x=(h+p)/4;return m>g&&m>v?m<.01?(n=0,r=.707106781,i=.707106781):(r=y/(n=Math.sqrt(m)),i=b/n):g>v?g<.01?(n=.707106781,r=0,i=.707106781):(n=y/(r=Math.sqrt(g)),i=x/r):v<.01?(n=.707106781,r=.707106781,i=0):(n=b/(i=Math.sqrt(v)),r=x/i),this.set(n,r,i,t),this}var w=Math.sqrt((p-h)*(p-h)+(c-d)*(c-d)+(l-s)*(l-s));return Math.abs(w)<.001&&(w=1),this.x=(p-h)/w,this.y=(c-d)/w,this.z=(l-s)/w,this.w=Math.acos((o+u+f-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return void 0===Xt&&(Xt=new hn,Yt=new hn),Xt.set(e,e,e,e),Yt.set(t,t,t,t),this.clamp(Xt,Yt)},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),dn.prototype=Object.assign(Object.create(r.prototype),{constructor:dn,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.texture.image.width=e,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),pn.prototype=Object.assign(Object.create(dn.prototype),{constructor:pn,isWebGLMultisampleRenderTarget:!0,copy:function(e){return dn.prototype.copy.call(this,e),this.samples=e.samples,this}}),fn.prototype=Object.create(dn.prototype),fn.prototype.constructor=fn,fn.prototype.isWebGLRenderTargetCube=!0,fn.prototype.fromEquirectangularTexture=function(e,t){this.texture.type=t.type,this.texture.format=t.format,this.texture.encoding=t.encoding;var n=new THREE.Scene,r={uniforms:{tEquirect:{value:null}},vertexShader:"\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t#include <begin_vertex>\n\t\t\t\t#include <project_vertex>\n\n\t\t\t}\n\t\t\t",fragmentShader:"\n\t\t\tuniform sampler2D tEquirect;\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t#define RECIPROCAL_PI 0.31830988618\n\t\t\t#define RECIPROCAL_PI2 0.15915494\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\tvec2 sampleUV;\n\n\t\t\t\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\n\t\t\t\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\n\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t}\n\t\t\t"},i=new THREE.ShaderMaterial({type:"CubemapFromEquirect",uniforms:THREE.UniformsUtils.clone(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:THREE.BackSide,blending:THREE.NoBlending});i.uniforms.tEquirect.value=t;var a=new THREE.Mesh(new THREE.BoxBufferGeometry(5,5,5),i);n.add(a);var o=new THREE.CubeCamera(1,10,1);return o.renderTarget=this,o.renderTarget.texture.name="CubeCameraTexture",o.update(e,n),a.geometry.dispose(),a.material.dispose(),this},mn.prototype=Object.create(un.prototype),mn.prototype.constructor=mn,mn.prototype.isDataTexture=!0,Object.assign(gn.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,c=e.length;s<c;s+=3){var l=e[s],u=e[s+1],h=e[s+2];l<t&&(t=l),u<n&&(n=u),h<r&&(r=h),l>i&&(i=l),u>a&&(a=u),h>o&&(o=h)}return this.min.set(t,n,r),this.max.set(i,a,o),this},setFromBufferAttribute:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,c=e.count;s<c;s++){var l=e.getX(s),u=e.getY(s),h=e.getZ(s);l<t&&(t=l),u<n&&(n=u),h<r&&(r=h),l>i&&(i=l),u>a&&(a=u),h>o&&(o=h)}return this.min.set(t,n,r),this.max.set(i,a,o),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new Wt;return function(t,n){var r=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}}(),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new Wt),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new Wt),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){var e,t,n,r=new Wt;function i(i){var a=i.geometry;if(void 0!==a)if(a.isGeometry){var o=a.vertices;for(t=0,n=o.length;t<n;t++)r.copy(o[t]),r.applyMatrix4(i.matrixWorld),e.expandByPoint(r)}else if(a.isBufferGeometry){var s=a.attributes.position;if(void 0!==s)for(t=0,n=s.count;t<n;t++)r.fromBufferAttribute(s,t).applyMatrix4(i.matrixWorld),e.expandByPoint(r)}}return function(t){return e=this,t.updateMatrixWorld(!0),t.traverse(i),this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new Wt),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:(Jt=new Wt,function(e){return this.clampPoint(e.center,Jt),Jt.distanceToSquared(e.center)<=e.radius*e.radius}),intersectsPlane:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant},intersectsTriangle:function(){var e=new Wt,t=new Wt,n=new Wt,r=new Wt,i=new Wt,a=new Wt,o=new Wt,s=new Wt,c=new Wt,l=new Wt;function u(r){var i,a;for(i=0,a=r.length-3;i<=a;i+=3){o.fromArray(r,i);var s=c.x*Math.abs(o.x)+c.y*Math.abs(o.y)+c.z*Math.abs(o.z),l=e.dot(o),u=t.dot(o),h=n.dot(o);if(Math.max(-Math.max(l,u,h),Math.min(l,u,h))>s)return!1}return!0}return function(o){if(this.isEmpty())return!1;this.getCenter(s),c.subVectors(this.max,s),e.subVectors(o.a,s),t.subVectors(o.b,s),n.subVectors(o.c,s),r.subVectors(t,e),i.subVectors(n,t),a.subVectors(e,n);var h=[0,-r.z,r.y,0,-i.z,i.y,0,-a.z,a.y,r.z,0,-r.x,i.z,0,-i.x,a.z,0,-a.x,-r.y,r.x,0,-i.y,i.x,0,-a.y,a.x,0];return!!u(h)&&(!!u(h=[1,0,0,0,1,0,0,0,1])&&(l.crossVectors(r,i),u(h=[l.x,l.y,l.z])))}}(),clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new Wt),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new Wt;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new Wt;return function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(e).length(),t}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:(Kt=[new Wt,new Wt,new Wt,new Wt,new Wt,new Wt,new Wt,new Wt],function(e){return this.isEmpty()?this:(Kt[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Kt[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Kt[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Kt[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Kt[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Kt[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Kt[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Kt[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Kt),this)}),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(vn.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:(Zt=new gn,function(e,t){var n=this.center;void 0!==t?n.copy(t):Zt.setFromPoints(e).getCenter(n);for(var r=0,i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new Wt),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new gn),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(yn.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new Wt,t=new Wt;return function(n,r,i){var a=e.subVectors(i,r).cross(t.subVectors(n,r)).normalize();return this.setFromNormalAndCoplanarPoint(a,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new Wt),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var e=new Wt;return function(t,n){void 0===n&&(console.warn("THREE.Plane: .intersectLine() target is now required"),n=new Wt);var r=t.delta(e),i=this.normal.dot(r);if(0===i)return 0===this.distanceToPoint(t.start)?n.copy(t.start):void 0;var a=-(t.start.dot(this.normal)+this.constant)/i;return a<0||a>1?void 0:n.copy(r).multiplyScalar(a).add(t.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new Wt),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new Wt,t=new qt;return function(n,r){var i=r||t.getNormalMatrix(n),a=this.coplanarPoint(e).applyMatrix4(n),o=this.normal.applyMatrix3(i).normalize();return this.constant=-a.dot(o),this}}(),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(bn.prototype,{set:function(e,t,n,r,i,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromMatrix:function(e){var t=this.planes,n=e.elements,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],c=n[5],l=n[6],u=n[7],h=n[8],d=n[9],p=n[10],f=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return t[0].setComponents(o-r,u-s,f-h,y-m).normalize(),t[1].setComponents(o+r,u+s,f+h,y+m).normalize(),t[2].setComponents(o+i,u+c,f+d,y+g).normalize(),t[3].setComponents(o-i,u-c,f-d,y-g).normalize(),t[4].setComponents(o-a,u-l,f-p,y-v).normalize(),t[5].setComponents(o+a,u+l,f+p,y+v).normalize(),this},intersectsObject:($t=new vn,function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),$t.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere($t)}),intersectsSprite:function(){var e=new vn;return function(t){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++){if(t[i].distanceToPoint(n)<r)return!1}return!0},intersectsBox:(Qt=new Wt,function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(Qt.x=r.normal.x>0?e.max.x:e.min.x,Qt.y=r.normal.y>0?e.max.y:e.min.y,Qt.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Qt)<0)return!1}return!0}),containsPoint:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}}),Object.assign(xn.prototype,{isMatrix4:!0,set:function(e,t,n,r,i,a,o,s,c,l,u,h,d,p,f,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=a,g[9]=o,g[13]=s,g[2]=c,g[6]=l,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new xn).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},copyPosition:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:function(){var e=new Wt;return function(t){var n=this.elements,r=t.elements,i=1/e.setFromMatrixColumn(t,0).length(),a=1/e.setFromMatrixColumn(t,1).length(),o=1/e.setFromMatrixColumn(t,2).length();return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=0,n[4]=r[4]*a,n[5]=r[5]*a,n[6]=r[6]*a,n[7]=0,n[8]=r[8]*o,n[9]=r[9]*o,n[10]=r[10]*o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}}(),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),c=Math.sin(r),l=Math.cos(i),u=Math.sin(i);if("XYZ"===e.order){var h=a*l,d=a*u,p=o*l,f=o*u;t[0]=s*l,t[4]=-s*u,t[8]=c,t[1]=d+p*c,t[5]=h-f*c,t[9]=-o*s,t[2]=f-h*c,t[6]=p+d*c,t[10]=a*s}else if("YXZ"===e.order){var m=s*l,g=s*u,v=c*l,y=c*u;t[0]=m+y*o,t[4]=v*o-g,t[8]=a*c,t[1]=a*u,t[5]=a*l,t[9]=-o,t[2]=g*o-v,t[6]=y+m*o,t[10]=a*s}else if("ZXY"===e.order){m=s*l,g=s*u,v=c*l,y=c*u;t[0]=m-y*o,t[4]=-a*u,t[8]=v+g*o,t[1]=g+v*o,t[5]=a*l,t[9]=y-m*o,t[2]=-a*c,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){h=a*l,d=a*u,p=o*l,f=o*u;t[0]=s*l,t[4]=p*c-d,t[8]=h*c+f,t[1]=s*u,t[5]=f*c+h,t[9]=d*c-p,t[2]=-c,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){var b=a*s,x=a*c,w=o*s,E=o*c;t[0]=s*l,t[4]=E-b*u,t[8]=w*u+x,t[1]=u,t[5]=a*l,t[9]=-o*l,t[2]=-c*l,t[6]=x*u+w,t[10]=b-E*u}else if("XZY"===e.order){b=a*s,x=a*c,w=o*s,E=o*c;t[0]=s*l,t[4]=-u,t[8]=c*l,t[1]=b*u+E,t[5]=a*l,t[9]=x*u-w,t[2]=w*u-x,t[6]=o*l,t[10]=E*u+b}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:(on=new Wt(0,0,0),sn=new Wt(1,1,1),function(e){return this.compose(on,e,sn)}),lookAt:(nn=new Wt,rn=new Wt,an=new Wt,function(e,t,n){var r=this.elements;return an.subVectors(e,t),0===an.lengthSq()&&(an.z=1),an.normalize(),nn.crossVectors(n,an),0===nn.lengthSq()&&(1===Math.abs(n.z)?an.x+=1e-4:an.z+=1e-4,an.normalize(),nn.crossVectors(n,an)),nn.normalize(),rn.crossVectors(an,nn),r[0]=nn.x,r[4]=rn.x,r[8]=an.x,r[1]=nn.y,r[5]=rn.y,r[9]=an.y,r[2]=nn.z,r[6]=rn.z,r[10]=an.z,this}),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[4],s=n[8],c=n[12],l=n[1],u=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],y=n[7],b=n[11],x=n[15],w=r[0],E=r[4],M=r[8],A=r[12],T=r[1],_=r[5],S=r[9],L=r[13],C=r[2],R=r[6],P=r[10],O=r[14],D=r[3],I=r[7],B=r[11],k=r[15];return i[0]=a*w+o*T+s*C+c*D,i[4]=a*E+o*_+s*R+c*I,i[8]=a*M+o*S+s*P+c*B,i[12]=a*A+o*L+s*O+c*k,i[1]=l*w+u*T+h*C+d*D,i[5]=l*E+u*_+h*R+d*I,i[9]=l*M+u*S+h*P+d*B,i[13]=l*A+u*L+h*O+d*k,i[2]=p*w+f*T+m*C+g*D,i[6]=p*E+f*_+m*R+g*I,i[10]=p*M+f*S+m*P+g*B,i[14]=p*A+f*L+m*O+g*k,i[3]=v*w+y*T+b*C+x*D,i[7]=v*E+y*_+b*R+x*I,i[11]=v*M+y*S+b*P+x*B,i[15]=v*A+y*L+b*O+x*k,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(){var e=new Wt;return function(t){for(var n=0,r=t.count;n<r;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.applyMatrix4(this),t.setXYZ(n,e.x,e.y,e.z);return t}}(),determinant:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],o=e[5],s=e[9],c=e[13],l=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+i*s*u-r*c*u-i*o*h+n*c*h+r*o*d-n*s*d)+e[7]*(+t*s*d-t*c*h+i*a*h-r*a*d+r*c*l-i*s*l)+e[11]*(+t*c*u-t*o*d-i*a*u+n*a*d+i*o*l-n*c*l)+e[15]*(-r*o*l-t*s*u+t*o*h+r*a*u-n*a*h+n*s*l)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this},getInverse:function(e,t){var n=this.elements,r=e.elements,i=r[0],a=r[1],o=r[2],s=r[3],c=r[4],l=r[5],u=r[6],h=r[7],d=r[8],p=r[9],f=r[10],m=r[11],g=r[12],v=r[13],y=r[14],b=r[15],x=p*y*h-v*f*h+v*u*m-l*y*m-p*u*b+l*f*b,w=g*f*h-d*y*h-g*u*m+c*y*m+d*u*b-c*f*b,E=d*v*h-g*p*h+g*l*m-c*v*m-d*l*b+c*p*b,M=g*p*u-d*v*u-g*l*f+c*v*f+d*l*y-c*p*y,A=i*x+a*w+o*E+s*M;if(0===A){var T="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(T);return console.warn(T),this.identity()}var _=1/A;return n[0]=x*_,n[1]=(v*f*s-p*y*s-v*o*m+a*y*m+p*o*b-a*f*b)*_,n[2]=(l*y*s-v*u*s+v*o*h-a*y*h-l*o*b+a*u*b)*_,n[3]=(p*u*s-l*f*s-p*o*h+a*f*h+l*o*m-a*u*m)*_,n[4]=w*_,n[5]=(d*y*s-g*f*s+g*o*m-i*y*m-d*o*b+i*f*b)*_,n[6]=(g*u*s-c*y*s-g*o*h+i*y*h+c*o*b-i*u*b)*_,n[7]=(c*f*s-d*u*s+d*o*h-i*f*h-c*o*m+i*u*m)*_,n[8]=E*_,n[9]=(g*p*s-d*v*s-g*a*m+i*v*m+d*a*b-i*p*b)*_,n[10]=(c*v*s-g*l*s+g*a*h-i*v*h-c*a*b+i*l*b)*_,n[11]=(d*l*s-c*p*s-d*a*h+i*p*h+c*a*m-i*l*m)*_,n[12]=M*_,n[13]=(d*v*o-g*p*o+g*a*f-i*v*f-d*a*y+i*p*y)*_,n[14]=(g*l*o-c*v*o-g*a*u+i*v*u+c*a*y-i*l*y)*_,n[15]=(c*p*o-d*l*o+d*a*u-i*p*u-c*a*f+i*l*f)*_,this},scale:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,o=e.y,s=e.z,c=i*a,l=i*o;return this.set(c*a+n,c*o-r*s,c*s+r*o,0,c*o+r*s,l*o+n,l*s-r*a,0,c*s-r*o,l*s+r*a,i*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){var r=this.elements,i=t._x,a=t._y,o=t._z,s=t._w,c=i+i,l=a+a,u=o+o,h=i*c,d=i*l,p=i*u,f=a*l,m=a*u,g=o*u,v=s*c,y=s*l,b=s*u,x=n.x,w=n.y,E=n.z;return r[0]=(1-(f+g))*x,r[1]=(d+b)*x,r[2]=(p-y)*x,r[3]=0,r[4]=(d-b)*w,r[5]=(1-(h+g))*w,r[6]=(m+v)*w,r[7]=0,r[8]=(p+y)*E,r[9]=(m-v)*E,r[10]=(1-(h+f))*E,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this},decompose:(en=new Wt,tn=new xn,function(e,t,n){var r=this.elements,i=en.set(r[0],r[1],r[2]).length(),a=en.set(r[4],r[5],r[6]).length(),o=en.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],tn.copy(this);var s=1/i,c=1/a,l=1/o;return tn.elements[0]*=s,tn.elements[1]*=s,tn.elements[2]*=s,tn.elements[4]*=c,tn.elements[5]*=c,tn.elements[6]*=c,tn.elements[8]*=l,tn.elements[9]*=l,tn.elements[10]*=l,t.setFromRotationMatrix(tn),n.x=i,n.y=a,n.z=o,this}),makePerspective:function(e,t,n,r,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*i/(t-e),c=2*i/(n-r),l=(t+e)/(t-e),u=(n+r)/(n-r),h=-(a+i)/(a-i),d=-2*a*i/(a-i);return o[0]=s,o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=c,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(e,t,n,r,i,a){var o=this.elements,s=1/(t-e),c=1/(n-r),l=1/(a-i),u=(t+e)*s,h=(n+r)*c,d=(a+i)*l;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*c,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*l,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}});var wn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = normalMatrix * objectTangent;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif",lights_pars_begin:"uniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#endif\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\tfloat clearCoatInv = 1.0 - clearCoatDHR;\n\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec3 singleScattering = vec3( 0.0 );\n\t\tvec3 multiScattering = vec3( 0.0 );\n\t\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\t\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * singleScattering;\n\t\treflectedLight.indirectDiffuse += multiScattering * cosineWeightedIrradiance;\n\t\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n\t#else\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#endif\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, irradiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t#endif\n#endif",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\t#ifdef USE_TANGENT\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy = normalScale * mapN.xy;\n\t\t\tnormal = normalize( vTBN * mapN );\n\t\t#else\n\t\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t\t#endif\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#if defined( DITHERING )\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"};function En(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}return t}function Mn(e){for(var t={},n=0;n<e.length;n++){var r=En(e[n]);for(var i in r)t[i]=r[i]}return t}var An,Tn,_n,Sn={clone:En,merge:Mn},Ln={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Cn(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}Object.assign(Cn.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(){function e(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}return function(t,n,r){if(t=Vt.euclideanModulo(t,1),n=Vt.clamp(n,0,1),r=Vt.clamp(r,0,1),0===n)this.r=this.g=this.b=r;else{var i=r<=.5?r*(1+n):r+n-r*n,a=2*r-i;this.r=e(a,i,t+1/3),this.g=e(a,i,t),this.b=e(a,i,t-1/3)}return this}}(),setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var r,i=n[1],a=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,c=parseInt(r[3],10)/100;return t(r[5]),this.setHSL(o,s,c)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(e)){var l,u=(l=n[1]).length;if(3===u)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}e&&e.length>0&&(void 0!==(l=Ln[e])?this.setHex(l):console.warn("THREE.Color: Unknown color "+e));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(){function e(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}return function(t){return this.r=e(t.r),this.g=e(t.g),this.b=e(t.b),this}}(),copyLinearToSRGB:function(){function e(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}return function(t){return this.r=e(t.r),this.g=e(t.g),this.b=e(t.b),this}}(),convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,r=this.r,i=this.g,a=this.b,o=Math.max(r,i,a),s=Math.min(r,i,a),c=(s+o)/2;if(s===o)t=0,n=0;else{var l=o-s;switch(n=c<=.5?l/(o+s):l/(2-o-s),o){case r:t=(i-a)/l+(i<a?6:0);break;case i:t=(a-r)/l+2;break;case a:t=(r-i)/l+4}t/=6}return e.h=t,e.s=n,e.l=c,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:(_n={},function(e,t,n){return this.getHSL(_n),_n.h+=e,_n.s+=t,_n.l+=n,this.setHSL(_n.h,_n.s,_n.l),this}),add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:(An={h:0,s:0,l:0},Tn={h:0,s:0,l:0},function(e,t){this.getHSL(An),e.getHSL(Tn);var n=Vt.lerp(An.h,Tn.h,t),r=Vt.lerp(An.s,Tn.s,t),i=Vt.lerp(An.l,Tn.l,t);return this.setHSL(n,r,i),this}),equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var Rn,Pn={common:{diffuse:{value:new Cn(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new qt},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new jt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Cn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Cn(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new qt}},sprite:{diffuse:{value:new Cn(15658734)},opacity:{value:1},center:{value:new jt(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new qt}}},On={basic:{uniforms:Mn([Pn.common,Pn.specularmap,Pn.envmap,Pn.aomap,Pn.lightmap,Pn.fog]),vertexShader:wn.meshbasic_vert,fragmentShader:wn.meshbasic_frag},lambert:{uniforms:Mn([Pn.common,Pn.specularmap,Pn.envmap,Pn.aomap,Pn.lightmap,Pn.emissivemap,Pn.fog,Pn.lights,{emissive:{value:new Cn(0)}}]),vertexShader:wn.meshlambert_vert,fragmentShader:wn.meshlambert_frag},phong:{uniforms:Mn([Pn.common,Pn.specularmap,Pn.envmap,Pn.aomap,Pn.lightmap,Pn.emissivemap,Pn.bumpmap,Pn.normalmap,Pn.displacementmap,Pn.gradientmap,Pn.fog,Pn.lights,{emissive:{value:new Cn(0)},specular:{value:new Cn(1118481)},shininess:{value:30}}]),vertexShader:wn.meshphong_vert,fragmentShader:wn.meshphong_frag},standard:{uniforms:Mn([Pn.common,Pn.envmap,Pn.aomap,Pn.lightmap,Pn.emissivemap,Pn.bumpmap,Pn.normalmap,Pn.displacementmap,Pn.roughnessmap,Pn.metalnessmap,Pn.fog,Pn.lights,{emissive:{value:new Cn(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:wn.meshphysical_vert,fragmentShader:wn.meshphysical_frag},matcap:{uniforms:Mn([Pn.common,Pn.bumpmap,Pn.normalmap,Pn.displacementmap,Pn.fog,{matcap:{value:null}}]),vertexShader:wn.meshmatcap_vert,fragmentShader:wn.meshmatcap_frag},points:{uniforms:Mn([Pn.points,Pn.fog]),vertexShader:wn.points_vert,fragmentShader:wn.points_frag},dashed:{uniforms:Mn([Pn.common,Pn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:wn.linedashed_vert,fragmentShader:wn.linedashed_frag},depth:{uniforms:Mn([Pn.common,Pn.displacementmap]),vertexShader:wn.depth_vert,fragmentShader:wn.depth_frag},normal:{uniforms:Mn([Pn.common,Pn.bumpmap,Pn.normalmap,Pn.displacementmap,{opacity:{value:1}}]),vertexShader:wn.normal_vert,fragmentShader:wn.normal_frag},sprite:{uniforms:Mn([Pn.sprite,Pn.fog]),vertexShader:wn.sprite_vert,fragmentShader:wn.sprite_frag},background:{uniforms:{uvTransform:{value:new qt},t2D:{value:null}},vertexShader:wn.background_vert,fragmentShader:wn.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:wn.cube_vert,fragmentShader:wn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:wn.equirect_vert,fragmentShader:wn.equirect_frag},distanceRGBA:{uniforms:Mn([Pn.common,Pn.displacementmap,{referencePosition:{value:new Wt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:wn.distanceRGBA_vert,fragmentShader:wn.distanceRGBA_frag},shadow:{uniforms:Mn([Pn.lights,Pn.fog,{color:{value:new Cn(0)},opacity:{value:1}}]),vertexShader:wn.shadow_vert,fragmentShader:wn.shadow_frag}};function Dn(){var e=null,t=!1,n=null;function r(i,a){!1!==t&&(n(i,a),e.requestAnimationFrame(r))}return{start:function(){!0!==t&&null!==n&&(e.requestAnimationFrame(r),t=!0)},stop:function(){t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function In(e){var t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);var r=t.get(n);r&&(e.deleteBuffer(r.buffer),t.delete(n))},update:function(n,r){n.isInterleavedBufferAttribute&&(n=n.data);var i=t.get(n);void 0===i?t.set(n,function(t,n){var r=t.array,i=t.dynamic?35048:35044,a=e.createBuffer();e.bindBuffer(n,a),e.bufferData(n,r,i),t.onUploadCallback();var o=5126;return r instanceof Float32Array?o=5126:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?o=5123:r instanceof Int16Array?o=5122:r instanceof Uint32Array?o=5125:r instanceof Int32Array?o=5124:r instanceof Int8Array?o=5120:r instanceof Uint8Array&&(o=5121),{buffer:a,type:o,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version}}(n,r)):i.version<n.version&&(!function(t,n,r){var i=n.array,a=n.updateRange;e.bindBuffer(r,t),!1===n.dynamic?e.bufferData(r,i,35044):-1===a.count?e.bufferSubData(r,0,i):0===a.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(r,a.offset*i.BYTES_PER_ELEMENT,i.subarray(a.offset,a.offset+a.count)),a.count=-1)}(i.buffer,n,r),i.version=n.version)}}}function Bn(e,t,n,r,i,a){this.a=e,this.b=t,this.c=n,this.normal=r&&r.isVector3?r:new Wt,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new Cn,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==a?a:0}function kn(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._order=r||kn.DefaultOrder}function Hn(){this.mask=1}On.physical={uniforms:Mn([On.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:wn.meshphysical_vert,fragmentShader:wn.meshphysical_frag},Object.assign(Bn.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}}),kn.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],kn.DefaultOrder="XYZ",Object.defineProperties(kn.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(kn.prototype,{isEuler:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var r=Vt.clamp,i=e.elements,a=i[0],o=i[4],s=i[8],c=i[1],l=i[5],u=i[9],h=i[2],d=i[6],p=i[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-u,p),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(d,l),this._z=0)):"YXZ"===t?(this._x=Math.asin(-r(u,-1,1)),Math.abs(u)<.99999?(this._y=Math.atan2(s,p),this._z=Math.atan2(c,l)):(this._y=Math.atan2(-h,a),this._z=0)):"ZXY"===t?(this._x=Math.asin(r(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(c,a))):"ZYX"===t?(this._y=Math.asin(-r(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(d,p),this._z=Math.atan2(c,a)):(this._x=0,this._z=Math.atan2(-o,l))):"YZX"===t?(this._z=Math.asin(r(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-h,a)):(this._x=0,this._y=Math.atan2(s,p))):"XZY"===t?(this._z=Math.asin(-r(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(d,l),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-u,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:function(){var e=new xn;return function(t,n,r){return e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,n,r)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:(Rn=new Gt,function(e){return Rn.setFromEuler(this),this.setFromQuaternion(Rn,e)}),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new Wt(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(Hn.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!=(this.mask&e.mask)}});var Nn,Fn,Un,zn,Vn,jn=0;function Gn(){Object.defineProperty(this,"id",{value:jn++}),this.uuid=Vt.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Gn.DefaultUp.clone();var e=new Wt,t=new kn,n=new Gt,r=new Wt(1,1,1);t.onChange((function(){n.setFromEuler(t,!1)})),n.onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new xn},normalMatrix:{value:new qt}}),this.matrix=new xn,this.matrixWorld=new xn,this.matrixAutoUpdate=Gn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Hn,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}Gn.DefaultUp=new Wt(0,1,0),Gn.DefaultMatrixAutoUpdate=!0,Gn.prototype=Object.assign(Object.create(r.prototype),{constructor:Gn,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:(Vn=new Gt,function(e,t){return Vn.setFromAxisAngle(e,t),this.quaternion.multiply(Vn),this}),rotateOnWorldAxis:function(){var e=new Gt;return function(t,n){return e.setFromAxisAngle(t,n),this.quaternion.premultiply(e),this}}(),rotateX:function(){var e=new Wt(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new Wt(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new Wt(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new Wt;return function(t,n){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(n)),this}}(),translateX:function(){var e=new Wt(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new Wt(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new Wt(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:(zn=new xn,function(e){return e.applyMatrix4(zn.getInverse(this.matrixWorld))}),lookAt:function(){var e=new Gt,t=new xn,n=new Wt,r=new Wt;return function(i,a,o){i.isVector3?n.copy(i):n.set(i,a,o);var s=this.parent;this.updateWorldMatrix(!0,!1),r.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?t.lookAt(r,n,this.up):t.lookAt(n,r,this.up),this.quaternion.setFromRotationMatrix(t),s&&(t.extractRotation(s.matrixWorld),e.setFromRotationMatrix(t),this.quaternion.premultiply(e.inverse()))}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(n,1)),this},attach:(Un=new xn,function(e){return this.updateWorldMatrix(!0,!1),Un.getInverse(this.matrixWorld),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Un.multiply(e.parent.matrixWorld)),e.applyMatrix(Un),e.updateWorldMatrix(!1,!1),this.add(e),this}),getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new Wt),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(Nn=new Wt,Fn=new Wt,function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new Gt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Nn,e,Fn),e}),getWorldScale:function(){var e=new Wt,t=new Gt;return function(n){return void 0===n&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),n=new Wt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,n),n}}(),getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Wt),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,i=0,a=r.length;i<a;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isMesh&&this.drawMode!==St&&(r.drawMode=this.drawMode),this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,c=o.length;s<c;s++){var l=o[s];i(e.shapes,l)}else i(e.shapes,o)}}if(void 0!==this.material)if(Array.isArray(this.material)){var u=[];for(s=0,c=this.material.length;s<c;s++)u.push(i(e.materials,this.material[s]));r.material=u}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(e).object)}if(t){var h=m(e.geometries),d=m(e.materials),p=m(e.textures),f=m(e.images);o=m(e.shapes);h.length>0&&(n.geometries=h),d.length>0&&(n.materials=d),p.length>0&&(n.textures=p),f.length>0&&(n.images=f),o.length>0&&(n.shapes=o)}return n.object=r,n;function m(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}});var Wn,qn,Xn=0;function Yn(){Object.defineProperty(this,"id",{value:Xn+=2}),this.uuid=Vt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function Kn(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this._array=e,this._itemSize=t,this.count=void 0!==e?e.length/t:0,this._normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0,this.versionVAO=0}function Jn(e,t,n){Kn.call(this,new Int8Array(e),t,n)}function Zn(e,t,n){Kn.call(this,new Uint8Array(e),t,n)}function Qn(e,t,n){Kn.call(this,new Uint8ClampedArray(e),t,n)}function $n(e,t,n){Kn.call(this,new Int16Array(e),t,n)}function er(e,t,n){Kn.call(this,new Uint16Array(e),t,n)}function tr(e,t,n){Kn.call(this,new Int32Array(e),t,n)}function nr(e,t,n){Kn.call(this,new Uint32Array(e),t,n)}function rr(e,t,n){Kn.call(this,new Float32Array(e),t,n)}function ir(e,t,n){Kn.call(this,new Float64Array(e),t,n)}function ar(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function or(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}Yn.prototype=Object.assign(Object.create(r.prototype),{constructor:Yn,isGeometry:!0,applyMatrix:function(e){for(var t=(new qt).getNormalMatrix(e),n=0,r=this.vertices.length;n<r;n++){this.vertices[n].applyMatrix4(e)}for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(t).normalize();for(var a=0,o=i.vertexNormals.length;a<o;a++)i.vertexNormals[a].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var e=new xn;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new xn;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new xn;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new xn;return function(t,n,r){return e.makeTranslation(t,n,r),this.applyMatrix(e),this}}(),scale:function(){var e=new xn;return function(t,n,r){return e.makeScale(t,n,r),this.applyMatrix(e),this}}(),lookAt:(qn=new Gn,function(e){qn.lookAt(e),qn.updateMatrix(),this.applyMatrix(qn.matrix)}),fromBufferGeometry:function(e){var t=this,n=null!==e.index?e.index.array:void 0,r=e.attributes,i=r.position.array,a=void 0!==r.normal?r.normal.array:void 0,o=void 0!==r.color?r.color.array:void 0,s=void 0!==r.uv?r.uv.array:void 0,c=void 0!==r.uv2?r.uv2.array:void 0;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var l=0;l<i.length;l+=3)t.vertices.push((new Wt).fromArray(i,l)),void 0!==o&&t.colors.push((new Cn).fromArray(o,l));function u(e,n,r,i){var l=void 0===o?[]:[t.colors[e].clone(),t.colors[n].clone(),t.colors[r].clone()],u=new Bn(e,n,r,void 0===a?[]:[(new Wt).fromArray(a,3*e),(new Wt).fromArray(a,3*n),(new Wt).fromArray(a,3*r)],l,i);t.faces.push(u),void 0!==s&&t.faceVertexUvs[0].push([(new jt).fromArray(s,2*e),(new jt).fromArray(s,2*n),(new jt).fromArray(s,2*r)]),void 0!==c&&t.faceVertexUvs[1].push([(new jt).fromArray(c,2*e),(new jt).fromArray(c,2*n),(new jt).fromArray(c,2*r)])}var h=e.groups;if(h.length>0)for(l=0;l<h.length;l++)for(var d=h[l],p=d.start,f=p,m=p+d.count;f<m;f+=3)void 0!==n?u(n[f],n[f+1],n[f+2],d.materialIndex):u(f,f+1,f+2,d.materialIndex);else if(void 0!==n)for(l=0;l<n.length;l+=3)u(n[l],n[l+1],n[l+2]);else for(l=0;l<i.length/3;l+=3)u(l,l+1,l+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:(Wn=new Wt,function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Wn).negate(),this.translate(Wn.x,Wn.y,Wn.z),this}),normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,n=0===t?1:1/t,r=new xn;return r.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix(r),this},computeFaceNormals:function(){for(var e=new Wt,t=new Wt,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],a=this.vertices[i.a],o=this.vertices[i.b],s=this.vertices[i.c];e.subVectors(s,o),t.subVectors(a,o),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){var t,n,r,i,a,o;for(void 0===e&&(e=!0),o=new Array(this.vertices.length),t=0,n=this.vertices.length;t<n;t++)o[t]=new Wt;if(e){var s,c,l,u=new Wt,h=new Wt;for(r=0,i=this.faces.length;r<i;r++)a=this.faces[r],s=this.vertices[a.a],c=this.vertices[a.b],l=this.vertices[a.c],u.subVectors(l,c),h.subVectors(s,c),u.cross(h),o[a.a].add(u),o[a.b].add(u),o[a.c].add(u)}else for(this.computeFaceNormals(),r=0,i=this.faces.length;r<i;r++)o[(a=this.faces[r]).a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(t=0,n=this.vertices.length;t<n;t++)o[t].normalize();for(r=0,i=this.faces.length;r<i;r++){var d=(a=this.faces[r]).vertexNormals;3===d.length?(d[0].copy(o[a.a]),d[1].copy(o[a.b]),d[2].copy(o[a.c])):(d[0]=o[a.a].clone(),d[1]=o[a.b].clone(),d[2]=o[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,n;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var r=(n=this.faces[e]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for((i=this.faces[n]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),e=0,t=i.vertexNormals.length;e<t;e++)i.__originalVertexNormals[e]?i.__originalVertexNormals[e].copy(i.vertexNormals[e]):i.__originalVertexNormals[e]=i.vertexNormals[e].clone();var a=new Yn;for(a.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var o=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)c=new Wt,l={a:new Wt,b:new Wt,c:new Wt},o.push(c),s.push(l)}var c,l,u=this.morphNormals[e];for(a.vertices=this.morphTargets[e].vertices,a.computeFaceNormals(),a.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)i=this.faces[n],c=u.faceNormals[n],l=u.vertexNormals[n],c.copy(i.normal),l.a.copy(i.vertexNormals[0]),l.b.copy(i.vertexNormals[1]),l.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(i=this.faces[n]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new gn),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new vn),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e&&e.isGeometry){var r,i=this.vertices.length,a=this.vertices,o=e.vertices,s=this.faces,c=e.faces,l=this.faceVertexUvs[0],u=e.faceVertexUvs[0],h=this.colors,d=e.colors;void 0===n&&(n=0),void 0!==t&&(r=(new qt).getNormalMatrix(t));for(var p=0,f=o.length;p<f;p++){var m=o[p].clone();void 0!==t&&m.applyMatrix4(t),a.push(m)}for(p=0,f=d.length;p<f;p++)h.push(d[p].clone());for(p=0,f=c.length;p<f;p++){var g,v,y,b=c[p],x=b.vertexNormals,w=b.vertexColors;(g=new Bn(b.a+i,b.b+i,b.c+i)).normal.copy(b.normal),void 0!==r&&g.normal.applyMatrix3(r).normalize();for(var E=0,M=x.length;E<M;E++)v=x[E].clone(),void 0!==r&&v.applyMatrix3(r).normalize(),g.vertexNormals.push(v);g.color.copy(b.color);for(E=0,M=w.length;E<M;E++)y=w[E],g.vertexColors.push(y.clone());g.materialIndex=b.materialIndex+n,s.push(g)}for(p=0,f=u.length;p<f;p++){var A=u[p],T=[];if(void 0!==A){for(E=0,M=A.length;E<M;E++)T.push(A[E].clone());l.push(T)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,n,r,i,a,o,s,c={},l=[],u=[],h=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)e=this.vertices[n],void 0===c[t=Math.round(e.x*h)+"_"+Math.round(e.y*h)+"_"+Math.round(e.z*h)]?(c[t]=n,l.push(this.vertices[n]),u[n]=l.length-1):u[n]=u[c[t]];var d=[];for(n=0,r=this.faces.length;n<r;n++){(i=this.faces[n]).a=u[i.a],i.b=u[i.b],i.c=u[i.c],a=[i.a,i.b,i.c];for(var p=0;p<3;p++)if(a[p]===a[(p+1)%3]){d.push(n);break}}for(n=d.length-1;n>=0;n--){var f=d[n];for(this.faces.splice(f,1),o=0,s=this.faceVertexUvs.length;o<s;o++)this.faceVertexUvs[o].splice(f,1)}var m=this.vertices.length-l.length;return this.vertices=l,m},setFromPoints:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var r=e[t];this.vertices.push(new Wt(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,n=0;n<t;n++)e[n]._id=n;e.sort((function(e,t){return e.materialIndex-t.materialIndex}));var r,i,a=this.faceVertexUvs[0],o=this.faceVertexUvs[1];a&&a.length===t&&(r=[]),o&&o.length===t&&(i=[]);for(n=0;n<t;n++){var s=e[n]._id;r&&r.push(a[s]),i&&i.push(o[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}for(var r=[],i=0;i<this.vertices.length;i++){var a=this.vertices[i];r.push(a.x,a.y,a.z)}var o=[],s=[],c={},l=[],u={},h=[],d={};for(i=0;i<this.faces.length;i++){var p=this.faces[i],f=void 0!==this.faceVertexUvs[0][i],m=p.normal.length()>0,g=p.vertexNormals.length>0,v=1!==p.color.r||1!==p.color.g||1!==p.color.b,y=p.vertexColors.length>0,b=0;if(b=M(b,0,0),b=M(b,1,!0),b=M(b,2,!1),b=M(b,3,f),b=M(b,4,m),b=M(b,5,g),b=M(b,6,v),b=M(b,7,y),o.push(b),o.push(p.a,p.b,p.c),o.push(p.materialIndex),f){var x=this.faceVertexUvs[0][i];o.push(_(x[0]),_(x[1]),_(x[2]))}if(m&&o.push(A(p.normal)),g){var w=p.vertexNormals;o.push(A(w[0]),A(w[1]),A(w[2]))}if(v&&o.push(T(p.color)),y){var E=p.vertexColors;o.push(T(E[0]),T(E[1]),T(E[2]))}}function M(e,t,n){return n?e|1<<t:e&~(1<<t)}function A(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==c[t]?c[t]:(c[t]=s.length/3,s.push(e.x,e.y,e.z),c[t])}function T(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==u[t]?u[t]:(u[t]=l.length,l.push(e.getHex()),u[t])}function _(e){var t=e.x.toString()+e.y.toString();return void 0!==d[t]?d[t]:(d[t]=h.length/2,h.push(e.x,e.y),d[t])}return e.data={},e.data.vertices=r,e.data.normals=s,l.length>0&&(e.data.colors=l),h.length>0&&(e.data.uvs=[h]),e.data.faces=o,e},clone:function(){return(new Yn).copy(this)},copy:function(e){var t,n,r,i,a,o;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,n=s.length;t<n;t++)this.vertices.push(s[t].clone());var c=e.colors;for(t=0,n=c.length;t<n;t++)this.colors.push(c[t].clone());var l=e.faces;for(t=0,n=l.length;t<n;t++)this.faces.push(l[t].clone());for(t=0,n=e.faceVertexUvs.length;t<n;t++){var u=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),r=0,i=u.length;r<i;r++){var h=u[r],d=[];for(a=0,o=h.length;a<o;a++){var p=h[a];d.push(p.clone())}this.faceVertexUvs[t].push(d)}}var f=e.morphTargets;for(t=0,n=f.length;t<n;t++){var m={};if(m.name=f[t].name,void 0!==f[t].vertices)for(m.vertices=[],r=0,i=f[t].vertices.length;r<i;r++)m.vertices.push(f[t].vertices[r].clone());if(void 0!==f[t].normals)for(m.normals=[],r=0,i=f[t].normals.length;r<i;r++)m.normals.push(f[t].normals[r].clone());this.morphTargets.push(m)}var g=e.morphNormals;for(t=0,n=g.length;t<n;t++){var v={};if(void 0!==g[t].vertexNormals)for(v.vertexNormals=[],r=0,i=g[t].vertexNormals.length;r<i;r++){var y=g[t].vertexNormals[r],b={};b.a=y.a.clone(),b.b=y.b.clone(),b.c=y.c.clone(),v.vertexNormals.push(b)}if(void 0!==g[t].faceNormals)for(v.faceNormals=[],r=0,i=g[t].faceNormals.length;r<i;r++)v.faceNormals.push(g[t].faceNormals[r].clone());this.morphNormals.push(v)}var x=e.skinWeights;for(t=0,n=x.length;t<n;t++)this.skinWeights.push(x[t].clone());var w=e.skinIndices;for(t=0,n=w.length;t<n;t++)this.skinIndices.push(w[t].clone());var E=e.lineDistances;for(t=0,n=E.length;t<n;t++)this.lineDistances.push(E[t]);var M=e.boundingBox;null!==M&&(this.boundingBox=M.clone());var A=e.boundingSphere;return null!==A&&(this.boundingSphere=A.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperties(Kn.prototype,{needsUpdate:{set:function(e){!0===e&&this.version++}},array:{get:function(){return this._array},set:function(e){this._array=e,this.versionVAO++}},itemSize:{get:function(){return this._itemSize},set:function(e){this._itemSize=e,this.versionVAO++}},normalized:{get:function(){return this._normalized},set:function(e){this._normalized=e,this.versionVAO++}}}),Object.assign(Kn.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.itemSize:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),a=new Cn),t[n++]=a.r,t[n++]=a.g,t[n++]=a.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new jt),t[n++]=a.x,t[n++]=a.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),a=new Wt),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),a=new hn),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z,t[n++]=a.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Jn.prototype=Object.create(Kn.prototype),Jn.prototype.constructor=Jn,Zn.prototype=Object.create(Kn.prototype),Zn.prototype.constructor=Zn,Qn.prototype=Object.create(Kn.prototype),Qn.prototype.constructor=Qn,$n.prototype=Object.create(Kn.prototype),$n.prototype.constructor=$n,er.prototype=Object.create(Kn.prototype),er.prototype.constructor=er,tr.prototype=Object.create(Kn.prototype),tr.prototype.constructor=tr,nr.prototype=Object.create(Kn.prototype),nr.prototype.constructor=nr,rr.prototype=Object.create(Kn.prototype),rr.prototype.constructor=rr,ir.prototype=Object.create(Kn.prototype),ir.prototype.constructor=ir,Object.assign(ar.prototype,{computeGroups:function(e){for(var t,n=[],r=void 0,i=e.faces,a=0;a<i.length;a++){var o=i[a];o.materialIndex!==r&&(r=o.materialIndex,void 0!==t&&(t.count=3*a-t.start,n.push(t)),t={start:3*a,materialIndex:r})}void 0!==t&&(t.count=3*a-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t,n=e.faces,r=e.vertices,i=e.faceVertexUvs,a=i[0]&&i[0].length>0,o=i[1]&&i[1].length>0,s=e.morphTargets,c=s.length;if(c>0){t=[];for(var l=0;l<c;l++)t[l]={name:s[l].name,data:[]};this.morphTargets.position=t}var u,h=e.morphNormals,d=h.length;if(d>0){u=[];for(l=0;l<d;l++)u[l]={name:h[l].name,data:[]};this.morphTargets.normal=u}var p=e.skinIndices,f=e.skinWeights,m=p.length===r.length,g=f.length===r.length;r.length>0&&0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(l=0;l<n.length;l++){var v=n[l];this.vertices.push(r[v.a],r[v.b],r[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var b=v.normal;this.normals.push(b,b,b)}var x,w=v.vertexColors;if(3===w.length)this.colors.push(w[0],w[1],w[2]);else{var E=v.color;this.colors.push(E,E,E)}if(!0===a)void 0!==(x=i[0][l])?this.uvs.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new jt,new jt,new jt));if(!0===o)void 0!==(x=i[1][l])?this.uvs2.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new jt,new jt,new jt));for(var M=0;M<c;M++){var A=s[M].vertices;t[M].data.push(A[v.a],A[v.b],A[v.c])}for(M=0;M<d;M++){var T=h[M].vertexNormals[l];u[M].data.push(T.a,T.b,T.c)}m&&this.skinIndices.push(p[v.a],p[v.b],p[v.c]),g&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}});var sr=1;function cr(){Object.defineProperty(this,"id",{value:sr+=2}),this.uuid=Vt.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function lr(e,t,n,r,i,a){Yn.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a},this.fromBufferGeometry(new ur(e,t,n,r,i,a)),this.mergeVertices()}function ur(e,t,n,r,i,a){cr.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};var o=this;e=e||1,t=t||1,n=n||1,r=Math.floor(r)||1,i=Math.floor(i)||1,a=Math.floor(a)||1;var s=[],c=[],l=[],u=[],h=0,d=0;function p(e,t,n,r,i,a,p,f,m,g,v){var y,b,x=a/m,w=p/g,E=a/2,M=p/2,A=f/2,T=m+1,_=g+1,S=0,L=0,C=new Wt;for(b=0;b<_;b++){var R=b*w-M;for(y=0;y<T;y++){var P=y*x-E;C[e]=P*r,C[t]=R*i,C[n]=A,c.push(C.x,C.y,C.z),C[e]=0,C[t]=0,C[n]=f>0?1:-1,l.push(C.x,C.y,C.z),u.push(y/m),u.push(1-b/g),S+=1}}for(b=0;b<g;b++)for(y=0;y<m;y++){var O=h+y+T*b,D=h+y+T*(b+1),I=h+(y+1)+T*(b+1),B=h+(y+1)+T*b;s.push(O,D,B),s.push(D,I,B),L+=6}o.addGroup(d,L,v),d+=L,h+=S}p("z","y","x",-1,-1,n,t,e,a,i,0),p("z","y","x",1,-1,n,t,-e,a,i,1),p("x","z","y",1,1,e,n,t,r,a,2),p("x","z","y",1,-1,e,n,-t,r,a,3),p("x","y","z",1,-1,e,t,n,r,i,4),p("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(s),this.addAttribute("position",new rr(c,3)),this.addAttribute("normal",new rr(l,3)),this.addAttribute("uv",new rr(u,2))}function hr(e,t,n,r,i){Yn.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r,flipY:i},this.fromBufferGeometry(new dr(e,t,n,r)),this.mergeVertices()}function dr(e,t,n,r,i=!0){cr.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r,flipY:i};var a,o,s=(e=e||1)/2,c=(t=t||1)/2,l=Math.floor(n)||1,u=Math.floor(r)||1,h=l+1,d=u+1,p=e/l,f=t/u,m=[],g=[],v=[],y=[];for(o=0;o<d;o++){var b=o*f-c;for(a=0;a<h;a++){var x=a*p-s;g.push(x,-b,0),v.push(0,0,1),y.push(a/l),y.push(i?1-o/u:o/u)}}for(o=0;o<u;o++)for(a=0;a<l;a++){var w=a+h*o,E=a+h*(o+1),M=a+1+h*(o+1),A=a+1+h*o;m.push(w,E,A),m.push(E,M,A)}this.setIndex(m),this.addAttribute("position",new rr(g,3)),this.addAttribute("normal",new rr(v,3)),this.addAttribute("uv",new rr(y,2))}cr.prototype=Object.assign(Object.create(r.prototype),{constructor:cr,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(or(e)>65535?nr:er)(e,1):this.index=e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):(this.attributes[e]=t,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new Kn(arguments[1],arguments[2])))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var n=this.attributes.normal;void 0!==n&&((new qt).getNormalMatrix(e).applyToBufferAttribute(n),n.needsUpdate=!0);var r=this.attributes.tangent;void 0!==r&&((new qt).getNormalMatrix(e).applyToBufferAttribute(r),r.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var e=new xn;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new xn;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new xn;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new xn;return function(t,n,r){return e.makeTranslation(t,n,r),this.applyMatrix(e),this}}(),scale:function(){var e=new xn;return function(t,n,r){return e.makeScale(t,n,r),this.applyMatrix(e),this}}(),lookAt:function(){var e=new Gn;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){var e=new Wt;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var n=new rr(3*t.vertices.length,3),r=new rr(3*t.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(t.vertices)),this.addAttribute("color",r.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var i=new rr(t.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.addAttribute("position",new rr(t,3)),this},updateFromObject:function(e){var t,n=e.geometry;if(e.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(n.vertices),t.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(n.normals),t.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(n.colors),t.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(n.uvs),t.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(n.lineDistances),t.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(e.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new ar).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new Kn(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var n=new Float32Array(3*e.normals.length);this.addAttribute("normal",new Kn(n,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var r=new Float32Array(3*e.colors.length);this.addAttribute("color",new Kn(r,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var i=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new Kn(i,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var a=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new Kn(a,2).copyVector2sArray(e.uvs2))}for(var o in this.groups=e.groups,e.morphTargets){for(var s=[],c=e.morphTargets[o],l=0,u=c.length;l<u;l++){var h=c[l],d=new rr(3*h.data.length,3);d.name=h.name,s.push(d.copyVector3sArray(h.data))}this.morphAttributes[o]=s}if(e.skinIndices.length>0){var p=new rr(4*e.skinIndices.length,4);this.addAttribute("skinIndex",p.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var f=new rr(4*e.skinWeights.length,4);this.addAttribute("skinWeight",f.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){var e=new gn;return function(){null===this.boundingBox&&(this.boundingBox=new gn);var t=this.attributes.position,n=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),n)for(var r=0,i=n.length;r<i;r++){var a=n[r];e.setFromBufferAttribute(a),this.boundingBox.expandByPoint(e.min),this.boundingBox.expandByPoint(e.max)}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}}(),computeBoundingSphere:function(){var e=new gn,t=new gn,n=new Wt;return function(){null===this.boundingSphere&&(this.boundingSphere=new vn);var r=this.attributes.position,i=this.morphAttributes.position;if(r){var a=this.boundingSphere.center;if(e.setFromBufferAttribute(r),i)for(var o=0,s=i.length;o<s;o++){var c=i[o];t.setFromBufferAttribute(c),e.expandByPoint(t.min),e.expandByPoint(t.max)}e.getCenter(a);var l=0;for(o=0,s=r.count;o<s;o++)n.fromBufferAttribute(r,o),l=Math.max(l,a.distanceToSquared(n));if(i)for(o=0,s=i.length;o<s;o++)for(var u=0,h=(c=i[o]).count;u<h;u++)n.fromBufferAttribute(c,u),l=Math.max(l,a.distanceToSquared(n));this.boundingSphere.radius=Math.sqrt(l),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var n=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new Kn(new Float32Array(n.length),3));else for(var r=t.normal.array,i=0,a=r.length;i<a;i++)r[i]=0;var o,s,c,l=t.normal.array,u=new Wt,h=new Wt,d=new Wt,p=new Wt,f=new Wt;if(e){var m=e.array;for(i=0,a=e.count;i<a;i+=3)o=3*m[i+0],s=3*m[i+1],c=3*m[i+2],u.fromArray(n,o),h.fromArray(n,s),d.fromArray(n,c),p.subVectors(d,h),f.subVectors(u,h),p.cross(f),l[o]+=p.x,l[o+1]+=p.y,l[o+2]+=p.z,l[s]+=p.x,l[s+1]+=p.y,l[s+2]+=p.z,l[c]+=p.x,l[c+1]+=p.y,l[c+2]+=p.z}else for(i=0,a=n.length;i<a;i+=9)u.fromArray(n,i),h.fromArray(n,i+3),d.fromArray(n,i+6),p.subVectors(d,h),f.subVectors(u,h),p.cross(f),l[i]=p.x,l[i+1]=p.y,l[i+2]=p.z,l[i+3]=p.x,l[i+4]=p.y,l[i+5]=p.z,l[i+6]=p.x,l[i+7]=p.y,l[i+8]=p.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==e.attributes[r])for(var i=n[r].array,a=e.attributes[r],o=a.array,s=a.itemSize*t,c=Math.min(o.length,i.length-s),l=0,u=s;l<c;l++,u++)i[u]=o[l];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){var e=new Wt;return function(){for(var t=this.attributes.normal,n=0,r=t.count;n<r;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.normalize(),t.setXYZ(n,e.x,e.y,e.z)}}(),toNonIndexed:function(){function e(e,t){for(var n=e.array,r=e.itemSize,i=new n.constructor(t.length*r),a=0,o=0,s=0,c=t.length;s<c;s++){a=t[s]*r;for(var l=0;l<r;l++)i[o++]=n[a++]}return new Kn(i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new cr,n=this.index.array,r=this.attributes;for(var i in r){var a=e(r[i],n);t.addAttribute(i,a)}var o=this.morphAttributes;for(i in o){for(var s=[],c=o[i],l=0,u=c.length;l<u;l++){a=e(c[l],n);s.push(a)}t.morphAttributes[i]=s}for(var h=this.groups,d=(l=0,h.length);l<d;l++){var p=h[l];t.addGroup(p.start,p.count,p.materialIndex)}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var n in i){var a=(d=i[n]).toJSON();""!==d.name&&(a.name=d.name),e.data.attributes[n]=a}var o={},s=!1;for(var n in this.morphAttributes){for(var c=this.morphAttributes[n],l=[],u=0,h=c.length;u<h;u++){var d;a=(d=c[u]).toJSON();""!==d.name&&(a.name=d.name),l.push(a)}l.length>0&&(o[n]=l,s=!0)}s&&(e.data.morphAttributes=o);var p=this.groups;p.length>0&&(e.data.groups=JSON.parse(JSON.stringify(p)));var f=this.boundingSphere;return null!==f&&(e.data.boundingSphere={center:f.center.toArray(),radius:f.radius}),e},clone:function(){return(new cr).copy(this)},copy:function(e){var t,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var i=e.index;null!==i&&this.setIndex(i.clone());var a=e.attributes;for(t in a){var o=a[t];this.addAttribute(t,o.clone())}var s=e.morphAttributes;for(t in s){var c=[],l=s[t];for(n=0,r=l.length;n<r;n++)c.push(l[n].clone());this.morphAttributes[t]=c}var u=e.groups;for(n=0,r=u.length;n<r;n++){var h=u[n];this.addGroup(h.start,h.count,h.materialIndex)}var d=e.boundingBox;null!==d&&(this.boundingBox=d.clone());var p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),lr.prototype=Object.create(Yn.prototype),lr.prototype.constructor=lr,ur.prototype=Object.create(cr.prototype),ur.prototype.constructor=ur,hr.prototype=Object.create(Yn.prototype),hr.prototype.constructor=hr,dr.prototype=Object.create(cr.prototype),dr.prototype.constructor=dr;var pr=0;function fr(){Object.defineProperty(this,"id",{value:pr++}),this.uuid=Vt.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=S,this.side=y,this.flatShading=!1,this.vertexTangents=!1,this.vertexColors=M,this.opacity=1,this.transparent=!1,this.blendSrc=z,this.blendDst=V,this.blendEquation=O,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Z,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.userData={},this.needsUpdate=!0}fr.prototype=Object.assign(Object.create(r.prototype),{constructor:fr,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===w;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearCoat&&(n.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==S&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==y&&(n.side=this.side),this.vertexColors!==M&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var i=r(e.textures),a=r(e.images);i.length>0&&(n.textures=i),a.length>0&&(n.images=a)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.shadowSide=e.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var mr,gr,vr,yr,br,xr,wr,Er,Mr,Ar,Tr,_r;function Sr(e){fr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Lr(e,t){this.origin=void 0!==e?e:new Wt,this.direction=void 0!==t?t:new Wt}function Cr(e,t,n){this.a=void 0!==e?e:new Wt,this.b=void 0!==t?t:new Wt,this.c=void 0!==n?n:new Wt}function Rr(e){fr.call(this),this.type="MeshBasicMaterial",this.color=new Cn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ne,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function Pr(e,t){Gn.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new cr,this.material=void 0!==t?t:new Rr({color:16777215*Math.random()}),this.drawMode=St,this.updateMorphTargets()}function Or(e,t,n,r){var i,a,o=new Cn(0),s=0,c=null,l=0;function u(e,n){t.buffers.color.setClear(e.r,e.g,e.b,n,r)}return{getClearColor:function(){return o},setClearColor:function(e,t){o.set(e),u(o,s=void 0!==t?t:1)},getClearAlpha:function(){return s},setClearAlpha:function(e){u(o,s=e)},render:function(t,r,h,d){var p=r.background,f=e.vr,m=f.getSession&&f.getSession();if(m&&"additive"===m.environmentBlendMode&&(p=null),null===p?(u(o,s),c=null,l=0):p&&p.isColor&&(u(p,1),d=!0,c=null,l=0),(e.autoClear||d)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),p&&(p.isCubeTexture||p.isWebGLRenderTargetCube)){void 0===a&&((a=new Pr(new ur(1,1,1),new Sr({type:"BackgroundCubeMaterial",uniforms:En(On.cube.uniforms),vertexShader:On.cube.vertexShader,fragmentShader:On.cube.fragmentShader,side:b,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),a.geometry.removeAttribute("uv"),a.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.tCube.value}}),n.update(a));var g=p.isWebGLRenderTargetCube?p.texture:p;a.material.uniforms.tCube.value=g,a.material.uniforms.tFlip.value=p.isWebGLRenderTargetCube?1:-1,c===p&&l===g.version||(a.material.needsUpdate=!0,c=p,l=g.version),t.unshift(a,a.geometry,a.material,0,0,null)}else p&&p.isTexture&&(void 0===i&&((i=new Pr(new dr(2,2),new Sr({type:"BackgroundMaterial",uniforms:En(On.background.uniforms),vertexShader:On.background.vertexShader,fragmentShader:On.background.fragmentShader,side:y,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),Object.defineProperty(i.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(i)),i.material.uniforms.t2D.value=p,!0===p.matrixAutoUpdate&&p.updateMatrix(),i.material.uniforms.uvTransform.value.copy(p.matrix),c===p&&l===p.version||(i.material.needsUpdate=!0,c=p,l=p.version),t.unshift(i,i.geometry,i.material,0,0,null))}}}function Dr(e,t,n,r){var i=e.getParameter(34921),a=r.isWebGL2?null:t.get("OES_vertex_array_object"),o=r.isWebGL2||null!==a,s={},c=d(null),l=c;function u(t){return r.isWebGL2?e.bindVertexArray(t):a.bindVertexArrayOES(t)}function h(t){return r.isWebGL2?e.deleteVertexArray(t):a.deleteVertexArrayOES(t)}function d(e){for(var t=[],n=[],r=[],a=0;a<i;a++)t[a]=0,n[a]=0,r[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{}}}function p(){for(var e=l.newAttributes,t=0,n=e.length;t<n;t++)e[t]=0}function f(e){m(e,0)}function m(n,i){var a=l.newAttributes,o=l.enabledAttributes,s=l.attributeDivisors;(a[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),s[n]!==i)&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),s[n]=i)}function g(){for(var t=l.newAttributes,n=l.enabledAttributes,r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function v(){y(),l!==c&&u((l=c).object)}function y(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:function(i,c,h,v){var y=!1;if(o){var b=function(t,n,i){var o=!0===i.wireframe,c=s[t.id];void 0===c&&(c={},s[t.id]=c);var l=c[n.id];void 0===l&&(l={},c[n.id]=l);var u=l[o];void 0===u&&(u=d(r.isWebGL2?e.createVertexArray():a.createVertexArrayOES()),l[o]=u);return u}(h,c,i);l!==b&&u((l=b).object),(y=function(e){var t=l.attributes,n=e.attributes;if(Object.keys(t).length!==Object.keys(n).length)return!0;for(var r in n){var i=t[r],a=n[r];if(i.attribute!==a)return!0;if(i.version!==a.versionVAO)return!0;if(i.data.buffer!==a.data)return!0;if(a.data&&i.data.version!==a.data.versionVAO)return!0}return!1}(h))&&function(e){var t={},n=e.attributes;for(var r in n){var i=n[r],a={};a.attribute=i,a.version=i.versionVAO,a.data={},i.data&&(a.data.buffer=i.data,a.data.version=i.data.versionVAO),t[r]=a}l.attributes=t}(h)}else{var x=!0===i.wireframe;l.geometry===h.id&&l.program===c.id&&l.wireframe===x||(l.geometry=h.id,l.program=c.id,l.wireframe=x,y=!0)}null!==v&&n.update(v,34963),y&&(!function(i,a,o){if(o&&o.isInstancedBufferGeometry&!r.isWebGL2&&null===t.get("ANGLE_instanced_arrays"))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p();var s=o.attributes,c=a.getAttributes(),l=i.defaultAttributeValues;for(var u in c){var h=c[u];if(h>=0){var d=s[u];if(void 0!==d){var v=d.normalized,y=d.itemSize,b=n.get(d);if(void 0===b)continue;var x=b.buffer,w=b.type,E=b.bytesPerElement;if(d.isInterleavedBufferAttribute){var M=d.data,A=M.stride,T=d.offset;M&&M.isInstancedInterleavedBuffer?(m(h,M.meshPerAttribute),void 0===o.maxInstancedCount&&(o.maxInstancedCount=M.meshPerAttribute*M.count)):f(h),e.bindBuffer(34962,x),e.vertexAttribPointer(h,y,w,v,A*E,T*E)}else d.isInstancedBufferAttribute?(m(h,d.meshPerAttribute),void 0===o.maxInstancedCount&&(o.maxInstancedCount=d.meshPerAttribute*d.count)):f(h),e.bindBuffer(34962,x),e.vertexAttribPointer(h,y,w,v,0,0)}else if(void 0!==l){var _=l[u];if(void 0!==_)switch(_.length){case 2:e.vertexAttrib2fv(h,_);break;case 3:e.vertexAttrib3fv(h,_);break;case 4:e.vertexAttrib4fv(h,_);break;default:e.vertexAttrib1fv(h,_)}}}}g()}(i,c,h),null!==v&&e.bindBuffer(34963,n.get(v).buffer))},reset:v,resetDefaultState:y,dispose:function(){for(var e in v(),s){var t=s[e];for(var n in t){var r=t[n];for(var i in r)h(r[i].object),delete r[i];delete t[n]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0!==s[e.id]){var t=s[e.id];for(var n in t){var r=t[n];for(var i in r)h(r[i].object),delete r[i];delete t[n]}delete s[e.id]}},releaseStatesOfProgram:function(e){for(var t in s){var n=s[t];if(void 0!==n[e.id]){var r=n[e.id];for(var i in r)h(r[i].object),delete r[i];delete n[e.id]}}},initAttributes:p,enableAttribute:f,disableUnusedAttributes:g}}function Ir(e,t,n,r){var i;this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i)},this.renderInstances=function(a,o,s){var c;if(r.isWebGL2)c=e;else if(null===(c=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[r.isWebGL2?"drawArraysInstanced":"drawArraysInstancedANGLE"](i,o,s,a.maxInstancedCount),n.update(s,i,a.maxInstancedCount)}}function Br(e,t,n){var r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var a="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext,o=void 0!==n.precision?n.precision:"highp",s=i(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var c=!0===n.logarithmicDepthBuffer,l=e.getParameter(34930),u=e.getParameter(35660),h=e.getParameter(3379),d=e.getParameter(34076),p=e.getParameter(34921),f=e.getParameter(36347),m=e.getParameter(36348),g=e.getParameter(36349),v=u>0,y=a||!!t.get("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==r)return r;var n=t.get("EXT_texture_filter_anisotropic");return r=null!==n?e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:c,maxTextures:l,maxVertexTextures:u,maxTextureSize:h,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:f,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y,maxSamples:a?e.getParameter(36183):0,multiview:a&&(!!t.get("WEBGL_multiview")||!!t.get("OVR_multiview"))}}function kr(){var e=this,t=null,n=0,r=!1,i=!1,a=new yn,o=new qt,s={value:null,needsUpdate:!1};function c(){s.value!==t&&(s.value=t,s.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function l(t,n,r,i){var c=null!==t?t.length:0,l=null;if(0!==c){if(l=s.value,!0!==i||null===l){var u=r+4*c,h=n.matrixWorldInverse;o.getNormalMatrix(h),(null===l||l.length<u)&&(l=new Float32Array(u));for(var d=0,p=r;d!==c;++d,p+=4)a.copy(t[d]).applyMatrix4(h,o),a.normal.toArray(l,p),l[p+3]=a.constant}s.value=l,s.needsUpdate=!0}return e.numPlanes=c,l}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,i,a){var o=0!==e.length||i||0!==n||r;return r=i,t=l(e,a,0),n=e.length,o},this.beginShadows=function(){i=!0,l(null)},this.endShadows=function(){i=!1,c()},this.setState=function(e,a,o,u,h,d){if(!r||null===e||0===e.length||i&&!o)i?l(null):c();else{var p=i?0:n,f=4*p,m=h.clippingState||null;s.value=m,m=l(e,u,f,d);for(var g=0;g!==f;++g)m[g]=t[g];h.clippingState=m,this.numIntersection=a?this.numPlanes:0,this.numPlanes+=p}}}function Hr(e){var t={};return{get:function(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),t[n]=r,r}}}function Nr(e,t,n,r){var i={},a={};function o(e){var s=e.target,c=i[s.id];for(var l in null!==c.index&&t.remove(c.index),c.attributes)t.remove(c.attributes[l]);s.removeEventListener("dispose",o),delete i[s.id];var u=a[c.id];u&&(t.remove(u),delete a[c.id]),r.releaseStatesOfGeometry(s),n.memory.geometries--}return{get:function(e,t){var r=i[t.id];return r||(t.addEventListener("dispose",o),t.isBufferGeometry?r=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new cr).setFromObject(e)),r=t._bufferGeometry),i[t.id]=r,n.memory.geometries++,r)},update:function(e){var n=e.attributes;for(var r in n)t.update(n[r],34962);var i=e.morphAttributes;for(var r in i)for(var a=i[r],o=0,s=a.length;o<s;o++)t.update(a[o],34962)},getWireframeAttribute:function(e){var t=a[e.id];if(t)return t;var n,r=[],i=e.index,o=e.attributes;if(null!==i)for(var s=0,c=(n=i.array).length;s<c;s+=3){var l=n[s+0],u=n[s+1],h=n[s+2];r.push(l,u,u,h,h,l)}else for(s=0,c=(n=o.position.array).length/3-1;s<c;s+=3){l=s+0,u=s+1,h=s+2;r.push(l,u,u,h,h,l)}return t=new(or(r)>65535?nr:er)(r,1),a[e.id]=t,t}}}function Fr(e,t,n,r){var i,a,o;this.setMode=function(e){i=e},this.setIndex=function(e){a=e.type,o=e.bytesPerElement},this.render=function(t,r){e.drawElements(i,r,a,t*o),n.update(r,i)},this.renderInstances=function(s,c,l){var u;if(r.isWebGL2)u=e;else if(null===(u=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[r.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](i,l,a,c*o,s.maxInstancedCount),n.update(l,i,s.maxInstancedCount)}}function Ur(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(r=r||1,t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 5:case 6:t.triangles+=r*(e-2);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function zr(e,t){return e[0]-t[0]}function Vr(e,t){return Math.abs(t[1])-Math.abs(e[1])}function jr(e){for(var t={},n=new Float32Array(8),r=[],i=0;i<8;i++)r[i]=[i,0];return{update:function(i,a,o,s){var c=i.morphTargetInfluences,l=c.length,u=t[a.id];if(void 0===u){u=[];for(var h=0;h<l;h++)u[h]=[h,0];t[a.id]=u}for(h=0;h<l;h++){(f=u[h])[0]=h,f[1]=c[h]}for(u.sort(Vr),h=0;h<8;h++)h<l&&u[h][1]?(r[h][0]=u[h][0],r[h][1]=u[h][1]):(r[h][0]=Number.MAX_SAFE_INTEGER,r[h][1]=0);r.sort(zr);var d=o.morphTargets&&a.morphAttributes.position,p=o.morphNormals&&a.morphAttributes.normal;for(h=0;h<8;h++){var f,m=(f=r[h])[0],g=f[1];m!==Number.MAX_SAFE_INTEGER&&g?(d&&a.getAttribute("morphTarget"+h)!==d[m]&&a.addAttribute("morphTarget"+h,d[m]),p&&a.getAttribute("morphNormal"+h)!==p[m]&&a.addAttribute("morphNormal"+h,p[m]),n[h]=g):(d&&void 0!==a.getAttribute("morphTarget"+h)&&a.removeAttribute("morphTarget"+h),p&&void 0!==a.getAttribute("morphNormal"+h)&&a.removeAttribute("morphNormal"+h),n[h]=0)}s.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function Gr(e,t){var n={};return{update:function(r){var i=t.render.frame,a=r.geometry,o=e.get(r,a);return n[o.id]!==i&&(a.isGeometry&&o.updateFromObject(r),e.update(o),n[o.id]=i),o},dispose:function(){n={}}}}function Wr(e,t,n,r,i,a,o,s,c,l){e=void 0!==e?e:[],t=void 0!==t?t:de,o=void 0!==o?o:ze,un.call(this,e,t,n,r,i,a,o,s,c,l),this.flipY=!1}function qr(e,t,n,r){un.call(this,null),this.image={data:e,width:t,height:n,depth:r},this.magFilter=Ee,this.minFilter=Ee,this.wrapR=xe,this.generateMipmaps=!1,this.flipY=!1}function Xr(e,t,n,r){un.call(this,null),this.image={data:e,width:t,height:n,depth:r},this.magFilter=Ee,this.minFilter=Ee,this.wrapR=xe,this.generateMipmaps=!1,this.flipY=!1}Sr.prototype=Object.create(fr.prototype),Sr.prototype.constructor=Sr,Sr.prototype.isShaderMaterial=!0,Sr.prototype.copy=function(e){return fr.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=En(e.uniforms),this.uniformsGroups=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},Sr.prototype.toJSON=function(e){var t=fr.prototype.toJSON.call(this,e);for(var n in t.uniforms={},this.uniforms){var r=this.uniforms[n].value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var i={};for(var a in this.extensions)!0===this.extensions[a]&&(i[a]=!0);return Object.keys(i).length>0&&(t.extensions=i),t},Object.assign(Lr.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new Wt),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new Wt;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new Wt),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new Wt;return function(t){var n=e.subVectors(t,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(n).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:(gr=new Wt,vr=new Wt,yr=new Wt,function(e,t,n,r){gr.copy(e).add(t).multiplyScalar(.5),vr.copy(t).sub(e).normalize(),yr.copy(this.origin).sub(gr);var i,a,o,s,c=.5*e.distanceTo(t),l=-this.direction.dot(vr),u=yr.dot(this.direction),h=-yr.dot(vr),d=yr.lengthSq(),p=Math.abs(1-l*l);if(p>0)if(a=l*u-h,s=c*p,(i=l*h-u)>=0)if(a>=-s)if(a<=s){var f=1/p;o=(i*=f)*(i+l*(a*=f)+2*u)+a*(l*i+a+2*h)+d}else a=c,o=-(i=Math.max(0,-(l*a+u)))*i+a*(a+2*h)+d;else a=-c,o=-(i=Math.max(0,-(l*a+u)))*i+a*(a+2*h)+d;else a<=-s?o=-(i=Math.max(0,-(-l*c+u)))*i+(a=i>0?-c:Math.min(Math.max(-c,-h),c))*(a+2*h)+d:a<=s?(i=0,o=(a=Math.min(Math.max(-c,-h),c))*(a+2*h)+d):o=-(i=Math.max(0,-(l*c+u)))*i+(a=i>0?c:Math.min(Math.max(-c,-h),c))*(a+2*h)+d;else a=l>0?-c:c,o=-(i=Math.max(0,-(l*a+u)))*i+a*(a+2*h)+d;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(vr).multiplyScalar(a).add(gr),o}),intersectSphere:function(){var e=new Wt;return function(t,n){e.subVectors(t.center,this.origin);var r=e.dot(this.direction),i=e.dot(e)-r*r,a=t.radius*t.radius;if(i>a)return null;var o=Math.sqrt(a-i),s=r-o,c=r+o;return s<0&&c<0?null:s<0?this.at(c,n):this.at(s,n)}}(),intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var n,r,i,a,o,s,c=1/this.direction.x,l=1/this.direction.y,u=1/this.direction.z,h=this.origin;return c>=0?(n=(e.min.x-h.x)*c,r=(e.max.x-h.x)*c):(n=(e.max.x-h.x)*c,r=(e.min.x-h.x)*c),l>=0?(i=(e.min.y-h.y)*l,a=(e.max.y-h.y)*l):(i=(e.max.y-h.y)*l,a=(e.min.y-h.y)*l),n>a||i>r?null:((i>n||n!=n)&&(n=i),(a<r||r!=r)&&(r=a),u>=0?(o=(e.min.z-h.z)*u,s=(e.max.z-h.z)*u):(o=(e.max.z-h.z)*u,s=(e.min.z-h.z)*u),n>s||o>r?null:((o>n||n!=n)&&(n=o),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))},intersectsBox:(mr=new Wt,function(e){return null!==this.intersectBox(e,mr)}),intersectTriangle:function(){var e=new Wt,t=new Wt,n=new Wt,r=new Wt;return function(i,a,o,s,c){t.subVectors(a,i),n.subVectors(o,i),r.crossVectors(t,n);var l,u=this.direction.dot(r);if(u>0){if(s)return null;l=1}else{if(!(u<0))return null;l=-1,u=-u}e.subVectors(this.origin,i);var h=l*this.direction.dot(n.crossVectors(e,n));if(h<0)return null;var d=l*this.direction.dot(t.cross(e));if(d<0)return null;if(h+d>u)return null;var p=-l*e.dot(r);return p<0?null:this.at(p/u,c)}}(),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(Cr,{getNormal:(xr=new Wt,function(e,t,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new Wt),r.subVectors(n,t),xr.subVectors(e,t),r.cross(xr);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}),getBarycoord:function(){var e=new Wt,t=new Wt,n=new Wt;return function(r,i,a,o,s){e.subVectors(o,i),t.subVectors(a,i),n.subVectors(r,i);var c=e.dot(e),l=e.dot(t),u=e.dot(n),h=t.dot(t),d=t.dot(n),p=c*h-l*l;if(void 0===s&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),s=new Wt),0===p)return s.set(-2,-1,-1);var f=1/p,m=(h*u-l*d)*f,g=(c*d-l*u)*f;return s.set(1-m-g,g,m)}}(),containsPoint:function(){var e=new Wt;return function(t,n,r,i){return Cr.getBarycoord(t,n,r,i,e),e.x>=0&&e.y>=0&&e.x+e.y<=1}}(),getUV:(br=new Wt,function(e,t,n,r,i,a,o,s){return this.getBarycoord(e,t,n,r,br),s.set(0,0),s.addScaledVector(i,br.x),s.addScaledVector(a,br.y),s.addScaledVector(o,br.z),s}),isFrontFacing:function(){var e=new Wt,t=new Wt;return function(n,r,i,a){return e.subVectors(i,r),t.subVectors(n,r),e.cross(t).dot(a)<0}}()}),Object.assign(Cr.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){var e=new Wt,t=new Wt;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new Wt),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return Cr.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Wt),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return Cr.getBarycoord(e,this.a,this.b,this.c,t)},getUV:function(e,t,n,r,i){return Cr.getUV(e,this.a,this.b,this.c,t,n,r,i)},containsPoint:function(e){return Cr.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return Cr.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:(wr=new Wt,Er=new Wt,Mr=new Wt,Ar=new Wt,Tr=new Wt,_r=new Wt,function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new Wt);var n,r,i=this.a,a=this.b,o=this.c;wr.subVectors(a,i),Er.subVectors(o,i),Ar.subVectors(e,i);var s=wr.dot(Ar),c=Er.dot(Ar);if(s<=0&&c<=0)return t.copy(i);Tr.subVectors(e,a);var l=wr.dot(Tr),u=Er.dot(Tr);if(l>=0&&u<=l)return t.copy(a);var h=s*u-l*c;if(h<=0&&s>=0&&l<=0)return n=s/(s-l),t.copy(i).addScaledVector(wr,n);_r.subVectors(e,o);var d=wr.dot(_r),p=Er.dot(_r);if(p>=0&&d<=p)return t.copy(o);var f=d*c-s*p;if(f<=0&&c>=0&&p<=0)return r=c/(c-p),t.copy(i).addScaledVector(Er,r);var m=l*p-d*u;if(m<=0&&u-l>=0&&d-p>=0)return Mr.subVectors(o,a),r=(u-l)/(u-l+(d-p)),t.copy(a).addScaledVector(Mr,r);var g=1/(m+f+h);return n=f*g,r=h*g,t.copy(i).addScaledVector(wr,n).addScaledVector(Er,r)}),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),Rr.prototype=Object.create(fr.prototype),Rr.prototype.constructor=Rr,Rr.prototype.isMeshBasicMaterial=!0,Rr.prototype.copy=function(e){return fr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},Pr.prototype=Object.assign(Object.create(Gn.prototype),{constructor:Pr,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return Gn.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,a=Object.keys(i);if(a.length>0){var o=i[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=o.length;e<t;e++)n=o[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else{var s=r.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(){var e=new xn,t=new Lr,n=new vn,r=new Wt,i=new Wt,a=new Wt,o=new Wt,s=new Wt,c=new Wt,l=new Wt,u=new Wt,h=new Wt,d=new jt,p=new jt,f=new jt,m=new Wt,g=new Wt;function v(e,t,n,r,i,a,o,s){if(null===(t.side===b?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,t.side!==x,s)))return null;g.copy(s),g.applyMatrix4(e.matrixWorld);var c=n.ray.origin.distanceTo(g);return c<n.near||c>n.far?null:{distance:c,point:g.clone(),object:e}}function y(e,t,n,g,y,b,x,w,E,M){r.fromBufferAttribute(y,w),i.fromBufferAttribute(y,E),a.fromBufferAttribute(y,M);var A=e.morphTargetInfluences;if(t.morphTargets&&b&&A){l.set(0,0,0),u.set(0,0,0),h.set(0,0,0);for(var T=0,_=b.length;T<_;T++){var S=A[T],L=b[T];0!==S&&(o.fromBufferAttribute(L,w),s.fromBufferAttribute(L,E),c.fromBufferAttribute(L,M),l.addScaledVector(o.sub(r),S),u.addScaledVector(s.sub(i),S),h.addScaledVector(c.sub(a),S))}r.add(l),i.add(u),a.add(h)}var C=v(e,t,n,g,r,i,a,m);if(C){x&&(d.fromBufferAttribute(x,w),p.fromBufferAttribute(x,E),f.fromBufferAttribute(x,M),C.uv=Cr.getUV(m,r,i,a,d,p,f,new jt));var R=new Bn(w,E,M);Cr.getNormal(r,i,a,R.normal),C.face=R}return C}return function(r,i){var a,o=this.geometry,s=this.material,c=this.matrixWorld;if(void 0!==s&&(null===o.boundingSphere&&o.computeBoundingSphere(),n.copy(o.boundingSphere),n.applyMatrix4(c),!1!==r.ray.intersectsSphere(n)&&(e.getInverse(c),t.copy(r.ray).applyMatrix4(e),null===o.boundingBox||!1!==t.intersectsBox(o.boundingBox))))if(o.isBufferGeometry){var l,u,h,g,b,x,w,E,M,A,T,_=o.index,S=o.attributes.position,L=o.morphAttributes.position,C=o.attributes.uv,R=o.groups,P=o.drawRange;if(null!==_)if(Array.isArray(s))for(g=0,x=R.length;g<x;g++)for(M=s[(E=R[g]).materialIndex],b=A=Math.max(E.start,P.start),w=T=Math.min(E.start+E.count,P.start+P.count);b<w;b+=3)l=_.getX(b),u=_.getX(b+1),h=_.getX(b+2),(a=y(this,M,r,t,S,L,C,l,u,h))&&(a.faceIndex=Math.floor(b/3),a.face.materialIndex=E.materialIndex,i.push(a));else for(g=A=Math.max(0,P.start),x=T=Math.min(_.count,P.start+P.count);g<x;g+=3)l=_.getX(g),u=_.getX(g+1),h=_.getX(g+2),(a=y(this,s,r,t,S,L,C,l,u,h))&&(a.faceIndex=Math.floor(g/3),i.push(a));else if(void 0!==S)if(Array.isArray(s))for(g=0,x=R.length;g<x;g++)for(M=s[(E=R[g]).materialIndex],b=A=Math.max(E.start,P.start),w=T=Math.min(E.start+E.count,P.start+P.count);b<w;b+=3)(a=y(this,M,r,t,S,L,C,l=b,u=b+1,h=b+2))&&(a.faceIndex=Math.floor(b/3),a.face.materialIndex=E.materialIndex,i.push(a));else if(A=Math.max(0,P.start),T=Math.min(S.count,P.start+P.count),this.drawMode===Lt){var O=0;for(g=A,x=T;g<x-2;g++)u=g+1+O,h=g+2-O,O=(O+1)%2,(a=y(this,s,r,t,S,L,C,l=g,u,h))&&(a.faceIndex=Math.floor(g),i.push(a))}else for(g=A,x=T;g<x;g+=3)(a=y(this,s,r,t,S,L,C,l=g,u=g+1,h=g+2))&&(a.faceIndex=Math.floor(g/3),i.push(a))}else if(o.isGeometry){var D,I,B,k,H=Array.isArray(s),N=o.vertices,F=o.faces,U=o.faceVertexUvs[0];U.length>0&&(k=U);for(var z=0,V=F.length;z<V;z++){var j=F[z],G=H?s[j.materialIndex]:s;if(void 0!==G&&(D=N[j.a],I=N[j.b],B=N[j.c],a=v(this,G,r,t,D,I,B,m))){if(k&&k[z]){var W=k[z];d.copy(W[0]),p.copy(W[1]),f.copy(W[2]),a.uv=Cr.getUV(m,D,I,B,d,p,f,new jt)}a.face=j,a.faceIndex=z,i.push(a)}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Wr.prototype=Object.create(un.prototype),Wr.prototype.constructor=Wr,Wr.prototype.isCubeTexture=!0,Object.defineProperty(Wr.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),qr.prototype=Object.create(un.prototype),qr.prototype.constructor=qr,qr.prototype.isDataTexture2DArray=!0,Xr.prototype=Object.create(un.prototype),Xr.prototype.constructor=Xr,Xr.prototype.isDataTexture3D=!0;var Yr=new un,Kr=new qr,Jr=new Xr,Zr=new Wr,Qr=[],$r=[],ei=new Float32Array(16),ti=new Float32Array(9),ni=new Float32Array(4);function ri(e,t,n){var r=e[0];if(r<=0||r>0)return e;var i=t*n,a=Qr[i];if(void 0===a&&(a=new Float32Array(i),Qr[i]=a),0!==t){r.toArray(a,0);for(var o=1,s=0;o!==t;++o)s+=n,e[o].toArray(a,s)}return a}function ii(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function ai(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function oi(e,t){var n=$r[t];void 0===n&&(n=new Int32Array(t),$r[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function si(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function ci(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(ii(n,t))return;e.uniform2fv(this.addr,t),ai(n,t)}}function li(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(ii(n,t))return;e.uniform3fv(this.addr,t),ai(n,t)}}function ui(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(ii(n,t))return;e.uniform4fv(this.addr,t),ai(n,t)}}function hi(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(ii(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),ai(n,t)}else{if(ii(n,r))return;ni.set(r),e.uniformMatrix2fv(this.addr,!1,ni),ai(n,r)}}function di(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(ii(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),ai(n,t)}else{if(ii(n,r))return;ti.set(r),e.uniformMatrix3fv(this.addr,!1,ti),ai(n,r)}}function pi(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(ii(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),ai(n,t)}else{if(ii(n,r))return;ei.set(r),e.uniformMatrix4fv(this.addr,!1,ei),ai(n,r)}}function fi(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(t||Yr,i)}function mi(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||Kr,i)}function gi(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||Jr,i)}function vi(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(t||Zr,i)}function yi(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function bi(e,t){var n=this.cache;ii(n,t)||(e.uniform2iv(this.addr,t),ai(n,t))}function xi(e,t){var n=this.cache;ii(n,t)||(e.uniform3iv(this.addr,t),ai(n,t))}function wi(e,t){var n=this.cache;ii(n,t)||(e.uniform4iv(this.addr,t),ai(n,t))}function Ei(e,t){e.uniform1fv(this.addr,t)}function Mi(e,t){e.uniform1iv(this.addr,t)}function Ai(e,t){e.uniform2iv(this.addr,t)}function Ti(e,t){e.uniform3iv(this.addr,t)}function _i(e,t){e.uniform4iv(this.addr,t)}function Si(e,t){var n=ri(t,this.size,2);e.uniform2fv(this.addr,n)}function Li(e,t){var n=ri(t,this.size,3);e.uniform3fv(this.addr,n)}function Ci(e,t){var n=ri(t,this.size,4);e.uniform4fv(this.addr,n)}function Ri(e,t){var n=ri(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function Pi(e,t){var n=ri(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function Oi(e,t){var n=ri(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function Di(e,t,n){var r=t.length,i=oi(n,r);e.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.safeSetTexture2D(t[a]||Yr,i[a])}function Ii(e,t,n){var r=t.length,i=oi(n,r);e.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.safeSetTextureCube(t[a]||Zr,i[a])}function Bi(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return si;case 35664:return ci;case 35665:return li;case 35666:return ui;case 35674:return hi;case 35675:return di;case 35676:return pi;case 35678:case 36198:return fi;case 35679:return gi;case 35680:return vi;case 36289:return mi;case 5124:case 35670:return yi;case 35667:case 35671:return bi;case 35668:case 35672:return xi;case 35669:case 35673:return wi}}(t.type)}function ki(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Ei;case 35664:return Si;case 35665:return Li;case 35666:return Ci;case 35674:return Ri;case 35675:return Pi;case 35676:return Oi;case 35678:return Di;case 35680:return Ii;case 5124:case 35670:return Mi;case 35667:case 35671:return Ai;case 35668:case 35672:return Ti;case 35669:case 35673:return _i}}(t.type)}function Hi(e){this.id=e,this.seq=[],this.map={}}ki.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),ai(t,e)},Hi.prototype.setValue=function(e,t,n){for(var r=this.seq,i=0,a=r.length;i!==a;++i){var o=r[i];o.setValue(e,t[o.id],n)}};var Ni=/([\w\d_]+)(\])?(\[|\.)?/g;function Fi(e,t){e.seq.push(t),e.map[t.id]=t}function Ui(e,t,n){var r=e.name,i=r.length;for(Ni.lastIndex=0;;){var a=Ni.exec(r),o=Ni.lastIndex,s=a[1],c="]"===a[2],l=a[3];if(c&&(s|=0),void 0===l||"["===l&&o+2===i){Fi(n,void 0===l?new Bi(s,e,t):new ki(s,e,t));break}var u=n.map[s];void 0===u&&Fi(n,u=new Hi(s)),n=u}}function zi(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,35718),r=0;r<n;++r){var i=e.getActiveUniform(t,r);Ui(i,e.getUniformLocation(t,i.name),this)}}function Vi(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}zi.prototype.setValue=function(e,t,n,r){var i=this.map[t];void 0!==i&&i.setValue(e,n,r)},zi.prototype.setOptional=function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)},zi.upload=function(e,t,n,r){for(var i=0,a=t.length;i!==a;++i){var o=t[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}},zi.seqWithValue=function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var a=e[r];a.id in t&&n.push(a)}return n};var ji=0;function Gi(e){switch(e){case Rt:return["Linear","( value )"];case Pt:return["sRGB","( value )"];case Dt:return["RGBE","( value )"];case Bt:return["RGBM","( value, 7.0 )"];case kt:return["RGBM","( value, 16.0 )"];case Ht:return["RGBD","( value, 256.0 )"];case Ot:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function Wi(e,t,n){var r=e.getShaderParameter(t,35713),i=e.getShaderInfoLog(t).trim();return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(e.getShaderSource(t))}function qi(e,t){var n=Gi(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Xi(e,t){var n;switch(t){case oe:n="Linear";break;case se:n="Reinhard";break;case ce:n="Uncharted2";break;case le:n="OptimizedCineon";break;case ue:n="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Yi(e){return""!==e}function Ki(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function Ji(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}function Zi(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,(function(e,t){var n=wn[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Zi(n)}))}function Qi(e){return e.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,(function(e,t,n,r){for(var i="",a=parseInt(t);a<parseInt(n);a++)i+=r.replace(/\[ i \]/g,"[ "+a+" ]");return i}))}function $i(e,t,n,r,i,a,o,s,c){var l=e.context,u=r.defines,h=i.vertexShader,d=i.fragmentShader,p="SHADOWMAP_TYPE_BASIC";a.shadowMapType===g?p="SHADOWMAP_TYPE_PCF":a.shadowMapType===v&&(p="SHADOWMAP_TYPE_PCF_SOFT");var f="ENVMAP_TYPE_CUBE",m="ENVMAP_MODE_REFLECTION",y="ENVMAP_BLENDING_MULTIPLY";if(a.envMap){switch(r.envMap.mapping){case de:case pe:f="ENVMAP_TYPE_CUBE";break;case ve:case ye:f="ENVMAP_TYPE_CUBE_UV";break;case fe:case me:f="ENVMAP_TYPE_EQUIREC";break;case ge:f="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case pe:case me:m="ENVMAP_MODE_REFRACTION"}switch(r.combine){case ne:y="ENVMAP_BLENDING_MULTIPLY";break;case re:y="ENVMAP_BLENDING_MIX";break;case ie:y="ENVMAP_BLENDING_ADD"}}var b,x,w,E,M,A=e.gammaFactor>0?e.gammaFactor:1,T=o.isWebGL2?"":function(e,t,n){return[(e=e||{}).derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap&&!t.objectSpaceNormalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Yi).join("\n")}(r.extensions,a,t),_=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(u),S=l.createProgram();if(r.isRawShaderMaterial?((b=[_].filter(Yi).join("\n")).length>0&&(b+="\n"),(x=[T,_].filter(Yi).join("\n")).length>0&&(x+="\n")):(b=["precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+i.name,_,a.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+A,"#define MAX_BONES "+a.maxBones,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+m:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.displacementMap&&a.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&!1===a.flatShading?"#define USE_MORPHNORMALS":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+p:"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&(o.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;",e.vr.multiview?["uniform mat4 modelViewMatrix2;","uniform mat4 projectionMatrix2;","uniform mat4 viewMatrix2;","uniform mat3 normalMatrix2;","uniform vec3 cameraPosition2;","#define modelViewMatrix (gl_ViewID_OVR==0u?modelViewMatrix:modelViewMatrix2)","#define projectionMatrix (gl_ViewID_OVR==0u?projectionMatrix:projectionMatrix2)","#define viewMatrix (gl_ViewID_OVR==0u?viewMatrix:viewMatrix2)","#define normalMatrix (gl_ViewID_OVR==0u?normalMatrix:normalMatrix2)","#define cameraPosition (gl_ViewID_OVR==0u?cameraPosition:cameraPosition2)"].join("\n"):"","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Yi).join("\n"),x=[T,"precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+i.name,_,a.alphaTest?"#define ALPHATEST "+a.alphaTest+(a.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+A,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.matcap?"#define USE_MATCAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+f:"",a.envMap?"#define "+m:"",a.envMap?"#define "+y:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.gradientMap?"#define USE_GRADIENTMAP":"",a.flatShading?"#define FLAT_SHADED":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+p:"",a.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",a.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&(o.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",a.envMap&&(o.isWebGL2||t.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",e.vr.multiview?["uniform vec3 cameraPosition2;","#define cameraPosition (gl_ViewID_OVR==0u?cameraPosition:cameraPosition2)"].join("\n"):"",a.toneMapping!==ae?"#define TONE_MAPPING":"",a.toneMapping!==ae?wn.tonemapping_pars_fragment:"",a.toneMapping!==ae?Xi("toneMapping",a.toneMapping):"",a.dithering?"#define DITHERING":"",a.outputEncoding||a.mapEncoding||a.matcapEncoding||a.envMapEncoding||a.emissiveMapEncoding?wn.encodings_pars_fragment:"",a.mapEncoding?qi("mapTexelToLinear",a.mapEncoding):"",a.matcapEncoding?qi("matcapTexelToLinear",a.matcapEncoding):"",a.envMapEncoding?qi("envMapTexelToLinear",a.envMapEncoding):"",a.emissiveMapEncoding?qi("emissiveMapTexelToLinear",a.emissiveMapEncoding):"",a.outputEncoding?(w="linearToOutputTexel",E=a.outputEncoding,M=Gi(E),"vec4 "+w+"( vec4 value ) { return LinearTo"+M[0]+M[1]+"; }"):"",a.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(Yi).join("\n")),h=Ji(h=Ki(h=Zi(h),a),a),d=Ji(d=Ki(d=Zi(d),a),a),h=Qi(h),d=Qi(d),o.isWebGL2){var L=!1,C=/^\s*#version\s+300\s+es\s*\n/;if(r.isShaderMaterial&&null!==h.match(C)&&null!==d.match(C)&&(L=!0,h=h.replace(C,""),d=d.replace(C,"")),r.isRawShaderMaterial){const e="#version 300 es\n";L&&(b=e+b,x=e+x)}else b=["#version 300 es\n",e.vr.multiview?["#extension GL_OVR_multiview : require","layout(num_views = 2) in;"].join("\n"):"","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+b,x=["#version 300 es\n","#define varying in",L?"":"out highp vec4 pc_fragColor;",L?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+x}var R,P,O=x+d,D=Vi(l,35633,b+h),I=Vi(l,35632,O);if(l.attachShader(S,D),l.attachShader(S,I),void 0!==r.index0AttributeName?l.bindAttribLocation(S,0,r.index0AttributeName):!0===a.morphTargets&&l.bindAttribLocation(S,0,"position"),l.linkProgram(S),e.debug.checkShaderErrors){var B=l.getProgramInfoLog(S).trim(),k=l.getShaderInfoLog(D).trim(),H=l.getShaderInfoLog(I).trim(),N=!0,F=!0;if(!1===l.getProgramParameter(S,35714)){N=!1;var U=Wi(l,D,"vertex"),z=Wi(l,I,"fragment");console.error("THREE.WebGLProgram: shader error: ",l.getError(),"35715",l.getProgramParameter(S,35715),"gl.getProgramInfoLog",B,U,z)}else""!==B?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",B):""!==k&&""!==H||(F=!1);F&&(this.diagnostics={runnable:N,material:r,programLog:B,vertexShader:{log:k,prefix:b},fragmentShader:{log:H,prefix:x}})}return l.deleteShader(D),l.deleteShader(I),this.getUniforms=function(){return void 0===R&&(R=new zi(l,S,s)),R},this.getAttributes=function(){return void 0===P&&(P=function(e,t){for(var n={},r=e.getProgramParameter(t,35721),i=0;i<r;i++){var a=e.getActiveAttrib(t,i).name;n[a]=e.getAttribLocation(t,a)}return n}(l,S)),P},this.destroy=function(){c.releaseStatesOfProgram(this),l.deleteProgram(S),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.name=i.name,this.id=ji++,this.code=n,this.usedTimes=1,this.program=S,this.vertexShader=D,this.fragmentShader=I,this}function ea(e,t,n,r,i){var a=[],o={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},s=["precision","supportsVertexTextures","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function c(e,t){var n;return e?e.isTexture?n=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=e.texture.encoding):n=Rt,n===Rt&&t&&(n=Ot),n}this.getParameters=function(t,r,i,a,s,l,u){var h=o[t.type],d=u.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(n.floatVertexTextures)return 1024;var r=n.maxVertexUniforms,i=Math.floor((r-20)/4),a=Math.min(i,t.length);return a<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+a+"."),0):a}(u):0,p=n.precision;null!==t.precision&&(p=n.getMaxPrecision(t.precision))!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",p,"instead.");var f=e.getRenderTarget();return{shaderID:h,precision:p,supportsVertexTextures:n.vertexTextures,outputEncoding:c(f?f.texture:null,e.gammaOutput),map:!!t.map,mapEncoding:c(t.map,e.gammaInput),matcap:!!t.matcap,matcapEncoding:c(t.matcap,e.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:c(t.envMap,e.gammaInput),envMapCubeUV:!!t.envMap&&(t.envMap.mapping===ve||t.envMap.mapping===ye),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:c(t.emissiveMap,e.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,objectSpaceNormalMap:t.normalMapType===zt,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,combine:t.combine,vertexTangents:t.normalMap&&t.vertexTangents,vertexColors:t.vertexColors,fog:!!a,useFog:t.fog,fogExp:a&&a.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:n.logarithmicDepthBuffer,skinning:t.skinning&&d>0,maxBones:d,useVertexTexture:n.floatVertexTextures,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:r.directional.length,numPointLights:r.point.length,numSpotLights:r.spot.length,numRectAreaLights:r.rectArea.length,numHemiLights:r.hemi.length,numClippingPlanes:s,numClipIntersection:l,dithering:t.dithering,shadowMapEnabled:e.shadowMap.enabled&&u.receiveShadow&&i.length>0,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:t.side===x,flipSided:t.side===b,depthPacking:void 0!==t.depthPacking&&t.depthPacking}},this.getProgramCode=function(t,n){var r=[];if(n.shaderID?r.push(n.shaderID):(r.push(t.fragmentShader),r.push(t.vertexShader)),void 0!==t.defines)for(var i in t.defines)r.push(i),r.push(t.defines[i]);for(var a=0;a<s.length;a++)r.push(n[s[a]]);return r.push(t.onBeforeCompile.toString()),r.push(e.gammaOutput),r.push(e.gammaFactor),r.join()},this.acquireProgram=function(o,s,c,l){for(var u,h=0,d=a.length;h<d;h++){var p=a[h];if(p.code===l){++(u=p).usedTimes;break}}return void 0===u&&(u=new $i(e,t,l,o,s,c,n,r,i),a.push(u)),u},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=a.indexOf(e);a[t]=a[a.length-1],a.pop(),e.destroy()}},this.programs=a}function ta(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function na(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function ra(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function ia(){var e=[],t=0,n=[],r=[],i={id:-1};function a(n,r,a,o,s,c){var l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:r,material:a,program:a.program||i,groupOrder:o,renderOrder:n.renderOrder,z:s,group:c},e[t]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=a,l.program=a.program||i,l.groupOrder=o,l.renderOrder=n.renderOrder,l.z=s,l.group=c),t++,l}return{opaque:n,transparent:r,init:function(){t=0,n.length=0,r.length=0},push:function(e,t,i,o,s,c){var l=a(e,t,i,o,s,c);(!0===i.transparent?r:n).push(l)},unshift:function(e,t,i,o,s,c){var l=a(e,t,i,o,s,c);(!0===i.transparent?r:n).unshift(l)},sort:function(){n.length>1&&n.sort(na),r.length>1&&r.sort(ra)}}}function aa(){var e={};function t(n){var r=n.target;r.removeEventListener("dispose",t),delete e[r.id]}return{get:function(n,r){var i,a=e[n.id];return void 0===a?(i=new ia,e[n.id]={},e[n.id][r.id]=i,n.addEventListener("dispose",t)):void 0===(i=a[r.id])&&(i=new ia,a[r.id]=i),i},dispose:function(){e={}}}}function oa(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new Wt,color:new Cn,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new jt};break;case"SpotLight":n={position:new Wt,direction:new Wt,color:new Cn,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new jt};break;case"PointLight":n={position:new Wt,color:new Cn,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new jt,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":n={direction:new Wt,skyColor:new Cn,groundColor:new Cn};break;case"RectAreaLight":n={color:new Cn,position:new Wt,halfWidth:new Wt,halfHeight:new Wt}}return e[t.id]=n,n}}}var sa=0;function ca(){for(var e=new oa,t={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},n=0;n<9;n++)t.probe.push(new Wt);var r=new Wt,i=new xn,a=new xn;return{setup:function(n,o,s){for(var c=0,l=0,u=0,h=0;h<9;h++)t.probe[h].set(0,0,0);for(var d=0,p=0,f=0,m=0,g=0,v=s.matrixWorldInverse,y=(h=0,n.length);h<y;h++){var b=n[h],x=b.color,w=b.intensity,E=b.distance,M=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)c+=x.r*w,l+=x.g*w,u+=x.b*w;else if(b.isLightProbe)for(var A=0;A<9;A++)t.probe[A].addScaledVector(b.sh.coefficients[A],w);else if(b.isDirectionalLight){if((_=e.get(b)).color.copy(b.color).multiplyScalar(b.intensity),_.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),_.direction.sub(r),_.direction.transformDirection(v),_.shadow=b.castShadow,b.castShadow){var T=b.shadow;_.shadowBias=T.bias,_.shadowRadius=T.radius,_.shadowMapSize=T.mapSize}t.directionalShadowMap[d]=M,t.directionalShadowMatrix[d]=b.shadow.matrix,t.directional[d]=_,d++}else if(b.isSpotLight){if((_=e.get(b)).position.setFromMatrixPosition(b.matrixWorld),_.position.applyMatrix4(v),_.color.copy(x).multiplyScalar(w),_.distance=E,_.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),_.direction.sub(r),_.direction.transformDirection(v),_.coneCos=Math.cos(b.angle),_.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),_.decay=b.decay,_.shadow=b.castShadow,b.castShadow){T=b.shadow;_.shadowBias=T.bias,_.shadowRadius=T.radius,_.shadowMapSize=T.mapSize}t.spotShadowMap[f]=M,t.spotShadowMatrix[f]=b.shadow.matrix,t.spot[f]=_,f++}else if(b.isRectAreaLight){(_=e.get(b)).color.copy(x).multiplyScalar(w),_.position.setFromMatrixPosition(b.matrixWorld),_.position.applyMatrix4(v),a.identity(),i.copy(b.matrixWorld),i.premultiply(v),a.extractRotation(i),_.halfWidth.set(.5*b.width,0,0),_.halfHeight.set(0,.5*b.height,0),_.halfWidth.applyMatrix4(a),_.halfHeight.applyMatrix4(a),t.rectArea[m]=_,m++}else if(b.isPointLight){if((_=e.get(b)).position.setFromMatrixPosition(b.matrixWorld),_.position.applyMatrix4(v),_.color.copy(b.color).multiplyScalar(b.intensity),_.distance=b.distance,_.decay=b.decay,_.shadow=b.castShadow,b.castShadow){T=b.shadow;_.shadowBias=T.bias,_.shadowRadius=T.radius,_.shadowMapSize=T.mapSize,_.shadowCameraNear=T.camera.near,_.shadowCameraFar=T.camera.far}t.pointShadowMap[p]=M,t.pointShadowMatrix[p]=b.shadow.matrix,t.point[p]=_,p++}else if(b.isHemisphereLight){var _;(_=e.get(b)).direction.setFromMatrixPosition(b.matrixWorld),_.direction.transformDirection(v),_.direction.normalize(),_.skyColor.copy(b.color).multiplyScalar(w),_.groundColor.copy(b.groundColor).multiplyScalar(w),t.hemi[g]=_,g++}}t.ambient[0]=c,t.ambient[1]=l,t.ambient[2]=u;var S=t.hash;S.directionalLength===d&&S.pointLength===p&&S.spotLength===f&&S.rectAreaLength===m&&S.hemiLength===g&&S.shadowsLength===o.length||(t.directional.length=d,t.spot.length=f,t.rectArea.length=m,t.point.length=p,t.hemi.length=g,S.directionalLength=d,S.pointLength=p,S.spotLength=f,S.rectAreaLength=m,S.hemiLength=g,S.shadowsLength=o.length,t.version=sa++)},state:t}}function la(){var e=new ca,t=[],n=[];return{init:function(){t.length=0,n.length=0},state:{lightsArray:t,shadowsArray:n,lights:e},setupLights:function(r){e.setup(t,n,r)},pushLight:function(e){t.push(e)},pushShadow:function(e){n.push(e)}}}function ua(){var e={};function t(n){var r=n.target;r.removeEventListener("dispose",t),delete e[r.id]}return{get:function(n,r){var i;return void 0===e[n.id]?(i=new la,e[n.id]={},e[n.id][r.id]=i,n.addEventListener("dispose",t)):void 0===e[n.id][r.id]?(i=new la,e[n.id][r.id]=i):i=e[n.id][r.id],i},dispose:function(){e={}}}}function ha(e){fr.call(this),this.type="MeshDepthMaterial",this.depthPacking=Nt,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function da(e){fr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Wt,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(e)}function pa(e,t,n){for(var r=new bn,i=new xn,a=new jt,o=new jt(n,n),s=new Wt,c=new Wt,l=new Array(4),u=new Array(4),h={},d={0:b,1:y,2:x},p=[new Wt(1,0,0),new Wt(-1,0,0),new Wt(0,0,1),new Wt(0,0,-1),new Wt(0,1,0),new Wt(0,-1,0)],f=[new Wt(0,1,0),new Wt(0,1,0),new Wt(0,1,0),new Wt(0,1,0),new Wt(0,0,1),new Wt(0,0,-1)],m=[new hn,new hn,new hn,new hn,new hn,new hn],v=0;4!==v;++v){var w=0!=(1&v),E=0!=(2&v),M=new ha({depthPacking:Ft,morphTargets:w,skinning:E});l[v]=M;var A=new da({morphTargets:w,skinning:E});u[v]=A}var T=this;function S(t,n,r,i,a,o){var s=t.geometry,c=null,p=l,f=t.customDepthMaterial;if(r&&(p=u,f=t.customDistanceMaterial),f)c=f;else{var m=!1;n.morphTargets&&(s&&s.isBufferGeometry?m=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:s&&s.isGeometry&&(m=s.morphTargets&&s.morphTargets.length>0)),t.isSkinnedMesh&&!1===n.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t);var g=0;m&&(g|=1),t.isSkinnedMesh&&n.skinning&&(g|=2),c=p[g]}if(e.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var v=c.uuid,y=n.uuid,b=h[v];void 0===b&&(b={},h[v]=b);var x=b[y];void 0===x&&(x=c.clone(),b[y]=x),c=x}return c.visible=n.visible,c.wireframe=n.wireframe,c.side=null!=n.shadowSide?n.shadowSide:d[n.side],c.clipShadows=n.clipShadows,c.clippingPlanes=n.clippingPlanes,c.clipIntersection=n.clipIntersection,c.wireframeLinewidth=n.wireframeLinewidth,c.linewidth=n.linewidth,r&&c.isMeshDistanceMaterial&&(c.referencePosition.copy(i),c.nearDistance=a,c.farDistance=o),c}function L(n,i,a,o){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&n.castShadow&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);var s=t.update(n),l=n.material;if(Array.isArray(l))for(var u=s.groups,h=0,d=u.length;h<d;h++){var p=u[h],f=l[p.materialIndex];if(f&&f.visible){var m=S(n,f,o,c,a.near,a.far);e.renderBufferDirect(a,null,s,m,n,p)}}else if(l.visible){m=S(n,l,o,c,a.near,a.far);e.renderBufferDirect(a,null,s,m,n,null)}}for(var g=n.children,v=0,y=g.length;v<y;v++)L(g[v],i,a,o)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=g,this.render=function(t,n,l){if(!1!==T.enabled&&(!1!==T.autoUpdate||!1!==T.needsUpdate)&&0!==t.length){var u,h=e.getRenderTarget(),d=e.getActiveCubeFace(),g=e.getActiveMipMapLevel(),v=e.state;v.setBlending(_),v.buffers.color.setClear(1,1,1,1),v.buffers.depth.setTest(!0),v.setScissorTest(!1);for(var y=0,b=t.length;y<b;y++){var x=t[y],w=x.shadow,E=x&&x.isPointLight;if(void 0!==w){var M=w.camera;if(a.copy(w.mapSize),a.min(o),E){var A=a.x,S=a.y;m[0].set(2*A,S,A,S),m[1].set(0,S,A,S),m[2].set(3*A,S,A,S),m[3].set(A,S,A,S),m[4].set(3*A,0,A,S),m[5].set(A,0,A,S),a.x*=4,a.y*=2}if(null===w.map){var C={minFilter:Ee,magFilter:Ee,format:Ve};w.map=new dn(a.x,a.y,C),w.map.texture.name=x.name+".shadowMap",M.updateProjectionMatrix()}w.isSpotLightShadow&&w.update(x);var R=w.map,P=w.matrix;c.setFromMatrixPosition(x.matrixWorld),M.position.copy(c),E?(u=6,P.makeTranslation(-c.x,-c.y,-c.z)):(u=1,s.setFromMatrixPosition(x.target.matrixWorld),M.lookAt(s),M.updateMatrixWorld(),P.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),P.multiply(M.projectionMatrix),P.multiply(M.matrixWorldInverse)),e.setRenderTarget(R),e.clear();for(var O=0;O<u;O++){if(E){s.copy(M.position),s.add(p[O]),M.up.copy(f[O]),M.lookAt(s),M.updateMatrixWorld();var D=m[O];v.viewport(D)}i.multiplyMatrices(M.projectionMatrix,M.matrixWorldInverse),r.setFromMatrix(i),L(n,l,M,E)}}else console.warn("THREE.WebGLShadowMap:",x,"has no shadow.")}T.needsUpdate=!1,e.setRenderTarget(h,d,g)}}}function fa(e,t,n){var r=new function(){var t=!1,n=new hn,r=null,i=new hn(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,o,s){!0===s&&(t*=o,r*=o,a*=o),n.set(t,r,a,o),!1===i.equals(n)&&(e.clearColor(t,r,a,o),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},i=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(e){e?X(2929):ne(2929)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case Y:e.depthFunc(512);break;case K:e.depthFunc(519);break;case J:e.depthFunc(513);break;case Z:e.depthFunc(515);break;case Q:e.depthFunc(514);break;case $:e.depthFunc(518);break;case ee:e.depthFunc(516);break;case te:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},a=new function(){var t=!1,n=null,r=null,i=null,a=null,o=null,s=null,c=null,l=null;return{setTest:function(e){e?X(2960):ne(2960)},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&i===n&&a===o||(e.stencilFunc(t,n,o),r=t,i=n,a=o)},setOp:function(t,n,r){o===t&&s===n&&c===r||(e.stencilOp(t,n,r),o=t,s=n,c=r)},setLocked:function(e){t=e},setClear:function(t){l!==t&&(e.clearStencil(t),l=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,o=null,s=null,c=null,l=null}}},o=new WeakMap,s=new WeakMap,c={},d=null,p=null,f=null,m=null,g=null,v=null,y=null,w=null,E=null,M=null,A=!1,T=null,D=null,I=null,B=null,k=null,H=e.getParameter(35661),N=!1,F=0,U=e.getParameter(7938);-1!==U.indexOf("WebGL")?(F=parseFloat(/^WebGL\ ([0-9])/.exec(U)[1]),N=F>=1):-1!==U.indexOf("OpenGL ES")&&(F=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(U)[1]),N=F>=2);var z=null,V={},j=new hn,G=new hn;function W(t,n,r){var i=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var o=0;o<r;o++)e.texImage2D(n+o,0,6408,1,1,0,6408,5121,i);return a}var q={};function X(t){!0!==c[t]&&(e.enable(t),c[t]=!0)}function ne(t){!1!==c[t]&&(e.disable(t),c[t]=!1)}function re(t,r,i,a,o,s,c,l){if(t!==_){if(f||(X(3042),f=!0),t===P)o=o||r,s=s||i,c=c||a,r===g&&o===w||(e.blendEquationSeparate(n.convert(r),n.convert(o)),g=r,w=o),i===v&&a===y&&s===E&&c===M||(e.blendFuncSeparate(n.convert(i),n.convert(a),n.convert(s),n.convert(c)),v=i,y=a,E=s,M=c),m=t,A=null;else if(t!==m||l!==A){if(g===O&&w===O||(e.blendEquation(32774),g=O,w=O),l)switch(t){case S:e.blendFuncSeparate(1,771,1,771);break;case L:e.blendFunc(1,1);break;case C:e.blendFuncSeparate(0,0,769,771);break;case R:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case S:e.blendFuncSeparate(770,771,1,771);break;case L:e.blendFunc(770,1);break;case C:e.blendFunc(0,769);break;case R:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}v=null,y=null,E=null,M=null,m=t,A=l}}else f&&(ne(3042),f=!1)}function ie(t){T!==t&&(t?e.frontFace(2304):e.frontFace(2305),T=t)}function ae(t){t!==l?(X(2884),t!==D&&(t===u?e.cullFace(1029):t===h?e.cullFace(1028):e.cullFace(1032))):ne(2884),D=t}function oe(t,n,r){t?(X(32823),B===n&&k===r||(e.polygonOffset(n,r),B=n,k=r)):ne(32823)}function se(t){void 0===t&&(t=33984+H-1),z!==t&&(e.activeTexture(t),z=t)}return q[3553]=W(3553,3553,1),q[34067]=W(34067,34069,6),r.setClear(0,0,0,1),i.setClear(1),a.setClear(0),X(2929),i.setFunc(Z),ie(!1),ae(u),X(2884),re(_),{buffers:{color:r,depth:i,stencil:a},enable:X,disable:ne,getCompressedTextureFormats:function(){if(null===d&&(d=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")||t.get("WEBGL_compressed_texture_astc")))for(var n=e.getParameter(34467),r=0;r<n.length;r++)d.push(n[r]);return d},useProgram:function(t){return p!==t&&(e.useProgram(t),p=t,!0)},setBlending:re,setMaterial:function(e,t){e.side===x?ne(2884):X(2884);var n=e.side===b;t&&(n=!n),ie(n),e.blending===S&&!1===e.transparent?re(_):re(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),i.setFunc(e.depthFunc),i.setTest(e.depthTest),i.setMask(e.depthWrite),r.setMask(e.colorWrite),oe(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:ie,setCullFace:ae,setLineWidth:function(t){t!==I&&(N&&e.lineWidth(t),I=t)},setPolygonOffset:oe,setScissorTest:function(e){e?X(3089):ne(3089)},activeTexture:se,bindTexture:function(t,n){null===z&&se();var r=V[z];void 0===r&&(r={type:void 0,texture:void 0},V[z]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||q[t]),r.type=t,r.texture=n)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===j.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),j.copy(t))},viewport:function(t){!1===G.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),G.copy(t))},updateUBOMapping:function(t,n){var r=s.get(n);void 0===r&&(r=new WeakMap,s.set(n,r));var i=r.get(t);void 0===i&&(i=e.getUniformBlockIndex(n,t.name),r.set(t,i))},uniformBlockBinding:function(t,n){var r=s.get(n).get(t);o.get(t)!==r&&(e.uniformBlockBinding(n,r,t.__bindingPointIndex),o.set(t,r))},reset:function(){c={},d=null,z=null,V={},p=null,m=null,T=null,D=null,r.reset(),i.reset(),a.reset()}}}function ma(e,t,n,r,i,a,o){var s,c={},l="undefined"!=typeof OffscreenCanvas;function u(e,t){return l?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function h(e,t,n,r){var i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var a=t?Vt.floorPowerOfTwo:Math.floor,o=a(i*e.width),c=a(i*e.height);void 0===s&&(s=u(o,c));var l=n?u(o,c):s;return l.width=o,l.height=c,l.getContext("2d").drawImage(e,0,0,o,c),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+c+")."),l}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function d(e){return Vt.isPowerOfTwo(e.width)&&Vt.isPowerOfTwo(e.height)}function p(e,t){return e.generateMipmaps&&t&&e.minFilter!==Ee&&e.minFilter!==Te}function f(t,n,i,a){e.generateMipmap(t),r.get(n).__maxMipLevel=Math.log(Math.max(i,a))*Math.LOG2E}function m(e,n){if(!i.isWebGL2)return e;var r=e;return 6403===e&&(5126===n&&(r=33326),5131===n&&(r=33325),5121===n&&(r=33321)),6407===e&&(5126===n&&(r=34837),5131===n&&(r=34843),5121===n&&(r=32849)),6408===e&&(5126===n&&(r=34836),5131===n&&(r=34842),5121===n&&(r=32856)),33325===r||33326===r||34842===r||34836===r?t.get("EXT_color_buffer_float"):34843!==r&&34837!==r||console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),r}function g(e){return e===Ee||e===Me||e===Ae?9728:9729}function v(t){var n=t.target;n.removeEventListener("dispose",v),function(t){var n=r.get(t);if(void 0===n.__webglInit)return;e.deleteTexture(n.__webglTexture),r.remove(t)}(n),n.isVideoTexture&&delete c[n.id],o.memory.textures--}function y(t){var n=t.target;n.removeEventListener("dispose",y),function(t){var n=r.get(t),i=r.get(t.texture);if(!t)return;void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLRenderTargetCube)for(var a=0;a<6;a++)e.deleteFramebuffer(n.__webglFramebuffer[a]),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[a]);else e.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer);r.remove(t.texture),r.remove(t)}(n),o.memory.textures--}var b=0;function x(e,t){var i=r.get(e);if(e.isVideoTexture&&function(e){var t=e.id,n=o.render.frame;c[t]!==n&&(c[t]=n,e.update())}(e),e.version>0&&i.__version!==e.version){var a=e.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==a.complete)return void T(i,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,i.__webglTexture)}function w(t,o){var s=r.get(t);if(6===t.image.length)if(t.version>0&&s.__version!==t.version){A(s,t),n.activeTexture(33984+o),n.bindTexture(34067,s.__webglTexture),e.pixelStorei(37440,t.flipY);for(var c=t.image[0]&&t.image[0].isCompressedTexture,l=t.image[0]&&t.image[0].isDataTexture,u=[],g=0;g<6;g++)u[g]=c||l?l?t.image[g].image:t.image[g]:h(t.image[g],!1,!0,i.maxCubemapSize);var v=u[0],y=d(v)||i.isWebGL2,b=a.convert(t.format),x=a.convert(t.type),w=m(b,x);M(34067,t,y);for(g=0;g<6;g++)if(c)for(var E,T=u[g].mipmaps,_=0,S=T.length;_<S;_++)E=T[_],t.format!==Ve&&t.format!==ze?n.getCompressedTextureFormats().indexOf(b)>-1?n.compressedTexImage2D(34069+g,_,w,E.width,E.height,0,E.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+g,_,w,E.width,E.height,0,b,x,E.data);else l?n.texImage2D(34069+g,0,w,u[g].width,u[g].height,0,b,x,u[g].data):n.texImage2D(34069+g,0,w,b,x,u[g]);s.__maxMipLevel=c?T.length-1:0,p(t,y)&&f(34067,t,v.width,v.height),s.__version=t.version,t.onUpdate&&t.onUpdate(t)}else n.activeTexture(33984+o),n.bindTexture(34067,s.__webglTexture)}function E(e,t){n.activeTexture(33984+t),n.bindTexture(34067,r.get(e).__webglTexture)}function M(n,o,s){var c;if(s?(e.texParameteri(n,10242,a.convert(o.wrapS)),e.texParameteri(n,10243,a.convert(o.wrapT)),32879!==n&&35866!==n||e.texParameteri(n,32882,a.convert(o.wrapR)),e.texParameteri(n,10240,a.convert(o.magFilter)),e.texParameteri(n,10241,a.convert(o.minFilter))):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),o.wrapS===xe&&o.wrapT===xe||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,g(o.magFilter)),e.texParameteri(n,10241,g(o.minFilter)),o.minFilter!==Ee&&o.minFilter!==Te&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),c=t.get("EXT_texture_filter_anisotropic")){if(o.type===Ie&&null===t.get("OES_texture_float_linear"))return;if(o.type===Be&&null===(i.isWebGL2||t.get("OES_texture_half_float_linear")))return;(o.anisotropy>1||r.get(o).__currentAnisotropy)&&(e.texParameterf(n,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy)}}function A(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",v),t.__webglTexture=e.createTexture(),o.memory.textures++)}function T(t,r,o){var s=3553;r.isDataTexture2DArray&&(s=35866),r.isDataTexture3D&&(s=32879),A(t,r),n.activeTexture(33984+o),n.bindTexture(s,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment);var c=function(e){return!i.isWebGL2&&(e.wrapS!==xe||e.wrapT!==xe||e.minFilter!==Ee&&e.minFilter!==Te)}(r)&&!1===d(r.image),l=h(r.image,c,!1,i.maxTextureSize),u=d(l)||i.isWebGL2,g=a.convert(r.format),v=a.convert(r.type),y=m(g,v);M(s,r,u);var b,x=r.mipmaps;if(r.isDepthTexture){if(y=6402,r.type===Ie){if(!i.isWebGL2)throw new Error("Float Depth Texture only supported in WebGL2.0");y=36012}else i.isWebGL2&&(y=33189);r.format===qe&&6402===y&&r.type!==Pe&&r.type!==De&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=Pe,v=a.convert(r.type)),r.format===Xe&&(y=34041,r.type!==Fe&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=Fe,v=a.convert(r.type))),n.texImage2D(3553,0,y,l.width,l.height,0,g,v,null)}else if(r.isDataTexture)if(x.length>0&&u){for(var w=0,E=x.length;w<E;w++)b=x[w],n.texImage2D(3553,w,y,b.width,b.height,0,g,v,b.data);r.generateMipmaps=!1,t.__maxMipLevel=x.length-1}else n.texImage2D(3553,0,y,l.width,l.height,0,g,v,l.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(w=0,E=x.length;w<E;w++)b=x[w],r.format!==Ve&&r.format!==ze?n.getCompressedTextureFormats().indexOf(g)>-1?n.compressedTexImage2D(3553,w,y,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,w,y,b.width,b.height,0,g,v,b.data);t.__maxMipLevel=x.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,y,l.width,l.height,l.depth,0,g,v,l.data),t.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,y,l.width,l.height,l.depth,0,g,v,l.data),t.__maxMipLevel=0;else if(x.length>0&&u){for(w=0,E=x.length;w<E;w++)b=x[w],n.texImage2D(3553,w,y,g,v,b);r.generateMipmaps=!1,t.__maxMipLevel=x.length-1}else n.texImage2D(3553,0,y,g,v,l),t.__maxMipLevel=0;p(r,u)&&f(3553,r,l.width,l.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function _(t,i,o,s){var c=a.convert(i.texture.format),l=a.convert(i.texture.type),u=m(c,l);n.texImage2D(s,0,u,i.width,i.height,0,c,l,null),e.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,o,s,r.get(i.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function S(t,n,r){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){if(r){var i=C(n);e.renderbufferStorageMultisample(36161,i,33189,n.width,n.height)}else e.renderbufferStorage(36161,33189,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){if(r){i=C(n);e.renderbufferStorageMultisample(36161,i,34041,n.width,n.height)}else e.renderbufferStorage(36161,34041,n.width,n.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{var o=m(a.convert(n.texture.format),a.convert(n.texture.type));if(r){i=C(n);e.renderbufferStorageMultisample(36161,i,o,n.width,n.height)}else e.renderbufferStorage(36161,o,n.width,n.height)}e.bindRenderbuffer(36161,null)}function L(t){var n=r.get(t),i=!0===t.isWebGLRenderTargetCube;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,n){if(n&&n.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,t),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),x(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===qe)e.framebufferTexture2D(36160,36096,3553,i,0);else{if(n.depthTexture.format!==Xe)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,i,0)}}(n.__webglFramebuffer,t)}else if(i){n.__webglDepthbuffer=[];for(var a=0;a<6;a++)e.bindFramebuffer(36160,n.__webglFramebuffer[a]),n.__webglDepthbuffer[a]=e.createRenderbuffer(),S(n.__webglDepthbuffer[a],t)}else e.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),S(n.__webglDepthbuffer,t);e.bindFramebuffer(36160,null)}function C(e){return i.isWebGL2&&e.isWebGLMultisampleRenderTarget?Math.min(i.maxSamples,e.samples):0}var R=!1,P=!1;this.allocateTextureUnit=function(){var e=b;return e>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+i.maxTextures),b+=1,e},this.resetTextureUnits=function(){b=0},this.setTexture2D=x,this.setTexture2DArray=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?T(i,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?T(i,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=w,this.setTextureCubeDynamic=E,this.setupRenderTarget=function(t){var s=r.get(t),c=r.get(t.texture);t.addEventListener("dispose",y),c.__webglTexture=e.createTexture(),o.memory.textures++;var l=!0===t.isWebGLRenderTargetCube,u=!0===t.isWebGLMultisampleRenderTarget,h=d(t)||i.isWebGL2;if(l){s.__webglFramebuffer=[];for(var g=0;g<6;g++)s.__webglFramebuffer[g]=e.createFramebuffer()}else if(s.__webglFramebuffer=e.createFramebuffer(),u)if(i.isWebGL2){s.__webglMultisampledFramebuffer=e.createFramebuffer(),s.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,s.__webglColorRenderbuffer);var v=m(a.convert(t.texture.format),a.convert(t.texture.type)),b=C(t);e.renderbufferStorageMultisample(36161,b,v,t.width,t.height),e.bindFramebuffer(36160,s.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,s.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(s.__webglDepthRenderbuffer=e.createRenderbuffer(),S(s.__webglDepthRenderbuffer,t,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(l){n.bindTexture(34067,c.__webglTexture),M(34067,t.texture,h);for(g=0;g<6;g++)_(s.__webglFramebuffer[g],t,36064,34069+g);p(t.texture,h)&&f(34067,t.texture,t.width,t.height),n.bindTexture(34067,null)}else n.bindTexture(3553,c.__webglTexture),M(3553,t.texture,h),_(s.__webglFramebuffer,t,36064,3553),p(t.texture,h)&&f(3553,t.texture,t.width,t.height),n.bindTexture(3553,null);t.depthBuffer&&L(t)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(p(t,d(e)||i.isWebGL2)){var a=e.isWebGLRenderTargetCube?34067:3553,o=r.get(t).__webglTexture;n.bindTexture(a,o),f(a,t,e.width,e.height),n.bindTexture(a,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(i.isWebGL2){var n=r.get(t);e.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,n.__webglFramebuffer);var a=t.width,o=t.height,s=16384;t.depthBuffer&&(s|=256),t.stencilBuffer&&(s|=1024),e.blitFramebuffer(0,0,a,o,0,0,a,o,s,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===R&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),R=!0),e=e.texture),x(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLRenderTargetCube&&(!1===P&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),P=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?w(e,t):E(e,t)}}function ga(e,t,n,r){var i={},a={},o=[],s=n.isWebGL2?e.getParameter(35375):0;function c(e,t,n){var r=e.value;if(void 0===n[t])return n[t]="number"==typeof r?r:r.clone(),!0;if("number"==typeof r){if(n[t]!==r)return n[t]=r,!0}else{var i=n[t];if(!1===i.equals(r))return i.copy(r),!0}return!1}function l(e){var t=e.value,n={boundary:0,storage:0};return"number"==typeof t?(n.boundary=4,n.storage=4):t.isVector2?(n.boundary=8,n.storage=8):t.isVector3||t.isColor?(n.boundary=16,n.storage=12):t.isVector4?(n.boundary=16,n.storage=16):t.isMatrix3?(n.boundary=48,n.storage=48):t.isMatrix4?(n.boundary=64,n.storage=64):t.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",t),n}function u(t){var n=t.target;n.removeEventListener("dispose",u);var r=o.indexOf(n.__bindingPointIndex);o.splice(r,1),e.deleteBuffer(i[n.id]),delete i[n.id],delete a[n.id]}return{bind:function(e,t){r.uniformBlockBinding(e,t)},update:function(n,h){var d=i[n.id];void 0===d&&(!function(e){if(e.isRawUniformsGroup)return this;for(var t=e.uniforms,n=0,r=0,i=0,a=t.length;i<a;i++){var o=t[i],s=l(o);if(o.__data=new Float32Array(s.storage/Float32Array.BYTES_PER_ELEMENT),o.__offset=n,i>0){var c=16-(r=n%16);0!==r&&c-s.boundary<0&&(n+=16-r,o.__offset=n)}n+=s.storage}(r=n%16)>0&&(n+=16-r);e.__size=n,e.__cache={}}(n),d=function(t){var n=function(){for(var e=0;e<s;e++)if(-1===o.indexOf(e))return o.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;var r=e.createBuffer(),i=t.isRawUniformsGroup?t.data.byteLength:t.__size,a=t.dynamic?35048:35044;return e.bindBuffer(35345,r),e.bufferData(35345,i,a),e.bindBuffer(35345,null),e.bindBufferBase(35345,n,r),r}(n),i[n.id]=d,n.addEventListener("dispose",u)),r.updateUBOMapping(n,h);var p=t.render.frame;a[n.id]!==p&&(!function(t){var n=i[t.id],r=t.uniforms,a=t.__cache;if(t.isRawUniformsGroup)return void((t.autoUpdate||t.needsUpdate)&&(e.bindBuffer(35345,n),e.bufferSubData(35345,0,t.data),e.bindBuffer(35345,null)));e.bindBuffer(35345,n);for(var o=0,s=r.length;o<s;o++){var l=r[o];if(!0===c(l,o,a)){var u=l.value,h=l.__offset;"number"==typeof u?(l.__data[0]=u,e.bufferSubData(35345,h,l.__data)):(l.value.isMatrix3?(l.__data[0]=l.value.elements[0],l.__data[1]=l.value.elements[1],l.__data[2]=l.value.elements[2],l.__data[3]=l.value.elements[0],l.__data[4]=l.value.elements[3],l.__data[5]=l.value.elements[4],l.__data[6]=l.value.elements[5],l.__data[7]=l.value.elements[0],l.__data[8]=l.value.elements[6],l.__data[9]=l.value.elements[7],l.__data[10]=l.value.elements[8],l.__data[11]=l.value.elements[0]):u.toArray(l.__data),e.bufferSubData(35345,h,l.__data))}}e.bindBuffer(35345,null)}(n),a[n.id]=p)},dispose:function(){for(var t in i)e.deleteBuffer(i[t]);o=[],i={},a={}}}}function va(e,t,n){return{convert:function(e){var r;if(e===be)return 10497;if(e===xe)return 33071;if(e===we)return 33648;if(e===Ee)return 9728;if(e===Me)return 9984;if(e===Ae)return 9986;if(e===Te)return 9729;if(e===_e)return 9985;if(e===Se)return 9987;if(e===Le)return 5121;if(e===ke)return 32819;if(e===He)return 32820;if(e===Ne)return 33635;if(e===Ce)return 5120;if(e===Re)return 5122;if(e===Pe)return 5123;if(e===Oe)return 5124;if(e===De)return 5125;if(e===Ie)return 5126;if(e===Be){if(n.isWebGL2)return 5131;if(null!==(r=t.get("OES_texture_half_float")))return r.HALF_FLOAT_OES}if(e===Ue)return 6406;if(e===ze)return 6407;if(e===Ve)return 6408;if(e===je)return 6409;if(e===Ge)return 6410;if(e===qe)return 6402;if(e===Xe)return 34041;if(e===Ye)return 6403;if(e===O)return 32774;if(e===D)return 32778;if(e===I)return 32779;if(e===H)return 0;if(e===N)return 1;if(e===F)return 768;if(e===U)return 769;if(e===z)return 770;if(e===V)return 771;if(e===j)return 772;if(e===G)return 773;if(e===W)return 774;if(e===q)return 775;if(e===X)return 776;if((e===Ke||e===Je||e===Ze||e===Qe)&&null!==(r=t.get("WEBGL_compressed_texture_s3tc"))){if(e===Ke)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===Je)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Ze)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===Qe)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((e===$e||e===et||e===tt||e===nt)&&null!==(r=t.get("WEBGL_compressed_texture_pvrtc"))){if(e===$e)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===et)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===tt)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===nt)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===rt&&null!==(r=t.get("WEBGL_compressed_texture_etc1")))return r.COMPRESSED_RGB_ETC1_WEBGL;if((e===it||e===at||e===ot||e===st||e===ct||e===lt||e===ut||e===ht||e===dt||e===pt||e===ft||e===mt||e===gt||e===vt)&&null!==(r=t.get("WEBGL_compressed_texture_astc")))return e;if(e===B||e===k){if(n.isWebGL2){if(e===B)return 32775;if(e===k)return 32776}if(null!==(r=t.get("EXT_blend_minmax"))){if(e===B)return r.MIN_EXT;if(e===k)return r.MAX_EXT}}if(e===Fe){if(n.isWebGL2)return 34042;if(null!==(r=t.get("WEBGL_depth_texture")))return r.UNSIGNED_INT_24_8_WEBGL}return 0}}}function ya(){Gn.call(this),this.type="Group"}function ba(){Gn.call(this),this.type="Camera",this.matrixWorldInverse=new xn,this.projectionMatrix=new xn,this.projectionMatrixInverse=new xn}function xa(e,t,n,r){ba.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function wa(e){xa.call(this),this.cameras=e||[]}ha.prototype=Object.create(fr.prototype),ha.prototype.constructor=ha,ha.prototype.isMeshDepthMaterial=!0,ha.prototype.copy=function(e){return fr.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},da.prototype=Object.create(fr.prototype),da.prototype.constructor=da,da.prototype.isMeshDistanceMaterial=!0,da.prototype.copy=function(e){return fr.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},ya.prototype=Object.assign(Object.create(Gn.prototype),{constructor:ya,isGroup:!0}),ba.prototype=Object.assign(Object.create(Gn.prototype),{constructor:ba,isCamera:!0,copy:function(e,t){return Gn.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Wt),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){Gn.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),xa.prototype=Object.assign(Object.create(ba.prototype),{constructor:xa,isPerspectiveCamera:!0,copy:function(e,t){return ba.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*Vt.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Vt.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Vt.RAD2DEG*Math.atan(Math.tan(.5*Vt.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*Vt.DEG2RAD*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;i+=a.offsetX*r/o,t-=a.offsetY*n/s,r*=a.width/o,n*=a.height/s}var c=this.filmOffset;0!==c&&(i+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=Gn.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),wa.prototype=Object.assign(Object.create(xa.prototype),{constructor:wa,isArrayCamera:!0});var Ea,Ma,Aa,Ta,_a,Sa,La=new Wt,Ca=new Wt;function Ra(e,t,n){La.setFromMatrixPosition(t.matrixWorld),Ca.setFromMatrixPosition(n.matrixWorld);var r=La.distanceTo(Ca),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),c=(i[9]+1)/i[5],l=(i[9]-1)/i[5],u=(i[8]-1)/i[0],h=(a[8]+1)/a[0],d=o*u,p=o*h,f=r/(-u+h),m=f*-u;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.getInverse(e.matrixWorld);var g=o+f,v=s+f,y=d-m,b=p+(r-m),x=c*s/v*g,w=l*s/v*g;e.projectionMatrix.makePerspective(y,b,x,w,g,v)}function Pa(e){var t,n,r=this,i=null,a=null,o=null,s=[],c=new xn,l=new xn,u=1,h="local-floor";"undefined"!=typeof window&&"VRFrameData"in window&&(a=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",E,!1));var d=new xn,p=new Gt,f=new Wt,m=new xa;m.viewport=new hn,m.layers.enable(1);var g=new xa;g.viewport=new hn,g.layers.enable(2);var v=new wa([m,g]);v.layers.enable(1),v.layers.enable(2),this.multiview=!1;var y=null;function b(){return null!==i&&!0===i.isPresenting}var x,w=new jt;function E(){if(b()){var a=i.getEyeParameters("left");t=2*a.renderWidth*u,n=a.renderHeight*u,x=e.getPixelRatio(),e.getSize(w),e.setDrawingBufferSize(t,n,1),m.viewport.set(0,0,t/2,n),g.viewport.set(t/2,0,t/2,n),(y=function(){if(!i.getViews)return!1;var e=i.getViews();return!!e&&1===e.length&&!!e[0].getAttributes().multiview}())&&(e.setFramebuffer(i.getViews()[0].framebuffer),e.setRenderTarget(e.getRenderTarget())),e.animation.stop(),_.start(),r.dispatchEvent({type:"sessionstart"})}else r.enabled&&(e.setDrawingBufferSize(w.width,w.height,x),y&&(e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()))),_.stop(),e.animation.start(),r.dispatchEvent({type:"sessionend"})}var M=[];function A(e){for(var t=navigator.getGamepads&&navigator.getGamepads(),n=0,r=0,i=t.length;n<i;n++){var a=t[n];if(a&&("Daydream Controller"===a.id||"Gear VR Controller"===a.id||"Oculus Go Controller"===a.id||"OpenVR Gamepad"===a.id||a.id.startsWith("Oculus Touch")||a.id.startsWith("Spatial Controller"))){if(r===e)return a;r++}}}function T(e,r){null!==r&&4===r.length&&e.set(r[0]*t,r[1]*n,r[2]*t,r[3]*n)}this.enabled=!1,this.getController=function(e){var t=s[e];return void 0===t&&((t=new ya).matrixAutoUpdate=!1,t.visible=!1,s[e]=t),t},this.getDevice=function(){return i},this.setDevice=function(e){void 0!==e&&(i=e),_.setContext(e)},this.setFramebufferScaleFactor=function(e){u=e},this.setReferenceSpaceType=function(e){h=e},this.setPoseTarget=function(e){void 0!==e&&(o=e)},this.getCamera=function(e){var t="local-floor"===h?1.6:0;if(!1===b())return e.position.set(0,t,0),e.rotation.set(0,0,0),e;if(i.depthNear=e.near,i.depthFar=e.far,i.getFrameData(a),"local-floor"===h){var n=i.stageParameters;n?c.fromArray(n.sittingToStandingTransform):c.makeTranslation(0,t,0)}var r=a.pose,u=null!==o?o:e;u.matrix.copy(c),u.matrix.decompose(u.position,u.quaternion,u.scale),null!==r.orientation&&(p.fromArray(r.orientation),u.quaternion.multiply(p)),null!==r.position&&(p.setFromRotationMatrix(c),f.fromArray(r.position),f.applyQuaternion(p),u.position.add(f)),u.updateMatrixWorld(),m.near=e.near,g.near=e.near,m.far=e.far,g.far=e.far,m.matrixWorldInverse.fromArray(a.leftViewMatrix),g.matrixWorldInverse.fromArray(a.rightViewMatrix),l.getInverse(c),"local-floor"===h&&(m.matrixWorldInverse.multiply(l),g.matrixWorldInverse.multiply(l));var y=u.parent;null!==y&&(d.getInverse(y.matrixWorld),m.matrixWorldInverse.multiply(d),g.matrixWorldInverse.multiply(d)),m.matrixWorld.getInverse(m.matrixWorldInverse),g.matrixWorld.getInverse(g.matrixWorldInverse),m.projectionMatrix.fromArray(a.leftProjectionMatrix),g.projectionMatrix.fromArray(a.rightProjectionMatrix),Ra(v,m,g);var x=i.getLayers();if(x.length){var w=x[0];T(m.viewport,w.leftBounds),T(g.viewport,w.rightBounds)}return function(){for(var e=0;e<s.length;e++){var t=s[e],n=A(e);if(void 0!==n&&void 0!==n.pose){if(null===n.pose)return;var r=n.pose;!1===r.hasPosition&&t.position.set(.2,-.6,-.05),null!==r.position&&t.position.fromArray(r.position),null!==r.orientation&&t.quaternion.fromArray(r.orientation),t.matrix.compose(t.position,t.quaternion,t.scale),t.matrix.premultiply(c),t.matrix.decompose(t.position,t.quaternion,t.scale),t.matrixWorldNeedsUpdate=!0,t.visible=!0;var i="Daydream Controller"===n.id?0:1;void 0===M[e]&&(M[e]=!1),M[e]!==n.buttons[i].pressed&&(M[e]=n.buttons[i].pressed,!0===M[e]?t.dispatchEvent({type:"selectstart"}):(t.dispatchEvent({type:"selectend"}),t.dispatchEvent({type:"select"})))}else t.visible=!1}}(),v},this.getStandingMatrix=function(){return c},this.isPresenting=b;var _=new Dn;this.setAnimationLoop=function(e){_.setAnimationLoop(e),b()&&_.start()},this.submitFrame=function(){b()&&i.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",E)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}function Oa(e){var t=this,n=e.context,r=null,i=1,a=null,o="local-floor",s=null,c=null,l=[],u=[];function h(){return null!==r&&null!==a}var d=new xa;d.layers.enable(1),d.viewport=new hn;var p=new xa;p.layers.enable(2),p.viewport=new hn;var f=new wa([d,p]);function m(e){for(var t=0;t<l.length;t++)u[t]===e.inputSource&&l[t].dispatchEvent({type:e.type})}function g(){e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),x.stop(),e.animation.start(),t.dispatchEvent({type:"sessionend"})}function v(e){a=e,x.setContext(r),x.start(),t.dispatchEvent({type:"sessionstart"})}function y(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}f.layers.enable(1),f.layers.enable(2),this.multiview=!1,this.enabled=!1,this.getController=function(e){var t=l[e];return void 0===t&&((t=new ya).matrixAutoUpdate=!1,t.visible=!1,l[e]=t),t},this.setFramebufferScaleFactor=function(e){i=e},this.setReferenceSpaceType=function(e){o=e},this.getSession=function(){return r},this.setSession=function(e){null!==(r=e)&&(r.addEventListener("select",m),r.addEventListener("selectstart",m),r.addEventListener("selectend",m),r.addEventListener("end",g),r.updateRenderState({baseLayer:new XRWebGLLayer(r,n,{framebufferScaleFactor:i,multiview:this.multiview})}),r.requestReferenceSpace(o).then(v),u=r.inputSources,r.addEventListener("inputsourceschange",(function(){u=r.inputSources,console.log(u);for(var e=0;e<l.length;e++){l[e].userData.inputSource=u[e]}})))},this.setPoseTarget=function(e){void 0!==e&&(c=e)},this.getCamera=function(e){if(h()){var t=e.parent,n=f.cameras,r=c||e;y(f,t);for(var i=0;i<n.length;i++)y(n[i],t);r.matrixWorld.copy(f.matrixWorld);for(var a=r.children,o=(i=0,a.length);i<o;i++)a[i].updateMatrixWorld(!0);return Ra(f,d,p),f}return e},this.getCameraPose=function(){return s},this.isPresenting=h;var b=null;var x=new Dn;x.setAnimationLoop((function(t,n){if(null!==(s=n.getViewerPose(a))){var i=s.views,o=r.renderState.baseLayer;e.setFramebuffer(o.framebuffer);for(var c=0;c<i.length;c++){var h=i[c],d=o.getViewport(h),p=h.transform.inverse.matrix,m=f.cameras[c];m.matrix.fromArray(p).getInverse(m.matrix),m.projectionMatrix.fromArray(h.projectionMatrix),m.viewport.set(d.x,d.y,d.width,d.height),0===c&&f.matrix.copy(m.matrix)}}for(c=0;c<l.length;c++){var g=l[c],v=u[c];if(v){var y=n.getPose(v.targetRaySpace,a);if(null!==y){g.matrix.fromArray(y.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.visible=!0;continue}}g.visible=!1}b&&b(t,n)})),this.setAnimationLoop=function(e){b=e},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed."),new xn},this.getDevice=function(){console.warn("THREE.WebXRManager: getDevice() has been deprecated.")},this.setDevice=function(){console.warn("THREE.WebXRManager: setDevice() has been deprecated.")},this.setFrameOfReferenceType=function(){console.warn("THREE.WebXRManager: setFrameOfReferenceType() has been deprecated.")},this.submitFrame=function(){}}function Da(e){console.log("THREE.WebGLRenderer",s);var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,c=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,u=void 0!==e.powerPreference?e.powerPreference:"default",h=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,d=void 0!==e.forceWebVR&&e.forceWebVR,p=null,f=null;this.domElement=t,this.context=null,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=oe,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var m,g,v,y,x,w,E,M,A,T,_,S,L,C,R,P,O,D,I,B,k,H=this,N=!1,F=null,U=0,z=0,V=null,j=null,G=-1,W=null,q=null,X=new hn,Y=new hn,K=null,J=t.width,Z=t.height,Q=1,$=new hn(0,0,J,Z),ee=new hn(0,0,J,Z),te=!1,ne=new bn,re=new kr,ie=!1,ae=!1,se=new xn,ce=new Wt;function le(){return null===V?Q:1}try{var ue={alpha:r,depth:i,stencil:a,antialias:o,premultipliedAlpha:c,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:h,xrCompatible:!0};if(t.addEventListener("webglcontextlost",me,!1),t.addEventListener("webglcontextrestored",ge,!1),null===(m=n||t.getContext("webgl",ue)||t.getContext("experimental-webgl",ue)))throw null!==t.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===m.getShaderPrecisionFormat&&(m.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function he(){g=new Hr(m),(v=new Br(m,g,e)).isWebGL2||(g.get("WEBGL_depth_texture"),g.get("OES_texture_float"),g.get("OES_texture_half_float"),g.get("OES_texture_half_float_linear"),g.get("OES_standard_derivatives"),g.get("OES_element_index_uint"),g.get("OES_vertex_array_object"),g.get("ANGLE_instanced_arrays")),g.get("OES_texture_float_linear"),I=new va(m,g,v),(y=new fa(m,g,I)).scissor(Y.copy(ee).multiplyScalar(Q)),y.viewport(X.copy($).multiplyScalar(Q)),x=new Ur(m),w=new ta,E=new ma(m,g,y,w,v,I,x),M=new In(m),B=new Dr(m,g,M,v),A=new Nr(m,M,x,B),T=new Gr(A,x),P=new jr(m),_=new ea(H,g,v,E,B),S=new aa,L=new ua,C=new ga(m,x,v,y),R=new Or(H,y,T,c),O=new Ir(m,g,x,v),D=new Fr(m,g,x,v),x.programs=_.programs,k=[],H.context=m,H.capabilities=v,H.extensions=g,H.properties=w,H.renderLists=S,H.state=y,H.info=x}he();var de=!d&&"undefined"!=typeof navigator&&"xr"in navigator&&"supportsSession"in navigator.xr?new Oa(H):new Pa(H);this.vr=de;var pe=new pa(H,T,v.maxTextureSize);this.shadowMap=pe;var fe={inProgress:!1,modelViewMatrix:new xn,normalMatrix:new qt,projectionMatrix:new xn,camera:null};function me(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),N=!0}function ge(){console.log("THREE.WebGLRenderer: Context Restored."),N=!1,he()}function ve(e){var t=e.target;t.removeEventListener("dispose",ve),function(e){ye(e),w.remove(e)}(t)}function ye(e){var t=w.get(e).program;e.program=void 0,void 0!==t&&_.releaseProgram(t)}this.getContext=function(){return m},this.getContextAttributes=function(){return m.getContextAttributes()},this.forceContextLoss=function(){var e=g.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=g.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return Q},this.setPixelRatio=function(e){void 0!==e&&(Q=e,this.setSize(J,Z,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new jt),e.set(J,Z)},this.setSize=function(e,n,r){de.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(J=e,Z=n,t.width=e*Q,t.height=n*Q,!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new jt),e.set(J*Q,Z*Q)},this.setDrawingBufferSize=function(e,n,r){J=e,Z=n,Q=r,t.width=e*r,t.height=n*r,this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new hn),e.copy(X)},this.getViewport=function(e){return e.copy($)},this.setViewport=function(e,t,n,r){e.isVector4?$.set(e.x,e.y,e.z,e.w):$.set(e,t,n,r),y.viewport(X.copy($).multiplyScalar(Q))},this.getScissor=function(e){return e.copy(ee)},this.setScissor=function(e,t,n,r){e.isVector4?ee.set(e.x,e.y,e.z,e.w):ee.set(e,t,n,r),y.scissor(Y.copy(ee).multiplyScalar(Q))},this.getScissorTest=function(){return te},this.setScissorTest=function(e){y.setScissorTest(te=e)},this.getClearColor=function(){return R.getClearColor()},this.setClearColor=function(){R.setClearColor.apply(R,arguments)},this.getClearAlpha=function(){return R.getClearAlpha()},this.setClearAlpha=function(){R.setClearAlpha.apply(R,arguments)},this.clear=function(e,t,n){var r=0;(void 0===e||e)&&(r|=16384),(void 0===t||t)&&(r|=256),(void 0===n||n)&&(r|=1024),m.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",me,!1),t.removeEventListener("webglcontextrestored",ge,!1),S.dispose(),L.dispose(),w.dispose(),T.dispose(),B.dispose(),C.dispose(),de.dispose(),xe.stop()},this.renderBufferImmediate=function(e,t){B.initAttributes();var n=w.get(e);e.hasPositions&&!n.position&&(n.position=m.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=m.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=m.createBuffer()),e.hasColors&&!n.color&&(n.color=m.createBuffer());var r=t.getAttributes();e.hasPositions&&(m.bindBuffer(34962,n.position),m.bufferData(34962,e.positionArray,35048),B.enableAttribute(r.position),m.vertexAttribPointer(r.position,3,5126,!1,0,0)),e.hasNormals&&(m.bindBuffer(34962,n.normal),m.bufferData(34962,e.normalArray,35048),B.enableAttribute(r.normal),m.vertexAttribPointer(r.normal,3,5126,!1,0,0)),e.hasUvs&&(m.bindBuffer(34962,n.uv),m.bufferData(34962,e.uvArray,35048),B.enableAttribute(r.uv),m.vertexAttribPointer(r.uv,2,5126,!1,0,0)),e.hasColors&&(m.bindBuffer(34962,n.color),m.bufferData(34962,e.colorArray,35048),B.enableAttribute(r.color),m.vertexAttribPointer(r.color,3,5126,!1,0,0)),B.disableUnusedAttributes(),m.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,i,a){var o=i.isMesh&&i.matrixWorld.determinant()<0;y.setMaterial(r,o);var s,c=Ae(e,t,r,i),l=n.index,u=n.attributes.position,h=1;!0===r.wireframe&&(l=A.getWireframeAttribute(n),h=2),i.morphTargetInfluences&&P.update(i,n,r,c),B.setup(r,c,n,l);var d=O;null!==l&&(s=M.get(l),(d=D).setIndex(s));var p=1/0;null!==l?p=l.count:void 0!==u&&(p=u.count);var f=n.drawRange.start*h,m=n.drawRange.count*h,g=null!==a?a.start*h:0,v=null!==a?a.count*h:1/0,b=Math.max(f,g),x=Math.min(p,f+m,g+v)-1,w=Math.max(0,x-b+1);if(0!==w){if(i.isMesh)if(!0===r.wireframe)y.setLineWidth(r.wireframeLinewidth*le()),d.setMode(1);else switch(i.drawMode){case St:d.setMode(4);break;case Lt:d.setMode(5);break;case Ct:d.setMode(6)}else if(i.isLine){var E=r.linewidth;void 0===E&&(E=1),y.setLineWidth(E*le()),i.isLineSegments?d.setMode(1):i.isLineLoop?d.setMode(2):d.setMode(3)}else i.isPoints?d.setMode(0):i.isSprite&&d.setMode(4);n&&n.isInstancedBufferGeometry?n.maxInstancedCount>0&&d.renderInstances(n,b,w):d.render(b,w)}},this.compileAndUploadMaterials=function(e,t){(f=L.get(e,t)).init(),e.traverse((function(e){e.isLight&&f.pushLight(e),e.castShadow&&f.pushShadow(e)})),f.setupLights(t),e.traverse((function(n){if(n.material)if(Array.isArray(n.material))for(var r=0;r<n.material.length;r++)y.setMaterial(n.material[r]),Ae(t,e.fog,n.material[r],n);else y.setMaterial(n.material),Ae(t,e.fog,n.material,n)})),f=null},this.compile=function(e,t){(f=L.get(e,t)).init(),e.traverse((function(e){e.isLight&&(f.pushLight(e),e.castShadow&&f.pushShadow(e))})),f.setupLights(t),e.traverse((function(t){if(t.material)if(Array.isArray(t.material))for(var n=0;n<t.material.length;n++)Me(t.material[n],e.fog,t);else Me(t.material,e.fog,t)}))};var be=null;var xe=new Dn;function we(e,t,n,r){for(var i=0,a=e.length;i<a;i++){var o=e[i],s=o.object,c=o.geometry,l=void 0===r?o.material:r,u=o.group;if(n.isArrayCamera){q=n;var h=n.cameras;if(de.multiview&&!v.multiview&&(console.warn("WebGLRenderer: Use WebGL 2.0 and WEBGL/OVR_multiview extension support browser for VR multiview with opaque framebuffer approach."),de.multiview=!1),de.multiview){if(fe.camera=h[1],fe.inProgress=!0,"getSession"in de)y.viewport(X.copy(h[0].viewport));else{var d=de.getDevice().getViews()[0].getViewport();y.viewport(X.set(d.x,d.y,d.width,d.height))}f.setupLights(fe.camera),Ee(s,t,h[0],c,l,u),fe.inProgress=!1,fe.camera=null;continue}for(var p=0,m=h.length;p<m;p++){var g=h[p];s.layers.test(g.layers)&&(y.viewport(X.copy(g.viewport)),f.setupLights(g),Ee(s,t,g,c,l,u))}}else q=null,Ee(s,t,n,c,l,u)}}function Ee(e,t,n,r,i,a){if(e.onBeforeRender(H,t,n,r,i,a),f=L.get(t,q||n),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),fe.inProgress&&(fe.modelViewMatrix.multiplyMatrices(fe.camera.matrixWorldInverse,e.matrixWorld),fe.normalMatrix.getNormalMatrix(fe.modelViewMatrix)),e.isImmediateRenderObject){y.setMaterial(i);var o=Ae(n,t.fog,i,e);B.reset(),function(e,t){e.render((function(e){H.renderBufferImmediate(e,t)}))}(e,o)}else H.renderBufferDirect(n,t.fog,r,i,e,a);e.onAfterRender(H,t,n,r,i,a),f=L.get(t,q||n)}function Me(e,t,n){var r=w.get(e),i=f.state.lights,a=f.state.shadowsArray,o=i.state.version,s=_.getParameters(e,i.state,a,t,re.numPlanes,re.numIntersection,n),c=_.getProgramCode(e,s),l=r.program,u=!0;if(void 0===l)e.addEventListener("dispose",ve);else if(l.code!==c)ye(e);else if(r.lightsStateVersion!==o)r.lightsStateVersion=o,u=!1;else{if(void 0!==s.shaderID)return;u=!1}if(u){if(s.shaderID){var h=On[s.shaderID];r.shader={name:e.type,uniforms:En(h.uniforms),vertexShader:h.vertexShader,fragmentShader:h.fragmentShader}}else r.shader={name:e.type,uniforms:e.uniforms,uniformsGroups:e.uniformsGroups,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(r.shader,H),c=_.getProgramCode(e,s),l=_.acquireProgram(e,r.shader,s,c),r.program=l,e.program=l}var d=l.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var p=0;p<H.maxMorphTargets;p++)d["morphTarget"+p]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(p=0;p<H.maxMorphNormals;p++)d["morphNormal"+p]>=0&&e.numSupportedMorphNormals++}var m=r.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(r.numClippingPlanes=re.numPlanes,r.numIntersection=re.numIntersection,m.clippingPlanes=re.uniform),r.fog=t,r.lightsStateVersion=o,e.lights&&(m.ambientLightColor.value=i.state.ambient,m.lightProbe.value=i.state.probe,m.directionalLights.value=i.state.directional,m.spotLights.value=i.state.spot,m.rectAreaLights.value=i.state.rectArea,m.pointLights.value=i.state.point,m.hemisphereLights.value=i.state.hemi,m.directionalShadowMap.value=i.state.directionalShadowMap,m.directionalShadowMatrix.value=i.state.directionalShadowMatrix,m.spotShadowMap.value=i.state.spotShadowMap,m.spotShadowMatrix.value=i.state.spotShadowMatrix,m.pointShadowMap.value=i.state.pointShadowMap,m.pointShadowMatrix.value=i.state.pointShadowMatrix);var g=r.program.getUniforms(),v=zi.seqWithValue(g.seq,m);r.uniformsList=v}function Ae(e,t,n,r){E.resetTextureUnits();var i=w.get(n),a=f.state.lights;if(ie&&(ae||e!==W)){var o=e===W&&n.id===G;re.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,e,i,o)}!1===n.needsUpdate&&(void 0===i.program?n.needsUpdate=!0:n.fog&&i.fog!==t?n.needsUpdate=!0:n.lights&&i.lightsStateVersion!==a.state.version?n.needsUpdate=!0:void 0===i.numClippingPlanes||i.numClippingPlanes===re.numPlanes&&i.numIntersection===re.numIntersection||(n.needsUpdate=!0)),n.needsUpdate&&(Me(n,t,r),n.needsUpdate=!1);var s,c,l=!1,u=!1,h=!1,d=i.program,p=d.getUniforms(),g=i.shader.uniforms;if(y.useProgram(d.program)&&(l=!0,u=!0,h=!0),n.id!==G&&(G=n.id,u=!0),l||W!==e){var x;if(p.setValue(m,"projectionMatrix",e.projectionMatrix),fe.inProgress&&p.setValue(m,"projectionMatrix2",fe.camera.projectionMatrix),v.logarithmicDepthBuffer&&p.setValue(m,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),W!==e&&(W=e,u=!0,h=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap)if(void 0!==(x=p.map.cameraPosition)&&x.setValue(m,ce.setFromMatrixPosition(e.matrixWorld)),fe.inProgress)void 0!==(x=p.map.cameraPosition2)&&x.setValue(m,ce.setFromMatrixPosition(fe.camera.matrixWorld));(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&(p.setValue(m,"viewMatrix",e.matrixWorldInverse),fe.inProgress&&p.setValue(m,"viewMatrix2",fe.camera.matrixWorldInverse))}if(n.skinning){p.setOptional(m,r,"bindMatrix"),p.setOptional(m,r,"bindMatrixInverse");var M=r.skeleton;if(M){var A=M.bones;if(v.floatVertexTextures){if(void 0===M.boneTexture){var T=Math.sqrt(4*A.length);T=Vt.ceilPowerOfTwo(T),T=Math.max(T,4);var _=new Float32Array(T*T*4);_.set(M.boneMatrices);var S=new mn(_,T,T,Ve,Ie);S.needsUpdate=!0,M.boneMatrices=_,M.boneTexture=S,M.boneTextureSize=T}p.setValue(m,"boneTexture",M.boneTexture,E),p.setValue(m,"boneTextureSize",M.boneTextureSize)}else p.setOptional(m,M,"boneMatrices")}}if(u&&(p.setValue(m,"toneMappingExposure",H.toneMappingExposure),p.setValue(m,"toneMappingWhitePoint",H.toneMappingWhitePoint),n.lights&&(c=h,(s=g).ambientLightColor.needsUpdate=c,s.lightProbe.needsUpdate=c,s.directionalLights.needsUpdate=c,s.pointLights.needsUpdate=c,s.spotLights.needsUpdate=c,s.rectAreaLights.needsUpdate=c,s.hemisphereLights.needsUpdate=c),t&&n.fog&&function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(g,t),n.isMeshBasicMaterial?Te(g,n):n.isMeshLambertMaterial?(Te(g,n),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(g,n)):n.isMeshPhongMaterial?(Te(g,n),n.isMeshToonMaterial?function(e,t){_e(e,t),t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(g,n):_e(g,n)):n.isMeshStandardMaterial?(Te(g,n),n.isMeshPhysicalMaterial?function(e,t){Se(e,t),e.reflectivity.value=t.reflectivity,e.clearCoat.value=t.clearCoat,e.clearCoatRoughness.value=t.clearCoatRoughness}(g,n):Se(g,n)):n.isMeshMatcapMaterial?(Te(g,n),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===b&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===b&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(g,n)):n.isMeshDepthMaterial?(Te(g,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(g,n)):n.isMeshDistanceMaterial?(Te(g,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(g,n)):n.isMeshNormalMaterial?(Te(g,n),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===b&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===b&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(g,n)):n.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(g,n),n.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(g,n)):n.isPointsMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*Q,e.scale.value=.5*Z,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(g,n):n.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(g,n):n.isShadowMaterial&&(g.color.value.copy(n.color),g.opacity.value=n.opacity),void 0!==g.ltc_1&&(g.ltc_1.value=Pn.LTC_1),void 0!==g.ltc_2&&(g.ltc_2.value=Pn.LTC_2),zi.upload(m,i.uniformsList,g,E)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(zi.upload(m,i.uniformsList,g,E),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&p.setValue(m,"center",r.center),p.setValue(m,"modelViewMatrix",r.modelViewMatrix),p.setValue(m,"normalMatrix",r.normalMatrix),p.setValue(m,"modelMatrix",r.matrixWorld),fe.inProgress&&(p.setValue(m,"modelViewMatrix2",fe.modelViewMatrix),p.setValue(m,"normalMatrix2",fe.normalMatrix)),n.isShaderMaterial||n.isRawShaderMaterial)for(var L=i.shader.uniformsGroups,R=i.program.program,P=0,O=L.length;P<O;P++)if(v.isWebGL2){var D=L[P];C.update(D,R),C.bind(D,R)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.");return d}function Te(e,t){var n;e.opacity.value=t.opacity,t.color&&e.diffuse.value.copy(t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=w.get(t.envMap).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?n=t.map:t.specularMap?n=t.specularMap:t.displacementMap?n=t.displacementMap:t.normalMap?n=t.normalMap:t.bumpMap?n=t.bumpMap:t.roughnessMap?n=t.roughnessMap:t.metalnessMap?n=t.metalnessMap:t.alphaMap?n=t.alphaMap:t.emissiveMap&&(n=t.emissiveMap),void 0!==n&&(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}function _e(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===b&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===b&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function Se(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===b&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===b&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}xe.setAnimationLoop((function(e){be&&be(e)})),this.animation=xe,"undefined"!=typeof window&&xe.setContext(window),this.setAnimationLoop=function(e){be=e,de.setAnimationLoop(e),xe.start()},this.render=function(t,n,r,i){if(n&&n.isCamera){if(!N){B.resetDefaultState(),G=-1,W=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===n.parent&&n.updateMatrixWorld(),de.enabled&&(n=de.getCamera(n)),(f=L.get(t,n)).init(),t.onBeforeRender(H,t,n,r||V),se.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),ne.setFromMatrix(se),ae=this.localClippingEnabled,ie=re.init(this.clippingPlanes,ae,n),(p=S.get(t,n)).init(),k.length=0,function t(n,r,i,a){if(!1===n.visible)return;if(n.layers.test(r.layers))if(n.isGroup)i=n.renderOrder;else if(n.isLight)f.pushLight(n),n.castShadow&&f.pushShadow(n);else if(n.isSprite){if(!n.frustumCulled||ne.intersectsSprite(n)){a&&ce.setFromMatrixPosition(n.matrixWorld).applyMatrix4(se);var o=T.update(n);(s=n.material).visible&&p.push(n,o,s,i,ce.z,null)}}else if(n.isImmediateRenderObject)a&&ce.setFromMatrixPosition(n.matrixWorld).applyMatrix4(se),p.push(n,null,n.material,i,ce.z,null);else if((n.isMesh||n.isLine||n.isPoints)&&(n.isSkinnedMesh&&n.skeleton.update(),!n.frustumCulled||ne.intersectsObject(n))){a&&ce.setFromMatrixPosition(n.matrixWorld).applyMatrix4(se);o=T.update(n);var s=n.material;if(Array.isArray(s))for(var c=o.groups,l=0,u=c.length;l<u;l++){var h=c[l],d=s[h.materialIndex];d&&d.visible&&p.push(n,o,d,i,ce.z,h)}else s.visible&&(e.preuploadVideos&&s.map&&s.map.isVideoTexture&&k.push(s.map),p.push(n,o,s,i,ce.z,null))}var m=n.children;for(l=0,u=m.length;l<u;l++)t(m[l],r,i,a)}(t,n,0,H.sortObjects),!0===H.sortObjects&&p.sort(),ie&&re.beginShadows();var a=f.state.shadowsArray;if(pe.render(a,t,n),f.setupLights(n),ie&&re.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==r&&this.setRenderTarget(r),e.preuploadVideos)for(var o=0,s=k.length;o<s;o++)E.setTexture2D(k[o],0);R.render(p,t,n,i);var c=p.opaque,l=p.transparent;if(t.overrideMaterial){var u=t.overrideMaterial;c.length&&we(c,t,n,u),l.length&&we(l,t,n,u)}else c.length&&we(c,t,n),l.length&&we(l,t,n);t.onAfterRender(H,t,n),null!==V&&(E.updateRenderTargetMipmap(V),E.updateMultisampleRenderTarget(V)),y.buffers.depth.setTest(!0),y.buffers.depth.setMask(!0),y.buffers.color.setMask(!0),y.setPolygonOffset(!1),de.enabled&&de.submitFrame(),p=null,f=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(e){F!==e&&m.bindFramebuffer(36160,e),F=e},this.getActiveCubeFace=function(){return U},this.getActiveMipMapLevel=function(){return z},this.getRenderTarget=function(){return V},this.setRenderTarget=function(e,t,n){V=e,U=t,z=n,e&&void 0===w.get(e).__webglFramebuffer&&E.setupRenderTarget(e);var r=F,i=!1;if(e){var a=w.get(e).__webglFramebuffer;e.isWebGLRenderTargetCube?(r=a[t||0],i=!0):r=e.isWebGLMultisampleRenderTarget?w.get(e).__webglMultisampledFramebuffer:a,X.copy(e.viewport),Y.copy(e.scissor),K=e.scissorTest}else X.copy($).multiplyScalar(Q),Y.copy(ee).multiplyScalar(Q),K=te;if(j!==r&&(m.bindFramebuffer(36160,r),j=r),y.viewport(X),y.scissor(Y),y.setScissorTest(K),i){var o=w.get(e.texture);m.framebufferTexture2D(36160,36064,34069+(t||0),o.__webglTexture,n||0)}},this.readRenderTargetPixels=function(e,t,n,r,i,a,o){if(e&&e.isWebGLRenderTarget){var s=w.get(e).__webglFramebuffer;if(e.isWebGLRenderTargetCube&&void 0!==o&&(s=s[o]),s){var c=!1;s!==j&&(m.bindFramebuffer(36160,s),c=!0);try{var l=e.texture,u=l.format,h=l.type;if(u!==Ve&&I.convert(u)!==m.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(h===Le||I.convert(h)===m.getParameter(35738)||h===Ie&&(v.isWebGL2||g.get("OES_texture_float")||g.get("WEBGL_color_buffer_float"))||h===Be&&(v.isWebGL2?g.get("EXT_color_buffer_float"):g.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===m.checkFramebufferStatus(36160)?t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&m.readPixels(t,n,r,i,I.convert(u),I.convert(h),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{c&&m.bindFramebuffer(36160,j)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,n){var r=t.image.width,i=t.image.height,a=I.convert(t.format);E.setTexture2D(t,0),m.copyTexImage2D(3553,n||0,a,e.x,e.y,r,i,0)},this.copyTextureToTexture=function(e,t,n,r){var i=t.image.width,a=t.image.height,o=I.convert(n.format),s=I.convert(n.type);E.setTexture2D(n,0),t.isDataTexture?m.texSubImage2D(3553,r||0,e.x,e.y,i,a,o,s,t.image.data):m.texSubImage2D(3553,r||0,e.x,e.y,o,s,t.image)}}function Ia(e,t){this.name="",this.color=new Cn(e),this.density=void 0!==t?t:25e-5}function Ba(e,t,n){this.name="",this.color=new Cn(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3}function ka(){Gn.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function Ha(e,t){this._array=e,this._stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0,this.versionVAO=0}function Na(e,t,n,r){this._data=e,this._itemSize=t,this._offset=n,this._normalized=!0===r,this.versionVAO=0}function Fa(e){fr.call(this),this.type="SpriteMaterial",this.color=new Cn(16777215),this.map=null,this.rotation=0,this.sizeAttenuation=!0,this.lights=!1,this.transparent=!0,this.setValues(e)}function Ua(e){if(Gn.call(this),this.type="Sprite",void 0===Ea){Ea=new cr;var t=new Ha(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Ea.setIndex([0,1,2,0,2,3]),Ea.addAttribute("position",new Na(t,3,0,!1)),Ea.addAttribute("uv",new Na(t,2,3,!1))}this.geometry=Ea,this.material=void 0!==e?e:new Fa,this.center=new jt(.5,.5)}function za(){Gn.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Va(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Pr.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new xn,this.bindMatrixInverse=new xn}function ja(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new xn)}}function Ga(){Gn.call(this),this.type="Bone"}function Wa(e){fr.call(this),this.type="LineBasicMaterial",this.color=new Cn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function qa(e,t,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Gn.call(this),this.type="Line",this.geometry=void 0!==e?e:new cr,this.material=void 0!==t?t:new Wa({color:16777215*Math.random()})}function Xa(e,t){qa.call(this,e,t),this.type="LineSegments"}function Ya(e,t){qa.call(this,e,t),this.type="LineLoop"}function Ka(e){fr.call(this),this.type="PointsMaterial",this.color=new Cn(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function Ja(e,t){Gn.call(this),this.type="Points",this.geometry=void 0!==e?e:new cr,this.material=void 0!==t?t:new Ka({color:16777215*Math.random()})}function Za(e,t,n,r,i,a,o,s,c){un.call(this,e,t,n,r,i,a,o,s,c),this.format=void 0!==o?o:ze,this.minFilter=void 0!==a?a:Te,this.magFilter=void 0!==i?i:Te,this.generateMipmaps=!1}function Qa(e,t,n,r,i,a,o,s,c,l,u,h){un.call(this,null,a,o,s,c,l,r,i,u,h),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function $a(e,t,n,r,i,a,o,s,c){un.call(this,e,t,n,r,i,a,o,s,c),this.needsUpdate=!0}function eo(e,t,n,r,i,a,o,s,c,l){if((l=void 0!==l?l:qe)!==qe&&l!==Xe)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&l===qe&&(n=Pe),void 0===n&&l===Xe&&(n=Fe),un.call(this,null,r,i,a,o,s,l,n,c),this.image={width:e,height:t},this.magFilter=void 0!==o?o:Ee,this.minFilter=void 0!==s?s:Ee,this.flipY=!1,this.generateMipmaps=!1}function to(e){cr.call(this),this.type="WireframeGeometry";var t,n,r,i,a,o,s,c,l,u,h=[],d=[0,0],p={},f=["a","b","c"];if(e&&e.isGeometry){var m=e.faces;for(t=0,r=m.length;t<r;t++){var g=m[t];for(n=0;n<3;n++)s=g[f[n]],c=g[f[(n+1)%3]],d[0]=Math.min(s,c),d[1]=Math.max(s,c),void 0===p[l=d[0]+","+d[1]]&&(p[l]={index1:d[0],index2:d[1]})}for(l in p)o=p[l],u=e.vertices[o.index1],h.push(u.x,u.y,u.z),u=e.vertices[o.index2],h.push(u.x,u.y,u.z)}else if(e&&e.isBufferGeometry){var v,y,b,x,w,E,M;if(u=new Wt,null!==e.index){for(v=e.attributes.position,y=e.index,0===(b=e.groups).length&&(b=[{start:0,count:y.count,materialIndex:0}]),i=0,a=b.length;i<a;++i)for(t=w=(x=b[i]).start,r=w+x.count;t<r;t+=3)for(n=0;n<3;n++)s=y.getX(t+n),c=y.getX(t+(n+1)%3),d[0]=Math.min(s,c),d[1]=Math.max(s,c),void 0===p[l=d[0]+","+d[1]]&&(p[l]={index1:d[0],index2:d[1]});for(l in p)o=p[l],u.fromBufferAttribute(v,o.index1),h.push(u.x,u.y,u.z),u.fromBufferAttribute(v,o.index2),h.push(u.x,u.y,u.z)}else for(t=0,r=(v=e.attributes.position).count/3;t<r;t++)for(n=0;n<3;n++)E=3*t+n,u.fromBufferAttribute(v,E),h.push(u.x,u.y,u.z),M=3*t+(n+1)%3,u.fromBufferAttribute(v,M),h.push(u.x,u.y,u.z)}this.addAttribute("position",new rr(h,3))}function no(e,t,n){Yn.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new ro(e,t,n)),this.mergeVertices()}function ro(e,t,n){cr.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};var r,i,a=[],o=[],s=[],c=[],l=new Wt,u=new Wt,h=new Wt,d=new Wt,p=new Wt;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var f=t+1;for(r=0;r<=n;r++){var m=r/n;for(i=0;i<=t;i++){var g=i/t;e(g,m,u),o.push(u.x,u.y,u.z),g-1e-5>=0?(e(g-1e-5,m,h),d.subVectors(u,h)):(e(g+1e-5,m,h),d.subVectors(h,u)),m-1e-5>=0?(e(g,m-1e-5,h),p.subVectors(u,h)):(e(g,m+1e-5,h),p.subVectors(h,u)),l.crossVectors(d,p).normalize(),s.push(l.x,l.y,l.z),c.push(g,m)}}for(r=0;r<n;r++)for(i=0;i<t;i++){var v=r*f+i,y=r*f+i+1,b=(r+1)*f+i+1,x=(r+1)*f+i;a.push(v,y,x),a.push(y,b,x)}this.setIndex(a),this.addAttribute("position",new rr(o,3)),this.addAttribute("normal",new rr(s,3)),this.addAttribute("uv",new rr(c,2))}function io(e,t,n,r){Yn.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},this.fromBufferGeometry(new ao(e,t,n,r)),this.mergeVertices()}function ao(e,t,n,r){cr.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},n=n||1;var i=[],a=[];function o(e,t,n,r){var i,a,o=Math.pow(2,r),c=[];for(i=0;i<=o;i++){c[i]=[];var l=e.clone().lerp(n,i/o),u=t.clone().lerp(n,i/o),h=o-i;for(a=0;a<=h;a++)c[i][a]=0===a&&i===o?l:l.clone().lerp(u,a/h)}for(i=0;i<o;i++)for(a=0;a<2*(o-i)-1;a++){var d=Math.floor(a/2);a%2==0?(s(c[i][d+1]),s(c[i+1][d]),s(c[i][d])):(s(c[i][d+1]),s(c[i+1][d+1]),s(c[i+1][d]))}}function s(e){i.push(e.x,e.y,e.z)}function c(t,n){var r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function l(e,t,n,r){r<0&&1===e.x&&(a[t]=e.x-1),0===n.x&&0===n.z&&(a[t]=r/2/Math.PI+.5)}function u(e){return Math.atan2(e.z,-e.x)}function h(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}!function(e){for(var n=new Wt,r=new Wt,i=new Wt,a=0;a<t.length;a+=3)c(t[a+0],n),c(t[a+1],r),c(t[a+2],i),o(n,r,i,e)}(r=r||0),function(e){for(var t=new Wt,n=0;n<i.length;n+=3)t.x=i[n+0],t.y=i[n+1],t.z=i[n+2],t.normalize().multiplyScalar(e),i[n+0]=t.x,i[n+1]=t.y,i[n+2]=t.z}(n),function(){for(var e=new Wt,t=0;t<i.length;t+=3){e.x=i[t+0],e.y=i[t+1],e.z=i[t+2];var n=u(e)/2/Math.PI+.5,r=h(e)/Math.PI+.5;a.push(n,1-r)}(function(){for(var e=new Wt,t=new Wt,n=new Wt,r=new Wt,o=new jt,s=new jt,c=new jt,h=0,d=0;h<i.length;h+=9,d+=6){e.set(i[h+0],i[h+1],i[h+2]),t.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),o.set(a[d+0],a[d+1]),s.set(a[d+2],a[d+3]),c.set(a[d+4],a[d+5]),r.copy(e).add(t).add(n).divideScalar(3);var p=u(r);l(o,d+0,e,p),l(s,d+2,t,p),l(c,d+4,n,p)}})(),function(){for(var e=0;e<a.length;e+=6){var t=a[e+0],n=a[e+2],r=a[e+4],i=Math.max(t,n,r),o=Math.min(t,n,r);i>.9&&o<.1&&(t<.2&&(a[e+0]+=1),n<.2&&(a[e+2]+=1),r<.2&&(a[e+4]+=1))}}()}(),this.addAttribute("position",new rr(i,3)),this.addAttribute("normal",new rr(i.slice(),3)),this.addAttribute("uv",new rr(a,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function oo(e,t){Yn.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new so(e,t)),this.mergeVertices()}function so(e,t){ao.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function co(e,t){Yn.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new lo(e,t)),this.mergeVertices()}function lo(e,t){ao.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function uo(e,t){Yn.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new ho(e,t)),this.mergeVertices()}function ho(e,t){var n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];ao.call(this,r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function po(e,t){Yn.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new fo(e,t)),this.mergeVertices()}function fo(e,t){var n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r];ao.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function mo(e,t,n,r,i,a){Yn.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");var o=new go(e,t,n,r,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function go(e,t,n,r,i){cr.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i},t=t||64,n=n||1,r=r||8,i=i||!1;var a=e.computeFrenetFrames(t,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;var o,s,c=new Wt,l=new Wt,u=new jt,h=new Wt,d=[],p=[],f=[],m=[];function g(i){h=e.getPointAt(i/t,h);var o=a.normals[i],u=a.binormals[i];for(s=0;s<=r;s++){var f=s/r*Math.PI*2,m=Math.sin(f),g=-Math.cos(f);l.x=g*o.x+m*u.x,l.y=g*o.y+m*u.y,l.z=g*o.z+m*u.z,l.normalize(),p.push(l.x,l.y,l.z),c.x=h.x+n*l.x,c.y=h.y+n*l.y,c.z=h.z+n*l.z,d.push(c.x,c.y,c.z)}}!function(){for(o=0;o<t;o++)g(o);g(!1===i?t:0),function(){for(o=0;o<=t;o++)for(s=0;s<=r;s++)u.x=o/t,u.y=s/r,f.push(u.x,u.y)}(),function(){for(s=1;s<=t;s++)for(o=1;o<=r;o++){var e=(r+1)*(s-1)+(o-1),n=(r+1)*s+(o-1),i=(r+1)*s+o,a=(r+1)*(s-1)+o;m.push(e,n,a),m.push(n,i,a)}}()}(),this.setIndex(m),this.addAttribute("position",new rr(d,3)),this.addAttribute("normal",new rr(p,3)),this.addAttribute("uv",new rr(f,2))}function vo(e,t,n,r,i,a,o){Yn.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new yo(e,t,n,r,i,a)),this.mergeVertices()}function yo(e,t,n,r,i,a){cr.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:a},e=e||1,t=t||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,a=a||3;var o,s,c=[],l=[],u=[],h=[],d=new Wt,p=new Wt,f=new Wt,m=new Wt,g=new Wt,v=new Wt,y=new Wt;for(o=0;o<=n;++o){var b=o/n*i*Math.PI*2;for(S(b,i,a,e,f),S(b+.01,i,a,e,m),v.subVectors(m,f),y.addVectors(m,f),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),s=0;s<=r;++s){var x=s/r*Math.PI*2,w=-t*Math.cos(x),E=t*Math.sin(x);d.x=f.x+(w*y.x+E*g.x),d.y=f.y+(w*y.y+E*g.y),d.z=f.z+(w*y.z+E*g.z),l.push(d.x,d.y,d.z),p.subVectors(d,f).normalize(),u.push(p.x,p.y,p.z),h.push(o/n),h.push(s/r)}}for(s=1;s<=n;s++)for(o=1;o<=r;o++){var M=(r+1)*(s-1)+(o-1),A=(r+1)*s+(o-1),T=(r+1)*s+o,_=(r+1)*(s-1)+o;c.push(M,A,_),c.push(A,T,_)}function S(e,t,n,r,i){var a=Math.cos(e),o=Math.sin(e),s=n/t*e,c=Math.cos(s);i.x=r*(2+c)*.5*a,i.y=r*(2+c)*o*.5,i.z=r*Math.sin(s)*.5}this.setIndex(c),this.addAttribute("position",new rr(l,3)),this.addAttribute("normal",new rr(u,3)),this.addAttribute("uv",new rr(h,2))}function bo(e,t,n,r,i){Yn.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new xo(e,t,n,r,i)),this.mergeVertices()}function xo(e,t,n,r,i){cr.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},e=e||1,t=t||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var a,o,s=[],c=[],l=[],u=[],h=new Wt,d=new Wt,p=new Wt;for(a=0;a<=n;a++)for(o=0;o<=r;o++){var f=o/r*i,m=a/n*Math.PI*2;d.x=(e+t*Math.cos(m))*Math.cos(f),d.y=(e+t*Math.cos(m))*Math.sin(f),d.z=t*Math.sin(m),c.push(d.x,d.y,d.z),h.x=e*Math.cos(f),h.y=e*Math.sin(f),p.subVectors(d,h).normalize(),l.push(p.x,p.y,p.z),u.push(o/r),u.push(a/n)}for(a=1;a<=n;a++)for(o=1;o<=r;o++){var g=(r+1)*a+o-1,v=(r+1)*(a-1)+o-1,y=(r+1)*(a-1)+o,b=(r+1)*a+o;s.push(g,v,b),s.push(v,y,b)}this.setIndex(s),this.addAttribute("position",new rr(c,3)),this.addAttribute("normal",new rr(l,3)),this.addAttribute("uv",new rr(u,2))}Object.assign(Pa.prototype,r.prototype),Object.assign(Oa.prototype,r.prototype),Object.assign(Ia.prototype,{isFogExp2:!0,clone:function(){return new Ia(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(Ba.prototype,{isFog:!0,clone:function(){return new Ba(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),ka.prototype=Object.assign(Object.create(Gn.prototype),{constructor:ka,isScene:!0,copy:function(e,t){return Gn.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=Gn.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperties(Ha.prototype,{needsUpdate:{set:function(e){!0===e&&this.version++}},array:{get:function(){return this._array},set:function(e){this._array=e,this.versionVAO++}},stride:{get:function(){return this._stride},set:function(e){this._stride=e,this.versionVAO++}}}),Object.assign(Ha.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.stride:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),Object.defineProperties(Na.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},data:{get:function(){return this._data},set:function(e){this._data=e,this.versionVAO++}},itemSize:{get:function(){return this._itemSize},set:function(e){this._itemSize=e,this.versionVAO++}},offset:{get:function(){return this._offset},set:function(e){this._offset=e,this.versionVAO++}},normalized:{get:function(){return this._normalized},set:function(e){this._normalized=e,this.versionVAO++}}}),Object.assign(Na.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}}),Fa.prototype=Object.create(fr.prototype),Fa.prototype.constructor=Fa,Fa.prototype.isSpriteMaterial=!0,Fa.prototype.copy=function(e){return fr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this},Ua.prototype=Object.assign(Object.create(Gn.prototype),{constructor:Ua,isSprite:!0,raycast:function(){var e=new Wt,t=new Wt,n=new Wt,r=new jt,i=new jt,a=new xn,o=new Wt,s=new Wt,c=new Wt,l=new jt,u=new jt,h=new jt;function d(e,t,n,o,s,c){r.subVectors(e,n).addScalar(.5).multiply(o),void 0!==s?(i.x=c*r.x-s*r.y,i.y=s*r.x+c*r.y):i.copy(r),e.copy(t),e.x+=i.x,e.y+=i.y,e.applyMatrix4(a)}return function(r,i){t.setFromMatrixScale(this.matrixWorld),a.copy(r._camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(r._camera.matrixWorldInverse,this.matrixWorld),n.setFromMatrixPosition(this.modelViewMatrix),r._camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&t.multiplyScalar(-n.z);var p,f,m=this.material.rotation;0!==m&&(f=Math.cos(m),p=Math.sin(m));var g=this.center;d(o.set(-.5,-.5,0),n,g,t,p,f),d(s.set(.5,-.5,0),n,g,t,p,f),d(c.set(.5,.5,0),n,g,t,p,f),l.set(0,0),u.set(1,0),h.set(1,1);var v=r.ray.intersectTriangle(o,s,c,!1,e);if(null!==v||(d(s.set(-.5,.5,0),n,g,t,p,f),u.set(0,1),null!==(v=r.ray.intersectTriangle(o,c,s,!1,e)))){var y=r.ray.origin.distanceTo(e);y<r.near||y>r.far||i.push({distance:y,point:e.clone(),uv:Cr.getUV(e,o,s,c,l,u,h,new jt),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return Gn.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}}),za.prototype=Object.assign(Object.create(Gn.prototype),{constructor:za,isLOD:!0,copy:function(e){Gn.prototype.copy.call(this,e,!1);for(var t=e.levels,n=0,r=t.length;n<r;n++){var i=t[n];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var n=this.levels,r=0;r<n.length&&!(t<n[r].distance);r++);return n.splice(r,0,{distance:t,object:e}),this.add(e),this},getObjectForDistance:function(e){for(var t=this.levels,n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object},raycast:(Ma=new Wt,function(e,t){Ma.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(Ma);this.getObjectForDistance(n).raycast(e,t)}),update:function(){var e=new Wt,t=new Wt;return function(n){var r=this.levels;if(r.length>1){e.setFromMatrixPosition(n.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var i=e.distanceTo(t);r[0].object.visible=!0;for(var a=1,o=r.length;a<o&&i>=r[a].distance;a++)r[a-1].object.visible=!1,r[a].object.visible=!0;for(;a<o;a++)r[a].object.visible=!1}}}(),toJSON:function(e){var t=Gn.prototype.toJSON.call(this,e);t.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var a=n[r];t.object.levels.push({object:a.object.uuid,distance:a.distance})}return t}}),Va.prototype=Object.assign(Object.create(Pr.prototype),{constructor:Va,isSkinnedMesh:!0,bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new hn,t=this.geometry.attributes.skinWeight,n=0,r=t.count;n<r;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Pr.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Object.assign(ja.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var n=new xn;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},pose:function(){var e,t,n;for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:(Aa=new xn,Ta=new xn,function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,a=e.length;i<a;i++){var o=e[i]?e[i].matrixWorld:Ta;Aa.multiplyMatrices(o,t[i]),Aa.toArray(n,16*i)}void 0!==r&&(r.needsUpdate=!0)}),clone:function(){return new ja(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}}}),Ga.prototype=Object.assign(Object.create(Gn.prototype),{constructor:Ga,isBone:!0}),Wa.prototype=Object.create(fr.prototype),Wa.prototype.constructor=Wa,Wa.prototype.isLineBasicMaterial=!0,Wa.prototype.copy=function(e){return fr.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},qa.prototype=Object.assign(Object.create(Gn.prototype),{constructor:qa,isLine:!0,computeLineDistances:(_a=new Wt,Sa=new Wt,function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,i=t.count;r<i;r++)_a.fromBufferAttribute(t,r-1),Sa.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=_a.distanceTo(Sa);e.addAttribute("lineDistance",new rr(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var a=e.vertices;for((n=e.lineDistances)[0]=0,r=1,i=a.length;r<i;r++)n[r]=n[r-1],n[r]+=a[r-1].distanceTo(a[r])}return this}),raycast:function(){var e=new xn,t=new Lr,n=new vn;return function(r,i){var a=r.linePrecision,o=this.geometry,s=this.matrixWorld;if(null===o.boundingSphere&&o.computeBoundingSphere(),n.copy(o.boundingSphere),n.applyMatrix4(s),n.radius+=a,!1!==r.ray.intersectsSphere(n)){e.getInverse(s),t.copy(r.ray).applyMatrix4(e);var c=a/((this.scale.x+this.scale.y+this.scale.z)/3),l=c*c,u=new Wt,h=new Wt,d=new Wt,p=new Wt,f=this&&this.isLineSegments?2:1;if(o.isBufferGeometry){var m=o.index,g=o.attributes.position.array;if(null!==m)for(var v=m.array,y=0,b=v.length-1;y<b;y+=f){var x=v[y],w=v[y+1];if(u.fromArray(g,3*x),h.fromArray(g,3*w),!(t.distanceSqToSegment(u,h,p,d)>l))p.applyMatrix4(this.matrixWorld),(A=r.ray.origin.distanceTo(p))<r.near||A>r.far||i.push({distance:A,point:d.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}else for(y=0,b=g.length/3-1;y<b;y+=f){if(u.fromArray(g,3*y),h.fromArray(g,3*y+3),!(t.distanceSqToSegment(u,h,p,d)>l))p.applyMatrix4(this.matrixWorld),(A=r.ray.origin.distanceTo(p))<r.near||A>r.far||i.push({distance:A,point:d.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}else if(o.isGeometry){var E=o.vertices,M=E.length;for(y=0;y<M-1;y+=f){var A;if(!(t.distanceSqToSegment(E[y],E[y+1],p,d)>l))p.applyMatrix4(this.matrixWorld),(A=r.ray.origin.distanceTo(p))<r.near||A>r.far||i.push({distance:A,point:d.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Xa.prototype=Object.assign(Object.create(qa.prototype),{constructor:Xa,isLineSegments:!0,computeLineDistances:function(){var e=new Wt,t=new Wt;return function(){var n=this.geometry;if(n.isBufferGeometry)if(null===n.index){for(var r=n.attributes.position,i=[],a=0,o=r.count;a<o;a+=2)e.fromBufferAttribute(r,a),t.fromBufferAttribute(r,a+1),i[a]=0===a?0:i[a-1],i[a+1]=i[a]+e.distanceTo(t);n.addAttribute("lineDistance",new rr(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(n.isGeometry){var s=n.vertices;for(i=n.lineDistances,a=0,o=s.length;a<o;a+=2)e.copy(s[a]),t.copy(s[a+1]),i[a]=0===a?0:i[a-1],i[a+1]=i[a]+e.distanceTo(t)}return this}}()}),Ya.prototype=Object.assign(Object.create(qa.prototype),{constructor:Ya,isLineLoop:!0}),Ka.prototype=Object.create(fr.prototype),Ka.prototype.constructor=Ka,Ka.prototype.isPointsMaterial=!0,Ka.prototype.copy=function(e){return fr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this},Ja.prototype=Object.assign(Object.create(Gn.prototype),{constructor:Ja,isPoints:!0,raycast:function(){var e=new xn,t=new Lr,n=new vn;return function(r,i){var a=this,o=this.geometry,s=this.matrixWorld,c=r.params.Points.threshold;if(null===o.boundingSphere&&o.computeBoundingSphere(),n.copy(o.boundingSphere),n.applyMatrix4(s),n.radius+=c,!1!==r.ray.intersectsSphere(n)){e.getInverse(s),t.copy(r.ray).applyMatrix4(e);var l=c/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l,h=new Wt,d=new Wt;if(o.isBufferGeometry){var p=o.index,f=o.attributes.position.array;if(null!==p)for(var m=p.array,g=0,v=m.length;g<v;g++){var y=m[g];h.fromArray(f,3*y),w(h,y)}else{g=0;for(var b=f.length/3;g<b;g++)h.fromArray(f,3*g),w(h,g)}}else{var x=o.vertices;for(g=0,b=x.length;g<b;g++)w(x[g],g)}}function w(e,n){var o=t.distanceSqToPoint(e);if(o<u){t.closestPointToPoint(e,d),d.applyMatrix4(s);var c=r.ray.origin.distanceTo(d);if(c<r.near||c>r.far)return;i.push({distance:c,distanceToRay:Math.sqrt(o),point:d.clone(),index:n,face:null,object:a})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Za.prototype=Object.assign(Object.create(un.prototype),{constructor:Za,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Qa.prototype=Object.create(un.prototype),Qa.prototype.constructor=Qa,Qa.prototype.isCompressedTexture=!0,$a.prototype=Object.create(un.prototype),$a.prototype.constructor=$a,$a.prototype.isCanvasTexture=!0,eo.prototype=Object.create(un.prototype),eo.prototype.constructor=eo,eo.prototype.isDepthTexture=!0,to.prototype=Object.create(cr.prototype),to.prototype.constructor=to,no.prototype=Object.create(Yn.prototype),no.prototype.constructor=no,ro.prototype=Object.create(cr.prototype),ro.prototype.constructor=ro,io.prototype=Object.create(Yn.prototype),io.prototype.constructor=io,ao.prototype=Object.create(cr.prototype),ao.prototype.constructor=ao,oo.prototype=Object.create(Yn.prototype),oo.prototype.constructor=oo,so.prototype=Object.create(ao.prototype),so.prototype.constructor=so,co.prototype=Object.create(Yn.prototype),co.prototype.constructor=co,lo.prototype=Object.create(ao.prototype),lo.prototype.constructor=lo,uo.prototype=Object.create(Yn.prototype),uo.prototype.constructor=uo,ho.prototype=Object.create(ao.prototype),ho.prototype.constructor=ho,po.prototype=Object.create(Yn.prototype),po.prototype.constructor=po,fo.prototype=Object.create(ao.prototype),fo.prototype.constructor=fo,mo.prototype=Object.create(Yn.prototype),mo.prototype.constructor=mo,go.prototype=Object.create(cr.prototype),go.prototype.constructor=go,go.prototype.toJSON=function(){var e=cr.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},vo.prototype=Object.create(Yn.prototype),vo.prototype.constructor=vo,yo.prototype=Object.create(cr.prototype),yo.prototype.constructor=yo,bo.prototype=Object.create(Yn.prototype),bo.prototype.constructor=bo,xo.prototype=Object.create(cr.prototype),xo.prototype.constructor=xo;var wo=function(e,t,n){n=n||2;var r,i,a,o,s,c,l,u=t&&t.length,h=u?t[0]*n:e.length,d=Eo(e,0,h,n,!0),p=[];if(!d)return p;if(u&&(d=function(e,t,n,r){var i,a,o,s,c,l=[];for(i=0,a=t.length;i<a;i++)o=t[i]*r,s=i<a-1?t[i+1]*r:e.length,(c=Eo(e,o,s,r,!1))===c.next&&(c.steiner=!0),l.push(Oo(c));for(l.sort(Co),i=0;i<l.length;i++)Ro(l[i],n),n=Mo(n,n.next);return n}(e,t,d,n)),e.length>80*n){r=a=e[0],i=o=e[1];for(var f=n;f<h;f+=n)(s=e[f])<r&&(r=s),(c=e[f+1])<i&&(i=c),s>a&&(a=s),c>o&&(o=c);l=0!==(l=Math.max(a-r,o-i))?1/l:0}return Ao(d,p,n,r,i,l),p};function Eo(e,t,n,r,i){var a,o;if(i===function(e,t,n,r){for(var i=0,a=t,o=n-r;a<n;a+=r)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}(e,t,n,r)>0)for(a=t;a<n;a+=r)o=Uo(a,e[a],e[a+1],o);else for(a=n-r;a>=t;a-=r)o=Uo(a,e[a],e[a+1],o);return o&&ko(o,o.next)&&(zo(o),o=o.next),o}function Mo(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!ko(r,r.next)&&0!==Bo(r.prev,r,r.next))r=r.next;else{if(zo(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function Ao(e,t,n,r,i,a,o){if(e){!o&&a&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=Po(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,a,o,s,c,l=1;do{for(n=e,e=null,a=null,o=0;n;){for(o++,r=n,s=0,t=0;t<l&&(s++,r=r.nextZ);t++);for(c=l;s>0||c>0&&r;)0!==s&&(0===c||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,c--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;n=r}a.nextZ=null,l*=2}while(o>1)}(i)}(e,r,i,a);for(var s,c,l=e;e.prev!==e.next;)if(s=e.prev,c=e.next,a?_o(e,r,i,a):To(e))t.push(s.i/n),t.push(e.i/n),t.push(c.i/n),zo(e),e=c.next,l=c.next;else if((e=c)===l){o?1===o?Ao(e=So(e,t,n),t,n,r,i,a,2):2===o&&Lo(e,t,n,r,i,a):Ao(Mo(e),t,n,r,i,a,1);break}}}function To(e){var t=e.prev,n=e,r=e.next;if(Bo(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(Do(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Bo(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function _o(e,t,n,r){var i=e.prev,a=e,o=e.next;if(Bo(i,a,o)>=0)return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,c=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,l=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,u=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,h=Po(s,c,t,n,r),d=Po(l,u,t,n,r),p=e.nextZ;p&&p.z<=d;){if(p!==e.prev&&p!==e.next&&Do(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Bo(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=e.prevZ;p&&p.z>=h;){if(p!==e.prev&&p!==e.next&&Do(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Bo(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function So(e,t,n){var r=e;do{var i=r.prev,a=r.next.next;!ko(i,a)&&Ho(i,r,r.next,a)&&No(i,a)&&No(a,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(a.i/n),zo(r),zo(r.next),r=e=a),r=r.next}while(r!==e);return r}function Lo(e,t,n,r,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Io(o,s)){var c=Fo(o,s);return o=Mo(o,o.next),c=Mo(c,c.next),Ao(o,t,n,r,i,a),void Ao(c,t,n,r,i,a)}s=s.next}o=o.next}while(o!==e)}function Co(e,t){return e.x-t.x}function Ro(e,t){if(t=function(e,t){var n,r=t,i=e.x,a=e.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>o){if(o=s,s===i){if(a===r.y)return r;if(a===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===o)return n.prev;var c,l=n,u=n.x,h=n.y,d=1/0;r=n.next;for(;r!==l;)i>=r.x&&r.x>=u&&i!==r.x&&Do(a<h?i:o,a,u,h,a<h?o:i,a,r.x,r.y)&&((c=Math.abs(a-r.y)/(i-r.x))<d||c===d&&r.x>n.x)&&No(r,e)&&(n=r,d=c),r=r.next;return n}(e,t)){var n=Fo(t,e);Mo(n,n.next)}}function Po(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Oo(e){var t=e,n=e;do{t.x<n.x&&(n=t),t=t.next}while(t!==e);return n}function Do(e,t,n,r,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(r-s)-(n-o)*(t-s)>=0&&(n-o)*(a-s)-(i-o)*(r-s)>=0}function Io(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Ho(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&No(e,t)&&No(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)}function Bo(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function ko(e,t){return e.x===t.x&&e.y===t.y}function Ho(e,t,n,r){return!!(ko(e,t)&&ko(n,r)||ko(e,r)&&ko(n,t))||Bo(e,t,n)>0!=Bo(e,t,r)>0&&Bo(n,r,e)>0!=Bo(n,r,t)>0}function No(e,t){return Bo(e.prev,e,e.next)<0?Bo(e,t,e.next)>=0&&Bo(e,e.prev,t)>=0:Bo(e,t,e.prev)<0||Bo(e,e.next,t)<0}function Fo(e,t){var n=new Vo(e.i,e.x,e.y),r=new Vo(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function Uo(e,t,n,r){var i=new Vo(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function zo(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Vo(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var jo={area:function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n},isClockWise:function(e){return jo.area(e)<0},triangulateShape:function(e,t){var n=[],r=[],i=[];Go(e),Wo(n,e);var a=e.length;t.forEach(Go);for(var o=0;o<t.length;o++)r.push(a),a+=t[o].length,Wo(n,t[o]);var s=wo(n,r);for(o=0;o<s.length;o+=3)i.push(s.slice(o,o+3));return i}};function Go(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function Wo(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}function qo(e,t){Yn.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new Xo(e,t)),this.mergeVertices()}function Xo(e,t){cr.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];for(var n=this,r=[],i=[],a=0,o=e.length;a<o;a++){s(e[a])}function s(e){var a=[],o=void 0!==t.curveSegments?t.curveSegments:12,s=void 0!==t.steps?t.steps:1,c=void 0!==t.depth?t.depth:100,l=void 0===t.bevelEnabled||t.bevelEnabled,u=void 0!==t.bevelThickness?t.bevelThickness:6,h=void 0!==t.bevelSize?t.bevelSize:u-2,d=void 0!==t.bevelOffset?t.bevelOffset:0,p=void 0!==t.bevelSegments?t.bevelSegments:3,f=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:Yo;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),c=t.amount);var g,v,y,b,x,w,E,M,A=!1;f&&(g=f.getSpacedPoints(s),A=!0,l=!1,v=f.computeFrenetFrames(s,!1),y=new Wt,b=new Wt,x=new Wt),l||(p=0,u=0,h=0,d=0);var T=e.extractPoints(o),_=T.shape,S=T.holes;if(!jo.isClockWise(_))for(_=_.reverse(),E=0,M=S.length;E<M;E++)w=S[E],jo.isClockWise(w)&&(S[E]=w.reverse());var L=jo.triangulateShape(_,S),C=_;for(E=0,M=S.length;E<M;E++)w=S[E],_=_.concat(w);function R(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var P,O,D,I,B,k,H=_.length,N=L.length;function F(e,t,n){var r,i,a,o=e.x-t.x,s=e.y-t.y,c=n.x-e.x,l=n.y-e.y,u=o*o+s*s,h=o*l-s*c;if(Math.abs(h)>Number.EPSILON){var d=Math.sqrt(u),p=Math.sqrt(c*c+l*l),f=t.x-s/d,m=t.y+o/d,g=((n.x-l/p-f)*l-(n.y+c/p-m)*c)/(o*l-s*c),v=(r=f+o*g-e.x)*r+(i=m+s*g-e.y)*i;if(v<=2)return new jt(r,i);a=Math.sqrt(v/2)}else{var y=!1;o>Number.EPSILON?c>Number.EPSILON&&(y=!0):o<-Number.EPSILON?c<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(l)&&(y=!0),y?(r=-s,i=o,a=Math.sqrt(u)):(r=o,i=s,a=Math.sqrt(u/2))}return new jt(r/a,i/a)}for(var U=[],z=0,V=C.length,j=V-1,G=z+1;z<V;z++,j++,G++)j===V&&(j=0),G===V&&(G=0),U[z]=F(C[z],C[j],C[G]);var W,q,X=[],Y=U.concat();for(E=0,M=S.length;E<M;E++){for(w=S[E],W=[],z=0,j=(V=w.length)-1,G=z+1;z<V;z++,j++,G++)j===V&&(j=0),G===V&&(G=0),W[z]=F(w[z],w[j],w[G]);X.push(W),Y=Y.concat(W)}for(P=0;P<p;P++){for(D=P/p,I=u*Math.cos(D*Math.PI/2),O=h*Math.sin(D*Math.PI/2)+d,z=0,V=C.length;z<V;z++)J((B=R(C[z],U[z],O)).x,B.y,-I);for(E=0,M=S.length;E<M;E++)for(w=S[E],W=X[E],z=0,V=w.length;z<V;z++)J((B=R(w[z],W[z],O)).x,B.y,-I)}for(O=h+d,z=0;z<H;z++)B=l?R(_[z],Y[z],O):_[z],A?(b.copy(v.normals[0]).multiplyScalar(B.x),y.copy(v.binormals[0]).multiplyScalar(B.y),x.copy(g[0]).add(b).add(y),J(x.x,x.y,x.z)):J(B.x,B.y,0);for(q=1;q<=s;q++)for(z=0;z<H;z++)B=l?R(_[z],Y[z],O):_[z],A?(b.copy(v.normals[q]).multiplyScalar(B.x),y.copy(v.binormals[q]).multiplyScalar(B.y),x.copy(g[q]).add(b).add(y),J(x.x,x.y,x.z)):J(B.x,B.y,c/s*q);for(P=p-1;P>=0;P--){for(D=P/p,I=u*Math.cos(D*Math.PI/2),O=h*Math.sin(D*Math.PI/2)+d,z=0,V=C.length;z<V;z++)J((B=R(C[z],U[z],O)).x,B.y,c+I);for(E=0,M=S.length;E<M;E++)for(w=S[E],W=X[E],z=0,V=w.length;z<V;z++)B=R(w[z],W[z],O),A?J(B.x,B.y+g[s-1].y,g[s-1].x+I):J(B.x,B.y,c+I)}function K(e,t){var n,r;for(z=e.length;--z>=0;){n=z,(r=z-1)<0&&(r=e.length-1);var i=0,a=s+2*p;for(i=0;i<a;i++){var o=H*i,c=H*(i+1);Q(t+n+o,t+r+o,t+r+c,t+n+c)}}}function J(e,t,n){a.push(e),a.push(t),a.push(n)}function Z(e,t,i){$(e),$(t),$(i);var a=r.length/3,o=m.generateTopUV(n,r,a-3,a-2,a-1);ee(o[0]),ee(o[1]),ee(o[2])}function Q(e,t,i,a){$(e),$(t),$(a),$(t),$(i),$(a);var o=r.length/3,s=m.generateSideWallUV(n,r,o-6,o-3,o-2,o-1);ee(s[0]),ee(s[1]),ee(s[3]),ee(s[1]),ee(s[2]),ee(s[3])}function $(e){r.push(a[3*e+0]),r.push(a[3*e+1]),r.push(a[3*e+2])}function ee(e){i.push(e.x),i.push(e.y)}!function(){var e=r.length/3;if(l){var t=0,i=H*t;for(z=0;z<N;z++)Z((k=L[z])[2]+i,k[1]+i,k[0]+i);for(i=H*(t=s+2*p),z=0;z<N;z++)Z((k=L[z])[0]+i,k[1]+i,k[2]+i)}else{for(z=0;z<N;z++)Z((k=L[z])[2],k[1],k[0]);for(z=0;z<N;z++)Z((k=L[z])[0]+H*s,k[1]+H*s,k[2]+H*s)}n.addGroup(e,r.length/3-e,0)}(),function(){var e=r.length/3,t=0;for(K(C,t),t+=C.length,E=0,M=S.length;E<M;E++)K(w=S[E],t),t+=w.length;n.addGroup(e,r.length/3-e,1)}()}this.addAttribute("position",new rr(r,3)),this.addAttribute("uv",new rr(i,2)),this.computeVertexNormals()}qo.prototype=Object.create(Yn.prototype),qo.prototype.constructor=qo,qo.prototype.toJSON=function(){var e=Yn.prototype.toJSON.call(this);return Ko(this.parameters.shapes,this.parameters.options,e)},Xo.prototype=Object.create(cr.prototype),Xo.prototype.constructor=Xo,Xo.prototype.toJSON=function(){var e=cr.prototype.toJSON.call(this);return Ko(this.parameters.shapes,this.parameters.options,e)};var Yo={generateTopUV:function(e,t,n,r,i){var a=t[3*n],o=t[3*n+1],s=t[3*r],c=t[3*r+1],l=t[3*i],u=t[3*i+1];return[new jt(a,o),new jt(s,c),new jt(l,u)]},generateSideWallUV:function(e,t,n,r,i,a){var o=t[3*n],s=t[3*n+1],c=t[3*n+2],l=t[3*r],u=t[3*r+1],h=t[3*r+2],d=t[3*i],p=t[3*i+1],f=t[3*i+2],m=t[3*a],g=t[3*a+1],v=t[3*a+2];return Math.abs(s-u)<.01?[new jt(o,1-c),new jt(l,1-h),new jt(d,1-f),new jt(m,1-v)]:[new jt(s,1-c),new jt(u,1-h),new jt(p,1-f),new jt(g,1-v)]}};function Ko(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var a=e[r];n.shapes.push(a.uuid)}else n.shapes.push(e.uuid);return void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}function Jo(e,t){Yn.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Zo(e,t)),this.mergeVertices()}function Zo(e,t){var n=(t=t||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Yn;var r=n.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),Xo.call(this,r,t),this.type="TextBufferGeometry"}function Qo(e,t,n,r,i,a,o){Yn.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new $o(e,t,n,r,i,a,o)),this.mergeVertices()}function $o(e,t,n,r,i,a,o){cr.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},e=e||1,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI,a=void 0!==a?a:0,o=void 0!==o?o:Math.PI;var s,c,l=Math.min(a+o,Math.PI),u=0,h=[],d=new Wt,p=new Wt,f=[],m=[],g=[],v=[];for(c=0;c<=n;c++){var y=[],b=c/n,x=0;for(0==c&&0==a?x=.5/t:c==n&&l==Math.PI&&(x=-.5/t),s=0;s<=t;s++){var w=s/t;d.x=-e*Math.cos(r+w*i)*Math.sin(a+b*o),d.y=e*Math.cos(a+b*o),d.z=e*Math.sin(r+w*i)*Math.sin(a+b*o),m.push(d.x,d.y,d.z),p.copy(d).normalize(),g.push(p.x,p.y,p.z),v.push(w+x,1-b),y.push(u++)}h.push(y)}for(c=0;c<n;c++)for(s=0;s<t;s++){var E=h[c][s+1],M=h[c][s],A=h[c+1][s],T=h[c+1][s+1];(0!==c||a>0)&&f.push(E,M,T),(c!==n-1||l<Math.PI)&&f.push(M,A,T)}this.setIndex(f),this.addAttribute("position",new rr(m,3)),this.addAttribute("normal",new rr(g,3)),this.addAttribute("uv",new rr(v,2))}function es(e,t,n,r,i,a){Yn.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},this.fromBufferGeometry(new ts(e,t,n,r,i,a)),this.mergeVertices()}function ts(e,t,n,r,i,a){cr.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},e=e||.5,t=t||1,i=void 0!==i?i:0,a=void 0!==a?a:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var o,s,c,l=[],u=[],h=[],d=[],p=e,f=(t-e)/(r=void 0!==r?Math.max(1,r):1),m=new Wt,g=new jt;for(s=0;s<=r;s++){for(c=0;c<=n;c++)o=i+c/n*a,m.x=p*Math.cos(o),m.y=p*Math.sin(o),u.push(m.x,m.y,m.z),h.push(0,0,1),g.x=(m.x/t+1)/2,g.y=(m.y/t+1)/2,d.push(g.x,g.y);p+=f}for(s=0;s<r;s++){var v=s*(n+1);for(c=0;c<n;c++){var y=o=c+v,b=o+n+1,x=o+n+2,w=o+1;l.push(y,b,w),l.push(b,x,w)}}this.setIndex(l),this.addAttribute("position",new rr(u,3)),this.addAttribute("normal",new rr(h,3)),this.addAttribute("uv",new rr(d,2))}function ns(e,t,n,r){Yn.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},this.fromBufferGeometry(new rs(e,t,n,r)),this.mergeVertices()}function rs(e,t,n,r){cr.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t)||12,n=n||0,r=r||2*Math.PI,r=Vt.clamp(r,0,2*Math.PI);var i,a,o,s=[],c=[],l=[],u=1/t,h=new Wt,d=new jt;for(a=0;a<=t;a++){var p=n+a*u*r,f=Math.sin(p),m=Math.cos(p);for(o=0;o<=e.length-1;o++)h.x=e[o].x*f,h.y=e[o].y,h.z=e[o].x*m,c.push(h.x,h.y,h.z),d.x=a/t,d.y=o/(e.length-1),l.push(d.x,d.y)}for(a=0;a<t;a++)for(o=0;o<e.length-1;o++){var g=i=o+a*e.length,v=i+e.length,y=i+e.length+1,b=i+1;s.push(g,v,b),s.push(v,y,b)}if(this.setIndex(s),this.addAttribute("position",new rr(c,3)),this.addAttribute("uv",new rr(l,2)),this.computeVertexNormals(),r===2*Math.PI){var x=this.attributes.normal.array,w=new Wt,E=new Wt,M=new Wt;for(i=t*e.length*3,a=0,o=0;a<e.length;a++,o+=3)w.x=x[o+0],w.y=x[o+1],w.z=x[o+2],E.x=x[i+o+0],E.y=x[i+o+1],E.z=x[i+o+2],M.addVectors(w,E).normalize(),x[o+0]=x[i+o+0]=M.x,x[o+1]=x[i+o+1]=M.y,x[o+2]=x[i+o+2]=M.z}}function is(e,t){Yn.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new as(e,t)),this.mergeVertices()}function as(e,t){cr.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var n=[],r=[],i=[],a=[],o=0,s=0;if(!1===Array.isArray(e))l(e);else for(var c=0;c<e.length;c++)l(e[c]),this.addGroup(o,s,c),o+=s,s=0;function l(e){var o,c,l,u=r.length/3,h=e.extractPoints(t),d=h.shape,p=h.holes;for(!1===jo.isClockWise(d)&&(d=d.reverse()),o=0,c=p.length;o<c;o++)l=p[o],!0===jo.isClockWise(l)&&(p[o]=l.reverse());var f=jo.triangulateShape(d,p);for(o=0,c=p.length;o<c;o++)l=p[o],d=d.concat(l);for(o=0,c=d.length;o<c;o++){var m=d[o];r.push(m.x,m.y,0),i.push(0,0,1),a.push(m.x,m.y)}for(o=0,c=f.length;o<c;o++){var g=f[o],v=g[0]+u,y=g[1]+u,b=g[2]+u;n.push(v,y,b),s+=3}}this.setIndex(n),this.addAttribute("position",new rr(r,3)),this.addAttribute("normal",new rr(i,3)),this.addAttribute("uv",new rr(a,2))}function os(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}function ss(e,t){cr.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var n,r,i,a,o=[],s=Math.cos(Vt.DEG2RAD*t),c=[0,0],l={},u=["a","b","c"];e.isBufferGeometry?(a=new Yn).fromBufferGeometry(e):a=e.clone(),a.mergeVertices(),a.computeFaceNormals();for(var h=a.vertices,d=a.faces,p=0,f=d.length;p<f;p++)for(var m=d[p],g=0;g<3;g++)n=m[u[g]],r=m[u[(g+1)%3]],c[0]=Math.min(n,r),c[1]=Math.max(n,r),void 0===l[i=c[0]+","+c[1]]?l[i]={index1:c[0],index2:c[1],face1:p,face2:void 0}:l[i].face2=p;for(i in l){var v=l[i];if(void 0===v.face2||d[v.face1].normal.dot(d[v.face2].normal)<=s){var y=h[v.index1];o.push(y.x,y.y,y.z),y=h[v.index2],o.push(y.x,y.y,y.z)}}this.addAttribute("position",new rr(o,3))}function cs(e,t,n,r,i,a,o,s){Yn.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new ls(e,t,n,r,i,a,o,s)),this.mergeVertices()}function ls(e,t,n,r,i,a,o,s){cr.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s};var c=this;e=void 0!==e?e:1,t=void 0!==t?t:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,a=void 0!==a&&a,o=void 0!==o?o:0,s=void 0!==s?s:2*Math.PI;var l=[],u=[],h=[],d=[],p=0,f=[],m=n/2,g=0;function v(n){var i,a,f,v=new jt,y=new Wt,b=0,x=!0===n?e:t,w=!0===n?1:-1;for(a=p,i=1;i<=r;i++)u.push(0,m*w,0),h.push(0,w,0),d.push(.5,.5),p++;for(f=p,i=0;i<=r;i++){var E=i/r*s+o,M=Math.cos(E),A=Math.sin(E);y.x=x*A,y.y=m*w,y.z=x*M,u.push(y.x,y.y,y.z),h.push(0,w,0),v.x=.5*M+.5,v.y=.5*A*w+.5,d.push(v.x,v.y),p++}for(i=0;i<r;i++){var T=a+i,_=f+i;!0===n?l.push(_,_+1,T):l.push(_+1,_,T),b+=3}c.addGroup(g,b,!0===n?1:2),g+=b}!function(){var a,v,y=new Wt,b=new Wt,x=0,w=(t-e)/n;for(v=0;v<=i;v++){var E=[],M=v/i,A=M*(t-e)+e;for(a=0;a<=r;a++){var T=a/r,_=T*s+o,S=Math.sin(_),L=Math.cos(_);b.x=A*S,b.y=-M*n+m,b.z=A*L,u.push(b.x,b.y,b.z),y.set(S,w,L).normalize(),h.push(y.x,y.y,y.z),d.push(T,1-M),E.push(p++)}f.push(E)}for(a=0;a<r;a++)for(v=0;v<i;v++){var C=f[v][a],R=f[v+1][a],P=f[v+1][a+1],O=f[v][a+1];l.push(C,R,O),l.push(R,P,O),x+=6}c.addGroup(g,x,0),g+=x}(),!1===a&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(l),this.addAttribute("position",new rr(u,3)),this.addAttribute("normal",new rr(h,3)),this.addAttribute("uv",new rr(d,2))}function us(e,t,n,r,i,a,o){cs.call(this,0,e,t,n,r,i,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:o}}function hs(e,t,n,r,i,a,o){ls.call(this,0,e,t,n,r,i,a,o),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:o}}function ds(e,t,n,r){Yn.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new ps(e,t,n,r)),this.mergeVertices()}function ps(e,t,n,r){cr.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},e=e||1,t=void 0!==t?Math.max(3,t):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,a,o=[],s=[],c=[],l=[],u=new Wt,h=new jt;for(s.push(0,0,0),c.push(0,0,1),l.push(.5,.5),a=0,i=3;a<=t;a++,i+=3){var d=n+a/t*r;u.x=e*Math.cos(d),u.y=e*Math.sin(d),s.push(u.x,u.y,u.z),c.push(0,0,1),h.x=(s[i]/e+1)/2,h.y=(s[i+1]/e+1)/2,l.push(h.x,h.y)}for(i=1;i<=t;i++)o.push(i,i+1,0);this.setIndex(o),this.addAttribute("position",new rr(s,3)),this.addAttribute("normal",new rr(c,3)),this.addAttribute("uv",new rr(l,2))}Jo.prototype=Object.create(Yn.prototype),Jo.prototype.constructor=Jo,Zo.prototype=Object.create(Xo.prototype),Zo.prototype.constructor=Zo,Qo.prototype=Object.create(Yn.prototype),Qo.prototype.constructor=Qo,$o.prototype=Object.create(cr.prototype),$o.prototype.constructor=$o,es.prototype=Object.create(Yn.prototype),es.prototype.constructor=es,ts.prototype=Object.create(cr.prototype),ts.prototype.constructor=ts,ns.prototype=Object.create(Yn.prototype),ns.prototype.constructor=ns,rs.prototype=Object.create(cr.prototype),rs.prototype.constructor=rs,is.prototype=Object.create(Yn.prototype),is.prototype.constructor=is,is.prototype.toJSON=function(){var e=Yn.prototype.toJSON.call(this);return os(this.parameters.shapes,e)},as.prototype=Object.create(cr.prototype),as.prototype.constructor=as,as.prototype.toJSON=function(){var e=cr.prototype.toJSON.call(this);return os(this.parameters.shapes,e)},ss.prototype=Object.create(cr.prototype),ss.prototype.constructor=ss,cs.prototype=Object.create(Yn.prototype),cs.prototype.constructor=cs,ls.prototype=Object.create(cr.prototype),ls.prototype.constructor=ls,us.prototype=Object.create(cs.prototype),us.prototype.constructor=us,hs.prototype=Object.create(ls.prototype),hs.prototype.constructor=hs,ds.prototype=Object.create(Yn.prototype),ds.prototype.constructor=ds,ps.prototype=Object.create(cr.prototype),ps.prototype.constructor=ps;var fs=Object.freeze({WireframeGeometry:to,ParametricGeometry:no,ParametricBufferGeometry:ro,TetrahedronGeometry:oo,TetrahedronBufferGeometry:so,OctahedronGeometry:co,OctahedronBufferGeometry:lo,IcosahedronGeometry:uo,IcosahedronBufferGeometry:ho,DodecahedronGeometry:po,DodecahedronBufferGeometry:fo,PolyhedronGeometry:io,PolyhedronBufferGeometry:ao,TubeGeometry:mo,TubeBufferGeometry:go,TorusKnotGeometry:vo,TorusKnotBufferGeometry:yo,TorusGeometry:bo,TorusBufferGeometry:xo,TextGeometry:Jo,TextBufferGeometry:Zo,SphereGeometry:Qo,SphereBufferGeometry:$o,RingGeometry:es,RingBufferGeometry:ts,PlaneGeometry:hr,PlaneBufferGeometry:dr,LatheGeometry:ns,LatheBufferGeometry:rs,ShapeGeometry:is,ShapeBufferGeometry:as,ExtrudeGeometry:qo,ExtrudeBufferGeometry:Xo,EdgesGeometry:ss,ConeGeometry:us,ConeBufferGeometry:hs,CylinderGeometry:cs,CylinderBufferGeometry:ls,CircleGeometry:ds,CircleBufferGeometry:ps,BoxGeometry:lr,BoxBufferGeometry:ur});function ms(e){fr.call(this),this.type="ShadowMaterial",this.color=new Cn(0),this.transparent=!0,this.setValues(e)}function gs(e){Sr.call(this,e),this.type="RawShaderMaterial"}function vs(e){fr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Cn(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Cn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ut,this.normalScale=new jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function ys(e){vs.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function bs(e){fr.call(this),this.type="MeshPhongMaterial",this.color=new Cn(16777215),this.specular=new Cn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Cn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ut,this.normalScale=new jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ne,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function xs(e){bs.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function ws(e){fr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ut,this.normalScale=new jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Es(e){fr.call(this),this.type="MeshLambertMaterial",this.color=new Cn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Cn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ne,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Ms(e){fr.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Cn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ut,this.normalScale=new jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.lights=!1,this.setValues(e)}function As(e){Wa.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}ms.prototype=Object.create(fr.prototype),ms.prototype.constructor=ms,ms.prototype.isShadowMaterial=!0,ms.prototype.copy=function(e){return fr.prototype.copy.call(this,e),this.color.copy(e.color),this},gs.prototype=Object.create(Sr.prototype),gs.prototype.constructor=gs,gs.prototype.isRawShaderMaterial=!0,vs.prototype=Object.create(fr.prototype),vs.prototype.constructor=vs,vs.prototype.isMeshStandardMaterial=!0,vs.prototype.copy=function(e){return fr.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},ys.prototype=Object.create(vs.prototype),ys.prototype.constructor=ys,ys.prototype.isMeshPhysicalMaterial=!0,ys.prototype.copy=function(e){return vs.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},bs.prototype=Object.create(fr.prototype),bs.prototype.constructor=bs,bs.prototype.isMeshPhongMaterial=!0,bs.prototype.copy=function(e){return fr.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},xs.prototype=Object.create(bs.prototype),xs.prototype.constructor=xs,xs.prototype.isMeshToonMaterial=!0,xs.prototype.copy=function(e){return bs.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},ws.prototype=Object.create(fr.prototype),ws.prototype.constructor=ws,ws.prototype.isMeshNormalMaterial=!0,ws.prototype.copy=function(e){return fr.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Es.prototype=Object.create(fr.prototype),Es.prototype.constructor=Es,Es.prototype.isMeshLambertMaterial=!0,Es.prototype.copy=function(e){return fr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Ms.prototype=Object.create(fr.prototype),Ms.prototype.constructor=Ms,Ms.prototype.isMeshMatcapMaterial=!0,Ms.prototype.copy=function(e){return fr.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},As.prototype=Object.create(Wa.prototype),As.prototype.constructor=As,As.prototype.isLineDashedMaterial=!0,As.prototype.copy=function(e){return Wa.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var Ts=Object.freeze({ShadowMaterial:ms,SpriteMaterial:Fa,RawShaderMaterial:gs,ShaderMaterial:Sr,PointsMaterial:Ka,MeshPhysicalMaterial:ys,MeshStandardMaterial:vs,MeshPhongMaterial:bs,MeshToonMaterial:xs,MeshNormalMaterial:ws,MeshLambertMaterial:Es,MeshDepthMaterial:ha,MeshDistanceMaterial:da,MeshBasicMaterial:Rr,MeshMatcapMaterial:Ms,LineDashedMaterial:As,LineBasicMaterial:Wa,Material:fr}),_s={arraySlice:function(e,t,n){return _s.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){for(var r=e.length,i=new e.constructor(r),a=0,o=0;o!==r;++a)for(var s=n[a]*t,c=0;c!==t;++c)i[o++]=e[s+c];return i},flattenJSON:function(e,t,n,r){for(var i=1,a=e[0];void 0!==a&&void 0===a[r];)a=e[i++];if(void 0!==a){var o=a[r];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[r])&&(t.push(a.time),n.push.apply(n,o)),a=e[i++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[r])&&(t.push(a.time),o.toArray(n,n.length)),a=e[i++]}while(void 0!==a);else do{void 0!==(o=a[r])&&(t.push(a.time),n.push(o)),a=e[i++]}while(void 0!==a)}}};function Ss(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function Ls(e,t,n,r){Ss.call(this,e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Cs(e,t,n,r){Ss.call(this,e,t,n,r)}function Rs(e,t,n,r){Ss.call(this,e,t,n,r)}function Ps(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=_s.convertArray(t,this.TimeBufferType),this.values=_s.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function Os(e,t,n){Ps.call(this,e,t,n)}function Ds(e,t,n,r){Ps.call(this,e,t,n,r)}function Is(e,t,n,r){Ps.call(this,e,t,n,r)}function Bs(e,t,n,r){Ss.call(this,e,t,n,r)}function ks(e,t,n,r){Ps.call(this,e,t,n,r)}function Hs(e,t,n,r){Ps.call(this,e,t,n,r)}function Ns(e,t,n,r){Ps.call(this,e,t,n,r)}function Fs(e,t,n){this.name=e,this.tracks=n,this.duration=void 0!==t?t:-1,this.uuid=Vt.generateUUID(),this.duration<0&&this.resetDuration()}function Us(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Is;case"vector":case"vector2":case"vector3":case"vector4":return Ns;case"color":return Ds;case"quaternion":return ks;case"bool":case"boolean":return Os;case"string":return Hs}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],r=[];_s.flattenJSON(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}Object.assign(Ss.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{var a;n:{r:if(!(e<r)){for(var o=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,i)}if(n===o)break;if(i=r,e<(r=t[++n]))break t}a=t.length;break n}if(e>=i)break e;var s=t[1];e<s&&(n=2,i=s);for(o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===o)break;if(r=i,e>=(i=t[--n-1]))break t}a=n,n=0}for(;n<a;){var c=n+a>>>1;e<t[c]?a=c:n=c+1}if(r=t[n],void 0===(i=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,i,e)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,a=0;a!==r;++a)t[a]=n[i+a];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(Ss.prototype,{beforeStart_:Ss.prototype.copySampleValue_,afterEnd_:Ss.prototype.copySampleValue_}),Ls.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Ls,DefaultSettings_:{endingStart:At,endingEnd:At},intervalChanged_:function(e,t,n){var r=this.parameterPositions,i=e-2,a=e+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case Tt:i=e,o=2*t-n;break;case _t:o=t+r[i=r.length-2]-r[i+1];break;default:i=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case Tt:a=e,s=2*n-t;break;case _t:a=1,s=n+r[1]-r[0];break;default:a=e-1,s=t}var c=.5*(n-t),l=this.valueSize;this._weightPrev=c/(t-o),this._weightNext=c/(s-n),this._offsetPrev=i*l,this._offsetNext=a*l},interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,c=s-o,l=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-t)/(r-t),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,v=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,b=d*m-d*f,x=0;x!==o;++x)i[x]=g*a[l+x]+v*a[c+x]+y*a[s+x]+b*a[u+x];return i}}),Cs.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Cs,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,c=s-o,l=(n-t)/(r-t),u=1-l,h=0;h!==o;++h)i[h]=a[c+h]*u+a[s+h]*l;return i}}),Rs.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Rs,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(Ps,{toJSON:function(e){var t,n=e.constructor;if(void 0!==n.toJSON)t=n.toJSON(e);else{t={name:e.name,times:_s.convertArray(e.times,Array),values:_s.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}),Object.assign(Ps.prototype,{constructor:Ps,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Et,InterpolantFactoryMethodDiscrete:function(e){return new Rs(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Cs(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Ls(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case wt:t=this.InterpolantFactoryMethodDiscrete;break;case Et:t=this.InterpolantFactoryMethodLinear;break;case Mt:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return wt;case this.InterpolantFactoryMethodLinear:return Et;case this.InterpolantFactoryMethodSmooth:return Mt}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this},trim:function(e,t){for(var n=this.times,r=n.length,i=0,a=r-1;i!==r&&n[i]<e;)++i;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==i||a!==r){i>=a&&(i=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=_s.arraySlice(n,i,a),this.values=_s.arraySlice(this.values,i*o,a*o)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a=null,o=0;o!==i;o++){var s=n[o];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),e=!1;break}a=s}if(void 0!==r&&_s.isTypedArray(r)){o=0;for(var c=r.length;o!==c;++o){var l=r[o];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,l),e=!1;break}}}return e},optimize:function(){for(var e=this.times,t=this.values,n=this.getValueSize(),r=this.getInterpolation()===Mt,i=1,a=e.length-1,o=1;o<a;++o){var s=!1,c=e[o];if(c!==e[o+1]&&(1!==o||c!==c[0]))if(r)s=!0;else for(var l=o*n,u=l-n,h=l+n,d=0;d!==n;++d){var p=t[l+d];if(p!==t[u+d]||p!==t[h+d]){s=!0;break}}if(s){if(o!==i){e[i]=e[o];var f=o*n,m=i*n;for(d=0;d!==n;++d)t[m+d]=t[f+d]}++i}}if(a>0){e[i]=e[a];for(f=a*n,m=i*n,d=0;d!==n;++d)t[m+d]=t[f+d];++i}return i!==e.length&&(this.times=_s.arraySlice(e,0,i),this.values=_s.arraySlice(t,0,i*n)),this},clone:function(){var e=_s.arraySlice(this.times,0),t=_s.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}),Os.prototype=Object.assign(Object.create(Ps.prototype),{constructor:Os,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:wt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Ds.prototype=Object.assign(Object.create(Ps.prototype),{constructor:Ds,ValueTypeName:"color"}),Is.prototype=Object.assign(Object.create(Ps.prototype),{constructor:Is,ValueTypeName:"number"}),Bs.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Bs,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,c=(n-t)/(r-t),l=s+o;s!==l;s+=4)Gt.slerpFlat(i,0,a,s-o,a,s,c);return i}}),ks.prototype=Object.assign(Object.create(Ps.prototype),{constructor:ks,ValueTypeName:"quaternion",DefaultInterpolation:Et,InterpolantFactoryMethodLinear:function(e){return new Bs(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),Hs.prototype=Object.assign(Object.create(Ps.prototype),{constructor:Hs,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:wt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Ns.prototype=Object.assign(Object.create(Ps.prototype),{constructor:Ns,ValueTypeName:"vector"}),Object.assign(Fs,{parse:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,a=n.length;i!==a;++i)t.push(Us(n[i]).scale(r));return new Fs(e.name,e.duration,t)},toJSON:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},i=0,a=n.length;i!==a;++i)t.push(Ps.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(e,t,n,r){for(var i=t.length,a=[],o=0;o<i;o++){var s=[],c=[];s.push((o+i-1)%i,o,(o+1)%i),c.push(0,1,0);var l=_s.getKeyframeOrder(s);s=_s.sortedArray(s,1,l),c=_s.sortedArray(c,1,l),r||0!==s[0]||(s.push(i),c.push(c[0])),a.push(new Is(".morphTargetInfluences["+t[o].name+"]",s,c).scale(1/n))}return new Fs(e,-1,a)},findByName:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,a=0,o=e.length;a<o;a++){var s=e[a],c=s.name.match(i);if(c&&c.length>1){var l=r[h=c[1]];l||(r[h]=l=[]),l.push(s)}}var u=[];for(var h in r)u.push(Fs.CreateFromMorphTargetSequence(h,r[h],t,n));return u},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){if(0!==n.length){var a=[],o=[];_s.flattenJSON(n,a,o,r),0!==a.length&&i.push(new e(t,a,o))}},r=[],i=e.name||"default",a=e.length||-1,o=e.fps||30,s=e.hierarchy||[],c=0;c<s.length;c++){var l=s[c].keys;if(l&&0!==l.length)if(l[0].morphTargets){for(var u={},h=0;h<l.length;h++)if(l[h].morphTargets)for(var d=0;d<l[h].morphTargets.length;d++)u[l[h].morphTargets[d]]=-1;for(var p in u){var f=[],m=[];for(d=0;d!==l[h].morphTargets.length;++d){var g=l[h];f.push(g.time),m.push(g.morphTarget===p?1:0)}r.push(new Is(".morphTargetInfluence["+p+"]",f,m))}a=u.length*(o||1)}else{var v=".bones["+t[c].name+"]";n(Ns,v+".position",l,"pos",r),n(ks,v+".quaternion",l,"rot",r),n(Ns,v+".scale",l,"scl",r)}}return 0===r.length?null:new Fs(i,a,r)}}),Object.assign(Fs.prototype,{resetDuration:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new Fs(this.name,this.duration,e)}});var zs={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function Vs(e,t,n){var r=this,i=!1,a=0,o=0,s=void 0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++,!1===i&&void 0!==r.onStart&&r.onStart(e,a,o),i=!0},this.itemEnd=function(e){a++,void 0!==r.onProgress&&r.onProgress(e,a,o),a===o&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this}}var js=new Vs,Gs={};function Ws(e){this.manager=void 0!==e?e:js}function qs(e){this.manager=void 0!==e?e:js}function Xs(e){this.manager=void 0!==e?e:js,this._parser=null}function Ys(e){this.manager=void 0!==e?e:js,this._parser=null}function Ks(e){this.manager=void 0!==e?e:js}function Js(e){this.manager=void 0!==e?e:js}function Zs(e){this.manager=void 0!==e?e:js}function Qs(){this.type="Curve",this.arcLengthDivisions=200}function $s(e,t,n,r,i,a,o,s){Qs.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}function ec(e,t,n,r,i,a){$s.call(this,e,t,n,n,r,i,a),this.type="ArcCurve"}function tc(){var e=0,t=0,n=0,r=0;function i(i,a,o,s){e=i,t=o,n=-3*i+3*a-2*o-s,r=2*i-2*a+o+s}return{initCatmullRom:function(e,t,n,r,a){i(t,n,a*(n-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,a,o,s){var c=(t-e)/a-(n-e)/(a+o)+(n-t)/o,l=(n-t)/o-(r-t)/(o+s)+(r-n)/s;i(t,n,c*=o,l*=o)},calc:function(i){var a=i*i;return e+t*i+n*a+r*(a*i)}}}Object.assign(Ws.prototype,{load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=zs.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;if(void 0===Gs[e]){var o=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(o){var s=o[1],c=!!o[2],l=o[3];l=decodeURIComponent(l),c&&(l=atob(l));try{var u,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var d=new Uint8Array(l.length),p=0;p<l.length;p++)d[p]=l.charCodeAt(p);u="blob"===h?new Blob([d.buffer],{type:s}):d.buffer;break;case"document":var f=new DOMParser;u=f.parseFromString(l,s);break;case"json":u=JSON.parse(l);break;default:u=l}setTimeout((function(){t&&t(u),i.manager.itemEnd(e)}),0)}catch(t){setTimeout((function(){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}),0)}}else{Gs[e]=[],Gs[e].push({onLoad:t,onProgress:n,onError:r});var m=new XMLHttpRequest;for(var g in m.open("GET",e,!0),m.addEventListener("load",(function(t){var n=this.response;zs.add(e,n);var r=Gs[e];if(delete Gs[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var a=0,o=r.length;a<o;a++){(s=r[a]).onLoad&&s.onLoad(n)}i.manager.itemEnd(e)}else{for(a=0,o=r.length;a<o;a++){var s;(s=r[a]).onError&&s.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}}),!1),m.addEventListener("progress",(function(t){for(var n=Gs[e],r=0,i=n.length;r<i;r++){var a=n[r];a.onProgress&&a.onProgress(t)}}),!1),m.addEventListener("error",(function(t){var n=Gs[e];delete Gs[e];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),m.addEventListener("abort",(function(t){var n=Gs[e];delete Gs[e];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return i.manager.itemStart(e),m}Gs[e].push({onLoad:t,onProgress:n,onError:r})},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(qs.prototype,{load:function(e,t,n,r){var i=this,a=new Ws(i.manager);a.setPath(i.path),a.load(e,(function(e){t(i.parse(JSON.parse(e)))}),n,r)},parse:function(e){for(var t=[],n=0;n<e.length;n++){var r=Fs.parse(e[n]);t.push(r)}return t},setPath:function(e){return this.path=e,this}}),Object.assign(Xs.prototype,{load:function(e,t,n,r){var i=this,a=[],o=new Qa;o.image=a;var s=new Ws(this.manager);function c(c){s.load(e[c],(function(e){var n=i._parser(e,!0);a[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(l+=1)&&(1===n.mipmapCount&&(o.minFilter=Te),o.format=n.format,o.needsUpdate=!0,t&&t(o))}),n,r)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(e))for(var l=0,u=0,h=e.length;u<h;++u)c(u);else s.load(e,(function(e){var n=i._parser(e,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){a[s]={mipmaps:[]};for(var c=0;c<n.mipmapCount;c++)a[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+c]),a[s].format=n.format,a[s].width=n.width,a[s].height=n.height}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=Te),o.format=n.format,o.needsUpdate=!0,t&&t(o)}),n,r);return o},setPath:function(e){return this.path=e,this}}),Object.assign(Ys.prototype,{load:function(e,t,n,r){var i=this,a=new mn,o=new Ws(this.manager);return o.setResponseType("arraybuffer"),o.setPath(this.path),o.load(e,(function(e){var n=i._parser(e);n&&(void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:xe,a.wrapT=void 0!==n.wrapT?n.wrapT:xe,a.magFilter=void 0!==n.magFilter?n.magFilter:Te,a.minFilter=void 0!==n.minFilter?n.minFilter:Se,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps),1===n.mipmapCount&&(a.minFilter=Te),a.needsUpdate=!0,t&&t(a,n))}),n,r),a},setPath:function(e){return this.path=e,this}}),Object.assign(Ks.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=zs.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",c,!1),zs.add(e,this),t&&t(this),i.manager.itemEnd(e)}function c(t){o.removeEventListener("load",s,!1),o.removeEventListener("error",c,!1),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}return o.addEventListener("load",s,!1),o.addEventListener("error",c,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Js.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){var i=new Wr,a=new Ks(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(n){a.load(e[n],(function(e){i.images[n]=e,6===++o&&(i.needsUpdate=!0,t&&t(i))}),void 0,r)}for(var c=0;c<e.length;++c)s(c);return i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Zs.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){var i=new un,a=new Ks(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(n){i.image=n;var r=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);i.format=r?ze:Ve,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Qs.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n,r=[],i=this.getPoint(0),a=0;for(r.push(0),n=1;n<=e;n++)a+=(t=this.getPoint(n/e)).distanceTo(i),r.push(a),i=t;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n,r=this.getLengths(),i=0,a=r.length;n=t||e*r[a-1];for(var o,s=0,c=a-1;s<=c;)if((o=r[i=Math.floor(s+(c-s)/2)]-n)<0)s=i+1;else{if(!(o>0)){c=i;break}c=i-1}if(r[i=c]===n)return i/(a-1);var l=r[i];return(i+(n-l)/(r[i+1]-l))/(a-1)},getTangent:function(e){var t=e-1e-4,n=e+1e-4;t<0&&(t=0),n>1&&(n=1);var r=this.getPoint(t);return this.getPoint(n).clone().sub(r).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var n,r,i,a=new Wt,o=[],s=[],c=[],l=new Wt,u=new xn;for(n=0;n<=e;n++)r=n/e,o[n]=this.getTangentAt(r),o[n].normalize();s[0]=new Wt,c[0]=new Wt;var h=Number.MAX_VALUE,d=Math.abs(o[0].x),p=Math.abs(o[0].y),f=Math.abs(o[0].z);for(d<=h&&(h=d,a.set(1,0,0)),p<=h&&(h=p,a.set(0,1,0)),f<=h&&a.set(0,0,1),l.crossVectors(o[0],a).normalize(),s[0].crossVectors(o[0],l),c[0].crossVectors(o[0],s[0]),n=1;n<=e;n++)s[n]=s[n-1].clone(),c[n]=c[n-1].clone(),l.crossVectors(o[n-1],o[n]),l.length()>Number.EPSILON&&(l.normalize(),i=Math.acos(Vt.clamp(o[n-1].dot(o[n]),-1,1)),s[n].applyMatrix4(u.makeRotationAxis(l,i))),c[n].crossVectors(o[n],s[n]);if(!0===t)for(i=Math.acos(Vt.clamp(s[0].dot(s[e]),-1,1)),i/=e,o[0].dot(l.crossVectors(s[0],s[e]))>0&&(i=-i),n=1;n<=e;n++)s[n].applyMatrix4(u.makeRotationAxis(o[n],i*n)),c[n].crossVectors(o[n],s[n]);return{tangents:o,normals:s,binormals:c}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),$s.prototype=Object.create(Qs.prototype),$s.prototype.constructor=$s,$s.prototype.isEllipseCurve=!0,$s.prototype.getPoint=function(e,t){for(var n=t||new jt,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,a=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=a?0:r),!0!==this.aClockwise||a||(i===r?i=-r:i-=r);var o=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(o),c=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var l=Math.cos(this.aRotation),u=Math.sin(this.aRotation),h=s-this.aX,d=c-this.aY;s=h*l-d*u+this.aX,c=h*u+d*l+this.aY}return n.set(s,c)},$s.prototype.copy=function(e){return Qs.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},$s.prototype.toJSON=function(){var e=Qs.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},$s.prototype.fromJSON=function(e){return Qs.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},ec.prototype=Object.create($s.prototype),ec.prototype.constructor=ec,ec.prototype.isArcCurve=!0;var nc=new Wt,rc=new tc,ic=new tc,ac=new tc;function oc(e,t,n,r){Qs.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=r||.5}function sc(e,t,n,r,i){var a=.5*(r-t),o=.5*(i-n),s=e*e;return(2*n-2*r+a+o)*(e*s)+(-3*n+3*r-2*a-o)*s+a*e+n}function cc(e,t,n,r){return function(e,t){var n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function lc(e,t,n,r,i){return function(e,t){var n=1-e;return n*n*n*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}function uc(e,t,n,r){Qs.call(this),this.type="CubicBezierCurve",this.v0=e||new jt,this.v1=t||new jt,this.v2=n||new jt,this.v3=r||new jt}function hc(e,t,n,r){Qs.call(this),this.type="CubicBezierCurve3",this.v0=e||new Wt,this.v1=t||new Wt,this.v2=n||new Wt,this.v3=r||new Wt}function dc(e,t){Qs.call(this),this.type="LineCurve",this.v1=e||new jt,this.v2=t||new jt}function pc(e,t){Qs.call(this),this.type="LineCurve3",this.v1=e||new Wt,this.v2=t||new Wt}function fc(e,t,n){Qs.call(this),this.type="QuadraticBezierCurve",this.v0=e||new jt,this.v1=t||new jt,this.v2=n||new jt}function mc(e,t,n){Qs.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new Wt,this.v1=t||new Wt,this.v2=n||new Wt}function gc(e){Qs.call(this),this.type="SplineCurve",this.points=e||[]}oc.prototype=Object.create(Qs.prototype),oc.prototype.constructor=oc,oc.prototype.isCatmullRomCurve3=!0,oc.prototype.getPoint=function(e,t){var n,r,i,a,o=t||new Wt,s=this.points,c=s.length,l=(c-(this.closed?0:1))*e,u=Math.floor(l),h=l-u;if(this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/c)+1)*c:0===h&&u===c-1&&(u=c-2,h=1),this.closed||u>0?n=s[(u-1)%c]:(nc.subVectors(s[0],s[1]).add(s[0]),n=nc),r=s[u%c],i=s[(u+1)%c],this.closed||u+2<c?a=s[(u+2)%c]:(nc.subVectors(s[c-1],s[c-2]).add(s[c-1]),a=nc),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,p=Math.pow(n.distanceToSquared(r),d),f=Math.pow(r.distanceToSquared(i),d),m=Math.pow(i.distanceToSquared(a),d);f<1e-4&&(f=1),p<1e-4&&(p=f),m<1e-4&&(m=f),rc.initNonuniformCatmullRom(n.x,r.x,i.x,a.x,p,f,m),ic.initNonuniformCatmullRom(n.y,r.y,i.y,a.y,p,f,m),ac.initNonuniformCatmullRom(n.z,r.z,i.z,a.z,p,f,m)}else"catmullrom"===this.curveType&&(rc.initCatmullRom(n.x,r.x,i.x,a.x,this.tension),ic.initCatmullRom(n.y,r.y,i.y,a.y,this.tension),ac.initCatmullRom(n.z,r.z,i.z,a.z,this.tension));return o.set(rc.calc(h),ic.calc(h),ac.calc(h)),o},oc.prototype.copy=function(e){Qs.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},oc.prototype.toJSON=function(){var e=Qs.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},oc.prototype.fromJSON=function(e){Qs.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new Wt).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},uc.prototype=Object.create(Qs.prototype),uc.prototype.constructor=uc,uc.prototype.isCubicBezierCurve=!0,uc.prototype.getPoint=function(e,t){var n=t||new jt,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(lc(e,r.x,i.x,a.x,o.x),lc(e,r.y,i.y,a.y,o.y)),n},uc.prototype.copy=function(e){return Qs.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},uc.prototype.toJSON=function(){var e=Qs.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},uc.prototype.fromJSON=function(e){return Qs.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},hc.prototype=Object.create(Qs.prototype),hc.prototype.constructor=hc,hc.prototype.isCubicBezierCurve3=!0,hc.prototype.getPoint=function(e,t){var n=t||new Wt,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(lc(e,r.x,i.x,a.x,o.x),lc(e,r.y,i.y,a.y,o.y),lc(e,r.z,i.z,a.z,o.z)),n},hc.prototype.copy=function(e){return Qs.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},hc.prototype.toJSON=function(){var e=Qs.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},hc.prototype.fromJSON=function(e){return Qs.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},dc.prototype=Object.create(Qs.prototype),dc.prototype.constructor=dc,dc.prototype.isLineCurve=!0,dc.prototype.getPoint=function(e,t){var n=t||new jt;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},dc.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},dc.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},dc.prototype.copy=function(e){return Qs.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},dc.prototype.toJSON=function(){var e=Qs.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},dc.prototype.fromJSON=function(e){return Qs.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},pc.prototype=Object.create(Qs.prototype),pc.prototype.constructor=pc,pc.prototype.isLineCurve3=!0,pc.prototype.getPoint=function(e,t){var n=t||new Wt;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},pc.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},pc.prototype.copy=function(e){return Qs.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},pc.prototype.toJSON=function(){var e=Qs.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},pc.prototype.fromJSON=function(e){return Qs.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},fc.prototype=Object.create(Qs.prototype),fc.prototype.constructor=fc,fc.prototype.isQuadraticBezierCurve=!0,fc.prototype.getPoint=function(e,t){var n=t||new jt,r=this.v0,i=this.v1,a=this.v2;return n.set(cc(e,r.x,i.x,a.x),cc(e,r.y,i.y,a.y)),n},fc.prototype.copy=function(e){return Qs.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},fc.prototype.toJSON=function(){var e=Qs.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},fc.prototype.fromJSON=function(e){return Qs.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},mc.prototype=Object.create(Qs.prototype),mc.prototype.constructor=mc,mc.prototype.isQuadraticBezierCurve3=!0,mc.prototype.getPoint=function(e,t){var n=t||new Wt,r=this.v0,i=this.v1,a=this.v2;return n.set(cc(e,r.x,i.x,a.x),cc(e,r.y,i.y,a.y),cc(e,r.z,i.z,a.z)),n},mc.prototype.copy=function(e){return Qs.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},mc.prototype.toJSON=function(){var e=Qs.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},mc.prototype.fromJSON=function(e){return Qs.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},gc.prototype=Object.create(Qs.prototype),gc.prototype.constructor=gc,gc.prototype.isSplineCurve=!0,gc.prototype.getPoint=function(e,t){var n=t||new jt,r=this.points,i=(r.length-1)*e,a=Math.floor(i),o=i-a,s=r[0===a?a:a-1],c=r[a],l=r[a>r.length-2?r.length-1:a+1],u=r[a>r.length-3?r.length-1:a+2];return n.set(sc(o,s.x,c.x,l.x,u.x),sc(o,s.y,c.y,l.y,u.y)),n},gc.prototype.copy=function(e){Qs.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this},gc.prototype.toJSON=function(){var e=Qs.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e},gc.prototype.fromJSON=function(e){Qs.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new jt).fromArray(r))}return this};var vc=Object.freeze({ArcCurve:ec,CatmullRomCurve3:oc,CubicBezierCurve:uc,CubicBezierCurve3:hc,EllipseCurve:$s,LineCurve:dc,LineCurve3:pc,QuadraticBezierCurve:fc,QuadraticBezierCurve3:mc,SplineCurve:gc});function yc(){Qs.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function bc(e){yc.call(this),this.type="Path",this.currentPoint=new jt,e&&this.setFromPoints(e)}function xc(e){bc.call(this,e),this.uuid=Vt.generateUUID(),this.type="Shape",this.holes=[]}function wc(e,t){Gn.call(this),this.type="Light",this.color=new Cn(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function Ec(e,t,n){wc.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Gn.DefaultUp),this.updateMatrix(),this.groundColor=new Cn(t)}function Mc(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new jt(512,512),this.map=null,this.matrix=new xn}function Ac(){Mc.call(this,new xa(50,1,.5,500))}function Tc(e,t,n,r,i,a){wc.call(this,e,t),this.type="SpotLight",this.position.copy(Gn.DefaultUp),this.updateMatrix(),this.target=new Gn,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==a?a:1,this.shadow=new Ac}function _c(e,t,n,r){wc.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new Mc(new xa(90,1,.5,500))}function Sc(e,t,n,r,i,a){ba.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==e?e:-1,this.right=void 0!==t?t:1,this.top=void 0!==n?n:1,this.bottom=void 0!==r?r:-1,this.near=void 0!==i?i:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function Lc(){Mc.call(this,new Sc(-5,5,5,-5,.5,500))}function Cc(e,t){wc.call(this,e,t),this.type="DirectionalLight",this.position.copy(Gn.DefaultUp),this.updateMatrix(),this.target=new Gn,this.shadow=new Lc}function Rc(e,t){wc.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function Pc(e,t,n,r){wc.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function Oc(e){this.manager=void 0!==e?e:js,this.textures={}}yc.prototype=Object.assign(Object.create(Qs.prototype),{constructor:yc,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new dc(t,e))},getPoint:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=t){var i=n[r]-t,a=this.curves[r],o=a.getLength(),s=0===o?0:1-i/o;return a.getPointAt(s)}r++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,n=[],r=0,i=this.curves;r<i.length;r++)for(var a=i[r],o=a&&a.isEllipseCurve?2*e:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?e*a.points.length:e,s=a.getPoints(o),c=0;c<s.length;c++){var l=s[c];t&&t.equals(l)||(n.push(l),t=l)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(e){Qs.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=Qs.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,n=this.curves.length;t<n;t++){var r=this.curves[t];e.curves.push(r.toJSON())}return e},fromJSON:function(e){Qs.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push((new vc[r.type]).fromJSON(r))}return this}}),bc.prototype=Object.assign(Object.create(yc.prototype),{constructor:bc,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var n=new dc(this.currentPoint.clone(),new jt(e,t));this.curves.push(n),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,n,r){var i=new fc(this.currentPoint.clone(),new jt(e,t),new jt(n,r));this.curves.push(i),this.currentPoint.set(n,r)},bezierCurveTo:function(e,t,n,r,i,a){var o=new uc(this.currentPoint.clone(),new jt(e,t),new jt(n,r),new jt(i,a));this.curves.push(o),this.currentPoint.set(i,a)},splineThru:function(e){var t=new gc([this.currentPoint.clone()].concat(e));this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,n,r,i,a){var o=this.currentPoint.x,s=this.currentPoint.y;this.absarc(e+o,t+s,n,r,i,a)},absarc:function(e,t,n,r,i,a){this.absellipse(e,t,n,n,r,i,a)},ellipse:function(e,t,n,r,i,a,o,s){var c=this.currentPoint.x,l=this.currentPoint.y;this.absellipse(e+c,t+l,n,r,i,a,o,s)},absellipse:function(e,t,n,r,i,a,o,s){var c=new $s(e,t,n,r,i,a,o,s);if(this.curves.length>0){var l=c.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(c);var u=c.getPoint(1);this.currentPoint.copy(u)},copy:function(e){return yc.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=yc.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return yc.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),xc.prototype=Object.assign(Object.create(bc.prototype),{constructor:xc,getPointsHoles:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){bc.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push(r.clone())}return this},toJSON:function(){var e=bc.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,n=this.holes.length;t<n;t++){var r=this.holes[t];e.holes.push(r.toJSON())}return e},fromJSON:function(e){bc.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push((new bc).fromJSON(r))}return this}}),wc.prototype=Object.assign(Object.create(Gn.prototype),{constructor:wc,isLight:!0,copy:function(e){return Gn.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=Gn.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Ec.prototype=Object.assign(Object.create(wc.prototype),{constructor:Ec,isHemisphereLight:!0,copy:function(e){return wc.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(Mc.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Ac.prototype=Object.assign(Object.create(Mc.prototype),{constructor:Ac,isSpotLightShadow:!0,update:function(e){var t=this.camera,n=2*Vt.RAD2DEG*e.angle,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix())}}),Tc.prototype=Object.assign(Object.create(wc.prototype),{constructor:Tc,isSpotLight:!0,copy:function(e){return wc.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),_c.prototype=Object.assign(Object.create(wc.prototype),{constructor:_c,isPointLight:!0,copy:function(e){return wc.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),Sc.prototype=Object.assign(Object.create(ba.prototype),{constructor:Sc,isOrthographicCamera:!0,copy:function(e,t){return ba.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,a=n+e,o=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var c=this.zoom/(this.view.width/this.view.fullWidth),l=this.zoom/(this.view.height/this.view.fullHeight),u=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;a=(i+=u*(this.view.offsetX/c))+u*(this.view.width/c),s=(o-=h*(this.view.offsetY/l))-h*(this.view.height/l)}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=Gn.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),Lc.prototype=Object.assign(Object.create(Mc.prototype),{constructor:Lc}),Cc.prototype=Object.assign(Object.create(wc.prototype),{constructor:Cc,isDirectionalLight:!0,copy:function(e){return wc.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Rc.prototype=Object.assign(Object.create(wc.prototype),{constructor:Rc,isAmbientLight:!0}),Pc.prototype=Object.assign(Object.create(wc.prototype),{constructor:Pc,isRectAreaLight:!0,copy:function(e){return wc.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=wc.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),Object.assign(Oc.prototype,{load:function(e,t,n,r){var i=this,a=new Ws(i.manager);a.setPath(i.path),a.load(e,(function(e){t(i.parse(JSON.parse(e)))}),n,r)},parse:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r=new Ts[e.type];if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&r.specular.setHex(e.specular),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearCoat&&(r.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(r.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.vertexColors&&(r.vertexColors=e.vertexColors),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(r.skinning=e.skinning),void 0!==e.morphTargets&&(r.morphTargets=e.morphTargets),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.uniforms)for(var i in e.uniforms){var a=e.uniforms[i];switch(r.uniforms[i]={},a.type){case"t":r.uniforms[i].value=n(a.value);break;case"c":r.uniforms[i].value=(new Cn).setHex(a.value);break;case"v2":r.uniforms[i].value=(new jt).fromArray(a.value);break;case"v3":r.uniforms[i].value=(new Wt).fromArray(a.value);break;case"v4":r.uniforms[i].value=(new hn).fromArray(a.value);break;case"m3":r.uniforms[i].value=(new qt).fromArray(a.value);case"m4":r.uniforms[i].value=(new xn).fromArray(a.value);break;default:r.uniforms[i].value=a.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var o in e.extensions)r.extensions[o]=e.extensions[o];if(void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap),r.transparent=!0),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){var s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new jt).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),r},setPath:function(e){return this.path=e,this},setTextures:function(e){return this.textures=e,this}});var Dc={decodeText:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(e){return t}},extractUrlBase:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};function Ic(){cr.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Bc(e,t,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Kn.call(this,e,t,n),this._meshPerAttribute=r||1,this.versionVAO=0}function kc(e){this.manager=void 0!==e?e:js}Ic.prototype=Object.assign(Object.create(cr.prototype),{constructor:Ic,isInstancedBufferGeometry:!0,copy:function(e){return cr.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e=cr.prototype.toJSON.call(this);return e.maxInstancedCount=this.maxInstancedCount,e.isInstancedBufferGeometry=!0,e}}),Bc.prototype=Object.assign(Object.create(Kn.prototype),{constructor:Bc,isInstancedBufferAttribute:!0,copy:function(e){return Kn.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=Kn.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),Object.defineProperties(Bc.prototype,{meshPerAttribute:{get:function(){return this._meshPerAttribute},set:function(e){this._meshPerAttribute=e,this.versionVAO++}}}),Object.assign(kc.prototype,{load:function(e,t,n,r){var i=this,a=new Ws(i.manager);a.setPath(i.path),a.load(e,(function(e){t(i.parse(JSON.parse(e)))}),n,r)},parse:function(e){var t=e.isInstancedBufferGeometry?new Ic:new cr,n=e.data.index;if(void 0!==n){var r=new Hc[n.type](n.array);t.setIndex(new Kn(r,1))}var i=e.data.attributes;for(var a in i){var o=i[a],s=(r=new Hc[o.type](o.array),new(o.isInstancedBufferAttribute?Bc:Kn)(r,o.itemSize,o.normalized));void 0!==o.name&&(s.name=o.name),t.addAttribute(a,s)}var c=e.data.morphAttributes;if(c)for(var a in c){for(var l=c[a],u=[],h=0,d=l.length;h<d;h++){o=l[h],s=new Kn(r=new Hc[o.type](o.array),o.itemSize,o.normalized);void 0!==o.name&&(s.name=o.name),u.push(s)}t.morphAttributes[a]=u}var p=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==p){h=0;for(var f=p.length;h!==f;++h){var m=p[h];t.addGroup(m.start,m.count,m.materialIndex)}}var g=e.data.boundingSphere;if(void 0!==g){var v=new Wt;void 0!==g.center&&v.fromArray(g.center),t.boundingSphere=new vn(v,g.radius)}return e.name&&(t.name=e.name),e.userData&&(t.userData=e.userData),t},setPath:function(e){return this.path=e,this}});var Hc={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Nc(e){this.manager=void 0!==e?e:js,this.resourcePath=""}Object.assign(Nc.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){var i=this,a=void 0===this.path?Dc.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;var o=new Ws(i.manager);o.setPath(this.path),o.load(e,(function(n){var a=null;try{a=JSON.parse(n)}catch(t){return void 0!==r&&r(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var o=a.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?i.parse(a,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,r)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){var n=this.parseShape(e.shapes),r=this.parseGeometries(e.geometries,n),i=this.parseImages(e.images,(function(){void 0!==t&&t(s)})),a=this.parseTextures(e.textures,i),o=this.parseMaterials(e.materials,a),s=this.parseObject(e.object,r,o);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var i=(new xc).fromJSON(e[n]);t[i.uuid]=i}return t},parseGeometries:function(e,t){var n={};if(void 0!==e)for(var r=new kc,i=0,a=e.length;i<a;i++){var o,s=e[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new fs[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new fs[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new fs[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new fs[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new fs[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new fs[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":o=new fs[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new fs[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new fs[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new fs[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":o=new fs[s.type]((new vc[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":o=new fs[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":o=new fs[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var c=[],l=0,u=s.shapes.length;l<u;l++){var h=t[s.shapes[l]];c.push(h)}o=new fs[s.type](c,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(c=[],l=0,u=s.shapes.length;l<u;l++){h=t[s.shapes[l]];c.push(h)}var d=s.options.extrudePath;void 0!==d&&(s.options.extrudePath=(new vc[d.type]).fromJSON(d)),o=new fs[s.type](c,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(s);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE)o=(new THREE.LegacyJSONLoader).parse(s,this.resourcePath).geometry;else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),n[s.uuid]=o}return n},parseMaterials:function(e,t){var n={},r={};if(void 0!==e){var i=new Oc;i.setTextures(t);for(var a=0,o=e.length;a<o;a++){var s=e[a];if("MultiMaterial"===s.type){for(var c=[],l=0;l<s.materials.length;l++){var u=s.materials[l];void 0===n[u.uuid]&&(n[u.uuid]=i.parse(u)),c.push(n[u.uuid])}r[s.uuid]=c}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r},parseAnimations:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],i=Fs.parse(r);void 0!==r.uuid&&(i.uuid=r.uuid),t.push(i)}return t},parseImages:function(e,t){var n=this,r={};function i(e){return n.manager.itemStart(e),a.load(e,(function(){n.manager.itemEnd(e)}),void 0,(function(){n.manager.itemError(e),n.manager.itemEnd(e)}))}if(void 0!==e&&e.length>0){var a=new Ks(new Vs(t));a.setCrossOrigin(this.crossOrigin);for(var o=0,s=e.length;o<s;o++){var c=e[o],l=c.url;if(Array.isArray(l)){r[c.uuid]=[];for(var u=0,h=l.length;u<h;u++){var d=l[u],p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:n.resourcePath+d;r[c.uuid].push(i(p))}}else{p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:n.resourcePath+c.url;r[c.uuid]=i(p)}}}return r},parseTextures:function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,a=e.length;i<a;i++){var o,s=e[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(o=Array.isArray(t[s.image])?new Wr(t[s.image]):new un(t[s.image])).needsUpdate=!0,o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),void 0!==s.mapping&&(o.mapping=n(s.mapping,Gc)),void 0!==s.offset&&o.offset.fromArray(s.offset),void 0!==s.repeat&&o.repeat.fromArray(s.repeat),void 0!==s.center&&o.center.fromArray(s.center),void 0!==s.rotation&&(o.rotation=s.rotation),void 0!==s.wrap&&(o.wrapS=n(s.wrap[0],Wc),o.wrapT=n(s.wrap[1],Wc)),void 0!==s.format&&(o.format=s.format),void 0!==s.type&&(o.type=s.type),void 0!==s.encoding&&(o.encoding=s.encoding),void 0!==s.minFilter&&(o.minFilter=n(s.minFilter,qc)),void 0!==s.magFilter&&(o.magFilter=n(s.magFilter,qc)),void 0!==s.anisotropy&&(o.anisotropy=s.anisotropy),void 0!==s.flipY&&(o.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(o.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(o.unpackAlignment=s.unpackAlignment),r[s.uuid]=o}return r},parseObject:function(e,t,n){var r;function i(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function a(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],r=0,i=e.length;r<i;r++){var a=e[r];void 0===n[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),t.push(n[a])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(e.type){case"Scene":r=new ka,void 0!==e.background&&Number.isInteger(e.background)&&(r.background=new Cn(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?r.fog=new Ba(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(r.fog=new Ia(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":r=new xa(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(r.focus=e.focus),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.filmGauge&&(r.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(r.filmOffset=e.filmOffset),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"OrthographicCamera":r=new Sc(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"AmbientLight":r=new Rc(e.color,e.intensity);break;case"DirectionalLight":r=new Cc(e.color,e.intensity);break;case"PointLight":r=new _c(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":r=new Pc(e.color,e.intensity,e.width,e.height);break;case"SpotLight":r=new Tc(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":r=new Ec(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var o=i(e.geometry),s=a(e.material);r=o.bones&&o.bones.length>0?new Va(o,s):new Pr(o,s),void 0!==e.drawMode&&r.setDrawMode(e.drawMode);break;case"LOD":r=new za;break;case"Line":r=new qa(i(e.geometry),a(e.material),e.mode);break;case"LineLoop":r=new Ya(i(e.geometry),a(e.material));break;case"LineSegments":r=new Xa(i(e.geometry),a(e.material));break;case"PointCloud":case"Points":r=new Ja(i(e.geometry),a(e.material));break;case"Sprite":r=new Ua(a(e.material));break;case"Group":r=new ya;break;default:r=new Gn}if(r.uuid=e.uuid,void 0!==e.name&&(r.name=e.name),void 0!==e.matrix?(r.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(r.matrixAutoUpdate=e.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==e.position&&r.position.fromArray(e.position),void 0!==e.rotation&&r.rotation.fromArray(e.rotation),void 0!==e.quaternion&&r.quaternion.fromArray(e.quaternion),void 0!==e.scale&&r.scale.fromArray(e.scale)),void 0!==e.castShadow&&(r.castShadow=e.castShadow),void 0!==e.receiveShadow&&(r.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(r.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(r.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&r.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(r.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.frustumCulled&&(r.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(r.renderOrder=e.renderOrder),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.layers&&(r.layers.mask=e.layers),void 0!==e.children)for(var c=e.children,l=0;l<c.length;l++)r.add(this.parseObject(c[l],t,n));if("LOD"===e.type)for(var u=e.levels,h=0;h<u.length;h++){var d=u[h],p=r.getObjectByProperty("uuid",d.object);void 0!==p&&r.addLevel(p,d.distance)}return r}});var Fc,Uc,zc,Vc,jc,Gc={UVMapping:he,CubeReflectionMapping:de,CubeRefractionMapping:pe,EquirectangularReflectionMapping:fe,EquirectangularRefractionMapping:me,SphericalReflectionMapping:ge,CubeUVReflectionMapping:ve,CubeUVRefractionMapping:ye},Wc={RepeatWrapping:be,ClampToEdgeWrapping:xe,MirroredRepeatWrapping:we},qc={NearestFilter:Ee,NearestMipMapNearestFilter:Me,NearestMipMapLinearFilter:Ae,LinearFilter:Te,LinearMipMapNearestFilter:_e,LinearMipMapLinearFilter:Se};function Xc(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==e?e:js,this.options=void 0}function Yc(){this.type="ShapePath",this.color=new Cn,this.subPaths=[],this.currentPath=null}function Kc(e){this.type="Font",this.data=e}function Jc(e,t,n,r,i){var a=i.glyphs[e]||i.glyphs["?"];if(a){var o,s,c,l,u,h,d,p,f=new Yc;if(a.o)for(var m=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),g=0,v=m.length;g<v;){switch(m[g++]){case"m":o=m[g++]*t+n,s=m[g++]*t+r,f.moveTo(o,s);break;case"l":o=m[g++]*t+n,s=m[g++]*t+r,f.lineTo(o,s);break;case"q":c=m[g++]*t+n,l=m[g++]*t+r,u=m[g++]*t+n,h=m[g++]*t+r,f.quadraticCurveTo(u,h,c,l);break;case"b":c=m[g++]*t+n,l=m[g++]*t+r,u=m[g++]*t+n,h=m[g++]*t+r,d=m[g++]*t+n,p=m[g++]*t+r,f.bezierCurveTo(u,h,d,p,c,l)}}return{offsetX:a.ha*t,path:f}}}function Zc(e){this.manager=void 0!==e?e:js}function Qc(){}Xc.prototype={constructor:Xc,setOptions:function(e){return this.options=e,this},load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=zs.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;fetch(e).then((function(e){return e.blob()})).then((function(e){return void 0===i.options?createImageBitmap(e):createImageBitmap(e,i.options)})).then((function(n){zs.add(e,n),t&&t(n),i.manager.itemEnd(e)})).catch((function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)},setCrossOrigin:function(){return this},setPath:function(e){return this.path=e,this}},Object.assign(Yc.prototype,{moveTo:function(e,t){this.currentPath=new bc,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,n,r){this.currentPath.quadraticCurveTo(e,t,n,r)},bezierCurveTo:function(e,t,n,r,i,a){this.currentPath.bezierCurveTo(e,t,n,r,i,a)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],a=new xc;a.curves=i.curves,t.push(a)}return t}function r(e,t){for(var n=t.length,r=!1,i=n-1,a=0;a<n;i=a++){var o=t[i],s=t[a],c=s.x-o.x,l=s.y-o.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(o=t[a],c=-c,s=t[i],l=-l),e.y<o.y||e.y>s.y)continue;if(e.y===o.y){if(e.x===o.x)return!0}else{var u=l*(e.x-o.x)-c*(e.y-o.y);if(0===u)return!0;if(u<0)continue;r=!r}}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return!0}}return r}var i=jo.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===t)return n(a);var o,s,c,l=[];if(1===a.length)return s=a[0],(c=new xc).curves=s.curves,l.push(c),l;var u=!i(a[0].getPoints());u=e?!u:u;var h,d,p=[],f=[],m=[],g=0;f[g]=void 0,m[g]=[];for(var v=0,y=a.length;v<y;v++)o=i(h=(s=a[v]).getPoints()),(o=e?!o:o)?(!u&&f[g]&&g++,f[g]={s:new xc,p:h},f[g].s.curves=s.curves,u&&g++,m[g]=[]):m[g].push({h:s,p:h[0]});if(!f[0])return n(a);if(f.length>1){for(var b=!1,x=[],w=0,E=f.length;w<E;w++)p[w]=[];for(w=0,E=f.length;w<E;w++)for(var M=m[w],A=0;A<M.length;A++){for(var T=M[A],_=!0,S=0;S<f.length;S++)r(T.p,f[S].p)&&(w!==S&&x.push({froms:w,tos:S,hole:A}),_?(_=!1,p[S].push(T)):b=!0);_&&p[w].push(T)}x.length>0&&(b||(m=p))}v=0;for(var L=f.length;v<L;v++){c=f[v].s,l.push(c);for(var C=0,R=(d=m[v]).length;C<R;C++)c.holes.push(d[C].h)}return l}}),Object.assign(Kc.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);for(var n=[],r=function(e,t,n){for(var r=Array.from?Array.from(e):String(e).split(""),i=t/n.resolution,a=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,o=[],s=0,c=0,l=0;l<r.length;l++){var u=r[l];if("\n"===u)s=0,c-=a;else{var h=Jc(u,i,s,c,n);s+=h.offsetX,o.push(h.path)}}return o}(e,t,this.data),i=0,a=r.length;i<a;i++)Array.prototype.push.apply(n,r[i].toShapes());return n}}),Object.assign(Zc.prototype,{load:function(e,t,n,r){var i=this,a=new Ws(this.manager);a.setPath(this.path),a.load(e,(function(e){var n;try{n=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}var r=i.parse(n);t&&t(r)}),n,r)},parse:function(e){return new Kc(e)},setPath:function(e){return this.path=e,this}}),Qc.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,n=0,r=t.length;n<r;n+=2){var i=t[n],a=t[n+1];if(i.test(e))return a}return null}},Object.assign(Qc.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(e,t,n){for(var r=[],i=0;i<e.length;++i)r[i]=this.createMaterial(e[i],t,n);return r},createMaterial:(Fc={NoBlending:_,NormalBlending:S,AdditiveBlending:L,SubtractiveBlending:C,MultiplyBlending:R,CustomBlending:P},Uc=new Cn,zc=new Zs,Vc=new Oc,function(e,t,n){var r={};function i(e,i,a,o,s){var c,l=t+e,u=Qc.Handlers.get(l);null!==u?c=u.load(l):(zc.setCrossOrigin(n),c=zc.load(l)),void 0!==i&&(c.repeat.fromArray(i),1!==i[0]&&(c.wrapS=be),1!==i[1]&&(c.wrapT=be)),void 0!==a&&c.offset.fromArray(a),void 0!==o&&("repeat"===o[0]&&(c.wrapS=be),"mirror"===o[0]&&(c.wrapS=we),"repeat"===o[1]&&(c.wrapT=be),"mirror"===o[1]&&(c.wrapT=we)),void 0!==s&&(c.anisotropy=s);var h=Vt.generateUUID();return r[h]=c,h}var a={uuid:Vt.generateUUID(),type:"MeshLambertMaterial"};for(var o in e){var s=e[o];switch(o){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":a.name=s;break;case"blending":a.blending=Fc[s];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",o,"is no longer supported.");break;case"colorDiffuse":a.color=Uc.fromArray(s).getHex();break;case"colorSpecular":a.specular=Uc.fromArray(s).getHex();break;case"colorEmissive":a.emissive=Uc.fromArray(s).getHex();break;case"specularCoef":a.shininess=s;break;case"shading":"basic"===s.toLowerCase()&&(a.type="MeshBasicMaterial"),"phong"===s.toLowerCase()&&(a.type="MeshPhongMaterial"),"standard"===s.toLowerCase()&&(a.type="MeshStandardMaterial");break;case"mapDiffuse":a.map=i(s,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":a.emissiveMap=i(s,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":a.lightMap=i(s,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":a.aoMap=i(s,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,e.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":a.bumpMap=i(s,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case"mapBumpScale":a.bumpScale=s;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":a.normalMap=i(s,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case"mapNormalFactor":a.normalScale=s;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":a.specularMap=i(s,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":a.metalnessMap=i(s,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":a.roughnessMap=i(s,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":a.alphaMap=i(s,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":a.side=b;break;case"doubleSided":a.side=x;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),a.opacity=s;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":a[o]=s;break;case"vertexColors":!0===s&&(a.vertexColors=T),"face"===s&&(a.vertexColors=A);break;default:console.error("THREE.Loader.createMaterial: Unsupported",o,s)}}return"MeshBasicMaterial"===a.type&&delete a.emissive,"MeshPhongMaterial"!==a.type&&delete a.specular,a.opacity<1&&(a.transparent=!0),Vc.setTextures(r),Vc.parse(a)})});var $c={getContext:function(){return void 0===jc&&(jc=new(window.AudioContext||window.webkitAudioContext)),jc},setContext:function(e){jc=e}};function el(e){this.manager=void 0!==e?e:js}function tl(){this.coefficients=[];for(var e=0;e<9;e++)this.coefficients.push(new Wt)}function nl(e,t){wc.call(this,void 0,t),this.sh=void 0!==e?e:new tl}function rl(e,t,n){nl.call(this,void 0,n);var r=(new Cn).set(e),i=(new Cn).set(t),a=new Wt(r.r,r.g,r.b),o=new Wt(i.r,i.g,i.b),s=Math.sqrt(Math.PI),c=s*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(o).multiplyScalar(s),this.sh.coefficients[1].copy(a).sub(o).multiplyScalar(c)}function il(e,t){nl.call(this,void 0,t);var n=(new Cn).set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}function al(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new xa,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new xa,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}Object.assign(el.prototype,{load:function(e,t,n,r){var i=new Ws(this.manager);i.setResponseType("arraybuffer"),i.setPath(this.path),i.load(e,(function(e){var n=e.slice(0);$c.getContext().decodeAudioData(n,(function(e){t(e)}))}),n,r)},setPath:function(e){return this.path=e,this}}),Object.assign(tl.prototype,{isSphericalHarmonics3:!0,set:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this},zero:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,t){var n=e.x,r=e.y,i=e.z,a=this.coefficients;return t=.282095*a[0],t+=.488603*a[1]*r,t+=.488603*a[2]*i,t+=.488603*a[3]*n,t+=1.092548*a[4]*(n*r),t+=1.092548*a[5]*(r*i),t+=.315392*a[6]*(3*i*i-1),t+=1.092548*a[7]*(n*i),t+=.546274*a[8]*(n*n-r*r)},getIrradianceAt:function(e,t){var n=e.x,r=e.y,i=e.z,a=this.coefficients;return t=.886227*a[0],t+=2*a[1]*.511664*r,t+=2*a[2]*.511664*i,t+=2*a[3]*.511664*n,t+=2*a[4]*.429043*n*r,t+=2*a[5]*.429043*r*i,t+=a[6]*(.743125*i*i-.247708),t+=2*a[7]*.429043*n*i,t+=.429043*a[8]*(n*n-r*r)},add:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this},scale:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this},lerp:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this},equals:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(e){for(var t=this.coefficients,n=0;n<9;n++)t[n].fromArray(e,3*n);return this},toArray:function(){for(var e=[],t=this.coefficients,n=0;n<9;n++)t[n].toArray(e,3*n);return e}}),Object.assign(tl,{getBasisAt:function(e,t){var n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}),nl.prototype=Object.assign(Object.create(wc.prototype),{constructor:nl,isLightProbe:!0,copy:function(e){return wc.prototype.copy.call(this,e),this.sh.copy(e.sh),this.intensity=e.intensity,this},toJSON:function(e){return wc.prototype.toJSON.call(this,e)}}),rl.prototype=Object.assign(Object.create(nl.prototype),{constructor:rl,isHemisphereLightProbe:!0,copy:function(e){return nl.prototype.copy.call(this,e),this},toJSON:function(e){return nl.prototype.toJSON.call(this,e)}}),il.prototype=Object.assign(Object.create(nl.prototype),{constructor:il,isAmbientLightProbe:!0,copy:function(e){return nl.prototype.copy.call(this,e),this},toJSON:function(e){return nl.prototype.toJSON.call(this,e)}}),Object.assign(al.prototype,{update:function(){var e,t,n,r,i,a,o,s,c=new xn,l=new xn;return function(u){if(e!==this||t!==u.focus||n!==u.fov||r!==u.aspect*this.aspect||i!==u.near||a!==u.far||o!==u.zoom||s!==this.eyeSep){e=this,t=u.focus,n=u.fov,r=u.aspect*this.aspect,i=u.near,a=u.far,o=u.zoom;var h,d,p=u.projectionMatrix.clone(),f=(s=this.eyeSep/2)*i/t,m=i*Math.tan(Vt.DEG2RAD*n*.5)/o;l.elements[12]=-s,c.elements[12]=s,h=-m*r+f,d=m*r+f,p.elements[0]=2*i/(d-h),p.elements[8]=(d+h)/(d-h),this.cameraL.projectionMatrix.copy(p),h=-m*r-f,d=m*r-f,p.elements[0]=2*i/(d-h),p.elements[8]=(d+h)/(d-h),this.cameraR.projectionMatrix.copy(p)}this.cameraL.matrixWorld.copy(u.matrixWorld).multiply(l),this.cameraR.matrixWorld.copy(u.matrixWorld).multiply(c)}}()});function ol(e,t,n,r){Gn.call(this),this.type="CubeCamera";var i=new xa(90,1,e,t);i.up.set(0,-1,0),i.lookAt(new Wt(1,0,0)),this.add(i);var a=new xa(90,1,e,t);a.up.set(0,-1,0),a.lookAt(new Wt(-1,0,0)),this.add(a);var o=new xa(90,1,e,t);o.up.set(0,0,1),o.lookAt(new Wt(0,1,0)),this.add(o);var s=new xa(90,1,e,t);s.up.set(0,0,-1),s.lookAt(new Wt(0,-1,0)),this.add(s);var c=new xa(90,1,e,t);c.up.set(0,-1,0),c.lookAt(new Wt(0,0,1)),this.add(c);var l=new xa(90,1,e,t);l.up.set(0,-1,0),l.lookAt(new Wt(0,0,-1)),this.add(l),r=r||{format:ze,magFilter:Te,minFilter:Te},this.renderTarget=new fn(n,n,r),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var n=e.getRenderTarget(),r=this.renderTarget,u=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,i),e.setRenderTarget(r,1),e.render(t,a),e.setRenderTarget(r,2),e.render(t,o),e.setRenderTarget(r,3),e.render(t,s),e.setRenderTarget(r,4),e.render(t,c),r.texture.generateMipmaps=u,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(n)},this.clear=function(e,t,n,r){for(var i=e.getRenderTarget(),a=this.renderTarget,o=0;o<6;o++)e.setRenderTarget(a,o),e.clear(t,n,r);e.setRenderTarget(i)}}function sl(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function cl(){Gn.call(this),this.type="AudioListener",this.context=$c.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0}function ll(e){Gn.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function ul(e){ll.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function hl(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function dl(e,t,n){this.binding=e,this.valueSize=n;var r,i=Float64Array;switch(t){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}ol.prototype=Object.create(Gn.prototype),ol.prototype.constructor=ol,Object.assign(sl.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}),cl.prototype=Object.assign(Object.create(Gn.prototype),{constructor:cl,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(){var e=new Wt,t=new Gt,n=new Wt,r=new Wt,i=new sl;return function(a){Gn.prototype.updateMatrixWorld.call(this,a);var o=this.context.listener,s=this.up;if(this.timeDelta=i.getDelta(),this.matrixWorld.decompose(e,t,n),r.set(0,0,-1).applyQuaternion(t),o.positionX){var c=this.context.currentTime+this.timeDelta;o.positionX.linearRampToValueAtTime(e.x,c),o.positionY.linearRampToValueAtTime(e.y,c),o.positionZ.linearRampToValueAtTime(e.z,c),o.forwardX.linearRampToValueAtTime(r.x,c),o.forwardY.linearRampToValueAtTime(r.y,c),o.forwardZ.linearRampToValueAtTime(r.z,c),o.upX.linearRampToValueAtTime(s.x,c),o.upY.linearRampToValueAtTime(s.y,c),o.upZ.linearRampToValueAtTime(s.z,c)}else o.setPosition(e.x,e.y,e.z),o.setOrientation(r.x,r.y,r.z,s.x,s.y,s.z)}}()}),ll.prototype=Object.assign(Object.create(Gn.prototype),{constructor:ll,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}),ul.prototype=Object.assign(Object.create(ll.prototype),{constructor:ul,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(){var e=new Wt,t=new Gt,n=new Wt,r=new Wt;return function(i){if(Gn.prototype.updateMatrixWorld.call(this,i),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(e,t,n),r.set(0,0,1).applyQuaternion(t);var a=this.panner;if(a.positionX){var o=this.context.currentTime+this.listener.timeDelta;a.positionX.linearRampToValueAtTime(e.x,o),a.positionY.linearRampToValueAtTime(e.y,o),a.positionZ.linearRampToValueAtTime(e.z,o),a.orientationX.linearRampToValueAtTime(r.x,o),a.orientationY.linearRampToValueAtTime(r.y,o),a.orientationZ.linearRampToValueAtTime(r.z,o)}else a.setPosition(e.x,e.y,e.z),a.setOrientation(r.x,r.y,r.z)}}}()}),Object.assign(hl.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}),Object.assign(dl.prototype,{accumulate:function(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==r;++o)n[i+o]=n[o];a=t}else{var s=t/(a+=t);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=a},apply:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,i<1){var o=3*t;this._mixBufferRegion(n,r,o,1-i,t)}for(var s=t,c=t+t;s!==c;++s)if(n[s]!==n[s+t]){a.setValue(n,r);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=3*n;e.getValue(t,r);for(var i=n,a=r;i!==a;++i)t[i]=t[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,n,r,i){if(r>=.5)for(var a=0;a!==i;++a)e[t+a]=e[n+a]},_slerp:function(e,t,n,r){Gt.slerpFlat(e,t,e,t,e,n,r)},_lerp:function(e,t,n,r,i){for(var a=1-r,o=0;o!==i;++o){var s=t+o;e[s]=e[s]*a+e[n+o]*r}}});var pl,fl,ml,gl,vl,yl,bl,xl,wl;function El(e,t,n){var r=n||Ml.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}function Ml(e,t,n){this.path=t,this.parsedPath=n||Ml.parseTrackName(t),this.node=Ml.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function Al(){this.uuid=Vt.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function Tl(e,t,n){this._mixer=e,this._clip=t,this._localRoot=n||null;for(var r=t.tracks,i=r.length,a=new Array(i),o={endingStart:At,endingEnd:At},s=0;s!==i;++s){var c=r[s].createInterpolant(null);a[s]=c,c.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=bt,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function _l(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Sl(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}Object.assign(El.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(Ml,{Composite:El,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new Ml.Composite(e,t,n):new Ml(e,t,n)},sanitizeNodeName:(wl=new RegExp("[\\[\\]\\.:\\/]","g"),function(e){return e.replace(/\s/g,"_").replace(wl,"")}),parseTrackName:(pl="[^\\[\\]\\.:\\/]",fl="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",ml=/((?:WC+[\/:])*)/.source.replace("WC",pl),gl=/(WCOD+)?/.source.replace("WCOD",fl),vl=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",pl),yl=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",pl),bl=new RegExp("^"+ml+gl+vl+yl+"$"),xl=["material","materials","bones"],function(e){var t=bl.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==xl.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}),findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function(e){for(var n=0;n<e.length;n++){var i=e[n];if(i.name===t||i.uuid===t)return i;var a=r(i.children);if(a)return a}return null},i=r(e.children);if(i)return i}return null}}),Object.assign(Ml.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,r=t.propertyName,i=t.propertyIndex;if(e||(e=Ml.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var a=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var o=0;o<e.length;o++)if(e[o].name===a){a=o;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==a){if(void 0===e[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[a]}}var s=e[r];if(void 0!==s){var c=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);var l=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(e.geometry.morphAttributes.position[o].name===i){i=o;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(o=0;o<this.node.geometry.morphTargets.length;o++)if(e.geometry.morphTargets[o].name===i){i=o;break}}}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}else{var u=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+r+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(Ml.prototype,{_getValue_unbound:Ml.prototype.getValue,_setValue_unbound:Ml.prototype.setValue}),Object.assign(Al.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,c=void 0,l=0,u=arguments.length;l!==u;++l){var h=arguments[l],d=h.uuid,p=r[d];if(void 0===p){p=t++,r[d]=p,e.push(h);for(var f=0,m=s;f!==m;++f)o[f].push(new Ml(h,i[f],a[f]))}else if(p<n){c=e[p];var g=--n,v=e[g];r[v.uuid]=p,e[p]=v,r[d]=g,e[g]=h;for(f=0,m=s;f!==m;++f){var y=o[f],b=y[g],x=y[p];y[p]=b,void 0===x&&(x=new Ml(h,i[f],a[f])),y[g]=x}}else e[p]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],c=s.uuid,l=n[c];if(void 0!==l&&l>=t){var u=t++,h=e[u];n[h.uuid]=l,e[l]=h,n[c]=u,e[u]=s;for(var d=0,p=i;d!==p;++d){var f=r[d],m=f[u],g=f[l];f[l]=m,f[u]=g}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,a=i.length,o=0,s=arguments.length;o!==s;++o){var c=arguments[o],l=c.uuid,u=r[l];if(void 0!==u)if(delete r[l],u<n){var h=--n,d=e[h],p=e[y=--t];r[d.uuid]=u,e[u]=d,r[p.uuid]=h,e[h]=p,e.pop();for(var f=0,m=a;f!==m;++f){var g=(b=i[f])[h],v=b[y];b[u]=g,b[h]=v,b.pop()}}else{var y;r[(p=e[y=--t]).uuid]=u,e[u]=p,e.pop();for(f=0,m=a;f!==m;++f){var b;(b=i[f])[u]=b[y],b.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];var a=this._paths,o=this._parsedPaths,s=this._objects,c=s.length,l=this.nCachedObjects_,u=new Array(c);r=i.length,n[e]=r,a.push(e),o.push(t),i.push(u);for(var h=l,d=s.length;h!==d;++h){var p=s[h];u[h]=new Ml(p,e,t)}return u},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var r=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];t[e[o]]=n,a[n]=s,a.pop(),i[n]=i[o],i.pop(),r[n]=r[o],r.pop()}}}),Object.assign(Tl.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,i=e._clip.duration,a=i/r,o=r/i;e.warp(1,a,t),this.warp(o,1,t)}return this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){var r=this._mixer,i=r.time,a=this._timeScaleInterpolant,o=this.timeScale;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,c=a.sampleValues;return s[0]=i,s[1]=i+n,c[0]=e/o,c[1]=t/o,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var a=(e-i)*n;if(a<0||0===n)return;this._startTime=null,t=n*a}t*=this._updateTimeScale(e);var o=this._updateTime(t),s=this._updateWeight(e);if(s>0)for(var c=this._interpolants,l=this._propertyBindings,u=0,h=c.length;u!==h;++u)c[u].evaluate(o),l[u].accumulate(r,s)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e,n=this._clip.duration,r=this.loop,i=this._loopCount,a=r===xt;if(0===e)return-1===i?t:a&&1==(1&i)?n-t:t;if(r===yt){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=n)t=n;else{if(!(t<0)){this.time=t;break e}t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),t>=n||t<0){var o=Math.floor(t/n);t-=n*o,i+=Math.abs(o);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?n:0,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var c=e<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=t,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=t;if(a&&1==(1&i))return n-t}return t},_setEndings:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=Tt,r.endingEnd=Tt):(r.endingStart=e?this.zeroSlopeAtStart?Tt:At:_t,r.endingEnd=t?this.zeroSlopeAtEnd?Tt:At:_t)},_scheduleFading:function(e,t,n){var r=this._mixer,i=r.time,a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=t,o[1]=i+e,s[1]=n,this}}),_l.prototype=Object.assign(Object.create(r.prototype),{constructor:_l,_bindAction:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,o=e._interpolants,s=n.uuid,c=this._bindingsByRootAndName,l=c[s];void 0===l&&(l={},c[s]=l);for(var u=0;u!==i;++u){var h=r[u],d=h.name,p=l[d];if(void 0!==p)a[u]=p;else{if(void 0!==(p=a[u])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,d));continue}var f=t&&t._propertyBindings[u].binding.parsedPath;++(p=new dl(Ml.create(n,d,f),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(p,s,d),a[u]=p}o[u].resultBuffer=p.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var i=e._propertyBindings,a=0,o=i.length;a!==o;++a){var s=i[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,n){var r=this._actions,i=this._actionsByClip,a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{var o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e},_removeInactiveAction:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,c=s[s.length-1],l=e._byClipCacheIndex;c._byClipCacheIndex=l,s[l]=c,s.pop(),e._byClipCacheIndex=null,delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete a[i],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackAction:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_addInactiveBinding:function(e,t,n){var r=this._bindingsByRootAndName,i=r[t],a=this._bindings;void 0===i&&(i={},r[t]=i),i[n]=e,e._cacheIndex=a.length,a.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,o=a[r],s=t[t.length-1],c=e._cacheIndex;s._cacheIndex=c,t[c]=s,t.pop(),delete o[i];e:{for(var l in o)break e;delete a[r]}},_lendBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new Cs(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=n),n},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?Fs.findByName(n,e):e,a=null!==i?i.uuid:e,o=this._actionsByClip[a],s=null;if(void 0!==o){var c=o.actionByRoot[r];if(void 0!==c)return c;s=o.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var l=new Tl(this,i,t);return this._bindAction(l,s),this._addInactiveAction(l,a,r),l},existingAction:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?Fs.findByName(n,e):e,a=i?i.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[r]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==t;++i)e[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1,o=0;o!==n;++o){t[o]._update(r,e,i,a)}var s=this._bindings,c=this._nActiveBindings;for(o=0;o!==c;++o)s[o].apply(a);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var a=i.knownActions,o=0,s=a.length;o!==s;++o){var c=a[o];this._deactivateAction(c);var l=c._cacheIndex,u=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,u._cacheIndex=l,t[l]=u,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[n]}},uncacheRoot:function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var a=this._bindingsByRootAndName[t];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),Sl.prototype.clone=function(){return new Sl(void 0===this.value.clone?this.value:this.value.clone())};var Ll,Cl,Rl,Pl,Ol,Dl,Il=0;function Bl(){Object.defineProperty(this,"id",{value:Il++}),this.name="",this.dynamic=!1,this.uniforms=[]}function kl(e){Bl.call(this),this.data=e,this.autoUpdate=!0,this.needsUpdate=!1}function Hl(e,t,n){Ha.call(this,e,t),this._meshPerAttribute=n||1,this.versionVAO=0}function Nl(e,t,n,r){this.ray=new Lr(e,t),this.near=n||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Fl(e,t){return e.distance-t.distance}function Ul(e,t,n,r){if(!1!==e.visible&&(e.raycast(t,n),!0===r))for(var i=e.children,a=0,o=i.length;a<o;a++)Ul(i[a],t,n,!0)}function zl(e,t,n){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==n?n:0,this}function Vl(e,t,n){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==n?n:0,this}function jl(e,t){this.min=void 0!==e?e:new jt(1/0,1/0),this.max=void 0!==t?t:new jt(-1/0,-1/0)}function Gl(e,t){this.start=void 0!==e?e:new Wt,this.end=void 0!==t?t:new Wt}function Wl(e){Gn.call(this),this.material=e,this.render=function(){}}function ql(e,t,n,r){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==n?n:16711680,a=void 0!==r?r:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=3*s.faces.length:s&&s.isBufferGeometry&&(o=s.attributes.normal.count);var c=new cr,l=new rr(2*o*3,3);c.addAttribute("position",l),Xa.call(this,c,new Wa({color:i,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function Xl(e,t){Gn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var n=new cr,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,a=1;i<32;i++,a++){var o=i/32*Math.PI*2,s=a/32*Math.PI*2;r.push(Math.cos(o),Math.sin(o),1,Math.cos(s),Math.sin(s),1)}n.addAttribute("position",new rr(r,3));var c=new Wa({fog:!1});this.cone=new Xa(n,c),this.add(this.cone),this.update()}function Yl(e){for(var t=function e(t){var n=[];t&&t.isBone&&n.push(t);for(var r=0;r<t.children.length;r++)n.push.apply(n,e(t.children[r]));return n}(e),n=new cr,r=[],i=[],a=new Cn(0,0,1),o=new Cn(0,1,0),s=0;s<t.length;s++){var c=t[s];c.parent&&c.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(a.r,a.g,a.b),i.push(o.r,o.g,o.b))}n.addAttribute("position",new rr(r,3)),n.addAttribute("color",new rr(i,3));var l=new Wa({vertexColors:T,depthTest:!1,depthWrite:!1,transparent:!0});Xa.call(this,n,l),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function Kl(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n;var r=new $o(t,4,2),i=new Rr({wireframe:!0,fog:!1});Pr.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Jl(e,t){this.type="RectAreaLightHelper",this.light=e,this.color=t;var n=new cr;n.addAttribute("position",new rr([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),n.computeBoundingSphere();var r=new Wa({fog:!1});qa.call(this,n,r);var i=new cr;i.addAttribute("position",new rr([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),i.computeBoundingSphere(),this.add(new Pr(i,new Rr({side:b,fog:!1}))),this.update()}function Zl(e,t,n){Gn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new lo(t);r.rotateY(.5*Math.PI),this.material=new Rr({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=T);var i=r.getAttribute("position"),a=new Float32Array(3*i.count);r.addAttribute("color",new Kn(a,3)),this.add(new Pr(r,this.material)),this.update()}function Ql(e,t){this.lightProbe=e,this.size=t;var n={GAMMA_OUTPUT:""},r=new Sr({defines:n,uniforms:{sh:{value:this.lightProbe.sh.coefficients},intensity:{value:this.lightProbe.intensity}},vertexShader:["varying vec3 vNormal;","void main() {","\tvNormal = normalize( normalMatrix * normal );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define RECIPROCAL_PI 0.318309886","vec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {","\t// matrix is assumed to be orthogonal","\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );","}","vec3 linearToOutput( in vec3 a ) {","\t#ifdef GAMMA_OUTPUT","\t\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );","\t#else","\t\treturn a;","\t#endif","}","// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf","vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {","\t// normal is assumed to have unit length","\tfloat x = normal.x, y = normal.y, z = normal.z;","\t// band 0","\tvec3 result = shCoefficients[ 0 ] * 0.886227;","\t// band 1","\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;","\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;","\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;","\t// band 2","\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;","\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;","\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );","\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;","\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );","\treturn result;","}","uniform vec3 sh[ 9 ]; // sh coefficients","uniform float intensity; // light probe intensity","varying vec3 vNormal;","void main() {","\tvec3 normal = normalize( vNormal );","\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );","\tvec3 irradiance = shGetIrradianceAt( worldNormal, sh );","\tvec3 outgoingLight = RECIPROCAL_PI * irradiance * intensity;","\toutgoingLight = linearToOutput( outgoingLight );","\tgl_FragColor = vec4( outgoingLight, 1.0 );","}"].join("\n")}),i=new $o(1,32,16);Pr.call(this,i,r),this.onBeforeRender()}function $l(e,t,n,r){e=e||10,t=t||10,n=new Cn(void 0!==n?n:4473924),r=new Cn(void 0!==r?r:8947848);for(var i=t/2,a=e/t,o=e/2,s=[],c=[],l=0,u=0,h=-o;l<=t;l++,h+=a){s.push(-o,0,h,o,0,h),s.push(h,0,-o,h,0,o);var d=l===i?n:r;d.toArray(c,u),u+=3,d.toArray(c,u),u+=3,d.toArray(c,u),u+=3,d.toArray(c,u),u+=3}var p=new cr;p.addAttribute("position",new rr(s,3)),p.addAttribute("color",new rr(c,3));var f=new Wa({vertexColors:T});Xa.call(this,p,f)}function eu(e,t,n,r,i,a){e=e||10,t=t||16,n=n||8,r=r||64,i=new Cn(void 0!==i?i:4473924),a=new Cn(void 0!==a?a:8947848);var o,s,c,l,u,h,d,p=[],f=[];for(l=0;l<=t;l++)c=l/t*(2*Math.PI),o=Math.sin(c)*e,s=Math.cos(c)*e,p.push(0,0,0),p.push(o,0,s),d=1&l?i:a,f.push(d.r,d.g,d.b),f.push(d.r,d.g,d.b);for(l=0;l<=n;l++)for(d=1&l?i:a,h=e-e/n*l,u=0;u<r;u++)c=u/r*(2*Math.PI),o=Math.sin(c)*h,s=Math.cos(c)*h,p.push(o,0,s),f.push(d.r,d.g,d.b),c=(u+1)/r*(2*Math.PI),o=Math.sin(c)*h,s=Math.cos(c)*h,p.push(o,0,s),f.push(d.r,d.g,d.b);var m=new cr;m.addAttribute("position",new rr(p,3)),m.addAttribute("color",new rr(f,3));var g=new Wa({vertexColors:T});Xa.call(this,m,g)}function tu(e,t,n,r){this.audio=e,this.range=t||1,this.divisionsInnerAngle=n||16,this.divisionsOuterAngle=r||2;var i=new cr,a=this.divisionsInnerAngle+2*this.divisionsOuterAngle,o=new Float32Array(3*(3*a+3));i.addAttribute("position",new Kn(o,3));var s=new Wa({color:65280}),c=new Wa({color:16776960});qa.call(this,i,[c,s]),this.update()}function nu(e,t,n,r){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==n?n:16776960,a=void 0!==r?r:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var c=new cr,l=new rr(2*o*3,3);c.addAttribute("position",l),Xa.call(this,c,new Wa({color:i,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function ru(e,t,n){Gn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);var r=new cr;r.addAttribute("position",new rr([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var i=new Wa({fog:!1});this.lightPlane=new qa(r,i),this.add(this.lightPlane),(r=new cr).addAttribute("position",new rr([0,0,0,0,0,1],3)),this.targetLine=new qa(r,i),this.add(this.targetLine),this.update()}function iu(e){var t=new cr,n=new Wa({color:16777215,vertexColors:A}),r=[],i=[],a={},o=new Cn(16755200),s=new Cn(16711680),c=new Cn(43775),l=new Cn(16777215),u=new Cn(3355443);function h(e,t,n){d(e,n),d(t,n)}function d(e,t){r.push(0,0,0),i.push(t.r,t.g,t.b),void 0===a[e]&&(a[e]=[]),a[e].push(r.length/3-1)}h("n1","n2",o),h("n2","n4",o),h("n4","n3",o),h("n3","n1",o),h("f1","f2",o),h("f2","f4",o),h("f4","f3",o),h("f3","f1",o),h("n1","f1",o),h("n2","f2",o),h("n3","f3",o),h("n4","f4",o),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",c),h("u2","u3",c),h("u3","u1",c),h("c","t",l),h("p","c",u),h("cn1","cn2",u),h("cn3","cn4",u),h("cf1","cf2",u),h("cf3","cf4",u),t.addAttribute("position",new rr(r,3)),t.addAttribute("color",new rr(i,3)),Xa.call(this,t,n),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function au(e,t){this.object=e,void 0===t&&(t=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new cr;i.setIndex(new Kn(n,1)),i.addAttribute("position",new Kn(r,3)),Xa.call(this,i,new Wa({color:t})),this.matrixAutoUpdate=!1,this.update()}function ou(e,t){this.type="Box3Helper",this.box=e;var n=void 0!==t?t:16776960,r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new cr;i.setIndex(new Kn(r,1)),i.addAttribute("position",new rr([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Xa.call(this,i,new Wa({color:n})),this.geometry.computeBoundingSphere()}function su(e,t,n){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var r=void 0!==n?n:16776960,i=new cr;i.addAttribute("position",new rr([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),qa.call(this,i,new Wa({color:r}));var a=new cr;a.addAttribute("position",new rr([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),a.computeBoundingSphere(),this.add(new Pr(a,new Rr({color:r,opacity:.2,transparent:!0,depthWrite:!1})))}function cu(e,t,n,r,i,a){Gn.call(this),void 0===e&&(e=new Wt(0,0,1)),void 0===t&&(t=new Wt(0,0,0)),void 0===n&&(n=1),void 0===r&&(r=16776960),void 0===i&&(i=.2*n),void 0===a&&(a=.2*i),void 0===Rl&&((Rl=new cr).addAttribute("position",new rr([0,0,0,0,1,0],3)),(Pl=new ls(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new qa(Rl,new Wa({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Pr(Pl,new Rr({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,a)}function lu(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new cr;n.addAttribute("position",new rr(t,3)),n.addAttribute("color",new rr([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var r=new Wa({vertexColors:T});Xa.call(this,n,r)}function uu(e,t,n,r,i,a,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Bn(e,t,n,i,a,o)}Bl.prototype=Object.assign(Object.create(r.prototype),{constructor:Bl,isUniformsGroup:!0,add:function(e){return this.uniforms.push(e),this},remove:function(e){var t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this},setName:function(e){return this.name=e,this},dispose:function(){return this.dispatchEvent({type:"dispose"}),this},copy:function(e){this.name=e.name,this.dynamic=e.dynamic;var t=e.uniforms;this.uniforms.length=0;for(var n=0,r=t.length;n<r;n++)this.uniforms.push(t[n].clone());return this},clone:function(){return(new this.constructor).copy(this)}}),kl.prototype=Object.assign(Object.create(Bl.prototype),{constructor:kl,isRawUniformsGroup:!0,add:function(e){return console.warn("THREE.RawUniformsGroup: .add() is unimplemented. Modify .data manually instead."),this},remove:function(e){return console.warn("THREE.RawUniformsGroup: .add() is unimplemented. Modify .data manually instead."),this},copy:function(e){return Bl.prototype.copy.call(this),this.autoUpdate=e.autoUpdate,this.data=e.data.slice(0),this}}),Hl.prototype=Object.assign(Object.create(Ha.prototype),{constructor:Hl,isInstancedInterleavedBuffer:!0,copy:function(e){return Ha.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.defineProperties(Hl.prototype,{meshPerAttribute:{get:function(){return this._meshPerAttribute},set:function(e){this._meshPerAttribute=e,this.versionVAO++}}}),Object.assign(Nl.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this._camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this._camera=t):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,n){var r=n||[];return Ul(e,this,r,t),r.sort(Fl),r},intersectObjects:function(e,t,n){var r=n||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,a=e.length;i<a;i++)Ul(e[i],this,r,t);return r.sort(Fl),r}}),Object.assign(zl.prototype,{set:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Vt.clamp(t/this.radius,-1,1))),this}}),Object.assign(Vl.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}}),Object.assign(jl.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new jt;return function(t,n){var r=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new jt),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new jt),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new jt),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new jt),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new jt;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(Gl.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new Wt),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new Wt),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new Wt),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:(Ll=new Wt,Cl=new Wt,function(e,t){Ll.subVectors(e,this.start),Cl.subVectors(this.end,this.start);var n=Cl.dot(Cl),r=Cl.dot(Ll)/n;return t&&(r=Vt.clamp(r,0,1)),r}),closestPointToPoint:function(e,t,n){var r=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Wt),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Wl.prototype=Object.create(Gn.prototype),Wl.prototype.constructor=Wl,Wl.prototype.isImmediateRenderObject=!0,ql.prototype=Object.create(Xa.prototype),ql.prototype.constructor=ql,ql.prototype.update=function(){var e=new Wt,t=new Wt,n=new qt;return function(){var r=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,a=this.geometry.attributes.position,o=this.object.geometry;if(o&&o.isGeometry)for(var s=o.vertices,c=o.faces,l=0,u=0,h=c.length;u<h;u++)for(var d=c[u],p=0,f=d.vertexNormals.length;p<f;p++){var m=s[d[r[p]]],g=d.vertexNormals[p];e.copy(m).applyMatrix4(i),t.copy(g).applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),a.setXYZ(l,e.x,e.y,e.z),l+=1,a.setXYZ(l,t.x,t.y,t.z),l+=1}else if(o&&o.isBufferGeometry){var v=o.attributes.position,y=o.attributes.normal;for(l=0,p=0,f=v.count;p<f;p++)e.set(v.getX(p),v.getY(p),v.getZ(p)).applyMatrix4(i),t.set(y.getX(p),y.getY(p),y.getZ(p)),t.applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),a.setXYZ(l,e.x,e.y,e.z),l+=1,a.setXYZ(l,t.x,t.y,t.z),l+=1}a.needsUpdate=!0}}(),Xl.prototype=Object.create(Gn.prototype),Xl.prototype.constructor=Xl,Xl.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Xl.prototype.update=function(){var e=new Wt;return function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,n=t*Math.tan(this.light.angle);this.cone.scale.set(n,n,t),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),Yl.prototype=Object.create(Xa.prototype),Yl.prototype.constructor=Yl,Yl.prototype.updateMatrixWorld=function(){var e=new Wt,t=new xn,n=new xn;return function(r){var i=this.bones,a=this.geometry,o=a.getAttribute("position");n.getInverse(this.root.matrixWorld);for(var s=0,c=0;s<i.length;s++){var l=i[s];l.parent&&l.parent.isBone&&(t.multiplyMatrices(n,l.matrixWorld),e.setFromMatrixPosition(t),o.setXYZ(c,e.x,e.y,e.z),t.multiplyMatrices(n,l.parent.matrixWorld),e.setFromMatrixPosition(t),o.setXYZ(c+1,e.x,e.y,e.z),c+=2)}a.getAttribute("position").needsUpdate=!0,Gn.prototype.updateMatrixWorld.call(this,r)}}(),Kl.prototype=Object.create(Pr.prototype),Kl.prototype.constructor=Kl,Kl.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Kl.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},Jl.prototype=Object.create(qa.prototype),Jl.prototype.constructor=Jl,Jl.prototype.update=function(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}},Jl.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()},Zl.prototype=Object.create(Gn.prototype),Zl.prototype.constructor=Zl,Zl.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Zl.prototype.update=function(){var e=new Wt,t=new Cn,n=new Cn;return function(){var r=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var i=r.geometry.getAttribute("color");t.copy(this.light.color),n.copy(this.light.groundColor);for(var a=0,o=i.count;a<o;a++){var s=a<o/2?t:n;i.setXYZ(a,s.r,s.g,s.b)}i.needsUpdate=!0}r.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),Ql.prototype=Object.create(Pr.prototype),Ql.prototype.constructor=Ql,Ql.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Ql.prototype.onBeforeRender=function(){this.position.copy(this.lightProbe.position),this.scale.set(1,1,1).multiplyScalar(this.size),this.material.uniforms.intensity.value=this.lightProbe.intensity},$l.prototype=Object.assign(Object.create(Xa.prototype),{constructor:$l,copy:function(e){return Xa.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return(new this.constructor).copy(this)}}),eu.prototype=Object.create(Xa.prototype),eu.prototype.constructor=eu,tu.prototype=Object.create(qa.prototype),tu.prototype.constructor=tu,tu.prototype.update=function(){var e,t,n=this.audio,r=this.range,i=this.divisionsInnerAngle,a=this.divisionsOuterAngle,o=Vt.degToRad(n.panner.coneInnerAngle),s=Vt.degToRad(n.panner.coneOuterAngle),c=o/2,l=s/2,u=0,h=0,d=this.geometry,p=d.attributes.position;function f(n,i,a,o){var s=(i-n)/a;for(p.setXYZ(u,0,0,0),h++,e=n;e<i;e+=s)t=u+h,p.setXYZ(t,Math.sin(e)*r,0,Math.cos(e)*r),p.setXYZ(t+1,Math.sin(Math.min(e+s,i))*r,0,Math.cos(Math.min(e+s,i))*r),p.setXYZ(t+2,0,0,0),h+=3;d.addGroup(u,h,o),u+=h,h=0}d.clearGroups(),f(-l,-c,a,0),f(-c,c,i,1),f(c,l,a,0),p.needsUpdate=!0,o===s&&(this.material[0].visible=!1)},tu.prototype.dispose=function(){this.geometry.dispose(),this.material[0].dispose(),this.material[1].dispose()},nu.prototype=Object.create(Xa.prototype),nu.prototype.constructor=nu,nu.prototype.update=function(){var e=new Wt,t=new Wt,n=new qt;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var r=this.object.matrixWorld,i=this.geometry.attributes.position,a=this.object.geometry,o=a.vertices,s=a.faces,c=0,l=0,u=s.length;l<u;l++){var h=s[l],d=h.normal;e.copy(o[h.a]).add(o[h.b]).add(o[h.c]).divideScalar(3).applyMatrix4(r),t.copy(d).applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),i.setXYZ(c,e.x,e.y,e.z),c+=1,i.setXYZ(c,t.x,t.y,t.z),c+=1}i.needsUpdate=!0}}(),ru.prototype=Object.create(Gn.prototype),ru.prototype.constructor=ru,ru.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},ru.prototype.update=function(){var e=new Wt,t=new Wt,n=new Wt;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(t,e),this.lightPlane.lookAt(t),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(t),this.targetLine.scale.z=n.length()}}(),iu.prototype=Object.create(Xa.prototype),iu.prototype.constructor=iu,iu.prototype.update=function(){var e,t,n=new Wt,r=new ba;function i(i,a,o,s){n.set(a,o,s).unproject(r);var c=t[i];if(void 0!==c)for(var l=e.getAttribute("position"),u=0,h=c.length;u<h;u++)l.setXYZ(c[u],n.x,n.y,n.z)}return function(){e=this.geometry,t=this.pointMap;r.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),i("c",0,0,-1),i("t",0,0,1),i("n1",-1,-1,-1),i("n2",1,-1,-1),i("n3",-1,1,-1),i("n4",1,1,-1),i("f1",-1,-1,1),i("f2",1,-1,1),i("f3",-1,1,1),i("f4",1,1,1),i("u1",.7,1.1,-1),i("u2",-.7,1.1,-1),i("u3",0,2,-1),i("cf1",-1,0,1),i("cf2",1,0,1),i("cf3",0,-1,1),i("cf4",0,1,1),i("cn1",-1,0,-1),i("cn2",1,0,-1),i("cn3",0,-1,-1),i("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),au.prototype=Object.create(Xa.prototype),au.prototype.constructor=au,au.prototype.update=function(){var e=new gn;return function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&e.setFromObject(this.object),!e.isEmpty()){var n=e.min,r=e.max,i=this.geometry.attributes.position,a=i.array;a[0]=r.x,a[1]=r.y,a[2]=r.z,a[3]=n.x,a[4]=r.y,a[5]=r.z,a[6]=n.x,a[7]=n.y,a[8]=r.z,a[9]=r.x,a[10]=n.y,a[11]=r.z,a[12]=r.x,a[13]=r.y,a[14]=n.z,a[15]=n.x,a[16]=r.y,a[17]=n.z,a[18]=n.x,a[19]=n.y,a[20]=n.z,a[21]=r.x,a[22]=n.y,a[23]=n.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),au.prototype.setFromObject=function(e){return this.object=e,this.update(),this},au.prototype.copy=function(e){return Xa.prototype.copy.call(this,e),this.object=e.object,this},au.prototype.clone=function(){return(new this.constructor).copy(this)},ou.prototype=Object.create(Xa.prototype),ou.prototype.constructor=ou,ou.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),Gn.prototype.updateMatrixWorld.call(this,e))},su.prototype=Object.create(qa.prototype),su.prototype.constructor=su,su.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?b:y,this.lookAt(this.plane.normal),Gn.prototype.updateMatrixWorld.call(this,e)},cu.prototype=Object.create(Gn.prototype),cu.prototype.constructor=cu,cu.prototype.setDirection=(Dl=new Wt,function(e){e.y>.99999?this.quaternion.set(0,0,0,1):e.y<-.99999?this.quaternion.set(1,0,0,0):(Dl.set(e.z,0,-e.x).normalize(),Ol=Math.acos(e.y),this.quaternion.setFromAxisAngle(Dl,Ol))}),cu.prototype.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},cu.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},cu.prototype.copy=function(e){return Gn.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},cu.prototype.clone=function(){return(new this.constructor).copy(this)},lu.prototype=Object.create(Xa.prototype),lu.prototype.constructor=lu;var hu=0,du=1;function pu(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function fu(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function mu(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Ja(e,t)}function gu(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Ua(e)}function vu(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Ja(e,t)}function yu(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Ka(e)}function bu(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Ka(e)}function xu(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Ka(e)}function wu(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Wt(e,t,n)}function Eu(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new Kn(e,t).setDynamic(!0)}function Mu(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Jn(e,t)}function Au(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Zn(e,t)}function Tu(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Qn(e,t)}function _u(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new $n(e,t)}function Su(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new er(e,t)}function Lu(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new tr(e,t)}function Cu(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new nr(e,t)}function Ru(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new rr(e,t)}function Pu(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new ir(e,t)}function Ou(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),oc.call(this,e),this.type="catmullrom",this.closed=!0}function Du(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),oc.call(this,e),this.type="catmullrom"}function Iu(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),oc.call(this,e),this.type="catmullrom"}function Bu(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new lu(e)}function ku(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new au(e,t)}function Hu(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Xa(new ss(e.geometry),new Wa({color:void 0!==t?t:16777215}))}function Nu(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Xa(new to(e.geometry),new Wa({color:void 0!==t?t:16777215}))}function Fu(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Ws(e)}function Uu(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Ys(e)}Qs.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(Qs.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(yc.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new Yn,n=0,r=e.length;n<r;n++){var i=e[n];t.vertices.push(new Wt(i.x,i.y,i.z||0))}return t}}),Object.assign(bc.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),Ou.prototype=Object.create(oc.prototype),Du.prototype=Object.create(oc.prototype),Iu.prototype=Object.create(oc.prototype),Object.assign(Iu.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),$l.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Yl.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Qc.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Dc.extractUrlBase(e)}}),Object.assign(Nc.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(jl.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(gn.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Gl.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(Vt,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Vt.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Vt.ceilPowerOfTwo(e)}}),Object.assign(qt.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(xn.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){var e;return function(){return void 0===e&&(e=new Wt),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),e.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,r,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,a)}}),yn.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Gt.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Lr.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(Cr.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(Cr,{barycoordFromPoint:function(e,t,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Cr.getBarycoord(e,t,n,r,i)},normal:function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Cr.getNormal(e,t,n,r)}}),Object.assign(xc.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new qo(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new is(this,e)}}),Object.assign(jt.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Wt.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(hn.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Yn.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(Gn.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(Gn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(za.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(ja.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Va.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Qs.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),xa.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(wc.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(Kn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(cr.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(cr.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.assign(Xo.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(Sl.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(fr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Cn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===w}}}),Object.defineProperties(bs.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Sr.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(Da.prototype,{clearTarget:function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")}}),Object.defineProperties(Da.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(pa.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(fn.prototype,{activeCubeFace:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeCubeFace has been removed. It is now the second parameter of WebGLRenderer.setRenderTarget().")}},activeMipMapLevel:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeMipMapLevel has been removed. It is now the third parameter of WebGLRenderer.setRenderTarget().")}}}),Object.defineProperties(dn.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(Pa.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}},userHeight:{set:function(){console.warn("THREE.WebVRManager: .userHeight has been removed.")}}}),ll.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new el).load(e,(function(e){t.setBuffer(e)})),this},hl.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},ol.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};var zu={merge:function(e,t,n){var r;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),r=t.matrix,t=t.geometry),e.merge(t,r,n)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}};function Vu(){console.error("THREE.CanvasRenderer has been removed")}function ju(){console.error("THREE.JSONLoader has been removed.")}cn.crossOrigin=void 0,cn.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new Zs;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,n,void 0,r);return t&&(a.mapping=t),a},cn.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new Js;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,n,void 0,r);return t&&(a.mapping=t),a},cn.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},cn.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var Gu={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};function Wu(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")}},54:function(e,t,n){var r=n(195).process,i=e.exports.geometries={},a=e.exports.geometryNames=[],o=n(19),s=e.exports.Geometry=function(){};s.prototype={schema:{},init:function(e){return this.geometry=new o.Geometry,this.geometry},update:function(e){}},e.exports.registerGeometry=function(e,t){var n,o={};if(Object.keys(t).forEach((function(e){o[e]={value:t[e],writable:!0}})),i[e])throw new Error("The geometry `"+e+"` has been already registered");return((n=function(){s.call(this)}).prototype=Object.create(s.prototype,o)).name=e,n.prototype.constructor=n,i[e]={Geometry:n,schema:r(n.prototype.schema)},a.push(e),n}},560:function(e,t,n){const r=n(13);function i(e){this.collisionConfiguration=null,this.dispatcher=null,this.broadphase=null,this.solver=null,this.physicsWorld=null,this.debugDrawer=null,this.object3Ds=new Map,this.collisions=new Map,this.collisionKeys=[],this.epsilon=e.epsilon||1e-5,this.debugDrawMode=e.debugDrawMode||THREE.AmmoDebugConstants.NoDebug,this.maxSubSteps=e.maxSubSteps||4,this.fixedTimeStep=e.fixedTimeStep||1/60,this.collisionConfiguration=new Ammo.btDefaultCollisionConfiguration,this.dispatcher=new Ammo.btCollisionDispatcher(this.collisionConfiguration),this.broadphase=new Ammo.btDbvtBroadphase,this.solver=new Ammo.btSequentialImpulseConstraintSolver,this.physicsWorld=new Ammo.btDiscreteDynamicsWorld(this.dispatcher,this.broadphase,this.solver,this.collisionConfiguration),this.physicsWorld.setForceUpdateAllAabbs(!1);const t=new Ammo.btVector3(0,r.GRAVITY,0);e.hasOwnProperty("gravity")&&t.setValue(e.gravity.x,e.gravity.y,e.gravity.z),this.physicsWorld.setGravity(t),Ammo.destroy(t),this.physicsWorld.getSolverInfo().set_m_numIterations(e.solverIterations||10)}i.prototype.isDebugEnabled=function(){return this.debugDrawMode!==THREE.AmmoDebugConstants.NoDebug},i.prototype.addBody=function(e,t,n,r){this.physicsWorld.addRigidBody(e,n,r),this.object3Ds.set(Ammo.getPointer(e),t)},i.prototype.removeBody=function(e){this.physicsWorld.removeRigidBody(e);const t=Ammo.getPointer(e);this.object3Ds.delete(t),this.collisions.delete(t),-1!==this.collisionKeys.indexOf(t)&&this.collisionKeys.splice(this.collisionKeys.indexOf(t),1)},i.prototype.updateBody=function(e){this.object3Ds.has(Ammo.getPointer(e))&&this.physicsWorld.updateSingleAabb(e)},i.prototype.step=function(e){this.physicsWorld.stepSimulation(e,this.maxSubSteps,this.fixedTimeStep);for(let e=0;e<this.collisionKeys.length;e++)this.collisions.get(this.collisionKeys[e]).length=0;const t=this.dispatcher.getNumManifolds();for(let e=0;e<t;e++){const t=this.dispatcher.getManifoldByIndexInternal(e),n=t.getNumContacts(),r=Ammo.getPointer(t.getBody0()),i=Ammo.getPointer(t.getBody1());for(let e=0;e<n;e++){if(t.getContactPoint(e).getDistance()<=this.epsilon){this.collisions.has(r)||(this.collisions.set(r,[]),this.collisionKeys.push(r)),-1===this.collisions.get(r).indexOf(i)&&this.collisions.get(r).push(i);break}}}this.debugDrawer&&this.debugDrawer.update()},i.prototype.destroy=function(){Ammo.destroy(this.collisionConfiguration),Ammo.destroy(this.dispatcher),Ammo.destroy(this.broadphase),Ammo.destroy(this.solver),Ammo.destroy(this.physicsWorld),Ammo.destroy(this.debugDrawer)},i.prototype.getDebugDrawer=function(e,t){return this.debugDrawer||((t=t||{}).debugDrawMode=t.debugDrawMode||this.debugDrawMode,this.debugDrawer=new THREE.AmmoDebugDrawer(e,this.physicsWorld,t)),this.debugDrawer},e.exports=i},561:function(e,t,n){n(418),n(313);const r=n(13),i=r.ACTIVATION_STATE,a=r.COLLISION_FLAG,o=r.SHAPE,s=r.TYPE,c=(r.FIT,[i.ACTIVE_TAG,i.ISLAND_SLEEPING,i.WANTS_DEACTIVATION,i.DISABLE_DEACTIVATION,i.DISABLE_SIMULATION]),l=0,u=1;function h(e,t,n){return Math.abs(t.x-n.x)<e&&Math.abs(t.y-n.y)<e&&Math.abs(t.z-n.z)<e}function d(e,t,n){return Math.abs(t.x()-n.x())<e&&Math.abs(t.y()-n.y())<e&&Math.abs(t.z()-n.z())<e}function p(e,t,n){this.loadedEvent=e.loadedEvent?e.loadedEvent:"",this.mass=e.hasOwnProperty("mass")?e.mass:1;const r=n.physicsWorld.getGravity();this.gravity=new Ammo.btVector3(r.x(),r.y(),r.z()),e.gravity&&this.gravity.setValue(e.gravity.x,e.gravity.y,e.gravity.z),this.linearDamping=e.hasOwnProperty("linearDamping")?e.linearDamping:.01,this.angularDamping=e.hasOwnProperty("angularDamping")?e.angularDamping:.01,this.linearSleepingThreshold=e.hasOwnProperty("linearSleepingThreshold")?e.linearSleepingThreshold:1.6,this.angularSleepingThreshold=e.hasOwnProperty("angularSleepingThreshold")?e.angularSleepingThreshold:2.5,this.angularFactor=new THREE.Vector3(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.activationState=e.activationState&&-1!==c.indexOf(e.activationState)?e.activationState:i.ACTIVE_TAG,this.type=e.type?e.type:s.DYNAMIC,this.emitCollisionEvents=!!e.hasOwnProperty("emitCollisionEvents")&&e.emitCollisionEvents,this.disableCollision=!!e.hasOwnProperty("disableCollision")&&e.disableCollision,this.collisionFilterGroup=e.hasOwnProperty("collisionFilterGroup")?e.collisionFilterGroup:1,this.collisionFilterMask=e.hasOwnProperty("collisionFilterMask")?e.collisionFilterMask:1,this.scaleAutoUpdate=!e.hasOwnProperty("scaleAutoUpdate")||e.scaleAutoUpdate,this.object3D=t,this.world=n,this.shapes=[],this._initBody()}p.prototype._initBody=function(){const e=new THREE.Vector3,t=new THREE.Quaternion;new THREE.Box3;return function(){this.localScaling=new Ammo.btVector3;const n=this.object3D;n.getWorldPosition(e),n.getWorldQuaternion(t),this.prevScale=new THREE.Vector3(1,1,1),this.prevNumChildShapes=0,this.msTransform=new Ammo.btTransform,this.msTransform.setIdentity(),this.rotation=new Ammo.btQuaternion(t.x,t.y,t.z,t.w),this.msTransform.getOrigin().setValue(e.x,e.y,e.z),this.msTransform.setRotation(this.rotation),this.motionState=new Ammo.btDefaultMotionState(this.msTransform),this.localInertia=new Ammo.btVector3(0,0,0),this.compoundShape=new Ammo.btCompoundShape(!0),this.rbInfo=new Ammo.btRigidBodyConstructionInfo(this.mass,this.motionState,this.compoundShape,this.localInertia),this.physicsBody=new Ammo.btRigidBody(this.rbInfo),this.physicsBody.setActivationState(c.indexOf(this.activationState)+1),this.physicsBody.setSleepingThresholds(this.linearSleepingThreshold,this.angularSleepingThreshold),this.physicsBody.setDamping(this.linearDamping,this.angularDamping);const r=new Ammo.btVector3(this.angularFactor.x,this.angularFactor.y,this.angularFactor.z);this.physicsBody.setAngularFactor(r),Ammo.destroy(r),d(.001,this.gravity,this.world.physicsWorld.getGravity())||(this.physicsBody.setGravity(this.gravity),this.physicsBody.setFlags(u)),this.updateCollisionFlags(),this.world.addBody(this.physicsBody,this.object3D,this.collisionFilterGroup,this.collisionFilterMask),this.emitCollisionEvents&&this.world.addEventListener(this.physicsBody)}}(),p.prototype.updateShapes=function(){const e=[o.HULL,o.HACD,o.VHACD];return function(){let t=!1;const n=this.object3D;if(this.scaleAutoUpdate&&this.prevScale&&!h(.001,n.scale,this.prevScale)&&(this.prevScale.copy(n.scale),t=!0,this.localScaling.setValue(this.prevScale.x,this.prevScale.y,this.prevScale.z),this.compoundShape.setLocalScaling(this.localScaling)),this.shapesChanged&&(this.shapesChanged=!1,t=!0,this.type===s.DYNAMIC&&this.updateMass(),this.world.updateBody(this.physicsBody)),this.world.isDebugEnabled()&&(t||!this.polyHedralFeaturesInitialized)){for(let t=0;t<this.shapes.length;t++){const n=this.shapes[t];-1!==e.indexOf(n.type)&&n.initializePolyhedralFeatures(0)}this.polyHedralFeaturesInitialized=!0}}}(),p.prototype.update=function(e){if((e.type&&e.type!==this.type||e.disableCollision&&e.disableCollision!==this.disableCollision)&&(e.type&&(this.type=e.type),e.disableCollision&&(this.disableCollision=e.disableCollision),this.updateCollisionFlags()),e.activationState&&e.activationState!==this.activationState&&(this.activationState=e.activationState,this.physicsBody.forceActivationState(c.indexOf(this.activationState)+1),this.activationState===i.ACTIVE_TAG&&this.physicsBody.activate(!0)),e.collisionFilterGroup&&e.collisionFilterGroup!==this.collisionFilterGroup||e.collisionFilterMask&&e.collisionFilterMask!==this.collisionFilterMask){e.collisionFilterGroup&&(this.collisionFilterGroup=e.collisionFilterGroup),e.collisionFilterMask&&(this.collisionFilterMask=e.collisionFilterMask);const t=this.physicsBody.getBroadphaseProxy();t.set_m_collisionFilterGroup(this.collisionFilterGroup),t.set_m_collisionFilterMask(this.collisionFilterMask),this.world.broadphase.getOverlappingPairCache().removeOverlappingPairsContainingProxy(t,this.world.dispatcher)}if((e.linearDamping&&e.linearDamping!=this.linearDamping||e.angularDamping&&e.angularDamping!=this.angularDamping)&&(e.linearDamping&&(this.linearDamping=e.linearDamping),e.angularDamping&&(this.angularDamping=e.angularDamping),this.physicsBody.setDamping(this.linearDamping,this.angularDamping)),e.gravity&&(this.gravity.setValue(e.gravity.x,e.gravity.y,e.gravity.z),d(.001,this.gravity,this.physicsBody.getGravity())||(d(.001,this.gravity,this.world.physicsWorld.getGravity())?this.physicsBody.setFlags(l):this.physicsBody.setFlags(u),this.physicsBody.setGravity(this.gravity))),(e.linearSleepingThreshold&&e.linearSleepingThreshold!=this.linearSleepingThreshold||e.angularSleepingThreshold&&e.angularSleepingThreshold!=this.angularSleepingThreshold)&&(e.linearSleepingThreshold&&(this.linearSleepingThreshold=e.linearSleepingThreshold),e.angularSleepingThreshold&&(this.angularSleepingThreshold=e.angularSleepingThreshold),this.physicsBody.setSleepingThresholds(this.linearSleepingThreshold,this.angularSleepingThreshold)),e.angularFactor&&!h(.001,e.angularFactor,this.angularFactor)){this.angularFactor.copy(e.angularFactor);const t=new Ammo.btVector3(this.angularFactor.x,this.angularFactor.y,this.angularFactor.z);this.physicsBody.setAngularFactor(t),Ammo.destroy(t)}},p.prototype.destroy=function(){this.triMesh&&Ammo.destroy(this.triMesh),this.localScaling&&Ammo.destroy(this.localScaling);for(let e=0;e<this.shapes.length;e++)this.compoundShape.removeChildShape([e]);this.compoundShape&&Ammo.destroy(this.compoundShape),this.world.removeBody(this.physicsBody),Ammo.destroy(this.physicsBody),delete this.physicsBody,Ammo.destroy(this.rbInfo),Ammo.destroy(this.msTransform),Ammo.destroy(this.motionState),Ammo.destroy(this.localInertia),Ammo.destroy(this.rotation),Ammo.destroy(this.gravity)},p.prototype.syncToPhysics=function(){const e=new THREE.Quaternion,t=new THREE.Vector3,n=new THREE.Vector3,r=new THREE.Vector3;return function(i){if(!this.physicsBody)return;this.motionState.getWorldTransform(this.msTransform),this.object3D.getWorldPosition(t),this.object3D.getWorldQuaternion(e);const a=this.msTransform.getOrigin();r.set(a.x(),a.y(),a.z());const o=this.msTransform.getRotation();n.set(o.x(),o.y(),o.z(),o.w()),h(.001,t,r)&&function(e,t,n){return Math.abs(t.x-n.x)<e&&Math.abs(t.y-n.y)<e&&Math.abs(t.z-n.z)<e&&Math.abs(t.w-n.w)<e||Math.abs(t.x+n.x)<e&&Math.abs(t.y+n.y)<e&&Math.abs(t.z+n.z)<e&&Math.abs(t.w+n.w)<e}(.001,e,n)||(this.physicsBody.isActive()||this.physicsBody.activate(!0),this.msTransform.getOrigin().setValue(t.x,t.y,t.z),this.rotation.setValue(e.x,e.y,e.z,e.w),this.msTransform.setRotation(this.rotation),this.motionState.setWorldTransform(this.msTransform),(this.type===s.STATIC||i)&&this.physicsBody.setCenterOfMassTransform(this.msTransform))}}(),p.prototype.syncFromPhysics=function(){const e=new THREE.Vector3,t=new THREE.Quaternion,n=new THREE.Quaternion;return function(){this.motionState.getWorldTransform(this.msTransform);const r=this.msTransform.getOrigin(),i=this.msTransform.getRotation();this.physicsBody&&(t.set(i.x(),i.y(),i.z(),i.w()),this.object3D.parent.getWorldQuaternion(n),t.multiply(n.inverse()),this.object3D.quaternion.copy(t),e.set(r.x(),r.y(),r.z()),this.object3D.parent.worldToLocal(e),this.object3D.position.copy(e))}}(),p.prototype.addShape=function(e){e.type!==o.MESH||this.type===s.STATIC?(this.shapes.push(e),this.compoundShape.addChildShape(e.localTransform,e),this.shapesChanged=!0,this.updateShapes()):console.warn("non-static mesh colliders not supported")},p.prototype.removeShape=function(e){const t=this.shapes.indexOf(e);this.compoundShape&&-1!==t&&(this.compoundShape.removeChildShape(this.shapes[t]),this.shapesChanged=!0,this.shapes.splice(t,1),this.updateShapes())},p.prototype.updateMass=function(){const e=this.physicsBody.getCollisionShape(),t=this.type===s.STATIC?0:this.mass;e.calculateLocalInertia(t,this.localInertia),this.physicsBody.setMassProps(t,this.localInertia),this.physicsBody.updateInertiaTensor()},p.prototype.updateCollisionFlags=function(){let e=this.disableCollision?4:0;switch(this.type){case s.STATIC:e|=a.STATIC_OBJECT;break;case s.KINEMATIC:e|=a.KINEMATIC_OBJECT;break;default:this.physicsBody.applyGravity()}this.physicsBody.setCollisionFlags(e),this.updateMass(),this.world.updateBody(this.physicsBody)},p.prototype.getVelocity=function(){return this.physicsBody.getLinearVelocity()},e.exports=p},562:function(e,t,n){const r=n(13).CONSTRAINT,i=[r.LOCK,r.FIXED,r.SPRING,r.SLIDER,r.HINGE,r.CONE_TWIST,r.POINT_TO_POINT];function a(e,t,n,a){this.physicsConstraint,this.world=a;const o=e.type&&i.indexOf(e.type)?e.type:r.LOCK,s=t.physicsBody.getCenterOfMassTransform().inverse().op_mul(n.physicsBody.getWorldTransform()),c=new Ammo.btTransform;switch(c.setIdentity(),o){case r.LOCK:{this.physicsConstraint=new Ammo.btGeneric6DofConstraint(t.physicsBody,n.physicsBody,s,c,!0);const e=new Ammo.btVector3(0,0,0);this.physicsConstraint.setLinearLowerLimit(e),this.physicsConstraint.setLinearUpperLimit(e),this.physicsConstraint.setAngularLowerLimit(e),this.physicsConstraint.setAngularUpperLimit(e),Ammo.destroy(e);break}case r.FIXED:s.setRotation(t.physicsBody.getWorldTransform().getRotation()),c.setRotation(n.physicsBody.getWorldTransform().getRotation()),this.physicsConstraint=new Ammo.btFixedConstraint(t.physicsBody,n.physicsBody,s,c);break;case r.SPRING:this.physicsConstraint=new Ammo.btGeneric6DofSpringConstraint(t.physicsBody,n.physicsBody,s,c,!0);break;case r.SLIDER:this.physicsConstraint=new Ammo.btSliderConstraint(t.physicsBody,n.physicsBody,s,c,!0),this.physicsConstraint.setLowerLinLimit(-1),this.physicsConstraint.setUpperLinLimit(1);break;case r.HINGE:{if(!e.pivot)throw new Error("pivot must be defined for type: hinge");if(!e.targetPivot)throw new Error("targetPivot must be defined for type: hinge");if(!e.axis)throw new Error("axis must be defined for type: hinge");if(!e.targetAxis)throw new Error("targetAxis must be defined for type: hinge");const r=new Ammo.btVector3(e.pivot.x,e.pivot.y,e.pivot.z),i=new Ammo.btVector3(e.targetPivot.x,e.targetPivot.y,e.targetPivot.z),a=new Ammo.btVector3(e.axis.x,e.axis.y,e.axis.z),o=new Ammo.btVector3(e.targetAxis.x,e.targetAxis.y,e.targetAxis.z);this.physicsConstraint=new Ammo.btHingeConstraint(t.physicsBody,n.physicsBody,r,i,a,o,!0),Ammo.destroy(r),Ammo.destroy(i),Ammo.destroy(a),Ammo.destroy(o);break}case r.CONE_TWIST:{if(!e.pivot)throw new Error("pivot must be defined for type: cone-twist");if(!e.targetPivot)throw new Error("targetPivot must be defined for type: cone-twist");const n=new Ammo.btTransform;n.setIdentity(),n.getOrigin().setValue(e.targetPivot.x,e.targetPivot.y,e.targetPivot.z),this.physicsConstraint=new Ammo.btConeTwistConstraint(t.physicsBody,n),Ammo.destroy(n);break}case r.POINT_TO_POINT:{if(!e.pivot)throw new Error("pivot must be defined for type: point-to-point");if(!e.targetPivot)throw new Error("targetPivot must be defined for type: point-to-point");const r=new Ammo.btVector3(e.pivot.x,e.pivot.y,e.pivot.z),i=new Ammo.btVector3(e.targetPivot.x,e.targetPivot.y,e.targetPivot.z);this.physicsConstraint=new Ammo.btPoint2PointConstraint(t.physicsBody,n.physicsBody,r,i),Ammo.destroy(r),Ammo.destroy(i);break}}Ammo.destroy(s),Ammo.destroy(c),this.world.physicsWorld.addConstraint(this.physicsConstraint,!1)}a.prototype.destroy=function(){this.physicsConstraint&&(this.world.physicsWorld.removeConstraint(this.physicsConstraint),Ammo.destroy(this.physicsConstraint),this.physicsConstraint=null)},e.exports=a},570:function(e,t,n){e.exports=function(){return n(225)('!function(r){var n={};function t(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return r[e].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=r,t.c=n,t.d=function(r,n,e){t.o(r,n)||Object.defineProperty(r,n,{enumerable:!0,get:e})},t.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},t.t=function(r,n){if(1&n&&(r=t(r)),8&n)return r;if(4&n&&"object"==typeof r&&r&&r.__esModule)return r;var e=Object.create(null);if(t.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:r}),2&n&&"string"!=typeof r)for(var a in r)t.d(e,a,function(n){return r[n]}.bind(null,a));return e},t.n=function(r){var n=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(n,"a",n),n},t.o=function(r,n){return Object.prototype.hasOwnProperty.call(r,n)},t.p="/custom-hubs-template/",t(t.s=3)}([function(r,n,t){"use strict";var e=t(4),a=t(7),o=[].slice,i=["keyword","gray","hex"],l={};Object.keys(a).forEach((function(r){l[o.call(a[r].labels).sort().join("")]=r}));var s={};function u(r,n){if(!(this instanceof u))return new u(r,n);if(n&&n in i&&(n=null),n&&!(n in a))throw new Error("Unknown model: "+n);var t,h;if(null==r)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(r instanceof u)this.model=r.model,this.color=r.color.slice(),this.valpha=r.valpha;else if("string"==typeof r){var c=e.get(r);if(null===c)throw new Error("Unable to parse color from string: "+r);this.model=c.model,h=a[this.model].channels,this.color=c.value.slice(0,h),this.valpha="number"==typeof c.value[h]?c.value[h]:1}else if(r.length){this.model=n||"rgb",h=a[this.model].channels;var f=o.call(r,0,h);this.color=g(f,h),this.valpha="number"==typeof r[h]?r[h]:1}else if("number"==typeof r)r&=16777215,this.model="rgb",this.color=[r>>16&255,r>>8&255,255&r],this.valpha=1;else{this.valpha=1;var b=Object.keys(r);"alpha"in r&&(b.splice(b.indexOf("alpha"),1),this.valpha="number"==typeof r.alpha?r.alpha:0);var p=b.sort().join("");if(!(p in l))throw new Error("Unable to parse color from object: "+JSON.stringify(r));this.model=l[p];var v=a[this.model].labels,d=[];for(t=0;t<v.length;t++)d.push(r[v[t]]);this.color=g(d)}if(s[this.model])for(h=a[this.model].channels,t=0;t<h;t++){var m=s[this.model][t];m&&(this.color[t]=m(this.color[t]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function h(r,n,t){return(r=Array.isArray(r)?r:[r]).forEach((function(r){(s[r]||(s[r]=[]))[n]=t})),r=r[0],function(e){var a;return arguments.length?(t&&(e=t(e)),(a=this[r]()).color[n]=e,a):(a=this[r]().color[n],t&&(a=t(a)),a)}}function c(r){return function(n){return Math.max(0,Math.min(r,n))}}function f(r){return Array.isArray(r)?r:[r]}function g(r,n){for(var t=0;t<n;t++)"number"!=typeof r[t]&&(r[t]=0);return r}u.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(r){var n=this.model in e.to?this:this.rgb(),t=1===(n=n.round("number"==typeof r?r:1)).valpha?n.color:n.color.concat(this.valpha);return e.to[n.model](t)},percentString:function(r){var n=this.rgb().round("number"==typeof r?r:1),t=1===n.valpha?n.color:n.color.concat(this.valpha);return e.to.rgb.percent(t)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var r={},n=a[this.model].channels,t=a[this.model].labels,e=0;e<n;e++)r[t[e]]=this.color[e];return 1!==this.valpha&&(r.alpha=this.valpha),r},unitArray:function(){var r=this.rgb().color;return r[0]/=255,r[1]/=255,r[2]/=255,1!==this.valpha&&r.push(this.valpha),r},unitObject:function(){var r=this.rgb().object();return r.r/=255,r.g/=255,r.b/=255,1!==this.valpha&&(r.alpha=this.valpha),r},round:function(r){return r=Math.max(r||0,0),new u(this.color.map(function(r){return function(n){return function(r,n){return Number(r.toFixed(n))}(n,r)}}(r)).concat(this.valpha),this.model)},alpha:function(r){return arguments.length?new u(this.color.concat(Math.max(0,Math.min(1,r))),this.model):this.valpha},red:h("rgb",0,c(255)),green:h("rgb",1,c(255)),blue:h("rgb",2,c(255)),hue:h(["hsl","hsv","hsl","hwb","hcg"],0,(function(r){return(r%360+360)%360})),saturationl:h("hsl",1,c(100)),lightness:h("hsl",2,c(100)),saturationv:h("hsv",1,c(100)),value:h("hsv",2,c(100)),chroma:h("hcg",1,c(100)),gray:h("hcg",2,c(100)),white:h("hwb",1,c(100)),wblack:h("hwb",2,c(100)),cyan:h("cmyk",0,c(100)),magenta:h("cmyk",1,c(100)),yellow:h("cmyk",2,c(100)),black:h("cmyk",3,c(100)),x:h("xyz",0,c(100)),y:h("xyz",1,c(100)),z:h("xyz",2,c(100)),l:h("lab",0,c(100)),a:h("lab",1),b:h("lab",2),keyword:function(r){return arguments.length?new u(r):a[this.model].keyword(this.color)},hex:function(r){return arguments.length?new u(r):e.to.hex(this.rgb().round().color)},rgbNumber:function(){var r=this.rgb().color;return(255&r[0])<<16|(255&r[1])<<8|255&r[2]},luminosity:function(){for(var r=this.rgb().color,n=[],t=0;t<r.length;t++){var e=r[t]/255;n[t]=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}return.2126*n[0]+.7152*n[1]+.0722*n[2]},contrast:function(r){var n=this.luminosity(),t=r.luminosity();return n>t?(n+.05)/(t+.05):(t+.05)/(n+.05)},level:function(r){var n=this.contrast(r);return n>=7.1?"AAA":n>=4.5?"AA":""},isDark:function(){var r=this.rgb().color;return(299*r[0]+587*r[1]+114*r[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var r=this.rgb(),n=0;n<3;n++)r.color[n]=255-r.color[n];return r},lighten:function(r){var n=this.hsl();return n.color[2]+=n.color[2]*r,n},darken:function(r){var n=this.hsl();return n.color[2]-=n.color[2]*r,n},saturate:function(r){var n=this.hsl();return n.color[1]+=n.color[1]*r,n},desaturate:function(r){var n=this.hsl();return n.color[1]-=n.color[1]*r,n},whiten:function(r){var n=this.hwb();return n.color[1]+=n.color[1]*r,n},blacken:function(r){var n=this.hwb();return n.color[2]+=n.color[2]*r,n},grayscale:function(){var r=this.rgb().color,n=.3*r[0]+.59*r[1]+.11*r[2];return u.rgb(n,n,n)},fade:function(r){return this.alpha(this.valpha-this.valpha*r)},opaquer:function(r){return this.alpha(this.valpha+this.valpha*r)},rotate:function(r){var n=this.hsl(),t=n.color[0];return t=(t=(t+r)%360)<0?360+t:t,n.color[0]=t,n},mix:function(r,n){if(!r||!r.rgb)throw new Error(\'Argument to "mix" was not a Color instance, but rather an instance of \'+typeof r);var t=r.rgb(),e=this.rgb(),a=void 0===n?.5:n,o=2*a-1,i=t.alpha()-e.alpha(),l=((o*i==-1?o:(o+i)/(1+o*i))+1)/2,s=1-l;return u.rgb(l*t.red()+s*e.red(),l*t.green()+s*e.green(),l*t.blue()+s*e.blue(),t.alpha()*a+e.alpha()*(1-a))}},Object.keys(a).forEach((function(r){if(-1===i.indexOf(r)){var n=a[r].channels;u.prototype[r]=function(){if(this.model===r)return new u(this);if(arguments.length)return new u(arguments,r);var t="number"==typeof arguments[n]?n:this.valpha;return new u(f(a[this.model][r].raw(this.color)).concat(t),r)},u[r]=function(t){return"number"==typeof t&&(t=g(o.call(arguments),n)),new u(t,r)}}})),r.exports=u},function(r,n,t){"use strict";r.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},function(r,n,t){var e=t(1),a={};for(var o in e)e.hasOwnProperty(o)&&(a[e[o]]=o);var i=r.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var l in i)if(i.hasOwnProperty(l)){if(!("channels"in i[l]))throw new Error("missing channels property: "+l);if(!("labels"in i[l]))throw new Error("missing channel labels property: "+l);if(i[l].labels.length!==i[l].channels)throw new Error("channel and label counts mismatch: "+l);var s=i[l].channels,u=i[l].labels;delete i[l].channels,delete i[l].labels,Object.defineProperty(i[l],"channels",{value:s}),Object.defineProperty(i[l],"labels",{value:u})}i.rgb.hsl=function(r){var n,t,e=r[0]/255,a=r[1]/255,o=r[2]/255,i=Math.min(e,a,o),l=Math.max(e,a,o),s=l-i;return l===i?n=0:e===l?n=(a-o)/s:a===l?n=2+(o-e)/s:o===l&&(n=4+(e-a)/s),(n=Math.min(60*n,360))<0&&(n+=360),t=(i+l)/2,[n,100*(l===i?0:t<=.5?s/(l+i):s/(2-l-i)),100*t]},i.rgb.hsv=function(r){var n,t,e,a,o,i=r[0]/255,l=r[1]/255,s=r[2]/255,u=Math.max(i,l,s),h=u-Math.min(i,l,s),c=function(r){return(u-r)/6/h+.5};return 0===h?a=o=0:(o=h/u,n=c(i),t=c(l),e=c(s),i===u?a=e-t:l===u?a=1/3+n-e:s===u&&(a=2/3+t-n),a<0?a+=1:a>1&&(a-=1)),[360*a,100*o,100*u]},i.rgb.hwb=function(r){var n=r[0],t=r[1],e=r[2];return[i.rgb.hsl(r)[0],100*(1/255*Math.min(n,Math.min(t,e))),100*(e=1-1/255*Math.max(n,Math.max(t,e)))]},i.rgb.cmyk=function(r){var n,t=r[0]/255,e=r[1]/255,a=r[2]/255;return[100*((1-t-(n=Math.min(1-t,1-e,1-a)))/(1-n)||0),100*((1-e-n)/(1-n)||0),100*((1-a-n)/(1-n)||0),100*n]},i.rgb.keyword=function(r){var n=a[r];if(n)return n;var t,o,i,l=1/0;for(var s in e)if(e.hasOwnProperty(s)){var u=e[s],h=(o=r,i=u,Math.pow(o[0]-i[0],2)+Math.pow(o[1]-i[1],2)+Math.pow(o[2]-i[2],2));h<l&&(l=h,t=s)}return t},i.keyword.rgb=function(r){return e[r]},i.rgb.xyz=function(r){var n=r[0]/255,t=r[1]/255,e=r[2]/255;return[100*(.4124*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.3576*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.1805*(e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)),100*(.2126*n+.7152*t+.0722*e),100*(.0193*n+.1192*t+.9505*e)]},i.rgb.lab=function(r){var n=i.rgb.xyz(r),t=n[0],e=n[1],a=n[2];return e/=100,a/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(e=e>.008856?Math.pow(e,1/3):7.787*e+16/116)-16,500*(t-e),200*(e-(a=a>.008856?Math.pow(a,1/3):7.787*a+16/116))]},i.hsl.rgb=function(r){var n,t,e,a,o,i=r[0]/360,l=r[1]/100,s=r[2]/100;if(0===l)return[o=255*s,o,o];n=2*s-(t=s<.5?s*(1+l):s+l-s*l),a=[0,0,0];for(var u=0;u<3;u++)(e=i+1/3*-(u-1))<0&&e++,e>1&&e--,o=6*e<1?n+6*(t-n)*e:2*e<1?t:3*e<2?n+(t-n)*(2/3-e)*6:n,a[u]=255*o;return a},i.hsl.hsv=function(r){var n=r[0],t=r[1]/100,e=r[2]/100,a=t,o=Math.max(e,.01);return t*=(e*=2)<=1?e:2-e,a*=o<=1?o:2-o,[n,100*(0===e?2*a/(o+a):2*t/(e+t)),100*((e+t)/2)]},i.hsv.rgb=function(r){var n=r[0]/60,t=r[1]/100,e=r[2]/100,a=Math.floor(n)%6,o=n-Math.floor(n),i=255*e*(1-t),l=255*e*(1-t*o),s=255*e*(1-t*(1-o));switch(e*=255,a){case 0:return[e,s,i];case 1:return[l,e,i];case 2:return[i,e,s];case 3:return[i,l,e];case 4:return[s,i,e];case 5:return[e,i,l]}},i.hsv.hsl=function(r){var n,t,e,a=r[0],o=r[1]/100,i=r[2]/100,l=Math.max(i,.01);return e=(2-o)*i,t=o*l,[a,100*(t=(t/=(n=(2-o)*l)<=1?n:2-n)||0),100*(e/=2)]},i.hwb.rgb=function(r){var n,t,e,a,o,i,l,s=r[0]/360,u=r[1]/100,h=r[2]/100,c=u+h;switch(c>1&&(u/=c,h/=c),e=6*s-(n=Math.floor(6*s)),0!=(1&n)&&(e=1-e),a=u+e*((t=1-h)-u),n){default:case 6:case 0:o=t,i=a,l=u;break;case 1:o=a,i=t,l=u;break;case 2:o=u,i=t,l=a;break;case 3:o=u,i=a,l=t;break;case 4:o=a,i=u,l=t;break;case 5:o=t,i=u,l=a}return[255*o,255*i,255*l]},i.cmyk.rgb=function(r){var n=r[0]/100,t=r[1]/100,e=r[2]/100,a=r[3]/100;return[255*(1-Math.min(1,n*(1-a)+a)),255*(1-Math.min(1,t*(1-a)+a)),255*(1-Math.min(1,e*(1-a)+a))]},i.xyz.rgb=function(r){var n,t,e,a=r[0]/100,o=r[1]/100,i=r[2]/100;return t=-.9689*a+1.8758*o+.0415*i,e=.0557*a+-.204*o+1.057*i,n=(n=3.2406*a+-1.5372*o+-.4986*i)>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,t=t>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,e=e>.0031308?1.055*Math.pow(e,1/2.4)-.055:12.92*e,[255*(n=Math.min(Math.max(0,n),1)),255*(t=Math.min(Math.max(0,t),1)),255*(e=Math.min(Math.max(0,e),1))]},i.xyz.lab=function(r){var n=r[0],t=r[1],e=r[2];return t/=100,e/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(t=t>.008856?Math.pow(t,1/3):7.787*t+16/116)-16,500*(n-t),200*(t-(e=e>.008856?Math.pow(e,1/3):7.787*e+16/116))]},i.lab.xyz=function(r){var n,t,e,a=r[0];n=r[1]/500+(t=(a+16)/116),e=t-r[2]/200;var o=Math.pow(t,3),i=Math.pow(n,3),l=Math.pow(e,3);return t=o>.008856?o:(t-16/116)/7.787,n=i>.008856?i:(n-16/116)/7.787,e=l>.008856?l:(e-16/116)/7.787,[n*=95.047,t*=100,e*=108.883]},i.lab.lch=function(r){var n,t=r[0],e=r[1],a=r[2];return(n=360*Math.atan2(a,e)/2/Math.PI)<0&&(n+=360),[t,Math.sqrt(e*e+a*a),n]},i.lch.lab=function(r){var n,t=r[0],e=r[1];return n=r[2]/360*2*Math.PI,[t,e*Math.cos(n),e*Math.sin(n)]},i.rgb.ansi16=function(r){var n=r[0],t=r[1],e=r[2],a=1 in arguments?arguments[1]:i.rgb.hsv(r)[2];if(0===(a=Math.round(a/50)))return 30;var o=30+(Math.round(e/255)<<2|Math.round(t/255)<<1|Math.round(n/255));return 2===a&&(o+=60),o},i.hsv.ansi16=function(r){return i.rgb.ansi16(i.hsv.rgb(r),r[2])},i.rgb.ansi256=function(r){var n=r[0],t=r[1],e=r[2];return n===t&&t===e?n<8?16:n>248?231:Math.round((n-8)/247*24)+232:16+36*Math.round(n/255*5)+6*Math.round(t/255*5)+Math.round(e/255*5)},i.ansi16.rgb=function(r){var n=r%10;if(0===n||7===n)return r>50&&(n+=3.5),[n=n/10.5*255,n,n];var t=.5*(1+~~(r>50));return[(1&n)*t*255,(n>>1&1)*t*255,(n>>2&1)*t*255]},i.ansi256.rgb=function(r){if(r>=232){var n=10*(r-232)+8;return[n,n,n]}var t;return r-=16,[Math.floor(r/36)/5*255,Math.floor((t=r%36)/6)/5*255,t%6/5*255]},i.rgb.hex=function(r){var n=(((255&Math.round(r[0]))<<16)+((255&Math.round(r[1]))<<8)+(255&Math.round(r[2]))).toString(16).toUpperCase();return"000000".substring(n.length)+n},i.hex.rgb=function(r){var n=r.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!n)return[0,0,0];var t=n[0];3===n[0].length&&(t=t.split("").map((function(r){return r+r})).join(""));var e=parseInt(t,16);return[e>>16&255,e>>8&255,255&e]},i.rgb.hcg=function(r){var n,t=r[0]/255,e=r[1]/255,a=r[2]/255,o=Math.max(Math.max(t,e),a),i=Math.min(Math.min(t,e),a),l=o-i;return n=l<=0?0:o===t?(e-a)/l%6:o===e?2+(a-t)/l:4+(t-e)/l+4,n/=6,[360*(n%=1),100*l,100*(l<1?i/(1-l):0)]},i.hsl.hcg=function(r){var n=r[1]/100,t=r[2]/100,e=1,a=0;return(e=t<.5?2*n*t:2*n*(1-t))<1&&(a=(t-.5*e)/(1-e)),[r[0],100*e,100*a]},i.hsv.hcg=function(r){var n=r[1]/100,t=r[2]/100,e=n*t,a=0;return e<1&&(a=(t-e)/(1-e)),[r[0],100*e,100*a]},i.hcg.rgb=function(r){var n=r[0]/360,t=r[1]/100,e=r[2]/100;if(0===t)return[255*e,255*e,255*e];var a,o=[0,0,0],i=n%1*6,l=i%1,s=1-l;switch(Math.floor(i)){case 0:o[0]=1,o[1]=l,o[2]=0;break;case 1:o[0]=s,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=l;break;case 3:o[0]=0,o[1]=s,o[2]=1;break;case 4:o[0]=l,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=s}return a=(1-t)*e,[255*(t*o[0]+a),255*(t*o[1]+a),255*(t*o[2]+a)]},i.hcg.hsv=function(r){var n=r[1]/100,t=n+r[2]/100*(1-n),e=0;return t>0&&(e=n/t),[r[0],100*e,100*t]},i.hcg.hsl=function(r){var n=r[1]/100,t=r[2]/100*(1-n)+.5*n,e=0;return t>0&&t<.5?e=n/(2*t):t>=.5&&t<1&&(e=n/(2*(1-t))),[r[0],100*e,100*t]},i.hcg.hwb=function(r){var n=r[1]/100,t=n+r[2]/100*(1-n);return[r[0],100*(t-n),100*(1-t)]},i.hwb.hcg=function(r){var n=r[1]/100,t=1-r[2]/100,e=t-n,a=0;return e<1&&(a=(t-e)/(1-e)),[r[0],100*e,100*a]},i.apple.rgb=function(r){return[r[0]/65535*255,r[1]/65535*255,r[2]/65535*255]},i.rgb.apple=function(r){return[r[0]/255*65535,r[1]/255*65535,r[2]/255*65535]},i.gray.rgb=function(r){return[r[0]/100*255,r[0]/100*255,r[0]/100*255]},i.gray.hsl=i.gray.hsv=function(r){return[0,0,r[0]]},i.gray.hwb=function(r){return[0,100,r[0]]},i.gray.cmyk=function(r){return[0,0,0,r[0]]},i.gray.lab=function(r){return[r[0],0,0]},i.gray.hex=function(r){var n=255&Math.round(r[0]/100*255),t=((n<<16)+(n<<8)+n).toString(16).toUpperCase();return"000000".substring(t.length)+t},i.rgb.gray=function(r){return[(r[0]+r[1]+r[2])/3/255*100]}},function(r,n,t){"use strict";t.r(n);var e=t(0),a=t.n(e);function o(r,n,t,e,a,o,i){try{var l=r[o](i),s=l.value}catch(r){return void t(r)}l.done?n(s):Promise.resolve(s).then(e,a)}function i(r){return function(){var n=this,t=arguments;return new Promise((function(e,a){var i=r.apply(n,t);function l(r){o(i,e,a,l,s,"next",r)}function s(r){o(i,e,a,l,s,"throw",r)}l(void 0)}))}}self.onmessage=function(){var r=i((function*(r){const n=yield function(r,n){const t="action"===r?a()("#ff3464"):a()("#2F80ED"),e=a()(n).hsl(),o=t.hsl(),l=e.hue()-o.hue(),s=e.saturationl()/o.saturationl(),u=e.lightness()/o.lightness();return function(){var r=i((function*(r){const n=(()=>{const r=(r,n)=>Math.abs(r-n)<5;return(n,t,e)=>r(n,t)&&r(t,e)&&r(n,e)})(),t={};for(let e=0,o=r.length;e<o;e+=4){const o=r[e],i=r[e+1],h=r[e+2];if(!n(o,i,h)){const n=o+1e3*i+1e6*h;if(!t[n]){let r=a()({r:o,g:i,b:h}).hsl();r=r.rotate(l),r.color[1]*=s,r.color[2]*=u;const[e,c,f]=r.rgb().array();t[n]=[e,c,f]}const[c,f,g]=t[n];r[e]=c,r[e+1]=f,r[e+2]=g}}return r}));return function(n){return r.apply(this,arguments)}}()}(r.data.type,r.data.color)(new Uint8ClampedArray(r.data.payload));self.postMessage({id:r.data.id,result:n})}));return function(n){return r.apply(this,arguments)}}()},function(r,n,t){var e=t(1),a=t(5),o={};for(var i in e)e.hasOwnProperty(i)&&(o[e[i]]=i);var l=r.exports={to:{},get:{}};function s(r,n,t){return Math.min(Math.max(n,r),t)}function u(r){var n=r.toString(16).toUpperCase();return n.length<2?"0"+n:n}l.get=function(r){var n,t;switch(r.substring(0,3).toLowerCase()){case"hsl":n=l.get.hsl(r),t="hsl";break;case"hwb":n=l.get.hwb(r),t="hwb";break;default:n=l.get.rgb(r),t="rgb"}return n?{model:t,value:n}:null},l.get.rgb=function(r){if(!r)return null;var n,t,a,o=[0,0,0,1];if(n=r.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(a=n[2],n=n[1],t=0;t<3;t++){var i=2*t;o[t]=parseInt(n.slice(i,i+2),16)}a&&(o[3]=Math.round(parseInt(a,16)/255*100)/100)}else if(n=r.match(/^#([a-f0-9]{3,4})$/i)){for(a=(n=n[1])[3],t=0;t<3;t++)o[t]=parseInt(n[t]+n[t],16);a&&(o[3]=Math.round(parseInt(a+a,16)/255*100)/100)}else if(n=r.match(/^rgba?\\(\\s*([+-]?\\d+)\\s*,\\s*([+-]?\\d+)\\s*,\\s*([+-]?\\d+)\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)$/)){for(t=0;t<3;t++)o[t]=parseInt(n[t+1],0);n[4]&&(o[3]=parseFloat(n[4]))}else{if(!(n=r.match(/^rgba?\\(\\s*([+-]?[\\d\\.]+)\\%\\s*,\\s*([+-]?[\\d\\.]+)\\%\\s*,\\s*([+-]?[\\d\\.]+)\\%\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)$/)))return(n=r.match(/(\\D+)/))?"transparent"===n[1]?[0,0,0,0]:(o=e[n[1]])?(o[3]=1,o):null:null;for(t=0;t<3;t++)o[t]=Math.round(2.55*parseFloat(n[t+1]));n[4]&&(o[3]=parseFloat(n[4]))}for(t=0;t<3;t++)o[t]=s(o[t],0,255);return o[3]=s(o[3],0,1),o},l.get.hsl=function(r){if(!r)return null;var n=r.match(/^hsla?\\(\\s*([+-]?(?:\\d*\\.)?\\d+)(?:deg)?\\s*,\\s*([+-]?[\\d\\.]+)%\\s*,\\s*([+-]?[\\d\\.]+)%\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)$/);if(n){var t=parseFloat(n[4]);return[(parseFloat(n[1])+360)%360,s(parseFloat(n[2]),0,100),s(parseFloat(n[3]),0,100),s(isNaN(t)?1:t,0,1)]}return null},l.get.hwb=function(r){if(!r)return null;var n=r.match(/^hwb\\(\\s*([+-]?\\d*[\\.]?\\d+)(?:deg)?\\s*,\\s*([+-]?[\\d\\.]+)%\\s*,\\s*([+-]?[\\d\\.]+)%\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)$/);if(n){var t=parseFloat(n[4]);return[(parseFloat(n[1])%360+360)%360,s(parseFloat(n[2]),0,100),s(parseFloat(n[3]),0,100),s(isNaN(t)?1:t,0,1)]}return null},l.to.hex=function(){var r=a(arguments);return"#"+u(r[0])+u(r[1])+u(r[2])+(r[3]<1?u(Math.round(255*r[3])):"")},l.to.rgb=function(){var r=a(arguments);return r.length<4||1===r[3]?"rgb("+Math.round(r[0])+", "+Math.round(r[1])+", "+Math.round(r[2])+")":"rgba("+Math.round(r[0])+", "+Math.round(r[1])+", "+Math.round(r[2])+", "+r[3]+")"},l.to.rgb.percent=function(){var r=a(arguments),n=Math.round(r[0]/255*100),t=Math.round(r[1]/255*100),e=Math.round(r[2]/255*100);return r.length<4||1===r[3]?"rgb("+n+"%, "+t+"%, "+e+"%)":"rgba("+n+"%, "+t+"%, "+e+"%, "+r[3]+")"},l.to.hsl=function(){var r=a(arguments);return r.length<4||1===r[3]?"hsl("+r[0]+", "+r[1]+"%, "+r[2]+"%)":"hsla("+r[0]+", "+r[1]+"%, "+r[2]+"%, "+r[3]+")"},l.to.hwb=function(){var r=a(arguments),n="";return r.length>=4&&1!==r[3]&&(n=", "+r[3]),"hwb("+r[0]+", "+r[1]+"%, "+r[2]+"%"+n+")"},l.to.keyword=function(r){return o[r.slice(0,3)]}},function(r,n,t){"use strict";var e=t(6),a=Array.prototype.concat,o=Array.prototype.slice,i=r.exports=function(r){for(var n=[],t=0,i=r.length;t<i;t++){var l=r[t];e(l)?n=a.call(n,o.call(l)):n.push(l)}return n};i.wrap=function(r){return function(){return r(i(arguments))}}},function(r,n){r.exports=function(r){return!(!r||"string"==typeof r)&&(r instanceof Array||Array.isArray(r)||r.length>=0&&(r.splice instanceof Function||Object.getOwnPropertyDescriptor(r,r.length-1)&&"String"!==r.constructor.name))}},function(r,n,t){var e=t(2),a=t(8),o={};Object.keys(e).forEach((function(r){o[r]={},Object.defineProperty(o[r],"channels",{value:e[r].channels}),Object.defineProperty(o[r],"labels",{value:e[r].labels});var n=a(r);Object.keys(n).forEach((function(t){var e=n[t];o[r][t]=function(r){var n=function(n){if(null==n)return n;arguments.length>1&&(n=Array.prototype.slice.call(arguments));var t=r(n);if("object"==typeof t)for(var e=t.length,a=0;a<e;a++)t[a]=Math.round(t[a]);return t};return"conversion"in r&&(n.conversion=r.conversion),n}(e),o[r][t].raw=function(r){var n=function(n){return null==n?n:(arguments.length>1&&(n=Array.prototype.slice.call(arguments)),r(n))};return"conversion"in r&&(n.conversion=r.conversion),n}(e)}))})),r.exports=o},function(r,n,t){var e=t(2);function a(r){var n=function(){for(var r={},n=Object.keys(e),t=n.length,a=0;a<t;a++)r[n[a]]={distance:-1,parent:null};return r}(),t=[r];for(n[r].distance=0;t.length;)for(var a=t.pop(),o=Object.keys(e[a]),i=o.length,l=0;l<i;l++){var s=o[l],u=n[s];-1===u.distance&&(u.distance=n[a].distance+1,u.parent=a,t.unshift(s))}return n}function o(r,n){return function(t){return n(r(t))}}function i(r,n){for(var t=[n[r].parent,r],a=e[n[r].parent][r],i=n[r].parent;n[i].parent;)t.unshift(n[i].parent),a=o(e[n[i].parent][i],a),i=n[i].parent;return a.conversion=t,a}r.exports=function(r){for(var n=a(r),t={},e=Object.keys(n),o=e.length,l=0;l<o;l++){var s=e[l];null!==n[s].parent&&(t[s]=i(s,n))}return t}}]);\n//# sourceMappingURL=color-shift.worker-84870f570e5c1590e3c7.js.map',"/assets/js/color-shift.worker-84870f570e5c1590e3c7.js")}},571:function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var r=n(5),i=0,a=1,o=2,s=3,c=4,l=5,u=6,h=5121,d=5123,p=5126,f=5125,m=34962,g=34963,v=9728,y=9729,b=9984,x=9985,w=9986,E=9987,M=33071,A=33648,T=10497,_={};_[r.NearestFilter]=v,_[r.NearestMipMapNearestFilter]=b,_[r.NearestMipMapLinearFilter]=w,_[r.LinearFilter]=y,_[r.LinearMipMapNearestFilter]=x,_[r.LinearMipMapLinearFilter]=E,_[r.ClampToEdgeWrapping]=M,_[r.RepeatWrapping]=T,_[r.MirroredRepeatWrapping]=A;var S={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},L={mode:"glb",trs:!0,onlyVisible:!0,truncateDrawRange:!0,animations:[],forceIndices:!1,forcePowerOfTwoTextures:!1,includeCustomExtensions:!1},C=function(){};C.prototype={constructor:C,parseChunks:function(e,t,n,v){(v=Object.assign({},L,v)).animations.length>0&&(v.trs=!0);var y,b={asset:{version:"2.0",generator:"GLTFExporter"}},x=[],w=[],E=0,M=[],A=[],T=new Map,R=[],P={},O={meshes:new Map,attributes:new Map,attributesRelative:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map},D=new Map,I=0;function B(e){return D.has(e)||D.set(e,I++),D.get(e)}function k(e,t){return e.length===t.length&&e.every((function(e,n){return e===t[n]}))}function H(e,t){if(0!==Object.keys(e.userData).length)try{var n=JSON.parse(JSON.stringify(e.userData));if(v.includeCustomExtensions&&n.gltfExtensions){for(var r in void 0===t.extensions&&(t.extensions={}),n.gltfExtensions)t.extensions[r]=n.gltfExtensions[r],P[r]=!0;delete n.gltfExtensions}Object.keys(n).length>0&&(t.extras=n)}catch(t){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+t.message)}}function N(e,t){var n=!1,r={};0===t.offset.x&&0===t.offset.y||(r.offset=t.offset.toArray(),n=!0),0!==t.rotation&&(r.rotation=t.rotation,n=!0),1===t.repeat.x&&1===t.repeat.y||(r.scale=t.repeat.toArray(),n=!0),n&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=r,P.KHR_texture_transform=!0)}function F(e){return b.buffers||(b.buffers=[{byteLength:0}]),M.push(e),0}function U(e,t,n,r){var i;if(e.array.constructor===Float32Array)i=p;else if(e.array.constructor===Uint32Array)i=f;else if(e.array.constructor===Uint16Array)i=d;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type.");i=h}if(void 0===n&&(n=0),void 0===r&&(r=e.count),v.truncateDrawRange&&void 0!==t&&null===t.index){var a=n+r,o=t.drawRange.count===1/0?e.count:t.drawRange.start+t.drawRange.count;n=Math.max(n,t.drawRange.start),(r=Math.min(a,o)-n)<0&&(r=0)}if(0===r)return null;var s,c=function(e,t,n){for(var r={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)},i=t;i<t+n;i++)for(var a=0;a<e.itemSize;a++){var o=e.array[i*e.itemSize+a];r.min[a]=Math.min(r.min[a],o),r.max[a]=Math.max(r.max[a],o)}return r}(e,n,r);void 0!==t&&(s=e===t.index?g:m);var l=function(e,t,n,r,i){var a;b.bufferViews||(b.bufferViews=[]),a=t===h?1:t===d?2:4;for(var o=C.Utils.getPaddedBufferSize(r*e.itemSize*a),s=new DataView(new ArrayBuffer(o)),c=0,l=n;l<n+r;l++)for(var u=0;u<e.itemSize;u++){var g=e.array[l*e.itemSize+u];t===p?s.setFloat32(c,g,!0):t===f?s.setUint32(c,g,!0):t===d?s.setUint16(c,g,!0):t===h&&s.setUint8(c,g),c+=a}var v={buffer:F(s.buffer),byteOffset:E,byteLength:o};return void 0!==i&&(v.target=i),i===m&&(v.byteStride=e.itemSize*a),E+=o,b.bufferViews.push(v),{id:b.bufferViews.length-1,byteLength:0}}(e,i,n,r,s),u={bufferView:l.id,byteOffset:l.byteOffset,componentType:i,count:r,max:c.max,min:c.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"}[e.itemSize]};return b.accessors||(b.accessors=[]),b.accessors.push(u),b.accessors.length-1}function z(e,t,n,i,a){var o=v.forcePowerOfTwoTextures&&!function(e){return r.Math.isPowerOfTwo(e.width)&&r.Math.isPowerOfTwo(e.height)}(e);if(o||n){var s=y=y||document.createElement("canvas");s.width=e.width,s.height=e.height,o&&(console.warn("GLTFExporter: Resized non-power-of-two image.",e),s.width=r.Math.floorPowerOfTwo(s.width),s.height=r.Math.floorPowerOfTwo(s.height));var c=s.getContext("2d");!0===n&&(c.translate(0,s.height),c.scale(1,-1)),c.drawImage(e,0,0,s.width,s.height),s.toBlob(a,t)}else fetch(e.src).then((function(e){return e.blob()})).then(a).catch(i)}function V(e,t,n){O.images.has(e)||O.images.set(e,{});var i=O.images.get(e),a=t===r.RGBAFormat?"image/png":"image/jpeg",o=a+":flipY/"+n.toString();if(void 0!==i[o])return i[o];b.images||(b.images=[]);var s,c,l={mimeType:a},u=b.images.length;if("glb"===v.mode)A.push(new Promise((function(t,r){z(e,a,n,r,(function(e){(function(e){return b.bufferViews||(b.bufferViews=[]),new Promise((function(t){var n=new window.FileReader;n.readAsArrayBuffer(e),n.onloadend=function(){var e=C.Utils.getPaddedArrayBuffer(n.result),r={buffer:F(e),byteOffset:E,byteLength:e.byteLength};E+=e.byteLength,b.bufferViews.push(r),t(b.bufferViews.length-1)}}))})(e).then((function(e){l.bufferView=e,t()})).catch(r)}))})));else{var h=(s=e.src,(c=s.split("#").shift().split("?").shift().split("/").pop().split(".")).length>1&&c.pop(),c.join()),d="image/png"===a?".png":".jpg";l.uri=h+u+d,A.push(new Promise((function(t,r){z(e,a,n,r,(function(e){w[u]=e,t()}))})))}return b.images.push(l),i[o]=u,u}function j(e){b.samplers||(b.samplers=[]);var t={magFilter:_[e.magFilter],minFilter:_[e.minFilter],wrapS:_[e.wrapS],wrapT:_[e.wrapT]};return b.samplers.push(t),b.samplers.length-1}function G(e){if(O.textures.has(e))return O.textures.get(e);b.textures||(b.textures=[]);var t={sampler:j(e),source:V(e.image,e.format,e.flipY)};b.textures.push(t);var n=b.textures.length-1;return O.textures.set(e,n),n}function W(e){if(O.materials.has(e))return O.materials.get(e);if(b.materials||(b.materials=[]),e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;var t={pbrMetallicRoughness:{}};e.isMeshBasicMaterial?(t.extensions={KHR_materials_unlit:{}},P.KHR_materials_unlit=!0):e.isMeshStandardMaterial||console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");var n=e.color.toArray().concat([e.opacity]);if(k(n,[1,1,1,1])||(t.pbrMetallicRoughness.baseColorFactor=n),e.isMeshStandardMaterial?(t.pbrMetallicRoughness.metallicFactor=e.metalness,t.pbrMetallicRoughness.roughnessFactor=e.roughness):e.isMeshBasicMaterial?(t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9):(t.pbrMetallicRoughness.metallicFactor=.5,t.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap)if(e.metalnessMap===e.roughnessMap){var i={index:G(e.metalnessMap)};N(i,e.metalnessMap),t.pbrMetallicRoughness.metallicRoughnessTexture=i}else console.warn("THREE.GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.");if(e.map){var a={index:G(e.map)};N(a,e.map),t.pbrMetallicRoughness.baseColorTexture=a}if(e.isMeshBasicMaterial||e.isLineBasicMaterial||e.isPointsMaterial);else{var o=e.emissive.clone().multiplyScalar(e.emissiveIntensity).toArray();if(k(o,[0,0,0])||(t.emissiveFactor=o),e.emissiveMap){var s={index:G(e.emissiveMap)};N(s,e.emissiveMap),t.emissiveTexture=s}}if(e.normalMap){var c={index:G(e.normalMap)};-1!==e.normalScale.x&&(e.normalScale.x!==e.normalScale.y&&console.warn("THREE.GLTFExporter: Normal scale components are different, ignoring Y and exporting X."),c.scale=e.normalScale.x),N(c,e.normalMap),t.normalTexture=c}if(e.aoMap){var l={index:G(e.aoMap),texCoord:1};1!==e.aoMapIntensity&&(l.strength=e.aoMapIntensity),N(l,e.aoMap),t.occlusionTexture=l}(e.transparent||e.alphaTest>0)&&(t.alphaMode=e.opacity<1?"BLEND":"MASK",e.alphaTest>0&&.5!==e.alphaTest&&(t.alphaCutoff=e.alphaTest)),e.side===r.DoubleSide&&(t.doubleSided=!0),""!==e.name&&(t.name=e.name),H(e,t),b.materials.push(t);var u=b.materials.length-1;return O.materials.set(e,u),u}function q(e){var t=e.geometry.uuid+":"+e.material.uuid;if(O.meshes.has(t))return O.meshes.get(t);var n,h=e.geometry;if(e.isLineSegments)n=a;else if(e.isLineLoop)n=o;else if(e.isLine)n=s;else if(e.isPoints)n=i;else{if(!h.isBufferGeometry){console.warn("GLTFExporter: Exporting THREE.Geometry will increase file size. Use BufferGeometry instead.");var d=new r.BufferGeometry;d.fromGeometry(h),h=d}e.drawMode===r.TriangleFanDrawMode?(console.warn("GLTFExporter: TriangleFanDrawMode and wireframe incompatible."),n=u):n=e.drawMode===r.TriangleStripDrawMode?e.material.wireframe?s:l:e.material.wireframe?a:c}var p={},f={},m=[],g=[],y={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},x=h.getAttribute("normal");void 0===x||function(e){if(O.attributesNormalized.has(e))return!1;for(var t=new r.Vector3,n=0,i=e.count;n<i;n++)if(Math.abs(t.fromArray(e.array,3*n).length()-1)>5e-4)return!1;return!0}(x)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),h.addAttribute("normal",function(e){if(O.attributesNormalized.has(e))return O.attributesNormalized.get(e);for(var t=e.clone(),n=new r.Vector3,i=0,a=t.count;i<a;i++)n.fromArray(t.array,3*i),0===n.x&&0===n.y&&0===n.z?n.setX(1):n.normalize(),n.toArray(t.array,3*i);return O.attributesNormalized.set(e,t),t}(x)));var w=null;for(var E in h.attributes)if("morph"!==E.substr(0,5)){var M=h.attributes[E];E=y[E]||E.toUpperCase();if(/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(E)||(E="_"+E),O.attributes.has(B(M)))f[E]=O.attributes.get(B(M));else{w=null;var A=M.array;"JOINTS_0"!==E||A instanceof Uint16Array||A instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),w=new r.BufferAttribute(new Uint16Array(A),M.itemSize,M.normalized));var T=U(w||M,h);null!==T&&(f[E]=T,O.attributes.set(B(M),T))}}if(void 0!==x&&h.addAttribute("normal",x),0===Object.keys(f).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){var _=[],S=[],L={};if(void 0!==e.morphTargetDictionary)for(var C in e.morphTargetDictionary)L[e.morphTargetDictionary[C]]=C;for(var R=0;R<e.morphTargetInfluences.length;++R){var P={},D=!1;for(var E in h.morphAttributes)if("position"===E||"normal"===E){M=h.morphAttributes[E][R];var I=E.toUpperCase(),k=h.attributes[E];if(O.attributesRelative.has(B(M)))P[I]=O.attributesRelative.get(B(M));else{for(var N=M.clone(),F=0,z=M.count;F<z;F++)N.setXYZ(F,M.getX(F)-k.getX(F),M.getY(F)-k.getY(F),M.getZ(F)-k.getZ(F));P[I]=U(N,h),O.attributesRelative.set(B(k),P[I])}}else D||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),D=!0);g.push(P),_.push(e.morphTargetInfluences[R]),void 0!==e.morphTargetDictionary&&S.push(L[R])}p.weights=_,S.length>0&&(p.extras={},p.extras.targetNames=S)}var V=v.forceIndices,j=Array.isArray(e.material);if(j&&0===h.groups.length)return null;!V&&null===h.index&&j&&(console.warn("THREE.GLTFExporter: Creating index for non-indexed multi-material mesh."),V=!0);var G=!1;if(null===h.index&&V){for(var q=[],X=(R=0,h.attributes.position.count);R<X;R++)q[R]=R;h.setIndex(q),G=!0}var Y=j?e.material:[e.material],K=j?h.groups:[{materialIndex:0,start:void 0,count:void 0}];for(R=0,X=K.length;R<X;R++){var J={mode:n,attributes:f};if(H(h,J),g.length>0&&(J.targets=g),null!==h.index){t=B(h.index);void 0===K[R].start&&void 0===K[R].count||(t+=":"+K[R].start+":"+K[R].count),O.attributes.has(t)?J.indices=O.attributes.get(t):(J.indices=U(h.index,h,K[R].start,K[R].count),O.attributes.set(t,J.indices)),null===J.indices&&delete J.indices}var Z=W(Y[K[R].materialIndex]);null!==Z&&(J.material=Z),m.push(J)}G&&h.setIndex(null),p.primitives=m,b.meshes||(b.meshes=[]),b.meshes.push(p);var Q=b.meshes.length-1;return O.meshes.set(t,Q),Q}function X(e,t){b.animations||(b.animations=[]);for(var n=(e=C.Utils.mergeMorphTargetTracks(e.clone(),t)).tracks,i=[],a=[],o=0;o<n.length;++o){var s=n[o],c=r.PropertyBinding.parseTrackName(s.name),l=r.PropertyBinding.findNode(t,c.nodeName),u=S[c.propertyName];if("bones"===c.objectName&&(l=!0===l.isSkinnedMesh?l.skeleton.getBoneByName(c.objectIndex):void 0),!l||!u)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',s.name),null;var h,d=s.values.length/s.times.length;u===S.morphTargetInfluences&&(d/=l.morphTargetInfluences.length),!0===s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(h="CUBICSPLINE",d/=3):h=s.getInterpolation()===r.InterpolateDiscrete?"STEP":"LINEAR",a.push({input:U(new r.BufferAttribute(s.times,1)),output:U(new r.BufferAttribute(s.values,d)),interpolation:h}),i.push({sampler:a.length-1,target:{node:T.get(l),path:u}})}return b.animations.push({name:e.name||"clip_"+b.animations.length,samplers:a,channels:i}),b.animations.length-1}function Y(e){var t=b.nodes[T.get(e)],n=e.skeleton,i=e.skeleton.bones[0];if(void 0===i)return null;for(var a=[],o=new Float32Array(16*n.bones.length),s=0;s<n.bones.length;++s)a.push(T.get(n.bones[s])),n.boneInverses[s].toArray(o,16*s);return void 0===b.skins&&(b.skins=[]),b.skins.push({inverseBindMatrices:U(new r.BufferAttribute(o,16)),joints:a,skeleton:T.get(i)}),t.skin=b.skins.length-1}function K(e){var t={};e.name&&(t.name=e.name),t.color=e.color.toArray(),t.intensity=e.intensity,e.isDirectionalLight?t.type="directional":e.isPointLight?(t.type="point",e.distance>0&&(t.range=e.distance)):e.isSpotLight&&(t.type="spot",e.distance>0&&(t.range=e.distance),t.spot={},t.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,t.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!e.target||e.target.parent===e&&0===e.target.position.x&&0===e.target.position.y&&-1===e.target.position.z||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1.");var n=b.extensions.KHR_lights_punctual.lights;return n.push(t),n.length-1}function J(e){b.nodes||(b.nodes=[]);var t={};if(v.trs){var n=e.quaternion.toArray(),i=e.position.toArray(),a=e.scale.toArray();k(n,[0,0,0,1])||(t.rotation=n),k(i,[0,0,0])||(t.translation=i),k(a,[1,1,1])||(t.scale=a)}else e.matrixAutoUpdate&&e.updateMatrix(),k(e.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])||(t.matrix=e.matrix.elements);if(""!==e.name&&(t.name=String(e.name)),H(e,t),e.isMesh||e.isLine||e.isPoints){var o=q(e);null!==o&&(t.mesh=o)}else if(e.isCamera)t.camera=function(e){b.cameras||(b.cameras=[]);var t=e.isOrthographicCamera,n={type:t?"orthographic":"perspective"};return t?n.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:n.perspective={aspectRatio:e.aspect,yfov:r.Math.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(n.name=e.type),b.cameras.push(n),b.cameras.length-1}(e);else if(e.isDirectionalLight||e.isPointLight||e.isSpotLight)P.KHR_lights_punctual||(b.extensions=b.extensions||{},b.extensions.KHR_lights_punctual={lights:[]},P.KHR_lights_punctual=!0),t.extensions=t.extensions||{},t.extensions.KHR_lights_punctual={light:K(e)};else if(e.isLight)return console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e),null;if(e.isSkinnedMesh&&R.push(e),e.children.length>0){for(var s=[],c=0,l=e.children.length;c<l;c++){var u=e.children[c];if(u.visible||!1===v.onlyVisible){var h=J(u);null!==h&&s.push(h)}}s.length>0&&(t.children=s)}b.nodes.push(t);var d=b.nodes.length-1;return T.set(e,d),d}function Z(e){b.scenes||(b.scenes=[],b.scene=0);var t={nodes:[]};""!==e.name&&(t.name=e.name),e.userData&&Object.keys(e.userData).length>0&&(t.extras=H(e)),b.scenes.push(t);for(var n=[],r=0,i=e.children.length;r<i;r++){var a=e.children[r];if(a.visible||!1===v.onlyVisible){var o=J(a);null!==o&&n.push(o)}}n.length>0&&(t.nodes=n),H(e,t)}try{!function(e){e=e instanceof Array?e:[e];for(var t=[],n=0;n<e.length;n++)e[n]instanceof r.Scene?Z(e[n]):t.push(e[n]);for(t.length>0&&function(e){var t=new r.Scene;t.name="AuxScene";for(var n=0;n<e.length;n++)t.children.push(e[n]);Z(t)}(t),n=0;n<R.length;++n)Y(R[n]);for(n=0;n<v.animations.length;++n)X(v.animations[n],e[0])}(e)}catch(e){n(e)}Promise.all(A).then((function(){return new Promise((function(e,t){if(b.buffers&&b.buffers.length>0){var n=new Blob(M,{type:"application/octet-stream"});b.buffers[0].byteLength=n.size,"gltf"===v.mode&&(b.buffers[0].uri="scene.bin"),x.push(n)}e()}))})).then((function(){var e=Object.keys(P);e.length>0&&(b.extensionsUsed=e),t({json:b,buffers:x,images:w})})).catch(n)},createGLBBlob:function(e,t,n){if(e.buffers.length>1)n(new Error("GLTFExporter: exportGLB expects 0 or 1 buffers."));else{var r=[],i=[],a=new ArrayBuffer(12),o=new DataView(a);o.setUint32(0,1179937895,!0),o.setUint32(4,2,!0),i.push(a);var s,c=C.Utils.getPaddedArrayBuffer(function(e){if(void 0!==window.TextEncoder)return(new TextEncoder).encode(e).buffer;for(var t=new Uint8Array(new ArrayBuffer(e.length)),n=0,r=e.length;n<r;n++){var i=e.charCodeAt(n);t[n]=i>255?32:i}return t.buffer}(JSON.stringify(e.json)),32),l=new DataView(new ArrayBuffer(8));if(l.setUint32(0,c.byteLength,!0),l.setUint32(4,1313821514,!0),i.push(l,c),0!==e.buffers.length){var u=(s=e.buffers[0],new Promise((function(e,t){var n=new window.FileReader;n.readAsArrayBuffer(s),n.onloadend=function(){var t=C.Utils.getPaddedArrayBuffer(n.result);e(t)},n.onerror=t}))).then((function(e){var t=new DataView(new ArrayBuffer(8));t.setUint32(0,e.byteLength,!0),t.setUint32(4,5130562,!0);var n=12+l.byteLength+c.byteLength+t.byteLength+e.byteLength;o.setUint32(8,n,!0),i.push(t,e)}));r.push(u)}Promise.all(r).then((function(){var e=new Blob(i,{type:"application/octet-stream"});t(e)})).catch(n)}},parse:function(e,t,n,r){"object"==typeof n&&console.warn("THREE.GLTFExporter: .parse() now expects ( input, onDone, onError, options )."),r&&void 0!==r.binary&&console.warn('THREE.GLTFExporter: options.binary has been deprecated. Use options.mode = "glb" instead.');var i=this;this.parseChunks(e,(function(e){"gltf"===r.mode?t(e):i.createGLBBlob(e,t,n)}),n,r)}},C.Utils={getPaddedBufferSize:e=>4*Math.ceil(e/4),getPaddedArrayBuffer(e,t){t=t||0;var n=C.Utils.getPaddedBufferSize(e.byteLength);if(n!==e.byteLength){var r=new Uint8Array(n);if(r.set(new Uint8Array(e)),0!==t)for(var i=e.byteLength;i<n;i++)r[i]=t;return r.buffer}return e},insertKeyframe:function(e,t){var n,r=e.getValueSize(),i=new e.TimeBufferType(e.times.length+1),a=new e.ValueBufferType(e.values.length+r),o=e.createInterpolant(new e.ValueBufferType(r));if(0===e.times.length){i[0]=t;for(var s=0;s<r;s++)a[s]=0;n=0}else if(t<e.times[0]){if(Math.abs(e.times[0]-t)<.001)return 0;i[0]=t,i.set(e.times,1),a.set(o.evaluate(t),0),a.set(e.values,r),n=0}else if(t>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-t)<.001)return e.times.length-1;i[i.length-1]=t,i.set(e.times,0),a.set(e.values,0),a.set(o.evaluate(t),e.values.length),n=i.length-1}else for(s=0;s<e.times.length;s++){if(Math.abs(e.times[s]-t)<.001)return s;if(e.times[s]<t&&e.times[s+1]>t){i.set(e.times.slice(0,s+1),0),i[s+1]=t,i.set(e.times.slice(s+1),s+2),a.set(e.values.slice(0,(s+1)*r),0),a.set(o.evaluate(t),(s+1)*r),a.set(e.values.slice((s+1)*r),(s+2)*r),n=s+1;break}}return e.times=i,e.values=a,n},mergeMorphTargetTracks:function(e,t){for(var n=[],i={},a=e.tracks,o=0;o<a.length;++o){var s=a[o],c=r.PropertyBinding.parseTrackName(s.name),l=r.PropertyBinding.findNode(t,c.nodeName);if("morphTargetInfluences"===c.propertyName&&void 0!==c.propertyIndex){if(s.createInterpolant!==s.InterpolantFactoryMethodDiscrete&&s.createInterpolant!==s.InterpolantFactoryMethodLinear){if(s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),(s=s.clone()).setInterpolation(r.InterpolateLinear)}var u,h=l.morphTargetInfluences.length,d=l.morphTargetDictionary[c.propertyIndex];if(void 0===d)throw new Error("THREE.GLTFExporter: Morph target name not found: "+c.propertyIndex);if(void 0!==i[l.uuid]){var p=s.createInterpolant(new s.ValueBufferType(1));u=i[l.uuid];for(g=0;g<u.times.length;g++)u.values[g*h+d]=p.evaluate(u.times[g]);for(g=0;g<s.times.length;g++){var f=this.insertKeyframe(u,s.times[g]);u.values[f*h+d]=s.values[g]}}else{for(var m=new((u=s.clone()).ValueBufferType)(h*u.times.length),g=0;g<u.times.length;g++)m[g*h+d]=u.values[g];u.name=".morphTargetInfluences",u.values=m,i[l.uuid]=u,n.push(u)}}else n.push(s)}return e.tracks=n,e}}},67:function(e,t,n){var r=n(224),i=n(22).components,a=n(113).registerElement,o=n(24),s=o.debug,c=o.entity.setComponentProperty,l=s("extras:primitives:debug"),u=s("extras:primitives:warn"),h=e.exports.primitives={};e.exports.registerPrimitive=function(e,t){e=e.toLowerCase(),l("Registering <%s>",e),t.defaultAttributes&&u("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var n=a(e,{prototype:Object.create(r.prototype,{defaultComponentsFromPrimitive:{value:t.defaultComponents||t.defaultAttributes||{}},deprecated:{value:t.deprecated||null},deprecatedMappings:{value:t.deprecatedMappings||{}},mappings:{value:t.mappings||{}},createdCallback:{value:function(){t.deprecated&&console.warn(t.deprecated),this.resolveMappingCollisions()}},resolveMappingCollisions:{value:function(){var e=this.mappings,t=this;Object.keys(e).forEach((function(n){var r;n!==n.toLowerCase()&&u("Mapping keys should be specified in lower case. The mapping key "+n+" may not be recognized"),i[n]&&(r=e[n].replace(".","-"),e[r]=e[n],delete e[n],console.warn("The primitive "+t.tagName.toLowerCase()+" has a mapping collision. The attribute "+n+" has the same name as a registered component and has been renamed to "+r))}))}},getExtraComponents:{value:function(){var e,t,n,r,i,a,s=this;for(t=o.clone(this.defaultComponentsFromPrimitive),(i=this.getAttribute("mixin"))&&(i=i.trim().split(" ")).forEach((function(e){var n=s.sceneEl.querySelector("#"+e).componentCache;Object.keys(n).forEach((function(e){t[e]=function(e,t){if(c(e))return l(t);if(c(t))return l(e);if(u(e)&&u(t))return o.extendDeep(e,t);return l(t)}(t[e],n[e])}))})),n=0;n<this.attributes.length;n++)e=this.attributes[n],(r=this.mappings[e.name])&&((a=o.entity.getComponentPropertyPath(r)).constructor===Array?(t[a[0]]=t[a[0]]||{},t[a[0]][a[1]]=e.value.trim()):t[a]=e.value.trim());return t;function c(e){return void 0===e}function l(e){return u(e)?o.extendDeep({},e):e}function u(e){return null!==e&&e.constructor===Object}}},attributeChangedCallback:{value:function(e,t,n){var r=this.mappings[e];e in this.deprecatedMappings&&console.warn(this.deprecatedMappings[e]),e&&r&&c(this,r,n)}}})});return h[e]=n,n},e.exports.definePrimitive=function(t,n,r){r=r||{},Object.keys(n).map((function(e){!function(e,t){var n=i[e].schema;Object.keys(n).map((function(n){var r=n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();void 0!==t[r]&&(r=e+"-"+n),t[r]=e+"."+n}))}(e,r)})),e.exports.registerPrimitive(t,o.extendDeep({},null,{defaultComponents:n,mappings:r}))}},810:function(e,t){e.exports=function(e){return/(iphone|ipod|ipad).*os.(7_|8_|9_)/i.test(e)}},815:function(e,t,n){(function(t){var r,i=n(200)("device:error");function a(){return r}window.addEventListener("vrdisplayactivate",(function(e){var t;navigator.xr||(t=document.createElement("canvas"),(r=e.display).requestPresent([{source:t}]).then((function(){}),(function(){})))})),navigator.xr?navigator.xr.requestDevice().then((function(e){e&&e.supportsSession({immersive:!0,exclusive:!0}).then((function(){var t=document.querySelector("a-scene");r=e,t&&t.emit("displayconnected",{vrDisplay:r})}))})).catch((function(e){i("WebXR Request Device: "+e.message)})):navigator.getVRDisplays&&navigator.getVRDisplays().then((function(e){var t=document.querySelector("a-scene");r=e.length&&e[0],t&&t.emit("displayconnected",{vrDisplay:r})})),e.exports.isWebXRAvailable=void 0!==navigator.xr,e.exports.getVRDisplay=a,e.exports.checkHeadsetConnected=function(){return!!a()};var o,s,c=(s=!1,o=window.navigator.userAgent||window.navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(o)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(o.substr(0,4)))&&(s=!0),(u()||l()||d())&&(s=!0),h()&&(s=!1),function(){return s});function l(e){var t=e||window.navigator.userAgent;return/ipad|Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(t)}function u(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}function h(){return/(OculusBrowser)|(SamsungBrowser)|(Mobile VR)/i.test(window.navigator.userAgent)}function d(){return/R7 Build/.test(window.navigator.userAgent)}e.exports.isMobile=c,e.exports.isTablet=l,e.exports.isIOS=u,e.exports.isMobileVR=h,e.exports.isR7=d,e.exports.isLandscape=function(){var e=window.orientation;return d()&&(e+=90),90===e||-90===e},e.exports.isBrowserEnvironment=!(t&&!t.browser),e.exports.isNodeEnvironment=!e.exports.isBrowserEnvironment,e.exports.PolyfillControls=function(e){var t,n=window.webvrpolyfill&&window.webvrpolyfill.getPolyfillDisplays()[0];window.VRFrameData&&(t=new window.VRFrameData),this.update=function(){var r;n&&(n.getFrameData(t),null!==(r=t.pose).orientation&&e.quaternion.fromArray(r.orientation),null!==r.position?e.position.fromArray(r.position):e.position.set(0,0,0))}}}).call(this,n(109))},816:function(e,t){var n=Object.freeze(Object.create(null));function r(){return{}}function i(e){var t;if(e&&e.constructor===Object)for(t in e)e[t]=void 0}e.exports.createPool=function(e){var t=[],a=null;function o(n){var r,i;if((n=void 0===n?t.length:n)>0&&null==a&&(a=0),n>0)for(r=t.length,t.length+=Number(n),i=r;i<t.length;i++)t[i]=e();return t.length}return e=e||r,{grow:o,pool:t,recycle:function(e){e instanceof Object&&(null!==a&&-1!==a?t[--a]=e:t[t.length]=e)},size:function(){return t.length},use:function(){var e;return null!==a&&a!==t.length||o(t.length||5),e=t[a],t[a++]=n,i(e),e}}},e.exports.clearObject=i},817:function(e,t){var n={};function r(e,t){return n[t=t||"."]||(n[t]={}),-1!==e.indexOf(t)?n[t][e]=e.split(t):n[t][e]=e,n[t][e]}e.exports.getComponentPropertyPath=r,e.exports.propertyPathCache=n,e.exports.getComponentProperty=function(e,t,n){var i;return n=n||".",-1!==t.indexOf(n)?(i=r(t,n)).constructor===String?e.getAttribute(i):e.getAttribute(i[0])[i[1]]:e.getAttribute(t)},e.exports.setComponentProperty=function(e,t,n,i){var a;i=i||".",-1===t.indexOf(i)?e.setAttribute(t,n):(a=r(t,i)).constructor===String?e.setAttribute(a,n):e.setAttribute(a[0],a[1],n)}},818:function(e,t){e.exports=function(e){var t=e.style.width,n=e.style.height;e.style.width=parseInt(t,10)+1+"px",e.style.height=parseInt(n,10)+1+"px",setTimeout((function(){e.style.width=t,e.style.height=n}),200)}},819:function(e,t){var n,r;e.exports=11===(n=-1,r=navigator.userAgent,"Microsoft Internet Explorer"===navigator.appName?null!=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})").exec(r)&&(n=parseFloat(RegExp.$1)):"Netscape"===navigator.appName&&null!=new RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})").exec(r)&&(n=parseFloat(RegExp.$1)),n)},820:function(e,t){THREE.DRACOLoader=function(e){this.timeLoaded=0,this.manager=e||THREE.DefaultLoadingManager,this.materials=null,this.verbosity=0,this.attributeOptions={},this.drawMode=THREE.TrianglesDrawMode,this.nativeAttributeMap={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"}},THREE.DRACOLoader.prototype={constructor:THREE.DRACOLoader,load:function(e,t,n,r){var i=this,a=new THREE.FileLoader(i.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.load(e,(function(e){i.decodeDracoFile(e,t)}),n,r)},setPath:function(e){return this.path=e,this},setVerbosity:function(e){return this.verbosity=e,this},setDrawMode:function(e){return this.drawMode=e,this},setSkipDequantization:function(e,t){var n=!0;return void 0!==t&&(n=t),this.getAttributeOptions(e).skipDequantization=n,this},decodeDracoFile:function(e,t,n,r){var i=this;THREE.DRACOLoader.getDecoderModule().then((function(a){i.decodeDracoFileInternal(e,a.decoder,t,n,r)}))},decodeDracoFileInternal:function(e,t,n,r,i){var a=new t.DecoderBuffer;a.Init(new Int8Array(e),e.byteLength);var o=new t.Decoder,s=o.GetEncodedGeometryType(a);if(s==t.TRIANGULAR_MESH)this.verbosity>0&&console.log("Loaded a mesh.");else{if(s!=t.POINT_CLOUD){var c="THREE.DRACOLoader: Unknown geometry type.";throw console.error(c),new Error(c)}this.verbosity>0&&console.log("Loaded a point cloud.")}n(this.convertDracoGeometryTo3JS(t,o,s,a,r,i))},addAttributeToGeometry:function(e,t,n,r,i,a,o,s){if(0===a.ptr){var c="THREE.DRACOLoader: No attribute "+r;throw console.error(c),new Error(c)}var l,u,h=a.num_components(),d=n.num_points()*h;switch(i){case Float32Array:l=new e.DracoFloat32Array,t.GetAttributeFloatForAllPoints(n,a,l),s[r]=new Float32Array(d),u=THREE.Float32BufferAttribute;break;case Int8Array:l=new e.DracoInt8Array,t.GetAttributeInt8ForAllPoints(n,a,l),s[r]=new Int8Array(d),u=THREE.Int8BufferAttribute;break;case Int16Array:l=new e.DracoInt16Array,t.GetAttributeInt16ForAllPoints(n,a,l),s[r]=new Int16Array(d),u=THREE.Int16BufferAttribute;break;case Int32Array:l=new e.DracoInt32Array,t.GetAttributeInt32ForAllPoints(n,a,l),s[r]=new Int32Array(d),u=THREE.Int32BufferAttribute;break;case Uint8Array:l=new e.DracoUInt8Array,t.GetAttributeUInt8ForAllPoints(n,a,l),s[r]=new Uint8Array(d),u=THREE.Uint8BufferAttribute;break;case Uint16Array:l=new e.DracoUInt16Array,t.GetAttributeUInt16ForAllPoints(n,a,l),s[r]=new Uint16Array(d),u=THREE.Uint16BufferAttribute;break;case Uint32Array:l=new e.DracoUInt32Array,t.GetAttributeUInt32ForAllPoints(n,a,l),s[r]=new Uint32Array(d),u=THREE.Uint32BufferAttribute;break;default:c="THREE.DRACOLoader: Unexpected attribute type.";throw console.error(c),new Error(c)}for(var p=0;p<d;p++)s[r][p]=l.GetValue(p);o.addAttribute(r,new u(s[r],h)),e.destroy(l)},convertDracoGeometryTo3JS:function(e,t,n,r,i,a){var o,s;!0===this.getAttributeOptions("position").skipDequantization&&t.SkipAttributeTransform(e.POSITION);var c=performance.now();if(n===e.TRIANGULAR_MESH?(o=new e.Mesh,s=t.DecodeBufferToMesh(r,o)):(o=new e.PointCloud,s=t.DecodeBufferToPointCloud(r,o)),!s.ok()||0==o.ptr){var l="THREE.DRACOLoader: Decoding failed: ";throw l+=s.error_msg(),console.error(l),e.destroy(t),e.destroy(o),new Error(l)}var u,h=performance.now();e.destroy(r),n==e.TRIANGULAR_MESH?(u=o.num_faces(),this.verbosity>0&&console.log("Number of faces loaded: "+u.toString())):u=0;var d=o.num_points(),p=o.num_attributes();this.verbosity>0&&(console.log("Number of points loaded: "+d.toString()),console.log("Number of attributes loaded: "+p.toString()));var f=t.GetAttributeId(o,e.POSITION);if(-1==f){l="THREE.DRACOLoader: No position attribute found.";throw console.error(l),e.destroy(t),e.destroy(o),new Error(l)}var m=t.GetAttribute(o,f),g={},v=new THREE.BufferGeometry;if(i)for(var y in i){var b=a[y],x=i[y],w=t.GetAttributeByUniqueId(o,x);this.addAttributeToGeometry(e,t,o,y,b,w,v,g)}else for(var y in this.nativeAttributeMap){var E=t.GetAttributeId(o,e[this.nativeAttributeMap[y]]);if(-1!==E){this.verbosity>0&&console.log("Loaded "+y+" attribute.");w=t.GetAttribute(o,E);this.addAttributeToGeometry(e,t,o,y,Float32Array,w,v,g)}}if(n==e.TRIANGULAR_MESH)if(this.drawMode===THREE.TriangleStripDrawMode){var M=new e.DracoInt32Array;t.GetTriangleStripsFromMesh(o,M),g.indices=new Uint32Array(M.size());for(var A=0;A<M.size();++A)g.indices[A]=M.GetValue(A);e.destroy(M)}else{var T=3*u;g.indices=new Uint32Array(T);var _=new e.DracoInt32Array;for(A=0;A<u;++A){t.GetFaceFromMesh(o,A,_);var S=3*A;g.indices[S]=_.GetValue(0),g.indices[S+1]=_.GetValue(1),g.indices[S+2]=_.GetValue(2)}e.destroy(_)}v.drawMode=this.drawMode,n==e.TRIANGULAR_MESH&&v.setIndex(new(g.indices.length>65535?THREE.Uint32BufferAttribute:THREE.Uint16BufferAttribute)(g.indices,1));var L=new e.AttributeQuantizationTransform;if(L.InitFromAttribute(m)){v.attributes.position.isQuantized=!0,v.attributes.position.maxRange=L.range(),v.attributes.position.numQuantizationBits=L.quantization_bits(),v.attributes.position.minValues=new Float32Array(3);for(A=0;A<3;++A)v.attributes.position.minValues[A]=L.min_value(A)}return e.destroy(L),e.destroy(t),e.destroy(o),this.decode_time=h-c,this.import_time=performance.now()-h,this.verbosity>0&&(console.log("Decode time: "+this.decode_time),console.log("Import time: "+this.import_time)),v},isVersionSupported:function(e,t){THREE.DRACOLoader.getDecoderModule().then((function(n){t(n.decoder.isVersionSupported(e))}))},getAttributeOptions:function(e){return void 0===this.attributeOptions[e]&&(this.attributeOptions[e]={}),this.attributeOptions[e]}},THREE.DRACOLoader.decoderPath="./",THREE.DRACOLoader.decoderConfig={},THREE.DRACOLoader.decoderModulePromise=null,THREE.DRACOLoader.setDecoderPath=function(e){THREE.DRACOLoader.decoderPath=e},THREE.DRACOLoader.setDecoderConfig=function(e){var t=THREE.DRACOLoader.decoderConfig.wasmBinary;THREE.DRACOLoader.decoderConfig=e||{},THREE.DRACOLoader.releaseDecoderModule(),t&&(THREE.DRACOLoader.decoderConfig.wasmBinary=t)},THREE.DRACOLoader.releaseDecoderModule=function(){THREE.DRACOLoader.decoderModulePromise=null},THREE.DRACOLoader.getDecoderModule=function(){var e=this,t=THREE.DRACOLoader.decoderPath,n=THREE.DRACOLoader.decoderConfig,r=THREE.DRACOLoader.decoderModulePromise;return r||("undefined"!=typeof DracoDecoderModule?r=Promise.resolve():"object"!=typeof WebAssembly||"js"===n.type?r=THREE.DRACOLoader._loadScript(t+"draco_decoder.js"):(n.wasmBinaryFile=t+"draco_decoder.wasm",r=THREE.DRACOLoader._loadScript(t+"draco_wasm_wrapper.js").then((function(){return THREE.DRACOLoader._loadArrayBuffer(n.wasmBinaryFile)})).then((function(e){n.wasmBinary=e}))),r=r.then((function(){return new Promise((function(t){n.onModuleLoaded=function(n){e.timeLoaded=performance.now(),t({decoder:n})},DracoDecoderModule(n)}))})),THREE.DRACOLoader.decoderModulePromise=r,r)},THREE.DRACOLoader._loadScript=function(e){var t=document.getElementById("decoder_script");null!==t&&t.parentNode.removeChild(t);var n=document.getElementsByTagName("head")[0],r=document.createElement("script");return r.id="decoder_script",r.type="text/javascript",r.src=e,new Promise((function(e){r.onload=e,n.appendChild(r)}))},THREE.DRACOLoader._loadArrayBuffer=function(e){var t=new THREE.FileLoader;return t.setResponseType("arraybuffer"),new Promise((function(n,r){t.load(e,n,void 0,r)}))}},821:function(e,t){THREE.OBJLoader=function(){var e=/^[og]\s*(.+)?/,t=/^mtllib /,n=/^usemtl /;function r(){var e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);var n=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(e,t){var n=this._finalize(!1);n&&(n.inherited||n.groupCount<=0)&&this.materials.splice(n.index,1);var r={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==n?n.smooth:this.smooth,groupStart:void 0!==n?n.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){var t={index:"number"==typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(r),r},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(var n=this.materials.length-1;n>=0;n--)this.materials[n].groupCount<=0&&this.materials.splice(n,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},n&&n.name&&"function"==typeof n.clone){var r=n.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){var n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseNormalIndex:function(e,t){var n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseUVIndex:function(e,t){var n=parseInt(e,10);return 2*(n>=0?n-1:n+t/2)},addVertex:function(e,t,n){var r=this.vertices,i=this.object.geometry.vertices;i.push(r[e+0],r[e+1],r[e+2]),i.push(r[t+0],r[t+1],r[t+2]),i.push(r[n+0],r[n+1],r[n+2])},addVertexPoint:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,n){var r=this.normals,i=this.object.geometry.normals;i.push(r[e+0],r[e+1],r[e+2]),i.push(r[t+0],r[t+1],r[t+2]),i.push(r[n+0],r[n+1],r[n+2])},addColor:function(e,t,n){var r=this.colors,i=this.object.geometry.colors;i.push(r[e+0],r[e+1],r[e+2]),i.push(r[t+0],r[t+1],r[t+2]),i.push(r[n+0],r[n+1],r[n+2])},addUV:function(e,t,n){var r=this.uvs,i=this.object.geometry.uvs;i.push(r[e+0],r[e+1]),i.push(r[t+0],r[t+1]),i.push(r[n+0],r[n+1])},addUVLine:function(e){var t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,n,r,i,a,o,s,c){var l=this.vertices.length,u=this.parseVertexIndex(e,l),h=this.parseVertexIndex(t,l),d=this.parseVertexIndex(n,l);if(this.addVertex(u,h,d),void 0!==r&&""!==r){var p=this.uvs.length;u=this.parseUVIndex(r,p),h=this.parseUVIndex(i,p),d=this.parseUVIndex(a,p),this.addUV(u,h,d)}if(void 0!==o&&""!==o){var f=this.normals.length;u=this.parseNormalIndex(o,f),h=o===s?u:this.parseNormalIndex(s,f),d=o===c?u:this.parseNormalIndex(c,f),this.addNormal(u,h,d)}this.colors.length>0&&this.addColor(u,h,d)},addPointGeometry:function(e){this.object.geometry.type="Points";for(var t=this.vertices.length,n=0,r=e.length;n<r;n++)this.addVertexPoint(this.parseVertexIndex(e[n],t))},addLineGeometry:function(e,t){this.object.geometry.type="Line";for(var n=this.vertices.length,r=this.uvs.length,i=0,a=e.length;i<a;i++)this.addVertexLine(this.parseVertexIndex(e[i],n));var o=0;for(a=t.length;o<a;o++)this.addUVLine(this.parseUVIndex(t[o],r))}};return e.startObject("",!1),e}function i(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.materials=null}return i.prototype={constructor:i,load:function(e,t,n,r){var i=this,a=new THREE.FileLoader(i.manager);a.setPath(this.path),a.load(e,(function(e){t(i.parse(e))}),n,r)},setPath:function(e){return this.path=e,this},setMaterials:function(e){return this.materials=e,this},parse:function(i){console.time("OBJLoader");var a=new r;-1!==i.indexOf("\r\n")&&(i=i.replace(/\r\n/g,"\n")),-1!==i.indexOf("\\\n")&&(i=i.replace(/\\\n/g,""));for(var o=i.split("\n"),s="",c="",l=[],u="function"==typeof"".trimLeft,h=0,d=o.length;h<d;h++)if(s=o[h],0!==(s=u?s.trimLeft():s.trim()).length&&"#"!==(c=s.charAt(0)))if("v"===c){var p=s.split(/\s+/);switch(p[0]){case"v":a.vertices.push(parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3])),8===p.length&&a.colors.push(parseFloat(p[4]),parseFloat(p[5]),parseFloat(p[6]));break;case"vn":a.normals.push(parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3]));break;case"vt":a.uvs.push(parseFloat(p[1]),parseFloat(p[2]))}}else if("f"===c){for(var f=s.substr(1).trim().split(/\s+/),m=[],g=0,v=f.length;g<v;g++){var y=f[g];if(y.length>0){var b=y.split("/");m.push(b)}}var x=m[0];for(g=1,v=m.length-1;g<v;g++){var w=m[g],E=m[g+1];a.addFace(x[0],w[0],E[0],x[1],w[1],E[1],x[2],w[2],E[2])}}else if("l"===c){var M=s.substring(1).trim().split(" "),A=[],T=[];if(-1===s.indexOf("/"))A=M;else for(var _=0,S=M.length;_<S;_++){var L=M[_].split("/");""!==L[0]&&A.push(L[0]),""!==L[1]&&T.push(L[1])}a.addLineGeometry(A,T)}else if("p"===c){var C=s.substr(1).trim().split(" ");a.addPointGeometry(C)}else if(null!==(l=e.exec(s))){var R=(" "+l[0].substr(1).trim()).substr(1);a.startObject(R)}else if(n.test(s))a.object.startMaterial(s.substring(7).trim(),a.materialLibraries);else if(t.test(s))a.materialLibraries.push(s.substring(7).trim());else{if("s"!==c){if("\0"===s)continue;throw new Error('THREE.OBJLoader: Unexpected line: "'+s+'"')}if((l=s.split(" ")).length>1){var P=l[1].trim().toLowerCase();a.object.smooth="0"!==P&&"off"!==P}else a.object.smooth=!0;(W=a.object.currentMaterial())&&(W.smooth=a.object.smooth)}a.finalize();var O=new THREE.Group;O.materialLibraries=[].concat(a.materialLibraries);for(h=0,d=a.objects.length;h<d;h++){var D=a.objects[h],I=D.geometry,B=D.materials,k="Line"===I.type,H="Points"===I.type,N=!1;if(0!==I.vertices.length){var F=new THREE.BufferGeometry;F.addAttribute("position",new THREE.Float32BufferAttribute(I.vertices,3)),I.normals.length>0?F.addAttribute("normal",new THREE.Float32BufferAttribute(I.normals,3)):F.computeVertexNormals(),I.colors.length>0&&(N=!0,F.addAttribute("color",new THREE.Float32BufferAttribute(I.colors,3))),I.uvs.length>0&&F.addAttribute("uv",new THREE.Float32BufferAttribute(I.uvs,2));for(var U,z=[],V=0,j=B.length;V<j;V++){var G=B[V],W=void 0;if(null!==this.materials)if(W=this.materials.create(G.name),!k||!W||W instanceof THREE.LineBasicMaterial){if(H&&W&&!(W instanceof THREE.PointsMaterial)){var q=new THREE.PointsMaterial({size:10,sizeAttenuation:!1});THREE.Material.prototype.copy.call(q,W),q.color.copy(W.color),q.map=W.map,q.lights=!1,W=q}}else{var X=new THREE.LineBasicMaterial;THREE.Material.prototype.copy.call(X,W),X.color.copy(W.color),X.lights=!1,W=X}W||((W=k?new THREE.LineBasicMaterial:H?new THREE.PointsMaterial({size:1,sizeAttenuation:!1}):new THREE.MeshPhongMaterial).name=G.name),W.flatShading=!G.smooth,W.vertexColors=N?THREE.VertexColors:THREE.NoColors,z.push(W)}if(z.length>1){for(V=0,j=B.length;V<j;V++){G=B[V];F.addGroup(G.groupStart,G.groupCount,V)}U=k?new THREE.LineSegments(F,z):H?new THREE.Points(F,z):new THREE.Mesh(F,z)}else U=k?new THREE.LineSegments(F,z[0]):H?new THREE.Points(F,z[0]):new THREE.Mesh(F,z[0]);U.name=D.name,O.add(U)}}return console.timeEnd("OBJLoader"),O}},i}()},822:function(e,t){THREE.MTLLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.MTLLoader.prototype={constructor:THREE.MTLLoader,crossOrigin:"anonymous",load:function(e,t,n,r){var i=this,a=void 0===this.path?THREE.LoaderUtils.extractUrlBase(e):this.path,o=new THREE.FileLoader(this.manager);o.setPath(this.path),o.load(e,(function(e){t(i.parse(e,a))}),n,r)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setTexturePath:function(e){return console.warn("THREE.MTLLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setMaterialOptions:function(e){return this.materialOptions=e,this},parse:function(e,t){for(var n=e.split("\n"),r={},i=/\s+/,a={},o=0;o<n.length;o++){var s=n[o];if(0!==(s=s.trim()).length&&"#"!==s.charAt(0)){var c=s.indexOf(" "),l=c>=0?s.substring(0,c):s;l=l.toLowerCase();var u=c>=0?s.substring(c+1):"";if(u=u.trim(),"newmtl"===l)r={name:u},a[u]=r;else if("ka"===l||"kd"===l||"ks"===l||"ke"===l){var h=u.split(i,3);r[l]=[parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2])]}else r[l]=u}}var d=new THREE.MTLLoader.MaterialCreator(this.resourcePath||t,this.materialOptions);return d.setCrossOrigin(this.crossOrigin),d.setManager(this.manager),d.setMaterials(a),d}},THREE.MTLLoader.MaterialCreator=function(e,t){this.baseUrl=e||"",this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping},THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(e){return this.crossOrigin=e,this},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var n in e){var r=e[n],i={};for(var a in t[n]=i,r){var o=!0,s=r[a],c=a.toLowerCase();switch(c){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[2]&&(o=!1)}o&&(i[c]=s)}}return t},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray},create:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]},createMaterial_:function(e){var t=this,n=this.materialsInfo[e],r={name:e,side:this.side};function i(e,n){if(!r[e]){var i,a,o=t.getTextureParams(n,r),s=t.loadTexture((i=t.baseUrl,"string"!=typeof(a=o.url)||""===a?"":/^https?:\/\//i.test(a)?a:i+a));s.repeat.copy(o.scale),s.offset.copy(o.offset),s.wrapS=t.wrap,s.wrapT=t.wrap,r[e]=s}}for(var a in n){var o,s=n[a];if(""!==s)switch(a.toLowerCase()){case"kd":r.color=(new THREE.Color).fromArray(s);break;case"ks":r.specular=(new THREE.Color).fromArray(s);break;case"ke":r.emissive=(new THREE.Color).fromArray(s);break;case"map_kd":i("map",s);break;case"map_ks":i("specularMap",s);break;case"map_ke":i("emissiveMap",s);break;case"norm":i("normalMap",s);break;case"map_bump":case"bump":i("bumpMap",s);break;case"map_d":i("alphaMap",s),r.transparent=!0;break;case"ns":r.shininess=parseFloat(s);break;case"d":(o=parseFloat(s))<1&&(r.opacity=o,r.transparent=!0);break;case"tr":o=parseFloat(s),this.options&&this.options.invertTrProperty&&(o=1-o),o>0&&(r.opacity=1-o,r.transparent=!0)}}return this.materials[e]=new THREE.MeshPhongMaterial(r),this.materials[e]},getTextureParams:function(e,t){var n,r={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)},i=e.split(/\s+/);return(n=i.indexOf("-bm"))>=0&&(t.bumpScale=parseFloat(i[n+1]),i.splice(n,2)),(n=i.indexOf("-s"))>=0&&(r.scale.set(parseFloat(i[n+1]),parseFloat(i[n+2])),i.splice(n,4)),(n=i.indexOf("-o"))>=0&&(r.offset.set(parseFloat(i[n+1]),parseFloat(i[n+2])),i.splice(n,4)),r.url=i.join(" ").trim(),r},loadTexture:function(e,t,n,r,i){var a,o=THREE.Loader.Handlers.get(e),s=void 0!==this.manager?this.manager:THREE.DefaultLoadingManager;return null===o&&(o=new THREE.TextureLoader(s)),o.setCrossOrigin&&o.setCrossOrigin(this.crossOrigin),a=o.load(e,n,r,i),void 0!==t&&(a.mapping=t),a}}},823:function(e,t){var n;e.exports.split=(n={},function(e,t){return t in n||(n[t]={}),e in n[t]?n[t][e]:(n[t][e]=e.split(t),n[t][e])})},824:function(e,t){var n=/-([a-z])/g;function r(e){return e.replace(n,c)}function i(e){var t,n;for(n in e)n!==(t=r(n))&&(e[t]=e[n],delete e[n]);return e}e.exports.parse=function(e,t){var n;return"string"!=typeof e?e:(n=function(e,t){var n,r,i,a,o,c;for(t=t||{},n=s(e),r=0;r<n.length;r++)(i=n[r])&&(a=i.indexOf(":"),o=i.substr(0,a).trim(),c=i.substr(a+1).trim(),t[o]=c);return t}(e,t))[""]?e:i(n)},e.exports.stringify=function(e){return"string"==typeof e?e:function(e){var t,n=0,r=0,i="";for(t in e)n++;for(t in e)i+=t+": "+e[t],r<n-1&&(i+="; "),r++;return i}(e)},e.exports.toCamelCase=r,e.exports.transformKeysToCamelCase=i;var a,o,s=(a=[],o=/url\([^)]+$/,function(e){var t,n="",r=0;for(a.length=0;r<e.length;)-1===(t=e.indexOf(";",r))&&(t=e.length),n+=e.substring(r,t),o.test(n)?(n+=";",r=t+1):(a.push(n.trim()),n="",r=t+1);return a});function c(e){return e[1].toUpperCase()}},825:function(e,t,n){var r=n(152).DEFAULT_HANDEDNESS,i=["x","y","z","w"];function a(e,t,n){var r,i,a=e.el.sceneEl,o=n.index||0;return!!t&&(!!(i=a&&a.systems["tracked-controls-webvr"])&&(!!(r=i.controllers).length&&!!s(r,null,t,n.hand,o)))}function o(e,t,n){var r,i=e.el.sceneEl,a=i&&i.systems["tracked-controls-webxr"];return!!a&&(!(!(r=a.controllers)||!r.length)&&c(r,n.hand))}function s(e,t,n,i,a){var o,s,c=0,l=a||0;for(s=0;s<e.length;s++)if(o=e[s],(!n||o.id.startsWith(n))&&(n||o.id===t)&&(!i||!o.hand||i===o.hand)){if(i&&!o.hand&&(l=2*a+(i===r?0:1)),c===l)return o;++c}}function c(e,t){var n,r;for(n=0;n<e.length;n++)if(r=e[n].handedness,!t||""===r&&"right"===t||e[n].handedness===t)return e[n]}e.exports.checkControllerPresentAndSetup=function(e,t,n){var r,i=e.el,s=i.sceneEl.hasWebXR;if(r=!!(s?o:a)(e,t,n),!e.controllerPresent||e.controllerEventsActive||s||e.addEventListeners(),r===e.controllerPresent)return r;e.controllerPresent=r,r?(e.injectTrackedControls(),s||e.addEventListeners(),i.emit("controllerconnected",{name:e.name,component:e})):(e.removeEventListeners(),i.emit("controllerdisconnected",{name:e.name,component:e}))},e.exports.isControllerPresentWebVR=a,e.exports.isControllerPresentWebXR=o,e.exports.findMatchingControllerWebVR=s,e.exports.findMatchingControllerWebXR=c,e.exports.emitIfAxesChanged=function(e,t,n){var r,a,o,s,c;for(a in t){for(r=t[a],o=!1,c=0;c<r.length;c++)n.detail.changed[r[c]]&&(o=!0);if(o){for(s={},c=0;c<r.length;c++)s[i[c]]=n.detail.axis[r[c]];e.el.emit(a+"moved",s)}}},e.exports.onButtonEvent=function(e,t,n,r){var i=(r?n.mapping[r]:n.mapping).buttons[e];n.el.emit(i+t),n.updateModel&&n.updateModel(i,t)}},826:function(e,t){e.exports={KEYCODE_TO_CODE:{38:"ArrowUp",37:"ArrowLeft",40:"ArrowDown",39:"ArrowRight",87:"KeyW",65:"KeyA",83:"KeyS",68:"KeyD"}}},827:function(e,t,n){var r=n(99)("utils:src-loader:warn");function i(e,t,n){!function(e,t){var n;if(e.tagName)return void t("IMG"===e.tagName);(n=new XMLHttpRequest).open("HEAD",e),n.addEventListener("load",(function(r){var i;n.status>=200&&n.status<300?null==(i=n.getResponseHeader("Content-Type"))?o(e,t):i.startsWith("image")?t(!0):t(!1):o(e,t),n.abort()})),n.send()}(e,(function(r){r?t(e):n(e)}))}function a(e){var t=e.match(/\url\((.+)\)/);if(t)return t[1]}function o(e,t){var n=new Image;n.addEventListener("load",(function(){t(!0)})),n.addEventListener("error",(function(){t(!1)})),n.src=e}e.exports={parseUrl:a,validateSrc:i,validateCubemapSrc:function(e,t){var n,o,s,c="",l=[];for(o=0;o<5;o++)c+="(url\\((?:[^\\)]+)\\),\\s*)";function u(e){l.push(e),6===l.length&&t(l)}if(c+="(url\\((?:[^\\)]+)\\)\\s*)",s=e.match(new RegExp(c)))for(o=1;o<7;o++)i(a(s[o]),u);else if(n=function(e){try{var t=document.querySelector(e);return t||r('No element was found matching the selector: "%s"',e),t}catch(t){return void r('"%s" is not a valid selector',e)}}(e))return"A-CUBEMAP"===n.tagName&&n.srcs?t(n.srcs):void r('Selector "%s" does not point to <a-cubemap>',e)}}},829:function(e,t,n){},830:function(e,t,n){},831:function(e,t,n){var r=n(832).inject,i=n(833),a=n(836),o=n(113),s=n(287),c=n(88).systems,l=n(19),u=n(24),h=n(224),d=n(171),p=n(839),f=n(89).shaders,m=u.bind,g=u.device.isIOS(),v=u.device.isMobile(),y=u.device.isWebXRAvailable,b=o.registerElement,x=u.debug("core:a-scene:warn");function w(e,t,n,r){return t?{height:e.parentElement.offsetHeight,width:e.parentElement.offsetWidth}:function(e,t){var n,r,i=window.devicePixelRatio;if(r={height:document.body.offsetHeight,width:document.body.offsetWidth},!e||t||-1===e.width&&-1===e.height)return r;if(r.width*i<e.width&&r.height*i<e.height)return r;n=r.width/r.height,r.width*i>e.width&&-1!==e.width&&(r.width=Math.round(e.width/i),r.height=Math.round(e.width/n/i));r.height*i>e.height&&-1!==e.height&&(r.height=Math.round(e.height/i),r.width=Math.round(e.height*n/i));return r}(n,r)}function E(e){var t;function n(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||e.exitVR(),document.activeElement.blur(),document.body.focus()}(t=document.createElement("canvas")).classList.add("a-canvas"),t.dataset.aframeCanvas=!0,e.appendChild(t),document.addEventListener("fullscreenchange",n),document.addEventListener("mozfullscreenchange",n),document.addEventListener("webkitfullscreenchange",n),t.addEventListener("touchmove",(function(e){e.preventDefault()})),e.canvas=t,e.emit("render-target-loaded",{target:t}),setTimeout(m(e.resize,e),0)}e.exports.AScene=b("a-scene",{prototype:Object.create(h.prototype,{createdCallback:{value:function(){this.clock=new l.Clock,this.isIOS=g,this.isMobile=v,this.hasWebXR=y,this.highRefreshRate=!1,this.isScene=!0,this.object3D=new l.Scene;var e=this;this.object3D.onAfterRender=function(t,n,r){e.isPlaying&&e.tock(e.time,e.delta,r)},this.render=m(this.render,this),this.systems={},this.systemNames=[],this.time=this.delta=0,this.behaviors={tick:[],tock:[]},this.hasLoaded=!1,this.isPlaying=!1,this.originalHTML=this.innerHTML}},addFullScreenStyles:{value:function(){document.documentElement.classList.add("a-fullscreen")}},removeFullScreenStyles:{value:function(){document.documentElement.classList.remove("a-fullscreen")}},attachedCallback:{value:function(){var e=this;E(this),this.setupRenderer(),this.resize(),this.addFullScreenStyles(),p(this),r(this),i(this),this.addEventListener("cameraready",(function(){e.attachedCallbackPostCamera()})),this.initSystems()}},attachedCallbackPostCamera:{value:function(){var e,t=this;e=m(this.resize,this),window.addEventListener("load",e),window.addEventListener("resize",(function(){t.isIOS?setTimeout(e,100):e()})),this.play(),s.push(this),this.onVRPresentChangeBound=m(this.onVRPresentChange,this),window.addEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),this.enterVRBound=function(){t.enterVR()},this.exitVRBound=function(){t.exitVR()},this.exitVRTrueBound=function(){t.exitVR(!0)},this.pointerRestrictedBound=function(){t.pointerRestricted()},this.pointerUnrestrictedBound=function(){t.pointerUnrestricted()},y||(window.addEventListener("vrdisplayactivate",this.enterVRBound),window.addEventListener("vrdisplaydeactivate",this.exitVRBound),window.addEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.addEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.addEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound))},writable:window.debug},initSystems:{value:function(){var e;for(e in this.initSystem("camera"),c)"camera"!==e&&this.initSystem(e)}},initSystem:{value:function(e){this.systems[e]||(this.systems[e]=new c[e](this),this.systemNames.push(e))}},detachedCallback:{value:function(){var e=s.indexOf(this);s.splice(e,1),window.removeEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),window.removeEventListener("vrdisplayactivate",this.enterVRBound),window.removeEventListener("vrdisplaydeactivate",this.exitVRBound),window.removeEventListener("vrdisplayconnect",this.enterVRBound),window.removeEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.removeEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.removeEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)}},addBehavior:{value:function(e){var t,n,r=this.behaviors;for(n in r)e[n]&&-1===(t=this.behaviors[n]).indexOf(e)&&t.push(e)}},getPointerLockElement:{value:function(){return document.pointerLockElement},writable:window.debug},checkHeadsetConnected:{value:u.device.checkHeadsetConnected,writable:window.debug},enterVR:{value:function(){var e,t=this,n=t.renderer.vr;if(this.is("vr-mode"))return Promise.resolve("Already in VR.");if(this.checkHeadsetConnected()||this.isMobile){e=u.device.getVRDisplay(),n.enabled=!0,n.setDevice(e);var r=this.getAttribute("renderer");if(!this.hasWebXR||r.forceWebVR){var i={highRefreshRate:r.highRefreshRate,foveationLevel:r.foveationLevel,multiview:n.multiview};return e.requestPresent([{source:this.canvas,attributes:i}]).then(a,(function(e){throw e&&e.message?new Error("Failed to enter VR mode (`requestPresent`): "+e.message):new Error("Failed to enter VR mode (`requestPresent`).")}))}return(this.xrSession&&this.xrSession.removeEventListener("end",this.exitVRBound),e.requestSession({immersive:!0,exclusive:!0}).then((function(e){t.xrSession=e,n.setSession(e),e.addEventListener("end",t.exitVRBound),e.requestFrameOfReference("stage").then((function(e){t.frameOfReference=e})),a()})),Promise.resolve())}return a(),Promise.resolve();function a(){var e;t.addState("vr-mode"),t.emit("enter-vr",{target:t}),t.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape"),t.addFullScreenStyles(),t.isMobile||t.checkHeadsetConnected()||((e=t.canvas).requestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen).apply(e),t.renderer.setAnimationLoop(t.render),t.resize()}},writable:!0},exitVR:{value:function(){var e,t=this,n=this.renderer.vr;if(!this.is("vr-mode"))return Promise.resolve("Not in VR.");if(this.checkHeadsetConnected()||this.isMobile){n.enabled=!1,e=u.device.getVRDisplay();var r=this.getAttribute("renderer");if(this.hasWebXR&&!r.forceWebVR)this.xrSession.removeEventListener("end",this.exitVRBound),this.xrSession.end(),n.setSession(null);else if(e.isPresenting)return e.exitPresent().then(i,(function(e){throw e&&e.message?new Error("Failed to exit VR mode (`exitPresent`): "+e.message):new Error("Failed to exit VR mode (`exitPresent`).")}))}else document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();return i(),Promise.resolve();function i(){t.removeState("vr-mode"),t.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),t.hasAttribute("embedded")&&t.removeFullScreenStyles(),t.resize(),t.isIOS&&u.forceCanvasResizeSafariMobile(t.canvas),t.emit("exit-vr",{target:t})}},writable:!0},pointerRestricted:{value:function(){if(this.canvas){var e=this.getPointerLockElement();e&&e!==this.canvas&&document.exitPointerLock&&document.exitPointerLock(),this.canvas.requestPointerLock&&this.canvas.requestPointerLock()}}},pointerUnrestricted:{value:function(){var e=this.getPointerLockElement();e&&e===this.canvas&&document.exitPointerLock&&document.exitPointerLock()}},onVRPresentChange:{value:function(e){(e.display||e.detail.display).isPresenting?this.enterVR():this.exitVR()}},getAttribute:{value:function(e){var t=this.systems[e];return t?t.data:h.prototype.getAttribute.call(this,e)}},getComputedAttribute:{value:function(e){x("`getComputedAttribute` is deprecated. Use `getAttribute` instead."),this.getAttribute(e)}},getDOMAttribute:{value:function(e){var t=this.systems[e];return t?t.data:h.prototype.getDOMAttribute.call(this,e)}},setAttribute:{value:function(e,t,n){var r=this.systems[e];if(r)return d.prototype.setAttribute.call(this,e,t),void r.updateProperties(t);h.prototype.setAttribute.call(this,e,t,n)}},removeBehavior:{value:function(e){var t,n,r,i=this.behaviors;for(n in i)e[n]&&-1!==(r=(t=this.behaviors[n]).indexOf(e))&&t.splice(r,1)}},resize:{value:function(){var e,t,n,r=this.camera,i=this.canvas;n=this.renderer.vr.getDevice(),e=this.renderer.vr.enabled&&n&&n.isPresenting,!r||!i||this.is("vr-mode")&&(this.isMobile||e)||(t=w(i,this.getAttribute("embedded")&&!this.is("vr-mode"),this.maxCanvasSize,this.is("vr-mode")),r.aspect=t.width/t.height,r.updateProjectionMatrix(),this.renderer.setSize(t.width,t.height,!1),this.emit("rendererresize",null,!1))},writable:!0},setupRenderer:{value:function(){var e,t,n,r,i=this;r={alpha:!0,antialias:!v,canvas:this.canvas,logarithmicDepthBuffer:!1,preuploadVideos:/Oculus/.test(navigator.userAgent)},this.maxCanvasSize={height:1920,width:1920};let o=!1;if(this.hasAttribute("renderer")){if(n=this.getAttribute("renderer"),o="true"===(t=u.styleParser.parse(n)).multiview,t.precision&&(r.precision=t.precision+"p"),t.antialias&&"auto"!==t.antialias&&(r.antialias="true"===t.antialias),t.logarithmicDepthBuffer&&"auto"!==t.logarithmicDepthBuffer&&(r.logarithmicDepthBuffer="true"===t.logarithmicDepthBuffer),t.alpha&&(r.alpha="true"===t.alpha),t.webgl2&&"true"===t.webgl2){const e=this.canvas.getContext("webgl2",{alpha:r.alpha,depth:!0,stencil:!0,antialias:r.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"});if(e){console.log("Using WebGL 2.0 context."),r.context=e;const t=!!e.getExtension("WEBGL_multiview")||!!e.getExtension("OVR_multiview");o&&!t&&(console.warn("Multiview enabled but WEBGL/OVR_multiview extension browser support not available"),o=!1);var s=/^\s*#version\s+300\s+es\s*\n/;for(var c in f){var h=f[c].Shader.prototype;if(!h.raw)continue;var d=h.vertexShader,p=h.fragmentShader,m=!1;null!==d.match(s)&&null!==p.match(s)&&(m=!0,d=d.replace(s,""),p=p.replace(s,""));const e=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture",o?"#define AFRAME_enable_multiview":""].join("\n")+"\n",t=["#version 300 es\n","#define varying in",m?"":"out highp vec4 pc_fragColor;",m?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n";h.vertexShader=e+d,h.fragmentShader=t+p}}else console.warn("No WebGL 2.0 context available. Falling back to WebGL 1.0"),o&&(console.warn("Multiview enabled but requires a WebGL2 context"),o=!1)}t.forceWebVR&&(r.forceWebVR="true"===t.forceWebVR),this.maxCanvasSize={width:t.maxCanvasWidth?parseInt(t.maxCanvasWidth):this.maxCanvasSize.width,height:t.maxCanvasHeight?parseInt(t.maxCanvasHeight):this.maxCanvasSize.height}}(e=this.renderer=new l.WebGLRenderer(r)).setPixelRatio(window.devicePixelRatio),e.sortObjects=!1,o&&(console.log("Using Multiview."),e.vr.multiview=!0),this.camera&&e.vr.setPoseTarget(this.camera.el.object3D),this.addEventListener("camera-set-active",(function(){e.vr.setPoseTarget(i.camera.el.object3D)})),a.setup(this,w)},writable:window.debug},play:{value:function(){var e=this,t=this;this.renderStarted?h.prototype.play.call(this):(this.addEventListener("loaded",(function(){var e,n=this.renderer,r=this.renderer.vr;h.prototype.play.call(this),t.renderStarted||(t.resize(),t.renderer&&(window.performance&&window.performance.mark("render-started"),a.remove(),(e=u.device.getVRDisplay())&&e.isPresenting&&(r.setDevice(e),r.enabled=!0,t.enterVR()),n.setAnimationLoop(this.render),t.renderStarted=!0,t.emit("renderstart")))})),setTimeout((function(){h.prototype.load.call(e)})))}},updateComponent:{value:function(e){e in c||h.prototype.updateComponent.apply(this,arguments)}},tick:{value:function(e,t){var n,r=this.systems;for(n=0;n<this.behaviors.tick.length;n++)this.behaviors.tick[n].el.isPlaying&&this.behaviors.tick[n].tick(e,t);for(n=0;n<this.systemNames.length;n++)r[this.systemNames[n]].tick&&r[this.systemNames[n]].tick(e,t)}},tock:{value:function(e,t,n){var r,i=this.systems;for(r=0;r<this.behaviors.tock.length;r++)this.behaviors.tock[r].el.isPlaying&&this.behaviors.tock[r].tock(e,t,n);for(r=0;r<this.systemNames.length;r++)i[this.systemNames[r]].tock&&i[this.systemNames[r]].tock(e,t,n)}},render:{value:function(e,t){var n=this.renderer;this.frame=t,this.delta=1e3*this.clock.getDelta(),this.time=1e3*this.clock.elapsedTime,this.isPlaying&&this.tick(this.time,this.delta),n.render(this.object3D,this.camera)},writable:!0}})}),e.exports.setupCanvas=E},832:function(e,t,n){var r,i=n(152),a=n(24).extend,o=e.exports.MOBILE_HEAD_TAGS=[c({name:"viewport",content:"width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui"}),c({name:"mobile-web-app-capable",content:"yes"}),c({name:"theme-color",content:"black"})],s=[c({name:"apple-mobile-web-app-capable",content:"yes"}),c({name:"apple-mobile-web-app-status-bar-style",content:"black"}),(r={rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"},{tagName:"link",attributes:r,exists:function(){return document.querySelector('link[rel="'+r.rel+'"]')}})];function c(e){return{tagName:"meta",attributes:e,exists:function(){return document.querySelector('meta[name="'+e.name+'"]')}}}e.exports.inject=function(e){var t,n=document.head,r=n.querySelector("script"),c=[];return o.forEach(l),e.isIOS&&s.forEach(l),c;function l(e){e&&!e.exists()&&(t=function(e){if(!e||!e.tagName)return;var t=document.createElement(e.tagName);return t.setAttribute(i.AFRAME_INJECTED,""),a(t,e.attributes)}(e))&&(r?r.parentNode.insertBefore(t,r):n.appendChild(t),c.push(t))}}},833:function(e,t,n){var r=n(834);e.exports=function(e){if(e.isMobile){var t=e.wakelock=new r;e.addEventListener("enter-vr",(function(){t.request()})),e.addEventListener("exit-vr",(function(){t.release()}))}}},834:function(e,t,n){var r,i=n(835);function a(){var e=document.createElement("video");e.addEventListener("ended",(function(){e.play()})),this.request=function(){e.paused&&(e.src=i.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw=="),e.play())},this.release=function(){e.pause(),e.src=""}}function o(){var e=null;this.request=function(){e||(e=setInterval((function(){window.location.href="/",setTimeout(window.stop,0)}),15e3))},this.release=function(){e&&(clearInterval(e),e=null)}}e.exports=(r=navigator.userAgent||navigator.vendor||window.opera).match(/iPhone/i)||r.match(/iPod/i)?o:a},835:function(e,t){var n={base64:function(e,t){return"data:"+e+";base64,"+t},isMobile:function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t},isIOS:function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},isIFrame:function(){try{return window.self!==window.top}catch(e){return!0}},appendQueryParameter:function(e,t,n){var r=e.indexOf("?")<0?"?":"&";return e+=r+t+"="+n},getQueryParameter:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},isLandscapeMode:function(){return 90==window.orientation||-90==window.orientation}};e.exports=n},836:function(e,t,n){var r,i,a,o=n(24).styleParser;function s(e){var t=a(r.canvas,!1,r.maxCanvasSize,r.is("vr-mode"));e.aspect=t.width/t.height,e.updateProjectionMatrix(),r.renderer.setSize(t.width,t.height,!1)}e.exports.setup=function(e,t){a=t;var n,c,l,u,h,d,p,f,m,g,v=(r=e).hasAttribute("loading-screen")?o.parse(r.getAttribute("loading-screen")):void 0,y=v&&v.dotsColor||"white",b=v&&v.backgroundColor||"#24CAFF";(void 0===v||!0===v.enabled||void 0===v.enabled)&&(n=new THREE.Scene,c=new THREE.SphereGeometry(.2,36,18,0,2*Math.PI,0,Math.PI),l=new THREE.MeshBasicMaterial({color:y}),u=new THREE.Mesh(c,l),h=u.clone(),d=u.clone(),p=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,5e-4,1e4),f=new THREE.Clock,m=0,g=function(){r.renderer.render(n,p),m=f.getElapsedTime()%4,u.visible=m>=1,h.visible=m>=2,d.visible=m>=3},n.background=new THREE.Color(b),n.add(p),u.position.set(-1,0,-15),h.position.set(0,0,-15),d.position.set(1,0,-15),p.add(u),p.add(h),p.add(d),(i=document.createElement("div")).className="a-loader-title",i.innerHTML=document.title,i.style.display="none",r.appendChild(i),setTimeout((function(){r.hasLoaded||(s(p),i.style.display="block",window.addEventListener("resize",(function(){s(p)})),r.renderer.setAnimationLoop(g))}),200))},e.exports.remove=function(){window.removeEventListener("resize",s),i&&(i.style.display="none")}},838:function(e,t,n){var r=n(361),i=n(200),a=i("core:propertyTypes:warn"),o=i("core:propertyTypes:warn"),s=e.exports.propertyTypes={},c=/[,> .[\]:]/,l=/\url\((.+)\)/;function u(e,t,n,r){"type"in s?a("Property type "+e+" is already registered."):s[e]={default:t,parse:n||d,stringify:r||p}}function h(e){var t,n;return"string"!=typeof e?e:(n=e.match(l))?n[1]:"#"===e.charAt(0)?(t=document.getElementById(e.substring(1)))?"CANVAS"===t.tagName||"VIDEO"===t.tagName||"IMG"===t.tagName?t:t.getAttribute("src"):void o('"'+e+'" asset not found.'):e}function d(e){return e}function p(e){return null===e?"null":e.toString()}function f(e){return parseInt(e,10)}function m(e){return r.parse(e,this.default)}function g(e,t){if(null===e)return!0;if("object"!=typeof e)return!1;if(Object.keys(e).length!==t)return!1;var n=e.x,r=e.y,i=e.z,a=e.w;return"number"==typeof n&&"number"==typeof r&&(!(t>2&&"number"!=typeof i)&&!(t>3&&"number"!=typeof a))}u("audio","",h),u("array",[],(function(e){if(Array.isArray(e))return e;if(!e||"string"!=typeof e)return[];return e.split(",").map((function(e){return e.trim()}))}),(function(e){return e.join(", ")})),u("asset","",h),u("boolean",!1,(function(e){return"false"!==e&&!1!==e})),u("color","#FFF",d,p),u("int",0,f),u("number",0,(function(e){return parseFloat(e,10)})),u("map","",h),u("model","",h),u("selector",null,(function(e){if(!e)return null;if("string"!=typeof e)return e;if("#"===e[0]&&!c.test(e))return document.getElementById(e.substring(1));return document.querySelector(e)}),(function(e){if(e.getAttribute)return"#"+e.getAttribute("id");return p(e)})),u("selectorAll",null,(function(e){if(!e)return null;if("string"!=typeof e)return e;return Array.prototype.slice.call(document.querySelectorAll(e),0)}),(function(e){if(e instanceof Array)return e.map((function(e){return"#"+e.getAttribute("id")})).join(", ");return p(e)})),u("src","",(function(e){return o("`src` property type is deprecated. Use `asset` instead."),h(e)})),u("string","",d,p),u("time",0,f),u("vec2",{x:0,y:0},m,r.stringify),u("vec3",{x:0,y:0,z:0},m,r.stringify),u("vec4",{x:0,y:0,z:0,w:1},m,r.stringify),e.exports.registerPropertyType=u,e.exports.isValidDefaultValue=function(e,t){return("audio"!==e||"string"==typeof t)&&(!("array"===e&&!Array.isArray(t))&&(("asset"!==e||"string"==typeof t)&&(("boolean"!==e||"boolean"==typeof t)&&(("color"!==e||"string"==typeof t)&&(("int"!==e||"number"==typeof t)&&(("number"!==e||"number"==typeof t)&&(("map"!==e||"string"==typeof t)&&(("model"!==e||"string"==typeof t)&&(("selector"!==e||"string"==typeof t||null===t)&&(("selectorAll"!==e||"string"==typeof t||null===t)&&(("src"!==e||"string"==typeof t)&&(("string"!==e||"string"==typeof t)&&(("time"!==e||"number"==typeof t)&&("vec2"===e?g(t,2):"vec3"===e?g(t,3):"vec4"!==e||g(t,4)))))))))))))))},e.exports.isValidDefaultCoordinate=g},839:function(e,t,n){var r=n(170),i=n(24).isIframed;function a(e){if(e.data)switch(e.data.type){case"vr":switch(e.data.data){case"enter":this.enterVR();break;case"exit":this.exitVR()}}}e.exports=function(e){i()&&window.addEventListener("message",r(a,e))}},840:function(e,t,n){n(841),n(843),n(844),n(845),n(846),n(847),n(848),n(849),n(850),n(851),n(852),n(853),n(854),n(855),n(856),n(857),n(858),n(859),n(860),n(861),n(862),n(863),n(864),n(865),n(866),n(867),n(868),n(869),n(870),n(871),n(875)},841:function(e,t,n){var r=n(842),i=n(22).components,a=n(22).registerComponent,o=n(19),s=n(24),c=new o.Color,l=new o.Color,u=s.entity.getComponentProperty,h=s.entity.setComponentProperty,d={};function p(e){e.x=o.Math.degToRad(e.x),e.y=o.Math.degToRad(e.y),e.z=o.Math.degToRad(e.z)}function f(e,t,n){var r;for(r=0;r<t.length;r++)e.addEventListener(t[r],n)}function m(e,t,n){var r;for(r=0;r<t.length;r++)e.removeEventListener(t[r],n)}function g(e,t){var n,r,i;for(r=y(t),i=e,n=0;n<r.length;n++)i=i[r[n]];return i}function v(e,t,n,r){var i,a,s,c;for(t.startsWith("object3D.rotation")&&(n=o.Math.degToRad(n)),a=y(t),c=e,i=0;i<a.length-1;i++)c=c[a[i]];s=a[a.length-1],"color"!==r?c[s]=n:"r"in c[s]?(c[s].r=n.r,c[s].g=n.g,c[s].b=n.b):(c[s].x=n.r,c[s].y=n.g,c[s].z=n.b)}function y(e){return e in d?d[e]:(d[e]=e.split("."),d[e])}function b(e){return e.isRawProperty||e.property.startsWith("components")||e.property.startsWith("object3D")}e.exports.Component=a("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(e){return!0===e||"true"===e||!1!==e&&"false"!==e&&parseInt(e,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){var e=this;this.eventDetail={name:this.attrName},this.time=0,this.animation=null,this.animationIsPlaying=!1,this.onStartEvent=this.onStartEvent.bind(this),this.beginAnimation=this.beginAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.resumeAnimation=this.resumeAnimation.bind(this),this.fromColor={},this.toColor={},this.targets={},this.targetsArray=[],this.updateConfigForDefault=this.updateConfigForDefault.bind(this),this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this),this.config={complete:function(){e.animationIsPlaying=!1,e.el.emit("animationcomplete",e.eventDetail,!1),e.id&&e.el.emit("animationcomplete__"+e.id,e.eventDetail,!1)}}},update:function(e){var t=this.config,n=this.data;this.animationIsPlaying=!1,this.data.enabled&&n.property&&(t.autoplay=!1,t.direction=n.dir,t.duration=n.dur,t.easing=n.easing,t.elasticity=n.elasticity,t.loop=n.loop,t.round=n.round,this.createAndStartAnimation())},tick:function(e,t){this.animationIsPlaying&&(this.time+=t,this.animation.tick(this.time))},remove:function(){this.pauseAnimation(),this.removeEventListeners()},pause:function(){this.paused=!0,this.pausedWasPlaying=this.animationIsPlaying,this.pauseAnimation(),this.removeEventListeners()},play:function(){this.paused&&(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){var e=this.data;this.updateConfig(),this.animationIsPlaying=!1,this.animation=r(this.config),this.animation.began=!0,this.removeEventListeners(),this.addEventListeners(),!e.autoplay||e.startEvents&&e.startEvents.length||(e.delay?setTimeout(this.beginAnimation,e.delay):this.beginAnimation())},beginAnimation:function(){this.updateConfig(),this.animation.began=!0,this.time=0,this.animationIsPlaying=!0,this.stopRelatedAnimations(),this.el.emit("animationbegin",this.eventDetail,!1)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=!0},onStartEvent:function(){this.data.enabled&&(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=r(this.config),this.data.delay?setTimeout(this.beginAnimation,this.data.delay):this.beginAnimation())},updateConfigForRawColor:function(){var e,t,n,r=this.config,i=this.data,a=this.el;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){for(t in e=""===i.from?g(a,i.property):i.from,n=i.to,this.setColorConfig(e,n),e=this.fromColor,n=this.toColor,this.targetsArray.length=0,this.targetsArray.push(e),r.targets=this.targetsArray,n)r[t]=n[t];var o;r.update=(o={},function(e){var t;(t=e.animatables[0].target).r===o.r&&t.g===o.g&&t.b===o.b||v(a,i.property,t,i.type)})}},updateConfigForDefault:function(){var e,t,n,r,i=this.config,a=this.data,o=this.el;this.waitComponentInitRawProperty(this.updateConfigForDefault)||(e=""===a.from?b(a)?g(o,a.property):u(o,a.property):a.from,n=a.to,!isNaN(e||n)?(e=parseFloat(e),n=parseFloat(n)):(e=e?e.toString():e,n=n?n.toString():n),(t="true"===a.to||"false"===a.to||!0===a.to||!1===a.to)&&(e="true"===a.from||!0===a.from?1:0,n="true"===a.to||!0===a.to?1:0),this.targets.aframeProperty=e,i.targets=this.targets,i.aframeProperty=n,i.update=function(e){var n;(n=e.animatables[0].target.aframeProperty)!==r&&(r=n,t&&(n=n>=1),b(a)?v(o,a.property,n,a.type):h(o,a.property,n))})},updateConfigForVector:function(){var e,t,n,r,i=this.config,a=this.data,o=this.el;for(e in t=""!==a.from?s.coordinates.parse(a.from):u(o,a.property),n=s.coordinates.parse(a.to),"rotation"===a.property&&(p(t),p(n)),this.targetsArray.length=0,this.targetsArray.push(t),i.targets=this.targetsArray,n)i[e]=n[e];"position"!==a.property&&"rotation"!==a.property&&"scale"!==a.property?i.update=function(){var e={};return function(t){var n=t.animations[0].target;n.x===e.x&&n.y===e.y&&n.z===e.z||(e.x=n.x,e.y=n.y,e.z=n.z,h(o,a.property,n))}}():i.update=(r={},function(e){var t=e.animatables[0].target;"scale"===a.property&&(t.x=Math.max(1e-4,t.x),t.y=Math.max(1e-4,t.y),t.z=Math.max(1e-4,t.z)),t.x===r.x&&t.y===r.y&&t.z===r.z||(r.x=t.x,r.y=t.y,r.z=t.z,o.object3D[a.property].set(t.x,t.y,t.z))})},updateConfig:function(){var e;e=function(e,t){var n,r,a,o;if(a=t.split("."),r=a[0],o=a[1],!(n=e.components[r]||i[r]))return null;if(o&&!n.schema[o])return null;if(o)return n.schema[o].type;return n.schema.type}(this.el,this.data.property),b(this.data)&&"color"===this.data.type?this.updateConfigForRawColor():"vec2"===e||"vec3"===e||"vec4"===e?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(e){var t,n=this.data,i=this.el,a=this;return""===n.from&&(!!n.property.startsWith("components")&&(t=y(n.property)[1],!i.components[t]&&(i.addEventListener("componentinitialized",(function n(o){o.detail.name===t&&(e(),a.animation=r(a.config),i.removeEventListener("componentinitialized",n))})),!0)))},stopRelatedAnimations:function(){var e,t;for(t in this.el.components)e=this.el.components[t],t!==this.attrName&&"animation"===e.name&&e.animationIsPlaying&&e.data.property===this.data.property&&(e.animationIsPlaying=!1)},addEventListeners:function(){var e=this.data,t=this.el;f(t,e.startEvents,this.onStartEvent),f(t,e.pauseEvents,this.pauseAnimation),f(t,e.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var e=this.data,t=this.el;m(t,e.startEvents,this.onStartEvent),m(t,e.pauseEvents,this.pauseAnimation),m(t,e.resumeEvents,this.resumeAnimation)},setColorConfig:function(e,t){c.set(e),l.set(t),e=this.fromColor,t=this.toColor,e.r=c.r,e.g=c.g,e.b=c.b,t.r=l.r,t.g=l.g,t.b=l.b}})},843:function(e,t,n){var r=n(22).registerComponent,i=n(19);e.exports.Component=r("camera",{schema:{active:{default:!0},far:{default:1e4},fov:{default:80,min:0},near:{default:.005,min:0},spectator:{default:!1},zoom:{default:1,min:0}},init:function(){var e,t=this.el;e=this.camera=new i.PerspectiveCamera,t.setObject3D("camera",e)},update:function(e){var t=this.data,n=this.camera;n.aspect=t.aspect||window.innerWidth/window.innerHeight,n.far=t.far,n.fov=t.fov,n.near=t.near,n.zoom=t.zoom,n.updateProjectionMatrix(),this.updateActiveCamera(e),this.updateSpectatorCamera(e)},updateActiveCamera:function(e){var t=this.data,n=this.el,r=this.system;e&&e.active===t.active||t.spectator||(t.active&&r.activeCameraEl!==n?r.setActiveCamera(n):t.active||r.activeCameraEl!==n||r.disableActiveCamera())},updateSpectatorCamera:function(e){var t=this.data,n=this.el,r=this.system;e&&e.spectator===t.spectator||(t.spectator&&r.spectatorCameraEl!==n?r.setSpectatorCamera(n):t.spectator||r.spectatorCameraEl!==n||r.disableSpectatorCamera())},remove:function(){this.el.removeObject3D("camera")}})},844:function(e,t,n){var r,i,a,o,s=n(22).registerComponent,c=n(24),l=c.bind,u="click",h="fusing",d="mouseenter",p="mousedown",f="mouseleave",m="mouseup",g="cursor-fusing",v="cursor-hovering",y="cursor-hovered",b={DOWN:["mousedown","touchstart"],UP:["mouseup","touchend"]};e.exports.Component=s("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:c.device.isMobile()},fuseTimeout:{default:1500,min:0},mouseCursorStylesEnabled:{default:!0},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity"]}},init:function(){var e=this;this.fuseTimeout=void 0,this.cursorDownEl=null,this.intersectedEl=null,this.canvasBounds=document.body.getBoundingClientRect(),this.updateCanvasBounds=c.debounce((function(){e.canvasBounds=e.el.sceneEl.canvas.getBoundingClientRect()}),500),this.eventDetail={},this.intersectedEventDetail={cursorEl:this.el},this.onCursorDown=l(this.onCursorDown,this),this.onCursorUp=l(this.onCursorUp,this),this.onIntersection=l(this.onIntersection,this),this.onIntersectionCleared=l(this.onIntersectionCleared,this),this.onMouseMove=l(this.onMouseMove,this)},update:function(e){this.data.rayOrigin!==e.rayOrigin&&this.updateMouseEventListeners()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var e=this.el;e.removeState(v),e.removeState(g),clearTimeout(this.fuseTimeout),this.intersectedEl&&this.intersectedEl.removeState(y),this.removeEventListeners()},addEventListeners:function(){var e,t=this.data,n=this.el,r=this;function i(){e=n.sceneEl.canvas,t.downEvents.length||t.upEvents.length||(b.DOWN.forEach((function(t){e.addEventListener(t,r.onCursorDown)})),b.UP.forEach((function(t){e.addEventListener(t,r.onCursorUp)})))}(e=n.sceneEl.canvas)?i():n.sceneEl.addEventListener("render-target-loaded",i),t.downEvents.forEach((function(e){n.addEventListener(e,r.onCursorDown)})),t.upEvents.forEach((function(e){n.addEventListener(e,r.onCursorUp)})),n.addEventListener("raycaster-intersection",this.onIntersection),n.addEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),n.sceneEl.addEventListener("rendererresize",this.updateCanvasBounds),window.addEventListener("resize",this.updateCanvasBounds),window.addEventListener("scroll",this.updateCanvasBounds),this.updateMouseEventListeners()},removeEventListeners:function(){var e,t=this.data,n=this.el,r=this;!(e=n.sceneEl.canvas)||t.downEvents.length||t.upEvents.length||(b.DOWN.forEach((function(t){e.removeEventListener(t,r.onCursorDown)})),b.UP.forEach((function(t){e.removeEventListener(t,r.onCursorUp)}))),t.downEvents.forEach((function(e){n.removeEventListener(e,r.onCursorDown)})),t.upEvents.forEach((function(e){n.removeEventListener(e,r.onCursorUp)})),n.removeEventListener("raycaster-intersection",this.onIntersection),n.removeEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),e.removeEventListener("mousemove",this.onMouseMove),e.removeEventListener("touchstart",this.onMouseMove),e.removeEventListener("touchmove",this.onMouseMove),n.sceneEl.removeEventListener("rendererresize",this.updateCanvasBounds),window.removeEventListener("resize",this.updateCanvasBounds),window.removeEventListener("scroll",this.updateCanvasBounds)},updateMouseEventListeners:function(){var e,t=this.el;(e=t.sceneEl.canvas).removeEventListener("mousemove",this.onMouseMove),e.removeEventListener("touchmove",this.onMouseMove),t.setAttribute("raycaster","useWorldCoordinates",!1),"mouse"===this.data.rayOrigin&&(e.addEventListener("mousemove",this.onMouseMove,!1),e.addEventListener("touchmove",this.onMouseMove,!1),t.setAttribute("raycaster","useWorldCoordinates",!0),this.updateCanvasBounds())},onMouseMove:(r=new THREE.Vector3,i=new THREE.Vector2,a=new THREE.Vector3,o={origin:a,direction:r},function(e){var t,n,s,c=this.canvasBounds,l=this.el.sceneEl.camera;l.parent.updateMatrixWorld(),t=(n="touchmove"===e.type||"touchstart"===e.type?e.touches.item(0):e).clientX-c.left,s=n.clientY-c.top,i.x=t/c.width*2-1,i.y=-s/c.height*2+1,a.setFromMatrixPosition(l.matrixWorld),r.set(i.x,i.y,.5).unproject(l).sub(a).normalize(),this.el.setAttribute("raycaster",o),"touchmove"===e.type&&e.preventDefault()}),onCursorDown:function(e){"mouse"===this.data.rayOrigin&&"touchstart"===e.type&&(this.onMouseMove(e),this.el.components.raycaster.checkIntersections(),e.preventDefault()),this.twoWayEmit(p),this.cursorDownEl=this.intersectedEl},onCursorUp:function(e){var t=this.data;this.twoWayEmit(m),this.cursorDownEl&&this.cursorDownEl!==this.intersectedEl&&(this.intersectedEventDetail.intersection=null,this.cursorDownEl.emit(m,this.intersectedEventDetail)),t.fuse&&"mouse"!==t.rayOrigin||!this.intersectedEl||this.cursorDownEl!==this.intersectedEl||this.twoWayEmit(u),this.cursorDownEl=null,"touchend"===e.type&&e.preventDefault()},onIntersection:function(e){var t,n,r,i,a=this.el;n=e.detail.els[0]===a?1:0,i=e.detail.intersections[n],(r=e.detail.els[n])&&this.intersectedEl!==r&&(this.intersectedEl&&(t=this.el.components.raycaster.getIntersection(this.intersectedEl))&&t.distance<=i.distance||(this.clearCurrentIntersection(!0),this.setIntersection(r,i)))},onIntersectionCleared:function(e){-1!==e.detail.clearedEls.indexOf(this.intersectedEl)&&this.clearCurrentIntersection()},setIntersection:function(e,t){var n=this.el,r=this.data,i=this;this.intersectedEl!==e&&(this.intersectedEl=e,n.addState(v),e.addState(y),this.twoWayEmit(d),this.data.mouseCursorStylesEnabled&&"mouse"===this.data.rayOrigin&&this.el.sceneEl.canvas.classList.add("a-mouse-cursor-hover"),0!==r.fuseTimeout&&r.fuse&&(n.addState(g),this.twoWayEmit(h),this.fuseTimeout=setTimeout((function(){n.removeState(g),i.twoWayEmit(u)}),r.fuseTimeout)))},clearCurrentIntersection:function(e){var t,n,r=this.el;this.intersectedEl&&(this.intersectedEl.removeState(y),r.removeState(v),r.removeState(g),this.twoWayEmit(f),this.data.mouseCursorStylesEnabled&&"mouse"===this.data.rayOrigin&&this.el.sceneEl.canvas.classList.remove("a-mouse-cursor-hover"),this.intersectedEl=null,clearTimeout(this.fuseTimeout),!0!==e&&0!==(n=this.el.components.raycaster.intersections).length&&(t=n[n[0].object.el===r?1:0])&&this.setIntersection(t.object.el,t))},twoWayEmit:function(e){var t,n=this.el,r=this.intersectedEl;t=this.el.components.raycaster.getIntersection(r),this.eventDetail.intersectedEl=r,this.eventDetail.intersection=t,n.emit(e,this.eventDetail),r&&(this.intersectedEventDetail.intersection=t,r.emit(e,this.intersectedEventDetail))}})},845:function(e,t,n){var r=n(54).geometries,i=n(54).geometryNames,a=n(22).registerComponent,o=n(19),s=new o.Geometry;e.exports.Component=a("geometry",{schema:{buffer:{default:!0},primitive:{default:"box",oneOf:i,schemaChange:!0},skipCache:{default:!1}},init:function(){this.geometry=null},update:function(e){var t,n=this.data,r=this.el,i=this.system;this.geometry&&(i.unuseGeometry(e),this.geometry=null),this.geometry=i.getOrCreateGeometry(n),(t=r.getObject3D("mesh"))?t.geometry=this.geometry:((t=new o.Mesh).geometry=this.geometry,r.setObject3D("mesh",t))},remove:function(){this.system.unuseGeometry(this.data),this.el.getObject3D("mesh").geometry=s,this.geometry=null},updateSchema:function(e){var t=this.oldData&&this.oldData.primitive,n=e.primitive,i=r[n]&&r[n].schema;if(!i)throw new Error("Unknown geometry schema `"+n+"`");t&&t===n||this.extendSchema(i)}})},846:function(e,t,n){var r=n(22).registerComponent,i=n(19),a=n(24).debug("components:gltf-model:warn");e.exports.Component=r("gltf-model",{schema:{type:"model"},init:function(){var e=this.system.getDRACOLoader();this.model=null,this.loader=new i.GLTFLoader,e&&this.loader.setDRACOLoader(e)},update:function(){var e=this,t=this.el,n=this.data;n&&(this.remove(),this.loader.load(n,(function(n){e.model=n.scene||n.scenes[0],e.model.animations=n.animations,t.setObject3D("mesh",e.model),t.emit("model-loaded",{format:"gltf",model:e.model})}),void 0,(function(e){var r=e&&e.message?e.message:"Failed to load glTF model";a(r),t.emit("model-error",{format:"gltf",src:n})})))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},847:function(e,t,n){var r=n(22).registerComponent,i={left:"https://cdn.aframe.io/controllers/hands/leftHand.glb",right:"https://cdn.aframe.io/controllers/hands/rightHand.glb"},a={open:"Open",point:"Point",pointThumb:"Point + Thumb",fist:"Fist",hold:"Hold",thumbUp:"Thumb Up"},o={};function s(e,t){var n;if(e)return"grip"===(n=o[e])?n+(t?"close":"open"):"point"===n||"thumb"===n?n+(t?"up":"down"):"pointing"===n||"pistol"===n?n+(t?"start":"end"):void 0}o[a.fist]="grip",o[a.thumbUp]="pistol",o[a.point]="pointing",o[a.thumb]="thumb",e.exports.Component=r("hand-controls",{schema:{default:"left"},init:function(){var e=this,t=this.el;this.gesture=a.open,this.pressedButtons={},this.touchedButtons={},this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("anonymous"),this.onGripDown=function(){e.handleButton("grip","down")},this.onGripUp=function(){e.handleButton("grip","up")},this.onTrackpadDown=function(){e.handleButton("trackpad","down")},this.onTrackpadUp=function(){e.handleButton("trackpad","up")},this.onTrackpadTouchStart=function(){e.handleButton("trackpad","touchstart")},this.onTrackpadTouchEnd=function(){e.handleButton("trackpad","touchend")},this.onTriggerDown=function(){e.handleButton("trigger","down")},this.onTriggerUp=function(){e.handleButton("trigger","up")},this.onTriggerTouchStart=function(){e.handleButton("trigger","touchstart")},this.onTriggerTouchEnd=function(){e.handleButton("trigger","touchend")},this.onGripTouchStart=function(){e.handleButton("grip","touchstart")},this.onGripTouchEnd=function(){e.handleButton("grip","touchend")},this.onThumbstickDown=function(){e.handleButton("thumbstick","down")},this.onThumbstickUp=function(){e.handleButton("thumbstick","up")},this.onAorXTouchStart=function(){e.handleButton("AorX","touchstart")},this.onAorXTouchEnd=function(){e.handleButton("AorX","touchend")},this.onBorYTouchStart=function(){e.handleButton("BorY","touchstart")},this.onBorYTouchEnd=function(){e.handleButton("BorY","touchend")},this.onSurfaceTouchStart=function(){e.handleButton("surface","touchstart")},this.onSurfaceTouchEnd=function(){e.handleButton("surface","touchend")},t.addEventListener("controllerconnected",this.onControllerConnected),t.addEventListener("controllerdisconnected",this.onControllerDisconnected),t.object3D.visible=!1},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(e,t){var n=this.el.getObject3D("mesh");n&&n.mixer&&n.mixer.update(t/1e3)},addEventListeners:function(){var e=this.el;e.addEventListener("gripdown",this.onGripDown),e.addEventListener("gripup",this.onGripUp),e.addEventListener("trackpaddown",this.onTrackpadDown),e.addEventListener("trackpadup",this.onTrackpadUp),e.addEventListener("trackpadtouchstart",this.onTrackpadTouchStart),e.addEventListener("trackpadtouchend",this.onTrackpadTouchEnd),e.addEventListener("triggerdown",this.onTriggerDown),e.addEventListener("triggerup",this.onTriggerUp),e.addEventListener("triggertouchstart",this.onTriggerTouchStart),e.addEventListener("triggertouchend",this.onTriggerTouchEnd),e.addEventListener("griptouchstart",this.onGripTouchStart),e.addEventListener("griptouchend",this.onGripTouchEnd),e.addEventListener("thumbstickdown",this.onThumbstickDown),e.addEventListener("thumbstickup",this.onThumbstickUp),e.addEventListener("abuttontouchstart",this.onAorXTouchStart),e.addEventListener("abuttontouchend",this.onAorXTouchEnd),e.addEventListener("bbuttontouchstart",this.onBorYTouchStart),e.addEventListener("bbuttontouchend",this.onBorYTouchEnd),e.addEventListener("xbuttontouchstart",this.onAorXTouchStart),e.addEventListener("xbuttontouchend",this.onAorXTouchEnd),e.addEventListener("ybuttontouchstart",this.onBorYTouchStart),e.addEventListener("ybuttontouchend",this.onBorYTouchEnd),e.addEventListener("surfacetouchstart",this.onSurfaceTouchStart),e.addEventListener("surfacetouchend",this.onSurfaceTouchEnd)},removeEventListeners:function(){var e=this.el;e.removeEventListener("gripdown",this.onGripDown),e.removeEventListener("gripup",this.onGripUp),e.removeEventListener("trackpaddown",this.onTrackpadDown),e.removeEventListener("trackpadup",this.onTrackpadUp),e.removeEventListener("trackpadtouchstart",this.onTrackpadTouchStart),e.removeEventListener("trackpadtouchend",this.onTrackpadTouchEnd),e.removeEventListener("triggerdown",this.onTriggerDown),e.removeEventListener("triggerup",this.onTriggerUp),e.removeEventListener("triggertouchstart",this.onTriggerTouchStart),e.removeEventListener("triggertouchend",this.onTriggerTouchEnd),e.removeEventListener("griptouchstart",this.onGripTouchStart),e.removeEventListener("griptouchend",this.onGripTouchEnd),e.removeEventListener("thumbstickdown",this.onThumbstickDown),e.removeEventListener("thumbstickup",this.onThumbstickUp),e.removeEventListener("abuttontouchstart",this.onAorXTouchStart),e.removeEventListener("abuttontouchend",this.onAorXTouchEnd),e.removeEventListener("bbuttontouchstart",this.onBorYTouchStart),e.removeEventListener("bbuttontouchend",this.onBorYTouchEnd),e.removeEventListener("xbuttontouchstart",this.onAorXTouchStart),e.removeEventListener("xbuttontouchend",this.onAorXTouchEnd),e.removeEventListener("ybuttontouchstart",this.onBorYTouchStart),e.removeEventListener("ybuttontouchend",this.onBorYTouchEnd),e.removeEventListener("surfacetouchstart",this.onSurfaceTouchStart),e.removeEventListener("surfacetouchend",this.onSurfaceTouchEnd)},update:function(e){var t,n=this.el,r=this.data,a=this;t={hand:r,model:!1,orientationOffset:{x:0,y:0,z:"left"===r?90:-90}},r!==e&&this.loader.load(i[r],(function(e){var r=e.scene.children[0];r.mixer=new THREE.AnimationMixer(r),a.clips=e.animations,n.setObject3D("mesh",r),r.position.set(0,0,0),r.rotation.set(0,0,0),n.setAttribute("vive-controls",t),n.setAttribute("oculus-touch-controls",t),n.setAttribute("windows-motion-controls",t)}))},remove:function(){this.el.removeObject3D("mesh")},handleButton:function(e,t){var n,r="down"===t,i="touchstart"===t;if(0===t.indexOf("touch")){if(i===this.touchedButtons[e])return;this.touchedButtons[e]=i}else{if(r===this.pressedButtons[e])return;this.pressedButtons[e]=r}n=this.gesture,this.gesture=this.determineGesture(),this.gesture!==n&&(this.animateGesture(this.gesture,n),this.emitGestureEvents(this.gesture,n))},determineGesture:function(){var e,t,n,r=this.pressedButtons.grip,i=this.pressedButtons.surface||this.touchedButtons.surface,o=this.pressedButtons.trackpad||this.touchedButtons.trackpad,s=this.pressedButtons.trigger||this.touchedButtons.trigger,c=this.touchedButtons.AorX||this.touchedButtons.BorY,l=(t=this.el.components["tracked-controls"],(n=t&&t.controller&&t.controller.id)&&0===n.indexOf("OpenVR "));return r?e=l?a.fist:i||c||o?s?a.fist:a.point:s?a.thumbUp:a.pointThumb:s?e=l?a.fist:a.hold:l&&o&&(e=a.point),e},getClip:function(e){var t,n;for(n=0;n<this.clips.length;n++)if((t=this.clips[n]).name===e)return t},animateGesture:function(e,t){e?this.playAnimation(e||a.open,t,!1):this.playAnimation(t,t,!0)},emitGestureEvents:function(e,t){var n,r=this.el;t!==e&&((n=s(t,!1))&&r.emit(n),(n=s(e,!0))&&r.emit(n))},playAnimation:function(e,t,n){var r,i,a,o=this.el.getObject3D("mesh");if(o){if(o.mixer.stopAllAction(),r=this.getClip(e),(a=o.mixer.clipAction(r)).clampWhenFinished=!0,a.loop=THREE.LoopRepeat,a.repetitions=0,a.timeScale=n?-1:1,a.time=n?r.duration:0,a.weight=1,!t||e===t)return o.mixer.stopAllAction(),void a.play();r=this.getClip(t),(i=o.mixer.clipAction(r)).weight=.15,i.play(),a.play(),i.crossFadeTo(a,.15,!0)}}})},848:function(e,t,n){var r=n(22).registerComponent,i=n(24);r("laser-controls",{schema:{hand:{default:"right"},model:{default:!0},defaultModelColor:{type:"color",default:"grey"}},init:function(){var e=this.config,t=this.data,n=this.el,r=this,a=this.data.model&&!this.el.sceneEl.hasWebXR,o={hand:t.hand,model:a};function s(t){var a=e[t.detail.name];if(a){var o=i.extend({showLine:!0},a.raycaster||{});t.detail.rayOrigin&&(o.origin=t.detail.rayOrigin.origin,o.direction=t.detail.rayOrigin.direction,o.showLine=!0),t.detail.rayOrigin||!r.modelReady?n.setAttribute("raycaster",o):n.setAttribute("raycaster","showLine",!0),n.setAttribute("cursor",i.extend({fuse:!1},a.cursor))}}n.setAttribute("daydream-controls",o),n.setAttribute("gearvr-controls",o),n.setAttribute("oculus-go-controls",o),n.setAttribute("oculus-touch-controls",o),n.setAttribute("vive-controls",o),n.setAttribute("vive-focus-controls",o),n.setAttribute("windows-motion-controls",o),this.data.model&&this.el.sceneEl.hasWebXR&&this.initDefaultModel(),n.addEventListener("controllerconnected",s),n.addEventListener("controllerdisconnected",(function(){n.setAttribute("raycaster","showLine",!1)})),n.addEventListener("controllermodelready",(function(e){s(e),r.modelReady=!0}))},config:{"daydream-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"gearvr-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-go-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"vive-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-focus-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:!1}}},initDefaultModel:function(){var e=this.modelEl=document.createElement("a-entity");e.setAttribute("geometry",{primitive:"sphere",radius:.03}),e.setAttribute("material",{color:this.data.color}),this.el.appendChild(e)}})},849:function(e,t,n){var r=n(170),i=n(24).diff,a=n(99),o=n(22).registerComponent,s=n(19),c=s.Math.degToRad,l=a("components:light:warn");e.exports.Component=o("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color"},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:1,min:0,if:{type:["ambient","directional","hemisphere","point","spot"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot"],schemaChange:!0},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:!1,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:!0}},shadowCameraFar:{default:500,if:{castShadow:!0}},shadowCameraFov:{default:90,if:{castShadow:!0}},shadowCameraNear:{default:.5,if:{castShadow:!0}},shadowCameraTop:{default:5,if:{castShadow:!0}},shadowCameraRight:{default:5,if:{castShadow:!0}},shadowCameraBottom:{default:-5,if:{castShadow:!0}},shadowCameraLeft:{default:-5,if:{castShadow:!0}},shadowCameraVisible:{default:!1,if:{castShadow:!0}},shadowMapHeight:{default:512,if:{castShadow:!0}},shadowMapWidth:{default:512,if:{castShadow:!0}},shadowRadius:{default:1,if:{castShadow:!0}}},init:function(){var e=this.el;this.light=null,this.defaultTarget=null,this.rendererSystem=this.el.sceneEl.systems.renderer,this.system.registerLight(e)},update:function(e){var t=this.data,n=i(t,e),a=this.light,o=this.rendererSystem,s=this;if(!a||"type"in n)this.setLight(this.data),this.updateShadow();else{var l=!1;Object.keys(n).forEach((function(e){var n=t[e];switch(e){case"color":a.color.set(n),o.applyColorCorrection(a.color);break;case"groundColor":a.groundColor.set(n),o.applyColorCorrection(a.groundColor);break;case"angle":a.angle=c(n);break;case"target":null===n?"spot"!==t.type&&"directional"!==t.type||(a.target=s.defaultTarget):n.hasLoaded?s.onSetTarget(n,a):n.addEventListener("loaded",r(s.onSetTarget,s,n,a));break;case"castShadow":case"shadowBias":case"shadowCameraFar":case"shadowCameraFov":case"shadowCameraNear":case"shadowCameraTop":case"shadowCameraRight":case"shadowCameraBottom":case"shadowCameraLeft":case"shadowCameraVisible":case"shadowMapHeight":case"shadowMapWidth":case"shadowRadius":l||(s.updateShadow(),l=!0);break;default:a[e]=n}}))}},setLight:function(e){var t=this.el,n=this.getLight(e);n&&(this.light&&t.removeObject3D("light"),this.light=n,this.light.el=t,t.setObject3D("light",this.light),"spot"!==e.type&&"directional"!==e.type&&"hemisphere"!==e.type||t.getObject3D("light").translateY(-1),"spot"===e.type&&(t.setObject3D("light-target",this.defaultTarget),t.getObject3D("light-target").position.set(0,0,-1)))},updateShadow:function(){var e=this.el,t=this.data,n=this.light;n.castShadow=t.castShadow;var r=e.getObject3D("cameraHelper");if(t.shadowCameraVisible&&!r?e.setObject3D("cameraHelper",new s.CameraHelper(n.shadow.camera)):!t.shadowCameraVisible&&r&&e.removeObject3D("cameraHelper"),!t.castShadow)return n;n.shadow.bias=t.shadowBias,n.shadow.radius=t.shadowRadius,n.shadow.mapSize.height=t.shadowMapHeight,n.shadow.mapSize.width=t.shadowMapWidth,n.shadow.camera.near=t.shadowCameraNear,n.shadow.camera.far=t.shadowCameraFar,n.shadow.camera instanceof s.OrthographicCamera?(n.shadow.camera.top=t.shadowCameraTop,n.shadow.camera.right=t.shadowCameraRight,n.shadow.camera.bottom=t.shadowCameraBottom,n.shadow.camera.left=t.shadowCameraLeft):n.shadow.camera.fov=t.shadowCameraFov,n.shadow.camera.updateProjectionMatrix(),r&&r.update()},getLight:function(e){var t=e.angle,n=new s.Color(e.color);this.rendererSystem.applyColorCorrection(n),n=n.getHex();var i=e.decay,a=e.distance,o=new s.Color(e.groundColor);this.rendererSystem.applyColorCorrection(o),o=o.getHex();var u=e.intensity,h=e.type,d=e.target,p=null;switch(h.toLowerCase()){case"ambient":return new s.AmbientLight(n,u);case"directional":return p=new s.DirectionalLight(n,u),this.defaultTarget=p.target,d&&(d.hasLoaded?this.onSetTarget(d,p):d.addEventListener("loaded",r(this.onSetTarget,this,d,p))),p;case"hemisphere":return new s.HemisphereLight(n,o,u);case"point":return new s.PointLight(n,u,a,i);case"spot":return p=new s.SpotLight(n,u,a,c(t),e.penumbra,i),this.defaultTarget=p.target,d&&(d.hasLoaded?this.onSetTarget(d,p):d.addEventListener("loaded",r(this.onSetTarget,this,d,p))),p;default:l("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",h)}},onSetTarget:function(e,t){t.target=e.object3D},remove:function(){var e=this.el;e.removeObject3D("light"),e.getObject3D("cameraHelper")&&e.removeObject3D("cameraHelper")}})},850:function(e,t,n){var r=n(22).registerComponent;function i(e,t){return!(!e||!t)&&(e.x===t.x&&e.y===t.y&&e.z===t.z)}e.exports.Component=r("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:!0}},multiple:!0,init:function(){var e,t,n=this.data;this.rendererSystem=this.el.sceneEl.systems.renderer,t=this.material=new THREE.LineBasicMaterial({color:n.color,opacity:n.opacity,transparent:n.opacity<1,visible:n.visible}),(e=this.geometry=new THREE.BufferGeometry).addAttribute("position",new THREE.BufferAttribute(new Float32Array(6),3)),this.rendererSystem.applyColorCorrection(t.color),this.line=new THREE.Line(e,t),this.el.setObject3D(this.attrName,this.line)},update:function(e){var t=this.data,n=this.geometry,r=!1,a=this.material,o=n.attributes.position.array;i(t.start,e.start)||(o[0]=t.start.x,o[1]=t.start.y,o[2]=t.start.z,r=!0),i(t.end,e.end)||(o[3]=t.end.x,o[4]=t.end.y,o[5]=t.end.z,r=!0),r&&(n.attributes.position.needsUpdate=!0,n.computeBoundingSphere()),a.color.setStyle(t.color),this.rendererSystem.applyColorCorrection(a.color),a.opacity=t.opacity,a.transparent=t.opacity<1,a.visible=t.visible},remove:function(){this.el.removeObject3D("line",this.line)}})},851:function(e,t,n){var r,i,a,o,s,c,l,u,h=n(22).registerComponent,d=n(89).registerShader,p=n(19);e.exports.Component=h("link",{schema:{backgroundColor:{default:"red",type:"color"},borderColor:{default:"white",type:"color"},highlighted:{default:!1},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:!1},title:{default:""},titleColor:{default:"white",type:"color"},visualAspectEnabled:{default:!1}},init:function(){this.navigate=this.navigate.bind(this),this.previousQuaternion=void 0,this.quaternionClone=new p.Quaternion,this.hiddenEls=[]},update:function(e){var t,n,r=this.data,i=this.el;r.visualAspectEnabled&&(this.initVisualAspect(),t=r.highlighted?r.highlightedColor:r.backgroundColor,n=r.highlighted?r.highlightedColor:r.borderColor,i.setAttribute("material","backgroundColor",t),i.setAttribute("material","strokeColor",n),r.on!==e.on&&this.updateEventListener(),void 0!==e.peekMode&&r.peekMode!==e.peekMode&&this.updatePeekMode(),r.image&&e.image!==r.image&&i.setAttribute("material","pano","string"==typeof r.image?r.image:r.image.src))},updatePeekMode:function(){var e=this.el,t=this.sphereEl;this.data.peekMode?(this.hideAll(),e.getObject3D("mesh").visible=!1,t.setAttribute("visible",!0)):(this.showAll(),e.getObject3D("mesh").visible=!0,t.setAttribute("visible",!1))},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var e=this.el;e.isPlaying&&(this.removeEventListener(),e.addEventListener(this.data.on,this.navigate))},removeEventListener:function(){var e=this.data.on;e&&this.el.removeEventListener(e,this.navigate)},initVisualAspect:function(){var e,t,n,r=this.el;this.data.visualAspectEnabled&&!this.visualAspectInitialized&&(n=this.textEl=this.textEl||document.createElement("a-entity"),t=this.sphereEl=this.sphereEl||document.createElement("a-entity"),e=this.semiSphereEl=this.semiSphereEl||document.createElement("a-entity"),r.setAttribute("geometry",{primitive:"circle",radius:1,segments:64}),r.setAttribute("material",{shader:"portal",pano:this.data.image,side:"double"}),n.setAttribute("text",{color:this.data.titleColor,align:"center",font:"kelsonsans",value:this.data.title||this.data.href,width:4}),n.setAttribute("position","0 1.5 0"),r.appendChild(n),e.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360}),e.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),e.setAttribute("rotation","0 180 0"),e.setAttribute("position","0 0 0"),e.setAttribute("visible",!1),r.appendChild(e),t.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64}),t.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),t.setAttribute("visible",!1),r.appendChild(t),this.visualAspectInitialized=!0)},navigate:function(){window.location=this.data.href},tick:(s=new p.Vector3,c=new p.Vector3,l=new p.Quaternion,u=new p.Vector3,function(){var e,t,n=this.el,r=n.object3D,i=n.sceneEl.camera,a=this.textEl;if(this.data.visualAspectEnabled)if(r.updateMatrixWorld(),i.parent.updateMatrixWorld(),i.updateMatrixWorld(),r.matrix.decompose(c,l,u),c.setFromMatrixPosition(r.matrixWorld),s.setFromMatrixPosition(i.matrixWorld),(t=c.distanceTo(s))>20)this.previousQuaternion||(this.quaternionClone.copy(l),this.previousQuaternion=this.quaternionClone),r.lookAt(s);else{if(e=this.calculateCameraPortalOrientation(),t<.5){if(!0===this.semiSphereEl.getAttribute("visible"))return;a.setAttribute("text","width",1.5),e<=0?(a.setAttribute("position","0 0 0.75"),a.setAttribute("rotation","0 180 0"),this.semiSphereEl.setAttribute("rotation","0 0 0")):(a.setAttribute("position","0 0 -0.75"),a.setAttribute("rotation","0 0 0"),this.semiSphereEl.setAttribute("rotation","0 180 0")),n.getObject3D("mesh").visible=!1,this.semiSphereEl.setAttribute("visible",!0),this.peekCameraPortalOrientation=e}else e<=0?a.setAttribute("rotation","0 180 0"):a.setAttribute("rotation","0 0 0"),a.setAttribute("text","width",5),a.setAttribute("position","0 1.5 0"),n.getObject3D("mesh").visible=!0,this.semiSphereEl.setAttribute("visible",!1),this.peekCameraPortalOrientation=void 0;this.previousQuaternion&&(r.quaternion.copy(this.previousQuaternion),this.previousQuaternion=void 0)}}),hideAll:function(){var e=this.el,t=this.hiddenEls,n=this;t.length>0||e.sceneEl.object3D.traverse((function(r){r&&r.el&&r.el.hasAttribute("link-controls")||r.el&&r!==e.sceneEl.object3D&&r.el!==e&&r.el!==n.sphereEl&&r.el!==e.sceneEl.cameraEl&&!1!==r.el.getAttribute("visible")&&r.el!==n.textEl&&r.el!==n.semiSphereEl&&(r.el.setAttribute("visible",!1),t.push(r.el))}))},showAll:function(){this.hiddenEls.forEach((function(e){e.setAttribute("visible",!0)})),this.hiddenEls=[]},calculateCameraPortalOrientation:(r=new p.Matrix4,i=new p.Vector3,a=new p.Vector3(0,0,1),o=new p.Vector3(0,0,0),function(){var e=this.el,t=e.sceneEl.camera;return i.set(0,0,0),a.set(0,0,1),o.set(0,0,0),e.object3D.matrixWorld.extractRotation(r),a.applyMatrix4(r),e.object3D.updateMatrixWorld(),e.object3D.localToWorld(o),t.parent.parent.updateMatrixWorld(),t.parent.updateMatrixWorld(),t.updateMatrixWorld(),t.localToWorld(i),i.sub(o).normalize(),a.normalize(),Math.sign(a.dot(i))}),remove:function(){this.removeEventListener()}}),d("portal",{schema:{borderEnabled:{default:1,type:"int",is:"uniform"},backgroundColor:{default:"red",type:"color",is:"uniform"},pano:{type:"map",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"}},vertexShader:["vec3 portalPosition;","varying vec3 vWorldPosition;","varying float vDistanceToCenter;","varying float vDistance;","void main() {","vDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);","portalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","vDistance = length(portalPosition - cameraPosition);","vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["#define RECIPROCAL_PI2 0.15915494","uniform sampler2D pano;","uniform vec3 strokeColor;","uniform vec3 backgroundColor;","uniform float borderEnabled;","varying float vDistanceToCenter;","varying float vDistance;","varying vec3 vWorldPosition;","void main() {","vec3 direction = normalize(vWorldPosition - cameraPosition);","vec2 sampleUV;","float borderThickness = clamp(exp(-vDistance / 50.0), 0.6, 0.95);","sampleUV.y = saturate(direction.y * 0.5  + 0.5);","sampleUV.x = atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;","if (vDistanceToCenter > borderThickness && borderEnabled == 1.0) {","gl_FragColor = vec4(strokeColor, 1.0);","} else {","gl_FragColor = mix(texture2D(pano, sampleUV), vec4(backgroundColor, 1.0), clamp(pow((vDistance / 15.0), 2.0), 0.0, 1.0));","}","}"].join("\n")})},852:function(e,t,n){var r,i=n(22).registerComponent,a=n(19),o=n(24).bind,s=n(24).device.PolyfillControls,c=Math.PI/2;e.exports.Component=i("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:!0},hmdEnabled:{default:!0},pointerLockEnabled:{default:!1},reverseMouseDrag:{default:!1},reverseTouchDrag:{default:!1},touchEnabled:{default:!0}},init:function(){this.previousHMDPosition=new a.Vector3,this.hmdQuaternion=new a.Quaternion,this.hmdEuler=new a.Euler,this.position=new a.Vector3,this.savedRotation=new a.Vector3,this.savedPosition=new a.Vector3,this.polyfillObject=new a.Object3D,this.polyfillControls=new s(this.polyfillObject),this.rotation={},this.deltaRotation={},this.savedPose=null,this.pointerLocked=!1,this.setupMouseControls(),this.bindMethods(),this.el.object3D.matrixAutoUpdate=!1,this.el.object3D.updateMatrix(),this.savedPose={position:new a.Vector3,rotation:new a.Euler},this.el.sceneEl.is("vr-mode")&&this.onEnterVR()},update:function(e){var t=this.data;t.enabled!==e.enabled&&this.updateGrabCursor(t.enabled),!e||t.hmdEnabled||e.hmdEnabled||(this.pitchObject.rotation.set(0,0,0),this.yawObject.rotation.set(0,0,0)),e&&!t.pointerLockEnabled!==e.pointerLockEnabled&&(this.removeEventListeners(),this.addEventListeners(),this.pointerLocked&&this.exitPointerLock())},tick:function(e){this.data.enabled&&this.updateOrientation()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},remove:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},bindMethods:function(){this.onMouseDown=o(this.onMouseDown,this),this.onMouseMove=o(this.onMouseMove,this),this.onMouseUp=o(this.onMouseUp,this),this.onTouchStart=o(this.onTouchStart,this),this.onTouchMove=o(this.onTouchMove,this),this.onTouchEnd=o(this.onTouchEnd,this),this.onEnterVR=o(this.onEnterVR,this),this.onExitVR=o(this.onExitVR,this),this.onPointerLockChange=o(this.onPointerLockChange,this),this.onPointerLockError=o(this.onPointerLockError,this)},setupMouseControls:function(){this.mouseDown=!1,this.pitchObject=new a.Object3D,this.yawObject=new a.Object3D,this.yawObject.position.y=10,this.yawObject.add(this.pitchObject)},addEventListeners:function(){var e=this.el.sceneEl,t=e.canvas;t?(t.addEventListener("mousedown",this.onMouseDown,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1),t.addEventListener("touchstart",this.onTouchStart),window.addEventListener("touchmove",this.onTouchMove),window.addEventListener("touchend",this.onTouchEnd),e.addEventListener("enter-vr",this.onEnterVR),e.addEventListener("exit-vr",this.onExitVR),this.data.pointerLockEnabled&&(document.addEventListener("pointerlockchange",this.onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.addEventListener("pointerlockerror",this.onPointerLockError,!1))):e.addEventListener("render-target-loaded",o(this.addEventListeners,this))},removeEventListeners:function(){var e=this.el.sceneEl,t=e&&e.canvas;t&&(t.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),e.removeEventListener("enter-vr",this.onEnterVR),e.removeEventListener("exit-vr",this.onExitVR),document.removeEventListener("pointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("pointerlockerror",this.onPointerLockError,!1))},updateOrientation:(r=new a.Matrix4,function(){var e,t=this.hmdEuler,n=this.el.object3D,i=this.pitchObject,a=this.yawObject,o=this.el.sceneEl;o.is("vr-mode")&&o.hasWebXR?(e=o.renderer.vr.getCameraPose())&&(r.elements=e.poseModelMatrix,r.decompose(n.position,n.rotation,n.scale)):n.updateMatrix(),o.is("vr-mode")&&o.checkHeadsetConnected()||(this.polyfillControls.update(),t.setFromQuaternion(this.polyfillObject.quaternion,"YXZ"),n.rotation.x=t.x+i.rotation.x,n.rotation.y=t.y+a.rotation.y)}),onMouseMove:function(e){var t,n,r,i=this.pitchObject,a=this.previousMouseEvent,o=this.yawObject;this.data.enabled&&(this.mouseDown||this.pointerLocked)&&(this.pointerLocked?(n=e.movementX||e.mozMovementX||0,r=e.movementY||e.mozMovementY||0):(n=e.screenX-a.screenX,r=e.screenY-a.screenY),this.previousMouseEvent=e,t=this.data.reverseMouseDrag?1:-1,o.rotation.y+=.002*n*t,i.rotation.x+=.002*r*t,i.rotation.x=Math.max(-c,Math.min(c,i.rotation.x)))},onMouseDown:function(e){if(this.data.enabled&&0===e.button){var t=this.el.sceneEl,n=t&&t.canvas;this.mouseDown=!0,this.previousMouseEvent=e,this.showGrabbingCursor(),this.data.pointerLockEnabled&&!this.pointerLocked&&(n.requestPointerLock?n.requestPointerLock():n.mozRequestPointerLock&&n.mozRequestPointerLock())}},showGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor="grabbing"},hideGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor=""},onMouseUp:function(){this.mouseDown=!1,this.hideGrabbingCursor()},onTouchStart:function(e){1===e.touches.length&&this.data.touchEnabled&&(this.touchStart={x:e.touches[0].pageX,y:e.touches[0].pageY},this.touchStarted=!0)},onTouchMove:function(e){var t,n,r=this.el.sceneEl.canvas,i=this.yawObject;this.touchStarted&&this.data.touchEnabled&&(n=2*Math.PI*(e.touches[0].pageX-this.touchStart.x)/r.clientWidth,t=this.data.reverseTouchDrag?1:-1,i.rotation.y-=.5*n*t,this.touchStart={x:e.touches[0].pageX,y:e.touches[0].pageY})},onTouchEnd:function(){this.touchStarted=!1},onEnterVR:function(){this.el.sceneEl.checkHeadsetConnected()&&(this.saveCameraPose(),this.el.object3D.position.set(0,0,0),this.el.object3D.updateMatrix())},onExitVR:function(){this.el.sceneEl.checkHeadsetConnected()&&(this.restoreCameraPose(),this.previousHMDPosition.set(0,0,0))},onPointerLockChange:function(){this.pointerLocked=!(!document.pointerLockElement&&!document.mozPointerLockElement)},onPointerLockError:function(){this.pointerLocked=!1},exitPointerLock:function(){document.exitPointerLock(),this.pointerLocked=!1},updateGrabCursor:function(e){var t=this.el.sceneEl;function n(){t.canvas.classList.add("a-grab-cursor")}function r(){t.canvas.classList.remove("a-grab-cursor")}t.canvas?e?n():r():e?t.addEventListener("render-target-loaded",n):t.addEventListener("render-target-loaded",r)},saveCameraPose:function(){var e=this.el;this.savedPose.position.copy(e.object3D.position),this.savedPose.rotation.copy(e.object3D.rotation),this.hasSavedPose=!0},restoreCameraPose:function(){var e=this.el,t=this.savedPose;this.hasSavedPose&&(e.object3D.position.copy(t.position),e.object3D.rotation.copy(t.rotation),this.hasSavedPose=!1)}})},853:function(e,t,n){var r=n(24),i=n(22),a=n(19),o=n(89),s=r.debug("components:material:error"),c=i.registerComponent,l=o.shaders,u=o.shaderNames;function h(e,t){e.dispose(),t.unregisterMaterial(e)}e.exports.Component=c("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:!0},depthWrite:{default:!0},flatShading:{default:!1},npot:{default:!1},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:u,schemaChange:!0},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:!1},vertexColors:{type:"string",default:"none",oneOf:["face","vertex"]},visible:{default:!0},blending:{default:"normal",oneOf:["none","normal","additive","subtractive","multiply"]}},init:function(){this.material=null},update:function(e){var t=this.data;this.shader&&t.shader===e.shader||this.updateShader(t.shader),this.shader.update(this.data),this.updateMaterial(e)},updateSchema:function(e){var t,n,r,i;n=e&&e.shader,t=this.oldData&&this.oldData.shader,(r=l[i=n||t]&&l[i].schema)||s("Unknown shader schema "+i),t&&n===t||(this.extendSchema(r),this.updateBehavior())},updateBehavior:function(){var e,t,n=this.el.sceneEl,r=this.schema,i=this;function a(e,n){var r;for(r in t)t[r]=e;i.shader.update(t)}for(e in this.tick=void 0,t={},r)"time"===r[e].type&&(this.tick=a,t[e]=!0);n&&(this.tick?n.addBehavior(this):n.removeBehavior(this))},updateShader:function(e){var t,n=this.data,r=l[e]&&l[e].Shader;if(!r)throw new Error("Unknown shader "+e);(t=this.shader=new r).el=this.el,t.init(n),this.setMaterial(t.material),this.updateSchema(n)},updateMaterial:function(e){var t,n=this.data,r=this.material;for(t in r.alphaTest=n.alphaTest,r.depthTest=!1!==n.depthTest,r.depthWrite=!1!==n.depthWrite,r.opacity=n.opacity,r.flatShading=n.flatShading,r.side=function(e){switch(e){case"back":return a.BackSide;case"double":return a.DoubleSide;default:return a.FrontSide}}(n.side),r.transparent=!1!==n.transparent||n.opacity<1,r.vertexColors=function(e){switch(e){case"face":return a.FaceColors;case"vertex":return a.VertexColors;default:return a.NoColors}}(n.vertexColors),r.visible=n.visible,r.blending=function(e){switch(e){case"none":return a.NoBlending;case"additive":return a.AdditiveBlending;case"subtractive":return a.SubtractiveBlending;case"multiply":return a.MultiplyBlending;default:return a.NormalBlending}}(n.blending),e)break;!t||e.alphaTest===n.alphaTest&&e.side===n.side&&e.vertexColors===n.vertexColors||(r.needsUpdate=!0)},remove:function(){var e=new a.MeshBasicMaterial,t=this.material,n=this.el.getObject3D("mesh");n&&(n.material=e),h(t,this.system)},setMaterial:function(e){var t,n=this.el,r=this.system;this.material&&h(this.material,r),this.material=e,r.registerMaterial(e),(t=n.getObject3D("mesh"))?t.material=e:n.addEventListener("object3dset",(function t(r){"mesh"===r.detail.type&&r.target===n&&(n.getObject3D("mesh").material=e,n.removeEventListener("object3dset",t))}))}})},854:function(e,t,n){var r=n(99),i=n(22).registerComponent,a=n(19),o=r("components:obj-model:warn");e.exports.Component=i("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){this.model=null,this.objLoader=new a.OBJLoader,this.mtlLoader=new a.MTLLoader(this.objLoader.manager),this.mtlLoader.crossOrigin=""},update:function(){var e=this.data;e.obj&&(this.resetMesh(),this.loadObj(e.obj,e.mtl))},remove:function(){this.model&&this.resetMesh()},resetMesh:function(){this.el.removeObject3D("mesh")},loadObj:function(e,t){var n=this,r=this.el,i=this.mtlLoader,s=this.objLoader,c=this.el.sceneEl.systems.renderer;if(t)return r.hasAttribute("material")&&o("Material component properties are ignored when a .MTL is provided"),i.setTexturePath(t.substr(0,t.lastIndexOf("/")+1)),void i.load(t,(function(t){t.preload(),s.setMaterials(t),s.load(e,(function(e){n.model=e,n.model.traverse((function(e){if(e.isMesh){var t=e.material;t.color&&c.applyColorCorrection(t.color),t.map&&c.applyColorCorrection(t.map),t.emissive&&c.applyColorCorrection(t.emissive),t.emissiveMap&&c.applyColorCorrection(t.emissiveMap)}})),r.setObject3D("mesh",e),r.emit("model-loaded",{format:"obj",model:e})}))}));s.load(e,(function(e){var t=r.components.material;t&&e.traverse((function(e){e instanceof a.Mesh&&(e.material=t.material)})),n.model=e,r.setObject3D("mesh",e),r.emit("model-loaded",{format:"obj",model:e})}))}})},855:function(e,t,n){var r=n(22).registerComponent;e.exports.Component=r("position",{schema:{type:"vec3"},update:function(){var e=this.el.object3D,t=this.data;e.position.set(t.x,t.y,t.z),e.matrixNeedsUpdate=!0},remove:function(){this.el.object3D.position.set(0,0,0),this.el.object3D.matrixNeedsUpdate=!0}})},856:function(e,t,n){var r,i,a=n(22).registerComponent,o=n(19),s=n(24).debug("components:raycaster:warn"),c=/^[\w\s-.,[\]#]*$/,l={childList:!0,attributes:!0,subtree:!0},u="raycaster-intersected",h="raycaster-intersection",d="raycaster-intersected-cleared",p="raycaster-intersection-cleared";function f(e,t){var n;for(e.length=t.length,n=0;n<t.length;n++)e[n]=t[n]}e.exports.Component=a("raycaster",{schema:{autoRefresh:{default:!0},direction:{type:"vec3",default:{x:0,y:0,z:-1}},enabled:{default:!0},far:{default:1e3},interval:{default:0},near:{default:0},objects:{default:""},origin:{type:"vec3"},showLine:{default:!1},useWorldCoordinates:{default:!1}},multiple:!0,init:function(){this.clearedIntersectedEls=[],this.unitLineEndVec3=new o.Vector3,this.intersectedEls=[],this.intersections=[],this.newIntersectedEls=[],this.newIntersections=[],this.objects=[],this.prevCheckTime=void 0,this.prevIntersectedEls=[],this.rawIntersections=[],this.raycaster=new o.Raycaster,this.updateOriginDirection(),this.setDirty=this.setDirty.bind(this),this.updateLine=this.updateLine.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.lineEndVec3=new o.Vector3,this.otherLineEndVec3=new o.Vector3,this.lineData={end:this.lineEndVec3},this.getIntersection=this.getIntersection.bind(this),this.intersectedDetail={el:this.el,getIntersection:this.getIntersection},this.intersectedClearedDetail={el:this.el},this.intersectionClearedDetail={clearedEls:this.clearedIntersectedEls},this.intersectionDetail={}},update:function(e){var t=this.data,n=this.el,r=this.raycaster;r.far=t.far,r.near=t.near,!t.showLine||t.far===e.far&&t.origin===e.origin&&t.direction===e.direction&&e.showLine||(this.unitLineEndVec3.copy(t.origin).add(t.direction).normalize(),this.drawLine()),!t.showLine&&e.showLine&&n.removeAttribute("line"),t.objects===e.objects||c.test(t.objects)||s('[raycaster] Selector "'+t.objects+'" may not update automatically with DOM changes.'),t.objects||s('[raycaster] For performance, please define raycaster.objects when using raycaster or cursor components to whitelist which entities to intersect with. e.g., raycaster="objects: [data-raycastable]".'),t.autoRefresh!==e.autoRefresh&&n.isPlaying&&(t.autoRefresh?this.addEventListeners():this.removeEventListeners()),e.enabled&&!t.enabled&&this.clearAllIntersections(),this.setDirty()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.data.showLine&&this.el.removeAttribute("line"),this.clearAllIntersections()},addEventListeners:function(){this.data.autoRefresh&&(this.observer.observe(this.el.sceneEl,l),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty))},removeEventListeners:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},setDirty:function(){this.dirty=!0},refreshObjects:function(){var e,t=this.data;e=t.objects?this.el.sceneEl.querySelectorAll(t.objects):this.el.sceneEl.querySelectorAll("*"),this.objects=this.flattenObject3DMaps(e),this.dirty=!1},tick:function(e){var t=this.data,n=this.prevCheckTime;t.enabled&&(n&&e-n<t.interval||(this.prevCheckTime=e,this.checkIntersections()))},checkIntersections:function(){var e,t,n=this.clearedIntersectedEls,r=this.el,i=this.data,a=this.intersectedEls,o=this.intersections,s=this.newIntersectedEls,c=this.newIntersections,l=this.prevIntersectedEls,m=this.rawIntersections;for(this.dirty&&this.refreshObjects(),f(this.prevIntersectedEls,this.intersectedEls),this.updateOriginDirection(),m.length=0,this.raycaster.intersectObjects(this.objects,!0,m),o.length=0,a.length=0,e=0;e<m.length;e++)t=m[e],i.showLine&&t.object===r.getObject3D("line")||t.object.el&&(o.push(t),a.push(t.object.el));for(c.length=0,s.length=0,e=0;e<o.length;e++)-1===l.indexOf(o[e].object.el)&&(c.push(o[e]),s.push(o[e].object.el));for(n.length=0,e=0;e<l.length;e++)-1===a.indexOf(l[e])&&(l[e].emit(d,this.intersectedClearedDetail),n.push(l[e]));for(n.length&&r.emit(p,this.intersectionClearedDetail),e=0;e<s.length;e++)s[e].emit(u,this.intersectedDetail);c.length&&(this.intersectionDetail.els=s,this.intersectionDetail.intersections=c,r.emit(h,this.intersectionDetail)),setTimeout(this.updateLine)},updateLine:function(){var e,t=this.el,n=this.intersections;this.data.showLine&&(n.length&&(e=n[0].object.el===t&&n[1]?n[1].distance:n[0].distance),this.drawLine(e))},getIntersection:function(e){var t,n;for(t=0;t<this.intersections.length;t++)if((n=this.intersections[t]).object.el===e)return n;return null},updateOriginDirection:(r=new o.Vector3,i=new o.Vector3,function(){var e=this.el,t=this.data;t.useWorldCoordinates?this.raycaster.set(t.origin,t.direction):(e.object3D.getWorldPosition(i),0===t.origin.x&&0===t.origin.y&&0===t.origin.z||(i=e.object3D.localToWorld(i.copy(t.origin))),r.copy(t.direction).transformDirection(e.object3D.matrixWorld).normalize(),this.raycaster.set(i,r))}),drawLine:function(e){var t,n=this.data,r=this.el;t=this.lineData.end===this.lineEndVec3?this.otherLineEndVec3:this.lineEndVec3,void 0===e&&(e=n.far===1/0?1e3:n.far),this.lineData.start=n.origin,this.lineData.end=t.copy(this.unitLineEndVec3).multiplyScalar(e),r.setAttribute("line",this.lineData)},flattenObject3DMaps:function(e){var t,n,r=this.objects;for(r.length=0,n=0;n<e.length;n++)if(e[n].isEntity&&e[n].object3D)for(t in e[n].object3DMap)r.push(e[n].getObject3D(t));return r},clearAllIntersections:function(){var e;for(e=0;e<this.intersectedEls.length;e++)this.intersectedEls[e].emit(d,this.intersectedClearedDetail);f(this.clearedIntersectedEls,this.intersectedEls),this.intersectedEls.length=0,this.intersections.length=0,this.el.emit(p,this.intersectionClearedDetail)}})},857:function(e,t,n){var r=n(19).Math.degToRad,i=n(22).registerComponent;e.exports.Component=i("rotation",{schema:{type:"vec3"},update:function(){var e=this.data,t=this.el.object3D;t.rotation.set(r(e.x),r(e.y),r(e.z)),t.rotation.order="YXZ",t.matrixNeedsUpdate=!0},remove:function(){this.el.object3D.rotation.set(0,0,0),this.el.object3D.matrixNeedsUpdate=!0}})},858:function(e,t,n){var r=n(22).registerComponent;e.exports.Component=r("scale",{schema:{type:"vec3",default:{x:1,y:1,z:1}},update:function(){var e=this.data,t=this.el.object3D,n=0===e.x?1e-5:e.x,r=0===e.y?1e-5:e.y,i=0===e.z?1e-5:e.z;t.scale.set(n,r,i),t.matrixNeedsUpdate=!0},remove:function(){this.el.object3D.scale.set(1,1,1),this.el.object3D.matrixNeedsUpdate=!0}})},859:function(e,t,n){var r=n(22),i=n(19),a=n(170),o=r.registerComponent;e.exports.Component=o("shadow",{schema:{cast:{default:!0},receive:{default:!0}},init:function(){this.onMeshChanged=a(this.update,this),this.el.addEventListener("object3dset",this.onMeshChanged),this.system.setShadowMapEnabled(!0)},update:function(){var e=this.data;this.updateDescendants(e.cast,e.receive)},remove:function(){this.el.removeEventListener("object3dset",this.onMeshChanged),this.updateDescendants(!1,!1)},updateDescendants:function(e,t){var n=this.el.sceneEl;this.el.object3D.traverse((function(r){if(r instanceof i.Mesh&&(r.castShadow=e,r.receiveShadow=t,n.hasLoaded&&r.material))for(var a=Array.isArray(r.material)?r.material:[r.material],o=0;o<a.length;o++)a[o].needsUpdate=!0}))}})},860:function(e,t,n){var r=n(22).registerComponent,i=n(99),a=n(19),o=i("components:sound:warn");e.exports.Component=r("sound",{schema:{autoplay:{default:!1},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:!1},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:!0},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:!0,init:function(){var e=this;this.listener=null,this.audioLoader=new a.AudioLoader,this.pool=new a.Group,this.loaded=!1,this.mustPlay=!1,this.playSoundBound=function(){e.playSound()}},update:function(e){var t,n,r=this.data,i=r.src!==e.src;if(i){if(!r.src)return;this.setupSound()}for(t=0;t<this.pool.children.length;t++)n=this.pool.children[t],r.positional&&(n.setDistanceModel(r.distanceModel),n.setMaxDistance(r.maxDistance),n.setRefDistance(r.refDistance),n.setRolloffFactor(r.rolloffFactor)),n.setLoop(r.loop),n.setVolume(r.volume),n.isPaused=!1;if(r.on!==e.on&&this.updateEventListener(e.on),i){var o=this;this.loaded=!1,this.audioLoader.load(r.src,(function(e){for(t=0;t<o.pool.children.length;t++)(n=o.pool.children[t]).setBuffer(e);o.loaded=!0,a.Cache.remove(r.src),(o.data.autoplay||o.mustPlay)&&o.playSound(),o.el.emit("sound-loaded",o.evtDetail,!1)}))}},pause:function(){this.stopSound(),this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound(),this.updateEventListener()},remove:function(){var e;this.removeEventListener(),this.el.getObject3D(this.attrName)&&this.el.removeObject3D(this.attrName);try{for(e=0;e<this.pool.children.length;e++)this.pool.children[e].disconnect()}catch(e){o("Audio source not properly disconnected")}},updateEventListener:function(e){var t=this.el;e&&t.removeEventListener(e,this.playSoundBound),t.addEventListener(this.data.on,this.playSoundBound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSoundBound)},setupSound:function(){var e,t,n=this,r=this.el,i=r.sceneEl;this.pool.children.length>0&&(this.stopSound(),r.removeObject3D("sound"));var o=this.listener=i.audioListener||new a.AudioListener;for(i.audioListener=o,i.camera&&i.camera.add(o),i.addEventListener("camera-set-active",(function(e){e.detail.cameraEl.getObject3D("camera").add(o)})),this.pool=new a.Group,e=0;e<this.data.poolSize;e++)t=this.data.positional?new a.PositionalAudio(o):new a.Audio(o),this.pool.add(t);for(r.setObject3D(this.attrName,this.pool),e=0;e<this.pool.children.length;e++)(t=this.pool.children[e]).onEnded=function(){this.isPlaying=!1,r.emit("sound-ended",n.evtDetail,!1)}},pauseSound:function(){var e,t;for(this.isPlaying=!1,e=0;e<this.pool.children.length;e++)(t=this.pool.children[e]).source&&t.source.buffer&&t.isPlaying&&!t.isPaused&&(t.isPaused=!0,t.pause())},playSound:function(e){var t,n,r;if(!this.loaded)return o("Sound not loaded yet. It will be played once it finished loading"),void(this.mustPlay=!0);for(t=!1,this.isPlaying=!0,n=0;n<this.pool.children.length;n++)(r=this.pool.children[n]).isPlaying||!r.buffer||t||(e&&e(r),r.play(),r.isPaused=!1,t=!0);t?this.mustPlay=!1:o("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",this.el)},stopSound:function(){var e,t;for(this.isPlaying=!1,e=0;e<this.pool.children.length;e++){if(!(t=this.pool.children[e]).source||!t.source.buffer)return;t.stop()}}})},861:function(e,t,n){var r=n(22).registerComponent;e.exports.Component=r("visible",{schema:{default:!0},update:function(){this.el.object3D.visible=this.data}})},862:function(e,t,n){var r,i,a=n(152).keyboardevent.KEYCODE_TO_CODE,o=n(22).registerComponent,s=n(19),c=n(24),l=c.bind,u=c.shouldCaptureKeyEvent,h=["KeyW","KeyA","KeyS","KeyD","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"];e.exports.Component=o("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:!0},adInverted:{default:!1},enabled:{default:!0},fly:{default:!1},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:!0},wsInverted:{default:!1}},init:function(){this.keys={},this.easing=1.1,this.velocity=new s.Vector3,this.onBlur=l(this.onBlur,this),this.onFocus=l(this.onFocus,this),this.onKeyDown=l(this.onKeyDown,this),this.onKeyUp=l(this.onKeyUp,this),this.onVisibilityChange=l(this.onVisibilityChange,this),this.attachVisibilityEventListeners()},tick:function(e,t){var n=this.data,r=this.el,i=this.velocity;(i[n.adAxis]||i[n.wsAxis]||!function(e){var t;for(t in e)return!1;return!0}(this.keys))&&(t/=1e3,this.updateVelocity(t),(i[n.adAxis]||i[n.wsAxis])&&r.object3D.position.add(this.getMovementVector(t)))},remove:function(){this.removeKeyEventListeners(),this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){this.keys={},this.removeKeyEventListeners()},updateVelocity:function(e){var t,n,r,i,a,o=this.data,s=this.keys,c=this.velocity;if(n=o.adAxis,i=o.wsAxis,e>.2)return c[n]=0,void(c[i]=0);var l=Math.pow(1/this.easing,60*e);0!==c[n]&&(c[n]-=c[n]*l),0!==c[i]&&(c[i]-=c[i]*l),Math.abs(c[n])<1e-5&&(c[n]=0),Math.abs(c[i])<1e-5&&(c[i]=0),o.enabled&&(t=o.acceleration,o.adEnabled&&(r=o.adInverted?-1:1,(s.KeyA||s.ArrowLeft)&&(c[n]-=r*t*e),(s.KeyD||s.ArrowRight)&&(c[n]+=r*t*e)),o.wsEnabled&&(a=o.wsInverted?-1:1,(s.KeyW||s.ArrowUp)&&(c[i]-=a*t*e),(s.KeyS||s.ArrowDown)&&(c[i]+=a*t*e)))},getMovementVector:(r=new s.Vector3(0,0,0),i=new s.Euler(0,0,0,"YXZ"),function(e){var t,n=this.el.getAttribute("rotation"),a=this.velocity;return r.copy(a),r.multiplyScalar(e),n?(t=this.data.fly?n.x:0,i.set(s.Math.degToRad(t),s.Math.degToRad(n.y),0),r.applyEuler(i),r):r}),attachVisibilityEventListeners:function(){window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),document.removeEventListener("visibilitychange",this.onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){document.hidden?this.onBlur():this.onFocus()},onKeyDown:function(e){var t;u(e)&&(t=e.code||a[e.keyCode],-1!==h.indexOf(t)&&(this.keys[t]=!0))},onKeyUp:function(e){var t;t=e.code||a[e.keyCode],delete this.keys[t]}})},863:function(e,t,n){var r=n(22).registerComponent;e.exports.Component=r("background",{schema:{color:{type:"color",default:"black"},transparent:{default:!1}},update:function(){var e=this.data,t=this.el.object3D;e.transparent?t.background=null:t.background=new THREE.Color(e.color)}})},864:function(e,t,n){var r=n(22).registerComponent;e.exports.Component=r("debug",{schema:{default:!0}})},865:function(e,t,n){var r=n(22).registerComponent;e.exports.Component=r("embedded",{dependencies:["vr-mode-ui"],schema:{default:!0},update:function(){var e=this.el,t=e.querySelector(".a-enter-vr");!0===this.data?(t&&t.classList.add("embedded"),e.removeFullScreenStyles()):(t&&t.classList.remove("embedded"),e.addFullScreenStyles())}})},866:function(e,t,n){var r=n(152).AFRAME_INJECTED,i=n(22).registerComponent,a=n(24),o="dev"==={NODE_ENV:"production",SHORTLINK_DOMAIN:"hub.link",RETICULUM_SERVER:"dev.reticulum.io",THUMBNAIL_SERVER:"nearspark-dev.reticulum.io",CORS_PROXY_SERVER:"cors-proxy-dev.reticulum.io",NON_CORS_PROXY_DOMAINS:"hubs.local,dev.reticulum.io"}.INSPECTOR_VERSION?"https://aframe.io/aframe-inspector/dist/aframe-inspector.js":"https://unpkg.com/aframe-inspector@0.9.0/dist/aframe-inspector.min.js";e.exports.Component=i("inspector",{schema:{url:{default:o}},init:function(){this.firstPlay=!0,this.onKeydown=this.onKeydown.bind(this),this.onMessage=this.onMessage.bind(this),this.initOverlay(),window.addEventListener("keydown",this.onKeydown),window.addEventListener("message",this.onMessage)},play:function(){var e;this.firstPlay&&"false"!==(e=a.getUrlParameter("inspector"))&&e&&(this.openInspector(),this.firstPlay=!1)},initOverlay:function(){this.loadingMessageEl=document.createElement("div"),this.loadingMessageEl.classList.add("a-inspector-loader"),this.loadingMessageEl.innerHTML='Loading Inspector<span class="dots"><span>.</span><span>.</span><span>.</span></span>'},remove:function(){this.removeEventListeners()},onKeydown:function(e){73===e.keyCode&&e.ctrlKey&&e.altKey&&this.openInspector()},showLoader:function(){document.body.appendChild(this.loadingMessageEl)},hideLoader:function(){document.body.removeChild(this.loadingMessageEl)},onMessage:function(e){"INJECT_AFRAME_INSPECTOR"===e.data&&this.openInspector()},openInspector:function(e){var t,n=this;AFRAME.INSPECTOR||AFRAME.inspectorInjected?AFRAME.INSPECTOR.open(e):(this.showLoader(),(t=document.createElement("script")).src=this.data.url,t.setAttribute("data-name","aframe-inspector"),t.setAttribute(r,""),t.onload=function(){AFRAME.INSPECTOR.open(e),n.hideLoader(),n.removeEventListeners()},t.onerror=function(){n.loadingMessageEl.innerHTML="Error loading Inspector"},document.head.appendChild(t),AFRAME.inspectorInjected=!0)},removeEventListeners:function(){window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("message",this.onMessage)}})},867:function(e,t,n){var r=n(22).registerComponent,i=n(19),a=n(99)("components:fog:warn");e.exports.Component=r("fog",{schema:{color:{type:"color",default:"#000"},density:{default:25e-5},far:{default:1e3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},update:function(){var e=this.data,t=this.el,n=this.el.object3D.fog;if(t.isScene)return n&&e.type===n.name?void Object.keys(this.schema).forEach((function(t){var r=e[t];"color"===t&&(r=new i.Color(r)),n[t]=r})):(t.object3D.fog=function(e){var t;t="exponential"===e.type?new i.FogExp2(e.color,e.density):new i.Fog(e.color,e.near,e.far);return t.name=e.type,t}(e),void t.systems.material.updateMaterials());a("Fog component can only be applied to <a-scene>")},remove:function(){var e=this.el.object3D.fog;e&&(e.far=0,e.near=.1)}})},868:function(e,t,n){var r=n(22).registerComponent,i=n(24).shouldCaptureKeyEvent;e.exports.Component=r("keyboard-shortcuts",{schema:{enterVR:{default:!0},exitVR:{default:!0}},init:function(){this.onKeyup=this.onKeyup.bind(this)},update:function(e){var t=this.data;this.enterVREnabled=t.enterVR},play:function(){window.addEventListener("keyup",this.onKeyup,!1)},pause:function(){window.removeEventListener("keyup",this.onKeyup)},onKeyup:function(e){var t=this.el;i(e)&&(this.enterVREnabled&&70===e.keyCode&&t.enterVR(),this.enterVREnabled&&27===e.keyCode&&t.exitVR())}})},869:function(e,t,n){var r=n(99),i=n(22).registerComponent,a=r("components:pool:warn");e.exports.Component=i("pool",{schema:{container:{default:""},mixin:{default:""},size:{default:0},dynamic:{default:!1}},multiple:!0,initPool:function(){var e;for(this.availableEls=[],this.usedEls=[],this.data.mixin||a("No mixin provided for pool component."),this.data.container&&(this.container=document.querySelector(this.data.container),this.container||a("Container "+this.data.container+" not found.")),this.container=this.container||this.el,e=0;e<this.data.size;++e)this.createEntity()},update:function(e){var t=this.data;e.mixin===t.mixin&&e.size===t.size||this.initPool()},createEntity:function(){var e;(e=document.createElement("a-entity")).play=this.wrapPlay(e.play),e.setAttribute("mixin",this.data.mixin),e.object3D.visible=!1,e.pause(),this.container.appendChild(e),this.availableEls.push(e)},wrapPlay:function(e){var t=this.usedEls;return function(){-1!==t.indexOf(this)&&e.call(this)}},requestEntity:function(){var e;if(0===this.availableEls.length){if(!1===this.data.dynamic)return void a("Requested entity from empty pool: "+this.attrName);a("Requested entity from empty pool. This pool is dynamic and will resize automatically. You might want to increase its initial size: "+this.attrName),this.createEntity()}return e=this.availableEls.shift(),this.usedEls.push(e),e.object3D.visible=!0,e},returnEntity:function(e){var t=this.usedEls.indexOf(e);if(-1!==t)return this.usedEls.splice(t,1),this.availableEls.push(e),e.object3D.visible=!1,e.pause(),e;a("The returned entity was not previously pooled from "+this.attrName)}})},870:function(e,t,n){var r=n(22).registerComponent,i=n(19),a=["attribute vec3 position;","attribute vec2 uv;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main()  {","  vUv = vec2( 1.- uv.x, uv.y );","  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),o=["precision mediump float;","uniform samplerCube map;","varying vec2 vUv;","#define M_PI 3.141592653589793238462643383279","void main() {","  vec2 uv = vUv;","  float longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;","  float latitude = uv.y * M_PI;","  vec3 dir = vec3(","    - sin( longitude ) * sin( latitude ),","    cos( latitude ),","    - cos( longitude ) * sin( latitude )","  );","  normalize( dir );","  gl_FragColor = vec4( textureCube( map, dir ).rgb, 1.0 );","}"].join("\n");e.exports.Component=r("screenshot",{schema:{width:{default:4096},height:{default:2048},camera:{type:"selector"}},init:function(){var e=this.el,t=this;function n(){var n=e.renderer.getContext();n&&(t.cubeMapSize=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),t.material=new i.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:a,fragmentShader:o,side:i.DoubleSide}),t.quad=new i.Mesh(new i.PlaneBufferGeometry(1,1),t.material),t.quad.visible=!1,t.camera=new i.OrthographicCamera(-.5,.5,.5,-.5,-1e4,1e4),t.canvas=document.createElement("canvas"),t.ctx=t.canvas.getContext("2d"),e.object3D.add(t.quad),t.onKeyDown=t.onKeyDown.bind(t))}e.renderer?n():e.addEventListener("render-target-loaded",n)},getRenderTarget:function(e,t){return new i.WebGLRenderTarget(e,t,{minFilter:i.LinearFilter,magFilter:i.LinearFilter,wrapS:i.ClampToEdgeWrapping,wrapT:i.ClampToEdgeWrapping,format:i.RGBAFormat,type:i.UnsignedByteType})},resize:function(e,t){this.quad.scale.set(e,t,1),this.camera.left=-1*e/2,this.camera.right=e/2,this.camera.top=t/2,this.camera.bottom=-1*t/2,this.camera.updateProjectionMatrix(),this.canvas.width=e,this.canvas.height=t},play:function(){window.addEventListener("keydown",this.onKeyDown)},onKeyDown:function(e){var t=83===e.keyCode&&e.ctrlKey&&e.altKey;if(this.data&&t){var n=e.shiftKey?"equirectangular":"perspective";this.capture(n)}},setCapture:function(e){var t,n,r,a=this.el;return"perspective"===e?(this.quad.visible=!1,n=this.data.camera&&this.data.camera.components.camera.camera||a.camera,t={width:this.data.width,height:this.data.height}):(n=this.camera,r=new i.CubeCamera(a.camera.near,a.camera.far,Math.min(this.cubeMapSize,2048)),a.camera.getWorldPosition(r.position),a.camera.getWorldQuaternion(r.quaternion),r.update(a.renderer,a.object3D),this.quad.material.uniforms.map.value=r.renderTarget.texture,t={width:this.data.width,height:this.data.height},this.quad.visible=!0),{camera:n,size:t,projection:e}},capture:function(e){var t,n=this.el.renderer.vr.enabled,r=this.el.renderer;r.vr.enabled=!1,t=this.setCapture(e),this.renderCapture(t.camera,t.size,t.projection),this.saveCapture(),r.vr.enabled=n},getCanvas:function(e){var t=this.setCapture(e);return this.renderCapture(t.camera,t.size,t.projection),this.canvas},renderCapture:function(e,t,n){var r,i,a,o=this.el.renderer.autoClear,s=this.el,c=s.renderer;i=this.getRenderTarget(t.width,t.height),a=new Uint8Array(4*t.width*t.height),this.resize(t.width,t.height),c.autoClear=!0,c.render(s.object3D,e,i,!0),c.autoClear=o,c.readRenderTargetPixels(i,0,0,t.width,t.height,a),"perspective"===n&&(a=this.flipPixelsVertically(a,t.width,t.height)),r=new ImageData(new Uint8ClampedArray(a),t.width,t.height),this.quad.visible=!1,this.ctx.putImageData(r,0,0)},flipPixelsVertically:function(e,t,n){for(var r=e.slice(0),i=0;i<t;++i)for(var a=0;a<n;++a)r[4*i+a*t*4]=e[4*i+(n-a)*t*4],r[4*i+1+a*t*4]=e[4*i+1+(n-a)*t*4],r[4*i+2+a*t*4]=e[4*i+2+(n-a)*t*4],r[4*i+3+a*t*4]=e[4*i+3+(n-a)*t*4];return r},saveCapture:function(){this.canvas.toBlob((function(e){var t="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png",n=document.createElement("a"),r=URL.createObjectURL(e);n.href=r,n.setAttribute("download",t),n.innerHTML="downloading...",n.style.display="none",document.body.appendChild(n),setTimeout((function(){n.click(),document.body.removeChild(n)}),1)}),"image/png")}})},871:function(e,t,n){var r=n(22).registerComponent,i=n(872),a=n(24);n(873),n(874);var o=window.aframeStats,s=a.bind,c=window.threeStats;e.exports.Component=r("stats",{schema:{default:!0},init:function(){var e=this.el;"false"!==a.getUrlParameter("stats")&&(this.stats=function(e){var t=new c(e.renderer),n=new o(e),r=e.isMobile?[]:[t,n];return new i({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:r})}(e),this.statsEl=document.querySelector(".rs-base"),this.hideBound=s(this.hide,this),this.showBound=s(this.show,this),e.addEventListener("enter-vr",this.hideBound),e.addEventListener("exit-vr",this.showBound))},update:function(){if(this.stats)return this.data?this.show():this.hide()},remove:function(){this.el.removeEventListener("enter-vr",this.hideBound),this.el.removeEventListener("exit-vr",this.showBound),this.statsEl&&this.statsEl.parentNode.removeChild(this.statsEl)},tick:function(){var e=this.stats;e&&(e("rAF").tick(),e("FPS").frame(),e().update())},hide:function(){this.statsEl.classList.add("a-hidden")},show:function(){this.statsEl.classList.remove("a-hidden")}})},872:function(e,t,n){"use strict";!function(){"performance"in window==0&&(window.performance={});var e=window.performance;if("now"in e==0){var t=Date.now();e.timing&&e.timing.navigationStart&&(t=e.timing.navigationStart),e.now=function(){return Date.now()-t}}e.mark||(e.mark=function(){}),e.measure||(e.measure=function(){})}(),window.rStats=function(e){function t(e,t){for(var n=Object.keys(e),r=0,i=n.length;r<i;r++)t(n[r])}var n=e||{},r=n.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"],i=(n.CSSPath?n.CSSPath:"")+"rStats.css";(n.css||["https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300",i]).forEach((function(e){var t,n;t=e,(n=document.createElement("link")).href=t,n.rel="stylesheet",n.type="text/css",document.getElementsByTagName("head")[0].appendChild(n)})),n.values||(n.values={});var a,o,s={};function c(e,t,n){var r=n||{},i=document.createElement("canvas"),a=i.getContext("2d"),o=0,s=0,c=r.color?r.color:"#666666",l=document.createElement("canvas"),u=l.getContext("2d");l.width=1,l.height=20,u.fillStyle="#444444",u.fillRect(0,0,1,20),u.fillStyle=c,u.fillRect(0,10,1,10),u.fillStyle="#ffffff",u.globalAlpha=.5,u.fillRect(0,10,1,1),u.globalAlpha=1;var h=document.createElement("canvas"),d=h.getContext("2d");return h.width=1,h.height=20,d.fillStyle="#444444",d.fillRect(0,0,1,20),d.fillStyle="#b70000",d.fillRect(0,10,1,10),d.globalAlpha=.5,d.fillStyle="#ffffff",d.fillRect(0,10,1,1),d.globalAlpha=1,i.width=200,i.height=10,i.style.width=i.width+"px",i.style.height=i.height+"px",i.className="rs-canvas",e.appendChild(i),a.fillStyle="#444444",a.fillRect(0,0,i.width,i.height),{draw:function(e,t){(s+=.1*(e-s))>(o*=.99)&&(o=s),a.drawImage(i,1,0,i.width-1,i.height,0,0,i.width-1,i.height),t?a.drawImage(h,i.width-1,i.height-s*i.height/o-10):a.drawImage(l,i.width-1,i.height-s*i.height/o-10)}}}function l(e,n){var i=document.createElement("canvas"),a=i.getContext("2d");return i.width=200,i.height=10*n,i.style.width=i.width+"px",i.style.height=i.height+"px",i.className="rs-canvas",e.appendChild(i),a.fillStyle="#444444",a.fillRect(0,0,i.width,i.height),{draw:function(e){a.drawImage(i,1,0,i.width-1,i.height,0,0,i.width-1,i.height);var n=0;t(e,(function(t){var o=e[t]*i.height;a.fillStyle=r[t],a.fillRect(i.width-1,n,1,o),n+=o}))}}}function u(e,t){var r,i=e,a=0,s=0,l=0,u=0,h=performance.now(),d=0,p=document.createElement("div"),f=document.createElement("span"),m=document.createElement("div"),g=document.createTextNode(""),v=n?n.values[i.toLowerCase()]:null,y=new c(p,i,v),b=!1;function x(e){if(v&&v.average){u+=e,d++;var t=performance.now();t-h>=(v.avgMs||1e3)&&(l=u/d,u=0,h=t,d=0)}}function w(){r=performance.now(),n.userTimingAPI&&performance.mark(i+"-start"),b=!0}function E(){a=performance.now()-r,n.userTimingAPI&&(performance.mark(i+"-end"),b&&performance.measure(i,i+"-start",i+"-end")),x(a)}return f.className="rs-counter-id",f.textContent=v&&v.caption?v.caption:i,m.className="rs-counter-value",m.appendChild(g),p.appendChild(f),p.appendChild(m),t?t.div.appendChild(p):o.appendChild(p),r=performance.now(),{set:function(e){x(a=e)},start:w,tick:function(){E(),w()},end:E,frame:function(){var e=performance.now(),t=e-r;s++,t>1e3&&(a=v&&!1===v.interpolate?s:1e3*s/t,s=0,r=e,x(a))},value:function(){return a},draw:function(){var e=v&&v.average?l:a;g.nodeValue=Math.round(100*e)/100;var t=v&&(v.below&&a<v.below||v.over&&a>v.over);y.draw(a,t),p.className=t?"rs-counter-base alarm":"rs-counter-base"}}}function h(e){var r=e.toLowerCase();if(void 0===r&&(r="default"),s[r])return s[r];var i=null;n&&n.groups&&t(n.groups,(function(e){var t=n.groups[parseInt(e,10)];i||-1===t.values.indexOf(r.toLowerCase())||(i=t)}));var a=new u(r,i);return s[r]=a,a}function d(){t(n.plugins,(function(e){n.plugins[e].update()})),t(s,(function(e){s[e].draw()})),n&&n.fractions&&t(n.fractions,(function(e){var r=n.fractions[parseInt(e,10)],i=[],a=s[r.base.toLowerCase()];a&&(a=a.value(),t(n.fractions[e].steps,(function(t){var r=n.fractions[e].steps[parseInt(t,10)].toLowerCase(),o=s[r];o&&i.push(o.value()/a)}))),r.graph.draw(i)}))}return function(){if(n.plugins){n.values||(n.values={}),n.groups||(n.groups=[]),n.fractions||(n.fractions=[]);for(var e=0;e<n.plugins.length;e++)n.plugins[e].attach(h),t(n.plugins[e].values,(function(t){n.values[t]=n.plugins[e].values[t]})),n.groups=n.groups.concat(n.plugins[e].groups),n.fractions=n.fractions.concat(n.plugins[e].fractions)}else n.plugins={};(a=document.createElement("div")).className="rs-base",(o=document.createElement("div")).className="rs-container",o.style.height="auto",a.appendChild(o),document.body.appendChild(a),n&&(n.groups&&t(n.groups,(function(e){var t=n.groups[parseInt(e,10)],r=document.createElement("div");r.className="rs-group",t.div=r;var i=document.createElement("h1");i.textContent=t.caption,i.addEventListener("click",function(e){this.classList.toggle("hidden"),e.preventDefault()}.bind(r)),o.appendChild(i),o.appendChild(r)})),n.fractions&&t(n.fractions,(function(e){var i=n.fractions[parseInt(e,10)],a=document.createElement("div");a.className="rs-fraction";var s=document.createElement("div");s.className="rs-legend";var c=0;t(n.fractions[e].steps,(function(t){var i=document.createElement("p");i.textContent=n.fractions[e].steps[t],i.style.color=r[c],s.appendChild(i),c++})),a.appendChild(s),a.style.height=10*c+"px",i.div=a;var u=new l(a,c);i.graph=u,o.appendChild(a)})))}(),function(e){return e?h(e):{element:a,update:d}}},e.exports=window.rStats},873:function(e,t,n){window.glStats=function(){var e=null,t=0,n=0,r=0,i=0,a=0,o=0,s=0;function c(e,t){return function(){t.apply(this,arguments),e.apply(this,arguments)}}WebGLRenderingContext.prototype.drawArrays=c(WebGLRenderingContext.prototype.drawArrays,(function(){t++,arguments[0]==this.POINTS?o+=arguments[2]:a+=arguments[2]})),WebGLRenderingContext.prototype.drawElements=c(WebGLRenderingContext.prototype.drawElements,(function(){n++,i+=arguments[1]/3,a+=arguments[1]})),WebGLRenderingContext.prototype.useProgram=c(WebGLRenderingContext.prototype.useProgram,(function(){r++})),WebGLRenderingContext.prototype.bindTexture=c(WebGLRenderingContext.prototype.bindTexture,(function(){s++}));return{update:function(){e("allcalls").set(t+n),e("drawElements").set(n),e("drawArrays").set(t),e("bindTexture").set(s),e("useProgram").set(r),e("glfaces").set(i),e("glvertices").set(a),e("glpoints").set(o)},start:function(){t=0,n=0,r=0,i=0,a=0,o=0,s=0},end:function(){},attach:function(t){e=t},values:{allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}},groups:[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}],fractions:[{base:"allcalls",steps:["drawelements","drawarrays"]}]}},window.threeStats=function(e){var t=null;return{update:function(){t("renderer.info.memory.geometries").set(e.info.memory.geometries),t("renderer.info.programs").set(e.info.programs.length),t("renderer.info.memory.textures").set(e.info.memory.textures),t("renderer.info.render.calls").set(e.info.render.calls),t("renderer.info.render.triangles").set(e.info.render.triangles),t("renderer.info.render.points").set(e.info.render.points)},start:function(){},end:function(){},attach:function(e){t=e},values:{"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.triangles":{caption:"Triangles",over:1e3},"renderer.info.render.points":{caption:"Points"}},groups:[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.triangles","renderer.info.render.points"]}],fractions:[]}},window.BrowserStats=function(){var e=null,t=0,n=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0}),0===performance.memory.totalJSHeapSize&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var r=Math.log(1024);function i(e){var t=Math.floor(Math.log(e)/r);return Math.round(100*e/Math.pow(1024,t))/100}return{update:function(){t=i(performance.memory.usedJSHeapSize),n=i(performance.memory.totalJSHeapSize),e("memory").set(t),e("total").set(n)},start:function(){t=0},end:function(){},attach:function(t){e=t},values:{memory:{caption:"Used Memory",average:!0,avgMs:1e3,over:22},total:{caption:"Total Memory"}},groups:[{caption:"Browser",values:["memory","total"]}],fractions:[{base:"total",steps:["memory"]}]}},e.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats}},874:function(e,t,n){window.aframeStats=function(e){var t=null,n=e;return{update:function(){var e;t("te").set((e=n.querySelectorAll("*"),Array.prototype.slice.call(e).filter((function(e){return e.isEntity})),e.length)),window.performance.getEntriesByName&&t("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))},start:function(){},end:function(){},attach:function(e){t=e},values:{te:{caption:"Entities"},lt:{caption:"Load Time"}},groups:[{caption:"A-Frame",values:["te","lt"]}],fractions:[]}},e.exports={aframeStats:window.aframeStats}},875:function(e,t,n){var r=n(22).registerComponent,i=n(152),a=n(24),o=a.bind;e.exports.Component=r("vr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:!0},enterVRButton:{default:""}},init:function(){var e=this,t=this.el;"false"!==a.getUrlParameter("ui")&&(this.insideLoader=!1,this.enterVREl=null,this.orientationModalEl=null,this.bindMethods(),t.addEventListener("enter-vr",this.updateEnterVRInterface),t.addEventListener("exit-vr",this.updateEnterVRInterface),window.addEventListener("message",(function(t){"loaderReady"===t.data.type&&(e.insideLoader=!0,e.remove())})),window.addEventListener("orientationchange",this.toggleOrientationModalIfNeeded))},bindMethods:function(){this.onEnterVRButtonClick=o(this.onEnterVRButtonClick,this),this.onModalClick=o(this.onModalClick,this),this.toggleOrientationModalIfNeeded=o(this.toggleOrientationModalIfNeeded,this),this.updateEnterVRInterface=o(this.updateEnterVRInterface,this)},onModalClick:function(){this.el.exitVR()},onEnterVRButtonClick:function(){this.el.enterVR()},update:function(){var e,t,n,r=this.data,o=this.el;if(!r.enabled||this.insideLoader||"false"===a.getUrlParameter("ui"))return this.remove();this.enterVREl||this.orientationModalEl||(r.enterVRButton?(this.enterVREl=document.querySelector(r.enterVRButton),this.enterVREl.addEventListener("click",this.onEnterVRButtonClick)):(this.enterVREl=(e=this.onEnterVRButtonClick,(n=document.createElement("div")).classList.add("a-enter-vr"),n.setAttribute(i.AFRAME_INJECTED,""),(t=document.createElement("button")).className="a-enter-vr-button",t.setAttribute("title","Enter VR mode with a headset or fullscreen mode on a desktop. Visit https://webvr.rocks or https://webvr.info for more information."),t.setAttribute(i.AFRAME_INJECTED,""),n.appendChild(t),t.addEventListener("click",(function(t){e(),t.stopPropagation()})),n),o.appendChild(this.enterVREl)),this.orientationModalEl=function(e){var t=document.createElement("div");t.className="a-orientation-modal",t.classList.add("a-hidden"),t.setAttribute(i.AFRAME_INJECTED,"");var n=document.createElement("button");return n.setAttribute(i.AFRAME_INJECTED,""),n.innerHTML="Exit VR",n.addEventListener("click",e),t.appendChild(n),t}(this.onModalClick),o.appendChild(this.orientationModalEl),this.updateEnterVRInterface())},remove:function(){[this.enterVREl,this.orientationModalEl].forEach((function(e){e&&e.parentNode&&e.parentNode.removeChild(e)}))},updateEnterVRInterface:function(){this.toggleEnterVRButtonIfNeeded(),this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){var e=this.el;this.enterVREl&&(e.is("vr-mode")?this.enterVREl.classList.add("a-hidden"):this.enterVREl.classList.remove("a-hidden"))},toggleOrientationModalIfNeeded:function(){var e=this.el,t=this.orientationModalEl;t&&e.isMobile&&(!a.device.isLandscape()&&e.is("vr-mode")?t.classList.remove("a-hidden"):t.classList.add("a-hidden"))}})},876:function(e,t,n){n(877),n(878),n(879),n(880),n(881),n(882),n(883),n(884),n(885),n(886),n(887),n(888),n(889),n(890)},877:function(e,t,n){var r=n(54).registerGeometry,i=n(19);r("box",{schema:{depth:{default:1,min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(e){this.geometry=new i.BoxGeometry(e.width,e.height,e.depth,e.segmentsWidth,e.segmentsHeight,e.segmentsDepth)}})},878:function(e,t,n){var r=n(54).registerGeometry,i=n(19),a=i.Math.degToRad;r("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){this.geometry=new i.CircleGeometry(e.radius,e.segments,a(e.thetaStart),a(e.thetaLength))}})},879:function(e,t,n){var r=n(54).registerGeometry,i=n(19),a=i.Math.degToRad;r("cone",{schema:{height:{default:1,min:0},openEnded:{default:!1},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){this.geometry=new i.CylinderGeometry(e.radiusTop,e.radiusBottom,e.height,e.segmentsRadial,e.segmentsHeight,e.openEnded,a(e.thetaStart),a(e.thetaLength))}})},88:function(e,t,n){var r=n(22),i=n(195),a=n(24),o=i.parseProperties,s=i.parseProperty,c=i.process,l=i.isSingleProperty,u=a.styleParser,h=e.exports.systems={},d=e.exports.System=function(e){var t=r&&r.components[this.name];this.el=e,this.sceneEl=e,t&&(t.Component.prototype.system=this),this.buildData(),this.init(),this.update({})};d.prototype={schema:{},init:function(){},update:function(e){},updateProperties:function(e){var t=this.data;Object.keys(i).length&&(this.buildData(e),this.update(t))},buildData:function(e){var t=this.schema;Object.keys(t).length&&(e=e||window.HTMLElement.prototype.getAttribute.call(this.sceneEl,this.name),l(t)?this.data=s(e,t):this.data=o(u.parse(e)||{},t))},tick:void 0,tock:void 0,play:function(){},pause:function(){}},e.exports.registerSystem=function(e,t){var n,r,i={},o=a.findAllScenes(document);if(Object.keys(t).forEach((function(e){i[e]={value:t[e],writable:!0}})),h[e])throw new Error("The system `"+e+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");for(((r=function(e){d.call(this,e)}).prototype=Object.create(d.prototype,i)).name=e,r.prototype.constructor=r,r.prototype.schema=a.extend(c(r.prototype.schema)),h[e]=r,n=0;n<o.length;n++)o[n].initSystem(e)}},880:function(e,t,n){var r=n(54).registerGeometry,i=n(19),a=i.Math.degToRad;r("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:!1},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){this.geometry=new i.CylinderGeometry(e.radius,e.radius,e.height,e.segmentsRadial,e.segmentsHeight,e.openEnded,a(e.thetaStart),a(e.thetaLength))}})},881:function(e,t,n){var r=n(54).registerGeometry,i=n(19);r("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){this.geometry=new i.DodecahedronGeometry(e.radius,e.detail)}})},882:function(e,t,n){var r=n(54).registerGeometry,i=n(19);r("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){this.geometry=new i.IcosahedronGeometry(e.radius,e.detail)}})},883:function(e,t,n){var r=n(54).registerGeometry,i=n(19);r("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){this.geometry=new i.OctahedronGeometry(e.radius,e.detail)}})},884:function(e,t,n){var r=n(54).registerGeometry,i=n(19);r("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(e){this.geometry=new i.PlaneGeometry(e.width,e.height,e.segmentsWidth,e.segmentsHeight)}})},885:function(e,t,n){var r=n(54).registerGeometry,i=n(19),a=i.Math.degToRad;r("ring",{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){this.geometry=new i.RingGeometry(e.radiusInner,e.radiusOuter,e.segmentsTheta,e.segmentsPhi,a(e.thetaStart),a(e.thetaLength))}})},886:function(e,t,n){var r=n(54).registerGeometry,i=n(19),a=i.Math.degToRad;r("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(e){this.geometry=new i.SphereGeometry(e.radius,e.segmentsWidth,e.segmentsHeight,a(e.phiStart),a(e.phiLength),a(e.thetaStart),a(e.thetaLength))}})},887:function(e,t,n){var r=n(54).registerGeometry,i=n(19);r("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){this.geometry=new i.TetrahedronGeometry(e.radius,e.detail)}})},888:function(e,t,n){var r=n(54).registerGeometry,i=n(19),a=i.Math.degToRad;r("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(e){this.geometry=new i.TorusGeometry(e.radius,2*e.radiusTubular,e.segmentsRadial,e.segmentsTubular,a(e.arc))}})},889:function(e,t,n){var r=n(54).registerGeometry,i=n(19);r("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(e){this.geometry=new i.TorusKnotGeometry(e.radius,2*e.radiusTubular,e.segmentsTubular,e.segmentsRadial,e.p,e.q)}})},89:function(e,t,n){var r=n(195).process,i=e.exports.shaders={},a=e.exports.shaderNames=[],o=n(19),s=n(24),c={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"},l=e.exports.Shader=function(){};l.prototype={schema:{},vertexShader:"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}",init:function(e){return this.attributes=this.initVariables(e,"attribute"),this.uniforms=this.initVariables(e,"uniform"),this.material=new(this.raw?o.RawShaderMaterial:o.ShaderMaterial)({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader}),this.material},initVariables:function(e,t){var n,r,i=this.schema,a={};for(n in i)i[n].is===t&&(r=c[i[n].type],a[n]={type:r,value:void 0});return a},update:function(e){this.updateVariables(e,"attribute"),this.updateVariables(e,"uniform")},updateVariables:function(e,t){var n,r,i,a=this.schema;for(n in i="uniform"===t?this.uniforms:this.attributes,e)if(a[n]&&a[n].is===t)if("map"!==a[n].type)i[n].value=this.parseValue(a[n].type,e[n]),i[n].needsUpdate=!0;else{if(!i[n]||i[n].value===e[n])continue;r="_texture_"+n,this.setMapOnTextureLoad(i,n,r),s.material.updateMapMaterialFromData(r,n,this,e)}},parseValue:function(e,t){var n;switch(e){case"vec2":return new o.Vector2(t.x,t.y);case"vec3":return new o.Vector3(t.x,t.y,t.z);case"vec4":return new o.Vector4(t.x,t.y,t.z,t.w);case"color":return n=new o.Color(t),new o.Vector3(n.r,n.g,n.b);case"map":return o.ImageUtils.loadTexture(t);default:return t}},setMapOnTextureLoad:function(e,t,n){var r=this;this.el.addEventListener("materialtextureloaded",(function(){e[t].value=r.material[n],e[t].needsUpdate=!0}))}},e.exports.registerShader=function(e,t){var n,o={};if(Object.keys(t).forEach((function(e){o[e]={value:t[e],writable:!0}})),i[e])throw new Error("The shader "+e+" has been already registered");return((n=function(){l.call(this)}).prototype=Object.create(l.prototype,o)).name=e,n.prototype.constructor=n,i[e]={Shader:n,schema:r(n.prototype.schema)},a.push(e),n}},890:function(e,t,n){var r=n(54).registerGeometry,i=n(19),a=new i.Quaternion,o=new i.Vector3(0,0,1),s=new i.Vector2,c=new i.Vector2,l=new i.Vector2;r("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(e){var t,n,r,u,h,d;(r=new i.Triangle).a.set(e.vertexA.x,e.vertexA.y,e.vertexA.z),r.b.set(e.vertexB.x,e.vertexB.y,e.vertexB.z),r.c.set(e.vertexC.x,e.vertexC.y,e.vertexC.z),n=r.getNormal(new i.Vector3),a.setFromUnitVectors(n,o),u=r.a.clone().applyQuaternion(a),h=r.b.clone().applyQuaternion(a),d=r.c.clone().applyQuaternion(a),s.set(Math.min(u.x,h.x,d.x),Math.min(u.y,h.y,d.y)),c.set(Math.max(u.x,h.x,d.x),Math.max(u.y,h.y,d.y)),l.set(0,0).subVectors(c,s),u=(new i.Vector2).subVectors(u,s).divide(l),h=(new i.Vector2).subVectors(h,s).divide(l),d=(new i.Vector2).subVectors(d,s).divide(l),(t=this.geometry=new i.Geometry).vertices.push(r.a),t.vertices.push(r.b),t.vertices.push(r.c),t.faces.push(new i.Face3(0,1,2,n)),t.faceVertexUvs[0]=[[u,h,d]]}})},891:function(e,t,n){n(892),n(893),n(894),n(895),n(896)},892:function(e,t,n){var r=n(89).registerShader,i=n(19),a=n(24);function o(e,t){return t.color.set(e.color),t.fog=e.fog,t.wireframe=e.wireframe,t.wireframeLinewidth=e.wireframeLinewidth,t}e.exports.Shader=r("flat",{schema:{color:{type:"color"},fog:{default:!0},height:{default:256},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(e){this.rendererSystem=this.el.sceneEl.systems.renderer,this.materialData={color:new i.Color},this.textureSrc=null,o(e,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.material=new i.MeshBasicMaterial(this.materialData),a.material.updateMap(this,e)},update:function(e){this.updateMaterial(e),a.material.updateMap(this,e)},updateMaterial:function(e){var t;for(t in o(e,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.materialData)this.material[t]=this.materialData[t]}})},893:function(e,t,n){var r=n(89).registerShader,i=n(19),a=n(24),o=new i.CubeTextureLoader,s={};function c(e,t){return t.color.set(e.color),t.emissive.set(e.emissive),t.emissiveIntensity=e.emissiveIntensity,t.fog=e.fog,t.metalness=e.metalness,t.roughness=e.roughness,t.wireframe=e.wireframe,t.wireframeLinewidth=e.wireframeLinewidth,e.normalMap&&(t.normalScale=e.normalScale),e.ambientOcclusionMap&&(t.aoMapIntensity=e.ambientOcclusionMapIntensity),e.displacementMap&&(t.displacementScale=e.displacementScale,t.displacementBias=e.displacementBias),t}e.exports.Shader=r("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:!0},height:{default:256},metalness:{default:0,min:0,max:1},metalnessMap:{type:"map"},metalnessTextureOffset:{type:"vec2"},metalnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},roughnessMap:{type:"map"},roughnessTextureOffset:{type:"vec2"},roughnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},sphericalEnvMap:{type:"map"},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(e){this.rendererSystem=this.el.sceneEl.systems.renderer,this.materialData={color:new i.Color,emissive:new i.Color},c(e,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.rendererSystem.applyColorCorrection(this.materialData.emissive),this.material=new i.MeshStandardMaterial(this.materialData),a.material.updateMap(this,e),e.normalMap&&a.material.updateDistortionMap("normal",this,e),e.displacementMap&&a.material.updateDistortionMap("displacement",this,e),e.ambientOcclusionMap&&a.material.updateDistortionMap("ambientOcclusion",this,e),e.metalnessMap&&a.material.updateDistortionMap("metalness",this,e),e.roughnessMap&&a.material.updateDistortionMap("roughness",this,e),this.updateEnvMap(e)},update:function(e){this.updateMaterial(e),a.material.updateMap(this,e),e.normalMap&&a.material.updateDistortionMap("normal",this,e),e.displacementMap&&a.material.updateDistortionMap("displacement",this,e),e.ambientOcclusionMap&&a.material.updateDistortionMap("ambientOcclusion",this,e),e.metalnessMap&&a.material.updateDistortionMap("metalness",this,e),e.roughnessMap&&a.material.updateDistortionMap("roughness",this,e),this.updateEnvMap(e)},updateMaterial:function(e){var t,n=this.material;for(t in c(e,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.rendererSystem.applyColorCorrection(this.materialData.emissive),this.materialData)n[t]=this.materialData[t]},updateEnvMap:function(e){var t=this,n=this.material,r=e.envMap,c=e.sphericalEnvMap;if(!r&&!c||this.isLoadingEnvMap)return n.envMap=null,void(n.needsUpdate=!0);this.isLoadingEnvMap=!0,c?this.el.sceneEl.systems.material.loadTexture(c,{src:c},(function(e){t.isLoadingEnvMap=!1,e.mapping=i.SphericalReflectionMapping,n.envMap=e,a.material.handleTextureEvents(t.el,e),n.needsUpdate=!0})):s[r]?s[r].then((function(e){t.isLoadingEnvMap=!1,n.envMap=e,a.material.handleTextureEvents(t.el,e),n.needsUpdate=!0})):s[r]=new Promise((function(e){a.srcLoader.validateCubemapSrc(r,(function(r){o.load(r,(function(r){t.isLoadingEnvMap=!1,n.envMap=r,a.material.handleTextureEvents(t.el,r),e(r)}))}))}))}})},894:function(e,t,n){var r=n(89).registerShader;e.exports.Shader=r("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:["#ifdef AFRAME_enable_multiview","  #extension GL_OVR_multiview : require","  layout(num_views = 2) in;","#endif","attribute vec2 uv;","attribute vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","#ifdef AFRAME_enable_multiview","  uniform mat4 modelViewMatrix2;","  uniform mat4 projectionMatrix2;","  #define modelViewMatrix (gl_ViewID_OVR==0u?modelViewMatrix:modelViewMatrix2)","  #define projectionMatrix (gl_ViewID_OVR==0u?projectionMatrix:projectionMatrix2)","#endif","varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join("\n"),fragmentShader:["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives: enable","#endif","precision highp float;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","#ifdef GL_OES_standard_derivatives","  float contour(float width, float value) {","    return smoothstep(0.5 - value, 0.5 + value, width);","  }","#else","  float aastep(float value, float afwidth) {","    return smoothstep(0.5 - afwidth, 0.5 + afwidth, value);","  }","#endif","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","#define ALL_SMOOTH 0.4","#define ALL_ROUGH 0.02","#define DISCARD_ALPHA (alphaTest / (2.2 - 1.2 * ratio))","void main() {","  #ifdef GL_OES_standard_derivatives","    vec2 uv = vUV;","    vec4 texColor = texture2D(map, uv);","    float dist = texColor.a;","    float width = fwidth(dist);","    float alpha = contour(dist, width);","    float dscale = 0.353505;","    vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","    float isBigEnough = max(abs(duv.x), abs(duv.y));","    if (isBigEnough <= BIG_ENOUGH) {","      vec4 box = vec4 (uv - duv, uv + duv);","      alpha = (alpha + 0.5 * (","        contour(texture2D(map, box.xy).a, width)","        + contour(texture2D(map, box.zw).a, width)","        + contour(texture2D(map, box.xw).a, width)","        + contour(texture2D(map, box.zy).a, width)","      )) / 3.0;","    }","    if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  #else","    vec4 texColor = texture2D(map, vUV);","    float value = texColor.a;","    float afwidth = (1.0 / 32.0) * (1.4142135623730951 / (2.0 * gl_FragCoord.w));","    float alpha = aastep(value, afwidth);","    float ratio = (gl_FragCoord.w >= ALL_SMOOTH) ? 1.0 : (gl_FragCoord.w < ALL_ROUGH) ? 0.0 : (gl_FragCoord.w - ALL_ROUGH) / (ALL_SMOOTH - ALL_ROUGH);","    if (alpha < alphaTest) { if (ratio >= 1.0) { discard; return; } alpha = 0.0; }","    alpha = alpha * ratio + (1.0 - ratio) * value;","    if (ratio < 1.0 && alpha <= DISCARD_ALPHA) { discard; return; }","  #endif","  gl_FragColor = vec4(color, opacity * alpha);","}"].join("\n")})},895:function(e,t,n){var r=n(89).registerShader;e.exports.Shader=r("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},negate:{type:"boolean",is:"uniform",default:!0},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:["#ifdef AFRAME_enable_multiview","  #extension GL_OVR_multiview : require","  layout(num_views = 2) in;","#endif","attribute vec2 uv;","attribute vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","#ifdef AFRAME_enable_multiview","  uniform mat4 modelViewMatrix2;","  uniform mat4 projectionMatrix2;","  #define modelViewMatrix (gl_ViewID_OVR==0u?modelViewMatrix:modelViewMatrix2)","  #define projectionMatrix (gl_ViewID_OVR==0u?projectionMatrix:projectionMatrix2)","#endif","varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join("\n"),fragmentShader:["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives: enable","#endif","precision highp float;","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 tSample = texture2D(map, vUV).rgb;","  if (negate) { tSample = 1.0 - tSample; }","  float sigDist = median(tSample.r, tSample.g, tSample.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color.xyz, alpha * opacity);","}"].join("\n")})},896:function(e,t,n){var r=n(89).registerShader;e.exports.Shader=r("ios10hls",{schema:{src:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:["varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join("\n"),fragmentShader:["uniform sampler2D src;","uniform float opacity;","varying vec2 vUV;","void main() {","  vec2 offset = vec2(0, 0);","  vec2 repeat = vec2(1, 1);","  vec4 color = texture2D(src, vec2(vUV.x / repeat.x + offset.x, (1.0 - vUV.y) / repeat.y + offset.y)).bgra;","  gl_FragColor = vec4(color.rgb, opacity);","}"].join("\n")})},897:function(e,t,n){n(898),n(899),n(900),n(901),n(902),n(903),n(904)},898:function(e,t,n){var r=n(152),i=n(88).registerSystem;e.exports.System=i("camera",{init:function(){this.activeCameraEl=null,this.render=this.render.bind(this),this.unwrapRender=this.unwrapRender.bind(this),this.wrapRender=this.wrapRender.bind(this),this.initialCameraFound=!1,this.numUserCameras=0,this.numUserCamerasChecked=0,this.setupInitialCamera()},setupInitialCamera:function(){var e,t,n=this.sceneEl,r=this;if(!n.camera||n.camera.el.getAttribute("camera").spectator)if((e=n.querySelectorAll("a-camera, [camera]")).length)for(this.numUserCameras=e.length,t=0;t<e.length;t++)e[t].addEventListener("object3dset",(function(e){"camera"===e.detail.type&&r.checkUserCamera(this)})),e[t].isNode?e[t].load():e[t].addEventListener("nodeready",(function(){this.load()}));else this.createDefaultCamera();else n.emit("cameraready",{cameraEl:n.camera.el})},checkUserCamera:function(e){var t,n=this.el.sceneEl;this.numUserCamerasChecked++,this.initialCameraFound||((t=e.getAttribute("camera")).active&&!t.spectator?(this.initialCameraFound=!0,n.camera=e.getObject3D("camera"),n.emit("cameraready",{cameraEl:e})):this.numUserCamerasChecked===this.numUserCameras&&this.createDefaultCamera())},createDefaultCamera:function(){var e,t=this.sceneEl;(e=document.createElement("a-entity")).setAttribute("camera",{active:!0}),e.setAttribute("position",{x:0,y:r.DEFAULT_CAMERA_HEIGHT,z:0}),e.setAttribute("wasd-controls",""),e.setAttribute("look-controls",""),e.setAttribute(r.AFRAME_INJECTED,""),e.addEventListener("object3dset",(function(n){"camera"===n.detail.type&&(t.camera=n.detail.object,t.emit("cameraready",{cameraEl:e}))})),t.appendChild(e)},disableActiveCamera:function(){var e;(e=this.sceneEl.querySelectorAll("[camera]"))[e.length-1].setAttribute("camera","active",!0)},setActiveCamera:function(e){var t,n,r,i,a=this.activeCameraEl,o=this.sceneEl;if((i=e.getObject3D("camera"))&&e!==this.activeCameraEl){var s=o.querySelector("[data-aframe-default-camera]");for(e!==(s&&s.querySelector("[camera]"))&&function(e){var t;if(!e.camera)return;if(!(t=e.querySelector("[data-aframe-default-camera]")))return;e.removeChild(t)}(o),this.activeCameraEl=e,this.activeCameraEl.play(),o.camera=i,a&&a.setAttribute("camera","active",!1),n=o.querySelectorAll("[camera]"),r=0;r<n.length;r++)(t=n[r]).isEntity&&e!==t&&(t.setAttribute("camera","active",!1),t.pause());o.emit("camera-set-active",{cameraEl:e})}},setSpectatorCamera:function(e){var t,n=this.spectatorCameraEl,r=this.sceneEl;e.getObject3D("camera")&&e!==this.spectatorCameraEl&&(n&&n.setAttribute("camera","spectator",!1),t=this.spectatorCameraEl=e,r.addEventListener("enter-vr",this.wrapRender),r.addEventListener("exit-vr",this.unwrapRender),t.setAttribute("camera","active",!1),t.play(),r.emit("camera-set-spectator",{cameraEl:e}))},disableSpectatorCamera:function(){this.spectatorCameraEl=void 0},wrapRender:function(){this.spectatorCameraEl&&(this.originalRender=this.sceneEl.renderer.render,this.sceneEl.renderer.render=this.render)},unwrapRender:function(){this.originalRender&&(this.sceneEl.renderer.render=this.originalRender,this.originalRender=void 0)},render:function(e,t){var n,r,i=this.sceneEl;n=i.renderer.vr.enabled,this.originalRender.call(i.renderer,e,t),this.spectatorCameraEl&&!i.isMobile&&n&&(r=this.spectatorCameraEl.components.camera.camera,i.renderer.vr.enabled=!1,this.originalRender.call(i.renderer,e,r),i.renderer.vr.enabled=n)}})},899:function(e,t,n){var r=n(54).geometries,i=n(88).registerSystem,a=n(19);function o(e){var t=e.primitive,n=r[t]&&r[t].Geometry,i=new n;if(!n)throw new Error("Unknown geometry `"+t+"`");return i.init(e),function(e,t){var n;if(!t)return e;return(n=(new a.BufferGeometry).fromGeometry(e)).metadata={type:e.type,parameters:e.parameters||{}},e.dispose(),n}(i.geometry,e.buffer)}e.exports.System=i("geometry",{init:function(){this.cache={},this.cacheCount={}},clearCache:function(){this.cache={},this.cacheCount={}},getOrCreateGeometry:function(e){var t,n,r=this.cache;return e.skipCache?o(e):(t=r[n=this.hash(e)],function(e,t){e[t]=void 0===e[t]?1:e[t]+1}(this.cacheCount,n),t||(t=o(e),r[n]=t,t))},unuseGeometry:function(e){var t,n=this.cache,r=this.cacheCount;e.skipCache||n[t=this.hash(e)]&&(!function(e,t){e[t]--}(r,t),r[t]>0||(n[t].dispose(),delete n[t],delete r[t]))},hash:function(e){return JSON.stringify(e)}})},900:function(e,t,n){var r=n(88).registerSystem,i=n(19);e.exports.System=r("gltf-model",{schema:{dracoDecoderPath:{default:""}},init:function(){var e=this.data.dracoDecoderPath;i.DRACOLoader.setDecoderPath(e),this.dracoLoader=e?new i.DRACOLoader:null},getDRACOLoader:function(){return this.dracoLoader}})},901:function(e,t,n){var r=n(88).registerSystem,i=n(170),a=n(152);e.exports.System=r("light",{schema:{defaultLightsEnabled:{default:!0}},init:function(){this.defaultLights=!1,this.userDefinedLights=!1,this.sceneEl.addEventListener("loaded",i(this.setupDefaultLights,this))},registerLight:function(e){e.hasAttribute("data-aframe-default-light")||(this.removeDefaultLights(),this.userDefinedLights=!0)},removeDefaultLights:function(){var e,t=this.sceneEl;if(this.defaultLights){e=document.querySelectorAll("[data-aframe-default-light]");for(var n=0;n<e.length;n++)t.removeChild(e[n]);this.defaultLights=!1}},setupDefaultLights:function(){var e,t,n=this.sceneEl;this.userDefinedLights||this.defaultLights||!this.data.defaultLightsEnabled||((e=document.createElement("a-entity")).setAttribute("light",{color:"#BBB",type:"ambient"}),e.setAttribute("data-aframe-default-light",""),e.setAttribute(a.AFRAME_INJECTED,""),n.appendChild(e),(t=document.createElement("a-entity")).setAttribute("light",{color:"#FFF",intensity:.6,castShadow:!0}),t.setAttribute("position",{x:-.5,y:1,z:1}),t.setAttribute("data-aframe-default-light",""),t.setAttribute(a.AFRAME_INJECTED,""),n.appendChild(t),this.defaultLights=!0)}})},902:function(e,t,n){var r=n(88).registerSystem,i=n(19),a=n(24),o=n(362).isHLS,s=a.bind,c=a.debug,l=c("components:texture:error"),u=new i.TextureLoader,h=c("components:texture:warn");function d(e,t){var n=t.offset||{x:0,y:0},r=t.repeat||{x:1,y:1};(t.npot||!1)&&(e.wrapS=i.ClampToEdgeWrapping,e.wrapT=i.ClampToEdgeWrapping,e.magFilter=i.LinearFilter,e.minFilter=i.LinearFilter),1===r.x&&1===r.y||(e.wrapS=i.RepeatWrapping,e.wrapT=i.RepeatWrapping,e.repeat.set(r.x,r.y)),0===n.x&&0===n.y||e.offset.set(n.x,n.y)}u.setCrossOrigin("anonymous"),e.exports.System=r("material",{init:function(){this.materials={},this.textureCounts={},this.textureCache={},this.sceneEl.addEventListener("materialtextureloaded",s(this.onMaterialTextureLoaded,this))},clearTextureCache:function(){this.textureCache={}},loadTexture:function(e,t,n){var r=this;if("CANVAS"!==e.tagName){if("VIDEO"===e.tagName)return e.src||e.srcObject||e.childElementCount||h("Video element was defined with neither `source` elements nor `src` / `srcObject` attributes."),void this.loadVideo(e,t,n);a.srcLoader.validateSrc(e,(function(e){r.loadImage(e,t,n)}),(function(e){r.loadVideo(e,t,n)}))}else this.loadCanvas(e,t,n)},loadImage:function(e,t,n){var r=this.hash(t),a=this.textureCache;a[r]?a[r].then(n):(a[r]=function(e,t){return new Promise((function(n,r){function a(e){d(e,t),e.needsUpdate=!0,n(e)}if("string"!=typeof e)return void a(new i.Texture(e));u.load(e,a,(function(){}),(function(e){l("`$s` could not be fetched (Error code: %s; Response: %s)",e.status,e.statusText)}))}))}(e,t),a[r].then(n))},loadCanvas:function(e,t,n){var r;d(r=new i.CanvasTexture(e),t),n(r)},loadVideo:function(e,t,n){var r,a,s,c,l=this.textureCache;function u(e){e.texture.needsUpdate=!0,n(e.texture,e.videoEl)}if("string"!=typeof e){if(s=e,l[r=this.hashVideo(t,s)])return void l[r].then(u);!function(e){e.autoplay=e.hasAttribute("autoplay")&&"false"!==e.getAttribute("autoplay"),e.controls=e.hasAttribute("controls")&&"false"!==e.getAttribute("controls"),"false"===e.getAttribute("loop")&&e.removeAttribute("loop");"false"===e.getAttribute("preload")&&(e.preload="none");e.crossOrigin=e.crossOrigin||"anonymous",e.setAttribute("playsinline",""),e.setAttribute("webkit-playsinline","")}(s)}s=s||function(e,t,n){var r=document.createElement("video");return r.width=t,r.height=n,r.setAttribute("playsinline",""),r.setAttribute("webkit-playsinline",""),r.autoplay=!0,r.loop=!0,r.crossOrigin="anonymous",r.addEventListener("error",(function(){h("`$s` is not a valid video",e)}),!0),r.src=e,r}(e,t.width,t.height),l[r=this.hashVideo(t,s)]?l[r].then(u):((a=new i.VideoTexture(s)).minFilter=i.LinearFilter,d(a,t),this.sceneEl.isIOS&&o(s.src||s.getAttribute("src"),s.type||s.getAttribute("type"))&&(a.format=i.RGBAFormat,a.needsCorrectionBGRA=!0,a.flipY=!1,a.needsCorrectionFlipY=!0),c={texture:a,videoEl:s},l[r]=Promise.resolve(c),u(c))},hash:function(e){return e.src.tagName&&((e=a.extendDeep({},e)).src=e.src.src),JSON.stringify(e)},hashVideo:function(e,t){return function(e,t){var n,r,i,a=t.getAttribute("id");if(a)return a;for(r="",i=e||{},n=0;n<t.attributes.length;n++)i[t.attributes[n].name]=t.attributes[n].value;return Object.keys(i).sort().forEach((function(e){r+=e+":"+i[e]+";"})),r}(e,t)},registerMaterial:function(e){this.materials[e.uuid]=e},unregisterMaterial:function(e){delete this.materials[e.uuid];var t=this.textureCounts;Object.keys(e).filter((function(t){return e[t]&&e[t].isTexture})).forEach((function(n){t[e[n].uuid]--,t[e[n].uuid]<=0&&e[n].dispose()}))},updateMaterials:function(e){var t=this.materials;Object.keys(t).forEach((function(e){t[e].needsUpdate=!0}))},onMaterialTextureLoaded:function(e){this.textureCounts[e.detail.texture.uuid]||(this.textureCounts[e.detail.texture.uuid]=0),this.textureCounts[e.detail.texture.uuid]++}})},903:function(e,t,n){var r=n(88).registerSystem,i=n(24),a=n(19),o=(0,i.debug)("components:renderer:warn");e.exports.System=r("renderer",{schema:{antialias:{default:"auto",oneOf:["true","false","auto"]},highRefreshRate:{default:!1},logarithmicDepthBuffer:{default:"auto",oneOf:["true","false","auto"]},maxCanvasWidth:{default:1920},maxCanvasHeight:{default:1920},physicallyCorrectLights:{default:!1},precision:{default:"high",oneOf:["high","medium","low"]},sortObjects:{default:!1},colorManagement:{default:!1},gammaOutput:{default:!1},alpha:{default:!0},webgl2:{default:!1},multiview:{default:!1},forceWebVR:{default:!1}},init:function(){var e=this.data,t=this.el,n=t.renderer;n.sortObjects=e.sortObjects,n.physicallyCorrectLights=e.physicallyCorrectLights,t.highRefreshRate=e.highRefreshRate,(e.colorManagement||e.gammaOutput)&&(n.gammaOutput=!0,n.gammaFactor=2.2,e.gammaOutput&&o('Property `gammaOutput` is deprecated. Use `renderer="colorManagement: true;"` instead.')),t.hasAttribute("antialias")&&o('Component `antialias` is deprecated. Use `renderer="antialias: true"` instead.'),t.hasAttribute("logarithmicDepthBuffer")&&o('Component `logarithmicDepthBuffer` is deprecated. Use `renderer="logarithmicDepthBuffer: true"` instead.')},applyColorCorrection:function(e){this.data.colorManagement&&e&&(e.isColor?e.convertSRGBToLinear():e.isTexture&&(e.encoding=a.sRGBEncoding))}})},904:function(e,t,n){var r=n(88).registerSystem,i=n(19),a={basic:i.BasicShadowMap,pcf:i.PCFShadowMap,pcfsoft:i.PCFSoftShadowMap};e.exports.System=r("shadow",{schema:{enabled:{default:!0},autoUpdate:{default:!0},type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]}},init:function(){var e=this.sceneEl,t=this.data;this.shadowMapEnabled=!1,e.renderer&&(e.renderer.shadowMap.type=a[t.type],e.renderer.shadowMap.autoUpdate=t.autoUpdate,this.setShadowMapEnabled(this.shadowMapEnabled))},update:function(e){e.enabled!==this.data.enabled&&this.setShadowMapEnabled(this.data.enabled)},setShadowMapEnabled:function(e){var t=this.sceneEl.renderer;this.shadowMapEnabled=this.data.enabled&&e,t&&(t.shadowMap.enabled=this.shadowMapEnabled)}})},905:function(e,t,n){var r=n(171),i=n(170),a=n(99),o=n(113).registerElement,s=n(19),c=new s.FileLoader,l=a("core:a-assets:warn");function u(e){if(e.hasAttribute("autoplay")||"auto"===e.getAttribute("preload"))return new Promise((function(t,n){if(4===e.readyState)return t();if(e.error)return n();function r(){for(var n=0,r=0;r<e.buffered.length;r++)n+=e.buffered.end(r)-e.buffered.start(r);n>=e.duration&&("VIDEO"===e.tagName&&(s.Cache.files[e.getAttribute("src")]=e),t())}e.addEventListener("loadeddata",r,!1),e.addEventListener("progress",r,!1),e.addEventListener("error",n,!1)}))}function h(e){var t=function(e){var t;if(e.hasAttribute("crossorigin"))return e;if(null!==(t=e.getAttribute("src"))){if(-1===t.indexOf("://"))return e;if((r=(n=t).indexOf("://")>-1?n.split("/")[2]:n.split("/")[0]).substring(0,r.indexOf(":"))===window.location.host)return e}var n,r;return l('Cross-origin element (e.g., <img>) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., <img crossorigin="anonymous">)',t),e.crossOrigin="anonymous",e.cloneNode(!0)}(e);return t.tagName&&"video"===t.tagName.toLowerCase()&&(t.setAttribute("playsinline",""),t.setAttribute("webkit-playsinline","")),t!==e&&(e.parentNode.appendChild(t),e.parentNode.removeChild(e)),t}function d(e){var t=e.lastIndexOf(".");if(t>=0){var n=e.slice(t,e.length);if(".gltf"===n||".glb"===n)return"arraybuffer"}return"text"}e.exports=o("a-assets",{prototype:Object.create(r.prototype,{createdCallback:{value:function(){this.isAssets=!0,this.fileLoader=c,this.timeout=null}},attachedCallback:{value:function(){var e,t,n,r,a,o,c=this,d=[];if(!this.parentNode.isScene)throw new Error("<a-assets> must be a child of a <a-scene>.");for(a=this.querySelectorAll("img"),e=0;e<a.length;e++)r=h(a[e]),d.push(new Promise((function(t,n){s.Cache.files[a[e].getAttribute("src")]=r,r.onload=t,r.onerror=n})));for(n=this.querySelectorAll("audio, video"),e=0;e<n.length;e++)(t=h(n[e])).src||t.srcObject||l("Audio/video asset has neither `src` nor `srcObject` attributes."),d.push(u(t));Promise.all(d).then(i(this.load,this)),o=parseInt(this.getAttribute("timeout"),10)||3e3,this.timeout=setTimeout((function(){c.hasLoaded||(l("Asset loading timed out in ",o,"ms"),c.emit("timeout"),c.load())}),o)}},detachedCallback:{value:function(){this.timeout&&clearTimeout(this.timeout)}},load:{value:function(){r.prototype.load.call(this,null,(function(e){return e.isAssetItem&&e.hasAttribute("src")}))}}})}),o("a-asset-item",{prototype:Object.create(r.prototype,{createdCallback:{value:function(){this.data=null,this.isAssetItem=!0}},attachedCallback:{value:function(){var e=this,t=this.getAttribute("src");c.setResponseType(this.getAttribute("response-type")||d(t)),c.load(t,(function(t){e.data=t,setTimeout((function(){r.prototype.load.call(e)}))}),(function(t){e.emit("progress",{loadedBytes:t.loaded,totalBytes:t.total,xhr:t})}),(function(t){e.emit("error",{xhr:t})}))}}})}),e.exports.inferResponseType=d},906:function(e,t,n){var r=n(99),i=n(113).registerElement,a=r("core:cubemap:warn");e.exports=i("a-cubemap",{prototype:Object.create(window.HTMLElement.prototype,{attachedCallback:{value:function(){this.srcs=this.validate()},writable:window.debug},validate:{value:function(){var e,t=this.querySelectorAll("[src]"),n=[];if(6===t.length){for(e=0;e<t.length;e++)n.push(t[e].getAttribute("src"));return n}a("<a-cubemap> did not contain exactly six elements each with a `src` attribute.")},writable:window.debug}})})},907:function(e,t,n){var r=n(171),i=n(113).registerElement,a=n(22).components,o=n(24);e.exports=i("a-mixin",{prototype:Object.create(r.prototype,{createdCallback:{value:function(){this.componentCache={},this.id=this.getAttribute("id"),this.isMixin=!0}},attributeChangedCallback:{value:function(e,t,n){this.cacheAttribute(e,n),this.updateEntities()}},attachedCallback:{value:function(){this.sceneEl=this.closestScene(),this.cacheAttributes(),this.updateEntities(),this.load()}},setAttribute:{value:function(e,t){window.HTMLElement.prototype.setAttribute.call(this,e,t),this.cacheAttribute(e,t)}},cacheAttribute:{value:function(e,t){var n,r;r=o.split(e,"__")[0],(n=a[r])&&(void 0===t&&(t=window.HTMLElement.prototype.getAttribute.call(this,e)),this.componentCache[e]=n.parseAttrValueForCache(t))}},getAttribute:{value:function(e){return this.componentCache[e]||window.HTMLElement.prototype.getAttribute.call(this,e)}},cacheAttributes:{value:function(){var e,t,n=this.attributes;for(t=0;t<n.length;t++)e=n[t].name,this.cacheAttribute(e)}},updateEntities:{value:function(){var e,t,n;if(this.sceneEl)for(t=this.sceneEl.querySelectorAll("[mixin~="+this.id+"]"),n=0;n<t.length;n++)(e=t[n]).hasLoaded&&!e.isMixin&&e.mixinUpdate(this.id)}}})})},908:function(e,t,n){n(909)},909:function(e,t,n){var r=n(22).registerComponent,i=n(19),a=new i.Vector3,o=new i.Vector3;r("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var e=this.data,t=this.el,n=t.object3D.parent,r=t.object3D,s=new i.Group;a.copy(r.position),o.copy(r.rotation),n.remove(r),s.add(r),n.add(s),t.object3D=s,r.position.set(-1*e.x,-1*e.y,-1*e.z),s.position.set(e.x+a.x,e.y+a.y,e.z+a.z),s.rotation.copy(r.rotation),r.rotation.set(0,0,0)}})},910:function(e,t,n){n(911),n(912),n(913),n(914),n(915),n(916),n(917),n(918),n(919),n(920),n(921),n(922),n(363)},911:function(e,t,n){(0,n(67).registerPrimitive)("a-camera",{defaultComponents:{camera:{},"look-controls":{},"wasd-controls":{},position:{x:0,y:1.6,z:0}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","pointer-lock-enabled":"look-controls.pointerLockEnabled","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag",zoom:"camera.zoom"}})},912:function(e,t,n){var r=n(114);(0,n(67).registerPrimitive)("a-cursor",n(24).extendDeep({},r(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",interval:"raycaster.interval",objects:"raycaster.objects"}}))},913:function(e,t,n){var r=n(114);(0,n(67).registerPrimitive)("a-curvedimage",n(24).extendDeep({},r(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:!0,thetaStart:0},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},914:function(e,t,n){(0,n(67).registerPrimitive)("a-gltf-model",{mappings:{src:"gltf-model"}})},915:function(e,t,n){var r=n(114);(0,n(67).registerPrimitive)("a-image",n(24).extendDeep({},r(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},916:function(e,t,n){(0,n(67).registerPrimitive)("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target"}})},917:function(e,t,n){(0,n(67).registerPrimitive)("a-link",{defaultComponents:{link:{visualAspectEnabled:!0}},mappings:{href:"link.href",image:"link.image",title:"link.title"}})},918:function(e,t,n){var r=n(114)();(0,n(67).registerPrimitive)("a-obj-model",n(24).extendDeep({},r,{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},919:function(e,t,n){var r=n(114),i=n(67).registerPrimitive,a=n(24),o=n(363);i("a-sky",a.extendDeep({},r(),{defaultComponents:{geometry:{primitive:"sphere",radius:5e3,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",side:"back",shader:"flat",npot:!0},scale:"-1 1 1"},mappings:a.extendDeep({},o["a-sphere"].prototype.mappings)}))},920:function(e,t,n){(0,n(67).registerPrimitive)("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},921:function(e,t,n){var r=n(114);(0,n(67).registerPrimitive)("a-video",n(24).extendDeep({},r(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},922:function(e,t,n){var r=n(114);(0,n(67).registerPrimitive)("a-videosphere",n(24).extendDeep({},r(),{defaultComponents:{geometry:{primitive:"sphere",radius:5e3,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",side:"back",npot:!0},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},923:function(e,t,n){"use strict";n.r(t);var r={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},i={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},a=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"],o={CSS:{},springs:{}};function s(e,t,n){return Math.min(Math.max(e,t),n)}function c(e,t){return e.indexOf(t)>-1}function l(e,t){return e.apply(null,t)}var u={arr:function(e){return Array.isArray(e)},obj:function(e){return c(Object.prototype.toString.call(e),"Object")},pth:function(e){return u.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return e.nodeType||u.svg(e)},str:function(e){return"string"==typeof e},fnc:function(e){return"function"==typeof e},und:function(e){return void 0===e},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return u.hex(e)||u.rgb(e)||u.hsl(e)},key:function(e){return!r.hasOwnProperty(e)&&!i.hasOwnProperty(e)&&"targets"!==e&&"keyframes"!==e}};function h(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map((function(e){return parseFloat(e)})):[]}function d(e,t){var n=h(e),r=s(u.und(n[0])?1:n[0],.1,100),i=s(u.und(n[1])?100:n[1],.1,100),a=s(u.und(n[2])?10:n[2],.1,100),c=s(u.und(n[3])?0:n[3],.1,100),l=Math.sqrt(i/r),d=a/(2*Math.sqrt(i*r)),p=d<1?l*Math.sqrt(1-d*d):0,f=d<1?(d*l-c)/p:-c+l;function m(e){var n=t?t*e/1e3:e;return n=d<1?Math.exp(-n*d*l)*(1*Math.cos(p*n)+f*Math.sin(p*n)):(1+f*n)*Math.exp(-n*l),0===e||1===e?e:1-n}return t?m:function(){var t=o.springs[e];if(t)return t;for(var n=0,r=0;;)if(1===m(n+=1/6)){if(++r>=16)break}else r=0;var i=n*(1/6)*1e3;return o.springs[e]=i,i}}function p(e,t){void 0===e&&(e=1),void 0===t&&(t=.5);var n=s(e,1,10),r=s(t,.1,2);return function(e){return 0===e||1===e?e:-n*Math.pow(2,10*(e-1))*Math.sin((e-1-r/(2*Math.PI)*Math.asin(1/n))*(2*Math.PI)/r)}}function f(e){return void 0===e&&(e=10),function(t){return Math.round(t*e)*(1/e)}}var m=function(){function e(e,t){return 1-3*t+3*e}function t(e,t){return 3*t-6*e}function n(e){return 3*e}function r(r,i,a){return((e(i,a)*r+t(i,a))*r+n(i))*r}function i(r,i,a){return 3*e(i,a)*r*r+2*t(i,a)*r+n(i)}return function(e,t,n,a){if(0<=e&&e<=1&&0<=n&&n<=1){var o=new Float32Array(11);if(e!==t||n!==a)for(var s=0;s<11;++s)o[s]=r(.1*s,e,n);return function(i){return e===t&&n===a?i:0===i||1===i?i:r(c(i),t,a)}}function c(t){for(var a=0,s=1;10!==s&&o[s]<=t;++s)a+=.1;--s;var c=a+.1*((t-o[s])/(o[s+1]-o[s])),l=i(c,e,n);return l>=.001?function(e,t,n,a){for(var o=0;o<4;++o){var s=i(t,n,a);if(0===s)return t;t-=(r(t,n,a)-e)/s}return t}(t,c,e,n):0===l?c:function(e,t,n,i,a){var o,s,c=0;do{(o=r(s=t+(n-t)/2,i,a)-e)>0?n=s:t=s}while(Math.abs(o)>1e-7&&++c<10);return s}(t,a,a+.1,e,n)}}}(),g=function(){var e=["Quad","Cubic","Quart","Quint","Sine","Expo","Circ","Back","Elastic"],t={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],p],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(e,t){return function(n){return 1-p(e,t)(1-n)}}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(e,t){return function(n){return n<.5?p(e,t)(2*n)/2:1-p(e,t)(-2*n+2)/2}}]},n={linear:[.25,.25,.75,.75]},r=function(r){t[r].forEach((function(t,i){n["ease"+r+e[i]]=t}))};for(var i in t)r(i);return n}();function v(e,t){if(u.fnc(e))return e;var n=e.split("(")[0],r=g[n],i=h(e);switch(n){case"spring":return d(e,t);case"cubicBezier":return l(m,i);case"steps":return l(f,i);default:return u.fnc(r)?l(r,i):l(m,r)}}function y(e){try{return document.querySelectorAll(e)}catch(e){return}}function b(e,t){for(var n=e.length,r=arguments.length>=2?arguments[1]:void 0,i=[],a=0;a<n;a++)if(a in e){var o=e[a];t.call(r,o,a,e)&&i.push(o)}return i}function x(e){return e.reduce((function(e,t){return e.concat(u.arr(t)?x(t):t)}),[])}function w(e){return u.arr(e)?e:(u.str(e)&&(e=y(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function E(e,t){return e.some((function(e){return e===t}))}function M(e){var t={};for(var n in e)t[n]=e[n];return t}function A(e,t){var n=M(e);for(var r in e)n[r]=t.hasOwnProperty(r)?t[r]:e[r];return n}function T(e,t){var n=M(e);for(var r in t)n[r]=u.und(e[r])?t[r]:e[r];return n}function _(e){return u.rgb(e)?(n=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(t=e))?"rgba("+n[1]+",1)":t:u.hex(e)?function(e){var t=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,r){return t+t+n+n+r+r})),n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return"rgba("+parseInt(n[1],16)+","+parseInt(n[2],16)+","+parseInt(n[3],16)+",1)"}(e):u.hsl(e)?function(e){var t,n,r,i=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),a=parseInt(i[1],10)/360,o=parseInt(i[2],10)/100,s=parseInt(i[3],10)/100,c=i[4]||1;function l(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(0==o)t=n=r=s;else{var u=s<.5?s*(1+o):s+o-s*o,h=2*s-u;t=l(h,u,a+1/3),n=l(h,u,a),r=l(h,u,a-1/3)}return"rgba("+255*t+","+255*n+","+255*r+","+c+")"}(e):void 0;var t,n}function S(e){var t=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[2]}function L(e,t){return u.fnc(e)?e(t.target,t.id,t.total):e}function C(e,t){return e.getAttribute(t)}function R(e,t,n){if(E([n,"deg","rad","turn"],S(t)))return t;var r=o.CSS[t+n];if(!u.und(r))return r;var i=document.createElement(e.tagName),a=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;a.appendChild(i),i.style.position="absolute",i.style.width=100+n;var s=100/i.offsetWidth;a.removeChild(i);var c=s*parseFloat(t);return o.CSS[t+n]=c,c}function P(e,t,n){if(t in e.style){var r=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),i=e.style[t]||getComputedStyle(e).getPropertyValue(r)||"0";return n?R(e,i,n):i}}function O(e,t){return u.dom(e)&&!u.inp(e)&&(C(e,t)||u.svg(e)&&e[t])?"attribute":u.dom(e)&&E(a,t)?"transform":u.dom(e)&&"transform"!==t&&P(e,t)?"css":null!=e[t]?"object":void 0}function D(e){if(u.dom(e)){for(var t,n=e.style.transform||"",r=/(\w+)\(([^)]*)\)/g,i=new Map;t=r.exec(n);)i.set(t[1],t[2]);return i}}function I(e,t,n,r){var i=c(t,"scale")?1:0+function(e){return c(e,"translate")||"perspective"===e?"px":c(e,"rotate")||c(e,"skew")?"deg":void 0}(t),a=D(e).get(t)||i;return n&&(n.transforms.list.set(t,a),n.transforms.last=t),r?R(e,a,r):a}function B(e,t,n,r){switch(O(e,t)){case"transform":return I(e,t,r,n);case"css":return P(e,t,n);case"attribute":return C(e,t);default:return e[t]||0}}function k(e,t){var n=/^(\*=|\+=|-=)/.exec(e);if(!n)return e;var r=S(e)||0,i=parseFloat(t),a=parseFloat(e.replace(n[0],""));switch(n[0][0]){case"+":return i+a+r;case"-":return i-a+r;case"*":return i*a+r}}function H(e,t){if(u.col(e))return _(e);var n=S(e),r=n?e.substr(0,e.length-n.length):e;return t&&!/\s/g.test(e)?r+t:r}function N(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function F(e){for(var t,n=e.points,r=0,i=0;i<n.numberOfItems;i++){var a=n.getItem(i);i>0&&(r+=N(t,a)),t=a}return r}function U(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return function(e){return 2*Math.PI*C(e,"r")}(e);case"rect":return function(e){return 2*C(e,"width")+2*C(e,"height")}(e);case"line":return function(e){return N({x:C(e,"x1"),y:C(e,"y1")},{x:C(e,"x2"),y:C(e,"y2")})}(e);case"polyline":return F(e);case"polygon":return function(e){var t=e.points;return F(e)+N(t.getItem(t.numberOfItems-1),t.getItem(0))}(e)}}function z(e,t){var n=t||{},r=n.el||function(e){for(var t=e.parentNode;u.svg(t)&&(t=t.parentNode,u.svg(t.parentNode)););return t}(e),i=r.getBoundingClientRect(),a=C(r,"viewBox"),o=i.width,s=i.height,c=n.viewBox||(a?a.split(" "):[0,0,o,s]);return{el:r,viewBox:c,x:c[0]/1,y:c[1]/1,w:o/c[2],h:s/c[3]}}function V(e,t){function n(n){void 0===n&&(n=0);var r=t+n>=1?t+n:0;return e.el.getPointAtLength(r)}var r=z(e.el,e.svg),i=n(),a=n(-1),o=n(1);switch(e.property){case"x":return(i.x-r.x)*r.w;case"y":return(i.y-r.y)*r.h;case"angle":return 180*Math.atan2(o.y-a.y,o.x-a.x)/Math.PI}}function j(e,t){var n=/[-+]?\d*\.?\d+([eE][-+]?\d+)?/g,r=H(u.pth(e)?e.totalLength:e,t)+"";return{original:r,numbers:r.match(n)?r.match(n).map(Number):[0],strings:u.str(e)||t?r.split(n):[]}}function G(e){return b(e?x(u.arr(e)?e.map(w):w(e)):[],(function(e,t,n){return n.indexOf(e)===t}))}function W(e){var t=G(e);return t.map((function(e,n){return{target:e,id:n,total:t.length,transforms:{list:D(e)}}}))}function q(e,t){var n=M(t);if(/^spring/.test(n.easing)&&(n.duration=d(n.easing)),u.arr(e)){var r=e.length;2===r&&!u.obj(e[0])?e={value:e}:u.fnc(t.duration)||(n.duration=t.duration/r)}var i=u.arr(e)?e:[e];return i.map((function(e,n){var r=u.obj(e)&&!u.pth(e)?e:{value:e};return u.und(r.delay)&&(r.delay=n?0:t.delay),u.und(r.endDelay)&&(r.endDelay=n===i.length-1?t.endDelay:0),r})).map((function(e){return T(e,n)}))}function X(e,t){var n=[],r=t.keyframes;for(var i in r&&(t=T(function(e){for(var t=b(x(e.map((function(e){return Object.keys(e)}))),(function(e){return u.key(e)})).reduce((function(e,t){return e.indexOf(t)<0&&e.push(t),e}),[]),n={},r=function(r){var i=t[r];n[i]=e.map((function(e){var t={};for(var n in e)u.key(n)?n==i&&(t.value=e[n]):t[n]=e[n];return t}))},i=0;i<t.length;i++)r(i);return n}(r),t)),t)u.key(i)&&n.push({name:i,tweens:q(t[i],e)});return n}function Y(e,t){var n;return e.tweens.map((function(r){var i=function(e,t){var n={};for(var r in e){var i=L(e[r],t);u.arr(i)&&1===(i=i.map((function(e){return L(e,t)}))).length&&(i=i[0]),n[r]=i}return n.duration=parseFloat(n.duration),n.delay=parseFloat(n.delay),n}(r,t),a=i.value,o=u.arr(a)?a[1]:a,s=S(o),c=B(t.target,e.name,s,t),l=n?n.to.original:c,h=u.arr(a)?a[0]:l,d=S(h)||S(c),p=s||d;return u.und(o)&&(o=l),i.from=j(h,p),i.to=j(k(o,h),p),i.start=n?n.end:0,i.end=i.start+i.delay+i.duration+i.endDelay,i.easing=v(i.easing,i.duration),i.isPath=u.pth(a),i.isColor=u.col(i.from.original),i.isColor&&(i.round=1),n=i,i}))}var K={css:function(e,t,n){return e.style[t]=n},attribute:function(e,t,n){return e.setAttribute(t,n)},object:function(e,t,n){return e[t]=n},transform:function(e,t,n,r,i){if(r.list.set(t,n),t===r.last||i){var a="";r.list.forEach((function(e,t){a+=t+"("+e+") "})),e.style.transform=a}}};function J(e,t){W(e).forEach((function(e){for(var n in t){var r=L(t[n],e),i=e.target,a=S(r),o=B(i,n,a,e),s=k(H(r,a||S(o)),o),c=O(i,n);K[c](i,n,s,e.transforms,!0)}}))}function Z(e,t){return b(x(e.map((function(e){return t.map((function(t){return function(e,t){var n=O(e.target,t.name);if(n){var r=Y(t,e),i=r[r.length-1];return{type:n,property:t.name,animatable:e,tweens:r,duration:i.end,delay:r[0].delay,endDelay:i.endDelay}}}(e,t)}))}))),(function(e){return!u.und(e)}))}function Q(e,t){var n=e.length,r=function(e){return e.timelineOffset?e.timelineOffset:0},i={};return i.duration=n?Math.max.apply(Math,e.map((function(e){return r(e)+e.duration}))):t.duration,i.delay=n?Math.min.apply(Math,e.map((function(e){return r(e)+e.delay}))):t.delay,i.endDelay=n?i.duration-Math.max.apply(Math,e.map((function(e){return r(e)+e.duration-e.endDelay}))):t.endDelay,i}var $=0;var ee,te=[],ne=[],re=function(){function e(){ee=requestAnimationFrame(t)}function t(t){var n=te.length;if(n){for(var r=0;r<n;){var i=te[r];if(i.paused){var a=te.indexOf(i);a>-1&&(te.splice(a,1),n=te.length)}else i.tick(t);r++}e()}else ee=cancelAnimationFrame(ee)}return e}();function ie(e){void 0===e&&(e={});var t,n=0,a=0,o=0,c=0,l=null;function u(e){var t=window.Promise&&new Promise((function(e){return l=e}));return e.finished=t,t}var h=function(e){var t=A(r,e),n=A(i,e),a=X(n,e),o=W(e.targets),s=Z(o,a),c=Q(s,n),l=$;return $++,T(t,{id:l,children:[],animatables:o,animations:s,duration:c.duration,delay:c.delay,endDelay:c.endDelay})}(e);u(h);function d(){var e=h.direction;"alternate"!==e&&(h.direction="normal"!==e?"normal":"reverse"),h.reversed=!h.reversed,t.forEach((function(e){return e.reversed=h.reversed}))}function p(e){return h.reversed?h.duration-e:e}function f(){n=0,a=p(h.currentTime)*(1/ie.speed)}function m(e,t){t&&t.seek(e-t.timelineOffset)}function g(e){for(var t=0,n=h.animations,r=n.length;t<r;){var i=n[t],a=i.animatable,o=i.tweens,c=o.length-1,l=o[c];c&&(l=b(o,(function(t){return e<t.end}))[0]||l);for(var u=s(e-l.start-l.delay,0,l.duration)/l.duration,d=isNaN(u)?1:l.easing(u),p=l.to.strings,f=l.round,m=[],g=l.to.numbers.length,v=void 0,y=0;y<g;y++){var x=void 0,w=l.to.numbers[y],E=l.from.numbers[y]||0;x=l.isPath?V(l.value,d*w):E+d*(w-E),f&&(l.isColor&&y>2||(x=Math.round(x*f)/f)),m.push(x)}var M=p.length;if(M){v=p[0];for(var A=0;A<M;A++){p[A];var T=p[A+1],_=m[A];isNaN(_)||(v+=T?_+T:_+" ")}}else v=m[0];K[i.type](a.target,i.property,v,a.transforms),i.currentValue=v,t++}}function v(e){h[e]&&!h.passThrough&&h[e](h)}function y(e){var r=h.duration,i=h.delay,f=r-h.endDelay,y=p(e);h.progress=s(y/r*100,0,100),h.reversePlayback=y<h.currentTime,t&&function(e){if(h.reversePlayback)for(var n=c;n--;)m(e,t[n]);else for(var r=0;r<c;r++)m(e,t[r])}(y),!h.began&&h.currentTime>0&&(h.began=!0,v("begin"),v("loopBegin")),y<=i&&0!==h.currentTime&&g(0),(y>=f&&h.currentTime!==r||!r)&&g(r),y>i&&y<f?(h.changeBegan||(h.changeBegan=!0,h.changeCompleted=!1,v("changeBegin")),v("change"),g(y)):h.changeBegan&&(h.changeCompleted=!0,h.changeBegan=!1,v("changeComplete")),h.currentTime=s(y,0,r),h.began&&v("update"),e>=r&&(a=0,h.remaining&&!0!==h.remaining&&h.remaining--,h.remaining?(n=o,v("loopComplete"),v("loopBegin"),"alternate"===h.direction&&d()):(h.paused=!0,h.completed||(h.completed=!0,v("loopComplete"),v("complete"),!h.passThrough&&"Promise"in window&&(l(),u(h)))))}return h.reset=function(){var e=h.direction;h.passThrough=!1,h.currentTime=0,h.progress=0,h.paused=!0,h.began=!1,h.changeBegan=!1,h.completed=!1,h.changeCompleted=!1,h.reversePlayback=!1,h.reversed="reverse"===e,h.remaining=h.loop,t=h.children;for(var n=c=t.length;n--;)h.children[n].reset();(h.reversed&&!0!==h.loop||"alternate"===e&&1===h.loop)&&h.remaining++,g(0)},h.set=function(e,t){return J(e,t),h},h.tick=function(e){o=e,n||(n=o),y((o+(a-n))*ie.speed)},h.seek=function(e){y(p(e))},h.pause=function(){h.paused=!0,f()},h.play=function(){h.paused&&(h.completed&&h.reset(),h.paused=!1,te.push(h),f(),ee||re())},h.reverse=function(){d(),f()},h.restart=function(){h.reset(),h.play()},h.reset(),h.autoplay&&h.play(),h}function ae(e,t){for(var n=t.length;n--;)E(e,t[n].animatable.target)&&t.splice(n,1)}"undefined"!=typeof document&&document.addEventListener("visibilitychange",(function(){document.hidden?(te.forEach((function(e){return e.pause()})),ne=te.slice(0),te=[]):ne.forEach((function(e){return e.play()}))})),ie.version="3.0.1",ie.speed=1,ie.running=te,ie.remove=function(e){for(var t=G(e),n=te.length;n--;){var r=te[n],i=r.animations,a=r.children;ae(t,i);for(var o=a.length;o--;){var s=a[o],c=s.animations;ae(t,c),c.length||s.children.length||a.splice(o,1)}i.length||a.length||r.pause()}},ie.get=B,ie.set=J,ie.convertPx=R,ie.path=function(e,t){var n=u.str(e)?y(e)[0]:e,r=t||100;return function(e){return{property:e,el:n,svg:z(n),totalLength:U(n)*(r/100)}}},ie.setDashoffset=function(e){var t=U(e);return e.setAttribute("stroke-dasharray",t),t},ie.stagger=function(e,t){void 0===t&&(t={});var n=t.direction||"normal",r=t.easing?v(t.easing):null,i=t.grid,a=t.axis,o=t.from||0,s="first"===o,c="center"===o,l="last"===o,h=u.arr(e),d=h?parseFloat(e[0]):parseFloat(e),p=h?parseFloat(e[1]):0,f=S(h?e[1]:e)||0,m=t.start||0+(h?d:0),g=[],y=0;return function(e,t,u){if(s&&(o=0),c&&(o=(u-1)/2),l&&(o=u-1),!g.length){for(var v=0;v<u;v++){if(i){var b=c?(i[0]-1)/2:o%i[0],x=c?(i[1]-1)/2:Math.floor(o/i[0]),w=b-v%i[0],E=x-Math.floor(v/i[0]),M=Math.sqrt(w*w+E*E);"x"===a&&(M=-w),"y"===a&&(M=-E),g.push(M)}else g.push(Math.abs(o-v));y=Math.max.apply(Math,g)}r&&(g=g.map((function(e){return r(e/y)*y}))),"reverse"===n&&(g=g.map((function(e){return a?e<0?-1*e:-e:Math.abs(y-e)})))}return m+(h?(p-d)/y:d)*(Math.round(100*g[t])/100)+f}},ie.timeline=function(e){void 0===e&&(e={});var t=ie(e);return t.duration=0,t.add=function(n,r){var a=te.indexOf(t),o=t.children;function s(e){e.passThrough=!0}a>-1&&te.splice(a,1);for(var c=0;c<o.length;c++)s(o[c]);var l=T(n,A(i,e));l.targets=l.targets||e.targets;var h=t.duration;l.autoplay=!1,l.direction=t.direction,l.timelineOffset=u.und(r)?h:k(r,h),s(t),t.seek(l.timelineOffset);var d=ie(l);s(d),o.push(d);var p=Q(o,e);return t.delay=p.delay,t.endDelay=p.endDelay,t.duration=p.duration,t.seek(0),t.reset(),t.autoplay&&t.play(),t},t},ie.easing=v,ie.penner=g,ie.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},t.default=ie},945:function(e,t){AFRAME.registerComponent("rounded",{schema:{enabled:{default:!0},width:{type:"number",default:1},height:{type:"number",default:1},radius:{type:"number",default:.3},topLeftRadius:{type:"number",default:-1},topRightRadius:{type:"number",default:-1},bottomLeftRadius:{type:"number",default:-1},bottomRightRadius:{type:"number",default:-1},color:{type:"color",default:"#F0F0F0"},opacity:{type:"number",default:1}},init:function(){this.rounded=new THREE.Mesh(this.draw(),new THREE.MeshPhongMaterial({color:new THREE.Color(this.data.color),side:THREE.DoubleSide})),this.updateOpacity(),this.el.setObject3D("mesh",this.rounded)},update:function(){this.data.enabled?this.rounded&&(this.rounded.visible=!0,this.rounded.geometry=this.draw(),this.rounded.material.color=new THREE.Color(this.data.color),this.updateOpacity()):this.rounded.visible=!1},updateOpacity:function(){this.data.opacity<0&&(this.data.opacity=0),this.data.opacity>1&&(this.data.opacity=1),this.data.opacity<1?this.rounded.material.transparent=!0:this.rounded.material.transparent=!1,this.rounded.material.opacity=this.data.opacity},tick:function(){},remove:function(){this.rounded&&(this.el.object3D.remove(this.rounded),this.rounded=null)},draw:function(){var e=new THREE.Shape;var t,n,r,i,a,o,s,c,l,u=[this.data.radius,this.data.radius,this.data.radius,this.data.radius];return-1!=this.data.topLeftRadius&&(u[0]=this.data.topLeftRadius),-1!=this.data.topRightRadius&&(u[1]=this.data.topRightRadius),-1!=this.data.bottomLeftRadius&&(u[2]=this.data.bottomLeftRadius),-1!=this.data.bottomRightRadius&&(u[3]=this.data.bottomRightRadius),t=e,n=0,r=0,i=this.data.width,a=this.data.height,o=u[0],s=u[1],c=u[2],l=u[3],o||(o=1e-5),s||(s=1e-5),c||(c=1e-5),l||(l=1e-5),t.moveTo(n,r+o),t.lineTo(n,r+a-o),t.quadraticCurveTo(n,r+a,n+o,r+a),t.lineTo(n+i-s,r+a),t.quadraticCurveTo(n+i,r+a,n+i,r+a-s),t.lineTo(n+i,r+l),t.quadraticCurveTo(n+i,r,n+i-l,r),t.lineTo(n+c,r),t.quadraticCurveTo(n,r,n,r+c),new THREE.ShapeBufferGeometry(e)},pause:function(){},play:function(){}}),AFRAME.registerPrimitive("a-rounded",{defaultComponents:{rounded:{}},mappings:{enabled:"rounded.enabled",width:"rounded.width",height:"rounded.height",radius:"rounded.radius","top-left-radius":"rounded.topLeftRadius","top-right-radius":"rounded.topRightRadius","bottom-left-radius":"rounded.bottomLeftRadius","bottom-right-radius":"rounded.bottomRightRadius",color:"rounded.color",opacity:"rounded.opacity"}})},958:function(e,t){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("slice9",{schema:{width:{default:1,min:0},height:{default:1,min:0},left:{default:0,min:0},right:{default:0,min:0},bottom:{default:0,min:0},top:{default:0,min:0},side:{default:"front",oneOf:["front","back","double"]},padding:{default:.1,min:.01},color:{type:"color",default:"#fff"},opacity:{default:1,min:0,max:1},transparent:{default:!0},debug:{default:!1},src:{type:"map"}},multiple:!1,init:function(){var e=this.data,t=this.material=new THREE.MeshBasicMaterial({color:e.color,opacity:e.opacity,transparent:e.transparent,wireframe:e.debug}),n=this.geometry=new THREE.PlaneBufferGeometry(e.width,e.height,3,3);new THREE.TextureLoader;this.plane=new THREE.Mesh(n,t),this.el.setObject3D("mesh",this.plane),this.textureSrc=null},updateMap:function(){var e=this.data.src;if(e){if(e===this.textureSrc)return;return this.textureSrc=e,void this.el.sceneEl.systems.material.loadTexture(e,{src:e},t.bind(this))}function t(e){this.material.map=e,this.material.needsUpdate=!0,this.regenerateMesh()}this.material.map&&t(null)},regenerateMesh:function(){var e=this.data,t=this.geometry.attributes.position.array,n=this.geometry.attributes.uv.array,r=this.material.map.image;if(r){var i={left:e.left/r.width,right:e.right/r.width,top:e.top/r.height,bottom:e.bottom/r.height};d(1,i.left,1),d(2,i.right,1),d(4,0,i.bottom),d(5,i.left,i.bottom),d(6,i.right,i.bottom),d(7,1,i.bottom),d(8,0,i.top),d(9,i.left,i.top),d(10,i.right,i.top),d(11,1,i.top),d(13,i.left,0),d(14,i.right,0);var a=e.width/2,o=e.height/2,s=-a+e.padding,c=a-e.padding,l=o-e.padding,u=-o+e.padding;h(0,-a,o),h(1,s,o),h(2,c,o),h(3,a,o),h(4,-a,l),h(5,s,l),h(6,c,l),h(7,a,l),h(8,-a,u),h(9,s,u),h(10,c,u),h(11,a,u),h(13,s,-o),h(14,c,-o),h(12,-a,-o),h(15,a,-o),this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.uv.needsUpdate=!0}function h(e,n,r){t[3*e]=n,t[3*e+1]=r}function d(e,t,r){n[2*e]=t,n[2*e+1]=r}},update:function(e){var t=this.data;this.material.color.setStyle(t.color),this.material.opacity=t.opacity,this.material.transparent=t.transparent,this.material.wireframe=t.debug,this.material.side=function(e){switch(e){case"back":return THREE.BackSide;case"double":return THREE.DoubleSide;default:return THREE.FrontSide}}(t.side);var n=AFRAME.utils.diff(t,e);"src"in n?this.updateMap():("width"in n||"height"in n||"padding"in n||"left"in n||"top"in n||"bottom"in n||"right"in n)&&this.regenerateMesh()},remove:function(){},pause:function(){},play:function(){}})},971:function(e,t){THREE.PMREMGenerator=function(){var e,t=((e=new THREE.ShaderMaterial({defines:{SAMPLES_PER_LEVEL:20},uniforms:{faceIndex:{value:0},roughness:{value:.5},mapSize:{value:.5},envMap:{value:null},tFlip:{value:-1}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform int faceIndex;\n\t\t\t\tuniform float roughness;\n\t\t\t\tuniform samplerCube envMap;\n\t\t\t\tuniform float mapSize;\n\t\t\t\tuniform float tFlip;\n\t\t\t\t\n\t\t\t\tfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\t\t\t\t\tfloat a = ggxRoughness + 0.0001;\n\t\t\t\t\ta *= a;\n\t\t\t\t\treturn ( 2.0 / a - 2.0 );\n\t\t\t\t}\n\t\t\t\tvec3 ImportanceSamplePhong(vec2 uv, mat3 vecSpace, float specPow) {\n\t\t\t\t\tfloat phi = uv.y * 2.0 * PI;\n\t\t\t\t\tfloat cosTheta = pow(1.0 - uv.x, 1.0 / (specPow + 1.0));\n\t\t\t\t\tfloat sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n\t\t\t\t\tvec3 sampleDir = vec3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta);\n\t\t\t\t\treturn vecSpace * sampleDir;\n\t\t\t\t}\n\t\t\t\tvec3 ImportanceSampleGGX( vec2 uv, mat3 vecSpace, float Roughness )\n\t\t\t\t{\n\t\t\t\t\tfloat a = Roughness * Roughness;\n\t\t\t\t\tfloat Phi = 2.0 * PI * uv.x;\n\t\t\t\t\tfloat CosTheta = sqrt( (1.0 - uv.y) / ( 1.0 + (a*a - 1.0) * uv.y ) );\n\t\t\t\t\tfloat SinTheta = sqrt( 1.0 - CosTheta * CosTheta );\n\t\t\t\t\treturn vecSpace * vec3(SinTheta * cos( Phi ), SinTheta * sin( Phi ), CosTheta);\n\t\t\t\t}\n\t\t\t\tmat3 matrixFromVector(vec3 n) {\n\t\t\t\t\tfloat a = 1.0 / (1.0 + n.z);\n\t\t\t\t\tfloat b = -n.x * n.y * a;\n\t\t\t\t\tvec3 b1 = vec3(1.0 - n.x * n.x * a, b, -n.x);\n\t\t\t\t\tvec3 b2 = vec3(b, 1.0 - n.y * n.y * a, -n.y);\n\t\t\t\t\treturn mat3(b1, b2, n);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvec4 testColorMap(float Roughness) {\n\t\t\t\t\tvec4 color;\n\t\t\t\t\tif(faceIndex == 0)\n\t\t\t\t\t\tcolor = vec4(1.0,0.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 1)\n\t\t\t\t\t\tcolor = vec4(0.0,1.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 2)\n\t\t\t\t\t\tcolor = vec4(0.0,0.0,1.0,1.0);\n\t\t\t\t\telse if(faceIndex == 3)\n\t\t\t\t\t\tcolor = vec4(1.0,1.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 4)\n\t\t\t\t\t\tcolor = vec4(0.0,1.0,1.0,1.0);\n\t\t\t\t\telse\n\t\t\t\t\t\tcolor = vec4(1.0,0.0,1.0,1.0);\n\t\t\t\t\tcolor *= ( 1.0 - Roughness );\n\t\t\t\t\treturn color;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec3 sampleDirection;\n\t\t\t\t\tvec2 uv = vUv*2.0 - 1.0;\n\t\t\t\t\tfloat offset = -1.0/mapSize;\n\t\t\t\t\tconst float a = -1.0;\n\t\t\t\t\tconst float b = 1.0;\n\t\t\t\t\tfloat c = -1.0 + offset;\n\t\t\t\t\tfloat d = 1.0 - offset;\n\t\t\t\t\tfloat bminusa = b - a;\n\t\t\t\t\tuv.x = (uv.x - a)/bminusa * d - (uv.x - b)/bminusa * c;\n\t\t\t\t\tuv.y = (uv.y - a)/bminusa * d - (uv.y - b)/bminusa * c;\n\t\t\t\t\tif (faceIndex==0) {\n\t\t\t\t\t\tsampleDirection = vec3(1.0, -uv.y, -uv.x);\n\t\t\t\t\t} else if (faceIndex==1) {\n\t\t\t\t\t\tsampleDirection = vec3(-1.0, -uv.y, uv.x);\n\t\t\t\t\t} else if (faceIndex==2) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, 1.0, uv.y);\n\t\t\t\t\t} else if (faceIndex==3) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, -1.0, -uv.y);\n\t\t\t\t\t} else if (faceIndex==4) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, -uv.y, 1.0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsampleDirection = vec3(-uv.x, -uv.y, -1.0);\n\t\t\t\t\t}\n\t\t\t\t\tvec3 correctedDirection = vec3( tFlip * sampleDirection.x, sampleDirection.yz );\n\t\t\t\t\tmat3 vecSpace = matrixFromVector( normalize( correctedDirection ) );\n\t\t\t\t\tvec3 rgbColor = vec3(0.0);\n\t\t\t\t\tconst int NumSamples = SAMPLES_PER_LEVEL;\n\t\t\t\t\tvec3 vect;\n\t\t\t\t\tfloat weight = 0.0;\n\t\t\t\t\tfor( int i = 0; i < NumSamples; i ++ ) {\n\t\t\t\t\t\tfloat sini = sin(float(i));\n\t\t\t\t\t\tfloat cosi = cos(float(i));\n\t\t\t\t\t\tfloat r = rand(vec2(sini, cosi));\n\t\t\t\t\t\tvect = ImportanceSampleGGX(vec2(float(i) / float(NumSamples), r), vecSpace, roughness);\n\t\t\t\t\t\tfloat dotProd = dot(vect, normalize(sampleDirection));\n\t\t\t\t\t\tweight += dotProd;\n\t\t\t\t\t\tvec3 color = envMapTexelToLinear(textureCube(envMap, vect)).rgb;\n\t\t\t\t\t\trgbColor.rgb += color;\n\t\t\t\t\t}\n\t\t\t\t\trgbColor /= float(NumSamples);\n\t\t\t\t\t//rgbColor = testColorMap( roughness ).rgb;\n\t\t\t\t\tgl_FragColor = linearToOutputTexel( vec4( rgbColor, 1.0 ) );\n\t\t\t\t}",blending:THREE.NoBlending})).type="PMREMGenerator",e),n=new THREE.OrthographicCamera(-1,1,1,-1,0,1e3),r=new THREE.Scene,i=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2,0),t);i.material.side=THREE.DoubleSide,r.add(i),r.add(n);var a=function(e,t,n){this.sourceTexture=e,this.resolution=void 0!==n?n:256,this.samplesPerLevel=void 0!==t?t:32;var r=this.sourceTexture.encoding===THREE.LinearEncoding||this.sourceTexture.encoding===THREE.GammaEncoding||this.sourceTexture.encoding===THREE.sRGBEncoding;this.sourceTexture.minFilter=r?THREE.LinearFilter:THREE.NearestFilter,this.sourceTexture.magFilter=r?THREE.LinearFilter:THREE.NearestFilter,this.sourceTexture.generateMipmaps=this.sourceTexture.generateMipmaps&&r,this.cubeLods=[];var i=this.resolution,a={format:this.sourceTexture.format,magFilter:this.sourceTexture.magFilter,minFilter:this.sourceTexture.minFilter,type:this.sourceTexture.type,generateMipmaps:this.sourceTexture.generateMipmaps,anisotropy:this.sourceTexture.anisotropy,encoding:this.sourceTexture.encoding};this.numLods=Math.log(i)/Math.log(2)-2;for(var o=0;o<this.numLods;o++){var s=new THREE.WebGLRenderTargetCube(i,i,a);s.texture.name="PMREMGenerator.cube"+o,this.cubeLods.push(s),i=Math.max(16,i/2)}};return a.prototype={constructor:a,update:function(e){var n=this.sourceTexture.isCubeTexture?-1:1;t.defines.SAMPLES_PER_LEVEL=this.samplesPerLevel,t.uniforms.faceIndex.value=0,t.uniforms.envMap.value=this.sourceTexture,t.envMap=this.sourceTexture,t.needsUpdate=!0;var r=e.gammaInput,i=e.gammaOutput,a=e.toneMapping,o=e.toneMappingExposure,s=e.getRenderTarget();e.toneMapping=THREE.LinearToneMapping,e.toneMappingExposure=1,e.gammaInput=!1,e.gammaOutput=!1;for(var c=0;c<this.numLods;c++){var l=c/(this.numLods-1);t.uniforms.roughness.value=.9*l,t.uniforms.tFlip.value=0==c?n:1;var u=this.cubeLods[c].width;t.uniforms.mapSize.value=u,this.renderToCubeMapTarget(e,this.cubeLods[c]),c<5&&(t.uniforms.envMap.value=this.cubeLods[c].texture)}e.setRenderTarget(s),e.toneMapping=a,e.toneMappingExposure=o,e.gammaInput=r,e.gammaOutput=i},renderToCubeMapTarget:function(e,t){for(var n=0;n<6;n++)this.renderToCubeMapTargetFace(e,t,n)},renderToCubeMapTargetFace:function(e,i,a){t.uniforms.faceIndex.value=a,e.setRenderTarget(i,a),e.clear(),e.render(r,n)},dispose:function(){for(var e=0,t=this.cubeLods.length;e<t;e++)this.cubeLods[e].dispose()}},a}()},972:function(e,t){var n,r,i,a,o;THREE.PMREMCubeUVPacker=(r=new THREE.OrthographicCamera,i=new THREE.Scene,(n=new THREE.ShaderMaterial({uniforms:{faceIndex:{value:0},mapSize:{value:0},envMap:{value:null},testColor:{value:new THREE.Vector3(1,1,1)}},vertexShader:"precision highp float;        varying vec2 vUv;        void main() {          vUv = uv;          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );        }",fragmentShader:"precision highp float;        varying vec2 vUv;        uniform samplerCube envMap;        uniform float mapSize;        uniform vec3 testColor;        uniform int faceIndex;                void main() {          vec3 sampleDirection;          vec2 uv = vUv;          uv = uv * 2.0 - 1.0;          uv.y *= -1.0;          if(faceIndex == 0) {            sampleDirection = normalize(vec3(1.0, uv.y, -uv.x));          } else if(faceIndex == 1) {            sampleDirection = normalize(vec3(uv.x, 1.0, uv.y));          } else if(faceIndex == 2) {            sampleDirection = normalize(vec3(uv.x, uv.y, 1.0));          } else if(faceIndex == 3) {            sampleDirection = normalize(vec3(-1.0, uv.y, uv.x));          } else if(faceIndex == 4) {            sampleDirection = normalize(vec3(uv.x, -1.0, -uv.y));          } else {            sampleDirection = normalize(vec3(-uv.x, uv.y, -1.0));          }          vec4 color = envMapTexelToLinear( textureCube( envMap, sampleDirection ) );          gl_FragColor = linearToOutputTexel( color );        }",blending:THREE.NoBlending})).type="PMREMCubeUVPacker",a=n,(o=function(e){this.cubeLods=e;var t=4*e[0].width,n=e[0].texture,r={format:n.format,magFilter:n.magFilter,minFilter:n.minFilter,type:n.type,generateMipmaps:n.generateMipmaps,anisotropy:n.anisotropy,encoding:n.encoding===THREE.RGBEEncoding?THREE.RGBM16Encoding:n.encoding};r.encoding===THREE.RGBM16Encoding&&(r.magFilter=THREE.LinearFilter,r.minFilter=THREE.LinearFilter),this.CubeUVRenderTarget=new THREE.WebGLRenderTarget(t,t,r),this.CubeUVRenderTarget.texture.name="PMREMCubeUVPacker.cubeUv",this.CubeUVRenderTarget.texture.mapping=THREE.CubeUVReflectionMapping,this.objects=[];var i=new THREE.PlaneBufferGeometry(1,1),o=[];o.push(new THREE.Vector2(0,0)),o.push(new THREE.Vector2(1,0)),o.push(new THREE.Vector2(2,0)),o.push(new THREE.Vector2(0,1)),o.push(new THREE.Vector2(1,1)),o.push(new THREE.Vector2(2,1));var s=t;t=e[0].width;var c=0,l=4;this.numLods=Math.log(e[0].width)/Math.log(2)-2;for(var u=0;u<this.numLods;u++){var h=.5*(s-s/l);t>16&&(l*=2);for(var d=t>16?6:1,p=0,f=0,m=t,g=0;g<d;g++){for(var v=0;v<6;v++){var y=a.clone();y.uniforms.envMap.value=this.cubeLods[u].texture,y.envMap=this.cubeLods[u].texture,y.uniforms.faceIndex.value=v,y.uniforms.mapSize.value=m;var b=new THREE.Mesh(i,y);b.position.x=o[v].x*m-h+p,b.position.y=o[v].y*m-h+c+f,b.material.side=THREE.BackSide,b.scale.setScalar(m),this.objects.push(b)}f+=1.75*m,p+=1.25*m,m/=2}c+=2*t,t>16&&(t/=2)}}).prototype={constructor:o,update:function(e){var t=4*this.cubeLods[0].width;r.left=.5*-t,r.right=.5*t,r.top=.5*-t,r.bottom=.5*t,r.near=0,r.far=1,r.updateProjectionMatrix();for(var n=0;n<this.objects.length;n++)i.add(this.objects[n]);var a=e.gammaInput,o=e.gammaOutput,s=e.toneMapping,c=e.toneMappingExposure,l=e.getRenderTarget();for(e.gammaInput=!1,e.gammaOutput=!1,e.toneMapping=THREE.LinearToneMapping,e.toneMappingExposure=1,e.setRenderTarget(this.CubeUVRenderTarget),e.render(i,r),e.setRenderTarget(l),e.toneMapping=s,e.toneMappingExposure=c,e.gammaInput=a,e.gammaOutput=o,n=0;n<this.objects.length;n++)i.remove(this.objects[n])},dispose:function(){for(var e=0,t=this.objects.length;e<t;e++)this.objects[e].material.dispose();this.objects[0].geometry.dispose()}},o)},99:function(e,t,n){(function(t){var r=n(200),i=n(60),a={colors:{debug:"gray",error:"red",info:"gray",warn:"orange"}},o=function(e){var t=r(e);return t.color=function(e){var t=function(e){var t=e.split(":");return t[t.length-1]}(e);return a.colors&&a.colors[t]||null}(e),t};i(o,r);var s=function(){try{return window.localStorage}catch(e){}}();s&&(parseInt(s.logs,10)||"true"===s.logs)?o.enable("*"):o.enable("*:error,*:info,*:warn"),t.browser&&(window.logs=o),e.exports=o}).call(this,n(109))}}]);
//# sourceMappingURL=engine-89e9a00d9249cd8b1752.js.map