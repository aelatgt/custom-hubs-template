{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/utils/disable-ios-zoom.js","webpack:///./src/react-components/link-root.js","webpack:///./src/link.js","webpack:///./src/utils/async-utils.js","webpack:///./src/utils/i18n.js","webpack:///./src/webxr-bypass-hacks.js","webpack:///./src/utils/crypto.js","webpack:///./src/utils/link-channel.js","webpack:///./src/utils/configs.js","webpack:///./src/utils/identity.js","webpack:///./src/storage/store.js","webpack:///./src/assets/images/app-logo.png","webpack:///./src/assets/images/company-logo.png","webpack:///./src/assets/images/editor-logo.png","webpack:///./src/assets/stylesheets/link.scss?5e2a","webpack:///./src/telemetry.js","webpack:///./src/assets/images/generic_vr_headset.svg","webpack:///./src/assets/models/DuckyMesh.glb","webpack:///./src/utils/name-generation.js","webpack:///./src/utils/phoenix-utils.js","webpack:///./src/utils/theme.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","7","exports","module","l","e","Promise","resolve","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","oe","err","console","error","jsonpArray","window","oldJsonpFunction","slice","__webpack_exports__","disableiOSZoom","detect_browser__WEBPACK_IMPORTED_MODULE_0__","detectOS","navigator","userAgent","lastTouchAtMs","document","addEventListener","ev","scale","preventDefault","now","Date","getTime","isDoubleTouch","MAX_DIGITS","MAX_LETTERS","addLocaleData","en","hasTouchEvents","documentElement","LinkRoot","Component","[object Object]","args","_this","super","this","_defineProperty","entered","isAlphaMode","failedAtLeastOnce","handleKeyDown","attachTouchEvents","ref","entries","buttonRefs","ontouchstart","removeChar","toggleMode","addToEntry","removeEventListener","keyCode","state","stopPropagation","ch","maxAllowedChars","newChars","setState","attemptLookup","substring","_ref","_asyncToGenerator","code","props","linkChannel","attemptLink","then","response","profile","hasChangedName","store","activity","update","credentials","path","location","href","catch","Error","message","_x","arguments","_ref2","url","fetch","status","_x2","_ref3","attemptEntry","_x3","render","react_default","a","createElement","index_es","locale","lang","messages","className","styles","link","linkContents","logo","src","configs","image","classNames","codeLoadingPanel","enteredContents","header","id","charInput","type","pattern","onChange","target","match","toUpperCase","enteredFooter","onClick","keypad","map","disabled","keypadButton","toString","keypadToggleMode","keypadZeroButton","keypadBackspace","footer","linkHeadsetFooterLink","style","visibility","HeadsetIcon","headsetIcon","createLink","intl","PropTypes","registerTelemetry","Store","LinkChannel","socket","connectToReticulum","setSocket","ReactDOM","link_root","getElementById","waitForEvent","waitForDOMContentLoaded","eventName","eventObj","once","readyState","_configs__WEBPACK_IMPORTED_MODULE_0__","_assets_translations_data_json__WEBPACK_IMPORTED_MODULE_1__","navigatorLang","languages","language","userLanguage","toLowerCase","split","localeData","_messages","APP_CONFIG","translations","configTranslations","messageKey","replace","_match","subkey","reduce","acc","entry","test","xr","requestDevice","reject","getVRDisplays","deriveKey","privateKey","publicKey","crypto","subtle","public","publicKeyToString","JSON","stringify","exportKey","stringToPublicKey","importKey","parse","namedCurve","stringToArrayBuffer","buf","Uint8Array","charCodeAt","arrayBufferToString","b","byteLength","String","fromCharCode","keyPair","generateKey","publicKeyString","incomingPublicKeyString","obj","iv","incomingPublicKey","secret","encryptedData","btoa","encrypt","base64value","ciphertext","atob","decrypt","LINK_ACTION_TIMEOUT","constructor","onFinished","finished","step","getLetter","Math","floor","random","readyToSend","leftChannel","channel","timeout","leave","cancel","on","keys","incoming","pathname","_objectSpread","_x5","_x6","_generatePublicKeyAndEncryptedObject","generatePublicKeyAndEncryptedObject","public_key","payload","target_session_id","reply_to_session_id","join","receive","_generateKeys","generateKeys","numOccupants","params","session_id","setTimeout","warn","_x7","_x8","_x9","_decryptObject","decryptObject","pdfjs_dist__WEBPACK_IMPORTED_MODULE_3__","pdfjs_dist__WEBPACK_IMPORTED_MODULE_3___default","isAdmin","forEach","x","el","querySelector","getAttribute","process","__webpack_public_path__","pdfjs","GlobalWorkerOptions","workerSrc","AVAILABLE_INTEGRATIONS","theme","colorVars","innerHTML","head","prepend","features","feature","featureName","enableAll","localDevImages","imageName","cssUrl","images","linkName","defaultValue","links","setIsAdmin","_isAdmin","names","chooseRandom","arr","fetchRandomDefaultAvatarId","_fetchRandomDefaultAvatarId","defaultAvatars","fetchReticulumAuthenticated","URL","ducky","avatar","LOCAL_STORE_KEY","STORE_STATE_CACHE_KEY","OAUTH_FLOW_CREDENTIALS_KEY","validator","Validator","SCHEMA","definitions","additionalProperties","properties","displayName","avatarId","personalAvatarId","token","email","hasFoundFreeze","hasAcceptedProfile","lastEnteredAt","hasPinned","hasRotated","hasRecentered","hasScaled","hasHoveredInWorldHud","hasOpenedShare","entryCount","settings","lastUsedMicDeviceId","preferences","muteMicOnEntry","enableOnScreenJoystickLeft","enableOnScreenJoystickRight","onlyShowNametagsInFreeze","allowMultipleHubsInstances","maxResolutionWidth","maxResolutionHeight","globalVoiceVolume","globalMediaVolume","snapRotationDegrees","materialQualitySetting","disableMovement","disableBackwardsMovement","disableStrafing","disableTeleporter","confirmedDiscordRooms","items","confirmedBroadcastedRooms","uploadPromotionTokens","fileId","promotionToken","creatorAssignmentTokens","hubId","creatorAssignmentToken","embedTokens","embedToken","onLoadActions","action","$ref","EventTarget","jwtDecode","exp","store_asyncToGenerator","_shouldResetAvatarOnInit","resetToRandomDefaultAvatar","localStorage","getItem","setItem","dispatchEvent","CustomEvent","oauthFlowCredentials","Cookies","getJSON","remove","_signOutOnExpiredAuthToken","credentialsAccountId","sub","resetConfirmedBroadcastedRooms","clearStoredArray","resetTipActivityFlags","bumpEntryCount","currentEntryCount","enqueueOnLoadAction","executeOnLoadActions","sceneEl","emit","event","detail","clearOnLoadActions","arrayMerge","destinationArray","sourceArray","newState","mergeOpts","finalState","merge","valid","validate","undefined","keypad-button","char-input","loading-text","loadingText","link-contents","entered-footer","entered-contents","create-link","code-loading-panel","entry-footer-image","entryFooterImage","footer-image","footerImage","keypad-backspace","keypad-toggle-mode","char","headset-icon","link-headset-footer-link","raven_js__WEBPACK_IMPORTED_MODULE_0__","raven_js__WEBPACK_IMPORTED_MODULE_0___default","_utils_configs__WEBPACK_IMPORTED_MODULE_1__","ga","trackedPage","trackedTitle","sentryDsn","SENTRY_DSN","gaTrackingId","GA_TRACKING_ID","log","Raven","config","install","adjectives","nouns","generateHubName","randItem","set","charAt","hasReticulumServer","RETICULUM_SERVER","isLocalClient","host","resolverLink","getReticulumFetchUrl","absolute","reticulumMeta","invalidatedReticulumMetaThisSession","invalidateReticulumMeta","_invalidateReticulumMeta","getReticulumMeta","_getReticulumMeta","version","pool","phx_host","res","json","phxHostOverride","URLSearchParams","search","_connectToReticulum","debug","socketClass","Socket","qs","getNewSocketUrl","socketProtocol","RETICULUM_SOCKET_PROTOCOL","protocol","socketHost","socketPort","RETICULUM_SOCKET_SERVER","port","socketUrl","socketSettings","logger","kind","msg","connect","onError","endPointPath","endPoint","newEndPoint","getLandingPageForPhoto","photoUrl","parsedUrl","method","APP","retUrl","headers","content-type","authorization","body","text","createAndRedirectToNewHub","_x4","_createAndRedirectToNewHub","sceneId","createUrl","hub","scene_id","creator_assignment_token","hub_id","embed_token","getPresenceEntryForSession","presences","sessionId","presence","find","k","metas","getPresenceContextForSession","context","getPresenceProfileForSession","migrateChannelToSocket","oldChannel","topic","bindings","item","callback","pushBuffer","oldJoinPush","joinPush","recHooks","discordBridgesForPresences","channels","values","discordBridges","Array","applyThemeToTextButton","getThemeColor","_async_utils__WEBPACK_IMPORTED_MODULE_0__","DEFAULT_COLORS","action-color","action-label-color","action-color-disabled","action-color-highlight","action-text-color","action-subtitle-color","notice-background-color","notice-text-color","favorited-color","highlighted","setAttribute","classList","add","actionColor","actionHoverColor"],"mappings":"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AA,GAGA,MAAMkc,EAAK3Z,OAAO2Z,GAEH,SAASvR,EAAkBwR,EAAaC,GACrD,MAAMC,EAAY3T,IAAQ4T,WACpBC,EAAe7T,IAAQ8T,eAEzBH,IACFja,QAAQqa,IAAI,yBAA2BJ,GACvCK,IAAMC,OAAON,GAAWO,WAGtBV,GAAMK,IACRna,QAAQqa,IAAI,kCAAoCF,GAEhDL,EAAG,SAAUK,EAAc,QAEvBJ,GACFD,EAAG,MAAO,OAAQC,GAGhBC,GACFF,EAAG,MAAO,QAASE,GAGrBF,EAAG,OAAQ,mCC3Bf7b,EAAAD,QAAiBJ,EAAAiC,EAAuB,4FCAxC5B,EAAAD,QAAiBJ,EAAAiC,EAAuB,4GCAxC,MAAM4a,EAAa,CACjB,OACA,WACA,aACA,YACA,eACA,WACA,SACA,YACA,WACA,cACA,QACA,UACA,UACA,OACA,SACA,UACA,WACA,SACA,WACA,aACA,WACA,SACA,UACA,UACA,OACA,QACA,QACA,UACA,OACA,YACA,WACA,SACA,WACA,OACA,WACA,WACA,SACA,QACA,YACA,MACA,WACA,SACA,UACA,QACA,WACA,WACA,QACA,QACA,MACA,QACA,YACA,OACA,UACA,SACA,cACA,WACA,UACA,YACA,UACA,WACA,YACA,UACA,aACA,SACA,WACA,UACA,WACA,SACA,YACA,UACA,QACA,OACA,OACA,QACA,YACA,QACA,SACA,SACA,QACA,UACA,aACA,SACA,cACA,YACA,WACA,OACA,QACA,WACA,UACA,WACA,WACA,cACA,cACA,OACA,SACA,QACA,YACA,UACA,WACA,SACA,WACA,eACA,aACA,OACA,SACA,MACA,WACA,SACA,QACA,SACA,UACA,QACA,QACA,SACA,SACA,WACA,OACA,UACA,aACA,aACA,YACA,YACA,UACA,SACA,UACA,aACA,aACA,OACA,YACA,WACA,WACA,SACA,YACA,WACA,aACA,aACA,cACA,UACA,UACA,OACA,QACA,QACA,SACA,OACA,WACA,OACA,YACA,QACA,UACA,UACA,WACA,QACA,WACA,YACA,QACA,YACA,QACA,OACA,YACA,aACA,QACA,SACA,SACA,QACA,QACA,QACA,MACA,QACA,WACA,QACA,WACA,QACA,WACA,UACA,SACA,OACA,QACA,MACA,UACA,QACA,UACA,QACA,QACA,QACA,WACA,WACA,SACA,WACA,WACA,cACA,gBACA,WACA,aACA,QACA,aACA,YACA,cACA,WACA,aACA,UACA,YACA,UACA,YACA,YACA,aACA,YACA,WACA,OACA,WACA,OACA,YACA,QACA,SACA,WACA,WACA,SACA,SACA,OACA,WACA,WACA,UACA,YACA,SACA,UACA,YACA,aACA,QACA,SACA,eACA,UACA,QACA,SACA,UACA,YACA,OACA,MACA,UACA,UACA,WACA,WACA,QACA,QACA,WACA,SACA,WACA,WACA,aACA,SACA,aACA,cACA,SACA,aACA,WACA,SACA,SACA,OACA,QACA,SACA,SACA,SACA,UACA,OACA,WACA,QACA,aACA,SACA,UACA,UACA,WACA,YACA,YACA,QACA,UACA,YACA,QACA,SACA,UACA,UACA,UACA,UACA,OACA,QACA,OACA,SACA,YACA,UACA,YACA,cACA,WACA,UACA,eACA,SACA,OACA,cACA,WACA,YACA,SACA,WACA,UACA,YACA,UACA,WACA,WACA,SACA,YACA,UACA,OACA,WACA,QACA,YACA,WACA,WACA,QACA,QACA,SACA,OACA,YACA,SACA,eACA,aACA,WACA,SACA,SACA,YACA,SACA,OACA,WACA,YACA,QACA,QACA,OACA,OACA,QACA,SACA,UACA,UACA,SACA,UACA,OACA,WACA,UACA,WACA,YACA,WACA,UACA,cACA,QACA,YACA,OACA,QACA,WACA,OACA,QACA,OACA,gBACA,UACA,YACA,cACA,SACA,QACA,SACA,WACA,WACA,WACA,WACA,OACA,UACA,OACA,QACA,SACA,SACA,SACA,WACA,SACA,SACA,OACA,OACA,UACA,UACA,QACA,SACA,eACA,cACA,WACA,UACA,cACA,SACA,YACA,SACA,cACA,aACA,YACA,SACA,QACA,SACA,WACA,QACA,UACA,WACA,YACA,YACA,cACA,QACA,OACA,YACA,YACA,YACA,YACA,aACA,YACA,WACA,QACA,OACA,WACA,QACA,WACA,aACA,SACA,WACA,WACA,SACA,YACA,UACA,UACA,aACA,MACA,OACA,aACA,WACA,WACA,YACA,cACA,QACA,QACA,UACA,gBACA,WACA,OACA,UACA,SACA,SACA,SACA,aACA,SACA,UACA,WACA,WACA,SACA,UACA,UACA,WACA,UACA,QACA,aACA,aACA,QACA,iBACA,UACA,SACA,SACA,WACA,SACA,QACA,SACA,QACA,cACA,WACA,UACA,SACA,WACA,WACA,QACA,UACA,YACA,aACA,aACA,SACA,SACA,UACA,SACA,UACA,QACA,YACA,SACA,UACA,WACA,WACA,YACA,aACA,UACA,YACA,YACA,QACA,UACA,SACA,WACA,OACA,UACA,SACA,WACA,QACA,QACA,OACA,cACA,YACA,WACA,UACA,WACA,SACA,cACA,SACA,SACA,WACA,OACA,WACA,QACA,QACA,UACA,QACA,QACA,SACA,YACA,SACA,cACA,cACA,QACA,QACA,QACA,QACA,WACA,WACA,YACA,eACA,aACA,aACA,OACA,aACA,cACA,YACA,SACA,QACA,UACA,WACA,OACA,OACA,UACA,WACA,SACA,aACA,SACA,UACA,UACA,SACA,QACA,QACA,SACA,aACA,YACA,QACA,QACA,cACA,UACA,WACA,cACA,SACA,WACA,OACA,SACA,OACA,SACA,WACA,QACA,QACA,UACA,aACA,SACA,WACA,MACA,QACA,YACA,UACA,OACA,UACA,OACA,WACA,OACA,QACA,UACA,QACA,OACA,SACA,WACA,SACA,OACA,UACA,SACA,cACA,YACA,UAGIC,EAAQ,CACZ,QACA,OACA,QACA,WACA,QACA,OACA,SACA,QACA,YACA,SACA,eACA,WACA,QACA,SACA,WACA,QACA,SACA,UACA,OACA,SACA,SACA,UACA,OACA,OACA,OACA,QACA,OACA,QACA,YACA,SACA,OACA,SACA,SACA,WACA,YACA,cACA,SACA,YACA,SACA,U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","file":"assets/js/link-6540b4027593d1f54fe2.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t7: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"assets/js/\" + ({}[chunkId]||chunkId) + \"-\" + {}[chunkId] + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// The chunk loading function for additional chunks\n \t// Since all referenced chunks are already included\n \t// in this file, this function is empty here.\n \t__webpack_require__.e = function requireEnsure() {\n \t\treturn Promise.resolve();\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/custom-hubs-template/\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([1416,1,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import { detectOS } from \"detect-browser\";\n\nexport function disableiOSZoom() {\n  if (detectOS(navigator.userAgent) !== \"iOS\") return;\n\n  let lastTouchAtMs = 0;\n\n  document.addEventListener(\"touchmove\", ev => {\n    if (ev.scale === 1) return;\n\n    ev.preventDefault();\n  });\n\n  document.addEventListener(\"touchend\", ev => {\n    const now = new Date().getTime();\n    const isDoubleTouch = now - lastTouchAtMs <= 300;\n    lastTouchAtMs = now;\n\n    if (isDoubleTouch) {\n      ev.preventDefault();\n    }\n  });\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { IntlProvider, FormattedMessage, addLocaleData } from \"react-intl\";\nimport en from \"react-intl/locale-data/en\";\n\nimport configs from \"../utils/configs\";\nimport { lang, messages } from \"../utils/i18n\";\nimport classNames from \"classnames\";\nimport styles from \"../assets/stylesheets/link.scss\";\nimport { disableiOSZoom } from \"../utils/disable-ios-zoom\";\nimport HeadsetIcon from \"../assets/images/generic_vr_headset.svg\";\n\nconst MAX_DIGITS = 6;\nconst MAX_LETTERS = 4;\n\naddLocaleData([...en]);\ndisableiOSZoom();\nconst hasTouchEvents = \"ontouchstart\" in document.documentElement;\n\nclass LinkRoot extends Component {\n  static propTypes = {\n    intl: PropTypes.object,\n    store: PropTypes.object,\n    linkChannel: PropTypes.object\n  };\n\n  state = {\n    entered: \"\",\n    isAlphaMode: false,\n    failedAtLeastOnce: false\n  };\n\n  buttonRefs = {};\n\n  componentDidMount = () => {\n    document.addEventListener(\"keydown\", this.handleKeyDown);\n    this.attachTouchEvents();\n  };\n\n  attachTouchEvents = () => {\n    // https://github.com/facebook/react/issues/9809#issuecomment-413978405\n    if (hasTouchEvents) {\n      for (const [name, ref] of Object.entries(this.buttonRefs)) {\n        if (!ref) continue;\n        if (name === \"remove\") {\n          ref.ontouchstart = () => this.removeChar();\n        } else if (name === \"toggle\") {\n          ref.ontouchstart = () => this.toggleMode();\n        } else {\n          ref.ontouchstart = () => this.addToEntry(name);\n        }\n      }\n    }\n  };\n\n  componentDidUpdate = () => {\n    this.attachTouchEvents();\n  };\n\n  componentWillUnmount = () => {\n    document.removeEventListener(\"keydown\", this.handleKeyDown);\n  };\n\n  handleKeyDown = e => {\n    // Number keys 0-9\n    if ((e.keyCode < 48 || e.keyCode > 57) && !this.state.isAlphaMode) {\n      return;\n    }\n\n    // Alpha keys A-I\n    if ((e.keyCode < 65 || e.keyCode > 73) && this.state.isAlphaMode) {\n      return;\n    }\n\n    e.preventDefault();\n    e.stopPropagation();\n\n    if (this.state.isAlphaMode) {\n      this.addToEntry(\"IHGFEDCBA\"[73 - e.keyCode]);\n    } else {\n      this.addToEntry(e.keyCode - 48);\n    }\n  };\n\n  maxAllowedChars = () => {\n    return this.state.isAlphaMode ? MAX_LETTERS : MAX_DIGITS;\n  };\n\n  addToEntry = ch => {\n    if (this.state.entered.length >= this.maxAllowedChars()) return;\n    const newChars = `${this.state.entered}${ch}`;\n\n    this.setState({ entered: newChars }, () => {\n      if (this.state.entered.length === this.maxAllowedChars()) {\n        this.attemptLookup(this.state.entered);\n      }\n    });\n  };\n\n  removeChar = () => {\n    const entered = this.state.entered;\n    if (entered.length === 0) return;\n    this.setState({ entered: entered.substring(0, entered.length - 1) });\n  };\n\n  attemptLink = async code => {\n    this.props.linkChannel\n      .attemptLink(code)\n      .then(response => {\n        // If there is a profile from the linked device, copy it over if we don't have one yet.\n        if (response.profile) {\n          const { hasChangedName } = this.props.store.state.activity;\n\n          if (!hasChangedName) {\n            this.props.store.update({ activity: { hasChangedName: true }, profile: response.profile });\n          }\n        }\n        this.props.store.update({ credentials: response.credentials });\n\n        if (response.path) {\n          window.location.href = response.path;\n        }\n      })\n      .catch(e => {\n        this.setState({ failedAtLeastOnce: true, entered: \"\" });\n\n        if (!(e instanceof Error && (e.message === \"in_use\" || e.message === \"failed\"))) {\n          throw e;\n        }\n      });\n  };\n\n  attemptEntry = async code => {\n    const url = \"/link/\" + code;\n    const res = await fetch(url);\n\n    if (res.status >= 400) {\n      this.setState({ failedAtLeastOnce: true, entered: \"\" });\n    } else {\n      document.location = url;\n    }\n  };\n\n  attemptLookup = async code => {\n    if (this.state.isAlphaMode) {\n      // Headset link code\n      this.attemptLink(code);\n    } else {\n      // Room entry code\n      this.attemptEntry(code);\n    }\n  };\n\n  toggleMode = () => {\n    this.setState({ isAlphaMode: !this.state.isAlphaMode, entered: \"\", failedAtLeastOnce: false });\n  };\n\n  render() {\n    // Note we use type \"tel\" for the input due to https://bugzilla.mozilla.org/show_bug.cgi?id=1005603\n\n    return (\n      <IntlProvider locale={lang} messages={messages}>\n        <div className={styles.link}>\n          <div className={styles.linkContents}>\n            <a className={styles.logo} href=\"/\">\n              <img src={configs.image(\"logo\")} />\n            </a>\n            {this.state.entered.length === this.maxAllowedChars() && (\n              <div className={classNames(\"loading-panel\", styles.codeLoadingPanel)}>\n                <div className=\"loader-wrap\">\n                  <div className=\"loader\">\n                    <div className=\"loader-center\" />\n                  </div>\n                </div>\n              </div>\n            )}\n\n            <div className={styles.enteredContents}>\n              <div className={styles.header}>\n                <FormattedMessage\n                  id={\n                    this.state.failedAtLeastOnce\n                      ? \"link.try_again\"\n                      : \"link.link_page_header_\" + (!this.state.isAlphaMode ? \"entry\" : \"headset\")\n                  }\n                />\n              </div>\n\n              <div className={styles.entered}>\n                <input\n                  className={styles.charInput}\n                  type={this.state.isAlphaMode ? \"text\" : \"tel\"}\n                  pattern=\"[0-9A-I]*\"\n                  value={this.state.entered}\n                  onChange={ev => {\n                    if (!this.state.isAlphaMode && ev.target.value.match(/[a-z]/i)) {\n                      this.setState({ isAlphaMode: true });\n                    }\n\n                    this.setState({ entered: ev.target.value.toUpperCase() }, () => {\n                      if (this.state.entered.length === this.maxAllowedChars()) {\n                        this.attemptLookup(this.state.entered);\n                      }\n                    });\n                  }}\n                />\n              </div>\n\n              <div className={styles.enteredFooter}>\n                {!this.state.isAlphaMode && (\n                  <span>\n                    <a href=\"#\" onClick={() => this.toggleMode()}>\n                      <FormattedMessage id=\"link.linking_a_headset\" />\n                    </a>\n                  </span>\n                )}\n              </div>\n            </div>\n\n            <div className={styles.keypad}>\n              {(this.state.isAlphaMode\n                ? [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\"]\n                : [1, 2, 3, 4, 5, 6, 7, 8, 9]\n              ).map((d, i) => (\n                <button\n                  disabled={this.state.entered.length === this.maxAllowedChars()}\n                  className={styles.keypadButton}\n                  key={`char_${i}`}\n                  onClick={() => {\n                    if (!hasTouchEvents) this.addToEntry(d);\n                  }}\n                  ref={r => (this.buttonRefs[d.toString()] = r)}\n                >\n                  {d}\n                </button>\n              ))}\n              <button\n                className={classNames(styles.keypadButton, styles.keypadToggleMode)}\n                ref={r => (this.buttonRefs[\"toggle\"] = r)}\n                onClick={() => {\n                  if (!hasTouchEvents) this.toggleMode();\n                }}\n              >\n                {this.state.isAlphaMode ? \"123\" : \"ABC\"}\n              </button>\n              {!this.state.isAlphaMode && (\n                <button\n                  disabled={this.state.entered.length === this.maxAllowedChars()}\n                  className={classNames(styles.keypadButton, styles.keypadZeroButton)}\n                  ref={r => (this.buttonRefs[\"0\"] = r)}\n                  onClick={() => {\n                    if (!hasTouchEvents) this.addToEntry(0);\n                  }}\n                >\n                  0\n                </button>\n              )}\n              <button\n                disabled={this.state.entered.length === 0 || this.state.entered.length === this.maxAllowedChars()}\n                className={classNames(styles.keypadButton, styles.keypadBackspace)}\n                ref={r => (this.buttonRefs[\"remove\"] = r)}\n                onClick={() => {\n                  if (!hasTouchEvents) this.removeChar();\n                }}\n              >\n                \n              </button>\n            </div>\n\n            <div className={styles.footer}>\n              {!this.state.isAlphaMode && (\n                <div\n                  className={styles.linkHeadsetFooterLink}\n                  style={{ visibility: this.state.isAlphaMode ? \"hidden\" : \"visible\" }}\n                >\n                  <img onClick={() => this.toggleMode()} src={HeadsetIcon} className={styles.headsetIcon} />\n                  <span>\n                    <a href=\"#\" onClick={() => this.toggleMode()}>\n                      <FormattedMessage id=\"link.linking_a_headset\" />\n                    </a>\n                  </span>\n                </div>\n              )}\n            </div>\n            <div className={styles.createLink}>\n              <a href=\"/\">\n                <FormattedMessage id=\"link.create_a_room\" />\n              </a>\n            </div>\n          </div>\n        </div>\n      </IntlProvider>\n    );\n  }\n}\n\nexport default LinkRoot;\n","import \"./webxr-bypass-hacks\";\nimport \"./utils/theme\";\nimport \"./utils/configs\";\nimport \"./assets/stylesheets/link.scss\";\nimport \"aframe\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport registerTelemetry from \"./telemetry\";\nimport LinkRoot from \"./react-components/link-root\";\nimport LinkChannel from \"./utils/link-channel\";\nimport { connectToReticulum } from \"./utils/phoenix-utils\";\nimport Store from \"./storage/store\";\n\nregisterTelemetry(\"/link\", \"Hubs Device Link\");\n\nconst store = new Store();\n\nconst linkChannel = new LinkChannel(store);\n\n(async () => {\n  const socket = await connectToReticulum();\n  linkChannel.setSocket(socket);\n})();\n\nReactDOM.render(<LinkRoot store={store} linkChannel={linkChannel} />, document.getElementById(\"link-root\"));\n","export const waitForEvent = function(eventName, eventObj) {\n  return new Promise(resolve => {\n    eventObj.addEventListener(eventName, resolve, { once: true });\n  });\n};\n\nexport const waitForDOMContentLoaded = function() {\n  if (document.readyState === \"complete\" || document.readyState === \"loaded\" || document.readyState === \"interactive\") {\n    return Promise.resolve(null);\n  } else {\n    return waitForEvent(\"DOMContentLoaded\", window);\n  }\n};\n","import configs from \"./configs\";\nimport localeData from \"../assets/translations.data.json\";\n\nconst navigatorLang = ((navigator.languages && navigator.languages[0]) || navigator.language || navigator.userLanguage)\n  .toLowerCase()\n  .split(/[_-]+/)[0];\nexport const lang = (localeData[navigatorLang] && navigatorLang) || \"en\";\n\nconst _messages = localeData[lang] || localeData.en;\n\nif (configs.APP_CONFIG && configs.APP_CONFIG.translations && configs.APP_CONFIG.translations[lang]) {\n  const configTranslations = configs.APP_CONFIG.translations[lang];\n  for (const messageKey in configTranslations) {\n    if (!configTranslations.hasOwnProperty(messageKey)) continue;\n    if (!configTranslations[messageKey]) continue;\n    _messages[messageKey] = configTranslations[messageKey];\n  }\n}\n\nexport const messages = Object.entries(_messages)\n  .map(([key, message]) => [\n    key,\n    // Replace nested message keys (e.g. %app-name%) with their messages.\n    message.replace(/%([\\w-.]+)%/i, (_match, subkey) => _messages[subkey])\n  ])\n  .reduce((acc, entry) => {\n    acc[entry[0]] = entry[1];\n    return acc;\n  }, {});\n","/*\nHACK Fix a-frame's device detection in Chrome when WebXR or WebVR flags are enabled in\nchrome://flags. See https://github.com/mozilla/hubs/issues/892\n*/\nif (!/Oculus/.test(navigator.userAgent) && navigator.xr && !navigator.xr.requestDevice) {\n  navigator.xr.requestDevice = () => Promise.reject({ message: \"Hubs: requestDevice not supported.\" });\n}\n/*\nHACK Call getVRDisplays to force Oculus Browser to use WebVR, which in turn disables the WebXR API.\n*/\nif (/Oculus/.test(navigator.userAgent)) {\n  navigator.getVRDisplays();\n}\n","// NOTE: We do not use an IV since we generate a new keypair each time we use these routines.\n\nasync function deriveKey(privateKey, publicKey) {\n  return crypto.subtle.deriveKey(\n    { name: \"ECDH\", public: publicKey },\n    privateKey,\n    { name: \"AES-CBC\", length: 256 },\n    true,\n    [\"encrypt\", \"decrypt\"]\n  );\n}\n\nasync function publicKeyToString(key) {\n  return JSON.stringify(await crypto.subtle.exportKey(\"jwk\", key));\n}\n\nasync function stringToPublicKey(s) {\n  return await crypto.subtle.importKey(\"jwk\", JSON.parse(s), { name: \"ECDH\", namedCurve: \"P-256\" }, true, []);\n}\n\nfunction stringToArrayBuffer(s) {\n  const buf = new Uint8Array(s.length);\n\n  for (let i = 0; i < s.length; i++) {\n    buf[i] = s.charCodeAt(i);\n  }\n\n  return buf;\n}\n\nfunction arrayBufferToString(b) {\n  const buf = new Uint8Array(b);\n  let s = \"\";\n\n  for (let i = 0; i < buf.byteLength; i++) {\n    s += String.fromCharCode(buf[i]);\n  }\n\n  return s;\n}\n\n// This allows a single object to be passed encrypted from a receiver in a req -> response flow\n\n// Requestor generates a public key and private key, and should send the public key to receiver.\nexport async function generateKeys() {\n  const keyPair = await crypto.subtle.generateKey({ name: \"ECDH\", namedCurve: \"P-256\" }, true, [\"deriveKey\"]);\n  const publicKeyString = await publicKeyToString(keyPair.publicKey);\n  return { publicKeyString, privateKey: keyPair.privateKey };\n}\n\n// Receiver takes the public key from requestor and passes obj to get a response public key and the encrypted data to return.\nexport async function generatePublicKeyAndEncryptedObject(incomingPublicKeyString, obj) {\n  const iv = new Uint8Array(16);\n  const incomingPublicKey = await stringToPublicKey(incomingPublicKeyString);\n  const keyPair = await crypto.subtle.generateKey({ name: \"ECDH\", namedCurve: \"P-256\" }, true, [\"deriveKey\"]);\n  const publicKeyString = await publicKeyToString(keyPair.publicKey);\n  const secret = await deriveKey(keyPair.privateKey, incomingPublicKey);\n\n  const encryptedData = btoa(\n    arrayBufferToString(\n      await crypto.subtle.encrypt({ name: \"AES-CBC\", iv }, secret, stringToArrayBuffer(JSON.stringify(obj)))\n    )\n  );\n\n  return { publicKeyString, encryptedData };\n}\n\n// Requestor then takes the receiver's public key, the private key (returned from generateKeys()), and the data from the receiver.\nexport async function decryptObject(publicKeyString, privateKey, base64value) {\n  const iv = new Uint8Array(16);\n  const publicKey = await stringToPublicKey(publicKeyString);\n  const secret = await deriveKey(privateKey, publicKey);\n  const ciphertext = stringToArrayBuffer(atob(base64value));\n  const data = await crypto.subtle.decrypt({ name: \"AES-CBC\", iv }, secret, ciphertext);\n  return JSON.parse(arrayBufferToString(data));\n}\n","import { generatePublicKeyAndEncryptedObject, generateKeys, decryptObject } from \"./crypto\";\n\nconst LINK_ACTION_TIMEOUT = 10000;\n\nexport default class LinkChannel {\n  constructor(store) {\n    this.store = store;\n  }\n\n  setSocket = socket => {\n    this.socket = socket;\n  };\n\n  // Returns a promise that, when resolved, will forward an object with three keys:\n  //\n  // code: The code that was made available to use for link.\n  //\n  // cancel: A function that the caller can call to cancel the use of the code.\n  //\n  // onFinished: A promise that, when resolved, indicates the code is no longer usable,\n  // because it was either successfully used by the remote device or it has expired\n  // (\"used\" or \"expired\" is passed to the callback).\n  generateCode = () => {\n    return new Promise(resolve => {\n      const onFinished = new Promise(finished => {\n        const step = () => {\n          const getLetter = () => \"ABCDEFGHI\"[Math.floor(Math.random() * 9)];\n          const code = `${getLetter()}${getLetter()}${getLetter()}${getLetter()}`;\n\n          // Only respond to one link_request in this channel.\n          let readyToSend = false;\n          let leftChannel = false;\n\n          const channel = this.socket.channel(`link:${code}`, { timeout: LINK_ACTION_TIMEOUT });\n\n          const leave = () => {\n            if (!leftChannel) channel.leave();\n            leftChannel = true;\n          };\n\n          const cancel = () => leave();\n\n          channel.on(\"link_expired\", () => finished(\"expired\"));\n\n          channel.on(\"presence_state\", state => {\n            if (readyToSend) return;\n\n            if (Object.keys(state).length > 0) {\n              // Code is in use by someone else, try a new one\n              step();\n            } else {\n              readyToSend = true;\n              resolve({ code, cancel, onFinished });\n            }\n          });\n\n          channel.on(\"link_request\", incoming => {\n            if (readyToSend) {\n              const data = { path: location.pathname };\n\n              // Copy profile data to link'ed device if it's been set.\n              if (this.store.state.activity.hasChangedName) {\n                data.profile = { ...this.store.state.profile };\n              }\n              data.credentials = { ...this.store.state.credentials };\n\n              generatePublicKeyAndEncryptedObject(incoming.public_key, data).then(\n                ({ publicKeyString, encryptedData }) => {\n                  const payload = {\n                    target_session_id: incoming.reply_to_session_id,\n                    public_key: publicKeyString,\n                    data: encryptedData\n                  };\n\n                  if (!leftChannel) {\n                    channel.push(\"link_response\", payload);\n                  }\n\n                  leave();\n\n                  finished(\"used\");\n                  readyToSend = false;\n                }\n              );\n            }\n          });\n\n          channel.join().receive(\"error\", r => console.error(r));\n        };\n\n        step();\n      });\n    });\n  };\n\n  // Attempts to receive a link payload from a remote device using the given code.\n  //\n  // Promise rejects if the code is invalid or there is a problem with the channel.\n  // Promise resolves and passes payload of link source on successful link.\n  attemptLink = code => {\n    return new Promise((resolve, reject) => {\n      const channel = this.socket.channel(`link:${code}`, { timeout: LINK_ACTION_TIMEOUT });\n      let finished = false;\n\n      generateKeys().then(({ publicKeyString, privateKey }) => {\n        channel.on(\"presence_state\", state => {\n          const numOccupants = Object.keys(state).length;\n\n          if (numOccupants === 1) {\n            // Great, only sender is in topic, request link\n            channel.push(\"link_request\", {\n              reply_to_session_id: this.socket.params().session_id,\n              public_key: publicKeyString\n            });\n\n            setTimeout(() => {\n              if (finished) return;\n              channel.leave();\n              reject(new Error(\"no_response\"));\n            }, LINK_ACTION_TIMEOUT);\n          } else if (numOccupants === 0) {\n            // Nobody in this channel, probably a bad code.\n            channel.leave();\n            reject(new Error(\"failed\"));\n          } else {\n            console.warn(\"link code channel already has 2 or more occupants, something fishy is going on.\");\n            channel.leave();\n            reject(new Error(\"in_use\"));\n          }\n        });\n\n        channel.on(\"link_response\", payload => {\n          finished = true;\n          channel.leave();\n\n          decryptObject(payload.public_key, privateKey, payload.data).then(resolve);\n        });\n\n        channel\n          .join()\n          .receive(\"ok\", data => (this.socket.params().session_id = data.session_id))\n          .receive(\"error\", r => console.error(r));\n      });\n    });\n  };\n}\n","import appLogo from \"../assets/images/app-logo.png\";\nimport companyLogo from \"../assets/images/company-logo.png\";\nimport sceneEditorLogo from \"../assets/images/editor-logo.png\";\nimport pdfjs from \"pdfjs-dist\";\n\n// Read configs from global variable if available, otherwise use the process.env injected from build.\nconst configs = {};\nlet isAdmin = false;\n\n[\n  \"RETICULUM_SERVER\",\n  \"THUMBNAIL_SERVER\",\n  \"CORS_PROXY_SERVER\",\n  \"NON_CORS_PROXY_DOMAINS\",\n  \"SENTRY_DSN\",\n  \"GA_TRACKING_ID\",\n  \"SHORTLINK_DOMAIN\",\n  \"BASE_ASSETS_PATH\"\n].forEach(x => {\n  const el = document.querySelector(`meta[name='env:${x.toLowerCase()}']`);\n  configs[x] = el ? el.getAttribute(\"content\") : process.env[x];\n\n  if (x === \"BASE_ASSETS_PATH\" && configs[x]) {\n    // eslint-disable-next-line no-undef\n    __webpack_public_path__ = configs[x];\n\n    // Using external CDN to reduce build size\n    pdfjs.GlobalWorkerOptions.workerSrc = `${configs[x]}../assets/js/pdfjs-dist@2.1.266/build/pdf.worker.js`;\n  }\n});\n\n// Also include configs that reticulum injects as a script in the page head.\n\nconfigs.AVAILABLE_INTEGRATIONS = window.AVAILABLE_INTEGRATIONS || {};\n\nif (window.APP_CONFIG) {\n  configs.APP_CONFIG = window.APP_CONFIG;\n  const { theme } = configs.APP_CONFIG;\n  if (theme) {\n    const colorVars = [];\n    for (const key in theme) {\n      if (!theme.hasOwnProperty(key)) continue;\n      colorVars.push(`--${key}: ${theme[key]};`);\n    }\n    const style = document.createElement(\"style\");\n    style.innerHTML = `:root{${colorVars.join(\"\\n\")}}`;\n    document.head.prepend(style);\n  }\n\n  if (!configs.APP_CONFIG.features) {\n    configs.APP_CONFIG.features = {};\n  }\n} else {\n  configs.APP_CONFIG = {\n    features: {}\n  };\n}\n\nconst isLocalDevelopment = process.env.NODE_ENV === \"development\";\n\nconfigs.feature = featureName => {\n  const value = configs.APP_CONFIG.features[featureName];\n  if (typeof value === \"boolean\") {\n    const enableAll = isLocalDevelopment && !process.env.USE_FEATURE_CONFIG;\n    const forceEnableSpoke = featureName === \"enable_spoke\" && isAdmin;\n    return forceEnableSpoke || enableAll || value;\n  } else {\n    return value;\n  }\n};\n\nlet localDevImages = {};\nif (isLocalDevelopment) {\n  localDevImages = {\n    logo: appLogo,\n    company_logo: companyLogo,\n    editor_logo: sceneEditorLogo\n  };\n}\n\nconfigs.image = (imageName, cssUrl) => {\n  const url =\n    (configs.APP_CONFIG && configs.APP_CONFIG.images && configs.APP_CONFIG.images[imageName]) ||\n    localDevImages[imageName];\n  return url && cssUrl ? `url(${url})` : url;\n};\n\nconfigs.link = (linkName, defaultValue) => {\n  return (configs.APP_CONFIG && configs.APP_CONFIG.links && configs.APP_CONFIG.links[linkName]) || defaultValue;\n};\n\nconfigs.setIsAdmin = _isAdmin => {\n  isAdmin = _isAdmin;\n};\nconfigs.isAdmin = () => isAdmin;\n\nexport default configs;\n","import { fetchReticulumAuthenticated } from \"./phoenix-utils\";\nimport ducky from \"../assets/models/DuckyMesh.glb\";\n\nconst names = [\n  \"Baers-Pochard\",\n  \"Baikal-Teal\",\n  \"Barrows-Goldeneye\",\n  \"Blue-Billed\",\n  \"Blue-Duck\",\n  \"Blue-Winged\",\n  \"Brown-Teal\",\n  \"Bufflehead\",\n  \"Canvasback\",\n  \"Cape-Shoveler\",\n  \"Chestnut-Teal\",\n  \"Chiloe-Wigeon\",\n  \"Cinnamon-Teal\",\n  \"Comb-Duck\",\n  \"Common-Eider\",\n  \"Common-Goldeneye\",\n  \"Common-Merganser\",\n  \"Common-Pochard\",\n  \"Common-Scoter\",\n  \"Common-Shelduck\",\n  \"Cotton-Pygmy\",\n  \"Crested-Duck\",\n  \"Crested-Shelduck\",\n  \"Eatons-Pintail\",\n  \"Falcated\",\n  \"Ferruginous\",\n  \"Freckled-Duck\",\n  \"Gadwall\",\n  \"Garganey\",\n  \"Greater-Scaup\",\n  \"Green-Pygmy\",\n  \"Grey-Teal\",\n  \"Hardhead\",\n  \"Harlequin\",\n  \"Hartlaubs\",\n  \"Hooded-Merganser\",\n  \"Hottentot-Teal\",\n  \"Kelp-Goose\",\n  \"King-Eider\",\n  \"Lake-Duck\",\n  \"Laysan-Duck\",\n  \"Lesser-Scaup\",\n  \"Long-Tailed\",\n  \"Maccoa-Duck\",\n  \"Mallard\",\n  \"Mandarin\",\n  \"Marbled-Teal\",\n  \"Mellers-Duck\",\n  \"Merganser\",\n  \"Northern-Pintail\",\n  \"Orinoco-Goose\",\n  \"Paradise-Shelduck\",\n  \"Plumed-Whistler\",\n  \"Puna-Teal\",\n  \"Pygmy-Goose\",\n  \"Radjah-Shelduck\",\n  \"Red-Billed\",\n  \"Red-Crested\",\n  \"Red-Shoveler\",\n  \"Ring-Necked\",\n  \"Ringed-Teal\",\n  \"Rosy-Billed\",\n  \"Ruddy-Shelduck\",\n  \"Salvadoris-Teal\",\n  \"Scaly-Sided\",\n  \"Shelduck\",\n  \"Shoveler\",\n  \"Silver-Teal\",\n  \"Smew\",\n  \"Spectacled-Eider\",\n  \"Spot-Billed\",\n  \"Spotted-Whistler\",\n  \"Steamerduck\",\n  \"Stellers-Eider\",\n  \"Sunda-Teal\",\n  \"Surf-Scoter\",\n  \"Tufted-Duck\",\n  \"Velvet-Scoter\",\n  \"Wandering-Whistler\",\n  \"Whistling-duck\",\n  \"White-Backed\",\n  \"White-Cheeked\",\n  \"White-Winged\",\n  \"Wigeon\",\n  \"Wood-Duck\",\n  \"Yellow-Billed\"\n];\n\nfunction chooseRandom(arr) {\n  return arr[Math.floor(Math.random() * arr.length)];\n}\n\nexport function generateRandomName() {\n  return `${chooseRandom(names)}-${Math.floor(10000 + Math.random() * 10000)}`;\n}\n\nexport async function fetchRandomDefaultAvatarId() {\n  const defaultAvatarEndpoint = \"/api/v1/media/search?filter=default&source=avatar_listings\";\n  const defaultAvatars = (await fetchReticulumAuthenticated(defaultAvatarEndpoint)).entries;\n  if (defaultAvatars.length === 0) {\n    // If reticulum doesn't return any default avatars, just default to the duck model. This should only happen\n    // when running against a fresh reticulum server, e.g. a local ret instance.\n    return new URL(ducky, location.href).href;\n  }\n  const avatarIds = defaultAvatars.map(avatar => avatar.id);\n  return chooseRandom(avatarIds);\n}\n","import { Validator } from \"jsonschema\";\nimport merge from \"deepmerge\";\nimport Cookies from \"js-cookie\";\nimport jwtDecode from \"jwt-decode\";\n\nconst LOCAL_STORE_KEY = \"___hubs_store\";\nconst STORE_STATE_CACHE_KEY = Symbol();\nconst OAUTH_FLOW_CREDENTIALS_KEY = \"ret-oauth-flow-account-credentials\";\nconst validator = new Validator();\nimport { EventTarget } from \"event-target-shim\";\nimport { fetchRandomDefaultAvatarId, generateRandomName } from \"../utils/identity.js\";\n\n// Durable (via local-storage) schema-enforced state that is meant to be consumed via forward data flow.\n// (Think flux but with way less incidental complexity, at least for now :))\nexport const SCHEMA = {\n  id: \"/HubsStore\",\n\n  definitions: {\n    profile: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        displayName: { type: \"string\", pattern: \"^[A-Za-z0-9 -]{3,32}$\" },\n        avatarId: { type: \"string\" },\n        // personalAvatarId is obsolete, but we need it here for backwards compatibility.\n        personalAvatarId: { type: \"string\" }\n      }\n    },\n\n    credentials: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        token: { type: [\"null\", \"string\"] },\n        email: { type: [\"null\", \"string\"] }\n      }\n    },\n\n    activity: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        hasFoundFreeze: { type: \"boolean\" },\n        hasChangedName: { type: \"boolean\" },\n        hasAcceptedProfile: { type: \"boolean\" },\n        lastEnteredAt: { type: \"string\" },\n        hasPinned: { type: \"boolean\" },\n        hasRotated: { type: \"boolean\" },\n        hasRecentered: { type: \"boolean\" },\n        hasScaled: { type: \"boolean\" },\n        hasHoveredInWorldHud: { type: \"boolean\" },\n        hasOpenedShare: { type: \"boolean\" },\n        entryCount: { type: \"number\" }\n      }\n    },\n\n    settings: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        lastUsedMicDeviceId: { type: \"string\" }\n      }\n    },\n\n    preferences: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        muteMicOnEntry: { type: \"bool\" },\n        enableOnScreenJoystickLeft: { type: \"bool\" },\n        enableOnScreenJoystickRight: { type: \"bool\" },\n        onlyShowNametagsInFreeze: { type: \"bool\" },\n        allowMultipleHubsInstances: { type: \"bool\" },\n        maxResolutionWidth: { type: \"number\" },\n        maxResolutionHeight: { type: \"number\" },\n        globalVoiceVolume: { type: \"number\" },\n        globalMediaVolume: { type: \"number\" },\n        snapRotationDegrees: { type: \"number\" },\n        materialQualitySetting: { type: \"string\" },\n        disableMovement: { type: \"bool\" },\n        disableBackwardsMovement: { type: \"bool\" },\n        disableStrafing: { type: \"bool\" },\n        disableTeleporter: { type: \"bool\" }\n      }\n    },\n\n    // Legacy\n    confirmedDiscordRooms: {\n      type: \"array\",\n      items: { type: \"string\" }\n    },\n\n    confirmedBroadcastedRooms: {\n      type: \"array\",\n      items: { type: \"string\" }\n    },\n\n    uploadPromotionTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          fileId: { type: \"string\" },\n          promotionToken: { type: \"string\" }\n        }\n      }\n    },\n\n    creatorAssignmentTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          hubId: { type: \"string\" },\n          creatorAssignmentToken: { type: \"string\" }\n        }\n      }\n    },\n\n    embedTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          hubId: { type: \"string\" },\n          embedToken: { type: \"string\" }\n        }\n      }\n    },\n\n    onLoadActions: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          action: { type: \"string\" },\n          args: { type: \"object\" }\n        }\n      }\n    }\n  },\n\n  type: \"object\",\n\n  properties: {\n    profile: { $ref: \"#/definitions/profile\" },\n    credentials: { $ref: \"#/definitions/credentials\" },\n    activity: { $ref: \"#/definitions/activity\" },\n    settings: { $ref: \"#/definitions/settings\" },\n    preferences: { $ref: \"#/definitions/preferences\" },\n    confirmedDiscordRooms: { $ref: \"#/definitions/confirmedDiscordRooms\" }, // Legacy\n    confirmedBroadcastedRooms: { $ref: \"#/definitions/confirmedBroadcastedRooms\" },\n    uploadPromotionTokens: { $ref: \"#/definitions/uploadPromotionTokens\" },\n    creatorAssignmentTokens: { $ref: \"#/definitions/creatorAssignmentTokens\" },\n    embedTokens: { $ref: \"#/definitions/embedTokens\" },\n    onLoadActions: { $ref: \"#/definitions/onLoadActions\" }\n  },\n\n  additionalProperties: false\n};\n\nexport default class Store extends EventTarget {\n  constructor() {\n    super();\n\n    if (localStorage.getItem(LOCAL_STORE_KEY) === null) {\n      localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify({}));\n    }\n\n    // When storage is updated in another window\n    window.addEventListener(\"storage\", e => {\n      if (e.key !== LOCAL_STORE_KEY) return;\n      delete this[STORE_STATE_CACHE_KEY];\n      this.dispatchEvent(new CustomEvent(\"statechanged\"));\n    });\n\n    this.update({\n      activity: {},\n      settings: {},\n      credentials: {},\n      profile: {},\n      confirmedDiscordRooms: [],\n      confirmedBroadcastedRooms: [],\n      uploadPromotionTokens: [],\n      creatorAssignmentTokens: [],\n      embedTokens: [],\n      onLoadActions: [],\n      preferences: {}\n    });\n\n    this._shouldResetAvatarOnInit = false;\n\n    const oauthFlowCredentials = Cookies.getJSON(OAUTH_FLOW_CREDENTIALS_KEY);\n    if (oauthFlowCredentials) {\n      this.update({ credentials: oauthFlowCredentials });\n      this._shouldResetAvatarOnInit = true;\n      Cookies.remove(OAUTH_FLOW_CREDENTIALS_KEY);\n    }\n\n    this._signOutOnExpiredAuthToken();\n  }\n\n  _signOutOnExpiredAuthToken = () => {\n    if (!this.state.credentials.token) return;\n\n    const expiry = jwtDecode(this.state.credentials.token).exp * 1000;\n    if (expiry <= Date.now()) {\n      this.update({ credentials: { token: null, email: null } });\n    }\n  };\n\n  initProfile = async () => {\n    if (this._shouldResetAvatarOnInit) {\n      await this.resetToRandomDefaultAvatar();\n    } else {\n      this.update({\n        profile: { avatarId: await fetchRandomDefaultAvatarId(), ...(this.state.profile || {}) }\n      });\n    }\n\n    // Regenerate name to encourage users to change it.\n    if (!this.state.activity.hasChangedName) {\n      this.update({ profile: { displayName: generateRandomName() } });\n    }\n  };\n\n  resetToRandomDefaultAvatar = async () => {\n    this.update({\n      profile: { ...(this.state.profile || {}), avatarId: await fetchRandomDefaultAvatarId() }\n    });\n  };\n\n  get state() {\n    if (!this.hasOwnProperty(STORE_STATE_CACHE_KEY)) {\n      this[STORE_STATE_CACHE_KEY] = JSON.parse(localStorage.getItem(LOCAL_STORE_KEY));\n    }\n\n    return this[STORE_STATE_CACHE_KEY];\n  }\n\n  get credentialsAccountId() {\n    if (this.state.credentials.token) {\n      return jwtDecode(this.state.credentials.token).sub;\n    } else {\n      return null;\n    }\n  }\n\n  resetConfirmedBroadcastedRooms() {\n    this.clearStoredArray(\"confirmedBroadcastedRooms\");\n  }\n\n  resetTipActivityFlags() {\n    this.update({\n      activity: { hasRotated: false, hasPinned: false, hasRecentered: false, hasScaled: false, entryCount: 0 }\n    });\n  }\n\n  bumpEntryCount() {\n    const currentEntryCount = this.state.activity.entryCount || 0;\n    this.update({ activity: { entryCount: currentEntryCount + 1 } });\n  }\n\n  // Sets a one-time action to perform the next time the page loads\n  enqueueOnLoadAction(action, args) {\n    this.update({ onLoadActions: [{ action, args }] });\n  }\n\n  executeOnLoadActions(sceneEl) {\n    for (let i = 0; i < this.state.onLoadActions.length; i++) {\n      const { action, args } = this.state.onLoadActions[i];\n\n      if (action === \"emit_scene_event\") {\n        sceneEl.emit(args.event, args.detail);\n      }\n    }\n\n    this.clearOnLoadActions();\n  }\n\n  clearOnLoadActions() {\n    this.clearStoredArray(\"onLoadActions\");\n  }\n\n  clearStoredArray(key) {\n    const overwriteMerge = (destinationArray, sourceArray) => sourceArray;\n    const update = {};\n    update[key] = [];\n\n    this.update(update, { arrayMerge: overwriteMerge });\n  }\n\n  update(newState, mergeOpts) {\n    const finalState = merge(this.state, newState, mergeOpts);\n    const { valid } = validator.validate(finalState, SCHEMA);\n\n    if (!valid) {\n      // Intentionally not including details about the state or validation result here, since we don't want to leak\n      // sensitive data in the error message.\n      throw new Error(`Write to store failed schema validation.`);\n    }\n\n    localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify(finalState));\n    delete this[STORE_STATE_CACHE_KEY];\n\n    if (newState.profile !== undefined) {\n      this.dispatchEvent(new CustomEvent(\"profilechanged\"));\n    }\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    return finalState;\n  }\n}\n","module.exports = __webpack_public_path__ + \"assets/images/app-logo-157c06cff6c80227eb577f35c79e58b6.png\";","module.exports = __webpack_public_path__ + \"assets/images/company-logo-8f6f7c3b303004256295b45c2eee5117.png\";","module.exports = __webpack_public_path__ + \"assets/images/editor-logo-6f885a1543496ebc23a21b7fea82b255.png\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"keypad-button\":\"link__keypad-button__2ElvK\",\"keypadButton\":\"link__keypad-button__2ElvK\",\"entered\":\"link__entered__1NNNd\",\"char-input\":\"link__char-input__3Uver\",\"charInput\":\"link__char-input__3Uver\",\"loading-text\":\"link__loading-text__2VpEE\",\"loadingText\":\"link__loading-text__2VpEE\",\"logo\":\"link__logo__dzO36\",\"link\":\"link__link__3kJ6B\",\"link-contents\":\"link__link-contents__3L1rY\",\"linkContents\":\"link__link-contents__3L1rY\",\"entered-footer\":\"link__entered-footer__2Oi0C\",\"enteredFooter\":\"link__entered-footer__2Oi0C\",\"entered-contents\":\"link__entered-contents__2ZmCP\",\"enteredContents\":\"link__entered-contents__2ZmCP\",\"create-link\":\"link__create-link__9JPd4\",\"createLink\":\"link__create-link__9JPd4\",\"code-loading-panel\":\"link__code-loading-panel__21IQD\",\"codeLoadingPanel\":\"link__code-loading-panel__21IQD\",\"entry-footer-image\":\"link__entry-footer-image__1XOeK\",\"entryFooterImage\":\"link__entry-footer-image__1XOeK\",\"footer-image\":\"link__footer-image__AsDh-\",\"footerImage\":\"link__footer-image__AsDh-\",\"header\":\"link__header__ID1fV\",\"footer\":\"link__footer__DERRP\",\"keypad\":\"link__keypad__1FVTF\",\"keypad-backspace\":\"link__keypad-backspace__M4x5m\",\"keypadBackspace\":\"link__keypad-backspace__M4x5m\",\"keypad-toggle-mode\":\"link__keypad-toggle-mode__2sIRG\",\"keypadToggleMode\":\"link__keypad-toggle-mode__2sIRG\",\"char\":\"link__char__20D9j\",\"headset-icon\":\"link__headset-icon__22_kp\",\"headsetIcon\":\"link__headset-icon__22_kp\",\"link-headset-footer-link\":\"link__link-headset-footer-link__pGQB8\",\"linkHeadsetFooterLink\":\"link__link-headset-footer-link__pGQB8\"};","import Raven from \"raven-js\";\nimport configs from \"./utils/configs\";\n\nconst ga = window.ga;\n\nexport default function registerTelemetry(trackedPage, trackedTitle) {\n  const sentryDsn = configs.SENTRY_DSN;\n  const gaTrackingId = configs.GA_TRACKING_ID;\n\n  if (sentryDsn) {\n    console.log(\"Tracking: Sentry DSN: \" + sentryDsn);\n    Raven.config(sentryDsn).install();\n  }\n\n  if (ga && gaTrackingId) {\n    console.log(\"Tracking: Google Analytics ID: \" + gaTrackingId);\n\n    ga(\"create\", gaTrackingId, \"auto\");\n\n    if (trackedPage) {\n      ga(\"set\", \"page\", trackedPage);\n    }\n\n    if (trackedTitle) {\n      ga(\"set\", \"title\", trackedTitle);\n    }\n\n    ga(\"send\", \"pageview\");\n  }\n}\n","module.exports = __webpack_public_path__ + \"assets/images/generic_vr_headset-6cb5c6205420ac7e9c3ca3e0c0a6db2c.svg\";","module.exports = __webpack_public_path__ + \"assets/models/DuckyMesh-04f978955fb12d48f7ff8c59a05de439.glb\";","const adjectives = [\n  \"able\",\n  \"absolute\",\n  \"acceptable\",\n  \"acclaimed\",\n  \"accomplished\",\n  \"accurate\",\n  \"aching\",\n  \"acrobatic\",\n  \"adorable\",\n  \"adventurous\",\n  \"basic\",\n  \"belated\",\n  \"beloved\",\n  \"calm\",\n  \"candid\",\n  \"capital\",\n  \"carefree\",\n  \"caring\",\n  \"cautious\",\n  \"celebrated\",\n  \"charming\",\n  \"daring\",\n  \"darling\",\n  \"dearest\",\n  \"each\",\n  \"eager\",\n  \"early\",\n  \"earnest\",\n  \"easy\",\n  \"easygoing\",\n  \"ecstatic\",\n  \"edible\",\n  \"fabulous\",\n  \"fair\",\n  \"faithful\",\n  \"familiar\",\n  \"famous\",\n  \"fancy\",\n  \"fantastic\",\n  \"far\",\n  \"generous\",\n  \"gentle\",\n  \"genuine\",\n  \"giant\",\n  \"handmade\",\n  \"handsome\",\n  \"handy\",\n  \"happy\",\n  \"icy\",\n  \"ideal\",\n  \"identical\",\n  \"keen\",\n  \"lasting\",\n  \"lavish\",\n  \"magnificent\",\n  \"majestic\",\n  \"mammoth\",\n  \"marvelous\",\n  \"natural\",\n  \"obedient\",\n  \"palatable\",\n  \"parched\",\n  \"passionate\",\n  \"pastel\",\n  \"peaceful\",\n  \"perfect\",\n  \"perfumed\",\n  \"quaint\",\n  \"qualified\",\n  \"radiant\",\n  \"rapid\",\n  \"rare\",\n  \"safe\",\n  \"sandy\",\n  \"satisfied\",\n  \"scaly\",\n  \"scarce\",\n  \"scared\",\n  \"scary\",\n  \"scented\",\n  \"scientific\",\n  \"secret\",\n  \"sentimental\",\n  \"talkative\",\n  \"tangible\",\n  \"tart\",\n  \"tasty\",\n  \"tattered\",\n  \"teeming\",\n  \"ultimate\",\n  \"uncommon\",\n  \"unconscious\",\n  \"understated\",\n  \"warm\",\n  \"active\",\n  \"adept\",\n  \"admirable\",\n  \"admired\",\n  \"adorable\",\n  \"adored\",\n  \"advanced\",\n  \"affectionate\",\n  \"beneficial\",\n  \"best\",\n  \"better\",\n  \"big\",\n  \"cheerful\",\n  \"cheery\",\n  \"chief\",\n  \"chilly\",\n  \"classic\",\n  \"clean\",\n  \"clear\",\n  \"clever\",\n  \"decent\",\n  \"decisive\",\n  \"deep\",\n  \"defiant\",\n  \"definitive\",\n  \"delectable\",\n  \"delicious\",\n  \"elaborate\",\n  \"elastic\",\n  \"elated\",\n  \"elegant\",\n  \"elementary\",\n  \"elliptical\",\n  \"fast\",\n  \"favorable\",\n  \"favorite\",\n  \"fearless\",\n  \"gifted\",\n  \"glamorous\",\n  \"gleaming\",\n  \"glittering\",\n  \"harmonious\",\n  \"imaginative\",\n  \"immense\",\n  \"jealous\",\n  \"kind\",\n  \"leafy\",\n  \"legal\",\n  \"mature\",\n  \"mean\",\n  \"nautical\",\n  \"neat\",\n  \"necessary\",\n  \"needy\",\n  \"oddball\",\n  \"offbeat\",\n  \"periodic\",\n  \"perky\",\n  \"personal\",\n  \"pertinent\",\n  \"petty\",\n  \"quarterly\",\n  \"ready\",\n  \"real\",\n  \"realistic\",\n  \"reasonable\",\n  \"regal\",\n  \"serene\",\n  \"shabby\",\n  \"sharp\",\n  \"shiny\",\n  \"showy\",\n  \"shy\",\n  \"silky\",\n  \"tempting\",\n  \"tense\",\n  \"terrific\",\n  \"testy\",\n  \"thankful\",\n  \"uniform\",\n  \"unique\",\n  \"vast\",\n  \"weary\",\n  \"wee\",\n  \"welcome\",\n  \"agile\",\n  \"alarmed\",\n  \"alert\",\n  \"alive\",\n  \"bleak\",\n  \"blissful\",\n  \"blushing\",\n  \"coarse\",\n  \"colorful\",\n  \"colossal\",\n  \"comfortable\",\n  \"compassionate\",\n  \"complete\",\n  \"delightful\",\n  \"dense\",\n  \"dependable\",\n  \"dependent\",\n  \"descriptive\",\n  \"detailed\",\n  \"determined\",\n  \"devoted\",\n  \"different\",\n  \"eminent\",\n  \"emotional\",\n  \"enchanted\",\n  \"enchanting\",\n  \"energetic\",\n  \"enormous\",\n  \"fine\",\n  \"finished\",\n  \"firm\",\n  \"firsthand\",\n  \"fixed\",\n  \"flashy\",\n  \"flawless\",\n  \"glorious\",\n  \"glossy\",\n  \"golden\",\n  \"good\",\n  \"gorgeous\",\n  \"graceful\",\n  \"healthy\",\n  \"heartfelt\",\n  \"hearty\",\n  \"helpful\",\n  \"impartial\",\n  \"impressive\",\n  \"jolly\",\n  \"jovial\",\n  \"lighthearted\",\n  \"likable\",\n  \"lined\",\n  \"mellow\",\n  \"melodic\",\n  \"memorable\",\n  \"mild\",\n  \"new\",\n  \"opulent\",\n  \"playful\",\n  \"pleasant\",\n  \"pleasing\",\n  \"plump\",\n  \"plush\",\n  \"polished\",\n  \"polite\",\n  \"reliable\",\n  \"relieved\",\n  \"remarkable\",\n  \"remote\",\n  \"respectful\",\n  \"responsible\",\n  \"simple\",\n  \"simplistic\",\n  \"sizzling\",\n  \"sleepy\",\n  \"slight\",\n  \"slim\",\n  \"smart\",\n  \"smooth\",\n  \"snappy\",\n  \"snoopy\",\n  \"thirsty\",\n  \"this\",\n  \"thorough\",\n  \"those\",\n  \"thoughtful\",\n  \"united\",\n  \"vibrant\",\n  \"vicious\",\n  \"wellmade\",\n  \"whimsical\",\n  \"whirlwind\",\n  \"zesty\",\n  \"amazing\",\n  \"ambitious\",\n  \"ample\",\n  \"amused\",\n  \"amusing\",\n  \"ancient\",\n  \"angelic\",\n  \"antique\",\n  \"bold\",\n  \"bossy\",\n  \"both\",\n  \"bouncy\",\n  \"bountiful\",\n  \"complex\",\n  \"conscious\",\n  \"considerate\",\n  \"constant\",\n  \"content\",\n  \"conventional\",\n  \"cooked\",\n  \"cool\",\n  \"cooperative\",\n  \"diligent\",\n  \"dimwitted\",\n  \"direct\",\n  \"discrete\",\n  \"envious\",\n  \"essential\",\n  \"ethical\",\n  \"euphoric\",\n  \"flippant\",\n  \"fluffy\",\n  \"flustered\",\n  \"focused\",\n  \"fond\",\n  \"gracious\",\n  \"grand\",\n  \"grandiose\",\n  \"granular\",\n  \"grateful\",\n  \"grave\",\n  \"great\",\n  \"hidden\",\n  \"high\",\n  \"hilarious\",\n  \"homely\",\n  \"incomparable\",\n  \"incredible\",\n  \"infamous\",\n  \"joyful\",\n  \"lively\",\n  \"loathsome\",\n  \"lonely\",\n  \"long\",\n  \"mindless\",\n  \"miniature\",\n  \"minor\",\n  \"misty\",\n  \"next\",\n  \"nice\",\n  \"nifty\",\n  \"nimble\",\n  \"orderly\",\n  \"organic\",\n  \"ornate\",\n  \"popular\",\n  \"posh\",\n  \"positive\",\n  \"potable\",\n  \"powerful\",\n  \"powerless\",\n  \"precious\",\n  \"present\",\n  \"prestigious\",\n  \"quick\",\n  \"rewarding\",\n  \"rich\",\n  \"right\",\n  \"sociable\",\n  \"soft\",\n  \"solid\",\n  \"some\",\n  \"sophisticated\",\n  \"soulful\",\n  \"sparkling\",\n  \"spectacular\",\n  \"speedy\",\n  \"spicy\",\n  \"spiffy\",\n  \"spirited\",\n  \"spiteful\",\n  \"splendid\",\n  \"spotless\",\n  \"spry\",\n  \"thrifty\",\n  \"tidy\",\n  \"tight\",\n  \"timely\",\n  \"tinted\",\n  \"unruly\",\n  \"untimely\",\n  \"violet\",\n  \"wicked\",\n  \"wide\",\n  \"wild\",\n  \"willing\",\n  \"winding\",\n  \"windy\",\n  \"zigzag\",\n  \"apprehensive\",\n  \"appropriate\",\n  \"artistic\",\n  \"assured\",\n  \"astonishing\",\n  \"bright\",\n  \"brilliant\",\n  \"bronze\",\n  \"coordinated\",\n  \"courageous\",\n  \"courteous\",\n  \"crafty\",\n  \"crazy\",\n  \"creamy\",\n  \"creative\",\n  \"crisp\",\n  \"distant\",\n  \"distinct\",\n  \"downright\",\n  \"evergreen\",\n  \"everlasting\",\n  \"every\",\n  \"evil\",\n  \"excellent\",\n  \"excitable\",\n  \"exemplary\",\n  \"exhausted\",\n  \"forthright\",\n  \"fortunate\",\n  \"fragrant\",\n  \"frank\",\n  \"free\",\n  \"frequent\",\n  \"fresh\",\n  \"friendly\",\n  \"frightened\",\n  \"frigid\",\n  \"gripping\",\n  \"grounded\",\n  \"honest\",\n  \"honorable\",\n  \"honored\",\n  \"hopeful\",\n  \"hospitable\",\n  \"hot\",\n  \"huge\",\n  \"infatuated\",\n  \"infinite\",\n  \"informal\",\n  \"insistent\",\n  \"instructive\",\n  \"juicy\",\n  \"jumbo\",\n  \"knowing\",\n  \"knowledgeable\",\n  \"longterm\",\n  \"loud\",\n  \"lovable\",\n  \"loving\",\n  \"modern\",\n  \"modest\",\n  \"monumental\",\n  \"normal\",\n  \"notable\",\n  \"outgoing\",\n  \"precious\",\n  \"pretty\",\n  \"prickly\",\n  \"primary\",\n  \"pristine\",\n  \"private\",\n  \"prize\",\n  \"productive\",\n  \"profitable\",\n  \"quiet\",\n  \"quintessential\",\n  \"roasted\",\n  \"robust\",\n  \"square\",\n  \"squiggly\",\n  \"stable\",\n  \"staid\",\n  \"starry\",\n  \"steel\",\n  \"stimulating\",\n  \"striking\",\n  \"striped\",\n  \"strong\",\n  \"studious\",\n  \"stunning\",\n  \"tough\",\n  \"trained\",\n  \"treasured\",\n  \"tremendous\",\n  \"triangular\",\n  \"tricky\",\n  \"unused\",\n  \"unusual\",\n  \"upbeat\",\n  \"virtual\",\n  \"witty\",\n  \"wonderful\",\n  \"wooden\",\n  \"worldly\",\n  \"youthful\",\n  \"attached\",\n  \"attentive\",\n  \"attractive\",\n  \"austere\",\n  \"authentic\",\n  \"automatic\",\n  \"aware\",\n  \"awesome\",\n  \"bubbly\",\n  \"bustling\",\n  \"busy\",\n  \"buttery\",\n  \"cuddly\",\n  \"cultured\",\n  \"curly\",\n  \"curvy\",\n  \"cute\",\n  \"cylindrical\",\n  \"downright\",\n  \"dramatic\",\n  \"excited\",\n  \"exciting\",\n  \"exotic\",\n  \"experienced\",\n  \"expert\",\n  \"frosty\",\n  \"fruitful\",\n  \"full\",\n  \"fumbling\",\n  \"funny\",\n  \"fussy\",\n  \"growing\",\n  \"grown\",\n  \"gummy\",\n  \"humble\",\n  \"humongous\",\n  \"hungry\",\n  \"intelligent\",\n  \"interesting\",\n  \"known\",\n  \"kooky\",\n  \"loyal\",\n  \"lucky\",\n  \"luminous\",\n  \"lustrous\",\n  \"luxurious\",\n  \"multicolored\",\n  \"mysterious\",\n  \"noteworthy\",\n  \"numb\",\n  \"nutritious\",\n  \"outstanding\",\n  \"overjoyed\",\n  \"proper\",\n  \"proud\",\n  \"prudent\",\n  \"punctual\",\n  \"puny\",\n  \"pure\",\n  \"puzzled\",\n  \"puzzling\",\n  \"quirky\",\n  \"stupendous\",\n  \"sturdy\",\n  \"stylish\",\n  \"subdued\",\n  \"subtle\",\n  \"sunny\",\n  \"super\",\n  \"superb\",\n  \"supportive\",\n  \"surprised\",\n  \"sweet\",\n  \"swift\",\n  \"sympathetic\",\n  \"trivial\",\n  \"trusting\",\n  \"trustworthy\",\n  \"trusty\",\n  \"truthful\",\n  \"twin\",\n  \"usable\",\n  \"used\",\n  \"useful\",\n  \"utilized\",\n  \"vital\",\n  \"vivid\",\n  \"worried\",\n  \"worthwhile\",\n  \"worthy\",\n  \"writhing\",\n  \"wry\",\n  \"yummy\",\n  \"chocolate\",\n  \"crimson\",\n  \"cyan\",\n  \"fuchsia\",\n  \"gold\",\n  \"honeydew\",\n  \"lime\",\n  \"linen\",\n  \"magenta\",\n  \"olive\",\n  \"peru\",\n  \"salmon\",\n  \"seashell\",\n  \"sienna\",\n  \"snow\",\n  \"thistle\",\n  \"tomato\",\n  \"transparent\",\n  \"turquoise\",\n  \"violet\"\n];\n\nconst nouns = [\n  \"space\",\n  \"land\",\n  \"world\",\n  \"universe\",\n  \"plane\",\n  \"room\",\n  \"nation\",\n  \"plaza\",\n  \"gathering\",\n  \"meetup\",\n  \"get together\",\n  \"conclave\",\n  \"party\",\n  \"domain\",\n  \"dominion\",\n  \"realm\",\n  \"square\",\n  \"commons\",\n  \"park\",\n  \"cosmos\",\n  \"sphere\",\n  \"terrain\",\n  \"spot\",\n  \"zone\",\n  \"area\",\n  \"tract\",\n  \"turf\",\n  \"place\",\n  \"territory\",\n  \"volume\",\n  \"camp\",\n  \"picnic\",\n  \"outing\",\n  \"vacation\",\n  \"adventure\",\n  \"exploration\",\n  \"outing\",\n  \"walkabout\",\n  \"safari\",\n  \"venture\",\n  \"roundtable\",\n  \"barbecue\",\n  \"celebration\",\n  \"festivity\",\n  \"gala\",\n  \"shindig\",\n  \"social\",\n  \"convention\",\n  \"assembly\",\n  \"congregation\",\n  \"rendezvous\",\n  \"huddle\",\n  \"meet\",\n  \"soiree\"\n];\n\nexport function generateHubName() {\n  const randItem = set => {\n    const s = set[Math.floor(Math.random() * set.length)];\n    return s.charAt(0).toUpperCase() + s.slice(1);\n  };\n\n  return `${randItem(adjectives)} ${randItem(adjectives)} ${randItem(nouns)}`;\n}\n","import { Socket } from \"phoenix\";\nimport { generateHubName } from \"../utils/name-generation\";\nimport configs from \"../utils/configs\";\n\nimport Store from \"../storage/store\";\n\nexport function hasReticulumServer() {\n  return !!configs.RETICULUM_SERVER;\n}\n\nexport function isLocalClient() {\n  return hasReticulumServer() && document.location.host !== configs.RETICULUM_SERVER;\n}\n\nconst resolverLink = document.createElement(\"a\");\nexport function getReticulumFetchUrl(path, absolute = false) {\n  if (hasReticulumServer()) {\n    return `https://${configs.RETICULUM_SERVER}${path}`;\n  } else if (absolute) {\n    resolverLink.href = path;\n    return resolverLink.href;\n  } else {\n    return path;\n  }\n}\n\nlet reticulumMeta = null;\nlet invalidatedReticulumMetaThisSession = false;\n\nexport async function invalidateReticulumMeta() {\n  invalidatedReticulumMetaThisSession = true;\n  reticulumMeta = null;\n}\n\nexport async function getReticulumMeta() {\n  if (!reticulumMeta) {\n    // Initially look up version based upon page, avoiding round-trip, otherwise fetch.\n    if (!invalidatedReticulumMetaThisSession && document.querySelector(\"meta[name='ret:version']\")) {\n      reticulumMeta = {\n        version: document.querySelector(\"meta[name='ret:version']\").getAttribute(\"value\"),\n        pool: document.querySelector(\"meta[name='ret:pool']\").getAttribute(\"value\"),\n        phx_host: document.querySelector(\"meta[name='ret:phx_host']\").getAttribute(\"value\")\n      };\n    } else {\n      await fetch(getReticulumFetchUrl(\"/api/v1/meta\")).then(async res => {\n        reticulumMeta = await res.json();\n      });\n    }\n  }\n\n  const qs = new URLSearchParams(location.search);\n  const phxHostOverride = qs.get(\"phx_host\");\n\n  if (phxHostOverride) {\n    reticulumMeta.phx_host = phxHostOverride;\n  }\n\n  return reticulumMeta;\n}\n\nexport async function connectToReticulum(debug = false, params = null, socketClass = Socket) {\n  const qs = new URLSearchParams(location.search);\n\n  const getNewSocketUrl = async () => {\n    const socketProtocol =\n      qs.get(\"phx_protocol\") ||\n      configs.RETICULUM_SOCKET_PROTOCOL ||\n      (document.location.protocol === \"https:\" ? \"wss:\" : \"ws:\");\n    let socketHost = qs.get(\"phx_host\");\n    let socketPort = qs.get(\"phx_port\");\n\n    const reticulumMeta = await getReticulumMeta();\n    socketHost = socketHost || configs.RETICULUM_SOCKET_SERVER || reticulumMeta.phx_host;\n    socketPort =\n      socketPort || (hasReticulumServer() ? new URL(`${socketProtocol}//${configs.RETICULUM_SERVER}`).port : \"443\");\n    return `${socketProtocol}//${socketHost}${socketPort ? `:${socketPort}` : \"\"}`;\n  };\n\n  const socketUrl = await getNewSocketUrl();\n  console.log(`Phoenix Socket URL: ${socketUrl}`);\n\n  const socketSettings = {};\n\n  if (debug) {\n    socketSettings.logger = (kind, msg, data) => {\n      console.log(`${kind}: ${msg}`, data);\n    };\n  }\n\n  if (params) {\n    socketSettings.params = params;\n  }\n\n  const socket = new socketClass(`${socketUrl}/socket`, socketSettings);\n  socket.connect();\n  socket.onError(async () => {\n    // On error, underlying reticulum node may have died, so rebalance by\n    // fetching a new healthy node to connect to.\n    invalidateReticulumMeta();\n\n    const endPointPath = new URL(socket.endPoint).pathname;\n    const newSocketUrl = await getNewSocketUrl();\n    const newEndPoint = `${newSocketUrl}${endPointPath}`;\n    console.log(`Socket error, changed endpoint to ${newEndPoint}`);\n    socket.endPoint = newEndPoint;\n  });\n\n  return socket;\n}\n\nexport function getLandingPageForPhoto(photoUrl) {\n  const parsedUrl = new URL(photoUrl);\n  return getReticulumFetchUrl(parsedUrl.pathname.replace(\".png\", \".html\") + parsedUrl.search, true);\n}\n\nexport function fetchReticulumAuthenticated(url, method = \"GET\", payload) {\n  const { token } = window.APP.store.state.credentials;\n  const retUrl = getReticulumFetchUrl(url);\n  const params = {\n    headers: { \"content-type\": \"application/json\" },\n    method\n  };\n  if (token) {\n    params.headers.authorization = `bearer ${token}`;\n  }\n  if (payload) {\n    params.body = JSON.stringify(payload);\n  }\n  return fetch(retUrl, params).then(async r => {\n    const result = await r.text();\n    try {\n      return JSON.parse(result);\n    } catch (e) {\n      // Some reticulum responses, particularly DELETE requests, don't return json.\n      return result;\n    }\n  });\n}\n\nexport async function createAndRedirectToNewHub(name, sceneId, replace) {\n  const createUrl = getReticulumFetchUrl(\"/api/v1/hubs\");\n  const payload = { hub: { name: name || generateHubName() } };\n\n  if (sceneId) {\n    payload.hub.scene_id = sceneId;\n  }\n\n  const headers = { \"content-type\": \"application/json\" };\n  const store = new Store();\n  if (store.state && store.state.credentials.token) {\n    headers.authorization = `bearer ${store.state.credentials.token}`;\n  }\n\n  let res = await fetch(createUrl, {\n    body: JSON.stringify(payload),\n    headers,\n    method: \"POST\"\n  }).then(r => r.json());\n\n  if (res.error === \"invalid_token\") {\n    // Clear the invalid token from store.\n    store.update({ credentials: { token: null, email: null } });\n\n    // Create hub anonymously\n    delete headers.authorization;\n    res = await fetch(createUrl, {\n      body: JSON.stringify(payload),\n      headers,\n      method: \"POST\"\n    }).then(r => r.json());\n  }\n\n  const hub = res;\n  let url = hub.url;\n\n  const creatorAssignmentToken = hub.creator_assignment_token;\n  if (creatorAssignmentToken) {\n    store.update({ creatorAssignmentTokens: [{ hubId: hub.hub_id, creatorAssignmentToken: creatorAssignmentToken }] });\n\n    // Don't need to store the embed token if there's no creator assignment token, since that means\n    // we are the owner and will get the embed token on page load.\n    const embedToken = hub.embed_token;\n\n    if (embedToken) {\n      store.update({ embedTokens: [{ hubId: hub.hub_id, embedToken: embedToken }] });\n    }\n  }\n\n  if (isLocalClient()) {\n    url = process.env.BASE_ASSETS_PATH + `hub.html?hub_id=${hub.hub_id}`;\n  }\n\n  if (replace) {\n    document.location.replace(url);\n  } else {\n    document.location = url;\n  }\n}\n\nexport function getPresenceEntryForSession(presences, sessionId) {\n  const entry = Object.entries(presences || {}).find(([k]) => k === sessionId) || [];\n  const presence = entry[1];\n  return (presence && presence.metas && presence.metas[0]) || {};\n}\n\nexport function getPresenceContextForSession(presences, sessionId) {\n  return (getPresenceEntryForSession(presences, sessionId) || {}).context || {};\n}\n\nexport function getPresenceProfileForSession(presences, sessionId) {\n  return (getPresenceEntryForSession(presences, sessionId) || {}).profile || {};\n}\n\n// Takes the given channel, and creates a new channel with the same bindings\n// with the given socket, joins it, and leaves the old channel after joining.\n//\n// NOTE: This function relies upon phoenix channel object internals, so this\n// function will need to be reviewed if/when we ever update phoenix.js\nexport function migrateChannelToSocket(oldChannel, socket, params) {\n  const channel = socket.channel(oldChannel.topic, params || oldChannel.params);\n\n  for (let i = 0, l = oldChannel.bindings.length; i < l; i++) {\n    const item = oldChannel.bindings[i];\n    channel.on(item.event, item.callback);\n  }\n\n  for (let i = 0, l = oldChannel.pushBuffer.length; i < l; i++) {\n    const item = oldChannel.pushBuffer[i];\n    channel.push(item.event, item.payload, item.timeout);\n  }\n\n  const oldJoinPush = oldChannel.joinPush;\n  const joinPush = channel.join();\n\n  for (let i = 0, l = oldJoinPush.recHooks.length; i < l; i++) {\n    const item = oldJoinPush.recHooks[i];\n    joinPush.receive(item.status, item.callback);\n  }\n\n  return new Promise(resolve => {\n    joinPush.receive(\"ok\", () => {\n      // Clear all event handlers first so no duplicate messages come in.\n      oldChannel.bindings = [];\n      resolve(channel);\n    });\n  });\n}\n\nexport function discordBridgesForPresences(presences) {\n  const channels = [];\n  for (const p of Object.values(presences)) {\n    for (const m of p.metas) {\n      if (m.profile && m.profile.discordBridges) {\n        Array.prototype.push.apply(channels, m.profile.discordBridges.map(b => b.channel.name));\n      }\n    }\n  }\n  return channels;\n}\n","import { waitForDOMContentLoaded } from \"./async-utils\";\nimport \"./configs\";\n\n// Node these should be synchronized with the top of shared.scss\nconst DEFAULT_ACTION_COLOR = \"#FF3464\";\nconst DEFAULT_ACTION_COLOR_LIGHT = \"#FF74A4\";\n\nconst DEFAULT_COLORS = {\n  \"action-color\": DEFAULT_ACTION_COLOR,\n  \"action-label-color\": DEFAULT_ACTION_COLOR,\n  \"action-color-disabled\": DEFAULT_ACTION_COLOR_LIGHT,\n  \"action-color-highlight\": DEFAULT_ACTION_COLOR_LIGHT,\n  \"action-text-color\": \"#FFFFFF\",\n  \"action-subtitle-color\": \"#F0F0F0\",\n  \"notice-background-color\": \"#2F80ED\",\n  \"notice-text-color\": \"#FFFFFF\",\n  \"favorited-color\": \"#FFC000\"\n};\n\nfunction getThemeColor(name) {\n  if (window.APP_CONFIG && window.APP_CONFIG.theme && window.APP_CONFIG.theme[name])\n    return window.APP_CONFIG.theme[name];\n\n  return DEFAULT_COLORS[name];\n}\n\nwaitForDOMContentLoaded().then(() => {\n  if (window.APP_CONFIG && window.APP_CONFIG.theme && window.APP_CONFIG.theme[\"dark-theme\"]) {\n    document.body.classList.add(\"dark-theme\");\n  } else {\n    document.body.classList.add(\"light-theme\");\n  }\n\n  const actionColor = getThemeColor(\"action-color\");\n  const actionHoverColor = getThemeColor(\"action-color-highlight\");\n\n  if (document.querySelector(\"#rounded-text-button\")) {\n    // NOTE, using the object-based {} setAttribute variant in a-frame\n    // seems to not work in Firefox here -- the entities with the mixins are not\n    // updated.\n    document\n      .querySelector(\"#rounded-text-button\")\n      .setAttribute(\n        \"text-button\",\n        `textHoverColor: ${actionHoverColor}; textColor: ${actionColor}; backgroundColor: #fff; backgroundHoverColor: #aaa;`\n      );\n\n    document\n      .querySelector(\"#rounded-button\")\n      .setAttribute(\n        \"text-button\",\n        `textHoverColor: ${actionHoverColor}; textColor: ${actionColor}; backgroundColor: #fff; backgroundHoverColor: #aaa;`\n      );\n\n    document\n      .querySelector(\"#rounded-text-action-button\")\n      .setAttribute(\n        \"text-button\",\n        `textHoverColor: #fff; textColor: #fff; backgroundColor: ${actionColor}; backgroundHoverColor: ${actionHoverColor}`\n      );\n\n    document\n      .querySelector(\"#rounded-action-button\")\n      .setAttribute(\n        \"text-button\",\n        `textHoverColor: #fff; textColor: #fff; backgroundColor: ${actionColor}; backgroundHoverColor: ${actionHoverColor}`\n      );\n  }\n});\n\nfunction applyThemeToTextButton(el, highlighted) {\n  el.setAttribute(\n    \"text-button\",\n    \"backgroundColor\",\n    highlighted ? getThemeColor(\"action-color-highlight\") : getThemeColor(\"action-color\")\n  );\n  el.setAttribute(\n    \"text-button\",\n    \"backgroundHoverColor\",\n    highlighted ? \"#aaa\" : getThemeColor(\"action-color-highlight\")\n  );\n}\n\nexport { applyThemeToTextButton, getThemeColor };\n"],"sourceRoot":""}