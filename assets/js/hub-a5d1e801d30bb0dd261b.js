!function(e){function t(t){for(var n,o,r=t[0],l=t[1],c=t[2],h=0,u=[];h<r.length;h++)o=r[h],a[o]&&u.push(a[o][0]),a[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(d&&d(t);u.length;)u.shift()();return s.push.apply(s,c||[]),i()}function i(){for(var e,t=0;t<s.length;t++){for(var i=s[t],n=!0,r=1;r<i.length;r++){var l=i[r];0!==a[l]&&(n=!1)}n&&(s.splice(t--,1),e=o(o.s=i[0]))}return e}var n={},a={5:0},s=[];function o(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.e=function(){return Promise.resolve()},o.m=e,o.c=n,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(i,n,function(t){return e[t]}.bind(null,n));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/custom-hubs-template/",o.oe=function(e){throw console.error(e),e};var r=window.webpackJsonp=window.webpackJsonp||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var d=l;s.push([1285,1,0]),i()}([,function(e,t,i){"use strict";function n(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),n.forEach(function(t){a(e,t,i[t])})}return e}function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.d(t,"a",function(){return s});const s={noop:"/noop",actions:{}};s.actions.log="/actions/log",s.actions.toggleScreenShare="/actions/toggleScreenShare",s.actions.snapRotateLeft="/actions/snapRotateLeft",s.actions.snapRotateRight="/actions/snapRotateRight",s.actions.angularVelocity="/actions/angularVelocity",s.actions.logDebugFrame="/actions/logDebugFrame",s.actions.logInteractionState="/actions/logInteractionState",s.actions.debugUserInput={},s.actions.debugUserInput.describeCurrentMasks="/actions/debugUserInput/describeCurrentMasks",s.actions.cameraDelta="/actions/cameraDelta",s.actions.lobbyCameraDelta="/actions/lobbyCameraDelta",s.actions.characterAcceleration="/actions/characterAcceleration",s.actions.dCharSpeed="/actions/dCharSpeed",s.actions.boost="/actions/boost",s.actions.startGazeTeleport="/actions/startTeleport",s.actions.stopGazeTeleport="/actions/stopTeleport",s.actions.spawnPen="/actions/spawnPen",s.actions.ensureFrozen="/actions/ensureFrozen",s.actions.toggleFreeze="/actions/toggleFreeze",s.actions.thaw="/actions/thaw",s.actions.muteMic="/actions/muteMic",s.actions.toggleFly="/actions/toggleFly",s.actions.toggleUI="/actions/toggleUI",s.actions.waypointDeltaDistance="/actions/waypointDeltaDistance",s.actions.focusChat="/actions/focusChat",s.actions.focusChatCommand="/actions/focusChatCommand",s.actions.toggleCamera="/actions/toggleCamera",s.actions.takeSnapshot="/actions/takeSnapshot",s.actions.mediaExit="/actions/mediaExit",s.actions.mediaSearch1="/actions/mediaSearch1",s.actions.mediaSearch2="/actions/mediaSearch2",s.actions.mediaSearch3="/actions/mediaSearch3",s.actions.mediaSearch4="/actions/mediaSearch4",s.actions.mediaSearch5="/actions/mediaSearch5",s.actions.mediaSearch6="/actions/mediaSearch6",s.actions.mediaSearch7="/actions/mediaSearch7",s.actions.mediaSearch8="/actions/mediaSearch8",s.actions.transformModifier="/actions/transformModifier",s.actions.rayObjectRotation="/actions/rayObjectRotation",s.actions.cursor={},s.actions.cursor.right={},s.actions.cursor.right.pose="/actions/cursor/right/Pose",s.actions.cursor.right.hideLine="/actions/cursor/right/HideLine",s.actions.cursor.right.grab="/actions/cursor/right/Grab",s.actions.cursor.right.drop="/actions/cursor/right/Drop",s.actions.cursor.right.modDelta="/actions/cursor/right/ModDelta",s.actions.cursor.right.startDrawing="/actions/cursor/right/StartDrawing",s.actions.cursor.right.stopDrawing="/actions/cursor/right/StopDrawing",s.actions.cursor.right.undoDrawing="/actions/cursor/right/UndoDrawing",s.actions.cursor.right.penNextColor="/actions/cursor/right/PenNextColor",s.actions.cursor.right.penPrevColor="/actions/cursor/right/PenPrevColor",s.actions.cursor.right.scalePenTip="/actions/cursor/right/ScalePenTip",s.actions.cursor.right.scaleGrabbedGrabbable="/actions/cursor/right/ScaleGrabbedGrabbable",s.actions.cursor.right.mediaVolumeMod="/actions/cursor/right//mediaVolumeMod",s.actions.cursor.right.takeSnapshot="/actions/cursor/right/TakeSnapshot",s.actions.cursor.right.wake="/actions/cursor/right/wake",s.actions.cursor.left={},s.actions.cursor.left.pose="/actions/cursor/left/Pose",s.actions.cursor.left.hideLine="/actions/cursor/left/HideLine",s.actions.cursor.left.grab="/actions/cursor/left/Grab",s.actions.cursor.left.drop="/actions/cursor/left/Drop",s.actions.cursor.left.modDelta="/actions/cursor/left/ModDelta",s.actions.cursor.left.startDrawing="/actions/cursor/left/StartDrawing",s.actions.cursor.left.stopDrawing="/actions/cursor/left/StopDrawing",s.actions.cursor.left.undoDrawing="/actions/cursor/left/UndoDrawing",s.actions.cursor.left.penNextColor="/actions/cursor/left/PenNextColor",s.actions.cursor.left.penPrevColor="/actions/cursor/left/PenPrevColor",s.actions.cursor.left.scalePenTip="/actions/cursor/left/ScalePenTip",s.actions.cursor.left.scaleGrabbedGrabbable="/actions/cursor/left/ScaleGrabbedGrabbable",s.actions.cursor.left.mediaVolumeMod="/actions/cursor/left//mediaVolumeMod",s.actions.cursor.left.takeSnapshot="/actions/cursor/left/TakeSnapshot",s.actions.cursor.left.wake="/actions/cursor/left/wake",s.actions.pen={},s.actions.pen.remove="/actions/pen/remove",s.actions.rightHand={},s.actions.rightHand.matrix="/actions/rightHand/matrix",s.actions.rightHand.pose="/actions/rightHandPose",s.actions.rightHand.grab="/actions/rightHandGrab",s.actions.rightHand.drop="/actions/rightHandDrop",s.actions.rightHand.modDelta="/actions/rightHandModDelta",s.actions.rightHand.startDrawing="/actions/rightHandStartDrawing",s.actions.rightHand.stopDrawing="/actions/rightHandStopDrawing",s.actions.rightHand.undoDrawing="/actions/rightHandUndoDrawing",s.actions.rightHand.switchDrawMode="/actions/rightHandSwitchDrawMode",s.actions.rightHand.penNextColor="/actions/rightHandPenNextColor",s.actions.rightHand.penPrevColor="/actions/rightHandPenPrevColor",s.actions.rightHand.scalePenTip="/actions/rightHandScalePenTip",s.actions.rightHand.startTeleport="/actions/rightHand/startTeleport",s.actions.rightHand.stopTeleport="/actions/rightHand/stopTeleport",s.actions.rightHand.takeSnapshot="/actions/rightHandTakeSnapshot",s.actions.rightHand.thumb="/actions/rightHand/thumbDown",s.actions.rightHand.index="/actions/rightHand/indexDown",s.actions.rightHand.middleRingPinky="/actions/rightHand/middleRingPinkyDown",s.actions.leftHand={},s.actions.leftHand.matrix="/actions/leftHand/matrix",s.actions.leftHand.pose="/actions/leftHandPose",s.actions.leftHand.grab="/actions/leftHandGrab",s.actions.leftHand.drop="/actions/leftHandDrop",s.actions.leftHand.modDelta="/actions/leftHandModDelta",s.actions.leftHand.startDrawing="/actions/leftHandStartDrawing",s.actions.leftHand.stopDrawing="/actions/leftHandStopDrawing",s.actions.leftHand.undoDrawing="/actions/leftHandUndoDrawing",s.actions.leftHand.switchDrawMode="/actions/leftHandSwitchDrawMode",s.actions.leftHand.penNextColor="/actions/leftHandPenNextColor",s.actions.leftHand.penPrevColor="/actions/leftHandPenPrevColor",s.actions.leftHand.scalePenTip="/actions/leftHandScalePenTip",s.actions.leftHand.startTeleport="/actions/leftHand/startTeleport",s.actions.leftHand.stopTeleport="/actions/leftHand/stopTeleport",s.actions.leftHand.takeSnapshot="/actions/leftHandTakeSnapshot",s.actions.leftHand.thumb="/actions/leftHand/thumbDown",s.actions.leftHand.index="/actions/leftHand/indexDown",s.actions.leftHand.middleRingPinky="/actions/leftHand/middleRingPinkyDown",s.actions.camera={},s.actions.camera.exitMirror="/actions/cameraExitMirror",s.actions.startInspecting="/actions/startInspecting",s.actions.stopInspecting="/actions/stopInspecting",s.actions.inspectZoom="/actions/inspectZoom",s.actions.inspectPanY="/actions/inspectPanY",s.actions.resetInspectView="/actions/resetInspectView",s.actions.nextCameraMode="/actions/nextCameraMode",s.haptics={},s.haptics.actuators={},s.haptics.actuators.left="/haptics/actuators/left",s.haptics.actuators.right="/haptics/actuators/right",s.device={},s.device.mouse={},s.device.mouse.coords="/device/mouse/coords",s.device.mouse.movementXY="/device/mouse/movementXY",s.device.mouse.buttonLeft="/device/mouse/buttonLeft",s.device.mouse.buttonRight="/device/mouse/buttonRight",s.device.mouse.buttonMiddle="/device/mouse/buttonMiddle",s.device.mouse.wheel="/device/mouse/wheel",s.device.smartMouse={},s.device.smartMouse.cursorPose="/device/smartMouse/cursorPose",s.device.smartMouse.cameraDelta="/device/smartMouse/cameraDelta",s.device.smartMouse.shouldMoveCamera="/device/smartMouse/shouldMoveCamera",s.device.touchscreen={},s.device.touchscreen.cursorPose="/device/touchscreen/cursorPose",s.device.touchscreen.touchCameraDelta="/device/touchscreen/touchCameraDelta",s.device.touchscreen.gyroCameraDelta="/device/touchscreen/gyroCameraDelta",s.device.touchscreen.cameraDelta="/device/touchscreen/cameraDelta",s.device.touchscreen.pinch={},s.device.touchscreen.pinch.delta="/device/touchscreen/pinch/delta",s.device.touchscreen.pinch.initialDistance="/device/touchscreen/pinch/initialDistance",s.device.touchscreen.pinch.currentDistance="/device/touchscreen/pinch/currentDistance",s.device.touchscreen.isTouching="/device/touchscreen/isTouching",s.device.touchscreen.isTouchingGrabbable="/device/touchscreen/isTouchingGrabbable",s.device.touchscreen.tap1="/device/touchscreen/tap1",s.device.touchscreen.tap2="/device/touchscreen/tap2",s.device.touchscreen.tap3="/device/touchscreen/tap3",s.device.touchscreen.tap4="/device/touchscreen/tap4",s.device.touchscreen.tap5="/device/touchscreen/tap5",s.device.touchscreen.anything="/device/touchscreen/anything",s.device.gyro={},s.device.gyro.averageDeltaX="/device/gyro/averageDeltaX",s.device.gyro.averageDeltaY="/device/gyro/averageDeltaY",s.device.hud={},s.device.hud.penButton="/device/hud/penButton",s.device.keyboard={map:new Map,key:function(e){let t=this.map.get(e);return t||(t=`/device/keyboard/${" "===e?"space":e.toLowerCase()}`,this.map.set(e,t),t)}},s.device.gamepad=e=>({button:t=>({pressed:`/device/gamepad/${e}/button/${t}/pressed`,touched:`/device/gamepad/${e}/button/${t}/touched`,value:`/device/gamepad/${e}/button/${t}/value`}),axis:t=>`/device/gamepad/${e}/axis/${t}`});const o="/device/xbox/";s.device.xbox={v:e=>`/vars/xbox/${e}`,button:e=>({pressed:`${o}button/${e}/pressed`,touched:`${o}button/${e}/touched`,value:`${o}button/${e}/value`}),axis:e=>`${o}axis/${e}`,axesSum:`${o}axis/sum`},s.device.oculusgo={button:e=>({pressed:`/device/oculusgo/button/${e}/pressed`,touched:`/device/oculusgo/button/${e}/touched`,value:`/device/oculusgo/button/${e}/value`}),axis:e=>`/device/oculusgo/axis/${e}`,trigger:{pressed:"/device/oculusgo/button/trigger/pressed",touched:"/device/oculusgo/button/trigger/touched",value:"/device/oculusgo/button/trigger/value"},touchpad:{pressed:"/device/oculusgo/button/touchpad/pressed",touched:"/device/oculusgo/button/touchpad/touched",value:"/device/oculusgo/button/touchpad/value",axisX:"/device/oculusgo/axis/touchpadX",axisY:"/device/oculusgo/axis/touchpadY"},pose:"/device/oculusgo/pose",matrix:"/device/oculusgo/matrix",v:e=>`/vars/oculusgo/${e}`};const r="/device/gearVRController/";s.device.gearVRController={button:e=>({pressed:`${r}button/${e}/pressed`,touched:`${r}button/${e}/touched`,value:`${r}button/${e}/value`}),axis:e=>`${r}axis/${e}`,pose:`${r}pose`,matrix:`${r}matrix`,v:e=>`/vars/gearVRController/${e}`};const l="/device/daydream/";s.device.daydream={button:e=>({pressed:`${l}button/${e}/pressed`,touched:`${l}button/${e}/touched`,value:`${l}button/${e}/value`}),axis:e=>`${l}axis/${e}`,pose:`${l}pose`,matrix:`${l}matrix`};const c="/device/rightOculusTouch/";s.device.rightOculusTouch={button:e=>({pressed:`${c}button/${e}/pressed`,touched:`${c}button/${e}/touched`,value:`${c}button/${e}/value`}),axis:e=>`${c}axis/${e}`,axesSum:`${c}axis/sum`,pose:`${c}pose`,matrix:`${c}matrix`};const d="/device/leftOculusTouch/";function h(e,t,i){return{pressed:`${e}${t}/button/${i}/pressed`,touched:`${e}${t}/button/${i}/touched`,value:`${e}${t}/button/${i}/value`}}function u(e,t,i){return{axisX:`${e}${t}/axis/${i}X`,axisY:`${e}${t}/axis/${i}Y`}}function p(e){const t="/device/wmr/";return{touchpad:n({},h(t,e,"touchpad"),u(t,e,"touchpad")),trigger:h(t,e,"trigger"),grip:h(t,e,"grip"),menu:h(t,e,"menu"),joystick:u(t,e,"joystick"),pose:`${t}${e}/pose`,matrix:`${t}${e}/matrix`}}s.device.leftOculusTouch={button:e=>({pressed:`${d}button/${e}/pressed`,touched:`${d}button/${e}/touched`,value:`${d}button/${e}/value`}),axis:e=>`${d}axis/${e}`,axesSum:`${d}axis/sum`,pose:`${d}pose`,matrix:`${d}matrix`},s.device.vive={},s.device.vive.left={button:e=>({pressed:`/device/vive/left/button/${e}/pressed`,touched:`/device/vive/left/button/${e}/touched`,value:`/device/vive/left/button/${e}/value`}),axis:e=>`/device/vive/left/axis/${e}`,axesSum:"/device/vive/left/axis/sum",pose:"/device/vive/left/pose",matrix:"/device/vive/left/matrix"},s.device.vive.right={button:e=>({pressed:`/device/vive/right/button/${e}/pressed`,touched:`/device/vive/right/button/${e}/touched`,value:`/device/vive/right/button/${e}/value`}),axis:e=>`/device/vive/right/axis/${e}`,axesSum:"/device/vive/right/axis/sum",pose:"/device/vive/right/pose",matrix:"/device/vive/right/matrix"},s.device.wmr={},s.device.wmr.v=e=>`/vars/wmr/${e}`,s.device.wmr.k=e=>`/vars/wmr/keyboard/${e}`,s.device.wmr.left=p("left"),s.device.wmr.right=p("right")},,,function(e,t,i){"use strict";i(53),i(54),i(55);var n=i(69),a=i.n(n);const s={};let o=!1;if(["RETICULUM_SERVER","THUMBNAIL_SERVER","CORS_PROXY_SERVER","NON_CORS_PROXY_DOMAINS","SENTRY_DSN","GA_TRACKING_ID","SHORTLINK_DOMAIN","BASE_ASSETS_PATH"].forEach(e=>{const t=document.querySelector(`meta[name='env:${e.toLowerCase()}']`);s[e]=t?t.getAttribute("content"):{NODE_ENV:"production",SHORTLINK_DOMAIN:"hub.link",RETICULUM_SERVER:"dev.reticulum.io",THUMBNAIL_SERVER:"nearspark-dev.reticulum.io",CORS_PROXY_SERVER:"cors-proxy-dev.reticulum.io",NON_CORS_PROXY_DOMAINS:"hubs.local,dev.reticulum.io",BASE_ASSETS_PATH:"/custom-hubs-template/"}[e],"BASE_ASSETS_PATH"===e&&s[e]&&(i.p=s[e],a.a.GlobalWorkerOptions.workerSrc=`${s[e]}../assets/js/pdfjs-dist@2.1.266/build/pdf.worker.js`)}),s.AVAILABLE_INTEGRATIONS=window.AVAILABLE_INTEGRATIONS||{},window.APP_CONFIG){s.APP_CONFIG=window.APP_CONFIG;const{theme:e}=s.APP_CONFIG;if(e){const t=[];for(const i in e)e.hasOwnProperty(i)&&t.push(`--${i}: ${e[i]};`);const i=document.createElement("style");i.innerHTML=`:root{${t.join("\n")}}`,document.head.prepend(i)}s.APP_CONFIG.features||(s.APP_CONFIG.features={})}else s.APP_CONFIG={features:{}};s.feature=e=>{const t=s.APP_CONFIG.features[e];if("boolean"==typeof t){const i=!1;return"enable_spoke"===e&&o||i||t}return t};let r={};s.image=(e,t)=>{const i=s.APP_CONFIG&&s.APP_CONFIG.images&&s.APP_CONFIG.images[e]||r[e];return i&&t?`url(${i})`:i},s.link=(e,t)=>s.APP_CONFIG&&s.APP_CONFIG.links&&s.APP_CONFIG.links[e]||t,s.setIsAdmin=e=>{o=e},s.isAdmin=()=>o,t.a=s},,,,function(e,t,i){"use strict";var n=i(106);const a=["able","absolute","acceptable","acclaimed","accomplished","accurate","aching","acrobatic","adorable","adventurous","basic","belated","beloved","calm","candid","capital","carefree","caring","cautious","celebrated","charming","daring","darling","dearest","each","eager","early","earnest","easy","easygoing","ecstatic","edible","fabulous","fair","faithful","familiar","famous","fancy","fantastic","far","generous","gentle","genuine","giant","handmade","handsome","handy","happy","icy","ideal","identical","keen","lasting","lavish","magnificent","majestic","mammoth","marvelous","natural","obedient","palatable","parched","passionate","pastel","peaceful","perfect","perfumed","quaint","qualified","radiant","rapid","rare","safe","sandy","satisfied","scaly","scarce","scared","scary","scented","scientific","secret","sentimental","talkative","tangible","tart","tasty","tattered","teeming","ultimate","uncommon","unconscious","understated","warm","active","adept","admirable","admired","adorable","adored","advanced","affectionate","beneficial","best","better","big","cheerful","cheery","chief","chilly","classic","clean","clear","clever","decent","decisive","deep","defiant","definitive","delectable","delicious","elaborate","elastic","elated","elegant","elementary","elliptical","fast","favorable","favorite","fearless","gifted","glamorous","gleaming","glittering","harmonious","imaginative","immense","jealous","kind","leafy","legal","mature","mean","nautical","neat","necessary","needy","oddball","offbeat","periodic","perky","personal","pertinent","petty","quarterly","ready","real","realistic","reasonable","regal","serene","shabby","sharp","shiny","showy","shy","silky","tempting","tense","terrific","testy","thankful","uniform","unique","vast","weary","wee","welcome","agile","alarmed","alert","alive","bleak","blissful","blushing","coarse","colorful","colossal","comfortable","compassionate","complete","delightful","dense","dependable","dependent","descriptive","detailed","determined","devoted","different","eminent","emotional","enchanted","enchanting","energetic","enormous","fine","finished","firm","firsthand","fixed","flashy","flawless","glorious","glossy","golden","good","gorgeous","graceful","healthy","heartfelt","hearty","helpful","impartial","impressive","jolly","jovial","lighthearted","likable","lined","mellow","melodic","memorable","mild","new","opulent","playful","pleasant","pleasing","plump","plush","polished","polite","reliable","relieved","remarkable","remote","respectful","responsible","simple","simplistic","sizzling","sleepy","slight","slim","smart","smooth","snappy","snoopy","thirsty","this","thorough","those","thoughtful","united","vibrant","vicious","wellmade","whimsical","whirlwind","zesty","amazing","ambitious","ample","amused","amusing","ancient","angelic","antique","bold","bossy","both","bouncy","bountiful","complex","conscious","considerate","constant","content","conventional","cooked","cool","cooperative","diligent","dimwitted","direct","discrete","envious","essential","ethical","euphoric","flippant","fluffy","flustered","focused","fond","gracious","grand","grandiose","granular","grateful","grave","great","hidden","high","hilarious","homely","incomparable","incredible","infamous","joyful","lively","loathsome","lonely","long","mindless","miniature","minor","misty","next","nice","nifty","nimble","orderly","organic","ornate","popular","posh","positive","potable","powerful","powerless","precious","present","prestigious","quick","rewarding","rich","right","sociable","soft","solid","some","sophisticated","soulful","sparkling","spectacular","speedy","spicy","spiffy","spirited","spiteful","splendid","spotless","spry","thrifty","tidy","tight","timely","tinted","unruly","untimely","violet","wicked","wide","wild","willing","winding","windy","zigzag","apprehensive","appropriate","artistic","assured","astonishing","bright","brilliant","bronze","coordinated","courageous","courteous","crafty","crazy","creamy","creative","crisp","distant","distinct","downright","evergreen","everlasting","every","evil","excellent","excitable","exemplary","exhausted","forthright","fortunate","fragrant","frank","free","frequent","fresh","friendly","frightened","frigid","gripping","grounded","honest","honorable","honored","hopeful","hospitable","hot","huge","infatuated","infinite","informal","insistent","instructive","juicy","jumbo","knowing","knowledgeable","longterm","loud","lovable","loving","modern","modest","monumental","normal","notable","outgoing","precious","pretty","prickly","primary","pristine","private","prize","productive","profitable","quiet","quintessential","roasted","robust","square","squiggly","stable","staid","starry","steel","stimulating","striking","striped","strong","studious","stunning","tough","trained","treasured","tremendous","triangular","tricky","unused","unusual","upbeat","virtual","witty","wonderful","wooden","worldly","youthful","attached","attentive","attractive","austere","authentic","automatic","aware","awesome","bubbly","bustling","busy","buttery","cuddly","cultured","curly","curvy","cute","cylindrical","downright","dramatic","excited","exciting","exotic","experienced","expert","frosty","fruitful","full","fumbling","funny","fussy","growing","grown","gummy","humble","humongous","hungry","intelligent","interesting","known","kooky","loyal","lucky","luminous","lustrous","luxurious","multicolored","mysterious","noteworthy","numb","nutritious","outstanding","overjoyed","proper","proud","prudent","punctual","puny","pure","puzzled","puzzling","quirky","stupendous","sturdy","stylish","subdued","subtle","sunny","super","superb","supportive","surprised","sweet","swift","sympathetic","trivial","trusting","trustworthy","trusty","truthful","twin","usable","used","useful","utilized","vital","vivid","worried","worthwhile","worthy","writhing","wry","yummy","chocolate","crimson","cyan","fuchsia","gold","honeydew","lime","linen","magenta","olive","peru","salmon","seashell","sienna","snow","thistle","tomato","transparent","turquoise","violet"],s=["space","land","world","universe","plane","room","nation","plaza","gathering","meetup","get together","conclave","party","domain","dominion","realm","square","commons","park","cosmos","sphere","terrain","spot","zone","area","tract","turf","place","territory","volume","camp","picnic","outing","vacation","adventure","exploration","outing","walkabout","safari","venture","roundtable","barbecue","celebration","festivity","gala","shindig","social","convention","assembly","congregation","rendezvous","huddle","meet","soiree"];function o(){const e=e=>{const t=e[Math.floor(Math.random()*e.length)];return t.charAt(0).toUpperCase()+t.slice(1)};return`${e(a)} ${e(a)} ${e(s)}`}var r=i(4),l=i(50);function c(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function d(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){c(s,n,a,o,r,"next",e)}function r(e){c(s,n,a,o,r,"throw",e)}o(void 0)})}}function h(){return!!r.a.RETICULUM_SERVER}function u(){return h()&&document.location.host!==r.a.RETICULUM_SERVER}i.d(t,"j",function(){return h}),i.d(t,"l",function(){return u}),i.d(t,"h",function(){return m}),i.d(t,"k",function(){return v}),i.d(t,"i",function(){return y}),i.d(t,"a",function(){return w}),i.d(t,"e",function(){return x}),i.d(t,"d",function(){return S}),i.d(t,"b",function(){return C}),i.d(t,"f",function(){return T}),i.d(t,"g",function(){return M}),i.d(t,"m",function(){return L}),i.d(t,"c",function(){return R});const p=document.createElement("a");function m(e,t=!1){return h()?`https://${r.a.RETICULUM_SERVER}${e}`:t?(p.href=e,p.href):e}let g=null,f=!1;function v(){return b.apply(this,arguments)}function b(){return(b=d(function*(){f=!0,g=null})).apply(this,arguments)}function y(){return _.apply(this,arguments)}function _(){return(_=d(function*(){g||(!f&&document.querySelector("meta[name='ret:version']")?g={version:document.querySelector("meta[name='ret:version']").getAttribute("value"),pool:document.querySelector("meta[name='ret:pool']").getAttribute("value"),phx_host:document.querySelector("meta[name='ret:phx_host']").getAttribute("value")}:yield fetch(m("/api/v1/meta")).then(function(){var e=d(function*(e){g=yield e.json()});return function(t){return e.apply(this,arguments)}}()));const e=new URLSearchParams(location.search).get("phx_host");return e&&(g.phx_host=e),g})).apply(this,arguments)}function w(){return E.apply(this,arguments)}function E(){return(E=d(function*(e=!1,t=null,i=n.b){const a=new URLSearchParams(location.search),s=function(){var e=d(function*(){const e=a.get("phx_protocol")||r.a.RETICULUM_SOCKET_PROTOCOL||("https:"===document.location.protocol?"wss:":"ws:");let t=a.get("phx_host"),i=a.get("phx_port");const n=yield y();return`${e}//${t=t||r.a.RETICULUM_SOCKET_SERVER||n.phx_host}${(i=i||(h()?new URL(`${e}//${r.a.RETICULUM_SERVER}`).port:"443"))?`:${i}`:""}`});return function(){return e.apply(this,arguments)}}(),o=yield s();console.log(`Phoenix Socket URL: ${o}`);const l={};e&&(l.logger=(e,t,i)=>{console.log(`${e}: ${t}`,i)}),t&&(l.params=t);const c=new i(`${o}/socket`,l);return c.connect(),c.onError(d(function*(){v();const e=new URL(c.endPoint).pathname,t=`${yield s()}${e}`;console.log(`Socket error, changed endpoint to ${t}`),c.endPoint=t})),c})).apply(this,arguments)}function x(e){const t=new URL(e);return m(t.pathname.replace(".png",".html")+t.search,!0)}function S(e,t="GET",i){const{token:n}=window.APP.store.state.credentials,a=m(e),s={headers:{"content-type":"application/json"},method:t};return n&&(s.headers.authorization=`bearer ${n}`),i&&(s.body=JSON.stringify(i)),fetch(a,s).then(function(){var e=d(function*(e){const t=yield e.text();try{return JSON.parse(t)}catch(e){return t}});return function(t){return e.apply(this,arguments)}}())}function C(e,t,i){return k.apply(this,arguments)}function k(){return(k=d(function*(e,t,i){const n=m("/api/v1/hubs"),a={hub:{name:e||o()}};t&&(a.hub.scene_id=t);const s={"content-type":"application/json"},r=new l.b;r.state&&r.state.credentials.token&&(s.authorization=`bearer ${r.state.credentials.token}`);let c=yield fetch(n,{body:JSON.stringify(a),headers:s,method:"POST"}).then(e=>e.json());"invalid_token"===c.error&&(r.update({credentials:{token:null,email:null}}),delete s.authorization,c=yield fetch(n,{body:JSON.stringify(a),headers:s,method:"POST"}).then(e=>e.json()));const d=c;let h=d.url;const p=d.creator_assignment_token;if(p){r.update({creatorAssignmentTokens:[{hubId:d.hub_id,creatorAssignmentToken:p}]});const e=d.embed_token;e&&r.update({embedTokens:[{hubId:d.hub_id,embedToken:e}]})}u()&&(h="/custom-hubs-template/"+`hub.html?hub_id=${d.hub_id}`),i?document.location.replace(h):document.location=h})).apply(this,arguments)}function A(e,t){const i=(Object.entries(e||{}).find(([e])=>e===t)||[])[1];return i&&i.metas&&i.metas[0]||{}}function T(e,t){return(A(e,t)||{}).context||{}}function M(e,t){return(A(e,t)||{}).profile||{}}function L(e,t,i){const n=t.channel(e.topic,i||e.params);for(let t=0,i=e.bindings.length;t<i;t++){const i=e.bindings[t];n.on(i.event,i.callback)}for(let t=0,i=e.pushBuffer.length;t<i;t++){const i=e.pushBuffer[t];n.push(i.event,i.payload,i.timeout)}const a=e.joinPush,s=n.join();for(let e=0,t=a.recHooks.length;e<t;e++){const t=a.recHooks[e];s.receive(t.status,t.callback)}return new Promise(t=>{s.receive("ok",()=>{e.bindings=[],t(n)})})}function R(e){const t=[];for(const i of Object.values(e))for(const e of i.metas)e.profile&&e.profile.discordBridges&&Array.prototype.push.apply(t,e.profile.discordBridges.map(e=>e.channel.name));return t}},,function(e,t,i){e.exports={"media-browser":"media-browser__media-browser__y0Hsu",mediaBrowser:"media-browser__media-browser__y0Hsu",facets:"media-browser__facets__1Yz65",facet:"media-browser__facet__2uP6U",body:"media-browser__body__j6Tv2",pager:"media-browser__pager__RKx5O","header-center":"media-browser__header-center__2D9CW",headerCenter:"media-browser__header-center__2D9CW",search:"media-browser__search__3gQ84","header-left":"media-browser__header-left__1ObQh",headerLeft:"media-browser__header-left__1ObQh","engine-attribution":"media-browser__engine-attribution__2P2aD",engineAttribution:"media-browser__engine-attribution__2P2aD","engine-attribution-contents":"media-browser__engine-attribution-contents__gCdfr",engineAttributionContents:"media-browser__engine-attribution-contents__gCdfr","favorites-header":"media-browser__favorites-header__1XzZx",favoritesHeader:"media-browser__favorites-header__1XzZx","search-clear":"media-browser__search-clear__2GkP3",searchClear:"media-browser__search-clear__2GkP3","search-icon":"media-browser__search-icon__g1Sj9",searchIcon:"media-browser__search-icon__g1Sj9",box:"media-browser__box__1KHYi",header:"media-browser__header__zqZ09","no-search":"media-browser__no-search__3N90H",noSearch:"media-browser__no-search__3N90H",nav:"media-browser__nav__9J5If","nav-right-pad":"media-browser__nav-right-pad__1qH0B",navRightPad:"media-browser__nav-right-pad__1qH0B","nav-source":"media-browser__nav-source__o6NI6",navSource:"media-browser__nav-source__o6NI6","nav-source-selected":"media-browser__nav-source-selected__2osjH",navSourceSelected:"media-browser__nav-source-selected__2osjH","nav-scroll-arrow":"media-browser__nav-scroll-arrow__2Nikk",navScrollArrow:"media-browser__nav-scroll-arrow__2Nikk",tiles:"media-browser__tiles__1BYEY",tile:"media-browser__tile__2lzHU",info:"media-browser__info__2c8Zs",name:"media-browser__name__RFiE4",attribution:"media-browser__attribution__3glgj",creator:"media-browser__creator__3LDPh",publisher:"media-browser__publisher__mTzsX","last-joined":"media-browser__last-joined__2DVWf",lastJoined:"media-browser__last-joined__2DVWf","tile-link":"media-browser__tile-link__IXyUO",tileLink:"media-browser__tile-link__IXyUO","tile-content":"media-browser__tile-content__1QYSP",tileContent:"media-browser__tile-content__1QYSP","avatar-tile":"media-browser__avatar-tile__qNo2r",avatarTile:"media-browser__avatar-tile__qNo2r",favorite:"media-browser__favorite__1vVd0","tile-actions":"media-browser__tile-actions__1QXbx",tileActions:"media-browser__tile-actions__1QXbx",presence:"media-browser__presence__2l7SM","create-tile":"media-browser__create-tile__RL9vr",createTile:"media-browser__create-tile__RL9vr","create-avatar-tile":"media-browser__create-avatar-tile__2dxlP",createAvatarTile:"media-browser__create-avatar-tile__2dxlP","tiles-variable":"media-browser__tiles-variable__1ZNxg",tilesVariable:"media-browser__tiles-variable__1ZNxg","page-number":"media-browser__page-number__OTpSH",pageNumber:"media-browser__page-number__OTpSH","pager-button-disabled":"media-browser__pager-button-disabled__ytlSN",pagerButtonDisabled:"media-browser__pager-button-disabled__ytlSN","header-right":"media-browser__header-right__3k3JZ",headerRight:"media-browser__header-right__3k3JZ","create-button":"media-browser__create-button__30hMV",createButton:"media-browser__create-button__30hMV","create-link":"media-browser__create-link__28Bpj",createLink:"media-browser__create-link__28Bpj","empty-string":"media-browser__empty-string__3r0tc",emptyString:"media-browser__empty-string__3r0tc","media-browser-inline":"media-browser__media-browser-inline__3AgWD",mediaBrowserInline:"media-browser__media-browser-inline__3AgWD"}},function(e,t,i){"use strict";i.d(t,"j",function(){return g}),i.d(t,"h",function(){return f}),i.d(t,"i",function(){return v}),i.d(t,"a",function(){return b}),i.d(t,"b",function(){return y}),i.d(t,"c",function(){return w}),i.d(t,"g",function(){return L}),i.d(t,"f",function(){return P}),i.d(t,"e",function(){return D}),i.d(t,"d",function(){return O});var n=i(8),a=i(4);function s(e,t){s=function(e,t){return new r(e,t)};var i=o(RegExp),n=RegExp.prototype,a=new WeakMap;function r(e,t){var n=i.call(this,e);return a.set(n,t),n}function c(e,i){var n=a.get(i);return Object.keys(t).reduce(function(t,i){return t[i]=e[n[i]],t},Object.create(null))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(r,i),r.prototype.exec=function(e){var t=n.exec.call(this,e);return t&&(t.groups=c(t,this)),t},r.prototype[Symbol.replace]=function(e,t){if("string"==typeof t){var i=a.get(this);return n[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,function(e,t){return"$"+i[t]}))}if("function"==typeof t){var s=this;return n[Symbol.replace].call(this,e,function(){var e=[];return e.push.apply(e,arguments),"object"!=typeof e[e.length-1]&&e.push(c(e,s)),t.apply(this,e)})}return n[Symbol.replace].call(this,e,t)},s.apply(this,arguments)}function o(e){var t="function"==typeof Map?new Map:void 0;return(o=function(e){if(null===e||(i=e,-1===Function.toString.call(i).indexOf("[native code]")))return e;var i;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return r(e,arguments,c(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),l(n,e)})(e)}function r(e,t,i){return(r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,i){var n=[null];n.push.apply(n,t);var a=new(Function.bind.apply(e,n));return i&&l(a,i.prototype),a}).apply(null,arguments)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function h(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){d(s,n,a,o,r,"next",e)}function r(e){d(s,n,a,o,r,"throw",e)}o(void 0)})}}const u=(a.a.NON_CORS_PROXY_DOMAINS||"").split(",");a.a.CORS_PROXY_SERVER&&u.push(a.a.CORS_PROXY_SERVER),u.push(document.location.hostname);const p={gltf:"model/gltf",glb:"model/gltf-binary",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",pdf:"application/pdf",mp4:"video/mp4",mp3:"audio/mpeg"};const m=e=>(function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(e,t)=>String.fromCharCode("0x"+t)))})(e).replace(/=+$/g,"").replace(/\+/g,"-").replace(/\//g,"_"),g=(e,t,i)=>{let s="";try{const t=new URL(e).pathname.split(".");if(t.length>1){const e=t.pop();p[e]&&(s=`.${e}`)}}catch(e){s=".png"}const o=`https://${a.a.THUMBNAIL_SERVER}/thumbnail/${m(e)}${s}?w=${t}&h=${i}`;try{const t=new URL(e).hostname;if(Object(n.j)()){if(new URL(`https://${a.a.RETICULUM_SERVER}`).hostname===t)return e}}catch(e){return o}return o},f=e=>u.find(t=>e.endsWith(t)),v=e=>{if(!e.startsWith("http:")&&!e.startsWith("https:"))return e;try{const t=new URL(e);if(f(t.hostname))return e}catch(e){}return`https://${a.a.CORS_PROXY_SERVER}/${e}`};function b(e,t){return function(e,t){return new URL(t,e)}(e,t).href}const y=e=>t=>{if("string"!=typeof t||""===t)return"";if(/^(https?:)?\/\//i.test(t))return t;if(/^data:.*,.*$/i.test(t))return t;if(/^blob:.*$/i.test(t))return t;if(a.a.CORS_PROXY_SERVER){const i=`https://${a.a.CORS_PROXY_SERVER}/`;if(e.startsWith(i)){const n=decodeURIComponent(e.substring(i.length)).split("/"),a=new URL(t).pathname;return i+(n.slice(0,n.length-1).join("/")+"/"+a)}}return t},_=/data:([a-zA-Z0-9]+\/[a-zA-Z0-9-.+]+).*,.*/,w=e=>{if(!e)return;if(e.startsWith("hubs://")&&e.endsWith("/video"))return"video/vnd.hubs-webrtc";if(e.startsWith("data:")){const t=_.exec(e);t.length>0&&t[1]}const t=new URL(e,window.location).pathname.split(".").pop();return p[t]},E=new Map;function x(e){return S.apply(this,arguments)}function S(){return(S=h(function*(e){if(!e)return!1;e.startsWith("http")||(e="https://"+e);const{origin:t}=new URL(e);if(E.has(t))return E.get(t);let i;try{i=(yield fetch(v(t),{method:"HEAD"})).headers.has("hub-name")}catch(e){i=!1}return E.set(t,i),i})).apply(this,arguments)}const C=/https?:\/\/[^\/]+\/scenes\/(\w+)\/?\S*/,k=s(/https?:\/\/[^\/]+\/avatars\/(\w+)\/?\S*/,{id:1}),A=/(https?:\/\/)?[^\/]+\/([a-zA-Z0-9]{7})\/?\S*/,T=function(){var e=h(function*(e){return(yield x(e))&&new URL(e).origin===document.location.origin});return function(t){return e.apply(this,arguments)}}(),M=function(){var e=h(function*(e){return(yield x(e))&&C.test(e)});return function(t){return e.apply(this,arguments)}}(),L=function(){var e=h(function*(e){return(yield M(e))&&(yield T(e))});return function(t){return e.apply(this,arguments)}}(),R=function(){var e=h(function*(e){return(yield x(e))&&k.test(e)});return function(t){return e.apply(this,arguments)}}(),P=function(){var e=h(function*(e){return(yield R(e))&&(yield T(e))});return function(t){return e.apply(this,arguments)}}(),D=function(){var e=h(function*(e){return(yield x(e))&&!(yield R(e))&&!(yield M(e))&&A.test(e)});return function(t){return e.apply(this,arguments)}}(),O=e=>{const t=e.match(k);return t?t.groups.id:null}},function(e,t,i){"use strict";i.d(t,"h",function(){return a}),i.d(t,"i",function(){return s}),i.d(t,"f",function(){return r}),i.d(t,"l",function(){return c}),i.d(t,"e",function(){return h}),i.d(t,"g",function(){return u}),i.d(t,"j",function(){return p}),i.d(t,"m",function(){return m}),i.d(t,"a",function(){return g}),i.d(t,"b",function(){return f}),i.d(t,"c",function(){return v}),i.d(t,"k",function(){return b}),i.d(t,"d",function(){return y});const n=new THREE.Vector3;new THREE.Quaternion;function a(e,t){return e.updateMatrices(),t.setFromMatrixPosition(e.matrixWorld),t}function s(e,t){return e.updateMatrices(),e.matrixWorld.decompose(n,t,n),t}function o(e){e.map&&e.map.dispose(),e.lightMap&&e.lightMap.dispose(),e.bumpMap&&e.bumpMap.dispose(),e.normalMap&&e.normalMap.dispose(),e.specularMap&&e.specularMap.dispose(),e.envMap&&e.envMap.dispose(),e.dispose()}function r(e){if(e instanceof THREE.Mesh&&(e.geometry&&e.geometry.dispose(),e.material)){let t;e.material instanceof THREE.MeshFaceMaterial||e.material instanceof THREE.MultiMaterial?t=e.material.materials:e.material instanceof Array&&(t=e.material),t?t.forEach(o):o(e.material)}}const l=(new THREE.Matrix4).identity();function c(e,t){e.matrixIsModified||e.applyMatrix(l),e.matrixWorld.copy(t),e.parent?e.matrix=e.matrix.getInverse(e.parent.matrixWorld).multiply(e.matrixWorld):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale),e.childrenNeedMatrixWorldUpdate=!0}function d(e,t){const i=e.tracks.map(e=>(function(e,t){const{nodeName:i,objectName:n,objectIndex:a,propertyName:s,propertyIndex:o}=THREE.PropertyBinding.parseTrackName(e.name);let r="";if(void 0!==i){const e=t.get(i);void 0===e&&console.warn(`Could not find KeyframeTrack target with uuid: "${i}"`),r+=e}void 0!==n&&(r+="."+n),void 0!==a&&(r+="["+a+"]"),void 0!==s&&(r+="."+s),void 0!==o&&(r+="["+o+"]");const l=e.clone();return l.name=r,l})(e,t));return new THREE.AnimationClip(e.name,e.duration,i)}function h(e,t){const i=new Map,n=new Map,a=e.clone();return function e(t,i,n){n(t,i);for(let a=0;a<t.children.length;a++)e(t.children[a],i.children[a],n)}(e,a,(e,t)=>{i.set(e,t)}),e.traverse(e=>{const a=i.get(e);t&&(a.uuid=e.uuid),n.set(e.uuid,a.uuid)}),e.traverse(e=>{const t=i.get(e);if(!t)return;if(e.animations&&(t.animations=e.animations.map(e=>d(e,n))),e.isMesh&&e.geometry.boundsTree&&(t.geometry.boundsTree=e.geometry.boundsTree),!e.isSkinnedMesh)return;const a=e.skeleton.bones;t.skeleton=e.skeleton.clone(),t.skeleton.bones=a.map(e=>{if(!i.has(e))throw new Error("Required bones are not descendants of the given object.");return i.get(e)}),t.bind(t.skeleton,e.bindMatrix)}),a}function u(e,t){let i=[e];for(;i.length;){const e=i.shift();if(t(e))return e;e.children&&(i=i.concat(e.children))}return null}const p=function(){const e=new THREE.Matrix4,t={position:new THREE.Vector3,quaternion:new THREE.Quaternion,scale:new THREE.Vector3},i={position:new THREE.Vector3,quaternion:new THREE.Quaternion,scale:new THREE.Vector3},n={position:new THREE.Vector3,quaternion:new THREE.Quaternion,scale:new THREE.Vector3};return function(a,s,o,r){return i.quaternion.setFromRotationMatrix(e.extractRotation(a)),t.quaternion.setFromRotationMatrix(e.extractRotation(s)),THREE.Quaternion.slerp(i.quaternion,t.quaternion,n.quaternion,o),n.position.lerpVectors(i.position.setFromMatrixColumn(a,3),t.position.setFromMatrixColumn(s,3),o),n.scale.lerpVectors(i.scale.setFromMatrixScale(a),t.scale.setFromMatrixScale(s),o),r.compose(n.position,n.quaternion,n.scale)}}(),m=function(){const e=new THREE.Vector3,t=new THREE.Vector3;return function(i,n){return i.updateMatrices(),n.updateMatrices(),e.setFromMatrixColumn(i.matrixWorld,3),t.setFromMatrixColumn(n.matrixWorld,3),e.distanceToSquared(t)}}();const g=function(){const e=new THREE.Matrix4,t=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3,s=new THREE.Vector3,o=new THREE.Matrix4;return function(r,l){return e.identity().extractRotation(o.copy(r)),t.setFromMatrixColumn(e,2).multiplyScalar(-1),i.copy(t).sub(s.copy(t).projectOnVector(a.set(0,1,0))).normalize(),n.crossVectors(i,a),l.makeBasis(n,a,i.multiplyScalar(-1)),l.scale(s.setFromMatrixScale(o)),l.setPosition(s.setFromMatrixColumn(o,3)),l}}(),f=function(){const e=new THREE.Matrix4,t=new THREE.Matrix4,i=new THREE.Matrix4;return function(n,a,s){g(n,e),i.getInverse(e).multiply(n),g(a,t),s.copy(t).multiply(i)}}(),v=function(e,t,i,n,a,s){const o=Math.max(Math.abs(n.max.y-a.y),Math.abs(a.y-n.min.y)),r=Math.max(Math.abs(n.max.x-a.x),Math.abs(a.x-n.min.x)),l=THREE.Math.degToRad(e/2),c=Math.atan(Math.tan(l)*t)*(s?.5:1),d=Math.abs(1.05*o/Math.tan(l)),h=Math.abs(1.05*r/Math.tan(c)),u=Math.abs(n.max.z-a.z)+Math.max(d,h);return(s?Math.max(.25,u):u)||1.25},b=function(){const e=new THREE.Matrix4,t=new THREE.Matrix4,i=new THREE.Matrix4,n=new THREE.Vector3;return function(a,s,o){return e.copy(a),o.copy(i.makeRotationY(s).multiply(t.extractRotation(e))).scale(n.setFromMatrixScale(e)).setPosition(n.setFromMatrixPosition(e))}}(),y=function(){const e=new THREE.Matrix4,t=new THREE.Matrix4;return function(i,n,a){n.updateMatrices(),e.getInverse(n.matrix),t.multiplyMatrices(a,e),c(i,t)}}()},,function(e,t,i){"use strict";i.d(t,"b",function(){return n}),i.d(t,"a",function(){return a});const n=function(e,t){return new Promise(i=>{t.addEventListener(e,i,{once:!0})})},a=function(){return"complete"===document.readyState||"loaded"===document.readyState||"interactive"===document.readyState?Promise.resolve(null):n("DOMContentLoaded",window)}},function(e,t,i){"use strict";i.d(t,"a",function(){return o}),i.d(t,"b",function(){return l});var n=i(4),a=i(35);const s=(navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage).toLowerCase().split(/[_-]+/)[0],o=a[s]&&s||"en",r=a[o]||a.en;if(n.a.APP_CONFIG&&n.a.APP_CONFIG.translations&&n.a.APP_CONFIG.translations[o]){const e=n.a.APP_CONFIG.translations[o];for(const t in e)e.hasOwnProperty(t)&&e[t]&&(r[t]=e[t])}const l=Object.entries(r).map(([e,t])=>[e,t.replace(/%([\w-.]+)%/i,(e,t)=>r[t])]).reduce((e,t)=>(e[t[0]]=t[1],e),{})},function(e,t,i){"use strict";function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t,i,a,s,o,r){let l={};const c=(e.location.state&&e.location.state.__historyLength||0)+(t?0:1);(i||o||r)&&(delete(l=e.location.state?function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},a=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),a.forEach(function(t){n(e,t,i[t])})}return e}({},e.location.state):{}).__duplicate,i&&(l[i]=a,l.key=i,l.value=a,l.detail=s));const d=void 0!==o?o:"/"===e.location.pathname?"":e.location.pathname,h=void 0!==r?r:e.location.search,u=e.location.state&&e.location.state.__duplicate,p=t||u?e.replace:e.push;l.__historyLength=c,p({pathname:d,search:h,state:l})}function s(e,t,i,n){a(e,!1,t,i,n)}function o(e,t,i,n){a(e,!0,t,i,n)}function r(e,t,i){a(e,!1,null,null,null,t,i)}function l(e){a(e,!1)}function c(e,t){if(!e.location.state||void 0===e.location.state.__historyLength)return;const i=e.location.state.__historyLength;return 0!==i?new Promise(n=>{const a=e.listen(()=>{a(),e.push({pathname:e.location.pathname,search:e.location.search,state:{__historyLength:0,__duplicate:!0}}),t&&e.go(-2),n()});e.go(-i)}):void 0}function d(e){c(e,!0)}function h(e){return`/${e.pathname.split("/").slice(2).join("/")}`}function u(e,t){return`/${e.pathname.split("/")[1]}${t}`}i.d(t,"e",function(){return s}),i.d(t,"f",function(){return o}),i.d(t,"d",function(){return r}),i.d(t,"a",function(){return l}),i.d(t,"c",function(){return c}),i.d(t,"b",function(){return d}),i.d(t,"g",function(){return h}),i.d(t,"h",function(){return u})},function(e,t,i){"use strict";var n,a,s,o=i(34),r=i(8),l=i(166),c=i.n(l),d=i(48);function h(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}class u{constructor(e=THREE.DefaultLoadingManager){this.manager=e}load(e,t,i,n){const a=new THREE.Texture;return this.loadTextureAsync(a,e,i).then(t).catch(n),a}loadTextureAsync(e,t,i){var n,a=this;return(n=function*(){let n;void 0!==window.createImageBitmap?(n=new THREE.ImageBitmapLoader(a.manager),e.flipY=!1):n=new THREE.ImageLoader(a.manager),n.setCrossOrigin(a.crossOrigin),n.setPath(a.path);const s=a.manager.resolveURL(t);return e.image=yield function(e,t,i){return new Promise((n,a)=>e.load(t,n,i,a))}(n,t,i),THREE.Cache.remove(s),e.needsUpdate=!0,e.onUpdate=function(){e.image.close&&e.image.close(),delete e.image},e},function(){var e=this,t=arguments;return new Promise(function(i,a){var s=n.apply(e,t);function o(e){h(s,i,a,o,r,"next",e)}function r(e){h(s,i,a,o,r,"throw",e)}o(void 0)})})()}setCrossOrigin(e){return this.crossOrigin=e,this}setPath(e){return this.path=e,this}}s="anonymous",(a="crossOrigin")in(n=u)?Object.defineProperty(n,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[a]=s;var p=i(149),m=i(11),g=i(137),f=i.n(g),v=i(150),b=i.n(v),y=i(124);function _(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function w(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){_(s,n,a,o,r,"next",e)}function r(e){_(s,n,a,o,r,"throw",e)}o(void 0)})}}i.d(t,"h",function(){return A}),i.d(t,"k",function(){return T}),i.d(t,"m",function(){return M}),i.d(t,"f",function(){return L}),i.d(t,"b",function(){return R}),i.d(t,"d",function(){return P}),i.d(t,"j",function(){return D}),i.d(t,"i",function(){return O}),i.d(t,"a",function(){return j}),i.d(t,"l",function(){return I}),i.d(t,"g",function(){return N}),i.d(t,"c",function(){return V}),i.d(t,"e",function(){return B});const E=f()();E.tlds(b.a);const x=Object(r.h)("/api/v1/media"),S=AFRAME.utils.device.isMobile(),C=AFRAME.utils.device.isMobile(),k=new Map,A=(e=!1)=>{const t=S||C;return e?t?"low_360":"high_360":t?"low":"high"},T=function(){var e=w(function*(e,t=null,i=1){const n=`${e}_${i}`;if(k.has(n))return k.get(n);const a=fetch(x,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({media:{url:e,quality:t||A()},version:i})}).then(function(){var t=w(function*(t){if(!t.ok){const i=`Error resolving url "${e}":`;try{const e=yield t.text();throw new Error(i+" "+e)}catch(e){throw new Error(i+" "+t.statusText)}}return t.json()});return function(e){return t.apply(this,arguments)}}());return k.set(n,a),a});return function(t){return e.apply(this,arguments)}}(),M=(e,t)=>{const i=new FormData;return i.append("media",e),i.append("promotion_mode","with_token"),t&&i.append("desired_content_type",t),fetch(x,{method:"POST",body:i}).then(e=>e.json())};function L(e){return E.test(e)?e.indexOf("://")>=0?e:`https://${e}`:e}const R=(e,t,i,n=null,a=!1,s=!1,r=!0,l={},c=!0,d=null,h=null)=>{const u=AFRAME.scenes[0],p=document.createElement("a-entity");if(c)p.setAttribute("networked",{template:t});else{const e=document.importNode(document.body.querySelector(t).content,!0).firstElementChild.cloneNode(!0),i=e.attributes;for(let e=0;e<i.length;e++)p.setAttribute(i[e].name,i[e].value);for(;e.firstElementChild;)p.appendChild(e.firstElementChild)}const g=e instanceof File,f=function(e){const t=document.querySelectorAll("[media-loader]");let i=1;for(const n of t){const t=n.components["media-loader"];t.data&&t.data.src===e&&(i=Math.max(i,t.data.version))}return i}(e);p.setAttribute("media-loader",{fitToBox:s,resolve:a,animate:r,src:"string"==typeof e?L(e)||e:"",version:f,contentSubtype:n,fileIsOwned:!g,linkedEl:h,mediaOptions:l}),p.object3D.matrixNeedsUpdate=!0,(d||u).appendChild(p);const v=new Promise(function(t){g?function(e,t){const i=new FileReader;i.onload=function(e){const i=new DataView(e.target.result);if(65496!=i.getUint16(0,!1))return t(-2);const n=i.byteLength;let a=2;for(;a<n;){if(i.getUint16(a+2,!1)<=8)return t(-1);const e=i.getUint16(a,!1);if(a+=2,65505==e){if(1165519206!=i.getUint32(a+=2,!1))return t(-1);const e=18761==i.getUint16(a+=6,!1);a+=i.getUint32(a+4,e);const n=i.getUint16(a,e);a+=2;for(let s=0;s<n;s++)if(274==i.getUint16(a+12*s,e))return t(i.getUint16(a+12*s+8,e))}else{if(65280!=(65280&e))break;a+=i.getUint16(a,!1)}}return t(-1)},i.readAsArrayBuffer(e)}(e,e=>{t(e)}):t(1)});if(g){M(e,"video-camera"===n?"video/mp4":null).then(e=>{const t=new URL(Object(m.i)(e.origin));t.searchParams.set("token",e.meta.access_token),p.setAttribute("media-loader",{resolve:!1,src:t.href,fileId:e.file_id}),window.APP.store.update({uploadPromotionTokens:[{fileId:e.file_id,promotionToken:e.meta.promotion_token}]})}).catch(e=>{console.error("Media upload failed",e),p.setAttribute("media-loader",{src:"error"})})}else e instanceof MediaStream&&p.setAttribute("media-loader",{src:`hubs://clients/${NAF.clientId}/video`});return i&&p.addEventListener("media_resolved",({detail:e})=>{const t=Object(o.c)(i,e.contentType,e.src);u.emit("object_spawned",{objectType:t})}),{entity:p,orientation:v}},P=(e,t,i=null,n=!0,a=!1,s=null)=>{i||({src:i}=e.components["media-loader"].data);const{contentSubtype:r,fitToBox:l,mediaOptions:c}=e.components["media-loader"].data;return R(i,t,o.a.URL,r,!0,l,!1,c,n,s,a?e:null)};function D(e){const t=/\bskinning_vertex\b/,i=/\bgl_FragColor\b/,n=[],a=AFRAME.scenes[0].systems["hubs-systems"].batchManagerSystem;return e.traverse(s=>{s.material&&(s.material=Object(d.b)(s,o=>{if(o.hubs_InjectedCustomShaderChunks)return o;if(!p.a.includes(o.type))return o;if(s.el.classList.contains("ui")||s.el.classList.contains("hud")||s.el.getAttribute("text-button"))return o;a.meshToEl.set(s,e.el);const r=o.clone();return r.onBeforeCompile=e=>{if(!t.test(e.vertexShader))return;e.uniforms.hubs_IsFrozen={value:!1},e.uniforms.hubs_EnableSweepingEffect={value:!1},e.uniforms.hubs_SweepParams={value:[0,0]},e.uniforms.hubs_InteractorOnePos={value:[0,0,0]},e.uniforms.hubs_InteractorTwoPos={value:[0,0,0]},e.uniforms.hubs_HighlightInteractorOne={value:!1},e.uniforms.hubs_HighlightInteractorTwo={value:!1},e.uniforms.hubs_Time={value:0};const a=e.vertexShader.split("\n"),s=a.findIndex(e=>t.test(e));a.splice(s+1,0,"\n        if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\n          vec4 wt = modelMatrix * vec4(transformed, 1);\n\n          // Used in the fragment shader below.\n          hubs_WorldPosition = wt.xyz;\n        }\n        "),a.unshift("varying vec3 hubs_WorldPosition;"),a.unshift("uniform bool hubs_IsFrozen;"),a.unshift("uniform bool hubs_HighlightInteractorOne;"),a.unshift("uniform bool hubs_HighlightInteractorTwo;"),e.vertexShader=a.join("\n");const o=e.fragmentShader.split("\n"),r=o.findIndex(e=>i.test(e));o.splice(r+1,0,c.a),o.unshift("varying vec3 hubs_WorldPosition;"),o.unshift("uniform bool hubs_IsFrozen;"),o.unshift("uniform bool hubs_EnableSweepingEffect;"),o.unshift("uniform vec2 hubs_SweepParams;"),o.unshift("uniform bool hubs_HighlightInteractorOne;"),o.unshift("uniform vec3 hubs_InteractorOnePos;"),o.unshift("uniform bool hubs_HighlightInteractorTwo;"),o.unshift("uniform vec3 hubs_InteractorTwoPos;"),o.unshift("uniform float hubs_Time;"),e.fragmentShader=o.join("\n"),n.push(e.uniforms)},r.needsUpdate=!0,r.hubs_InjectedCustomShaderChunks=!0,r}))}),n}function O(e){return window.APP.store.state.uploadPromotionTokens.find(t=>t.fileId===e)}const H=new THREE.Vector3;function j(e,t,i,n,a=!1,s=.75){const{entity:o,orientation:r}=R(t,"#interactable-media",void 0,i,!1),l=e.object3D.position;o.object3D.position.set(l.x,l.y,l.z),o.object3D.rotation.copy(e.object3D.rotation),a&&o.object3D.rotateY(Math.PI);const c=n%6+3;H.set(Math.cos(2*Math.PI*(c/6))*s,Math.sin(2*Math.PI*(c/6))*s,.001*c-.05),e.object3D.localToWorld(H),o.object3D.visible=!1;const d=()=>{o.object3D.visible=!0,o.setAttribute("animation__photo_pos",{property:"position",dur:800,from:{x:l.x,y:l.y,z:l.z},to:{x:H.x,y:H.y,z:H.z},easing:"easeOutElastic"})};let h=null;if(i.startsWith("photo"))o.addEventListener("image-loaded",d,{once:!0}),h="photo";else{if(!i.startsWith("video"))return void console.error("invalid type "+i);o.addEventListener("video-loaded",d,{once:!0}),h="video"}return o.object3D.matrixNeedsUpdate=!0,o.addEventListener("media_resolved",()=>{e.emit(`${h}_taken`,o.components["media-loader"].data.src)},{once:!0}),{entity:o,orientation:r}}const I=(new u).setCrossOrigin("anonymous");function N(e,t){return F.apply(this,arguments)}function F(){return(F=w(function*(e,t){let i;if(t){const n=new Image;n.crossOrigin="anonymous";const a=new Promise(e=>n.addEventListener("load",e,{once:!0}));n.src=e,yield a;const s=document.createElement("canvas");s.width=n.width,s.height=n.height;const o=s.getContext("2d");o.drawImage(n,0,0),yield t(o,n.width,n.height),i=new THREE.CanvasTexture(s)}else{i=new THREE.Texture;try{yield I.loadTextureAsync(i,e)}catch(t){throw new Error(`'${e}' could not be fetched (Error code: ${t.status}; Response: ${t.statusText})`)}}return i.encoding=THREE.sRGBEncoding,i.anisotropy=4,i})).apply(this,arguments)}function V(e,t,i){const n=function(){const t={};return function(i){const n=i.animatables[0].target;n.x=Math.max(Number.MIN_VALUE,n.x),n.y=Math.max(Number.MIN_VALUE,n.y),n.z=Math.max(Number.MIN_VALUE,n.z),n.x===t.x&&n.y===t.y&&n.z===t.z||(t.x=n.x,t.y=n.y,t.z=n.z,e.scale.set(n.x,n.y,n.z),e.matrixNeedsUpdate=!0)}}(),a={duration:400,easing:"easeOutElastic",elasticity:400,loop:0,round:!1,x:e.scale.x,y:e.scale.y,z:e.scale.z,targets:[t],update:e=>n(e),complete:e=>{n(e),i&&i()}};return e.scale.copy(t),e.matrixNeedsUpdate=!0,Object(y.default)(a)}function B(){const e=document.querySelector("#media-mirror-target");if(e.firstChild)return e.firstChild.setAttribute("animation__remove",{property:"scale",dur:200,to:{x:.01,y:.01,z:.01},easing:"easeInQuad"}),new Promise(t=>{e.firstChild.addEventListener("animationcomplete",()=>{e.removeChild(e.firstChild),e.parentEl.object3D.visible=!1,t()})})}},function(e,t,i){"use strict";i.d(t,"f",function(){return I}),i.d(t,"v",function(){return N}),i.d(t,"k",function(){return F}),i.d(t,"l",function(){return V}),i.d(t,"i",function(){return B}),i.d(t,"w",function(){return z}),i.d(t,"u",function(){return U}),i.d(t,"t",function(){return W}),i.d(t,"y",function(){return Z}),i.d(t,"x",function(){return G}),i.d(t,"p",function(){return q}),i.d(t,"r",function(){return $}),i.d(t,"j",function(){return Y}),i.d(t,"b",function(){return X}),i.d(t,"d",function(){return Q}),i.d(t,"o",function(){return K}),i.d(t,"s",function(){return J}),i.d(t,"c",function(){return ee}),i.d(t,"e",function(){return te}),i.d(t,"m",function(){return ie}),i.d(t,"h",function(){return ne}),i.d(t,"g",function(){return ae}),i.d(t,"a",function(){return se}),i.d(t,"n",function(){return re}),i.d(t,"q",function(){return le}),i.d(t,"z",function(){return ce});var n=i(66),a=i.n(n),s=i(247),o=i.n(s),r=i(202),l=i.n(r),c=i(248),d=i.n(c),h=i(249),u=i.n(h),p=i(250),m=i.n(p),g=i(251),f=i.n(g),v=i(252),b=i.n(v),y=i(253),_=i.n(y),w=i(254),E=i.n(w),x=i(255),S=i.n(x),C=i(203),k=i.n(C),A=i(256),T=i.n(A),M=i(257),L=i.n(M),R=i(258),P=i.n(R),D=i(259),O=i.n(D),H=i(12);let j=0;const I=j++,N=j++,F=j++,V=j++,B=j++,z=j++,U=j++,W=j++,Z=j++,G=j++,q=j++,$=j++,Y=j++,X=j++,Q=j++,K=j++,J=j++,ee=j++,te=j++,ie=j++,ne=j++,ae=j++,se=j++,oe=j++,re=j++,le=j++;class ce{constructor(e){this.pendingAudioSourceNodes=[],this.pendingPositionalAudios=[],this.positionalAudiosStationary=[],this.positionalAudiosFollowingObject3Ds=[],this.audioContext=THREE.AudioContext.getContext(),this.scene=e,this.scene.audioListener=this.scene.audioListener||new THREE.AudioListener,this.scene.camera&&this.scene.camera.add(this.scene.audioListener),this.scene.addEventListener("camera-set-active",e=>{e.detail.cameraEl.getObject3D("camera").add(this.scene.audioListener)});const t=[[I,a.a],[N,a.a],[F,a.a],[V,a.a],[B,a.a],[z,a.a],[se,a.a],[U,o.a],[W,l.a],[Z,l.a],[G,a.a],[q,d.a],[$,u.a],[Y,m.a],[X,f.a],[Q,b.a],[K,_.a],[J,E.a],[ee,S.a],[te,k.a],[ie,T.a],[ne,P.a],[ae,L.a],[oe,k.a],[re,a.a],[le,O.a]],i=new Map,n=e=>{let t=i.get(e);return t||(t=fetch(e).then(e=>e.arrayBuffer()).then(e=>(function(e,t){return new Promise((i,n)=>{e.decodeAudioData(t,i,n)})})(this.audioContext,e)),i.set(e,t)),t};this.sounds=new Map,t.map(([e,t])=>{n(t).then(t=>{this.sounds.set(e,t)})})}enqueueSound(e,t){const i=this.sounds.get(e);if(!i)return null;const n=this.audioContext.createBufferSource();return n.buffer=i,n.connect(this.audioContext.destination),n.loop=t,this.pendingAudioSourceNodes.push(n),n}enqueuePositionalSound(e,t){const i=this.sounds.get(e);if(!i)return null;const n=new THREE.PositionalAudio(this.scene.audioListener).setBuffer(i);return n.loop=t,this.pendingPositionalAudios.push(n),n}playPositionalSoundAt(e,t,i){const n=this.enqueuePositionalSound(e,i);if(!n)return null;n.position.copy(t),n.matrixWorldNeedsUpdate=!0,this.positionalAudiosStationary.push(n)}playPositionalSoundFollowing(e,t,i){const n=this.enqueuePositionalSound(e,i);return n?(this.positionalAudiosFollowingObject3Ds.push({positionalAudio:n,object3D:t}),n):null}playSoundOneShot(e){return this.enqueueSound(e,!1)}playSoundLooped(e){return this.enqueueSound(e,!0)}playSoundLoopedWithGain(e){const t=this.sounds.get(e);if(!t)return null;const i=this.audioContext.createBufferSource(),n=this.audioContext.createGain();return i.buffer=t,i.connect(n),n.connect(this.audioContext.destination),i.loop=!0,this.pendingAudioSourceNodes.push(i),{gain:n,source:i}}stopSoundNode(e){const t=this.pendingAudioSourceNodes.indexOf(e);-1!==t?this.pendingAudioSourceNodes.splice(t,1):e.stop()}stopPositionalAudio(e){const t=this.pendingPositionalAudios.indexOf(e);-1!==t?this.pendingPositionalAudios.splice(t,1):(e.isPlaying&&e.stop(),e.parent&&e.parent.remove(e)),this.positionalAudiosStationary=this.positionalAudiosStationary.filter(t=>t!==e),this.positionalAudiosFollowingObject3Ds=this.positionalAudiosFollowingObject3Ds.filter(({positionalAudio:t})=>t!==e)}tick(){for(let e=0;e<this.pendingAudioSourceNodes.length;e++)this.pendingAudioSourceNodes[e].start();this.pendingAudioSourceNodes.length=0;for(let e=0;e<this.pendingPositionalAudios.length;e++){const t=this.pendingPositionalAudios[e];this.scene.object3D.add(t),t.play()}this.pendingPositionalAudios.length=0;for(let e=this.positionalAudiosStationary.length-1;e>=0;e--){const t=this.positionalAudiosStationary[e];t.isPlaying||this.stopPositionalAudio(t)}for(let e=this.positionalAudiosFollowingObject3Ds.length-1;e>=0;e--){const t=this.positionalAudiosFollowingObject3Ds[e],i=t.positionalAudio,n=t.object3D;i.isPlaying&&n.parent?(n.updateMatrices(),Object(H.l)(i,n.matrixWorld)):this.stopPositionalAudio(i)}}}},function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i(4);function a(e){return n.a.feature(e.name)&&e.children||null}},function(e,t,i){"use strict";i.d(t,"a",function(){return u});var n=i(0),a=i.n(n),s=i(2),o=i.n(s),r=i(5),l=i.n(r),c=i(33),d=i(7);function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class u extends n.Component{constructor(e){super(e),h(this,"onContainerClicked",e=>{this.props.closable&&e.currentTarget===e.target&&this.props.onClose()}),this.onKeyDown=this.onKeyDown.bind(this),this.onContainerClicked=this.onContainerClicked.bind(this)}componentDidMount(){window.addEventListener("keydown",this.onKeyDown)}componentWillUnmount(){window.removeEventListener("keydown",this.onKeyDown)}onKeyDown(e){this.props.closable&&"Escape"===e.key&&this.props.onClose()}render(){return a.a.createElement("div",{className:l()("dialog-overlay",this.props.noOverlay?"dialog-overlay__no-pointer-events":"",this.props.className)},a.a.createElement("div",{className:l()("dialog",this.props.noOverlay?"dialog__no-pointer-events":"dialog__dark-background",this.props.noOverlay?"dialog__align-end":""),onClick:this.onContainerClicked},a.a.createElement("div",{className:`dialog__box ${this.props.wide?"dialog__wide":""} `},a.a.createElement("div",{className:l()("dialog__box__contents",this.props.allowOverflow?"dialog__box__contents-overflow":null,this.props.additionalClass)},this.props.closable&&this.props.onClose&&!this.props.noOverlay&&a.a.createElement("button",{className:"dialog__box__contents__close",onClick:()=>this.props.onClose()},a.a.createElement("i",null,a.a.createElement(d.a,{icon:c.faTimes}))),this.props.title&&a.a.createElement("div",{className:"dialog__box__contents__title"},this.props.title),a.a.createElement("div",{className:"dialog__box__contents__body"},this.props.children),a.a.createElement("div",{className:"dialog__box__contents__button-container"})))))}}h(u,"propTypes",{title:o.a.node,children:o.a.node.isRequired,onClose:o.a.func,closable:o.a.bool,wide:o.a.bool,noOverlay:o.a.bool,className:o.a.string,allowOverflow:o.a.bool,additionalClass:o.a.string}),h(u,"defaultProps",{closable:!0})},function(e,t,i){"use strict";i.d(t,"a",function(){return a});const n=new URLSearchParams(location.search);function a(e){const t=n.get(e);return""===t||/1|on|true|yes/i.test(t)}},,function(e,t,i){"use strict";i.d(t,"a",function(){return r}),i.d(t,"b",function(){return l});var n=i(0),a=i.n(n),s=i(2),o=i.n(s);const r=a.a.createContext({}),l=({sound:e,children:t})=>a.a.createElement(r.Consumer,null,i=>a.a.cloneElement(t,{onMouseEnter:n=>{i&&i.playSound&&i.playSound(e||"play_sound-hud_hover_start"),t.props.onMouseEnter&&t.props.onMouseEnter(n)}}));l.propTypes={children:o.a.object,sound:o.a.string}},function(e,t,i){e.exports={"secondary-button":"settings-menu__secondary-button__2Q5_g",secondaryButton:"settings-menu__secondary-button__2Q5_g","bottom-links-main":"settings-menu__bottom-links-main__Vtlje",bottomLinksMain:"settings-menu__bottom-links-main__Vtlje","bottom-links":"settings-menu__bottom-links__b1tDE",bottomLinks:"settings-menu__bottom-links__b1tDE","close-button":"settings-menu__close-button__M0EhC",closeButton:"settings-menu__close-button__M0EhC","settings-menu-drop":"settings-menu__settings-menu-drop__Od2Sa",settingsMenuDrop:"settings-menu__settings-menu-drop__Od2Sa","attach-point":"settings-menu__attach-point__2gV3g",attachPoint:"settings-menu__attach-point__2gV3g",contents:"settings-menu__contents__3GQlW",rows:"settings-menu__rows__2OtlS",row:"settings-menu__row__3w7fz","row-no-margin":"settings-menu__row-no-margin__3rYbX",rowNoMargin:"settings-menu__row-no-margin__3rYbX","row-header":"settings-menu__row-header__2oCqk",rowHeader:"settings-menu__row-header__2oCqk","list-item":"settings-menu__list-item__1__z6",listItem:"settings-menu__list-item__1__z6","list-item-link":"settings-menu__list-item-link__2ovr3",listItemLink:"settings-menu__list-item-link__2ovr3","settings-menu-overlay-wrap":"settings-menu__settings-menu-overlay-wrap__3T7VX",settingsMenuOverlayWrap:"settings-menu__settings-menu-overlay-wrap__3T7VX","settings-menu-overlay":"settings-menu__settings-menu-overlay__3kU9n",settingsMenuOverlay:"settings-menu__settings-menu-overlay__3kU9n","settings-row":"settings-menu__settings-row__1sDDk",settingsRow:"settings-menu__settings-row__1sDDk",icon:"settings-menu__icon__3KMMz","secondary-link-item":"settings-menu__secondary-link-item__1y7xz",secondaryLinkItem:"settings-menu__secondary-link-item__1y7xz"}},,,,function(e,t,i){e.exports={"entry-button-secondary":"entry__entry-button-secondary__1Fr_E",entryButtonSecondary:"entry__entry-button-secondary__1Fr_E","entry-panel":"entry__entry-panel__34CD9",entryPanel:"entry__entry-panel__34CD9","button-container":"entry__button-container__3Blog",buttonContainer:"entry__button-container__3Blog","secondary-action-button":"entry__secondary-action-button__3FCMj",secondaryActionButton:"entry__secondary-action-button__3FCMj","entry-button":"entry__entry-button__G7PQF",entryButton:"entry__entry-button__G7PQF","action-button":"entry__action-button__3Vnab",actionButton:"entry__action-button__3Vnab","collapse-button":"entry__collapse-button__3_PLp",collapseButton:"entry__collapse-button__3_PLp","favorite-button":"entry__favorite-button__2CVuk",favoriteButton:"entry__favorite-button__2CVuk",back:"entry__back__J4Sgl","lobby-label":"entry__lobby-label__2Nj9w",lobbyLabel:"entry__lobby-label__2Nj9w",label:"entry__label__fUhpb",title:"entry__title__1GITj",name:"entry__name__sYOeV","rename-button":"entry__rename-button__KFW9R",renameButton:"entry__rename-button__KFW9R",center:"entry__center__1105W","wide-button":"entry__wide-button__2tfMM",wideButton:"entry__wide-button__2tfMM","screen-sharing":"entry__screen-sharing__NBXQu",screenSharing:"entry__screen-sharing__NBXQu",checkbox:"entry__checkbox__3SoPk","entry-dialog":"entry__entry-dialog__30kMs",entryDialog:"entry__entry-dialog__30kMs",favorited:"entry__favorited__2IHpj",icon:"entry__icon__3JiUl",bolded:"entry__bolded__13B4f",subtitle:"entry__subtitle__1BC2y","room-subtitle":"entry__room-subtitle__7MSMo",roomSubtitle:"entry__room-subtitle__7MSMo",lobby:"entry__lobby__3AxfL","profile-icon":"entry__profile-icon__3BAWG",profileIcon:"entry__profile-icon__3BAWG","button-subtitle":"entry__button-subtitle__3zrEo",buttonSubtitle:"entry__button-subtitle__3zrEo","audio-loader":"entry__audio-loader__1YCJd",audioLoader:"entry__audio-loader__1YCJd","webvr-link-container":"entry__webvr-link-container__3scWP",webvrLinkContainer:"entry__webvr-link-container__3scWP","webvr-link":"entry__webvr-link__3eWuZ",webvrLink:"entry__webvr-link__3eWuZ",secondary:"entry__secondary__3uhYE"}},function(e,t,i){e.exports={ui:"ui-root__ui__33CMU","ui-dialog":"ui-root__ui-dialog__2TY9Y",uiDialog:"ui-root__ui-dialog__2TY9Y","ui-interactive":"ui-root__ui-interactive__2mtC4",uiInteractive:"ui-root__ui-interactive__2mtC4","object-list":"ui-root__object-list__34wMm",objectList:"ui-root__object-list__34wMm","presence-info":"ui-root__presence-info__3cieq",presenceInfo:"ui-root__presence-info__3cieq","corner-button":"ui-root__corner-button__2rfQ5",cornerButton:"ui-root__corner-button__2rfQ5","nag-corner-button":"ui-root__nag-corner-button__3TFW5",nagCornerButton:"ui-root__nag-corner-button__3TFW5","choose-scene-button":"ui-root__choose-scene-button__3VNdD",chooseSceneButton:"ui-root__choose-scene-button__3VNdD","leave-button":"ui-root__leave-button__29u2_",leaveButton:"ui-root__leave-button__29u2_",interstitial:"ui-root__interstitial__1cotl","invite-tip":"ui-root__invite-tip__20NJ6",inviteTip:"ui-root__invite-tip__20NJ6","streaming-tip":"ui-root__streaming-tip__17WYl",streamingTip:"ui-root__streaming-tip__17WYl","streaming-tip-attach-point":"ui-root__streaming-tip-attach-point__3XSH-",streamingTipAttachPoint:"ui-root__streaming-tip-attach-point__3XSH-","streaming-tip-close":"ui-root__streaming-tip-close__1OHPc",streamingTipClose:"ui-root__streaming-tip-close__1OHPc","streaming-tip-message":"ui-root__streaming-tip-message__2XOUD",streamingTipMessage:"ui-root__streaming-tip-message__2XOUD","ui-dialog-box-contents":"ui-root__ui-dialog-box-contents__3XWtl",uiDialogBoxContents:"ui-root__ui-dialog-box-contents__3XWtl",backgrounded:"ui-root__backgrounded__34j0m","in-room-favorite-button":"ui-root__in-room-favorite-button__2I0Kj",inRoomFavoriteButton:"ui-root__in-room-favorite-button__2I0Kj","help-button":"ui-root__help-button__1cq2F",helpButton:"ui-root__help-button__1cq2F","occupant-count":"ui-root__occupant-count__34rGX",occupantCount:"ui-root__occupant-count__34rGX","presence-info-selected":"ui-root__presence-info-selected__1Jhbw",presenceInfoSelected:"ui-root__presence-info-selected__1Jhbw","camera-mode-exit-button":"ui-root__camera-mode-exit-button__2mpbz",cameraModeExitButton:"ui-root__camera-mode-exit-button__2mpbz","corner-button-selected":"ui-root__corner-button-selected__qRY5R",cornerButtonSelected:"ui-root__corner-button-selected__qRY5R","invite-tip-attach-point":"ui-root__invite-tip-attach-point__3rQJ6",inviteTipAttachPoint:"ui-root__invite-tip-attach-point__3rQJ6","avatar-editor":"ui-root__avatar-editor__2mO8z",avatarEditor:"ui-root__avatar-editor__2mO8z"}},function(e,t,i){e.exports={title:"room-info-dialog__title__3-3CO","room-info":"room-info-dialog__room-info__3XkbS",roomInfo:"room-info-dialog__room-info__3XkbS","scene-screenshot":"room-info-dialog__scene-screenshot__3PWz-",sceneScreenshot:"room-info-dialog__scene-screenshot__3PWz-","scene-details":"room-info-dialog__scene-details__2pYml",sceneDetails:"room-info-dialog__scene-details__2pYml","scene-main":"room-info-dialog__scene-main__2mhXj",sceneMain:"room-info-dialog__scene-main__2mhXj","scene-name":"room-info-dialog__scene-name__1bqGh",sceneName:"room-info-dialog__scene-name__1bqGh","scene-creator":"room-info-dialog__scene-creator__3_za4",sceneCreator:"room-info-dialog__scene-creator__3_za4","scene-attributions":"room-info-dialog__scene-attributions__QpYVd",sceneAttributions:"room-info-dialog__scene-attributions__QpYVd",attribution:"room-info-dialog__attribution__I9_V-","attribution-name":"room-info-dialog__attribution-name__3JTpI",attributionName:"room-info-dialog__attribution-name__3JTpI","attribution-author":"room-info-dialog__attribution-author__BouZB",attributionAuthor:"room-info-dialog__attribution-author__BouZB",description:"room-info-dialog__description__2jXMQ",subtitle:"room-info-dialog__subtitle__1pamf","hub-title":"room-info-dialog__hub-title__2rQtj",hubTitle:"room-info-dialog__hub-title__2rQtj"}},function(e,t,i){e.exports={"presence-log":"presence-log__presence-log__10oFj",presenceLog:"presence-log__presence-log__10oFj","presence-log-entry":"presence-log__presence-log-entry__dt0t4",presenceLogEntry:"presence-log__presence-log-entry__dt0t4","message-body":"presence-log__message-body__2L9jA",messageBody:"presence-log__message-body__2L9jA","message-body-multi":"presence-log__message-body-multi__2e-Sx",messageBodyMulti:"presence-log__message-body-multi__2e-Sx","message-body-mono":"presence-log__message-body-mono__3zuQE",messageBodyMono:"presence-log__message-body-mono__3zuQE","message-wrap":"presence-log__message-wrap__2aWCa",messageWrap:"presence-log__message-wrap__2aWCa","message-wrap-multi":"presence-log__message-wrap-multi__1eA6v",messageWrapMulti:"presence-log__message-wrap-multi__1eA6v","message-source":"presence-log__message-source__3CI4d",messageSource:"presence-log__message-source__3CI4d","message-source-link":"presence-log__message-source-link__1evTZ",messageSourceLink:"presence-log__message-source-link__1evTZ","icon-button":"presence-log__icon-button__2Shbm",iconButton:"presence-log__icon-button__2Shbm","spawn-message":"presence-log__spawn-message__14Ne8",spawnMessage:"presence-log__spawn-message__14Ne8",share:"presence-log__share__37U7E",media:"presence-log__media__2qG_d",mediaBody:"presence-log__mediaBody__1rByA",expired:"presence-log__expired__2wMJc","presence-log-entry-with-button":"presence-log__presence-log-entry-with-button__1PxTw",presenceLogEntryWithButton:"presence-log__presence-log-entry-with-button__1PxTw","presence-log-in-room":"presence-log__presence-log-in-room__17h3n",presenceLogInRoom:"presence-log__presence-log-in-room__17h3n","presence-log-spawn":"presence-log__presence-log-spawn__3jlmT",presenceLogSpawn:"presence-log__presence-log-spawn__3jlmT","presence-log-entry-one-line":"presence-log__presence-log-entry-one-line__bRXfp",presenceLogEntryOneLine:"presence-log__presence-log-entry-one-line__bRXfp","presence-log-emoji":"presence-log__presence-log-emoji__1_3Yn",presenceLogEmoji:"presence-log__presence-log-emoji__1_3Yn",emoji:"presence-log__emoji__10b18"}},,,function(e,t,i){"use strict";i.d(t,"a",function(){return n}),i.d(t,"b",function(){return a}),i.d(t,"c",function(){return l});const n={URL:1,FILE:2,CLIPBOARD:3,SPAWNER:4},a={URL_IMAGE:0,URL_VIDEO:1,URL_MODEL:2,URL_PDF:3,URL_AUDIO:4,FILE_IMAGE:8,FILE_VIDEO:9,FILE_MODEL:10,FILE_PDF:11,FILE_AUDIO:12,CLIPBOARD_IMAGE:16,CLIPBOARD_VIDEO:17,CLIPBOARD_MODEL:18,CLIPBOARD_PDF:19,CLIPBOARD_AUDIO:20,SPAWNER_IMAGE:24,SPAWNER_VIDEO:25,SPAWNER_MODEL:26,SPAWNER_PDF:27,SPAWNER_AUDIO:28,CAMERA:30,UNKNOWN:31};function s(e,t,i,a,s){return e===n.URL?t:e===n.FILE?i:e===n.CLIPBOARD?a:s}const o={"image/":[a.URL_IMAGE,a.FILE_IMAGE,a.CLIPBOARD_IMAGE,a.SPAWNER_IMAGE],"model/":[a.URL_MODEL,a.FILE_MODEL,a.CLIPBOARD_MODEL,a.SPAWNER_MODEL],"application/x-zip-compressed":[a.URL_MODEL,a.FILE_MODEL,a.CLIPBOARD_MODEL,a.SPAWNER_MODEL],"video/":[a.URL_VIDEO,a.FILE_VIDEO,a.CLIPBOARD_VIDEO,a.SPAWNER_VIDEO],"application/vnd.apple.mpegurl":[a.URL_VIDEO,a.FILE_VIDEO,a.CLIPBOARD_VIDEO,a.SPAWNER_VIDEO],"application/x-mpegurl":[a.URL_VIDEO,a.FILE_VIDEO,a.CLIPBOARD_VIDEO,a.SPAWNER_VIDEO],"audio/":[a.URL_AUDIO,a.FILE_AUDIO,a.CLIPBOARD_AUDIO,a.SPAWNER_AUDIO],"application/pdf":[a.URL_PDF,a.FILE_PDF,a.CLIPBOARD_PDF,a.SPAWNER_PDF]},r={".m3u8":[a.URL_VIDEO,a.FILE_VIDEO,a.CLIPBOARD_VIDEO,a.SPAWNER_VIDEO]};function l(e,t,i){for(const i in o)if(t.toLowerCase().startsWith(i)){return s(e,...o[i])}if(i)for(const t in r)if(i.toLowerCase().endsWith(t)){return s(e,...r[t])}return a.UNKNOWN}},function(e){e.exports={en:{"app-name":"App","editor-name":"Scene Editor","contact-email":"app@company.com","company-name":"Company","share-hashtag":"#app","app-description":"Share a virtual room with friends.\nWatch videos, play with 3D objects, or just hang out.","app-tagline":"Private social VR in your web browser","auth.verified-title":"Email Verified!","auth.verify-failed":"Unable to sign in with this link. It may have already been used or has expired.","auth.verified":"Your email has been verified!\nYou can now close this browser tab and return to %app-name%.","auth.spoke-verified":"Your email has been verified!\nYou can now close this browser tab and return to %editor-name%.","sign-in.prompt":"Sign in to pin objects in rooms.","sign-in.admin":"Check your email for a verification email. Once verified, enter your email to create your account or sign in.","sign-in.admin-no-permission":"You don't have access to admin tools. Sign into another account or ask an administrator to grant you permission.","sign-in.hub":"An account is required to join rooms.\n\nEnter your email to create your account or sign in.","sign-in.auth-started":"Email sent!\n\nTo continue, click on the link in the email using your phone, tablet, or PC.\n\nNo email? You may not be able to create an account.","sign-in.pin":"You'll need to sign in to pin objects.","sign-in.pin-complete":"You are now signed in.","sign-in.unpin":"You'll need to sign in to un-pin objects.","sign-in.unpin-complete":"You are now signed in.","sign-in.change-scene":"You'll need to sign in to change the scene.","sign-in.change-scene-complete":"You are now signed in.","sign-in.room-settings":"You'll need to sign in to change the room's settings.","sign-in.room-settings-complete":"You are now signed in.","sign-in.close-room":"You'll need to sign in to close the room.","sign-in.close-room-complete":"You are now signed in.","sign-in.mute-user":"You'll need to sign in to mute other users.","sign-in.mute-user-complete":"You are now signed in.","sign-in.kick-user":"You'll need to sign in to kick other users.","sign-in.kick-user-complete":"You are now signed in.","sign-in.add-owner":"You'll need to sign in to assign moderators.","sign-in.add-owner-complete":"You are now signed in.","sign-in.remove-owner":"You'll need to sign in to assign moderators.","sign-in.remove-owner-complete":"You are now signed in.","sign-in.create-avatar":"You'll need to sign in to create avatars.","sign-in.create-avatar-complete":"You are now signed in.","sign-in.favorite-room":"You'll need to sign in to add this room to your favorites.","sign-in.favorite-rooms":"You'll need to sign in to add favorite rooms.","sign-in.favorite-room-complete":"You are now signed in.","sign-in.favorite-rooms-complete":"You are now signed in.","sign-in.tweet":"You'll need to sign in to send tweets.","sign-in.tweet-complete":"You are now signed in.","sign-in.as":"Signed in as","sign-in.in":"Sign In","sign-in.out":"Sign Out","room-settings.apply":"Apply","room-settings.name-subtitle":"Room Name","room-settings.description-subtitle":"Room Description","room-settings.room-access-subtitle":"Room Access","room-settings.permissions-subtitle":"Room Member Permissions","room-settings.spawn_and_move_media":"Create and move objects","room-settings.spawn_camera":"Create cameras","room-settings.spawn_drawing":"Create drawings","room-settings.pin_objects":"Pin objects","room-settings.access-private":"Private","room-settings.access-private-subtitle":"Only those with the link can join","room-settings.access-public":"Public","room-settings.access-public-subtitle":"Listed on the homepage","room-info.title":"Room & Scene Info","room-info.scene-info":"Scene Info","close-room.message":"Closing this room will remove yourself and others from the room, shutting it down permanently.\n\nAre you sure? This action cannot be undone.","close-room.confirm":"Yes, Close Room","close-room.cancel":"Cancel","promote.message":"Promoting a user will grant full access to room settings and moderation tools.\n\nAre you sure?","promote.confirm-prefix":"Yes, Promote ","promote.cancel":"Cancel","entry.room":"lobby","entry.enter-room-title":"Lobby","entry.enter-room":"Enter Room","entry.leave-room":"Leave Room","entry.change-scene":"Choose Scene","entry.in-lobby-notice":"You are viewing this room from the lobby.","entry.screen-prefix":"Enter on ","entry.desktop-screen":"Screen","entry.mobile-screen":"Phone","entry.mobile-safari":"Safari","entry.generic-prefix":" ","entry.generic-medium":"Connected VR Headset","entry.generic-subtitle-desktop":"Oculus or SteamVR","entry.gearvr-prefix":"Enter on ","entry.gearvr-medium":"Gear VR","entry.choose-device":"Choose Device","entry.device-medium":"Enter on Standalone VR","entry.device-subtitle-desktop":"Wireless VR Headsets","entry.device-subtitle-mobile":"Wireless VR Headsets","entry.device-subtitle-vr":"Phone or PC","entry.entry-disallowed":"Watch from Lobby","entry.entry-disallowed-subtitle":"Room is Full","entry.cardboard":"Enter on Google Cardboard","entry.daydream-prefix":"Enter on ","entry.daydream-medium":"Daydream","entry.daydream-via-chrome":"Using Google Chrome","entry.invite-others":"invite others","entry.share-button":"Share","entry.desktop.invite-tip":"Nobody is here yet. Share this room to get together.","entry.mobile.invite-tip":"Share to get together.","entry.return-to-vr":"Return to VR","entry.open-in-window":"Open in Tab","entry.lobby":"Lobby","entry.back":"Back","entry.notify_me":"Notify me when others arrive","entry.mute-on-entry":"Mute my microphone","profile.save":"Accept","profile.display_name.validation_warning":"Alphanumerics and hyphens. At least 3 characters, no more than 32","profile.header":"Name & Avatar","profile.terms_of_use":"Terms of Use","profile.privacy_notice":"Privacy Notice","profile.choose_avatar":"Browse Avatars","profile.tabs.legacy":"Default","profile.tabs.skinnable":"Custom Skin","profile.tabs.url":"Custom Model","avatar-editor.info":"Find more custom avatar resources","avatar-editor.info-link":"here","avatar-editor.external-editor-info":"Create a custom skin for this avatar: ","avatar-preview.loading-failed":"Loading failed\nPlease choose another avatar","media-browser.search-placeholder.scenes":"Search Scenes...","media-browser.search-placeholder.avatars":"Search Avatars...","media-browser.search-placeholder.videos":"Search for Videos...","media-browser.search-placeholder.images":"Search for Images...","media-browser.search-placeholder.youtube":"Search for Youtube videos...","media-browser.search-placeholder.gifs":"Search for GIFs...","media-browser.search-placeholder.twitch":"Search for Twitch streams...","media-browser.search-placeholder.sketchfab":"Search Sketchfab Models...","media-browser.search-placeholder.poly":"Search Google Poly Models...","media-browser.search-placeholder.base":"Search...","media-browser.favorites-header":"Favorite Rooms","media-browser.add_custom_object":"Custom URL or File","media-browser.add_custom_scene":"Custom Scene","media-browser.add_custom_avatar":"Avatar GLB URL","media-browser.privacy_policy":"Privacy Policy","media-browser.report_issue":"Report Issue","media-browser.powered_by.images":"Search by Bing | ","media-browser.powered_by.videos":"Search by Bing | ","media-browser.powered_by.youtube":"Search by Google | ","media-browser.powered_by.gifs":"Search by Tenor | ","media-browser.powered_by.sketchfab":"Search by Sketchfab | ","media-browser.powered_by.poly":"Search by Google | ","media-browser.powered_by.twitch":"Search by Twitch | ","media-browser.powered_by.scenes":"Made with ","media-browser.powered_by.avatars":" ","media-browser.empty.images":"No results. Try entering a new search above.","media-browser.empty.videos":"No results. Try entering a new search above.","media-browser.empty.youtube":"No results. Try entering a new search above.","media-browser.empty.gifs":"No result. Try entering a new search above.","media-browser.empty.sketchfab":"No results. Try entering a new search above.","media-browser.empty.poly":"No results. Try entering a new search above.","media-browser.empty.twitch":"No results. Try entering a new search above.","media-browser.empty.favorites":"You don't have any favorites. Click a  to add to your favorites.","media-browser.nav_title.youtube":"YouTube","media-browser.nav_title.videos":"Videos","media-browser.nav_title.images":"Images","media-browser.nav_title.gifs":"GIFs","media-browser.nav_title.scenes":"Scenes","media-browser.nav_title.avatars":"Avatars","media-browser.nav_title.sketchfab":"Sketchfab","media-browser.nav_title.poly":"Google Poly","media-browser.nav_title.twitch":"Twitch","media-browser.create-avatar":"Create Avatar","media-browser.create-scene":"Create Scene with %editor-name%","media-browser.hub.joined-prefix":"Visited ","media-browser.similar-to-facet":'Similar to: "{name}"',"audio.title":"Audio Setup","audio.talk_to_test":"talk","audio.click_to_test":"click","audio.subtitle-desktop":"Confirm HMD speaker output","audio.subtitle-mobile":"Earphones are recommended","audio.enter-now":"Enter Now","audio.hmd-mic-warning":"Your HMD mic is not chosen","audio.grant-title":"Grant mic permissions","audio.grant-subtitle":"Mic access needed to be heard by others","audio.granted-title":"Mic permissions granted","audio.granted-subtitle":"You can still mute yourself in-game","audio.granted-next":"Next","exit.subtitle.exited":"Your session has ended. Refresh your browser to start a new one.","exit.subtitle.closed":"This room is no longer available.","exit.subtitle.denied":"You are not permitted to join this room. Please request permission from the room creator.","exit.subtitle.disconnected":"You have disconnected from the room. Refresh the page to try to reconnect.","exit.subtitle.left":"You have left the room.","exit.subtitle.full":"This room is full, please try again later.","exit.subtitle.scene_error":"The scene failed to load.","exit.subtitle.connect_error":"Unable to connect to this room, please try again later.","exit.subtitle.version_mismatch":"The version you deployed is not available yet. Your browser will refresh in 5 seconds.","autoexit.title":"Auto-ending session in ","autoexit.title_units":" seconds","autoexit.concurrent_subtitle":"You have started another session.","autoexit.idle_subtitle":"You have been idle for too long.","autoexit.cancel":"CANCEL","presence.entered_room":"entered the room.","presence.entered_lobby":"entered the lobby.","presence.join_lobby":"joined the lobby.","presence.join_room":"joined the room.","presence.leave":"left.","presence.name_change":"is now known as","presence.scene_change":"changed the scene to","presence.hub_name_change":"changed the name of the room to","presence.in_lobby":"Lobby","presence.in_room":"In Room","home.create_a_room":"Create a Room","home.desktop.add_pwa":"Install Desktop App","home.mobile.add_pwa":"Add to Home Screen","home.take_a_tour":"Take a Tour","home.room_create_options":"options","home.room_create_button":"Create Room","home.create_name.validation_warning":"Invalid name, limited to 4 to 64 characters and limited symbols.","home.powered_by_prefix":"Powered by","home.powered_by_link":"Hubs Cloud","home.join_us":"Join the Conversation","home.have_code":"Have a room code?","home.add_to_discord_1":"Add the","home.add_to_discord_2":"%app-name% Bot","home.add_to_discord_3":"to Discord","home.create_with_spoke":"Create a Scene","home.report_issue":"Report Issues","home.source_link":"Source","home.whats_new_link":"What's New","home.about_link":"About","home.community_link":"Community","home.cloud_link":"Hubs Cloud","home.admin":"Admin","home.privacy_notice":"Privacy Notice","home.terms_of_use":"Terms of Use","home.made_with_love":"made with  by ","home.environment_author_by":" by ","dialog.close":"close","link.link_page_header_entry":"Enter your code:","link.link_page_header_headset":"Enter code:","link.linking_a_headset":"Have a letter code?","link.create_a_room":"Create a new room","link.try_again":"We couldn't find that code.\nPlease try again.","help.report_issue":"Report an Issue","scene.create_button":"Create a room with this scene","scene.tweet_button":"Share on Twitter","scene.unavailable":"This scene is no longer available.","scene.remix_button":"Remix in %editor-name%","scene.edit_button":"Edit in %editor-name%","link.in_your_browser":"In your device's web browser, go to:","link.enter_code":"Then, enter this one-time letter code:","link.do_not_close":"Your account and avatar will be transferred to the device.\nKeep this page open to use this code.","link.connect_headset":"Enter on Device","link.cancel":"cancel","invite.enter_via":"Or use expiring ","invite.enter_via_modal":"Others may enter via ","invite.tweet":"tweet","invite.and_enter_code":" code:","invite.duration_of_code":"new code every 72 hours","invite.or_visit":"Share room link:","invite.or_visit_modal":"or by visiting permalink","invite.embed":"or embed on a page","invite.embed-tip":"Please be mindful of where you embed a %app-name% room.\nGo to Room Settings to lock down permissions for this room.","commands.fly":"Toggle fly mode.","commands.grow":"Increase your avatar's size.","commands.shrink":"Decrease your avatar's size.","commands.scene":"Change the scene.","commands.rename":"Rename the room.","commands.help":"Show help.","commands.leave":"Disconnect from the room.","commands.duck":"The duck tested well. Quack.","commands.capture":"Capture a 15 second video.","commands.debug":"Toggle physics debug rendering.","commands.vrstats":"Toggle stats in VR.","preferences.muteMicOnEntry":"Mute microphone on entry","preferences.enableOnScreenJoystickLeft":"Enable left on-screen joystick for moving around","preferences.enableOnScreenJoystickRight":"Enable right on-screen joystick for looking around","preferences.onlyShowNametagsInFreeze":"Only show nametags while frozen","preferences.maxResolution":"Max Resolution (width x height in pixels)","preferences.globalVoiceVolume":"Incoming Voice Volume","preferences.globalMediaVolume":"Media Volume","preferences.materialQualitySetting":"Material quality (requires restart)","preferences.snapRotationDegrees":"Rotation per snap (in degrees)","preferences.allowMultipleHubsInstances":"Disable check for multiple hubs instances","preferences.baseMovementSpeed":"Base movement speed","preferences.disableMovement":"Disable movement","preferences.disableBackwardsMovement":"Disable backwards movement","preferences.disableStrafing":"Disable strafing","preferences.disableTeleporter":"Disable teleporter","settings.return-to-vr":"Return to VR","settings.change-avatar":"Set Name & Avatar","settings.change-scene":"Choose a Scene","settings.favorites":"Favorite Rooms","settings.preferences":"Preferences","settings.room-settings":"Room Settings","settings.close-room":"Close Room...","settings.room-info":"Room & Scene Info","settings.create-room":"New Room","settings.enable-streamer-mode":"Camera Mode","settings.disable-streamer-mode":"Exit Camera Mode","settings.send-feedback":"Send Feedback","settings.whats-new":"What's New","settings.features":"Help","settings.controls":"Controls","settings.community":"Join Discord","settings.tips":"Start Tour","settings.report":"Report Issue","settings.terms":"Terms of Use","settings.privacy":"Privacy Notice","settings.help":"Help","settings.row-profile":"You","settings.row-room":"Room","settings.row-tools":"Tools","tips.mobile.video_share_mode":"Tap to stop sharing video.","tips.mobile.pen_mode":"Tap icon again to end drawing.","tips.mobile.mute_mode":"You are muted. Tap to unmute.","tips.mobile.freeze_mode":"Two-finger tap to hide menus.","tips.mobile.look":"Welcome!  Tap and drag to look around.","tips.mobile.locomotion":"Great! To move, pinch with two fingers.","tips.mobile.spawn_menu-pre":"Use the ","tips.mobile.spawn_menu-post":"at the top to create objects.","tips.mobile.freeze_gesture":"Two-finger tap to show menus.","tips.mobile.object_grab":"Drag an object to move or throw it.","tips.mobile.object_rotate_button-pre":"Tap and drag ","tips.mobile.object_rotate_button-post":" to rotate.","tips.mobile.object_scale_button-pre":"Tap and drag ","tips.mobile.object_scale_button-post":" to scale.","tips.mobile.object_recenter_button-pre":"Tap ","tips.mobile.object_recenter_button-post":" to have the object face you.","tips.mobile.object_pin":"Pin an object to save it to the room.","tips.mobile.video_share_failed":"No permission granted.","tips.mobile.invite":"Use the Share button to share this room.","tips.mobile.feedback":" Quack! Want to help Hubs?","tips.mobile.feedback-link":"Tell the Duck.","tips.desktop.video_share_mode":"You're streaming. Select again to stop sharing video.","tips.desktop.pen_mode":"Press ESC or right click to drop pen. Ctrl-Z to undo.","tips.desktop.mute_mode":"You are muted. Click or press M to un-mute.","tips.desktop.look":"Welcome to %app-name%! Let's take a quick tour.  Click and drag to look around.","tips.desktop.locomotion":"Use the W A S D keys to move. Hold shift to boost.","tips.desktop.turning":"Perfect. Use the Q and E keys to rotate.","tips.desktop.spawn_menu-pre":"To create objects, click the ","tips.desktop.spawn_menu-post":"button at the top of the screen, or press Ctrl 1 through 7.","tips.desktop.freeze_gesture":"Press and hold spacebar to show object menus.","tips.desktop.menu_hover":"Now, point the cursor at an object to show the menu.","tips.desktop.object_grab":"Click and drag an object to move it. Or, flick to throw it!","tips.desktop.object_pin":"Pin an object to save it to the room.","tips.desktop.object_zoom":"Scroll to move this object towards and away from you.","tips.desktop.object_rotate_button-pre":"Click and drag ","tips.desktop.object_rotate_button-post":" to rotate the object.","tips.desktop.object_scale_button-pre":"Click and drag ","tips.desktop.object_scale_button-post":" to scale the object.","tips.desktop.object_recenter_button-pre":"Click ","tips.desktop.object_recenter_button-post":" to rotate the object to face you. Helpful if you drop it!","tips.desktop.object_scale":"Hold shift and scroll to scale it bigger and smaller.","tips.desktop.pen_color":"Use Shift-Q and Shift-E to change the pen color.","tips.desktop.pen_size":"Hold Shift and scroll to change the pen size.","tips.desktop.invite":"Nobody else is here. Use the Share button at the top to share this room.","tips.desktop.video_share_failed":"You need to grant permissions to stream video.","tips.streaming":"Now broadcasting to the lobby. Click to exit.","tips.desktop.watching":"You're in the lobby. Others cannot see or hear you.","tips.desktop.feedback":" Quack! Want to help us make Hubs better?","tips.desktop.feedback-link":"Talk to the Feedback Duck.","tips.watching.back":"Enter Room","tips.mobile.watching":"You're in the lobby.","tips.watching-exit":"Back","lobby.watching":"Watching ","loader.entering_lobby":"Entering lobby...","loader.loading":"Loading ","loader.connecting":"Connecting...","loader.connected":"Connected.","loader.object":"object","loader.objects":"objects","change-scene-dialog.change-scene":"Change Scene","change-scene-dialog.create-in-spoke":"Or, create a new scene using %editor-name%.","change-scene-dialog.new-spoke-project":"Launch %editor-name%","invalid-scene-url":"This URL does not point to a scene or valid GLB.","avatar-url-dialog.apply":"Apply","interstitial.prompt":"Continue","feedback.prompt":" Feedback ","help.prompt":"Help","help.docs_url":"https://github.com/mozilla/hubs/wiki/Hubs-Features","hide-ui.prompt":"Hide All","discord.primary_tagline":"Share a virtual room with your community.\nWatch videos, play with 3D objects, or just hang out.","discord.secondary_tagline":"No downloads or sign up. Full VR support too.","discord.contact_us":"Invite Bot to Server","discord.community_link":"Hubs Discord","discord.splash_tag":"Designed for serious businessing.","client-info.kick-button":"Kick","client-info.hide-button":"Hide","client-info.unhide-button":"Un-hide ","client-info.mute-button":"Mute","client-info.cancel":"Cancel","client-info.add-owner":"Promote","client-info.remove-owner":"Demote","object-info.remove-button":"Remove","object-info.open-link":"Open Link","object-info.waypoint":"Go To","object-info.pin-button":"Pin","object-info.raise-lights":"Show Background","object-info.lower-lights":"Hide Background","object-info.unpin-button":"Unpin","avatar-landing.select":"Select","avatar-landing.selected":"This is your current avatar","leave-room-dialog.join-room.message":"Joining a new room will leave this one. Are you sure?","leave-room-dialog.join-room.confirm":"Join Room","leave-room-dialog.create-room.message":"Creating a new room will leave this one. Are you sure?","leave-room-dialog.create-room.confirm":"Leave Room","embed.load-button":"Load Room","embed.presence-warning":"This room is embedded, so may be visible to visitors on other websites.","tweet-dialog.tweet":"Tweet","tweet-dialog.posted":"Your tweet has been posted.","tweet-dialog.close":"close","oauth-dialog.sign-in.twitter":"Connect to Twitter","oauth-dialog.sign-in.discord":"Sign in to Discord","oauth-dialog.message.twitter":"Connect to Twitter to send tweets from %app-name%.","cloud.primary_tagline":"Hubs Cloud deploys server infrastructure for private,\ncollaborative 3D rooms that can be accessed on your\ndesktop, mobile phone, or VR headset.","cloud.secondary_tagline":"Get it today on the AWS Marketplace","cloud.call_to_action":"View AWS Marketplace Listing","cloud.splash_tag":"Configurable infrastructure for your own Hubs stack"}}},function(e,t,i){e.exports={panel:"_2d-hud__panel__2oM_T","tip-cancel-text":"_2d-hud__tip-cancel-text__12KQ2",tipCancelText:"_2d-hud__tip-cancel-text__12KQ2","top-tip":"_2d-hud__top-tip__E5uti",topTip:"_2d-hud__top-tip__E5uti",container:"_2d-hud__container__66GRt",top:"_2d-hud__top__3PiNe",column:"_2d-hud__column__1y7XY",bottom:"_2d-hud__bottom__2jUcT",hide:"_2d-hud__hide__3HJO8","attach-point":"_2d-hud__attach-point__17FSc",attachPoint:"_2d-hud__attach-point__17FSc",attach_video_share_mode:"_2d-hud__attach_video_share_mode__21PhM",attachVideoShareMode:"_2d-hud__attach_video_share_mode__21PhM",attach_video_share_failed:"_2d-hud__attach_video_share_failed__2tfqf",attachVideoShareFailed:"_2d-hud__attach_video_share_failed__2tfqf",attach_pen_mode:"_2d-hud__attach_pen_mode__cI1AW",attachPenMode:"_2d-hud__attach_pen_mode__cI1AW",attach_mute_mode:"_2d-hud__attach_mute_mode__153iB",attachMuteMode:"_2d-hud__attach_mute_mode__153iB",attach_freeze_mode:"_2d-hud__attach_freeze_mode__3UIHP",attachFreezeMode:"_2d-hud__attach_freeze_mode__3UIHP","top-tip-no-hud":"_2d-hud__top-tip-no-hud__16RXh",topTipNoHud:"_2d-hud__top-tip-no-hud__16RXh","tip-cancel":"_2d-hud__tip-cancel__JaFV-",tipCancel:"_2d-hud__tip-cancel__JaFV-","video-share-extra-options":"_2d-hud__video-share-extra-options__31VMr",videoShareExtraOptions:"_2d-hud__video-share-extra-options__31VMr",iconButton:"_2d-hud__iconButton__3faJz",up:"_2d-hud__up__1lyhr",iconButtonIcon:"_2d-hud__iconButtonIcon__3uFYG",spawn:"_2d-hud__spawn__1FoBz",small:"_2d-hud__small__2rqgF",large:"_2d-hud__large__2bHqH",disabled:"_2d-hud__disabled__3ylbZ","video-share":"_2d-hud__video-share__38X7W",videoShare:"_2d-hud__video-share__38X7W"}},function(e,t,i){"use strict";i.d(t,"b",function(){return c}),i.d(t,"a",function(){return d});var n=i(57),a=i.n(n),s=i(77);const{detect:o}=i(105),r=o();let l=!1;function c(e){if(!window.AFRAME)return;const t=AFRAME.utils.device.isMobile();a.a.isFullscreen&&!AFRAME.utils.device.isMobileVR()&&"firefox"===r.name&&(l=!0,a.a.exit().then(()=>{e.focus()})),t||e.select()}function d(){l?l=!1:Object(s.b)()}},,function(e,t,i){e.exports={"max-resolution-preference-item":"preferences-screen__max-resolution-preference-item__1lqd7",maxResolutionPreferenceItem:"preferences-screen__max-resolution-preference-item__1lqd7","number-with-range":"preferences-screen__number-with-range__35LSW",numberWithRange:"preferences-screen__number-with-range__35LSW","number-in-number-with-range":"preferences-screen__number-in-number-with-range__2KQrK",numberInNumberWithRange:"preferences-screen__number-in-number-with-range__2KQrK","preference-list-item":"preferences-screen__preference-list-item__29ZAe",preferenceListItem:"preferences-screen__preference-list-item__29ZAe",dropdown:"preferences-screen__dropdown__Yvmf_","content-container":"preferences-screen__content-container__3VLFw",contentContainer:"preferences-screen__content-container__3VLFw","panel-margin":"preferences-screen__panel-margin__Srca-",panelMargin:"preferences-screen__panel-margin__Srca-","close-button":"preferences-screen__close-button__2zMLp",closeButton:"preferences-screen__close-button__2zMLp",dropdownArrow:"preferences-screen__dropdownArrow__2TIdk","preference-list-non-checkbox":"preferences-screen__preference-list-non-checkbox__MR159",preferenceListNonCheckbox:"preferences-screen__preference-list-non-checkbox__MR159",part:"preferences-screen__part__2Ranp","checkbox-margin":"preferences-screen__checkbox-margin__1PeGJ",checkboxMargin:"preferences-screen__checkbox-margin__1PeGJ",left:"preferences-screen__left__3gJX_",right:"preferences-screen__right__3_kjy","preferences-panel":"preferences-screen__preferences-panel__1WQqG",preferencesPanel:"preferences-screen__preferences-panel__1WQqG","scrolling-content":"preferences-screen__scrolling-content__3eE_K",scrollingContent:"preferences-screen__scrolling-content__3eE_K","section-bar":"preferences-screen__section-bar__3i097",sectionBar:"preferences-screen__section-bar__3i097","section-title":"preferences-screen__section-title__1JGHh",sectionTitle:"preferences-screen__section-title__1JGHh",checkbox:"preferences-screen__checkbox__1t8BH",row:"preferences-screen__row__24y1Q","row-name":"preferences-screen__row-name__EAAaz",rowName:"preferences-screen__row-name__EAAaz","reset-to-default-button":"preferences-screen__reset-to-default-button__1WpmV",resetToDefaultButton:"preferences-screen__reset-to-default-button__1WpmV","prev-option-scale":"preferences-screen__prev-option-scale__1UBJy",prevOptionScale:"preferences-screen__prev-option-scale__1UBJy","next-option-scale":"preferences-screen__next-option-scale__1WFTK",nextOptionScale:"preferences-screen__next-option-scale__1WFTK","prev-option-hovered-scale":"preferences-screen__prev-option-hovered-scale__3qfSH",prevOptionHoveredScale:"preferences-screen__prev-option-hovered-scale__3qfSH","next-option-hovered-scale":"preferences-screen__next-option-hovered-scale__3VyMZ",nextOptionHoveredScale:"preferences-screen__next-option-hovered-scale__3VyMZ","range-slider":"preferences-screen__range-slider__2JBPc",rangeSlider:"preferences-screen__range-slider__2JBPc"}},function(e,t,i){e.exports={"invite-container":"invite-dialog__invite-container__1c0Jw",inviteContainer:"invite-dialog__invite-container__1c0Jw",dialog:"invite-dialog__dialog__1XbxO","link-button":"invite-dialog__link-button__S_o-t",linkButton:"invite-dialog__link-button__S_o-t","enter-vr-button":"invite-dialog__enter-vr-button__3y1BF",enterVrButton:"invite-dialog__enter-vr-button__3y1BF","invite-button":"invite-dialog__invite-button__3cjFw",inviteButton:"invite-dialog__invite-button__3cjFw","enter-button":"invite-dialog__enter-button__2Z5EY",enterButton:"invite-dialog__enter-button__2Z5EY","invite-mini-button":"invite-dialog__invite-mini-button__2zWJj",inviteMiniButton:"invite-dialog__invite-mini-button__2zWJj",domain:"invite-dialog__domain__2Q8Wr","embed-text":"invite-dialog__embed-text__3-Boo",embedText:"invite-dialog__embed-text__3-Boo","invite-container-inverted":"invite-dialog__invite-container-inverted__1E3hR",inviteContainerInverted:"invite-dialog__invite-container-inverted__1E3hR",subscribe:"invite-dialog__subscribe__qlJL4","embed-tip-wrap":"invite-dialog__embed-tip-wrap__2CQRc",embedTipWrap:"invite-dialog__embed-tip-wrap__2CQRc","embed-tip":"invite-dialog__embed-tip__12p0o",embedTip:"invite-dialog__embed-tip__12p0o",modal:"invite-dialog__modal__1hbVP","invite-button-lowered":"invite-dialog__invite-button-lowered__3lM4N",inviteButtonLowered:"invite-dialog__invite-button-lowered__3lM4N","hide-small-screens":"invite-dialog__hide-small-screens__3UCeH",hideSmallScreens:"invite-dialog__hide-small-screens__3UCeH","link-code":"invite-dialog__link-code__k-Fcd",linkCode:"invite-dialog__link-code__k-Fcd","code-duration":"invite-dialog__code-duration__2E3JG",codeDuration:"invite-dialog__code-duration__2E3JG","invite-container-below-hud":"invite-dialog__invite-container-below-hud__30RHX",inviteContainerBelowHud:"invite-dialog__invite-container-below-hud__30RHX","attach-point":"invite-dialog__attach-point__otyII",attachPoint:"invite-dialog__attach-point__otyII",code:"invite-dialog__code__13AIx","keep-open":"invite-dialog__keep-open__229sO",keepOpen:"invite-dialog__keep-open__229sO",digit:"invite-dialog__digit__2w64P",digit_2:"invite-dialog__digit_2__pQCJ3",digit2:"invite-dialog__digit_2__pQCJ3",digit_3:"invite-dialog__digit_3__1bWtt",digit3:"invite-dialog__digit_3__1bWtt","code-loading-panel":"invite-dialog__code-loading-panel__1gghm",codeLoadingPanel:"invite-dialog__code-loading-panel__1gghm","hub-link-link":"invite-dialog__hub-link-link__2guVF",hubLinkLink:"invite-dialog__hub-link-link__2guVF",buttons:"invite-dialog__buttons__1yN_j",embed:"invite-dialog__embed__2zy_A",close:"invite-dialog__close__3PAxl","embed-tip-attach-point":"invite-dialog__embed-tip-attach-point__2UAZp",embedTipAttachPoint:"invite-dialog__embed-tip-attach-point__2UAZp"}},,function(e,t,i){"use strict";i.d(t,"a",function(){return l}),i.d(t,"g",function(){return c}),i.d(t,"d",function(){return h}),i.d(t,"e",function(){return m}),i.d(t,"f",function(){return g}),i.d(t,"b",function(){return v}),i.d(t,"c",function(){return b}),i.d(t,"h",function(){return y});var n=i(8),a=i(11);function s(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function o(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var o=e.apply(t,i);function r(e){s(o,n,a,r,l,"next",e)}function l(e){s(o,n,a,r,l,"throw",e)}r(void 0)})}}const r="/api/v1/avatars",l={SKINNABLE:"skinnable",URL:"url"};function c(e){return e.startsWith("http")?l.URL:l.SKINNABLE}function d(){return(d=o(function*(e){const t=yield Object(n.d)(`/api/v1/avatars/${e}`);return t&&t.avatars&&t.avatars[0]})).apply(this,arguments)}function h(e){return u.apply(this,arguments)}function u(){return(u=o(function*(e){switch(c(e)){case l.SKINNABLE:return function(e){return d.apply(this,arguments)}(e);case l.URL:return{avatar_id:e,gltf_url:Object(a.i)(e)}}})).apply(this,arguments)}function p(){return(p=o(function*(e){return h(e).then(e=>e&&e.gltf_url)})).apply(this,arguments)}function m(e){switch(c(e)){case l.SKINNABLE:return function(e){return p.apply(this,arguments)}(e);case l.URL:return Object(a.i)(e);default:return e}}function g(e){return f.apply(this,arguments)}function f(){return(f=o(function*(e){switch(c(e)){case l.SKINNABLE:return h(e).then(e=>e.files.thumbnail);default:return"https://asset-bundles-prod.reticulum.io/bots/avatar_unavailable.png"}})).apply(this,arguments)}const v="Bot_PBS";function b(e){if(e.materials.find(e=>e.name===v))return e;function t(t){if(!t.primitives)return;const i=t.primitives.find(e=>void 0!==e.material);return i&&e.materials[i.material]}let i=e.scenes[e.scene].nodes.slice(0);for(;i.length;){const n=e.nodes[i.shift()],a=void 0!==n.mesh&&t(e.meshes[n.mesh]);if(a){a.name=v;break}n.children&&(i=i.concat(n.children))}return e}function y(e,t){return _.apply(this,arguments)}function _(){return(_=o(function*(e,t){const i={parent_avatar_listing_id:e,name:t,files:{}};return Object(n.d)(r,"POST",{avatar:i})})).apply(this,arguments)}},,,,,function(e,t,i){"use strict";i.d(t,"f",function(){return c}),i.d(t,"b",function(){return m}),i.d(t,"c",function(){return v}),i.d(t,"d",function(){return b}),i.d(t,"a",function(){return w}),i.d(t,"e",function(){return k});var n=i(14),a=i(12),s=i(1),o=i(72),r=i(21);const l=Object(r.a)("thirdPerson");function c(e){let t=e;for(;t;){if(t.components&&t.components.tags&&t.components.tags.data.inspectable)return t;t=t.parentNode}return null}const d=function(){const e=new THREE.Vector3;return function(t,i,n){t.decompose(i,n,e)}}(),h=(new THREE.Matrix4).identity(),u=function(){const e=new THREE.Quaternion,t=new THREE.Vector3,i=new THREE.Quaternion,n=new THREE.Vector3,s=new THREE.Quaternion,o=new THREE.Vector3,r=new THREE.Vector3,l=new THREE.Object3D,c=new THREE.Quaternion,u=new THREE.Quaternion;return function(p,m,g,f,v,b,y,_){l.parent||(AFRAME.scenes[0].object3D.add(l),l.applyMatrix(h)),p.updateMatrices(),d(p.matrixWorld,t,e),d(g.matrixWorld,n,i),m.getWorldQuaternion(s),c.setFromAxisAngle(o.set(0,1,0).applyQuaternion(e),.1*f*y),l.quaternion.copy(i).premultiply(c);const w=(new THREE.Vector3).subVectors(n,t),E=1-b*y,x=w.length()*E;x>.1&&x<100&&w.multiplyScalar(E),u.setFromAxisAngle(r.set(1,0,0).applyQuaternion(l.quaternion),.1*v*y),l.quaternion.premultiply(u),l.position.addVectors(t,w.applyQuaternion(c).applyQuaternion(u)).add(o.set(0,1,0).multiplyScalar(_*x).applyQuaternion(l.quaternion)),l.matrixNeedsUpdate=!0,l.updateMatrices(),Object(a.d)(m,g,l.matrixWorld)}}(),p=function(){const e=new THREE.Quaternion,t=new THREE.Vector3,i=new THREE.Quaternion,n=new THREE.Vector3,s=new THREE.Vector3,r=new THREE.Vector3,l=new THREE.Object3D;return function(c,u,p,m){l.parent||(AFRAME.scenes[0].object3D.add(l),l.applyMatrix(h)),p.updateMatrices(),d(p.matrixWorld,t,e),d(u.matrixWorld,n,i),c.getWorldQuaternion(i);const g=Object(o.a)(p.el,p.el.getObject3D("mesh")||p,!0);g.getCenter(r);const f=p.el.sceneEl.is("vr-mode"),v=Object(a.c)(p.el.sceneEl.camera.fov,p.el.sceneEl.camera.aspect,p,g,r,f)*m;l.position.addVectors(t,s.set(0,0,1).multiplyScalar(v).applyQuaternion(e)),l.quaternion.copy(e),l.matrixNeedsUpdate=!0,l.updateMatrices(),Object(a.d)(c,u,l.matrixWorld)}}(),m=0,g=1,f=2,v=3,b=4,y={[m]:g,[g]:f,[f]:m},_=4,w=5,E=function(e){e.isLight&&e.layers.enable(_)},x=function(e){const t=AFRAME.scenes[0].systems["hubs-systems"].batchManagerSystem.batchManager.batchForMesh.get(e);t?(t.layers.enable(_),e.layers.enable(w)):e.layers.enable(_)},S=function(e){const t=AFRAME.scenes[0].systems["hubs-systems"].batchManagerSystem.batchManager.batchForMesh.get(e);t?(t.layers.disable(_),e.layers.disable(w)):e.layers.disable(_)};const C=.9;class k{constructor(e){var t,i,o;t=this,i="tick",o=function(){const e=new THREE.Matrix4;return function(t,i){if(!this.enteredScene&&t.is("entered")&&(this.enteredScene=!0,this.mode=m),this.avatarPOVRotator=this.avatarPOVRotator||this.avatarPOV.components["pitch-yaw-rotator"],this.viewingCameraRotator=this.viewingCameraRotator||this.viewingCamera.components["pitch-yaw-rotator"],this.avatarPOVRotator.on=!0,this.viewingCameraRotator.on=!0,this.userinput=this.userinput||t.systems.userinput,this.interaction=this.interaction||t.systems.interaction,this.userinput.get(s.a.actions.startInspecting)&&this.mode!==v){const e=this.interaction.state.rightRemote.hovered||this.interaction.state.leftRemote.hovered;if(e){const t=c(e);t&&this.inspect(t.object3D)}}else!this.temporarilyDisableRegularExit&&this.mode===v&&this.userinput.get(s.a.actions.stopInspecting)&&(t.emit("uninspect"),this.uninspect());this.userinput.get(s.a.actions.nextCameraMode)&&this.nextMode();const n=this.mode!==m;if(this.playerHead=this.playerHead||document.getElementById("avatar-head"),this.playerHead&&n!==this.playerHead.object3D.visible)this.playerHead.object3D.visible=n;else{if(this.mode===m)this.viewingCameraRotator.on=!1,this.avatarRig.object3D.updateMatrices(),Object(a.l)(this.viewingRig.object3D,this.avatarRig.object3D.matrixWorld),t.is("vr-mode")?(this.viewingCamera.object3D.updateMatrices(),Object(a.l)(this.avatarPOV.object3D,this.viewingCamera.object3D.matrixWorld)):(this.avatarPOV.object3D.updateMatrices(),Object(a.l)(this.viewingCamera.object3D,this.avatarPOV.object3D.matrixWorld));else if(this.mode===g||this.mode===f)this.mode===g?e.makeTranslation(0,1,3):e.makeTranslation(0,2,8),this.avatarRig.object3D.updateMatrices(),this.viewingRig.object3D.matrixWorld.copy(this.avatarRig.object3D.matrixWorld).multiply(e),Object(a.l)(this.viewingRig.object3D,this.viewingRig.object3D.matrixWorld),this.avatarPOV.object3D.quaternion.copy(this.viewingCamera.object3D.quaternion),this.avatarPOV.object3D.matrixNeedsUpdate=!0;else if(this.mode===v){this.avatarPOVRotator.on=!1,this.viewingCameraRotator.on=!1;const e=this.userinput.get(t.is("entered")?s.a.actions.cameraDelta:s.a.actions.lobbyCameraDelta);if(e){const t=(AFRAME.utils.device.isMobile()?-.6:1)*e[0]||0,i=(AFRAME.utils.device.isMobile()?-1.2:1)*e[1]||0;this.horizontalDelta=(this.horizontalDelta+t)/2,this.verticalDelta=(this.verticalDelta+i)/2}else(Math.abs(this.verticalDelta)>1e-4||Math.abs(this.horizontalDelta)>1e-4)&&(this.verticalDelta=C*this.verticalDelta,this.horizontalDelta=C*this.horizontalDelta);const n=.001*this.userinput.get(s.a.actions.inspectZoom);n?this.inspectZoom=n+5*this.inspectZoom/6:Math.abs(this.inspectZoom)>1e-4&&(this.inspectZoom=C*this.inspectZoom);const a=this.userinput.get(s.a.actions.inspectPanY)||0;this.userinput.get(s.a.actions.resetInspectView)&&p(this.viewingRig.object3D,this.viewingCamera.object3D,this.inspected,1),(Math.abs(this.verticalDelta)>.001||Math.abs(this.horizontalDelta)>.001||Math.abs(this.inspectZoom)>.001||Math.abs(a)>1e-4)&&u(this.inspected,this.viewingRig.object3D,this.viewingCamera.object3D,this.horizontalDelta,this.verticalDelta,this.inspectZoom,i,a)}t.audioListener&&this.avatarPOV&&(this.mode!==m&&this.mode!==v||t.audioListener.parent===this.avatarPOV.object3D?this.mode!==g&&this.mode!==f||t.audioListener.parent===this.viewingCamera.object3D||this.viewingCamera.object3D.add(t.audioListener):this.avatarPOV.object3D.add(t.audioListener))}}}(),i in t?Object.defineProperty(t,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[i]=o,this.enableLights="true"===localStorage.getItem("show-background-while-inspecting"),this.verticalDelta=0,this.horizontalDelta=0,this.inspectZoom=0,this.batchManagerSystem=e,this.mode=b,this.snapshot={audioTransform:new THREE.Matrix4,matrixWorld:new THREE.Matrix4},this.audioListenerTargetTransform=new THREE.Matrix4,Object(n.a)().then(()=>{this.avatarPOV=document.getElementById("avatar-pov-node"),this.avatarRig=document.getElementById("avatar-rig"),this.viewingCamera=document.getElementById("viewing-camera"),this.viewingRig=document.getElementById("viewing-rig");const e=new THREE.Mesh(new THREE.BoxGeometry(100,100,100),new THREE.MeshBasicMaterial({color:131586,side:THREE.BackSide}));e.layers.set(_),this.viewingRig.object3D.add(e)})}nextMode(){this.mode!==v?l&&this.mode!==b&&(this.mode=y[this.mode]||0,this.mode===m?AFRAME.scenes[0].renderer.vr.setPoseTarget(this.avatarPOV.object3D):this.mode!==g&&this.mode!==f||AFRAME.scenes[0].renderer.vr.setPoseTarget(this.viewingCamera.object3D)):this.uninspect()}inspect(e,t,i){if(this.verticalDelta=0,this.horizontalDelta=0,this.inspectZoom=0,this.temporarilyDisableRegularExit=i,this.mode===v)return;const n=AFRAME.scenes[0];n.object3D.traverse(E),n.classList.add("hand-cursor"),n.classList.remove("no-cursor"),this.snapshot.mode=this.mode,this.mode=v,this.inspected=e;const s=n.is("vr-mode"),o=s?n.renderer.vr.getCamera(n.camera):n.camera;this.snapshot.mask=o.layers.mask,s&&(this.snapshot.mask0=o.cameras[0].layers.mask,this.snapshot.mask1=o.cameras[1].layers.mask),this.enableLights||this.hideEverythingButThisObject(e),this.viewingCamera.object3D.updateMatrices(),this.snapshot.matrixWorld.copy(this.viewingRig.object3D.matrixWorld),p(this.viewingRig.object3D,this.viewingCamera.object3D,this.inspected,t||1),this.snapshot.audio=function(e){let t;return e.traverse(e=>{t||"Audio"!==e.type||(t=e)}),t}(e),this.snapshot.audio&&(this.snapshot.audio.updateMatrices(),this.snapshot.audioTransform.copy(this.snapshot.audio.matrixWorld),n.audioListener.updateMatrices(),this.audioListenerTargetTransform.makeTranslation(0,0,1).premultiply(n.audioListener.matrixWorld),Object(a.l)(this.snapshot.audio,this.audioListenerTargetTransform))}uninspect(){if(this.temporarilyDisableRegularExit=!1,this.mode!==v)return;const e=AFRAME.scenes[0];e.is("entered")&&(e.classList.remove("hand-cursor"),e.classList.add("no-cursor")),this.showEverythingAsNormal(),this.inspected=null,this.snapshot.audio&&(Object(a.l)(this.snapshot.audio,this.snapshot.audioTransform),this.snapshot.audio=null),this.mode=this.snapshot.mode,this.snapshot.mode===b&&Object(a.l)(this.viewingRig.object3D,this.snapshot.matrixWorld),this.snapshot.mode=null,this.tick(AFRAME.scenes[0])}hideEverythingButThisObject(e){e.traverse(x);const t=AFRAME.scenes[0],i=t.is("vr-mode"),n=i?t.renderer.vr.getCamera(t.camera):t.camera;n.layers.set(_),i&&(n.cameras[0].layers.set(_),n.cameras[1].layers.set(_))}showEverythingAsNormal(){this.inspected&&this.inspected.traverse(S);const e=AFRAME.scenes[0],t=e.is("vr-mode"),i=t?e.renderer.vr.getCamera(e.camera):e.camera;i.layers.mask=this.snapshot.mask,t&&(i.cameras[0].layers.mask=this.snapshot.mask0,i.cameras[1].layers.mask=this.snapshot.mask1)}}},function(e,t,i){"use strict";function n(e,t){e.material&&(Array.isArray(e.material)?e.material.forEach(t):t(e.material))}function a(e,t){if(e.material)return Array.isArray(e.material)?e.material.map(t):t(e.material)}i.d(t,"a",function(){return n}),i.d(t,"b",function(){return a})},,function(e,t,i){"use strict";var n=i(138),a=i(139),s=i(78),o=i.n(s),r=i(65),l=i.n(r),c=i(76),d=i(8),h=i(75),u=i.n(h);function p(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}const m=["Baers-Pochard","Baikal-Teal","Barrows-Goldeneye","Blue-Billed","Blue-Duck","Blue-Winged","Brown-Teal","Bufflehead","Canvasback","Cape-Shoveler","Chestnut-Teal","Chiloe-Wigeon","Cinnamon-Teal","Comb-Duck","Common-Eider","Common-Goldeneye","Common-Merganser","Common-Pochard","Common-Scoter","Common-Shelduck","Cotton-Pygmy","Crested-Duck","Crested-Shelduck","Eatons-Pintail","Falcated","Ferruginous","Freckled-Duck","Gadwall","Garganey","Greater-Scaup","Green-Pygmy","Grey-Teal","Hardhead","Harlequin","Hartlaubs","Hooded-Merganser","Hottentot-Teal","Kelp-Goose","King-Eider","Lake-Duck","Laysan-Duck","Lesser-Scaup","Long-Tailed","Maccoa-Duck","Mallard","Mandarin","Marbled-Teal","Mellers-Duck","Merganser","Northern-Pintail","Orinoco-Goose","Paradise-Shelduck","Plumed-Whistler","Puna-Teal","Pygmy-Goose","Radjah-Shelduck","Red-Billed","Red-Crested","Red-Shoveler","Ring-Necked","Ringed-Teal","Rosy-Billed","Ruddy-Shelduck","Salvadoris-Teal","Scaly-Sided","Shelduck","Shoveler","Silver-Teal","Smew","Spectacled-Eider","Spot-Billed","Spotted-Whistler","Steamerduck","Stellers-Eider","Sunda-Teal","Surf-Scoter","Tufted-Duck","Velvet-Scoter","Wandering-Whistler","Whistling-duck","White-Backed","White-Cheeked","White-Winged","Wigeon","Wood-Duck","Yellow-Billed"];function g(e){return e[Math.floor(Math.random()*e.length)]}function f(){return v.apply(this,arguments)}function v(){var e;return e=function*(){const e=(yield Object(d.d)("/api/v1/media/search?filter=default&source=avatar_listings")).entries;return 0===e.length?new URL(u.a,location.href).href:g(e.map(e=>e.id))},(v=function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){p(s,n,a,o,r,"next",e)}function r(e){p(s,n,a,o,r,"throw",e)}o(void 0)})}).apply(this,arguments)}function b(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),n.forEach(function(t){w(e,t,i[t])})}return e}function y(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function _(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){y(s,n,a,o,r,"next",e)}function r(e){y(s,n,a,o,r,"throw",e)}o(void 0)})}}function w(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.d(t,"a",function(){return k}),i.d(t,"b",function(){return A});const E="___hubs_store",x=Symbol(),S="ret-oauth-flow-account-credentials",C=new n.Validator,k={id:"/HubsStore",definitions:{profile:{type:"object",additionalProperties:!1,properties:{displayName:{type:"string",pattern:"^[A-Za-z0-9 -]{3,32}$"},avatarId:{type:"string"},personalAvatarId:{type:"string"}}},credentials:{type:"object",additionalProperties:!1,properties:{token:{type:["null","string"]},email:{type:["null","string"]}}},activity:{type:"object",additionalProperties:!1,properties:{hasFoundFreeze:{type:"boolean"},hasChangedName:{type:"boolean"},hasAcceptedProfile:{type:"boolean"},lastEnteredAt:{type:"string"},hasPinned:{type:"boolean"},hasRotated:{type:"boolean"},hasRecentered:{type:"boolean"},hasScaled:{type:"boolean"},hasHoveredInWorldHud:{type:"boolean"},hasOpenedShare:{type:"boolean"},entryCount:{type:"number"}}},settings:{type:"object",additionalProperties:!1,properties:{lastUsedMicDeviceId:{type:"string"}}},preferences:{type:"object",additionalProperties:!1,properties:{muteMicOnEntry:{type:"bool"},enableOnScreenJoystickLeft:{type:"bool"},enableOnScreenJoystickRight:{type:"bool"},onlyShowNametagsInFreeze:{type:"bool"},allowMultipleHubsInstances:{type:"bool"},maxResolutionWidth:{type:"number"},maxResolutionHeight:{type:"number"},globalVoiceVolume:{type:"number"},globalMediaVolume:{type:"number"},snapRotationDegrees:{type:"number"},materialQualitySetting:{type:"string"},disableMovement:{type:"bool"},disableBackwardsMovement:{type:"bool"},disableStrafing:{type:"bool"},disableTeleporter:{type:"bool"}}},confirmedDiscordRooms:{type:"array",items:{type:"string"}},confirmedBroadcastedRooms:{type:"array",items:{type:"string"}},uploadPromotionTokens:{type:"array",items:{type:"object",additionalProperties:!1,properties:{fileId:{type:"string"},promotionToken:{type:"string"}}}},creatorAssignmentTokens:{type:"array",items:{type:"object",additionalProperties:!1,properties:{hubId:{type:"string"},creatorAssignmentToken:{type:"string"}}}},embedTokens:{type:"array",items:{type:"object",additionalProperties:!1,properties:{hubId:{type:"string"},embedToken:{type:"string"}}}},onLoadActions:{type:"array",items:{type:"object",additionalProperties:!1,properties:{action:{type:"string"},args:{type:"object"}}}}},type:"object",properties:{profile:{$ref:"#/definitions/profile"},credentials:{$ref:"#/definitions/credentials"},activity:{$ref:"#/definitions/activity"},settings:{$ref:"#/definitions/settings"},preferences:{$ref:"#/definitions/preferences"},confirmedDiscordRooms:{$ref:"#/definitions/confirmedDiscordRooms"},confirmedBroadcastedRooms:{$ref:"#/definitions/confirmedBroadcastedRooms"},uploadPromotionTokens:{$ref:"#/definitions/uploadPromotionTokens"},creatorAssignmentTokens:{$ref:"#/definitions/creatorAssignmentTokens"},embedTokens:{$ref:"#/definitions/embedTokens"},onLoadActions:{$ref:"#/definitions/onLoadActions"}},additionalProperties:!1};class A extends c.a{constructor(){var e;super(),e=this,w(this,"_signOutOnExpiredAuthToken",()=>{if(!this.state.credentials.token)return;1e3*l()(this.state.credentials.token).exp<=Date.now()&&this.update({credentials:{token:null,email:null}})}),w(this,"initProfile",_(function*(){e._shouldResetAvatarOnInit?yield e.resetToRandomDefaultAvatar():e.update({profile:b({avatarId:yield f()},e.state.profile||{})}),e.state.activity.hasChangedName||e.update({profile:{displayName:`${g(m)}-${Math.floor(1e4+1e4*Math.random())}`}})})),w(this,"resetToRandomDefaultAvatar",_(function*(){e.update({profile:b({},e.state.profile||{},{avatarId:yield f()})})})),null===localStorage.getItem(E)&&localStorage.setItem(E,JSON.stringify({})),window.addEventListener("storage",e=>{e.key===E&&(delete this[x],this.dispatchEvent(new CustomEvent("statechanged")))}),this.update({activity:{},settings:{},credentials:{},profile:{},confirmedDiscordRooms:[],confirmedBroadcastedRooms:[],uploadPromotionTokens:[],creatorAssignmentTokens:[],embedTokens:[],onLoadActions:[],preferences:{}}),this._shouldResetAvatarOnInit=!1;const t=o.a.getJSON(S);t&&(this.update({credentials:t}),this._shouldResetAvatarOnInit=!0,o.a.remove(S)),this._signOutOnExpiredAuthToken()}get state(){return this.hasOwnProperty(x)||(this[x]=JSON.parse(localStorage.getItem(E))),this[x]}get credentialsAccountId(){return this.state.credentials.token?l()(this.state.credentials.token).sub:null}resetConfirmedBroadcastedRooms(){this.clearStoredArray("confirmedBroadcastedRooms")}resetTipActivityFlags(){this.update({activity:{hasRotated:!1,hasPinned:!1,hasRecentered:!1,hasScaled:!1,entryCount:0}})}bumpEntryCount(){const e=this.state.activity.entryCount||0;this.update({activity:{entryCount:e+1}})}enqueueOnLoadAction(e,t){this.update({onLoadActions:[{action:e,args:t}]})}executeOnLoadActions(e){for(let t=0;t<this.state.onLoadActions.length;t++){const{action:i,args:n}=this.state.onLoadActions[t];"emit_scene_event"===i&&e.emit(n.event,n.detail)}this.clearOnLoadActions()}clearOnLoadActions(){this.clearStoredArray("onLoadActions")}clearStoredArray(e){const t={};t[e]=[],this.update(t,{arrayMerge:(e,t)=>t})}update(e,t){const i=Object(a.a)(this.state,e,t),{valid:n}=C.validate(i,k);if(!n)throw new Error("Write to store failed schema validation.");return localStorage.setItem(E,JSON.stringify(i)),delete this[x],void 0!==e.profile&&this.dispatchEvent(new CustomEvent("profilechanged")),this.dispatchEvent(new CustomEvent("statechanged")),i}}},,,function(e,t,i){e.exports=i.p+"assets/images/app-logo-157c06cff6c80227eb577f35c79e58b6.png"},function(e,t,i){e.exports=i.p+"assets/images/company-logo-8f6f7c3b303004256295b45c2eee5117.png"},function(e,t,i){e.exports=i.p+"assets/images/editor-logo-6f885a1543496ebc23a21b7fea82b255.png"},function(e,t,i){"use strict";function n(e){const t=e.sceneEl.is("frozen"),i=e.components.pinnable&&e.components.pinnable.data.pinned,n=!!e.components["super-spawner"],a=window.APP.hubChannel.can("spawn_and_move_media")&&(!i||window.APP.hubChannel.can("pin_objects"));return(n||!i||t)&&a}function a(e){const t=e.components.pinnable&&e.components.pinnable.data.pinned,i=e&&e.components.networked&&e.components.networked.data.template,n="#interactable-camera"===i,a="#interactable-pen"===i;return e.components.tags&&e.components.tags.data.holdableButton||window.APP.hubChannel.can("spawn_and_move_media")&&(!t||window.APP.hubChannel.can("pin_objects"))&&(!n||window.APP.hubChannel.can("spawn_camera"))&&(!a||window.APP.hubChannel.can("spawn_drawing"))}function s(e,t){const i="string"==typeof e,n=i?e:e.component;return i?t.components.findIndex(e=>e===n):t.components.findIndex(t=>t.component===n&&t.property===e.property)}i.d(t,"d",function(){return n}),i.d(t,"c",function(){return a}),i.d(t,"b",function(){return m}),i.d(t,"a",function(){return f});let o=null;function r(e,t){null===o&&function(){o={};const{schemaDict:e}=NAF.schemas;for(const t in e){if(!e.hasOwnProperty(t))continue;const i=e[t];o[t]=(i.nonAuthorizedComponents||[]).map(e=>s(e,i)).map(e=>e.toString())}}();const i=o[e];for(const e in t.components)t.components.hasOwnProperty(e)&&(i.includes(e)||(t.components[e]=null));return t}function l(e,t,i){const{template:n,creator:a,isPinned:s}=e,o=t===a;return!!n.endsWith("-waypoint-avatar")||(n.endsWith("-avatar")?o:n.endsWith("-media")?(!s||i.pin_objects)&&(o||i.spawn_and_move_media):n.endsWith("-camera")?o||i.spawn_camera:!(!n.endsWith("-pen")&&!n.endsWith("-drawing"))&&(o||i.spawn_drawing))}function c(e){const t=NAF.connection.adapter.getPendingDataForNetworkId(e);if(t){const{template:e,creator:i}=t,n=NAF.schemas.schemaDict[e],a=t.components[s("pinnable",n)];return{template:e,creator:i,isPinned:a&&a.pinned}}const i=NAF.entities.getEntity(e);if(!i)return null;const{template:n,creator:a}=i.components.networked.data;return{template:n,creator:a,isPinned:i.components.pinnable&&i.components.pinnable.data.pinned}}function d(e,t,i){const n=c(e.networkId);if(!n)return!1;if(l(n,t,i))return!0;{const{template:t}=n;return r(t,e),!0}}const h={};function u(e,t){if(h[t.networkId]){const e=h[t.networkId].data,i=e.components;Object.assign(e,t),e.components=Object.assign(i,t.components)}else h[t.networkId]={dataType:"u",data:t,clientId:e.clientId,from_session_id:e.from_session_id}}const p={};function m(e){const{dataType:t,from_session_id:i}=e;if("u"===t&&e.data.isFirstSync&&!e.data.persistent)return e;const n=window.APP.hubChannel.presence.state[i];if(!n)return p;const a=n.metas[0].permissions;if("um"===t){let t=!1,n=!1;for(const s in e.data.d){if(!e.data.d.hasOwnProperty(s))continue;const o=e.data.d[s];if(o.persistent&&!NAF.entities.getEntity(o.networkId))u(e,o),e.data.d[s]=null,n=!0;else{d(o,i,a)||(e.data.d[s]=null,t=!0)}}return(t||n)&&(e.data.d=e.data.d.filter(e=>null!=e)),e}if("u"===t){if(e.data.persistent&&!NAF.entities.getEntity(e.data.networkId))return h[e.data.networkId]=e,p;return d(e.data,i,a)?e:p}if("r"===t){const t=c(e.data.networkId);return t&&l(t,i,a)?e:p}return e}const g="phx-reliable";function f(e){h[e]&&(NAF.connection.adapter.onData(m(h[e]),g),delete h[e])}},,function(e,t,i){e.exports={"navigation-button":"client-info-dialog__navigation-button__2WZHM",navigationButton:"client-info-dialog__navigation-button__2WZHM","primary-action-buttons":"client-info-dialog__primary-action-buttons__3xJ_N",primaryActionButtons:"client-info-dialog__primary-action-buttons__3xJ_N",cancel:"client-info-dialog__cancel__2BguV","collapse-button":"client-info-dialog__collapse-button__1tTD7",collapseButton:"client-info-dialog__collapse-button__1tTD7","title-and-close":"client-info-dialog__title-and-close__1GbuZ",titleAndClose:"client-info-dialog__title-and-close__1GbuZ","object-display-string":"client-info-dialog__object-display-string__2wcOD",objectDisplayString:"client-info-dialog__object-display-string__2wcOD","cancel-text":"client-info-dialog__cancel-text__2mi_O",cancelText:"client-info-dialog__cancel-text__2mi_O","client-info-dialog":"client-info-dialog__client-info-dialog__2e1dc",clientInfoDialog:"client-info-dialog__client-info-dialog__2e1dc",title:"client-info-dialog__title__3FGPe","community-identifier":"client-info-dialog__community-identifier__g3lbP",communityIdentifier:"client-info-dialog__community-identifier__g3lbP","client-info":"client-info-dialog__client-info__1MUSa",clientInfo:"client-info-dialog__client-info__1MUSa","client-profile-image":"client-info-dialog__client-profile-image__zt1EA",clientProfileImage:"client-info-dialog__client-profile-image__zt1EA","client-details":"client-info-dialog__client-details__1F5zy",clientDetails:"client-info-dialog__client-details__1F5zy","client-main":"client-info-dialog__client-main__2BC1s",clientMain:"client-info-dialog__client-main__2BC1s","action-button-sections":"client-info-dialog__action-button-sections__amVnt",actionButtonSections:"client-info-dialog__action-button-sections__amVnt","action-button-placeholder":"client-info-dialog__action-button-placeholder__3MCZ3",actionButtonPlaceholder:"client-info-dialog__action-button-placeholder__3MCZ3","left-action-buttons":"client-info-dialog__left-action-buttons__Vul8Q",leftActionButtons:"client-info-dialog__left-action-buttons__Vul8Q","right-action-buttons":"client-info-dialog__right-action-buttons__231Az",rightActionButtons:"client-info-dialog__right-action-buttons__231Az","button-icon":"client-info-dialog__button-icon__1vKfx",buttonIcon:"client-info-dialog__button-icon__1vKfx","primary-action-button":"client-info-dialog__primary-action-button__NecRf",primaryActionButton:"client-info-dialog__primary-action-button__NecRf"}},,,,,,function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i(98),a=i.n(n),s=i(4);const o=window.ga;function r(e,t){const i=s.a.SENTRY_DSN,n=s.a.GA_TRACKING_ID;i&&(console.log("Tracking: Sentry DSN: "+i),a.a.config(i).install()),o&&n&&(console.log("Tracking: Google Analytics ID: "+n),o("create",n,"auto"),e&&o("set","page",e),t&&o("set","title",t),o("send","pageview"))}},,function(e,t,i){e.exports=i.p+"assets/sfx/tick-b0fcbf1d9b6f92a24bec12f9bae1e42a.mp3"},function(e,t,i){e.exports={"client-link":"presence-list__client-link__3tkyz",clientLink:"presence-list__client-link__3tkyz","presence-list":"presence-list__presence-list__1KERe",presenceList:"presence-list__presence-list__1KERe","attach-point":"presence-list__attach-point__kIdfx",attachPoint:"presence-list__attach-point__kIdfx",contents:"presence-list__contents__1B7bz",rows:"presence-list__rows__1B6KS",row:"presence-list__row__1D2j2","row-no-margin":"presence-list__row-no-margin__2FoEq",rowNoMargin:"presence-list__row-no-margin__2FoEq","row-header":"presence-list__row-header__3kl1w",rowHeader:"presence-list__row-header__3kl1w","list-item":"presence-list__list-item__2YARP",listItem:"presence-list__list-item__2YARP","list-item-link":"presence-list__list-item-link__2DLC2",listItemLink:"presence-list__list-item-link__2DLC2",presence:"presence-list__presence__15DJe","sign-in":"presence-list__sign-in__28eVu",signIn:"presence-list__sign-in__28eVu",icon:"presence-list__icon__1t8iB",self:"presence-list__self__1g-bw","moderator-badge":"presence-list__moderator-badge__2njku",moderatorBadge:"presence-list__moderator-badge__2njku"}},,,,,function(e,t,i){"use strict";i.d(t,"a",function(){return s}),i.d(t,"b",function(){return o});const n=function(){const e=new THREE.Box3;return function(t,i){return i.makeEmpty(),t.traverse(t=>{const n=t.geometry;null!=n&&(null==n.boundingBox&&n.computeBoundingBox(),i.union(e.copy(n.boundingBox).applyMatrix4(t.matrixWorld)))}),i}}(),a=new THREE.Euler;function s(e,t,i){const s=new THREE.Box3;return a.copy(e.object3D.rotation),e.object3D.rotation.set(0,0,0),e.object3D.updateMatrices(!0,!0),t.updateMatrices(!0,!0),t.updateMatrixWorld(!0),n(t,s),s.isEmpty()||(i||(e.object3D.worldToLocal(s.min),e.object3D.worldToLocal(s.max)),e.object3D.rotation.copy(a),e.object3D.matrixNeedsUpdate=!0),t.matrixWorldNeedsUpdate=!0,t.updateMatrices(),s}function o(e,t){if(t.isEmpty())return 1;const{max:i,min:n}=t,a=Math.abs(i.x-n.x),s=Math.abs(i.y-n.y),o=Math.abs(i.z-n.z);return e/Math.max(a,s,o)}},function(e,t,i){e.exports={"message-entry-input":"message-entry__message-entry-input__2AtQE",messageEntryInput:"message-entry__message-entry-input__2AtQE","message-entry":"message-entry__message-entry__x7lQX",messageEntry:"message-entry__message-entry__x7lQX","message-entry-disabled":"message-entry__message-entry-disabled__25LSI",messageEntryDisabled:"message-entry__message-entry-disabled__25LSI","message-entry-button":"message-entry__message-entry-button__3xJhH",messageEntryButton:"message-entry__message-entry-button__3xJhH","message-entry-spawn":"message-entry__message-entry-spawn__1_AF5",messageEntrySpawn:"message-entry__message-entry-spawn__1_AF5","message-entry-button-in-room":"message-entry__message-entry-button-in-room__2yMTR",messageEntryButtonInRoom:"message-entry__message-entry-button-in-room__2yMTR","message-entry-upload":"message-entry__message-entry-upload__3F0sX",messageEntryUpload:"message-entry__message-entry-upload__3F0sX","message-entry-in-room":"message-entry__message-entry-in-room__1aN5s",messageEntryInRoom:"message-entry__message-entry-in-room__1aN5s","message-entry-input-in-room":"message-entry__message-entry-input-in-room__30ReF",messageEntryInputInRoom:"message-entry__message-entry-input-in-room__30ReF","message-entry-input-no-spawn":"message-entry__message-entry-input-no-spawn__1wF7R",messageEntryInputNoSpawn:"message-entry__message-entry-input-no-spawn__1wF7R","message-entry-on-mobile":"message-entry__message-entry-on-mobile__2pSYF",messageEntryOnMobile:"message-entry__message-entry-on-mobile__2pSYF"}},,function(e,t,i){e.exports=i.p+"assets/models/DuckyMesh-04f978955fb12d48f7ff8c59a05de439.glb"},,function(e,t,i){"use strict";i.d(t,"c",function(){return c}),i.d(t,"a",function(){return d}),i.d(t,"b",function(){return u});var n=i(57),a=i.n(n);function s(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function o(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var o=e.apply(t,i);function r(e){s(o,n,a,r,l,"next",e)}function l(e){s(o,n,a,r,l,"throw",e)}r(void 0)})}}let r=!1;function l(){return(AFRAME.utils.device.isMobile()||AFRAME.utils.device.isMobileVR())&&!AFRAME.utils.device.isIOS()&&a.a.enabled}function c(){return!a.a.isFullscreen&&l()}function d(){return h.apply(this,arguments)}function h(){return(h=o(function*(){l()&&(r=!0,yield a.a.request())})).apply(this,arguments)}function u(){return p.apply(this,arguments)}function p(){return(p=o(function*(){r&&!a.a.isFullscreen&&(yield a.a.request())})).apply(this,arguments)}},,,function(e,t,i){"use strict";function n(){return new Promise(e=>{setTimeout(e,0)})}i.d(t,"a",function(){return n})},function(e,t,i){"use strict";i.d(t,"a",function(){return C}),i.d(t,"b",function(){return A});var n=i(80),a=i(48),s=i(222),o=i.n(s),r=i(97),l=i(17),c=i(11),d=i(113),h=i(153),u=i(12);function p(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function m(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){p(s,n,a,o,r,"next",e)}function r(e){p(s,n,a,o,r,"throw",e)}o(void 0)})}}THREE.Mesh.prototype.raycast=h.b;const g=new class{constructor(){var e,t,i;e=this,t="cache",i=new Map,t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}set(e,t){return this.cache.set(e,{gltf:t,count:0}),this.retain(e)}has(e){return this.cache.has(e)}get(e){return this.cache.get(e)}retain(e){const t=this.cache.get(e);return t.count++,t}release(e){const t=this.cache.get(e);t?(t.count--,t.count<=0&&(t.gltf.scene.traverse(u.f),this.cache.delete(e))):console.error(`Releasing uncached gltf ${e}`)}},f=new Map,v=Object(d.a)(new o.a);function b(e,t,i){if(!AFRAME.components[t])throw new Error(`Inflator failed. "${t}" component does not exist.`);if(AFRAME.components[t].multiple&&Array.isArray(i))for(let n=0;n<i.length;n++)e.setAttribute(t+"__"+n,i[n]);else e.setAttribute(t,i)}function y(e){return{animations:e.scene.animations,scene:Object(u.e)(e.scene)}}function _(e){const t=e.userData.gltfExtensions&&(e.userData.gltfExtensions.MOZ_hubs_components||e.userData.gltfExtensions.HUBS_components),i=e.userData.components;return t||i}AFRAME.GLTFModelPlus={components:{},registerComponent(e,t,i){i=i||b,AFRAME.GLTFModelPlus.components[e]={inflator:i,componentName:t}}};const w=function(e,t,i,n,a=1){"Chest"===t.name?t.name="Spine":"Root Scene"===t.name?t.name="AvatarRoot":"Bot_Skinned"===t.name&&(t.name="AvatarMesh");const s=[],o=t.children.slice(0);for(const t of o){const n=w(e,t,i);n&&s.push(n)}const r=_(t);if(!(!!r||t.name in i)&&!s.length&&!n)return null;const l=document.createElement("a-entity");l.append.apply(l,s);const c=(t.name||t.uuid).replace(/[^\w-]/g,"");l.classList.add(c),"YXZ"!==t.rotation.order&&t.rotation.setFromQuaternion(t.quaternion,"YXZ"),l.object3D.position.copy(t.position),l.object3D.rotation.copy(t.rotation),l.object3D.scale.copy(t.scale).multiplyScalar(a),l.object3D.matrixNeedsUpdate=!0,t.matrixAutoUpdate=!1,t.matrix.identity(),t.matrix.decompose(t.position,t.rotation,t.scale),l.setObject3D(t.type.toLowerCase(),t),r&&"nav-mesh"in r&&l.setObject3D("mesh",t),l.object3D.name=t.name,l.object3D.uuid=t.uuid,t.uuid=THREE.Math.generateUUID(),t.animations&&(t.parent.animations=t.animations);const d=t.userData.gltfIndex;return void 0!==d&&(e[d]=l),l};function E(){return(E=m(function*(e,t){let i=!0;const n=[];e.object3D.traverse(function(){var e=m(function*(e){const a={};a.promise=new Promise(e=>a.resolve=e),n.push(a),i||(yield n.shift().promise),i=!1;const s=_(e),o=e.el;if(s&&o)for(const e in s)if(s.hasOwnProperty(e)&&AFRAME.GLTFModelPlus.components.hasOwnProperty(e)){const{componentName:i,inflator:n}=AFRAME.GLTFModelPlus.components[e];yield n(o,i,s[e],s,t)}a.resolve()});return function(t){return e.apply(this,arguments)}}()),yield n.shift().promise})).apply(this,arguments)}function x(e,t,i){const n=e.querySelectorAll("."+t);for(const e of n){const t=i.cloneNode(!0);for(const i of t.attributes){const{name:t,value:n}=i;e.setAttribute(t,n)}for(;t.children.length>0;)e.appendChild(t.children[0])}}function S(e){return e.extensions&&e.extensions.MOZ_hubs_components?e.extensions.MOZ_hubs_components:e.extensions&&e.extensions.HUBS_components?e.extensions.HUBS_components:e.extras&&e.extras.gltfExtensions&&e.extras.gltfExtensions.MOZ_hubs_components?e.extras.gltfExtensions.MOZ_hubs_components:void 0}function C(e,t,i,n,a){return k.apply(this,arguments)}function k(){return(k=m(function*(e,t,i,n,s){let o,d=e;t&&(t.includes("model/gltf+zip")||t.includes("application/x-zip-compressed"))&&(o=yield v(d),d=o["scene.gtlf"]);const h=new THREE.LoadingManager;h.setURLModifier(Object(c.b)(d));const u=new THREE.GLTFLoader(h),p=yield new Promise((e,t)=>u.createParser(d,e,n,t));p.textureLoader=l.l,s&&(p.json=s(p.json));let m=0;p.json.extensions&&p.json.extensions.MOZ_hubs_components&&p.json.extensions.MOZ_hubs_components.hasOwnProperty("version")&&(m=p.json.extensions.MOZ_hubs_components.version),function(e,t){if(e<2){const e=t.nodes.find(e=>{const t=S(e);return t&&t.heightfield&&t["nav-mesh"]});e&&(e.extensions&&e.extensions.MOZ_hubs_components?delete e.extensions.MOZ_hubs_components.heightfield:e.extensions&&e.extensions.HUBS_components?delete e.extensions.HUBS_components.heightfield:e.extras&&e.extras.gltfExtensions&&e.extras.gltfExtensions.MOZ_hubs_components&&delete e.extras.gltfExtensions.MOZ_hubs_components)}if(e<4&&t.nodes)for(const e of t.nodes){const t=S(e);if(!t)continue;const i=t["spot-light"]||t["point-light"];i&&0===i.range&&(i.decay=0)}}(m,p.json);const g=p.json.materials;if(g)for(let e=0;e<g.length;e++){const t=g[e];if(t.extensions&&t.extensions.MOZ_alt_materials&&void 0!==t.extensions.MOZ_alt_materials[i]){const n=t.extensions.MOZ_alt_materials[i];g[e]=g[n]}}const f=p.json.nodes;if(f)for(let e=0;e<f.length;e++){const t=f[e];t.extras||(t.extras={}),t.extras.gltfIndex=e}const b=yield new Promise(p.parse.bind(p));return b.scene.traverse(e=>{e.matrixAutoUpdate=THREE.Object3D.DefaultMatrixAutoUpdate,e.material=Object(a.b)(e,e=>e.isMeshStandardMaterial&&"KHR_materials_unlit"===i?r.a.fromStandardMaterial(e):e)}),o&&Object.keys(o).forEach(URL.revokeObjectURL),b.scene.animations=b.animations,b})).apply(this,arguments)}function A(e){return T.apply(this,arguments)}function T(){return(T=m(function*(e,t=null,i=!1,n=null){const a=window.APP&&"low"===window.APP.quality?"KHR_materials_unlit":"pbrMetallicRoughness";if(i){if(g.has(e))return g.retain(e),y(g.get(e).gltf);if(f.has(e)){const t=yield f.get(e);return g.retain(e),y(t)}{const i=C(e,t,a,null,n);f.set(e,i);const s=yield i;return f.delete(e),g.set(e,s),y(s)}}return C(e,t,a,null,n)})).apply(this,arguments)}function M(e){if(e&&"#"===e.charAt(0)){const t=document.getElementById(e.substring(1));if(t)return t.getAttribute("src")}return e}AFRAME.registerComponent("gltf-model-plus",{schema:{src:{type:"string"},contentType:{type:"string"},useCache:{default:!0},inflate:{default:!1},batch:{default:!1},modelToWorldScale:{type:"number",default:1}},init(){this.jsonPreprocessor=null,this.loadTemplates()},update(){this.applySrc(M(this.data.src),this.data.contentType)},remove(){this.data.batch&&this.model&&this.el.sceneEl.systems["hubs-systems"].batchManagerSystem.removeObject(this.el.object3DMap.mesh);const e=M(this.data.src);e&&g.release(e)},loadTemplates(){this.templates={},this.el.querySelectorAll(":scope > template").forEach(e=>{const t=document.importNode(e.firstElementChild||e.content.firstElementChild,!0);this.templates[e.getAttribute("data-name")]=t})},applySrc(e,t){var i=this;return m(function*(){try{if(e===i.lastSrc)return;const a=i.lastSrc;if(i.lastSrc=e,!e)return void(i.inflatedEl&&(console.warn("gltf-model-plus set to an empty source, unloading inflated model."),i.disposeLastInflatedEl()));i.el.emit("model-loading");const s=yield A(e,t,i.data.useCache,i.jsonPreprocessor);if(e!=i.lastSrc)return;i.disposeLastInflatedEl(),i.model=s.scene||s.scenes[0],i.data.batch&&i.el.sceneEl.systems["hubs-systems"].batchManagerSystem.addObject(i.model),s.animations.length>0?(i.el.setAttribute("animation-mixer",{}),i.el.components["animation-mixer"].initMixer(i.model.animations)):i.model.traverse(e=>{const t=e.isMesh&&e.geometry.isBufferGeometry,i=t&&e.geometry.boundsTree;if(t&&!i&&e.geometry.attributes.position){const t=e.geometry,i=t.index?t.index.count/3:t.attributes.position.count/3;i>1e3&&i<1e6&&(t.boundsTree=new h.a(e.geometry,{strategy:0,maxDepth:30}))}});const o={};let r=i.model;if(i.data.inflate&&(i.inflatedEl=w(o,i.model,i.templates,!0,i.data.modelToWorldScale))){if(i.el.appendChild(i.inflatedEl),(r=i.inflatedEl.object3D).visible=!1,yield Object(n.a)(),e!=i.lastSrc)return;yield function(e,t){return E.apply(this,arguments)}(i.inflatedEl,o);for(const e in i.templates)x(i.el,e,i.templates[e])}const l=[];r.traverse(e=>{const t=e.el;t&&l.push(()=>e.el=t)});const c=i.el.sceneEl.components["environment-map"];c&&c.applyEnvironmentMap(r),a&&g.release(a),i.el.setObject3D("mesh",r),l.forEach(e=>e()),r.visible=!0,i.el.emit("model-loaded",{format:"gltf",model:i.model})}catch(t){g.release(e),console.error("Failed to load glTF model",t,i),i.el.emit("model-error",{format:"gltf",src:e})}})()},disposeLastInflatedEl(){this.inflatedEl&&(this.inflatedEl.parentNode.removeChild(this.inflatedEl),this.inflatedEl.object3D.traverse(e=>{e.material&&e.material.dispose&&e.material.dispose(),e.geometry&&(e.geometry.dispose&&e.geometry.dispose(),e.geometry.boundsTree=null)}),delete this.inflatedEl,this.el.removeAttribute("animation-mixer"))}})},,,function(e,t,i){e.exports={"profile-entry":"profile__profile-entry__1pJKZ",profileEntry:"profile__profile-entry__1pJKZ","form-submit":"profile__form-submit__2y7xb",formSubmit:"profile__form-submit__2y7xb","choose-avatar":"profile__choose-avatar__2EV0F",chooseAvatar:"profile__choose-avatar__2EV0F","form-field-text":"profile__form-field-text__1bzeV",formFieldText:"profile__form-field-text__1bzeV",title:"profile__title__Vcynv",close:"profile__close__2Uitz",logo:"profile__logo__1JZAd",form:"profile__form__1-hBO",box:"profile__box__oJXQD",links:"profile__links__2hukW","display-name":"profile__display-name__auABh",displayName:"profile__display-name__auABh",preview:"profile__preview__3QjLq","edit-avatar":"profile__edit-avatar__3386A",editAvatar:"profile__edit-avatar__3386A"}},function(e,t,i){e.exports={buttons:"tweet-dialog__buttons__1gYv2","tweet-button":"tweet-dialog__tweet-button__3XvNj",tweetButton:"tweet-dialog__tweet-button__3XvNj",tweet:"tweet-dialog__tweet__25N6e",editor:"tweet-dialog__editor__3xJV-","editor-inner":"tweet-dialog__editor-inner__1Zhzc",editorInner:"tweet-dialog__editor-inner__1Zhzc","emoji-button":"tweet-dialog__emoji-button__2L9tR",emojiButton:"tweet-dialog__emoji-button__2L9tR",counter:"tweet-dialog__counter__2OZyX",media:"tweet-dialog__media__IeN9e",posted:"tweet-dialog__posted__2t8RC","tweet-loader":"tweet-dialog__tweet-loader__3Q8YL",tweetLoader:"tweet-dialog__tweet-loader__3Q8YL","dialog-background":"tweet-dialog__dialog-background__2vvyQ",dialogBackground:"tweet-dialog__dialog-background__2vvyQ"}},,,function(e,t,i){"use strict";function n(e,t){for(;e&&(!e.components||!e.components[t]);)e=e.parentNode;return e}i.d(t,"a",function(){return n})},function(e,t,i){"use strict";function n(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}i.d(t,"a",function(){return a}),i.d(t,"b",function(){return s});const a=window.createImageBitmap||function(){var e,t=(e=function*(e){return new Promise(t=>{let i;if(e instanceof Blob)i=URL.createObjectURL(e);else{const t=document.createElement("canvas"),n=t.getContext("2d");t.width=e.width,t.height=e.height,n.putImageData(e,0,0),i=t.toDataURL()}const n=document.createElement("img");n.addEventListener("load",()=>t(n)),n.src=i})},function(){var t=this,i=arguments;return new Promise(function(a,s){var o=e.apply(t,i);function r(e){n(o,a,s,r,l,"next",e)}function l(e){n(o,a,s,r,l,"throw",e)}r(void 0)})});return function(e){return t.apply(this,arguments)}}();function s(e){e instanceof HTMLImageElement&&e.src.startsWith("blob:")?URL.revokeObjectURL(e.src):e.close&&e.close()}},function(e,t,i){e.exports={"email-field":"sign-in-dialog__email-field__g3xRW",emailField:"sign-in-dialog__email-field__g3xRW","next-button":"sign-in-dialog__next-button__2pGtq",nextButton:"sign-in-dialog__next-button__2pGtq","continue-button":"sign-in-dialog__continue-button__kFN6Z",continueButton:"sign-in-dialog__continue-button__kFN6Z","sign-in-form":"sign-in-dialog__sign-in-form__3Muog",signInForm:"sign-in-dialog__sign-in-form__3Muog","sign-in-complete":"sign-in-dialog__sign-in-complete__3JMkv",signInComplete:"sign-in-dialog__sign-in-complete__3JMkv",terms:"sign-in-dialog__terms__3TT6i"}},,,,,function(e,t,i){"use strict";i.d(t,"a",function(){return o}),i.d(t,"b",function(){return s});var n=i(14);i(4);const a={"action-color":"#FF3464","action-label-color":"#FF3464","action-color-disabled":"#FF74A4","action-color-highlight":"#FF74A4","action-text-color":"#FFFFFF","action-subtitle-color":"#F0F0F0","notice-background-color":"#2F80ED","notice-text-color":"#FFFFFF","favorited-color":"#FFC000"};function s(e){return window.APP_CONFIG&&window.APP_CONFIG.theme&&window.APP_CONFIG.theme[e]?window.APP_CONFIG.theme[e]:a[e]}function o(e,t){e.setAttribute("text-button","backgroundColor",s(t?"action-color-highlight":"action-color")),e.setAttribute("text-button","backgroundHoverColor",t?"#aaa":s("action-color-highlight"))}Object(n.a)().then(()=>{window.APP_CONFIG&&window.APP_CONFIG.theme&&window.APP_CONFIG.theme["dark-theme"]?document.body.classList.add("dark-theme"):document.body.classList.add("light-theme");const e=s("action-color"),t=s("action-color-highlight");document.querySelector("#rounded-text-button")&&(document.querySelector("#rounded-text-button").setAttribute("text-button",`textHoverColor: ${t}; textColor: ${e}; backgroundColor: #fff; backgroundHoverColor: #aaa;`),document.querySelector("#rounded-button").setAttribute("text-button",`textHoverColor: ${t}; textColor: ${e}; backgroundColor: #fff; backgroundHoverColor: #aaa;`),document.querySelector("#rounded-text-action-button").setAttribute("text-button",`textHoverColor: #fff; textColor: #fff; backgroundColor: ${e}; backgroundHoverColor: ${t}`),document.querySelector("#rounded-action-button").setAttribute("text-button",`textHoverColor: #fff; textColor: #fff; backgroundColor: ${e}; backgroundHoverColor: ${t}`))})},function(e,t,i){e.exports=i.p+"assets/images/warning_icon-739d2a2ea906737505bcbc2cb51123a8.png"},function(e,t,i){"use strict";function n(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),n.forEach(function(t){a(e,t,i[t])})}return e}function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.d(t,"a",function(){return r});const s="\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n  #include <uv_vertex>\n  #include <uv2_vertex>\n  #include <color_vertex>\n  #include <skinbase_vertex>\n\n  #include <begin_vertex>\n  #include <morphtarget_vertex>\n  #include <skinning_vertex>\n  #include <project_vertex>\n  #include <logdepthbuf_vertex>\n\n  #include <worldpos_vertex>\n  #include <clipping_planes_vertex>\n  #include <fog_vertex>\n}\n",o="\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <aomap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n  #include <clipping_planes_fragment>\n\n  vec4 diffuseColor = vec4(diffuse, opacity);\n  ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));\n  vec3 totalEmissiveRadiance = emissive;\n\n  #include <logdepthbuf_fragment>\n  #include <map_fragment>\n  #include <color_fragment>\n  #include <alphatest_fragment>\n  #include <emissivemap_fragment>\n\n  reflectedLight.indirectDiffuse += vec3(1.0);\n\n  #include <aomap_fragment>\n\n  reflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n  vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n  gl_FragColor = vec4(outgoingLight, diffuseColor.a);\n\n  #include <premultiplied_alpha_fragment>\n  #include <tonemapping_fragment>\n  #include <encodings_fragment>\n  #include <fog_fragment>\n}\n";class r extends THREE.ShaderMaterial{constructor(...e){super(...e),a(this,"type","MobileStandardMaterial"),a(this,"isMobileStandardMaterial",!0)}static fromStandardMaterial(e){const t={vertexShader:s,fragmentShader:o,uniforms:n({},THREE.UniformsUtils.clone(THREE.UniformsLib.fog),{uvTransform:{value:new THREE.Matrix3},diffuse:{value:e.color},opacity:{value:e.opacity},map:{value:e.map},aoMapIntensity:{value:e.aoMapIntensity},aoMap:{value:e.aoMap},emissive:{value:e.emissive},emissiveMap:{value:e.emissiveMap}}),fog:!0,lights:!1,opacity:e.opacity,transparent:e.transparent,alphaTest:e.alphaTest,skinning:e.skinning,morphTargets:e.morphTargets,vertexColors:e.vertexColors,name:e.name},i=new r(t);return i.color=e.color,i.map=e.map,i.aoMap=e.aoMap,i.aoMapIntensity=e.aoMapIntensity,i.emissive=e.emissive,i.emissiveIntensity=e.emissiveIntensity,i.emissiveMap=e.emissiveMap,i.refreshUniforms(),i}refreshUniforms(){this.uniforms.opacity.value=this.opacity,this.color&&this.uniforms.diffuse.value.copy(this.color),this.emissive&&this.uniforms.emissive.value.copy(this.emissive).multiplyScalar(this.emissiveIntensity),this.map&&(this.uniforms.map.value=this.map),this.aoMap&&(this.uniforms.aoMap.value=this.aoMap,this.uniforms.aoMapIntensity.value=this.aoMapIntensity);const e=this.map||this.emissiveMap;e&&!0===e.matrixAutoUpdate&&(e.updateMatrix(),this.uniforms.uvTransform.value.copy(e.matrix))}clone(){return r.fromStandardMaterial(this)}}},,,,function(e,t,i){e.exports={"description-field":"room-settings-dialog__description-field__36sKF",descriptionField:"room-settings-dialog__description-field__36sKF","name-field":"room-settings-dialog__name-field___yGhb",nameField:"room-settings-dialog__name-field___yGhb","next-button":"room-settings-dialog__next-button__2F9Jd",nextButton:"room-settings-dialog__next-button__2F9Jd","continue-button":"room-settings-dialog__continue-button__2Ltsg",continueButton:"room-settings-dialog__continue-button__2Ltsg","room-settings-form":"room-settings-dialog__room-settings-form__yNism",roomSettingsForm:"room-settings-dialog__room-settings-form__yNism","select-container":"room-settings-dialog__select-container__SGcNH",selectContainer:"room-settings-dialog__select-container__SGcNH",permission:"room-settings-dialog__permission__3W-cW",subtitle:"room-settings-dialog__subtitle__2ddy2",permissions:"room-settings-dialog__permissions__1sHPN","permissions-group":"room-settings-dialog__permissions-group__1oRYA",permissionsGroup:"room-settings-dialog__permissions-group__1oRYA","permission-disabled":"room-settings-dialog__permission-disabled__3NH-j",permissionDisabled:"room-settings-dialog__permission-disabled__3NH-j"}},,,,,,function(e,t,i){e.exports={"tip-root":"tip__tip-root__1s7D1",tipRoot:"tip__tip-root__1s7D1","tip-link":"tip__tip-link__3m4Iq",tipLink:"tip__tip-link__3m4Iq","tip-cancel":"tip__tip-cancel__1xPNP",tipCancel:"tip__tip-cancel__1xPNP",tip:"tip__tip__32KOl","split-tip":"tip__split-tip__1xSCE",splitTip:"tip__split-tip__1xSCE","split-tip-icon":"tip__split-tip-icon__1ZXw0",splitTipIcon:"tip__split-tip-icon__1ZXw0","spawn_menu-icon":"tip__spawn_menu-icon__2en_9",spawnMenuIcon:"tip__spawn_menu-icon__2en_9","object_rotate_button-icon":"tip__object_rotate_button-icon__2tgeV",objectRotateButtonIcon:"tip__object_rotate_button-icon__2tgeV","object_scale_button-icon":"tip__object_scale_button-icon__pxKrw",objectScaleButtonIcon:"tip__object_scale_button-icon__pxKrw","object_recenter_button-icon":"tip__object_recenter_button-icon__38tNR",objectRecenterButtonIcon:"tip__object_recenter_button-icon__38tNR","tour-tip-root":"tip__tour-tip-root__1PxCu",tourTipRoot:"tip__tour-tip-root__1PxCu"}},,,,function(e,t){e.exports={COLLISION_LAYERS:{ALL:-1,NONE:0,INTERACTABLES:1,ENVIRONMENT:2,AVATAR:4,HANDS:8,DEFAULT_INTERACTABLE:15,UNOWNED_INTERACTABLE:9,DEFAULT_SPAWNER:9}}},,function(e,t,i){"use strict";function n(e){let t=0;const i={};return e.onmessage=t=>{const{id:n,result:a,err:s}=t.data,o=i[n];null==o?console.error(`Unknown message with ID ${n} received from ${e}.`):(delete i[n],null!=s?o.reject(new Error(s)):o.resolve(a))},function(n,a,s={}){const o=t++,r=new Promise((e,t)=>{i[o]={resolve:e,reject:t}});return e.postMessage(Object.assign(s,{id:o,payload:n}),a),r}}i.d(t,"a",function(){return n})},function(e,t,i){"use strict";i.d(t,"a",function(){return p}),i.d(t,"b",function(){return f});var n=i(76),a=i(4),s=i(8),o=i(16);function r(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function l(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){r(s,n,a,o,l,"next",e)}function l(e){r(s,n,a,o,l,"throw",e)}o(void 0)})}}function c(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const d={entries:[],meta:{}},h={scenes:"scene_listings",images:"bing_images",videos:"bing_videos",youtube:"youtube_videos",gifs:"tenor",sketchfab:"sketchfab",poly:"poly",twitch:"twitch",favorites:"favorites"},u=a.a.AVAILABLE_INTEGRATIONS,p=["poly","sketchfab","videos","scenes","avatars","gifs","images"].filter(e=>{const t=h[e];return!u.hasOwnProperty(t)||u[t]}),m={gifs:"trending",sketchfab:"featured",scenes:"featured",favorites:"my-favorites"},g=["q","filter","cursor","similar_to"];class f extends n.a{constructor(){var e;super(),e=this,c(this,"_update",function(){var t=l(function*(t){e.result=null,e.dispatchEvent(new CustomEvent("statechanged"));const i=e.getUrlMediaSource(t);if(!i)return;e.previousSource&&e.previousSource===i||(e.dispatchEvent(new CustomEvent("sourcechanged")),e.previousSource=i);const n=new URLSearchParams(t.search);e.requestIndex++;const a=e.requestIndex,o=new URLSearchParams,r=new URLSearchParams(t.search),l=r.get("filter")&&r.get("filter").startsWith("my-");for(const e of g)n.get(e)&&o.set(e,n.get(e));let c;if(o.get("locale",navigator.languages[0]),"avatars"===i||"scenes"===i){const e="avatars"===i?"avatar":"scene";c=l?`${e}s`:`${e}_listings`}else c=h[i];o.set("source",c);let u=!0;"avatars"!==c&&"scenes"!==c&&"favorites"!==c||l&&(window.APP.store.credentialsAccountId?o.set("user",window.APP.store.credentialsAccountId):u=!1);const p=`/api/v1/media/search?${o.toString()}`,m=Object(s.h)(p);if(e.lastSavedUrl===m)return;e.isFetching=!0,e.dispatchEvent(new CustomEvent("statechanged"));const f=u?yield Object(s.d)(p):d;e.requestIndex==a&&(e.result=f,e.nextCursor=e.result&&e.result.meta&&e.result.meta.next_cursor,e.lastFetchedUrl=m,e.isFetching=!1,e.dispatchEvent(new CustomEvent("statechanged")))});return function(e){return t.apply(this,arguments)}}()),c(this,"pageNavigate",e=>{if(-1===e)this.history.goBack();else{const e=this.history.location,t=new URLSearchParams(e.search);t.set("cursor",this.nextCursor),Object(o.d)(this.history,e.pathname,t.toString())}}),c(this,"filterQueryNavigate",(e,t)=>{const i=this.history.location,n=new URLSearchParams(i.search);n.delete("similar_to"),n.delete("similar_name"),t?n.set("q",t):n.delete("q"),e?n.set("filter",e):n.delete("filter"),e?n.set("cursor",e):n.delete("cursor"),Object(o.d)(this.history,i.pathname,n.toString())}),c(this,"getSearchClearedSearchParams",(e,t,i,n)=>{const a=new URLSearchParams(e.search);return a.delete("q"),a.delete("filter"),a.delete("cursor"),a.delete("similar_to"),a.delete("similar_name"),i||a.delete("media_nav"),t||a.delete("media_source"),n||a.delete("selectAction"),a}),c(this,"_stashLastSearchParams",e=>{const t=new URLSearchParams(e.search);this._stashedParams={},this._stashedSource=null;const i=this.getUrlMediaSource(e);if("favorites"!==i){this._stashedSource=i;for(const e of g){const i=t.get(e);i&&(this._stashedParams[e]=i)}}}),c(this,"clearStashedQuery",()=>{this._stashedParams&&delete this._stashedParams.q}),c(this,"sourceNavigate",e=>{this._sourceNavigate(e,!1,!0)}),c(this,"sourceNavigateToDefaultSource",()=>{this._sourceNavigate(this._stashedSource?this._stashedSource:p[0],!1,!0)}),c(this,"sourceNavigateWithNoNav",(e,t)=>{this._sourceNavigate(e,!0,!1,t)}),c(this,"_sourceNavigate",function(){var t=l(function*(t,i,n,r){const l=new URLSearchParams(e.history.location.search).get("q"),c=e.getSearchClearedSearchParams(e.history.location);if(l)c.set("q",l);else if(n&&e._stashedParams)for(const i of g){const n=e._stashedParams[i],a="q"===i||e._stashedSource===t;n&&a&&c.set(i,n)}else if("avatars"===t){const t=yield e._hasAccountWithAvatars();c.set("filter",t?"my-avatars":"featured")}else m[t]&&c.set("filter",m[t]);e._stashedParams=null,e._stashedSource=null,i&&c.set("media_nav","false"),r&&c.set("selectAction",r),Object(s.j)()&&document.location.host!==a.a.RETICULUM_SERVER?(c.set("media_source",t),Object(o.d)(e.history,e.history.location.pathname,c.toString())):Object(o.d)(e.history,Object(o.h)(e.history.location,`/media/${t}`),c.toString())});return function(e,i,n,a){return t.apply(this,arguments)}}()),c(this,"_hasAccountWithAvatars",l(function*(){const{credentialsAccountId:e}=window.APP.store;if(!e)return!1;const t=new URLSearchParams;t.set("source","avatars"),t.set("user",e);const i=yield Object(s.d)(`/api/v1/media/search?${t.toString()}`);return!(!i||!i.entries)&&i.entries.length>0})),c(this,"getUrlMediaSource",e=>{const{search:t}=e,i=new URLSearchParams(t),n=Object(o.g)(e);return n.startsWith("/media")||i.get("media_source")?i.get("media_source")||n.substring(7):null}),c(this,"pushExitMediaBrowserHistory",(e,t=!0)=>{e||(e=this.history),t&&this._stashLastSearchParams(e.location);const{pathname:i}=e.location,n=Object(o.g)(e.location).startsWith("/media");Object(o.d)(e,n?Object(o.h)(e.location,"/"):i,this.getSearchClearedSearchParams(e.location).toString()),this.dispatchEvent(new CustomEvent("media-exit"))}),this.requestIndex=0}setHistory(e){this.history=e,this._update(this.history.location),this.history.listen(e=>{this._update(e)})}}},function(e,t,i){"use strict";var n,a,s,o=i(0),r=i.n(o),l=i(2),c=i.n(l),d=i(16);function h(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}class u extends r.a.Component{handleClick(e,t){var i,n=this;return(i=function*(){if(n.props.onClick&&n.props.onClick(e),!(e.defaultPrevented||0!==e.button||n.props.target&&"_self"!==n.props.target||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))){e.preventDefault(),(n.props.replace?d.f:d.e)(t,n.props.stateKey,n.props.stateValue,n.props.stateDetail)}},function(){var e=this,t=arguments;return new Promise(function(n,a){var s=i.apply(e,t);function o(e){h(s,n,a,o,r,"next",e)}function r(e){h(s,n,a,o,r,"throw",e)}o(void 0)})})()}render(){const{innerRef:e,target:t,className:i,title:n,children:a}=this.props;return r.a.createElement("a",{target:t,className:i,title:n,onClick:e=>this.handleClick(e,this.props.history),href:"#",ref:e},a)}}n=u,a="propTypes",s={history:c.a.object,innerRef:c.a.object,replace:c.a.bool,stateKey:c.a.string,stateValue:c.a.string,stateDetail:c.a.object,target:c.a.string,title:c.a.string,onClick:c.a.func,children:c.a.node,className:c.a.string},a in n?Object.defineProperty(n,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[a]=s,t.a=u},,function(e,t,i){e.exports={touchZone:"virtual-gamepad-controls__touchZone__1KF_C",left:"virtual-gamepad-controls__left__1-URB",right:"virtual-gamepad-controls__right__1cgnU",mockJoystickContainer:"virtual-gamepad-controls__mockJoystickContainer__1aH3e",mockJoystick:"virtual-gamepad-controls__mockJoystick__2CuCG",inner:"virtual-gamepad-controls__inner__1Bn3C"}},function(e,t,i){e.exports={"action-button":"create-object-dialog__action-button__3OIJQ",actionButton:"create-object-dialog__action-button__3OIJQ",buttons:"create-object-dialog__buttons__1zA-b","small-button":"create-object-dialog__small-button__7UxXQ",smallButton:"create-object-dialog__small-button__7UxXQ","input-border":"create-object-dialog__input-border__1N9AV",inputBorder:"create-object-dialog__input-border__1N9AV","left-side-of-input":"create-object-dialog__left-side-of-input__zyV06",leftSideOfInput:"create-object-dialog__left-side-of-input__zyV06","add-media-form":"create-object-dialog__add-media-form__10Wh-",addMediaForm:"create-object-dialog__add-media-form__10Wh-","cancel-icon":"create-object-dialog__cancel-icon__yD-8A",cancelIcon:"create-object-dialog__cancel-icon__yD-8A","upload-icon":"create-object-dialog__upload-icon__19g9k",uploadIcon:"create-object-dialog__upload-icon__19g9k","hide-file-input":"create-object-dialog__hide-file-input__2myDe",hideFileInput:"create-object-dialog__hide-file-input__2myDe"}},function(e,t,i){e.exports={"close-button":"link-dialog__close-button__2THTw",closeButton:"link-dialog__close-button__2THTw",domain:"link-dialog__domain__1WbPJ",dialog:"link-dialog__dialog__1zbyG",header:"link-dialog__header__1A06x",contents:"link-dialog__contents__3ODVz",code:"link-dialog__code__259RI",imageHeader:"link-dialog__imageHeader__eaJe6","keep-open":"link-dialog__keep-open__DYcUI",keepOpen:"link-dialog__keep-open__DYcUI",digit:"link-dialog__digit___zoC4","code-loading-panel":"link-dialog__code-loading-panel__WKkNk",codeLoadingPanel:"link-dialog__code-loading-panel__WKkNk",close:"link-dialog__close__2TTmg"}},,,,,,function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i(105);function a(){if("iOS"!==Object(n.detectOS)(navigator.userAgent))return;let e=0;document.addEventListener("touchmove",e=>{1!==e.scale&&e.preventDefault()}),document.addEventListener("touchend",t=>{const i=(new Date).getTime(),n=i-e<=300;e=i,n&&t.preventDefault()})}},function(e,t,i){"use strict";function n(e,t){window.APP.componentRegistry=window.APP.componentRegistry||{},window.APP.componentRegistry[t]=window.APP.componentRegistry[t]||[],window.APP.componentRegistry[t].push(e)}function a(e,t){window.APP.componentRegistry&&window.APP.componentRegistry[t]&&window.APP.componentRegistry[t].splice(window.APP.componentRegistry[t].indexOf(e),1)}function s(){if(!(window.APP&&window.APP.componentRegistry&&window.APP.hubChannel&&window.APP.hubChannel.presence))return null;const e=window.APP.componentRegistry["player-info"]||[],t=window.APP.hubChannel.presence.state;for(let i=0;i<e.length;i++){const n=e[i],a=t[n.playerSessionId];if(a&&a.metas[0]&&a.metas[0].streaming)return n}return null}i.d(t,"c",function(){return n}),i.d(t,"a",function(){return a}),i.d(t,"b",function(){return s})},function(e,t,i){"use strict";i.d(t,"a",function(){return a});let n=null;function a(){return null===n&&(n=/\b(Macintosh|iPad|iPhone)\b/i.test(navigator.userAgent)&&function(){let e=!1;if("maxTouchPoints"in navigator)e=navigator.maxTouchPoints>0;else if("msMaxTouchPoints"in navigator)e=navigator.msMaxTouchPoints>0;else{const t=window.matchMedia&&matchMedia("(pointer:coarse)");if(t&&"(pointer:coarse)"===t.media)e=!!t.matches;else if("orientation"in window)e=!0;else{const t=navigator.userAgent;e=/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(t)||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(t)}}return e}()),n}},,,,,,,,,,,,,function(e,t,i){"use strict";i.d(t,"a",function(){return f});var n=i(0),a=i.n(n),s=i(2),o=i.n(s),r=i(3),l=i(4),c=i(19),d=i(90),h=i.n(d),u=i(20),p=i(37);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function g(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class f extends n.Component{constructor(...e){super(...e),g(this,"state",{email:""}),g(this,"onSubmit",e=>{e.preventDefault(),e.stopPropagation(),this.props.onSignIn(this.state.email)})}render(){let e;return e=this.props.authStarted?a.a.createElement("p",null,a.a.createElement(r.a,{className:"preformatted",id:"sign-in.auth-started"})):this.props.authComplete?a.a.createElement("div",{className:h.a.signInComplete},a.a.createElement("p",null,this.props.message),a.a.createElement("button",{onClick:this.props.onContinue,className:h.a.continueButton},this.props.continueText)):a.a.createElement("form",{onSubmit:this.onSubmit,className:h.a.signInForm},a.a.createElement("span",null,this.props.message),a.a.createElement("input",{name:"email",type:"email",required:!0,placeholder:"Your email address",value:this.state.email,onFocus:e=>Object(p.b)(e.target),onBlur:()=>Object(p.a)(),onChange:e=>this.setState({email:e.target.value}),className:h.a.emailField}),(l.a.feature("show_terms")||l.a.feature("show_privacy"))&&a.a.createElement("p",{className:h.a.terms},"By proceeding, you agree to the"," ",a.a.createElement(c.a,{name:"show_terms"},a.a.createElement("a",{rel:"noopener noreferrer",target:"_blank",href:l.a.link("terms_of_use","https://github.com/mozilla/hubs/blob/master/TERMS.md")},"terms of use")," "),l.a.feature("show_terms")&&l.a.feature("show_privacy")&&"and ",a.a.createElement(c.a,{name:"show_privacy"},a.a.createElement("a",{rel:"noopener noreferrer",target:"_blank",href:l.a.link("privacy_notice","https://github.com/mozilla/hubs/blob/master/PRIVACY.md")},"privacy notice")),"."),a.a.createElement("button",{type:"submit",className:h.a.nextButton},"next")),a.a.createElement(u.a,m({title:"Sign In"},this.props),e)}}g(f,"propTypes",{authStarted:o.a.bool,authComplete:o.a.bool,onSignIn:o.a.func,onContinue:o.a.func,message:o.a.string,continueText:o.a.string,closable:o.a.bool}),g(f,"defaultProps",{closable:!0})},,,,,,,,,function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i(48),a=i(56);const s=[],o=[],r=["MeshStandardMaterial","MeshBasicMaterial","MobileStandardMaterial"];AFRAME.registerComponent("hoverable-visuals",{schema:{enableSweepingEffect:{type:"boolean",default:!0}},init(){this.uniforms=null,this.geometryRadius=0,this.sweepParams=[0,0]},remove(){this.uniforms=null,this.boundingBox=null;const e=this.el.sceneEl.systems["hubs-systems"].batchManagerSystem;this.el.object3D.traverse(t=>{t.material&&Object(n.a)(t,i=>{!r.includes(i.type)||t.el.classList.contains("ui")||t.el.classList.contains("hud")||t.el.getAttribute("text-button")||e.meshToEl.delete(t)})});const t=AFRAME.utils.device.isMobile(),i=AFRAME.utils.device.isMobileVR();this.isTouchscreen=t&&!i},tick(e){if(!this.uniforms||!this.uniforms.length)return;const t=this.el.sceneEl.is("frozen"),i=Object(a.d)(this.el),n=this.el.sceneEl.systems["hubs-systems"].cursorTogglingSystem;let r,l;const c=this.el.sceneEl.systems.interaction;if(c.ready){if(c.state.leftHand.hovered!==this.el||c.state.leftHand.held||(r=c.options.leftHand.entity.object3D),c.state.leftRemote.hovered!==this.el||c.state.leftRemote.held||n.leftToggledOff||(r=c.options.leftRemote.entity.object3D),c.state.rightRemote.hovered!==this.el||c.state.rightRemote.held||n.rightToggledOff||(l=c.options.rightRemote.entity.object3D),c.state.rightHand.hovered!==this.el||c.state.rightHand.held||(l=c.options.rightHand.entity.object3D),r&&r.matrixWorld.toArray(s),l&&l.matrixWorld.toArray(o),r||l||t){const e=this.el.object3D.matrixWorld.elements[13],t=this.el.object3D.matrixWorld.elements[4],i=this.el.object3D.matrixWorld.elements[5],n=this.el.object3D.matrixWorld.elements[6],a=Math.sqrt(t*t+i*i+n*n)*this.geometryRadius;this.sweepParams[0]=e-a,this.sweepParams[1]=e+a}for(let n=0,a=this.uniforms.length;n<a;n++){const a=this.uniforms[n];a.hubs_EnableSweepingEffect.value=this.data.enableSweepingEffect&&i,a.hubs_IsFrozen.value=t,a.hubs_SweepParams.value=this.sweepParams,a.hubs_HighlightInteractorOne.value=!!r&&i&&!this.isTouchscreen,a.hubs_InteractorOnePos.value[0]=s[12],a.hubs_InteractorOnePos.value[1]=s[13],a.hubs_InteractorOnePos.value[2]=s[14],a.hubs_HighlightInteractorTwo.value=!!l&&i&&!this.isTouchscreen,a.hubs_InteractorTwoPos.value[0]=o[12],a.hubs_InteractorTwoPos.value[1]=o[13],a.hubs_InteractorTwoPos.value[2]=o[14],(r||l||t)&&(a.hubs_Time.value=e)}}}})},,function(e,t,i){"use strict";i.d(t,"b",function(){return r}),i.d(t,"a",function(){return c});var n=i(11);function a(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function s(e){return function(){var t=this,i=arguments;return new Promise(function(n,s){var o=e.apply(t,i);function r(e){a(o,n,s,r,l,"next",e)}function l(e){a(o,n,s,r,l,"throw",e)}r(void 0)})}}function o(){return(o=s(function*(e){return fetch(e).then(function(){var e=s(function*(e){const t=e.body.getReader();let i="";return yield t.read().then(function e({done:n,value:a}){if(i+=String.fromCharCode.apply(null,a.slice(0,4)),!n&&i.length<4)return t.read().then(e);t.cancel()}),i.startsWith("glTF")});return function(t){return e.apply(this,arguments)}}())})).apply(this,arguments)}function r(e){return l.apply(this,arguments)}function l(){return(l=s(function*(e){return""!==e.trim()&&(!!e.startsWith("http")&&(!!(yield Object(n.g)(e))||function(e){return o.apply(this,arguments)}(Object(n.i)(e))))})).apply(this,arguments)}function c(e,t){return t.credentialsAccountId&&e.account_id===t.credentialsAccountId||e.allow_promotion||e.allow_remixing}},function(e,t,i){e.exports=i.p+"assets/waternormals-4418dde3f6abc21dc32506acf5f5b093.jpg"},,function(e,t,i){e.exports={"load-button":"preload-overlay__load-button__ba1d4",loadButton:"preload-overlay__load-button__ba1d4",treatment:"preload-overlay__treatment__1L4r0",screenshot:"preload-overlay__screenshot__3TZYm","hub-name":"preload-overlay__hub-name__2txaT",hubName:"preload-overlay__hub-name__2txaT","main-panel":"preload-overlay__main-panel__2EX4k",mainPanel:"preload-overlay__main-panel__2EX4k",logo:"preload-overlay__logo__1IJJc"}},,function(e,t){},function(e,t){},function(e,t){},function(e,t){},,,,,function(e,t){},function(e,t,i){"use strict";i.d(t,"a",function(){return v});var n=i(48),a=i(167),s=i.n(a),o=i(168),r=i.n(o),l=i(169),c=i.n(l),d=i(170),h=i.n(d),u=i(171),p=i.n(u),m=i(172),g=i.n(m);function f(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function v(){return b.apply(this,arguments)}function b(){var e;return e=function*(){const e=[s.a,r.a,c.a,h.a,p.a,g.a],t=yield new Promise((t,i)=>(new THREE.CubeTextureLoader).load(e,t,void 0,i));return t.format=THREE.RGBFormat,t},(b=function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){f(s,n,a,o,r,"next",e)}function r(e){f(s,n,a,o,r,"throw",e)}o(void 0)})}).apply(this,arguments)}AFRAME.registerComponent("environment-map",{init(){this.environmentMap=null,this.updateEnvironmentMap=this.updateEnvironmentMap.bind(this)},updateEnvironmentMap(e){this.environmentMap=e,this.applyEnvironmentMap(this.el.object3D)},applyEnvironmentMap(e){e.traverse(e=>{Object(n.a)(e,e=>{e.isMeshStandardMaterial&&(e.envMap=this.environmentMap,e.needsUpdate=!0)})})}})},function(e,t){e.exports="if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\n  float ratio = 0.0;\n  float size = hubs_SweepParams.t - hubs_SweepParams.s;\n\n  if (hubs_EnableSweepingEffect) {\n    float line = mod(hubs_Time / 500.0 * size, size * 3.0) + hubs_SweepParams.s - size / 3.0;\n\n    if (hubs_WorldPosition.y < line) {\n      // Highlight with a sweeping gradient.\n      ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\n    }\n  }\n\n  // Highlight with a gradient falling off with distance.\n  float pulse = 1.0 / (size + 0.2) * 8.0 + 1.0 / (size + 0.3) * 3.0 * (sin(hubs_Time / 1000.0) + 1.0);\n\n  if (hubs_HighlightInteractorOne) {\n    float dist1 = distance(hubs_WorldPosition, hubs_InteractorOnePos);\n    ratio += -min(1.0, pow(dist1 * pulse, 3.0)) + 1.0;\n  } \n\n  if (hubs_HighlightInteractorTwo) {\n    float dist2 = distance(hubs_WorldPosition, hubs_InteractorTwoPos);\n    ratio += -min(1.0, pow(dist2 * pulse, 3.0)) + 1.0;\n  }\n\n  ratio = min(1.0, ratio);\n\n  // Gamma corrected highlight color\n  vec3 highlightColor = vec3(0.184, 0.499, 0.933);\n\n  gl_FragColor.rgb = (gl_FragColor.rgb * (1.0 - ratio)) + (highlightColor * ratio);\n}\n"},function(e,t,i){e.exports=i.p+"assets/images/cubemap/posx-d235fb97df77b607be04b84125f40e7c.jpg"},function(e,t,i){e.exports=i.p+"assets/images/cubemap/negx-35034574e114423babdea92b6a2eb97a.jpg"},function(e,t,i){e.exports=i.p+"assets/images/cubemap/posy-d0c4e1e7979d75923d4d8b49c191bc6e.jpg"},function(e,t,i){e.exports=i.p+"assets/images/cubemap/negy-35808d21d1d17ac1b84d3184e365093b.jpg"},function(e,t,i){e.exports=i.p+"assets/images/cubemap/posz-de29aa8396196e4b040cd5305e351dbe.jpg"},function(e,t,i){e.exports=i.p+"assets/images/cubemap/negz-d73d18a8b7994524dc39a6ea3fcf43fc.jpg"},function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i(50),a=i(114);class s{constructor(){this.scene=null,this.quality="low",this.store=new n.b,this.mediaSearchStore=new a.b}setQuality(e){return this.quality!==e&&(this.quality=e,this.scene&&this.scene.dispatchEvent(new CustomEvent("quality-changed",{detail:e})),!0)}}},function(e,t,i){"use strict";var n=i(96),a=i.n(n),s=i(201),o=i.n(s),r=i(0),l=i.n(r),c=i(2),d=i.n(c),h=i(3),u=i(5),p=i.n(u),m=(i(435),i(165)),g=i(81),f=i(12),v=i(42),b=i(89),y=i(260),_=i.n(y);function w(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function E(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){w(s,n,a,o,r,"next",e)}function r(e){w(s,n,a,o,r,"throw",e)}o(void 0)})}}function x(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const S={base_map:["map"],emissive_map:["emissiveMap"],normal_map:["normalMap"],orm_map:["aoMap","roughnessMap","metalnessMap"]},C=Object.keys(S);function k(e,t=!1,i=!0){const n=e.getContext("webgl2",{alpha:t,depth:!0,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"}),a=new THREE.WebGLRenderer({alpha:t,canvas:e,context:n,forceWebVR:!0});return a.gammaOutput=!0,a.gammaFactor=2.2,a.physicallyCorrectLights=!0,i&&a.setPixelRatio(window.devicePixelRatio),a}const A=e=>fetch(e).then(e=>e.blob()).then(b.a),T=new THREE.Euler(-30*THREE.Math.DEG2RAD,30*THREE.Math.DEG2RAD,0),M=1;function L(e,t,i,n=M){const a=Math.max(t.max.y-i.y,i.y-t.min.y),s=THREE.Math.degToRad(e.fov/2);e.position.set(0,0,(a/Math.tan(s)+t.max.z)*n),e.position.applyEuler(T),e.position.add(i),e.lookAt(i)}class R extends r.Component{constructor(e){var t;super(e),t=this,x(this,"componentDidMount",()=>{this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(55,this.canvas.clientWidth/this.canvas.clientHeight,.1,1e3),this.controls=new THREE.OrbitControls(this.camera,this.canvas),this.controls.enablePan=!1;const e=new THREE.DirectionalLight(16250607,1);e.position.set(0,10,10),this.scene.add(e),this.scene.add(new THREE.HemisphereLight(11658239,11658239,2.5)),this.loadId=0,this.camera.position.set(-.2,.5,.5),this.camera.matrixAutoUpdate=!0,this.controls.target.set(0,.45,0),this.controls.update(),this.props.avatarGltfUrl&&this.loadCurrentAvatarGltfUrl();const t=new THREE.Clock;this.snapshotCanvas=document.createElement("canvas"),this.snapshotCanvas.width=720,this.snapshotCanvas.height=1280,this.snapshotCamera=new THREE.PerspectiveCamera(55,.5625,.1,1e3),this.snapshotCamera.matrixAutoUpdate=!0,this.snapshotRenderer=k(this.snapshotCanvas,!0,!1),this.snapshotRenderer.setClearAlpha(0),this.previewRenderer=k(this.canvas),this.previewRenderer.setClearColor(15395562),this.previewRenderer.setAnimationLoop(()=>{const e=t.getDelta();this.mixer&&this.mixer.update(e),this.previewRenderer.render(this.scene,this.camera)}),window.addEventListener("resize",this.resize),this.resize()}),x(this,"resize",()=>{const e=this.canvas.parentElement.offsetWidth,t=this.canvas.parentElement.offsetHeight;this.previewRenderer.setSize(e,t),this.camera.aspect=e/t,this.camera.updateProjectionMatrix()}),x(this,"setAvatar",e=>{e&&(this.avatar=e,this.scene.add(e),this.resetCamera(),this.setState({error:null,loading:!1}))}),x(this,"resetCamera",(()=>{const e=new THREE.Box3,t=new THREE.Vector3;return()=>{e.setFromObject(this.avatar),e.getCenter(t),t.y=.6*(e.max.y-e.min.y)+e.min.y,L(this.camera,e,t),L(this.snapshotCamera,e,t,.7),this.controls.target.copy(t),this.controls.update()}})()),x(this,"componentWillUnmount",()=>{this.scene&&this.scene.traverse(f.f),this.previewRenderer&&(this.previewRenderer.dispose(),this.previewRenderer.context=null),this.snapshotRenderer&&(this.snapshotRenderer.dispose(),this.snapshotRenderer.context=null),this.controls&&(this.controls.dispose(),this.controls.domElement=null),Object.values(this.imageBitmaps).forEach(e=>Object(b.b)(e)),window.removeEventListener("resize",this.resize)}),x(this,"componentDidUpdate",function(){var e=E(function*(e){e.avatarGltfUrl!==t.props.avatarGltfUrl&&(t.avatar&&(t.scene.remove(t.avatar),t.avatar=null),t.props.avatarGltfUrl&&(t.setState({error:null,loading:!0}),yield t.loadCurrentAvatarGltfUrl())),t.applyMaps(e,t.props)});return function(t){return e.apply(this,arguments)}}()),x(this,"loadPreviewAvatar",function(){var e=E(function*(e){let i;try{const n="low"===window.APP.quality?"KHR_materials_unlit":"pbrMetallicRoughness";i=yield Object(g.a)(e,"model/gltf",n,null,v.c)}catch(e){return console.error("Failed to load avatar preview",e),void t.setState({loading:!1,error:!0})}if(t.previewMesh=Object(f.g)(i.scene,e=>e.isMesh&&e.material&&e.material.name===v.b||"Bot_Skinned"===e.name),!t.previewMesh)return console.error("Failed to find avatar preview mesh"),void t.setState({loading:!1,error:!0});const n=i.animations&&i.animations.find(({name:e})=>"idle_eyes"===e);if(n){t.mixer=new THREE.AnimationMixer(i.scene);const e=t.mixer.clipAction(n);e.enabled=!0,e.setLoop(THREE.LoopRepeat,1/0).play(),t.idleAnimationAction=e}const{material:a}=t.previewMesh;if(a){const e=e=>a[e]&&delete a[e].onUpdate&&a[e].image;t.originalMaps={base_map:S.base_map.map(e),emissive_map:S.emissive_map.map(e),normal_map:S.normal_map.map(e),orm_map:S.orm_map.map(e)},yield Promise.all([t.applyMaps({},t.props),Object(m.a)().then(e=>{t.previewMesh.material.envMap=e,t.previewMesh.material.needsUpdate=!0})])}else t.originalMaps={};return i});return function(t){return e.apply(this,arguments)}}()),x(this,"applyMapToPreview",(e,t)=>{this.imageBitmaps[e]&&Object(b.b)(this.imageBitmaps[e]),this.imageBitmaps[e]=t,S[e].forEach(e=>{const i=this.previewMesh.material[e];i.image=t,i.needsUpdate=!0})}),x(this,"revertMap",e=>{this.imageBitmaps[e]&&Object(b.b)(this.imageBitmaps[e]),delete this.imageBitmaps[e],this.originalMaps[e].forEach((t,i)=>{const n=this.previewMesh.material[S[e][i]];n.image=t,n.needsUpdate=!0})}),x(this,"snapshot",()=>new Promise(e=>{this.idleAnimationAction&&this.idleAnimationAction.stop(),this.snapshotRenderer.render(this.scene,this.snapshotCamera),this.snapshotCanvas.toBlob(t=>{this.idleAnimationAction&&this.idleAnimationAction.play(),e(t)})})),this.state={loading:!0,error:null},this.avatar=null,this.imageBitmaps={}}loadCurrentAvatarGltfUrl(){var e=this;return E(function*(){const t=++e.loadId,i=yield e.loadPreviewAvatar(e.props.avatarGltfUrl);t===e.loadId&&(i&&e.props.onGltfLoaded&&e.props.onGltfLoaded(i),e.setAvatar(i.scene))})()}applyMaps(e,t){return Promise.all(C.map(i=>{const n=this.applyMapToPreview.bind(this,i);if(e[i]!=t[i])return t[i]instanceof File?Object(b.a)(t[i]).then(n):t[i]?A(t[i]).then(n):this.revertMap(i)}))}render(){return l.a.createElement("div",{className:p()(_.a.preview,this.props.className)},!this.props.avatarGltfUrl||this.state.loading&&!this.state.error&&l.a.createElement("div",{className:"loader"},l.a.createElement("div",{className:"loader-center"})),this.props.avatarGltfUrl&&this.state.error&&!this.state.loading&&l.a.createElement("div",{className:"error"},l.a.createElement("img",{src:a.a,srcSet:o.a+" 2x",className:"error-icon"}),l.a.createElement(h.a,{id:"avatar-preview.loading-failed"})),l.a.createElement("canvas",{ref:e=>this.canvas=e}))}}x(R,"propTypes",{avatarGltfUrl:d.a.string,className:d.a.string,onGltfLoaded:d.a.func}),t.a=Object(h.d)(R,{withRef:!0})},,,function(e,t,i){e.exports={"action-button":"change-scene-dialog__action-button__1xtdK",actionButton:"change-scene-dialog__action-button__1xtdK",buttons:"change-scene-dialog__buttons__2QE34","spoke-launch":"change-scene-dialog__spoke-launch__YObDn",spokeLaunch:"change-scene-dialog__spoke-launch__YObDn","input-border":"change-scene-dialog__input-border__30jd6",inputBorder:"change-scene-dialog__input-border__30jd6","left-side-of-input":"change-scene-dialog__left-side-of-input__14WKu",leftSideOfInput:"change-scene-dialog__left-side-of-input__14WKu","change-scene-button":"change-scene-dialog__change-scene-button__ckfZW",changeSceneButton:"change-scene-dialog__change-scene-button__ckfZW","spoke-create":"change-scene-dialog__spoke-create__2krL-",spokeCreate:"change-scene-dialog__spoke-create__2krL-"}},function(e,t,i){e.exports={"oauth-discord-button":"oauth-dialog__oauth-discord-button__A_Zra",oauthDiscordButton:"oauth-dialog__oauth-discord-button__A_Zra","oauth-twitter-button":"oauth-dialog__oauth-twitter-button__Vh4oX",oauthTwitterButton:"oauth-dialog__oauth-twitter-button__Vh4oX","oauth-button":"oauth-dialog__oauth-button__25RiO",oauthButton:"oauth-dialog__oauth-button__25RiO","oauth-type-name":"oauth-dialog__oauth-type-name__jPyhW",oauthTypeName:"oauth-dialog__oauth-type-name__jPyhW","oauth-icon":"oauth-dialog__oauth-icon__v1G6W",oauthIcon:"oauth-dialog__oauth-icon__v1G6W","privacy-notice":"oauth-dialog__privacy-notice__2R9ZT",privacyNotice:"oauth-dialog__privacy-notice__2R9ZT","oauth-buttons":"oauth-dialog__oauth-buttons__1U1Ni",oauthButtons:"oauth-dialog__oauth-buttons__1U1Ni","twitter-message":"oauth-dialog__twitter-message__cWCES",twitterMessage:"oauth-dialog__twitter-message__cWCES"}},function(e,t){},function(e,t){},function(e,t){/Oculus/.test(navigator.userAgent)||!navigator.xr||navigator.xr.requestDevice||(navigator.xr.requestDevice=()=>Promise.reject({message:"Hubs: requestDevice not supported."})),/Oculus/.test(navigator.userAgent)&&navigator.getVRDisplays()},,,,,,,,,,,,,,,function(e,t,i){"use strict";i.d(t,"a",function(){return u}),i.d(t,"b",function(){return f});var n=i(88),a=i(14),s=i(200);function o(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function r(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function r(e){o(s,n,a,r,l,"next",e)}function l(e){o(s,n,a,r,l,"throw",e)}r(void 0)})}}const l=.08,c=(e,t)=>{e.getByteTimeDomainData(t);let i=0;for(let e=0;e<t.length;e++){const n=(t[e]-128)/128;i+=n*n}return Math.sqrt(i/t.length)},d=new THREE.Vector3,h=new THREE.Vector3;function u(e,t,i,n,a){h.setFromMatrixPosition(t.matrixWorld),d.setFromMatrixPosition(e.matrixWorld);const s=d.distanceTo(h)/10;return Math.min(n,i+(n-i)*a*8*s)}function p(e){const t=c(e.analyser,e.levels),i=Math.log(THREE.Math.mapLinear(t,0,1,1,Math.E));e.volume=i<l?0:i;const n=e.volume>e.prevVolume?.35:.3;e.volume=n*e.volume+(1-n)*e.prevVolume,e.prevVolume=e.volume}function m(e){const t=Object(n.a)(e,"ik-root");if(t&&"avatar-rig"===t.id)return e.sceneEl.systems["local-audio-analyser"];{const t=Object(n.a)(e,"networked-audio-analyser");return t?t.components["networked-audio-analyser"]:null}}AFRAME.registerComponent("networked-audio-analyser",{init(){var e=this;return r(function*(){e.volume=0,e.prevVolume=0,e.loudest=0,e._updateAnalysis=e._updateAnalysis.bind(e),e._runScheduledWork=e._runScheduledWork.bind(e),e.el.sceneEl.systems["frame-scheduler"].schedule(e._updateAnalysis,"audio-analyser"),e.el.addEventListener("sound-source-set",t=>{const i=THREE.AudioContext.getContext();e.analyser=i.createAnalyser(),e.analyser.fftSize=32,e.levels=new Uint8Array(e.analyser.fftSize),t.detail.soundSource.connect(e.analyser)})})()},remove:function(){this.el.sceneEl.systems["frame-scheduler"].unschedule(this._runScheduledWork,"audio-analyser")},tick:function(e){this.avatarIsQuiet||this._updateAnalysis(e)},_runScheduledWork:function(){this.avatarIsQuiet&&this._updateAnalysis()},_updateAnalysis:function(e){this.analyser&&(p(this),this.volume<1e-5?e&&this.lastSeenVolume&&this.lastSeenVolume<e-1e4&&(this.avatarIsQuiet=!0):(e&&(this.lastSeenVolume=e),this.avatarIsQuiet=!1))}}),AFRAME.registerSystem("local-audio-analyser",{init(){this.volume=0,this.loudest=0,this.prevVolume=0,this.el.addEventListener("local-media-stream-created",e=>{const t=e.detail.mediaStream;this.stream&&console.warn("media stream changed",this.stream,t),this.stream=t;const{analyser:i,levels:n}=function(e){const t=THREE.AudioContext.getContext(),i=t.createMediaStreamSource(e),n=t.createAnalyser();n.fftSize=32;const a=new Uint8Array(n.fftSize);return i.connect(n),{analyser:n,levels:a}}(t);this.analyser=i,this.levels=n})},tick:function(){this.analyser&&p(this)}}),AFRAME.registerComponent("scale-audio-feedback",{schema:{minScale:{default:1},maxScale:{default:1.5}},init(){var e=this;return r(function*(){yield Object(a.a)(),e.camera=document.getElementById("viewing-camera").object3D})()},tick(){if(!this.el.object3D.visible)return;if(!this.camera)return;this.analyser||(this.analyser=m(this.el));const{minScale:e,maxScale:t}=this.data,{object3D:i}=this.el,n=u(this.el.object3D,this.camera,e,t,this.analyser?this.analyser.volume:0);i.scale.setScalar(n),i.matrixNeedsUpdate=!0}}),AFRAME.registerComponent("morph-audio-feedback",{schema:{name:{default:""},minValue:{default:0},maxValue:{default:2}},init(){this.mesh=this.el.object3DMap.skinnedmesh,this.morphNumber=this.mesh.morphTargetDictionary[this.data.name]},tick(){if(!this.mesh)return;this.analyser||(this.analyser=m(this.el));const{minValue:e,maxValue:t}=this.data;this.mesh.morphTargetInfluences[this.morphNumber]=THREE.Math.mapLinear(Object(s.a)(this.analyser?this.analyser.volume:0),0,1,e,t)}});const g={MIC:["mic-0.png","mic-1.png","mic-2.png","mic-3.png","mic-4.png","mic-5.png","mic-6.png","mic-7.png"],MIC_HOVER:["mic-0_hover.png","mic-1_hover.png","mic-2_hover.png","mic-3_hover.png","mic-4_hover.png","mic-5_hover.png","mic-6_hover.png","mic-7_hover.png"],MIC_OFF:["mic-off-0.png","mic-off-1.png","mic-off-2.png","mic-off-3.png","mic-off-4.png","mic-off-5.png","mic-off-6.png","mic-off-7.png"],MIC_OFF_HOVER:["mic-off-0_hover.png","mic-off-1_hover.png","mic-off-2_hover.png","mic-off-3_hover.png","mic-off-4_hover.png","mic-off-5_hover.png","mic-off-6_hover.png","mic-off-7_hover.png"]};function f(e){return THREE.Math.clamp(Math.ceil(THREE.Math.mapLinear(e-.05,0,1,0,7)),0,7)}AFRAME.registerComponent("mic-button",{schema:{active:{type:"boolean"},tooltip:{type:"selector"},tooltipText:{type:"string"},activeTooltipText:{type:"string"}},init(){this.prevSpriteName="",this.el.object3D.matrixNeedsUpdate=!0,this.hovering=!1,this.onHover=()=>{this.hovering=!0,this.data.tooltip.setAttribute("visible",!0)},this.onHoverOut=()=>{this.hovering=!1,this.data.tooltip.setAttribute("visible",!1)}},play(){this.el.object3D.addEventListener("hovered",this.onHover),this.el.object3D.addEventListener("unhovered",this.onHoverOut)},pause(){this.el.object3D.removeEventListener("hovered",this.onHover),this.el.object3D.removeEventListener("unhovered",this.onHoverOut)},update(){this.data.tooltip&&(this.textEl=this.data.tooltip.querySelector("[text]"))},tick(){const e=this.el.sceneEl.systems["local-audio-analyser"],t=this.data.active,i=this.hovering,n=g[t?i?"MIC_OFF_HOVER":"MIC_OFF":i?"MIC_HOVER":"MIC"][f(e.volume)];n!==this.prevSpriteName&&(this.prevSpriteName=n,this.el.setAttribute("sprite","name",n)),this.data.tooltip&&i&&(this.textEl=this.textEl||this.data.tooltip.querySelector("[text]"),this.textEl.setAttribute("text","value",t?this.data.activeTooltipText:this.data.tooltipText))}})},function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i(4);function a(e){return!n.a.feature(e.name)&&e.children||null}},function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i(288),a=i.n(n);function s(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function o(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var o=e.apply(t,i);function r(e){s(o,n,a,r,l,"next",e)}function l(e){s(o,n,a,r,l,"throw",e)}r(void 0)})}}function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class l{constructor(e){var t=this;r(this,"setSocket",e=>{this.socket=e}),r(this,"signOut",function(){var e=o(function*(e){e&&(yield e.signOut()),t.store.update({credentials:{token:null,email:null}}),yield t.store.resetToRandomDefaultAvatar(),t._signedIn=!1});return function(t){return e.apply(this,arguments)}}()),this.store=e,this.socket=null,this._signedIn=!!this.store.state.credentials.token}get email(){return this.store.state.credentials.email}get signedIn(){return this._signedIn}verifyAuthentication(e,t,i){var n=this;const a=this.socket.channel(e);return new Promise((e,s)=>{a.onError(()=>{a.leave(),s()}),a.join().receive("ok",()=>{a.on("auth_credentials",function(){var t=o(function*({credentials:t,payload:i}){yield n.handleAuthCredentials(i.email,t),e()});return function(e){return t.apply(this,arguments)}}()),a.push("auth_verified",{token:t,payload:i})}).receive("error",s)})}startAuthentication(e,t){var i=this;return o(function*(){const n=i.socket.channel(`auth:${a()()}`);yield new Promise((e,t)=>n.join().receive("ok",e).receive("error",t));const s=new Promise(a=>n.on("auth_credentials",function(){var n=o(function*({credentials:n}){yield i.handleAuthCredentials(e,n,t),a()});return function(e){return n.apply(this,arguments)}}()));return n.push("auth_request",{email:e,origin:"hubs"}),{authComplete:s}})()}handleAuthCredentials(e,t,i){var n=this;return o(function*(){n.store.update({credentials:{email:e,token:t}}),i&&(yield i.signIn(t)),n._signedIn=!0})()}}},function(e,t,i){"use strict";function n(e){e.components["animation-mixer"]&&(e.querySelector("[loop-animation]")||e.setAttribute("loop-animation",""))}i.d(t,"a",function(){return n})},function(e,t,i){"use strict";function n(e){return e*(2-e)}i.d(t,"a",function(){return n})},function(e,t,i){e.exports=i.p+"assets/images/warning_icon@2x-706e4a4db33f9456bac320e956b4120d.png"},function(e,t,i){e.exports=i.p+"assets/sfx/quickTurn-cda89edb1a7a32e4442cac70cd2694be.mp3"},function(e,t,i){e.exports=i.p+"assets/sfx/Eb_blip-8d7302990e83d6798400a6027dce3936.mp3"},,,,,,,,,,,,,,,,,,,,function(e,t,i){e.exports=i.p+"assets/images/dropdown_arrow-601450f494125f8caccec2271aebd4cb.png"},function(e,t,i){e.exports=i.p+"assets/images/dropdown_arrow@2x-1023ab0bd743b3525d99986de89f0c3b.png"},,,,,,,,,,,,function(e,t,i){"use strict";var n=i(221),a=i.n(n),s=i(21);const o=new URLSearchParams(location.search),r=Object(s.a)("debug"),l=o.get("log_filter")||r&&"naf-janus-adapter:*";l&&a.a.enable(l)},,,,,,function(e,t,i){"use strict";function n(e){if(!e)return"";const t=e.split("@"),i=t[0],n=t[1];return`${i.substring(0,Math.min(i.length,3))}...@${n}`}i.d(t,"a",function(){return n})},function(e,t,i){"use strict";var n,a,s,o=i(0),r=i.n(o),l=i(2),c=i.n(l),d=i(3),h=i(20),u=i(30),p=i.n(u),m=i(11),g=i(151);function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}class v extends o.Component{render(){const e=!!this.props.hubDescription,t=!!this.props.scene,i=t&&Object(g.a)(this.props.scene,this.props.store),n=(e,t)=>{if(e.url){const i=e.url.includes("sketchfab.com")?"on Sketchfab":e.url.includes("poly.google.com")?"on Google Poly":"";return r.a.createElement("div",{className:p.a.attribution,key:`${e.url} ${t}`},r.a.createElement("div",{className:p.a.attributionName},r.a.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer"},e.name)),r.a.createElement("div",{className:p.a.attributionAuthor},"by ",e.author," ",i))}return r.a.createElement("div",{className:p.a.attribution,key:`${e.name} ${e.author} {i}`},r.a.createElement("div",{className:p.a.attributionName},e.name),r.a.createElement("div",{className:p.a.attributionAuthor},"by ",e.author))};let a=null,s=null;t&&this.props.scene.attributions&&(s=this.props.scene.attributions.creator,a=r.a.createElement("div",null,this.props.scene.attributions.content&&this.props.scene.attributions.content.map(n)));const o=r.a.createElement("div",{className:p.a.title},e&&t?r.a.createElement(d.a,{id:"room-info.title"}):this.props.hubName);return r.a.createElement(h.a,f({title:o,wide:!0},this.props),e&&r.a.createElement(r.a.Fragment,null,t&&r.a.createElement("div",{className:p.a.hubTitle},this.props.hubName),r.a.createElement("div",{className:p.a.description},this.props.hubDescription)),t&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:p.a.subtitle},r.a.createElement(d.a,{id:"room-info.scene-info"})),r.a.createElement("div",{className:p.a.roomInfo},r.a.createElement("div",{className:p.a.sceneScreenshot},i?r.a.createElement("a",{href:this.props.scene.url,target:"_blank",rel:"noopener noreferrer"},r.a.createElement("img",{src:Object(m.j)(this.props.scene.screenshot_url,400,480)})):r.a.createElement("img",{src:Object(m.j)(this.props.scene.screenshot_url,400,480)})),r.a.createElement("div",{className:p.a.sceneDetails},r.a.createElement("div",{className:p.a.sceneMain},r.a.createElement("div",{className:p.a.sceneName},i?r.a.createElement("a",{href:this.props.scene.url,target:"_blank",rel:"noopener noreferrer"},this.props.scene.name):r.a.createElement("span",null,this.props.scene.name)),r.a.createElement("div",{className:p.a.sceneCreator},s)),r.a.createElement("div",{className:p.a.sceneAttributions},a),r.a.createElement("div",{className:p.a.sceneButtons}," ")))))}}n=v,a="propTypes",s={hubName:c.a.string,hubDescription:c.a.string,scene:c.a.object,store:c.a.object},a in n?Object.defineProperty(n,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[a]=s,t.a=Object(d.d)(v)},function(e,t,i){"use strict";var n=i(0),a=i.n(n),s=i(2),o=i.n(s),r=i(5),l=i.n(r),c=i(227),d=i.n(c),h=i(289),u=i.n(h),p=i(3),m=i(7),g=i(290),f=i(218),v=i(291),b=i(100),y=i(292),_=i(175),w=i(116),E=i(219),x=i(220),S=i(128),C=i(19),k=i(10),A=i.n(k),T=i(11),M=i(115),L=i(42),R=i(8);function P(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function D(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){P(s,n,a,o,r,"next",e)}function r(e){P(s,n,a,o,r,"throw",e)}o(void 0)})}}function O(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}d.a.extend(u.a);const H={sketchfab_model:"Sketchfab",poly_model:"Google Poly",twitch_stream:"Twitch"};class j extends n.Component{constructor(...e){var t;super(...e),t=this,O(this,"handleCopyAvatar",function(){var e=D(function*(e,i){e.preventDefault(),yield Object(L.h)(i.id,i.name),t.props.onCopyAvatar()});return function(t,i){return e.apply(this,arguments)}}()),O(this,"handleCopyScene",function(){var e=D(function*(e,i){e.preventDefault(),yield Object(R.d)("/api/v1/scenes","POST",{parent_scene_id:i.id}),t.props.onCopyScene()});return function(t,i){return e.apply(this,arguments)}}()),O(this,"getTileDimensions",(e,t,i)=>{const n=window.innerWidth;let a,s=n<1079?n<768?n<400?85:100:150:200;return t&&(s=Math.floor(1.5*s)),[a=e?Math.floor(Math.max(i*s,.85*s)):t?Math.floor(9/16*s):Math.floor(Math.max(16/9*s,.85*s)),s]}),O(this,"entryToTile",(e,t)=>{const i=e.images.preview.url,n=e.attributions&&e.attributions.creator,s=e.type.endsWith("_image"),o=["avatar","avatar_listing"].includes(e.type),r=["room"].includes(e.type),c=e.images.preview.width/e.images.preview.height,[h,u]=this.getTileDimensions(s,o,c),g="mp4"===e.images.preview.type?a.a.createElement("video",{className:l()(A.a.tileContent,A.a.avatarTile),style:{width:`${h}px`,height:`${u}px`},muted:!0,autoPlay:!0,playsInline:!0,loop:!0,src:Object(T.i)(i)}):a.a.createElement("img",{className:l()(A.a.tileContent,A.a.avatarTile),style:{width:`${h}px`,height:`${u}px`},src:Object(T.j)(i,h,u)}),f=e.attributions&&e.attributions.publisher&&e.attributions.publisher.name||H[e.type],{formatMessage:w}=this.props.intl;return a.a.createElement("div",{style:{width:`${h}px`},className:A.a.tile,key:`${e.id}_${t}`},a.a.createElement("a",{href:e.url,rel:"noreferrer noopener",onClick:t=>this.props.handleEntryClicked&&this.props.handleEntryClicked(t,e),className:A.a.tileLink,style:{width:`${h}px`,height:`${u}px`}},g),a.a.createElement("div",{className:A.a.tileActions},"avatar"===e.type&&a.a.createElement(M.a,{stateKey:"overlay",stateValue:"avatar-editor",stateDetail:{avatarId:e.id},history:this.props.history,title:"Edit"},a.a.createElement(m.a,{icon:b.faPencilAlt})),"avatar_listing"===e.type&&a.a.createElement("a",{onClick:t=>{t.preventDefault(),this.props.onShowSimilar(e.id,e.name)},title:"Show Similar"},a.a.createElement(m.a,{icon:E.faSearch})),"avatar_listing"===e.type&&e.allow_remixing&&a.a.createElement("a",{onClick:t=>this.handleCopyAvatar(t,e),title:"Copy to my avatars"},a.a.createElement(m.a,{icon:_.faClone})),"scene_listing"===e.type&&e.allow_remixing&&a.a.createElement("a",{onClick:t=>this.handleCopyScene(t,e),title:"Copy to my scenes"},a.a.createElement(m.a,{icon:_.faClone})),"scene"===e.type&&e.project_id&&a.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:Object(R.h)(`/spoke/projects/${e.project_id}`),title:w({id:"scene.edit_button"})},a.a.createElement(m.a,{icon:b.faPencilAlt})),"room"===e.type&&this.props.handleEntryInfoClicked&&e.description&&a.a.createElement("a",{title:"room info",onClick:t=>{t.preventDefault(),this.props.handleEntryInfoClicked(e)}},a.a.createElement(m.a,{icon:y.faInfo}))),e.favorited&&a.a.createElement("div",{className:A.a.favorite},a.a.createElement(m.a,{icon:S.faStar})),!e.type.endsWith("_image")&&a.a.createElement("div",{className:A.a.info},a.a.createElement("a",{href:e.url,rel:"noreferrer noopener",className:A.a.name,onClick:t=>this.props.handleEntryClicked&&this.props.handleEntryClicked(t,e)},e.name||""),!o&&!r&&a.a.createElement("div",{className:A.a.attribution},a.a.createElement("div",{className:A.a.creator},n&&void 0===n.name&&a.a.createElement("span",null,n),n&&n.name&&!n.url&&a.a.createElement("span",null,n.name),n&&n.name&&n.url&&a.a.createElement("a",{href:n.url,target:"_blank",rel:"noopener noreferrer"},n.name)),f&&a.a.createElement("div",{className:A.a.publisher},a.a.createElement("i",null,a.a.createElement(m.a,{icon:v.faExternalLinkAlt})),"",a.a.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer"},f))),r&&a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:A.a.attribution},a.a.createElement("div",{className:A.a.lastJoined},a.a.createElement(p.a,{id:"media-browser.hub.joined-prefix"}),d()(e.last_activated_at).fromNow())),a.a.createElement("div",{className:A.a.presence},a.a.createElement(m.a,{icon:x.faUsers}),a.a.createElement("span",null,e.member_count)))))})}render(){const{urlSource:e,hasNext:t,hasPrevious:i,page:n,isVariableWidth:s}=this.props,o=this.props.entries||[],[r,c]=this.getTileDimensions(!1,"avatars"===e);return a.a.createElement("div",{className:A.a.body},a.a.createElement("div",{className:l()({[A.a.tiles]:!0,[A.a.tilesVariable]:s})},("avatars"===e||"scenes"===e)&&a.a.createElement("div",{style:{width:`${r}px`,height:`${c}px`},className:l()({[A.a.tile]:!0,[A.a.createTile]:!0,[A.a.createAvatarTile]:"avatars"===e})},"scenes"===e?a.a.createElement(C.a,{name:"enable_spoke"},a.a.createElement("a",{href:"/spoke/new",rel:"noopener noreferrer",target:"_blank",className:A.a.tileLink},a.a.createElement("div",{className:A.a.tileContent},a.a.createElement(m.a,{icon:w.faPlus}),a.a.createElement(p.a,{id:"media-browser.create-scene"})))):a.a.createElement("a",{onClick:e=>{e.preventDefault(),window.dispatchEvent(new CustomEvent("action_create_avatar"))},className:A.a.tileLink},a.a.createElement("div",{className:A.a.tileContent},a.a.createElement(m.a,{icon:w.faPlus}),a.a.createElement(p.a,{id:"media-browser.create-avatar"})))),o.map(this.entryToTile)),(t||i)&&this.props.handlePager&&a.a.createElement("div",{className:A.a.pager},a.a.createElement("a",{className:l()({[A.a.previousPage]:!0,[A.a.pagerButtonDisabled]:!i}),onClick:()=>this.props.handlePager(-1)},a.a.createElement(m.a,{icon:g.faAngleLeft})),a.a.createElement("div",{className:A.a.pageNumber},n),a.a.createElement("a",{className:l()({[A.a.nextPage]:!0,[A.a.pagerButtonDisabled]:!t}),onClick:()=>this.props.handlePager(1)},a.a.createElement(m.a,{icon:f.faAngleRight}))))}}O(j,"propTypes",{intl:o.a.object,entries:o.a.array,hasNext:o.a.bool,hasPrevious:o.a.bool,isVariableWidth:o.a.bool,page:o.a.number,history:o.a.object,urlSource:o.a.string,handleEntryClicked:o.a.func,handleEntryInfoClicked:o.a.func,handlePager:o.a.func,onCopyAvatar:o.a.func,onCopyScene:o.a.func,onShowSimilar:o.a.func}),t.a=Object(p.d)(j)},function(e,t,i){"use strict";i.d(t,"a",function(){return a});const n=AFRAME.THREE;function a(){if(/Android.+Firefox/.test(navigator.userAgent)){const e=WebGLRenderingContext.prototype.getExtension,t=function(){const e=new n.WebGLRenderer,t=new n.Scene,i=new Float32Array(16),a=new n.DataTexture(i,2,2,n.RGBAFormat,n.FloatType),s=new n.Mesh(new n.PlaneBufferGeometry(1,1),new n.MeshBasicMaterial({map:a}));s.material.map.needsUpdate=!0,t.add(s),e.render(t,new n.Camera);const o=0===e.context.getError();return e.dispose(),o}();WebGLRenderingContext.prototype.getExtension=function(i){return"OES_texture_float"!==i||t?e.call(this,i):null}}}},function(e,t,i){e.exports=i.p+"assets/models/LoadingObject_Atom-7dcc3b81897e68b740c1cf12b6cf4c3f.glb"},function(e,t,i){e.exports=i.p+"assets/sfx/teleport-loop-84e2caa4f62e5c6d6ce339b0c715c06d.mp3"},function(e,t,i){e.exports=i.p+"assets/sfx/tap_mellow-673398d6e97818ec4b675708d460bd0f.mp3"},function(e,t,i){e.exports=i.p+"assets/sfx/PenSpawn-aac1f534773040f0fafa41e9db76017b.mp3"},function(e,t,i){e.exports=i.p+"assets/sfx/PenDraw1-ddbdc17a6beefecbca2685c8c9d0d2d5.mp3"},function(e,t,i){e.exports=i.p+"assets/sfx/PicSnapHey-0228ddd197e5a6d88f7bcd2ceb340f8e.mp3"},function(e,t,i){e.exports=i.p+"assets/sfx/welcome-0083300978d5dd05eaa376f65761da47.mp3"},function(e,t,i){e.exports=i.p+"assets/sfx/quack-1f18502834f8f1db43990b769c2ab193.mp3"},function(e,t,i){e.exports=i.p+"assets/sfx/specialquack-6d1a192a6092e8dfed5d3de063755ee2.mp3"},function(e,t,i){e.exports=i.p+"assets/sfx/pop-5784f3bcfaf98637147737448d6df8df.mp3"},function(e,t,i){e.exports=i.p+"assets/sfx/tack-0d55b064794faaa1733fcf6bc89cad0c.mp3"},function(e,t,i){e.exports=i.p+"assets/sfx/A_bendUp-de32e556413bb2a527fb514984738c70.mp3"},function(e,t,i){e.exports=i.p+"assets/sfx/suspense-f27c64840e5ede36ec694c22a030615c.mp3"},function(e,t,i){e.exports=i.p+"assets/sfx/emoji-27673179a22e6f42e8187ccba07e4dce.mp3"},function(e,t,i){e.exports={preview:"avatar-preview__preview__2I8qx"}},function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i(47);class a{constructor(){this.entities=[]}register(e){this.entities.push(e)}unregister(e){this.entities.splice(this.entities.indexOf(e,1))}tick(){for(const e of this.entities){const t=AFRAME.scenes[0].systems["hubs-systems"];!e||t&&t.cameraSystem.mode===n.c||e.components["scene-preview-camera"].tick2()}}}},function(e,t,i){"use strict";function n(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function a(e){return function(){var t=this,i=arguments;return new Promise(function(a,s){var o=e.apply(t,i);function r(e){n(o,a,s,r,l,"next",e)}function l(e){n(o,a,s,r,l,"throw",e)}r(void 0)})}}function s(e,t){return o.apply(this,arguments)}function o(){return(o=a(function*(e,t){return crypto.subtle.deriveKey({name:"ECDH",public:t},e,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"])})).apply(this,arguments)}function r(e){return l.apply(this,arguments)}function l(){return(l=a(function*(e){return JSON.stringify(yield crypto.subtle.exportKey("jwk",e))})).apply(this,arguments)}function c(e){return d.apply(this,arguments)}function d(){return(d=a(function*(e){return yield crypto.subtle.importKey("jwk",JSON.parse(e),{name:"ECDH",namedCurve:"P-256"},!0,[])})).apply(this,arguments)}function h(e){const t=new Uint8Array(e.length);for(let i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}function u(e){const t=new Uint8Array(e);let i="";for(let e=0;e<t.byteLength;e++)i+=String.fromCharCode(t[e]);return i}function p(){return(p=a(function*(){const e=yield crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]);return{publicKeyString:yield r(e.publicKey),privateKey:e.privateKey}})).apply(this,arguments)}function m(){return(m=a(function*(e,t){const i=new Uint8Array(16),n=yield c(e),a=yield crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]),o=yield r(a.publicKey),l=yield s(a.privateKey,n);return{publicKeyString:o,encryptedData:btoa(u(yield crypto.subtle.encrypt({name:"AES-CBC",iv:i},l,h(JSON.stringify(t)))))}})).apply(this,arguments)}function g(){return(g=a(function*(e,t,i){const n=new Uint8Array(16),a=yield c(e),o=yield s(t,a),r=h(atob(i)),l=yield crypto.subtle.decrypt({name:"AES-CBC",iv:n},o,r);return JSON.parse(u(l))})).apply(this,arguments)}function f(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),n.forEach(function(t){v(e,t,i[t])})}return e}function v(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.d(t,"a",function(){return y});const b=1e4;class y{constructor(e){v(this,"setSocket",e=>{this.socket=e}),v(this,"generateCode",()=>new Promise(e=>{const t=new Promise(i=>{const n=()=>{const a=()=>"ABCDEFGHI"[Math.floor(9*Math.random())],s=`${a()}${a()}${a()}${a()}`;let o=!1,r=!1;const l=this.socket.channel(`link:${s}`,{timeout:b}),c=()=>{r||l.leave(),r=!0},d=()=>c();l.on("link_expired",()=>i("expired")),l.on("presence_state",i=>{o||(Object.keys(i).length>0?n():(o=!0,e({code:s,cancel:d,onFinished:t})))}),l.on("link_request",e=>{if(o){const t={path:location.pathname};this.store.state.activity.hasChangedName&&(t.profile=f({},this.store.state.profile)),t.credentials=f({},this.store.state.credentials),function(e,t){return m.apply(this,arguments)}(e.public_key,t).then(({publicKeyString:t,encryptedData:n})=>{const a={target_session_id:e.reply_to_session_id,public_key:t,data:n};r||l.push("link_response",a),c(),i("used"),o=!1})}}),l.join().receive("error",e=>console.error(e))};n()})})),v(this,"attemptLink",e=>new Promise((t,i)=>{const n=this.socket.channel(`link:${e}`,{timeout:b});let a=!1;(function(){return p.apply(this,arguments)})().then(({publicKeyString:e,privateKey:s})=>{n.on("presence_state",t=>{const s=Object.keys(t).length;1===s?(n.push("link_request",{reply_to_session_id:this.socket.params().session_id,public_key:e}),setTimeout(()=>{a||(n.leave(),i(new Error("no_response")))},b)):0===s?(n.leave(),i(new Error("failed"))):(console.warn("link code channel already has 2 or more occupants, something fishy is going on."),n.leave(),i(new Error("in_use")))}),n.on("link_response",e=>{a=!0,n.leave(),function(e,t,i){return g.apply(this,arguments)}(e.public_key,s,e.data).then(t)}),n.join().receive("ok",e=>this.socket.params().session_id=e.session_id).receive("error",e=>console.error(e))})})),this.store=e}}},,,function(e,t,i){e.exports={"command-help":"chat-command-help__command-help__q0Wb8",commandHelp:"chat-command-help__command-help__q0Wb8",entry:"chat-command-help__entry__1E1un",command:"chat-command-help__command__2GMyn"}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){e.exports=i.p+"assets/images/mic_denied-5ce12e4dc9b5eb42ce69b753c46c2174.png"},function(e,t,i){e.exports=i.p+"assets/images/mic_denied@2x-127a94ff73b93a0b4ac89682ce836b91.png"},function(e,t){e.exports='<svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" class="svg-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M61.0316 33.4196C61.841 33.0737 61.841 31.9263 61.0316 31.5804L5.78581 7.97542C4.46632 7.41163 2.99999 8.37968 2.99999 9.81457L2.99999 30.4511L29.262 32.5L2.99999 34.549L2.99998 55.1854C2.99998 56.6203 4.46632 57.5884 5.7858 57.0246L61.0316 33.4196Z" fill="currentColor"></path></svg>'},,,,,function(e,t,i){e.exports=i.p+"assets/models/LoadingEnvironment-570a9f69a9509eb8a039c9ff93ccfdca.glb"},function(e,t,i){e.exports={"cancel-button":"promote-client-dialog__cancel-button__3YZLa",cancelButton:"promote-client-dialog__cancel-button__3YZLa","confirm-button":"promote-client-dialog__confirm-button__3LXvQ",confirmButton:"promote-client-dialog__confirm-button__3LXvQ",message:"promote-client-dialog__message__1LA_N"}},function(e,t,i){e.exports={"cancel-button":"close-room-dialog__cancel-button__MmtAo",cancelButton:"close-room-dialog__cancel-button__MmtAo","confirm-button":"close-room-dialog__confirm-button__Bs9y3",confirmButton:"close-room-dialog__confirm-button__Bs9y3",message:"close-room-dialog__message__1Rvh3"}},function(e,t,i){e.exports={"help-dialog":"help-dialog__help-dialog__3kPVz",helpDialog:"help-dialog__help-dialog__3kPVz","docs-link":"help-dialog__docs-link__1kBbO",docsLink:"help-dialog__docs-link__1kBbO","tour-button":"help-dialog__tour-button__2kJpg",tourButton:"help-dialog__tour-button__2kJpg","link-button":"help-dialog__link-button__18Iw0",linkButton:"help-dialog__link-button__18Iw0"}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){const i=new THREE.Vector3(0,0,0),n=new THREE.Quaternion,a=new THREE.Vector3(1,1,1),s=new THREE.Matrix4;s.identity();const o=THREE.PropertyBinding.prototype.SetterByBindingTypeAndVersioning,r=THREE.PropertyBinding.prototype.Versioning;for(let e=0;e<o.length;e++){const t=o[e][r.MatrixWorldNeedsUpdate];t&&(o[e][r.MatrixWorldNeedsUpdate]=function(){const e=t.apply(this,arguments);return this.targetObject.matrixNeedsUpdate=!0,e})}THREE.Object3D.prototype.getWorldPosition=function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new THREE.Vector3),this.updateMatrices(),e.setFromMatrixPosition(this.matrixWorld)},THREE.Object3D.prototype.getWorldQuaternion=function(){const e=new THREE.Vector3,t=new THREE.Vector3;return function(i){return void 0===i&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),i=new THREE.Quaternion),this.updateMatrices(),this.matrixWorld.decompose(e,i,t),i}}(),THREE.Object3D.getWorldScale=function(){const e=new THREE.Vector3,t=new THREE.Quaternion;return function(i){return void 0===i&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),i=new THREE.Vector3),this.updateMatrices(),this.matrixWorld.decompose(e,t,i),i}}();const l=e=>{e.matrixIsModified||(e.matrixIsModified=!0,e.cachedMatrixWorld&&(e.cachedMatrixWorld.copy(e.matrixWorld),e.matrixWorld=e.cachedMatrixWorld))},c=THREE.Object3D.prototype.updateMatrix;THREE.Object3D.prototype.updateMatrix=function(){c.apply(this,arguments),l(this)};const d=THREE.Object3D.prototype.applyMatrix;THREE.Object3D.prototype.applyMatrix=function(){d.apply(this,arguments),l(this)},THREE.Object3D.prototype.updateMatrices=function(e,t,o){this.hasHadFirstMatrixUpdate?(this.matrixNeedsUpdate||this.matrixAutoUpdate||e)&&(this.updateMatrix(),this.matrixNeedsUpdate&&(this.matrixNeedsUpdate=!1)):(this.position.equals(i)&&this.quaternion.equals(n)&&this.scale.equals(a)&&this.matrix.equals(s)||this.updateMatrix(),this.hasHadFirstMatrixUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.cachedMatrixWorld=this.matrixWorld),!o&&this.parent&&(this.parent.updateMatrices(!1,t,!1),this.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate||this.parent.childrenNeedMatrixWorldUpdate),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixIsModified?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld=this.parent.matrixWorld,this.childrenNeedMatrixWorldUpdate=!0,this.matrixWorldNeedsUpdate=!1)},THREE.Object3D.prototype.updateMatrixWorld=function(e,t){if(!this.visible&&!t)return;this.updateMatrices(!1,e,!0);const i=this.children,n=this.childrenNeedMatrixWorldUpdate||e;for(let e=0,a=i.length;e<a;e++)i[e].updateMatrixWorld(n,t);this.childrenNeedMatrixWorldUpdate&&(this.childrenNeedMatrixWorldUpdate=!1)},THREE.Object3D.prototype.lookAt=function(){const e=new THREE.Quaternion,t=new THREE.Matrix4,i=new THREE.Vector3,n=new THREE.Vector3;return function(a,s,o){a.isVector3?i.copy(a):i.set(a,s,o);const r=this.parent;r&&r.updateMatrices(),this.updateMatrices(),n.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?t.lookAt(n,i,this.up):t.lookAt(i,n,this.up),this.quaternion.setFromRotationMatrix(t),r&&(t.extractRotation(r.matrixWorld),e.setFromRotationMatrix(t),this.quaternion.premultiply(e.inverse())),this.matrixNeedsUpdate=!0}}()},function(e,t,i){var n=i(124).default,a=AFRAME.components,s=AFRAME.registerComponent,o=AFRAME.utils;delete AFRAME.components.animation;var r=new THREE.Color,l=new THREE.Color,c=o.entity.getComponentProperty,d=o.entity.setComponentProperty,h={},u="color",p="components",m="object3D";function g(e){e.x=THREE.Math.degToRad(e.x),e.y=THREE.Math.degToRad(e.y),e.z=THREE.Math.degToRad(e.z)}function f(e,t,i){var n;for(n=0;n<t.length;n++)e.addEventListener(t[n],i)}function v(e,t,i){var n;for(n=0;n<t.length;n++)e.removeEventListener(t[n],i)}function b(e,t){var i,n,a;for(n=_(t),a=e,i=0;i<n.length;i++)a=a[n[i]];return a}function y(e,t,i,n){var a,s,o,r;for(t.startsWith("object3D.rotation")&&(i=THREE.Math.degToRad(i)),s=_(t),r=e,a=0;a<s.length-1;a++)r=r[s[a]];o=s[s.length-1],n!==u?r[o]=i:"r"in r[o]?(r[o].r=i.r,r[o].g=i.g,r[o].b=i.b):(r[o].x=i.r,r[o].y=i.g,r[o].z=i.b)}function _(e){return e in h?h[e]:(h[e]=e.split("."),h[e])}function w(e){return e.isRawProperty||e.property.startsWith(p)||e.property.startsWith(m)}e.exports.Component=s("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(e){return!0===e||"true"===e||!1!==e&&"false"!==e&&parseInt(e,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){var e=this;this.eventDetail={name:this.attrName},this.time=0,this.animation=null,this.animationIsPlaying=!1,this.onStartEvent=this.onStartEvent.bind(this),this.beginAnimation=this.beginAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.resumeAnimation=this.resumeAnimation.bind(this),this.fromColor={},this.toColor={},this.targets={},this.targetsArray=[],this.updateConfigForDefault=this.updateConfigForDefault.bind(this),this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this),this.config={complete:function(){e.animationIsPlaying=!1,e.el.emit("animationcomplete",e.eventDetail,!1),e.id&&e.el.emit("animationcomplete__"+e.id,e.eventDetail,!1)}}},update:function(e){var t=this.config,i=this.data;this.animationIsPlaying=!1,this.data.enabled&&i.property&&(t.autoplay=!1,t.direction=i.dir,t.duration=i.dur,t.easing=i.easing,t.elasticity=i.elasticity,t.loop=i.loop,t.round=i.round,this.createAndStartAnimation())},tick:function(e,t){this.animationIsPlaying&&(this.time+=t,this.animation.tick(this.time))},remove:function(){this.pauseAnimation(),this.removeEventListeners(),this.cancelDelayedStart()},pause:function(){this.paused=!0,this.pausedWasPlaying=this.animationIsPlaying,this.pauseAnimation(),this.removeEventListeners(),this.cancelDelayedStart()},play:function(){this.paused&&(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){var e=this.data;this.updateConfig(),this.animationIsPlaying=!1,this.animation=n(this.config),this.removeEventListeners(),this.cancelDelayedStart(),this.addEventListeners(),!e.autoplay||e.startEvents&&e.startEvents.length||(e.delay?this.delayTimeout=setTimeout(this.beginAnimation,e.delay):this.beginAnimation())},beginAnimation:function(){this.updateConfig(),this.time=0,this.animationIsPlaying=!0,this.stopRelatedAnimations(),this.el.emit("animationbegin",this.eventDetail,!1)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=!0},onStartEvent:function(){this.data.enabled&&(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=n(this.config),this.data.delay?setTimeout(this.beginAnimation,this.data.delay):this.beginAnimation())},updateConfigForRawColor:function(){var e,t,i,n=this.config,a=this.data,s=this.el;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){for(t in e=""===a.from?b(s,a.property):a.from,i=a.to,this.setColorConfig(e,i),e=this.fromColor,i=this.toColor,this.targetsArray.length=0,this.targetsArray.push(e),n.targets=this.targetsArray,i)n[t]=i[t];var o;n.update=(o={},function(e){var t;(t=e.animatables[0].target).r===o.r&&t.g===o.g&&t.b===o.b||y(s,a.property,t,a.type)})}},updateConfigForDefault:function(){var e,t,i,n,a=this.config,s=this.data,o=this.el;this.waitComponentInitRawProperty(this.updateConfigForDefault)||(e=""===s.from?w(s)?b(o,s.property):c(o,s.property):s.from,i=s.to,!isNaN(e||i)?(e=parseFloat(e),i=parseFloat(i)):(e=e?e.toString():e,i=i?i.toString():i),(t="true"===s.to||"false"===s.to||!0===s.to||!1===s.to)&&(e="true"===s.from||!0===s.from?1:0,i="true"===s.to||!0===s.to?1:0),this.targets.aframeProperty=e,a.targets=this.targets,a.aframeProperty=i,a.update=function(e){var i;(i=e.animatables[0].target.aframeProperty)!==n&&(n=i,t&&(i=i>=1),w(s)?y(o,s.property,i,s.type):d(o,s.property,i))})},updateConfigForVector:function(){var e,t,i,n,a=this.config,s=this.data,r=this.el;for(e in t=""!==s.from?o.coordinates.parse(s.from):c(r,s.property),i=o.coordinates.parse(s.to),"rotation"===s.property&&(g(t),g(i)),this.targetsArray.length=0,this.targetsArray.push(t),a.targets=this.targetsArray,i)a[e]=i[e];"position"!==s.property&&"rotation"!==s.property&&"scale"!==s.property?a.update=function(){var e={};return function(t){var i=t.animations[0].target;i.x===e.x&&i.y===e.y&&i.z===e.z||(e.x=i.x,e.y=i.y,e.z=i.z,d(r,s.property,i))}}():a.update=(n={},function(e){var t=e.animatables[0].target;"scale"===s.property&&(t.x=Math.max(1e-4,t.x),t.y=Math.max(1e-4,t.y),t.z=Math.max(1e-4,t.z)),t.x===n.x&&t.y===n.y&&t.z===n.z||(n.x=t.x,n.y=t.y,n.z=t.z,r.object3D[s.property].set(t.x,t.y,t.z),r.object3D.matrixNeedsUpdate=!0)})},updateConfig:function(){var e;e=function(e,t){var i,n,s,o;if(s=t.split("."),n=s[0],o=s[1],!(i=e.components[n]||a[n]))return null;if(o&&!i.schema[o])return null;if(o)return i.schema[o].type;return i.schema.type}(this.el,this.data.property),w(this.data)&&this.data.type===u?this.updateConfigForRawColor():"vec2"===e||"vec3"===e||"vec4"===e?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(e){var t,i=this.data,a=this.el,s=this;return""===i.from&&(!!i.property.startsWith(p)&&(t=_(i.property)[1],!a.components[t]&&(a.addEventListener("componentinitialized",function i(o){o.detail.name===t&&(e(),s.animation=n(s.config),a.removeEventListener("componentinitialized",i))}),!0)))},stopRelatedAnimations:function(){var e,t;for(t in this.el.components)e=this.el.components[t],t!==this.attrName&&"animation"===e.name&&e.animationIsPlaying&&e.data.property===this.data.property&&(e.animationIsPlaying=!1)},addEventListeners:function(){var e=this.data,t=this.el;f(t,e.startEvents,this.onStartEvent),f(t,e.pauseEvents,this.pauseAnimation),f(t,e.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var e=this.data,t=this.el;v(t,e.startEvents,this.onStartEvent),v(t,e.pauseEvents,this.pauseAnimation),v(t,e.resumeEvents,this.resumeAnimation)},cancelDelayedStart:function(){this.delayTimeout&&(clearTimeout(this.delayTimeout),this.delayTimeout=null)},setColorConfig:function(e,t){r.set(e),l.set(t),e=this.fromColor,t=this.toColor,e.r=r.r,e.g=r.g,e.b=r.b,t.r=l.r,t.g=l.g,t.b=l.b}})},function(e,t){AFRAME.registerComponent("ambient-light",{schema:{color:{type:"color"},intensity:{default:1}},init(){const e=this.el;this.light=new THREE.AmbientLight,this.el.setObject3D("ambient-light",this.light),this.el.sceneEl.systems.light.registerLight(e),this.rendererSystem=this.el.sceneEl.systems.renderer},update(e){this.data.color!==e.color&&(this.light.color.set(this.data.color),this.rendererSystem.applyColorCorrection(this.light.color)),this.data.intensity!==e.intensity&&(this.light.intensity=this.data.intensity)},remove:function(){this.el.removeObject3D("ambient-light")}})},function(e,t){AFRAME.registerComponent("animation-mixer",{initMixer(e){this.mixer=new THREE.AnimationMixer(this.el.object3D),this.el.object3D.animations=e,this.animations=e},tick:function(e,t){this.mixer&&this.mixer.update(t/1e3)}})},function(e,t){AFRAME.registerComponent("css-class",{schema:{type:"string"},multiple:!0,init(){this.el.classList.add(this.data)},update(e){this.data!==e&&(this.el.classList.remove(e),this.el.classList.add(this.data))},remove(){this.el.classList.remove(this.data)}})},function(e,t){AFRAME.registerComponent("duck",{schema:{initialForce:{default:0},maxForce:{default:6.5},maxScale:{default:5}},init:function(){this.physicsSystem=this.el.sceneEl.systems.physics,this.hasBody=!1,this.position=new CANNON.Vec3,this.force=new CANNON.Vec3(0,this.data.initialForce,0),this.initialScale=this.el.object3D.scale.x,this.maxScale=this.data.maxScale*this.initialScale},play:function(){this.physicsSystem.addComponent(this)},pause:function(){this.physicsSystem.removeComponent(this)},beforeStep:function(){if(this.el.body&&NAF.utils.isMine(this.el)){const e=this.el.object3D.scale.x,t=Math.min(1,(e-this.initialScale)/(this.maxScale-this.initialScale))*this.data.maxForce;if(t>0){const e=Math.random()*Math.PI*2,i=Math.cos(e),n=Math.sin(e);this.force.set(i,t,n),this.position.set(.01*i,0,.01*n),this.el.object3D.matrixNeedsUpdate=!0,this.el.body.applyForce(this.force,this.position)}}}})},,function(e,t){AFRAME.registerComponent("heightfield",{init(){this.el.addEventListener("componentinitialized",e=>{"static-body"===e.detail.name&&this.generateAndAddHeightfield(this.el.components["static-body"])}),this.el.setAttribute("static-body",{shape:"none",mass:0})},generateAndAddHeightfield(e){const{offset:t,distance:i,data:n}=this.data,a=new CANNON.Quaternion;a.setFromAxisAngle(new CANNON.Vec3(1,0,0),-Math.PI/2);const s=new CANNON.Quaternion;s.setFromAxisAngle(new CANNON.Vec3(0,1,0),-Math.PI/2),s.mult(a,a);const o=new CANNON.Vec3(t.x,t.y,t.z),r=new CANNON.Heightfield(n,{elementSize:i});e.addShape(r,o,a)}})},function(e,t){AFRAME.registerComponent("hemisphere-light",{schema:{skyColor:{type:"color"},groundColor:{type:"color"},intensity:{default:1}},init(){const e=this.el;this.light=new THREE.HemisphereLight,this.light.position.set(0,0,0),this.light.matrixNeedsUpdate=!0,this.el.setObject3D("hemisphere-light",this.light),this.el.sceneEl.systems.light.registerLight(e)},update(e){this.data.skyColor!==e.skyColor&&this.light.color.set(this.data.skyColor),this.data.groundColor!==e.groundColor&&this.light.groundColor.set(this.data.groundColor),this.data.intensity!==e.intensity&&(this.light.intensity=this.data.intensity)},remove:function(){this.el.removeObject3D("hemisphere-light")}})},function(e,t){AFRAME.registerComponent("hide-when-quality",{schema:{type:"string",default:"low"},init(){this.onQualityChanged=this.onQualityChanged.bind(this),this.el.sceneEl.addEventListener("quality-changed",this.onQualityChanged)},onQualityChanged(e){this.updateComponentState(e.detail)},update(e){this.data!==e&&this.updateComponentState(window.APP.quality)},updateComponentState(e){this.el.setAttribute("visible",e!==this.data)}})},function(e,t){AFRAME.registerComponent("point-light",{schema:{color:{type:"color"},intensity:{default:1},range:{default:0},decay:{default:2},castShadow:{default:!0},shadowMapResolution:{default:[512,512]},shadowBias:{default:0},shadowRadius:{default:1}},init(){const e=this.el;this.light=new THREE.PointLight,this.light.shadow.camera.matrixAutoUpdate=!0,this.el.setObject3D("point-light",this.light),this.el.sceneEl.systems.light.registerLight(e),this.rendererSystem=this.el.sceneEl.systems.renderer},update(e){const t=this.light;if(this.data.color!==e.color){const e=new THREE.Color(this.data.color);this.rendererSystem.applyColorCorrection(e),t.color.copy(e)}this.data.intensity!==e.intensity&&(t.intensity=this.data.intensity),this.data.range!==e.range&&(t.distance=this.data.range),this.data.decay!==e.decay&&(t.decay=this.data.decay),this.data.castShadow!==e.castShadow&&(t.castShadow=this.data.castShadow),this.data.shadowBias!==e.shadowBias&&(t.shadow.bias=this.data.shadowBias),this.data.shadowRadius!==e.shadowRadius&&(t.shadow.radius=this.data.shadowRadius);const[i,n]=this.data.shadowMapResolution,[a,s]=e.shadowMapResolution?e.shadowMapResolution:[512,512];i===a&&n===s||(t.shadow.mapSize.set(i,n),t.shadow.map&&(t.shadow.map.dispose(),t.shadow.map=null))},remove:function(){this.el.removeObject3D("point-light")}})},function(e,t){AFRAME.registerComponent("spot-light",{schema:{color:{type:"color"},intensity:{default:1},range:{default:0},decay:{default:2},innerConeAngle:{default:0},outerConeAngle:{default:Math.PI/4},castShadow:{default:!0},shadowMapResolution:{default:[512,512]},shadowBias:{default:0},shadowRadius:{default:1}},init(){const e=this.el;this.light=new THREE.SpotLight,this.light.position.set(0,0,0),this.light.target.position.set(0,0,1),this.light.add(this.light.target),this.light.matrixNeedsUpdate=!0,this.light.target.matrixNeedsUpdate=!0,this.el.setObject3D("spot-light",this.light),this.el.sceneEl.systems.light.registerLight(e)},update(e){const t=this.light;this.data.color!==e.color&&t.color.set(this.data.color),this.data.intensity!==e.intensity&&(t.intensity=this.data.intensity),this.data.range!==e.range&&(t.distance=this.data.range),this.data.decay!==e.decay&&(t.decay=this.data.decay),this.data.innerConeAngle===e.innerConeAngle&&this.data.outerConeAngle===e.outerConeAngle||(t.angle=this.data.outerConeAngle,t.penumbra=1-this.data.innerConeAngle/this.data.outerConeAngle),this.data.castShadow!==e.castShadow&&(t.castShadow=this.data.castShadow),this.data.shadowBias!==e.shadowBias&&(t.shadow.bias=this.data.shadowBias),this.data.shadowRadius!==e.shadowRadius&&(t.shadow.radius=this.data.shadowRadius);const[i,n]=this.data.shadowMapResolution,[a,s]=e.shadowMapResolution?e.shadowMapResolution:[512,512];i===a&&n===s||(t.shadow.mapSize.set(i,n),t.shadow.map&&(t.shadow.map.dispose(),t.shadow.map=null))},remove:function(){this.el.removeObject3D("spot-light")}})},function(e,t,i){const n=i(111).COLLISION_LAYERS;AFRAME.registerComponent("floaty-object",{schema:{autoLockOnLoad:{default:!1},autoLockOnRelease:{default:!1},modifyGravityOnRelease:{default:!1},releaseGravity:{default:-2},reduceAngularFloat:{default:!1},gravitySpeedLimit:{default:1.85}},init(){this.onGrab=this.onGrab.bind(this),this.onRelease=this.onRelease.bind(this)},tick(){this.bodyHelper||(this.bodyHelper=this.el.components["body-helper"]);const e=AFRAME.scenes[0].systems.interaction,t=e&&e.isHeld(this.el);if(t&&!this.wasHeld&&this.onGrab(),this.wasHeld&&!t&&this.onRelease(),!t&&this._makeStaticWhenAtRest){const e=this.el.components.networked&&NAF.utils.isMine(this.el),t=this.bodyHelper.data.linearSleepingThreshold,i=this.bodyHelper.data.angularSleepingThreshold,n=this.bodyHelper.body&&this.bodyHelper.body.physicsBody.getLinearVelocity().length2()<t*t&&this.bodyHelper.body.physicsBody.getAngularVelocity().length2()<i*i;n&&e&&this.el.setAttribute("body-helper",{type:"kinematic"}),!n&&e||(this._makeStaticWhenAtRest=!1)}this.wasHeld=t},play(){this.hasBeenHereBefore||(this.hasBeenHereBefore=!0,this.data.autoLockOnLoad&&(this.el.setAttribute("body-helper",{gravity:{x:0,y:0,z:0}}),this.setLocked(!0)))},setLocked(e){this.el.components.networked&&!NAF.utils.isMine(this.el)||(this.locked=e,this.el.setAttribute("body-helper",{type:e?"kinematic":"dynamic"}))},onRelease(){this.data.modifyGravityOnRelease?0===this.data.gravitySpeedLimit||this.bodyHelper.body&&this.bodyHelper.body.getVelocity().length2()<this.data.gravitySpeedLimit*this.data.gravitySpeedLimit?(this.el.setAttribute("body-helper",{gravity:{x:0,y:0,z:0},angularDamping:this.data.reduceAngularFloat?.98:.5,linearDamping:.95,linearSleepingThreshold:.1,angularSleepingThreshold:.1,collisionFilterMask:n.HANDS}),this._makeStaticWhenAtRest=!0):this.el.setAttribute("body-helper",{gravity:{x:0,y:this.data.releaseGravity,z:0},angularDamping:.01,linearDamping:.01,linearSleepingThreshold:1.6,angularSleepingThreshold:2.5,collisionFilterMask:n.DEFAULT_INTERACTABLE}):this.el.setAttribute("body-helper",{collisionFilterMask:n.DEFAULT_INTERACTABLE,gravity:{x:0,y:-9.8,z:0}}),this.data.autoLockOnRelease&&this.setLocked(!0)},onGrab(){this.el.setAttribute("body-helper",{gravity:{x:0,y:0,z:0},collisionFilterMask:n.HANDS}),this.setLocked(!1)},remove(){if(this.stuckTo){const e=this.stuckTo;delete this.stuckTo,e._unstickObject()}}})},function(e,t){const i=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3;AFRAME.registerComponent("trigger-volume",{schema:{colliders:{type:"selectorAll"},size:{type:"vec3",default:{x:1,y:1,z:1}},target:{type:"selector"},enterComponent:{type:"string"},enterProperty:{type:"string"},enterValue:{default:"",parse:e=>"object"==typeof e?e:JSON.parse(e),stringify:JSON.stringify},leaveComponent:{type:"string"},leaveProperty:{type:"string"},leaveValue:{default:"",parse:e=>"object"==typeof e?e:JSON.parse(e),stringify:JSON.stringify}},init(){this.boundingBox=new THREE.Box3,this.collidingLastFrame={}},update(){this.el.object3D.getWorldPosition(n),i.copy(this.data.size),this.boundingBox.setFromCenterAndSize(n,i)},tick(){if(!this.data.target)return;const e=this.data.colliders;for(let t=0;t<e.length;t++){const i=e[t].object3D;i.getWorldPosition(a);const n=this.boundingBox.containsPoint(a),s=this.collidingLastFrame[i.id];n&&!s?this.data.target.setAttribute(this.data.enterComponent,this.data.enterProperty,this.data.enterValue):!n&&s&&this.data.target.setAttribute(this.data.leaveComponent,this.data.leaveProperty,this.data.leaveValue),this.collidingLastFrame[i.id]=n}}})},function(e,t){AFRAME.registerComponent("video-pause-state",{schema:{paused:{default:!1}},init(){this.onPauseStateChange=this.onPauseStateChange.bind(this),this.videoComponent=this.el.components["media-video"],this.videoComponent?this.onVideoLoaded():(this.onVideoLoaded=this.onVideoLoaded.bind(this),this.el.addEventListener("video-loaded",this.onVideoLoaded))},onVideoLoaded(){this.videoComponent=this.el.components["media-video"],this.video=this.videoComponent.video,this.video.addEventListener("pause",this.onPauseStateChange)},onPauseStateChange(){this.el.setAttribute("paused",this.video.paused)},update(){this.video&&this.data.paused!==this.video.paused&&this.videoComponent.togglePlaying()},remove(){this.video&&this.video.removeEventListener("pause",this.onPauseStateChange),this.el.removeEventListener("video-loaded",this.onVideoLoaded)}})},function(e,t){AFRAME.registerComponent("log-events",{init:function(){const e=this.el,t=this.log.bind(this),i=this.el.dispatchEvent;this.el.dispatchEvent=function(){return t(Array.from(arguments)),i.apply(e,arguments)}},log:function([e]){if(["componentchanged"].includes(e.type))return;let t=!0;console.info(`log-events: ${this.el.id} ${e.type} ${JSON.stringify(e.detail,(e,i)=>i&&"object"==typeof i&&void 0===i.length?t?(t=!1,i):"[object]":i)}`)}}),AFRAME.registerComponent("lifecycle-checker",{schema:{name:{type:"string"},tick:{default:!1}},init:function(){this.log("init")},update:function(){this.log("update")},tick:function(){this.data.tick&&this.log("tick")},remove:function(){this.log("remove")},pause:function(){this.log("pause")},play:function(){this.log("play")},log:function(e){console.info(`lifecycle-checker:${this.data.name} ${e}`)}})},,,,,,,,,,,,,,function(e,t,i){const{Pathfinding:n}=i(475);AFRAME.registerSystem("nav",{init:function(){this.pathfinder=new n},loadMesh:function(e,t){this.el.object3D.updateMatrixWorld(),this.mesh&&this.mesh.geometry&&this.mesh.geometry.dispose&&this.mesh.geometry.dispose(),this.mesh=e;const i=(new THREE.Geometry).fromBufferGeometry(e.geometry);i.applyMatrix(e.matrixWorld),this.pathfinder.setZoneData(t,n.createZone(i)),this.el.sceneEl.emit("nav-mesh-loaded")}})},function(e,t){AFRAME.registerComponent("event-repeater",{schema:{eventSource:{type:"selector"},events:{type:"array"}},play:function(){this.data.eventListeners=[];const e=this.data.events;for(let t=0;t<e.length;t++){const i=e[t];this.data.eventListeners[i]=this._handleEvent.bind(this,i),this.data.eventSource.addEventListener(i,this.data.eventListeners[i])}},pause:function(){const e=this.data.events;for(let t=0;t<e.length;t++){const i=e[t];this.data.eventSource.removeEventListener(i,this.data.eventListeners[i])}this.data.eventListeners=[]},_handleEvent:function(e,t){this.el.emit(e,t.detail)}})},,,function(e,t,i){"use strict";i(344),i(345),i(346),i(196),i(347);const n=new THREE.Box3,a=new THREE.Box3,s=new THREE.Matrix4,o=new THREE.Box3,r=1,l=-500,c=500,d=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];AFRAME.registerComponent("directional-light",{schema:{color:{type:"color"},intensity:{default:1},castShadow:{default:!0},shadowMapResolution:{default:[512,512]},shadowBias:{default:0},shadowRadius:{default:1}},init(){const e=this.el;this.light=new THREE.DirectionalLight,this.light.position.set(0,0,0),this.light.target.position.set(0,0,1),this.light.add(this.light.target),this.el.setObject3D("directional-light",this.light),this.el.sceneEl.systems.light.registerLight(e),this.rendererSystem=this.el.sceneEl.systems.renderer},update(e){const t=this.light;if(this.data.color!==e.color){const e=new THREE.Color(this.data.color);this.rendererSystem.applyColorCorrection(e),t.color.copy(e)}this.data.intensity!==e.intensity&&(t.intensity=this.data.intensity),this.data.castShadow!==e.castShadow&&(t.castShadow=this.data.castShadow),this.data.shadowBias!==e.shadowBias&&(t.shadow.bias=this.data.shadowBias),this.data.shadowRadius!==e.shadowRadius&&(t.shadow.radius=this.data.shadowRadius);const[i,n]=this.data.shadowMapResolution,[a,s]=e.shadowMapResolution?e.shadowMapResolution:[512,512];i===a&&n===s||(t.shadow.mapSize.set(i,n),t.shadow.map&&(t.shadow.map.dispose(),t.shadow.map=null)),this.light.shadow.camera.matrixNeedsUpdate=!0},tick(){window.APP&&"low"===window.APP.quality||function(e,t){a.makeEmpty(),n.makeEmpty(),t.traverse(e=>{const t=e.geometry;t&&e.castShadow&&(t.boundingBox||t.computeBoundingBox(),o.copy(t.boundingBox),o.applyMatrix4(e.matrixWorld),n.union(o))});const i=n.min,h=n.max;d[0].set(i.x,i.y,i.z),d[1].set(i.x,i.y,h.z),d[2].set(i.x,h.y,i.z),d[3].set(i.x,h.y,h.z),d[4].set(h.x,i.y,i.z),d[5].set(h.x,i.y,h.z),d[6].set(h.x,h.y,i.z),d[7].set(h.x,h.y,h.z),s.getInverse(e.shadow.camera.matrixWorld);for(let e=0;e<d.length;e++)d[e].applyMatrix4(s),a.expandByPoint(d[e]);const u=e.shadow.camera;u.left=a.min.x-r,u.right=a.max.x+r,u.bottom=a.min.y-r,u.top=a.max.y+r,u.near=a.min.z+l,u.far=a.max.z+c,u.updateProjectionMatrix()}(this.light,this.el.sceneEl.object3D)},remove:function(){this.el.removeObject3D("directional-light")}});i(348);var h=i(81);i(350),i(351),i(352);const u={reflection:3};AFRAME.registerComponent("layers",{schema:{reflection:{type:"boolean",default:!1},inWorldHud:{type:"boolean",default:!1},exclusive:{type:"boolean",default:!1}},init(){this.update=this.update.bind(this),this.el.addEventListener("model-loaded",this.update)},update(e){const t=this.el.object3D;this.data.exclusive&&t.traverse(e=>e.layers.mask=0);for(const[i,n]of Object.entries(u)){const a=e[i],s=this.data[i];a!==s&&(s?t.traverse(e=>e.layers.enable(n)):t.traverse(e=>e.layers.disable(n)))}},remove(){this.el.removeEventListener("model-loaded",this.update)}});var p=i(88);AFRAME.registerComponent("loop-animation",{schema:{paused:{type:"boolean",default:!1},clip:{type:"string",default:""},activeClipIndex:{type:"int",default:0}},init(){this.mixerEl=Object(p.a)(this.el,"animation-mixer"),this.mixerEl?this.updateClip():console.warn("loop-animation component could not find an animation-mixer in its ancestors.")},update(e){this.mixerEl&&(e.clip===this.data.clip&&e.activeClipIndex===this.data.activeClipIndex||this.updateClip(),e.paused!==this.data.paused&&this.currentAction&&(this.currentAction.paused=this.data.paused))},updateClip(){const{mixer:e,animations:t}=this.mixerEl.components["animation-mixer"],{clip:i,activeClipIndex:n}=this.data;if(0===t.length)return;let a;if(!(a=""!==i?t.find(({name:e})=>e===i):t[n]))return;const s=e.clipAction(a,this.el.object3D);s.enabled=!0,s.setLoop(THREE.LoopRepeat,1/0).play(),this.currentAction=s},destroy(){this.currentAction&&(this.currentAction.enabled=!1,this.currentAction.stop())}});var m=i(72),g=i(17),f=i(11),v=i(199),b=i(21),y=i(246),_=i.n(y),w=i(18),E=i(12),x=i(14),S=i(13);function C(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function k(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){C(s,n,a,o,r,"next",e)}function r(e){C(s,n,a,o,r,"throw",e)}o(void 0)})}}let A,T;Object(x.a)().then(()=>{Object(h.b)(_.a).then(e=>{T=e})});const M=Object(b.a)("batchMeshes"),L=Object(b.a)("disableBatching");AFRAME.registerComponent("media-loader",{schema:{playSoundEffect:{default:!0},fileId:{type:"string"},fileIsOwned:{type:"boolean"},src:{type:"string"},version:{type:"number",default:1},fitToBox:{default:!1},resolve:{default:!1},contentType:{default:null},contentSubtype:{default:null},animate:{default:!0},linkedEl:{default:null},mediaOptions:{default:{},parse:e=>"object"==typeof e?e:JSON.parse(e),stringify:JSON.stringify}},init(){this.onError=this.onError.bind(this),this.showLoader=this.showLoader.bind(this),this.clearLoadingTimeout=this.clearLoadingTimeout.bind(this),this.onMediaLoaded=this.onMediaLoaded.bind(this),this.handleLinkedElRemoved=this.handleLinkedElRemoved.bind(this),this.refresh=this.refresh.bind(this),this.animating=!1;try{NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEl=e}).catch(()=>{})}catch(e){}},updateScale:function(){const e=new THREE.Vector3;return function(t){const i=this.el.getObject3D("mesh"),n=Object(m.a)(this.el,i),a=t?Object(m.b)(.5,n):1;i.scale.multiplyScalar(a);const{min:s,max:o}=n;e.addVectors(s,o).multiplyScalar(.5*a),i.position.sub(e),i.matrixNeedsUpdate=!0}}(),removeShape(e){this.el.getAttribute("shape-helper__"+e)&&this.el.removeAttribute("shape-helper__"+e)},tick(e,t){this.loaderMixer&&this.loaderMixer.update(t/1e3)},handleLinkedElRemoved(e){"media-loader"===e.detail.name&&(this.data.linkedEl.removeEventListener("componentremoved",this.handleLinkedElRemoved),Object(g.e)())},remove(){this.data.linkedEl&&this.data.linkedEl.removeEventListener("componentremoved",this.handleLinkedElRemoved);const e=this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem;this.loadingSoundEffect&&(e.stopPositionalAudio(this.loadingSoundEffect),this.loadingSoundEffect=null),this.loadedSoundEffect&&(e.stopPositionalAudio(this.loadedSoundEffect),this.loadedSoundEffect=null)},onError(){this.el.removeAttribute("gltf-model-plus"),this.el.removeAttribute("media-pager"),this.el.removeAttribute("media-video"),this.el.removeAttribute("media-pdf"),this.el.setAttribute("media-image",{src:"error"}),this.clearLoadingTimeout()},showLoader(){if(this.el.object3DMap.mesh)return void this.clearLoadingTimeout();const e=!!T,t=e?Object(E.e)(T.scene):new THREE.Mesh(new THREE.BoxGeometry,new THREE.MeshBasicMaterial);if(this.el.setObject3D("mesh",t),this.updateScale(!0),e){const e=this.el.sceneEl.components["environment-map"];if(e){const i=e.environmentMap;A!==i&&(e.applyEnvironmentMap(t),A=i)}this.loaderMixer=new THREE.AnimationMixer(t),this.loadingClip=this.loaderMixer.clipAction(t.animations[0]),this.loadingScaleClip=this.loaderMixer.clipAction(new THREE.AnimationClip(null,1e3,[new THREE.VectorKeyframeTrack(".scale",[0,.2],[0,0,0,t.scale.x,t.scale.y,t.scale.z])])),setTimeout(()=>{this.loaderMixer&&this.el.setAttribute("shape-helper__loader",{type:S.SHAPE.BOX})},200),this.loadingClip.play(),this.loadingScaleClip.play()}this.el.sceneEl.is("entered")&&(!this.networkedEl||NAF.utils.isMine(this.networkedEl))&&this.data.playSoundEffect&&(this.loadingSoundEffect=this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playPositionalSoundFollowing(w.h,this.el.object3D,!0)),delete this.showLoaderTimeout},clearLoadingTimeout(){clearTimeout(this.showLoaderTimeout),this.loadingSoundEffect&&(this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.stopPositionalAudio(this.loadingSoundEffect),this.loadingSoundEffect=null),this.loaderMixer&&(this.loadingClip.stop(),this.loadingScaleClip.stop(),delete this.loaderMixer,delete this.loadingScaleClip,delete this.loadingClip),delete this.showLoaderTimeout,this.removeShape("loader")},updateHoverableVisuals:function(){const e=new THREE.Box3,t=new THREE.Sphere;return function(){const i=this.el.components["hoverable-visuals"];i&&(this.injectedCustomShaderChunks||(this.injectedCustomShaderChunks=!0,i.uniforms=Object(g.j)(this.el.object3D)),e.setFromObject(this.el.object3DMap.mesh),e.getBoundingSphere(t),i.geometryRadius=t.radius/this.el.object3D.scale.y)}}(),onMediaLoaded(e=null,t){const i=this.el;this.clearLoadingTimeout(),this.el.sceneEl.is("entered")&&this.data.playSoundEffect&&(this.loadedSoundEffect=this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playPositionalSoundFollowing(w.g,this.el.object3D,!1));const n=()=>{this.animating=!1,e&&i.setAttribute("shape-helper",{type:e,minHalfExtent:.04}),this.updateHoverableVisuals(),this.data.linkedEl&&(this.el.sceneEl.systems["linked-media"].registerLinkage(this.data.linkedEl,this.el),this.data.linkedEl.addEventListener("componentremoved",this.handleLinkedElRemoved)),i.emit("media-loaded")};if(this.data.animate){if(!this.animating){this.animating=!0,t&&this.updateScale(this.data.fitToBox);const e=this.el.getObject3D("mesh"),i={x:.001,y:.001,z:.001};i.x=e.scale.x<i.x?.001*e.scale.x:i.x,i.y=e.scale.y<i.y?.001*e.scale.x:i.y,i.z=e.scale.z<i.z?.001*e.scale.x:i.z,Object(g.c)(e,i,n)}}else t&&this.updateScale(this.data.fitToBox),n()},refresh(){(!this.networkedEl||NAF.utils.isMine(this.networkedEl)||NAF.utils.takeOwnership(this.networkedEl))&&this.el.setAttribute("media-loader",{version:Math.floor(Date.now()/1e3)})},update(e){var t=this;return k(function*(){const{src:i,version:n,contentSubtype:a}=t.data;if(!i)return;const s=e.src!==i;!(!e.version||e.version===n)&&(t.el.emit("media_refreshing"),t.data.animate=!1,t.data.playSoundEffect=NAF.utils.isMine(t.networkedEl));try{s&&!t.showLoaderTimeout&&(t.showLoaderTimeout=setTimeout(t.showLoader,100));let e,o=i,r=i,l=i,c=t.data.contentType;const d=new URL(i),h=Object(f.h)(d.hostname)&&(Object(f.c)(i)||"").startsWith("model/gltf");if(t.data.resolve&&!i.startsWith("data:")&&!i.startsWith("hubs:")&&!h){const a=!(!t.data.mediaOptions.projection||!t.data.mediaOptions.projection.startsWith("360")),s=Object(g.h)(a),l=yield Object(g.k)(i,s,n);(o=l.origin).startsWith("//")&&(o=location.protocol+o),(r=l.origin_audio)&&r.startsWith("//")&&(r=location.protocol+r),c=l.meta&&l.meta.expected_content_type||c,e=l.meta&&l.meta.thumbnail&&Object(f.i)(l.meta.thumbnail)}if(l=Object(f.i)(o),c=c||Object(f.c)(o)||(yield(e=>fetch(e,{method:"HEAD"}).then(e=>e.headers.get("content-type")))(l)),s?t.el.emit("media_resolved",{src:i,raw:l,contentType:c}):t.el.emit("media_refreshed",{src:i,raw:l,contentType:c}),c.startsWith("video/")||c.startsWith("audio/")||AFRAME.utils.material.isHLS(o,c)){let e,i,n;if(t.data.linkedEl){const a=t.data.linkedEl.components["media-video"];e=a.videoTexture,i=a.audioSource,n=a.mediaElementAudioSource}const a=parseInt(d.searchParams.get("t")),s=parseInt(new URLSearchParams(d.hash.substring(1)).get("t"))||a||0;t.el.removeAttribute("gltf-model-plus"),t.el.removeAttribute("media-image"),t.el.removeAttribute("media-pdf"),t.el.setAttribute("floaty-object",{reduceAngularFloat:!0,releaseGravity:-1}),t.el.addEventListener("video-loaded",e=>{t.onMediaLoaded("flat"===e.detail.projection?S.SHAPE.BOX:null)},{once:!0}),t.el.setAttribute("media-video",Object.assign({},t.data.mediaOptions,{src:l,audioSrc:r?Object(f.i)(r):null,time:s,contentType:c,linkedVideoTexture:e,linkedAudioSource:i,linkedMediaElementAudioSource:n})),t.el.components["position-at-box-shape-border__freeze"]&&t.el.setAttribute("position-at-box-shape-border__freeze",{dirs:["forward","back"]})}else if(c.startsWith("image/")){t.el.removeAttribute("gltf-model-plus"),t.el.removeAttribute("media-video"),t.el.removeAttribute("media-pdf"),t.el.removeAttribute("media-pager"),t.el.addEventListener("image-loaded",e=>{t.onMediaLoaded("flat"===e.detail.projection?S.SHAPE.BOX:null),"photo-camera"===a&&t.el.setAttribute("hover-menu__photo",{template:"#photo-hover-menu",dirs:["forward","back"]})},{once:!0}),t.el.setAttribute("floaty-object",{reduceAngularFloat:!0,releaseGravity:-1});let e=!L;t.data.mediaOptions.hasOwnProperty("batch")&&!t.data.mediaOptions.batch&&(e=!1),t.el.setAttribute("media-image",Object.assign({},t.data.mediaOptions,{src:l,version:n,contentType:c,batch:e})),t.el.components["position-at-box-shape-border__freeze"]&&t.el.setAttribute("position-at-box-shape-border__freeze",{dirs:["forward","back"]})}else if(c.startsWith("application/pdf"))t.el.removeAttribute("gltf-model-plus"),t.el.removeAttribute("media-video"),t.el.removeAttribute("media-image"),t.el.setAttribute("media-pdf",Object.assign({},t.data.mediaOptions,{src:l,contentType:c,batch:!1})),t.el.setAttribute("media-pager",{}),t.el.setAttribute("floaty-object",{reduceAngularFloat:!0,releaseGravity:-1}),t.el.addEventListener("pdf-loaded",()=>{t.clearLoadingTimeout(),t.onMediaLoaded(S.SHAPE.BOX)},{once:!0}),t.el.components["position-at-box-shape-border__freeze"]&&t.el.setAttribute("position-at-box-shape-border__freeze",{dirs:["forward","back"]});else if(c.includes("application/octet-stream")||c.includes("x-zip-compressed")||c.startsWith("model/gltf")){t.el.removeAttribute("media-image"),t.el.removeAttribute("media-video"),t.el.removeAttribute("media-pdf"),t.el.removeAttribute("media-pager"),t.el.addEventListener("model-loaded",()=>{t.onMediaLoaded(S.SHAPE.HULL,!0),Object(v.a)(t.el)},{once:!0}),t.el.addEventListener("model-error",t.onError,{once:!0});let e=!L&&(M||AFRAME.utils.device.isMobile()&&window.APP&&"low"===window.APP.quality);t.data.mediaOptions.hasOwnProperty("batch")&&!t.data.mediaOptions.batch&&(e=!1),t.el.setAttribute("gltf-model-plus",Object.assign({},t.data.mediaOptions,{src:l,contentType:c,inflate:!0,batch:e,modelToWorldScale:t.data.fitToBox?1e-4:1}))}else{if(!c.startsWith("text/html"))throw new Error(`Unsupported content type: ${c}`);{t.el.removeAttribute("gltf-model-plus"),t.el.removeAttribute("media-video"),t.el.removeAttribute("media-pdf"),t.el.removeAttribute("media-pager"),t.el.addEventListener("image-loaded",k(function*(){const e=t.el.sceneEl.systems.permissions.can("update_hub");(yield Object(f.f)(i))?t.el.setAttribute("hover-menu__hubs-item",{template:"#avatar-link-hover-menu",dirs:["forward","back"]}):(yield Object(f.e)(i))||(yield Object(f.g)(i))&&e?t.el.setAttribute("hover-menu__hubs-item",{template:"#hubs-destination-hover-menu",dirs:["forward","back"]}):t.el.setAttribute("hover-menu__link",{template:"#link-hover-menu",dirs:["forward","back"]}),t.onMediaLoaded(S.SHAPE.BOX)}),{once:!0}),t.el.setAttribute("floaty-object",{reduceAngularFloat:!0,releaseGravity:-1});let a=!L;t.data.mediaOptions.hasOwnProperty("batch")&&!t.data.mediaOptions.batch&&(a=!1),t.el.setAttribute("media-image",Object.assign({},t.data.mediaOptions,{src:e,version:n,contentType:Object(f.c)(e)||"image/png",batch:a})),t.el.components["position-at-box-shape-border__freeze"]&&t.el.setAttribute("position-at-box-shape-border__freeze",{dirs:["forward","back"]})}}}catch(e){console.error("Error adding media",e),t.onError()}})()}}),AFRAME.registerComponent("media-pager",{schema:{index:{default:0},maxIndex:{default:0}},init(){var e=this;this.onNext=this.onNext.bind(this),this.onPrev=this.onPrev.bind(this),this.onSnap=this.onSnap.bind(this),this.update=this.update.bind(this),this.el.setAttribute("hover-menu__pager",{template:"#pager-hover-menu",dirs:["forward","back"]}),this.el.components["hover-menu__pager"].getHoverMenu().then(e=>{this.el.parentNode&&(this.hoverMenu=e,this.nextButton=this.el.querySelector(".next-button [text-button]"),this.prevButton=this.el.querySelector(".prev-button [text-button]"),this.snapButton=this.el.querySelector(".snap-button [text-button]"),this.pageLabel=this.el.querySelector(".page-label"),this.nextButton.object3D.addEventListener("interact",this.onNext),this.prevButton.object3D.addEventListener("interact",this.onPrev),this.snapButton.object3D.addEventListener("interact",this.onSnap),this.update(),this.el.emit("pager-loaded"))}),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEl=e,this.networkedEl.addEventListener("pinned",this.update),this.networkedEl.addEventListener("unpinned",this.update),window.APP.hubChannel.addEventListener("permissions_updated",this.update)}).catch(()=>{}),this.el.addEventListener("pdf-loaded",k(function*(){e.update()}))},update(e){var t=this;return k(function*(){if(t.networkedEl&&NAF.utils.isMine(t.networkedEl)&&e&&"number"==typeof e.index&&e.index!==t.data.index&&t.el.emit("owned-pager-page-changed"),t.pageLabel&&t.pageLabel.setAttribute("text","value",`${t.data.index+1}/${t.data.maxIndex+1}`),t.prevButton&&t.nextButton){const e=t.el.components["media-loader"].data.linkedEl||t.el,i=e.components.pinnable&&e.components.pinnable.data.pinned;t.prevButton.object3D.visible=t.nextButton.object3D.visible=!i||window.APP.hubChannel.can("pin_objects")}})()},onNext(){if(this.networkedEl&&!NAF.utils.isMine(this.networkedEl)&&!NAF.utils.takeOwnership(this.networkedEl))return;const e=Math.min(this.data.index+1,this.data.maxIndex);this.el.setAttribute("media-pdf","index",e),this.el.setAttribute("media-pager","index",e)},onPrev(){if(this.networkedEl&&!NAF.utils.isMine(this.networkedEl)&&!NAF.utils.takeOwnership(this.networkedEl))return;const e=Math.max(this.data.index-1,0);this.el.setAttribute("media-pdf","index",e),this.el.setAttribute("media-pager","index",e)},onSnap(){this.el.emit("pager-snap-clicked")},remove(){this.networkedEl&&(this.networkedEl.removeEventListener("pinned",this.update),this.networkedEl.removeEventListener("unpinned",this.update)),window.APP.hubChannel.removeEventListener("permissions_updated",this.update)}});i(353);AFRAME.registerComponent("quack",{schema:{quackPercentage:{default:1},specialQuackPercentage:{default:.01}},init:function(){this._handleGrabStart=this._handleGrabStart.bind(this)},play:function(){this.el.object3D.addEventListener("interact",this._handleGrabStart)},pause:function(){this.el.object3D.removeEventListener("interact",this._handleGrabStart)},_handleGrabStart:function(){const e=Math.random();e<this.data.specialQuackPercentage?this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(w.s):e<this.data.quackPercentage&&this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(w.o)}});var R=i(126),P=i(47);function D(e,t,i){return(1-i)*e+i*t}const O=new THREE.Quaternion;AFRAME.registerComponent("scene-preview-camera",{schema:{duration:{default:90,type:"number"},positionOnly:{default:!1,type:"boolean"}},init:function(){const e=AFRAME.scenes[0].systems["hubs-systems"]||AFRAME.scenes[0].systems["scene-systems"];e&&e.scenePreviewCameraSystem.register(this.el),this.startPoint=this.el.object3D.position.clone(),this.startRotation=this.el.object3D.quaternion.clone(),this.targetPoint=this.el.object3D.position.clone(),this.targetPoint.y=Math.max(this.targetPoint.y-1.5,1),this.targetPoint.add(new THREE.Vector3(2,0,-2));const t=new THREE.Euler(-.15,0,.15);this.targetRotation=new THREE.Quaternion,this.targetRotation.setFromEuler(t),this.targetRotation.premultiply(this.startRotation),this.startTime=performance.now(),this.backwards=!1,this.ranOnePass=!1},tick2:function(){const e=this.el.sceneEl.systems["hubs-systems"];let t;if(e&&(e.cameraSystem.mode=P.d,t=function(){const e=Object(R.b)();return e?e.el.querySelector(".camera").object3D:null}()),t)Object(E.l)(this.el.object3D,t.matrixWorld),this.el.object3D.translateZ(-.1),this.el.object3D.matrixNeedsUpdate=!0;else{let e=(performance.now()-this.startTime)/(1e3*this.data.duration);e=Math.min(1,Math.max(0,e)),this.ranOnePass?e=e<.5?2*e*e:(4-2*e)*e-1:e*=2-e;const t=this.backwards?this.targetPoint:this.startPoint,i=this.backwards?this.startPoint:this.targetPoint,n=this.backwards?this.targetRotation:this.startRotation,a=this.backwards?this.startRotation:this.targetRotation;THREE.Quaternion.slerp(n,a,O,e),this.el.object3D.position.set(D(t.x,i.x,e),D(t.y,i.y,e),D(t.z,i.z,e)),this.data.positionOnly||this.el.object3D.rotation.setFromQuaternion(O),this.el.object3D.matrixNeedsUpdate=!0,e>=.9999&&(this.ranOnePass=!0,this.backwards=!this.backwards,this.startTime=performance.now())}},remove:function(){const e=AFRAME.scenes[0].systems["hubs-systems"]||AFRAME.scenes[0].systems["scene-systems"];e&&e.scenePreviewCameraSystem.unregister(this.el)}});i(431),i(432);function H(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const j=Object(b.a)("bot"),{Scene:I,CubeCamera:N,Object3D:F,Vector3:V,BoxBufferGeometry:B,ShaderMaterial:z,UniformsUtils:U,BackSide:W,Mesh:Z,UniformsLib:G,PMREMGenerator:q,PMREMCubeUVPacker:$}=THREE;class Y extends F{constructor(){super();const e=new z({fragmentShader:Y.shader.fragmentShader,vertexShader:Y.shader.vertexShader,uniforms:U.clone(Y.shader.uniforms),side:W,fog:!0});this.skyScene=new I,this.cubeCamera=new N(1,1e5,512),this.skyScene.add(this.cubeCamera),this.sky=new Z(Y._geometry,e),this.sky.name="Sky",this.add(this.sky),this._inclination=0,this._azimuth=.15,this._distance=8e3,this.updateSunPosition()}get turbidity(){return this.sky.material.uniforms.turbidity.value}set turbidity(e){this.sky.material.uniforms.turbidity.value=e}get rayleigh(){return this.sky.material.uniforms.rayleigh.value}set rayleigh(e){this.sky.material.uniforms.rayleigh.value=e}get luminance(){return this.sky.material.uniforms.luminance.value}set luminance(e){this.sky.material.uniforms.luminance.value=e}get mieCoefficient(){return this.sky.material.uniforms.mieCoefficient.value}set mieCoefficient(e){this.sky.material.uniforms.mieCoefficient.value=e}get mieDirectionalG(){return this.sky.material.uniforms.mieDirectionalG.value}set mieDirectionalG(e){this.sky.material.uniforms.mieDirectionalG.value=e}get inclination(){return this._inclination}set inclination(e){this._inclination=e,this.updateSunPosition()}get azimuth(){return this._azimuth}set azimuth(e){this._azimuth=e,this.updateSunPosition()}get distance(){return this._distance}set distance(e){this._distance=e,this.updateSunPosition()}updateSunPosition(){const e=Math.PI*(this._inclination-.5),t=2*Math.PI*(this._azimuth-.5),i=this._distance,n=i*Math.cos(t),a=i*Math.sin(t)*Math.sin(e),s=i*Math.sin(t)*Math.cos(e);this.sky.material.uniforms.sunPosition.value.set(n,a,s).normalize(),this.sky.scale.set(i,i,i)}generateEnvironmentMap(e){this.skyScene.add(this.sky),this.cubeCamera.update(e,this.skyScene),this.add(this.sky);const t=e.vr.enabled;e.vr.enabled=!1;const i=new q(this.cubeCamera.renderTarget.texture);i.update(e);const n=new $(i.cubeLods);return n.update(e),e.vr.enabled=t,i.dispose(),n.dispose(),n.CubeUVRenderTarget.texture}copy(e,t=!0){if(t&&this.remove(this.sky),super.copy(e,t),t){const t=e.children.indexOf(e.sky);-1!==t&&(this.sky=this.children[t])}return this.turbidity=e.turbidity,this.rayleigh=e.rayleigh,this.luminance=e.luminance,this.mieCoefficient=e.mieCoefficient,this.mieDirectionalG=e.mieDirectionalG,this.inclination=e.inclination,this.azimuth=e.azimuth,this.distance=e.distance,this}}H(Y,"shader",{uniforms:U.merge([G.fog,{luminance:{value:1},turbidity:{value:10},rayleigh:{value:2},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new V}}]),vertexShader:"\n#include <common>\n#include <fog_pars_vertex>\n\nuniform vec3 sunPosition;\nuniform float rayleigh;\nuniform float turbidity;\nuniform float mieCoefficient;\n\nvarying vec3 vWorldPosition;\nvarying vec3 vSunDirection;\nvarying float vSunfade;\nvarying vec3 vBetaR;\nvarying vec3 vBetaM;\nvarying float vSunE;\n\nconst vec3 up = vec3( 0.0, 1.0, 0.0 );\n\n// constants for atmospheric scattering\nconst float e = 2.71828182845904523536028747135266249775724709369995957;\nconst float pi = 3.141592653589793238462643383279502884197169;\n\n// wavelength of used primaries, according to preetham\nconst vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );\n// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\n// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\nconst vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );\n\n// mie stuff\n// K coefficient for the primaries\nconst float v = 4.0;\nconst vec3 K = vec3( 0.686, 0.678, 0.666 );\n// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\nconst vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );\n\n// earth shadow hack\n// cutoffAngle = pi / 1.95;\nconst float cutoffAngle = 1.6110731556870734;\nconst float steepness = 1.5;\nconst float EE = 1000.0;\n\nfloat sunIntensity( float zenithAngleCos ) {\n  zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );\n  return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );\n}\n\nvec3 totalMie( float T ) {\n  float c = ( 0.2 * T ) * 10E-18;\n  return 0.434 * c * MieConst;\n}\n\nvoid main() {\n  #include <begin_vertex>\n\n  vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n  vWorldPosition = worldPosition.xyz;\n\n  #include <project_vertex>\n\n  vSunDirection = normalize( sunPosition );\n\n  vSunE = sunIntensity( dot( vSunDirection, up ) );\n\n  vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );\n\n  float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );\n\n  // extinction (absorbtion + out scattering)\n  // rayleigh coefficients\n  vBetaR = totalRayleigh * rayleighCoefficient;\n\n  // mie coefficients\n  vBetaM = totalMie( turbidity ) * mieCoefficient;\n\n  #include <fog_vertex>\n}\n",fragmentShader:"\n#include <common>\n#include <fog_pars_fragment>\n\nvarying vec3 vWorldPosition;\nvarying vec3 vSunDirection;\nvarying float vSunfade;\nvarying vec3 vBetaR;\nvarying vec3 vBetaM;\nvarying float vSunE;\n\nuniform float luminance;\nuniform float mieDirectionalG;\n\nconst vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );\n\n// constants for atmospheric scattering\nconst float pi = 3.141592653589793238462643383279502884197169;\n\nconst float n = 1.0003; // refractive index of air\nconst float N = 2.545E25; // number of molecules per unit volume for air at\n// 288.15K and 1013mb (sea level -45 celsius)\n\n// optical length at zenith for molecules\nconst float rayleighZenithLength = 8.4E3;\nconst float mieZenithLength = 1.25E3;\nconst vec3 up = vec3( 0.0, 1.0, 0.0 );\n// 66 arc seconds -> degrees, and the cosine of that\nconst float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\n\n// 3.0 / ( 16.0 * pi )\nconst float THREE_OVER_SIXTEENPI = 0.05968310365946075;\n// 1.0 / ( 4.0 * pi )\nconst float ONE_OVER_FOURPI = 0.07957747154594767;\n\nfloat rayleighPhase( float cosTheta ) {\n  return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );\n}\n\nfloat hgPhase( float cosTheta, float g ) {\n  float g2 = pow( g, 2.0 );\n  float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );\n  return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );\n}\n\n// Filmic ToneMapping http://filmicgames.com/archives/75\nconst float A = 0.15;\nconst float B = 0.50;\nconst float C = 0.10;\nconst float D = 0.20;\nconst float E = 0.02;\nconst float F = 0.30;\n\nconst float whiteScale = 1.0748724675633854; // 1.0 / Uncharted2Tonemap(1000.0)\n\nvec3 Uncharted2Tonemap( vec3 x ) {\n  return ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;\n}\n\nvoid main() {\n  // optical length\n  // cutoff angle at 90 to avoid singularity in next formula.\n  float zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );\n  float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );\n  float sR = rayleighZenithLength * inverse;\n  float sM = mieZenithLength * inverse;\n\n  // combined extinction factor\n  vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );\n\n  // in scattering\n  float cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );\n\n  float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );\n  vec3 betaRTheta = vBetaR * rPhase;\n\n  float mPhase = hgPhase( cosTheta, mieDirectionalG );\n  vec3 betaMTheta = vBetaM * mPhase;\n\n  vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );\n  Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );\n\n  // nightsky\n  vec3 direction = normalize( vWorldPosition - cameraPos );\n  float theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]\n  float phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]\n  vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );\n  vec3 L0 = vec3( 0.1 ) * Fex;\n\n  // composition + solar disc\n  float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );\n  L0 += ( vSunE * 19000.0 * Fex ) * sundisk;\n\n  vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );\n\n  vec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );\n  vec3 color = curr * whiteScale;\n\n  vec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );\n\n  gl_FragColor = vec4( retColor, 1.0 );\n\n  #include <fog_fragment>\n}\n"}),H(Y,"_geometry",new B(1,1,1)),AFRAME.registerComponent("skybox",{schema:{turbidity:{type:"number",default:10},rayleigh:{type:"number",default:2},luminance:{type:"number",default:1},mieCoefficient:{type:"number",default:.005},mieDirectionalG:{type:"number",default:.8},inclination:{type:"number",default:0},azimuth:{type:"number",default:.15},distance:{type:"number",default:8e3}},init(){this.sky=new Y,this.sky.cubeCamera.children.forEach(e=>e.matrixNeedsUpdate=!0),this.el.setObject3D("mesh",this.sky),this.updateEnvironmentMap=this.updateEnvironmentMap.bind(this),requestAnimationFrame(()=>setTimeout(this.updateEnvironmentMap))},update(e){if(this.data.turbidity!==e.turbidity&&(this.sky.turbidity=this.data.turbidity),this.data.rayleigh!==e.rayleigh&&(this.sky.rayleigh=this.data.rayleigh),this.data.luminance!==e.luminance&&(this.sky.luminance=this.data.luminance),this.data.mieCoefficient!==e.mieCoefficient&&(this.sky.mieCoefficient=this.data.mieCoefficient),this.data.mieDirectionalG!==e.mieDirectionalG&&(this.sky.mieDirectionalG=this.data.mieDirectionalG),this.data.inclination!==e.inclination&&(this.sky.inclination=this.data.inclination,this.el.object3D.matrixNeedsUpdate=!0),this.data.azimuth!==e.azimuth&&(this.sky.azimuth=this.data.azimuth,this.el.object3D.matrixNeedsUpdate=!0),this.data.distance!==e.distance){const e=this.data.distance;this.sky.distance=1===this.el.object3D.scale.x?e:1,this.sky.matrixNeedsUpdate=!0}this.updateEnvironmentMap()},updateEnvironmentMap(){const e=this.el.sceneEl.components["environment-map"];if(e&&!j){const t=this.el.sceneEl.renderer,i=this.sky.generateEnvironmentMap(t);e.updateEnvironmentMap(i)}},remove(){this.el.removeObject3D("mesh")}}),AFRAME.registerComponent("spawn-controller",{schema:{target:{type:"selector"},camera:{type:"selector",default:"#avatar-pov-node"},playerHeight:{default:1.6},loadedEvent:{type:"string"}},init(){this.moveToSpawnPoint=this.moveToSpawnPoint.bind(this),Object(x.a)().then(()=>{this.data.target.addEventListener(this.data.loadedEvent,this.moveToSpawnPoint)})},moveToSpawnPoint(){const e=document.querySelectorAll("[spawn-point]");if(0===e.length)return;const t=this.data.camera,i=e[Math.round((e.length-1)*Math.random())];Object(E.h)(i.object3D,this.el.object3D.position),this.el.object3D.rotation.copy(i.object3D.rotation),this.el.sceneEl.is("vr-mode")?this.el.object3D.rotation.y-=this.data.camera.object3D.rotation.y:(t.object3D.position.set(0,this.data.playerHeight,0),t.object3D.rotation.set(0,0,0),t.object3D.matrixNeedsUpdate=!0),this.el.object3D.rotation.y+=Math.PI,this.el.object3D.matrixNeedsUpdate=!0}}),AFRAME.registerComponent("spawn-point",{init(){this.el.object3D.visible=!1}});i(354),i(355);var X=i(34),Q=i(1);function K(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}const J=i(111).COLLISION_LAYERS;AFRAME.registerComponent("super-spawner",{schema:{src:{default:""},resolve:{default:!1},template:{default:""},spawnScale:{type:"vec3",default:{x:NaN,y:NaN,z:NaN}},spawnCooldown:{default:1},spawnEvent:{type:"string"},animateFromCursor:{type:"boolean"},mediaOptions:{default:{},parse:e=>"object"==typeof e?e:JSON.parse(e),stringify:JSON.stringify}},init(){this.cooldownTimeout=null,this.handPosition=new THREE.Vector3,this.onSpawnEvent=this.onSpawnEvent.bind(this),this.sceneEl=this.el.sceneEl,this.tempSpawnHandPosition=new THREE.Vector3,this.handleMediaLoaded=this.handleMediaLoaded.bind(this),this.spawnedMediaScale=null},play(){this.el.addEventListener("media-loaded",this.handleMediaLoaded),this.data.spawnEvent&&this.el.sceneEl.addEventListener(this.data.spawnEvent,this.onSpawnEvent)},pause(){this.el.removeEventListener("media-loaded",this.handleMediaLoaded),this.data.spawnEvent&&this.el.sceneEl.removeEventListener(this.data.spawnEvent,this.onSpawnEvent),this.cooldownTimeout&&(clearTimeout(this.cooldownTimeout),this.cooldownTimeout=null,this.el.setAttribute("visible",!0),this.el.classList.add("interactable"))},handleMediaLoaded(e){const t=e.target;var i,n;this.spawnedMediaScale=t.object3D.scale.clone(),i=this.spawnedMediaScale,n=this.data.spawnScale,i.set(null===n.x?i.x:n.x,null===n.y?i.y:n.y,null===n.z?i.z:n.z);const a=t.components["media-image"]||t.components["media-video"]||t.components["media-pdf"]?1:.5,s=Object(m.b)(a,Object(m.a)(t,t.object3D));this.spawnedMediaScale.divideScalar(s)},onSpawnEvent(e){var t,i=this;return(t=function*(){if(i.cooldownTimeout||!i.el.sceneEl.is("entered"))return;const t=Object(g.b)(i.data.src,i.data.template,X.a.SPAWNER,null,i.data.resolve,!1,{x:null===i.data.spawnScale.x?1:i.data.spawnScale.x,y:null===i.data.spawnScale.y?1:i.data.spawnScale.y,z:null===i.data.spawnScale.z?1:i.data.spawnScale.z}).entity,n=i.el.sceneEl.systems.interaction;if(!n.ready)return;const a=e.detail&&e.detail.object3D||n.options.rightRemote.entity.object3D,s=-1===a.el.id.indexOf("right"),o=s?n.options.leftHand.entity.object3D:n.options.rightHand.entity.object3D;a.getWorldPosition(t.object3D.position),a.getWorldQuaternion(t.object3D.quaternion),t.object3D.matrixNeedsUpdate=!0,i.el.emit("spawned-entity-created",{target:t});const r=AFRAME.scenes[0].systems.userinput,l=i.data.animateFromCursor&&(r.get(Q.a.actions.rightHand.matrix)||r.get(Q.a.actions.leftHand.matrix));l||(s?(n.state.leftRemote.held=t,n.state.leftRemote.spawning=!0):(n.state.rightRemote.held=t,n.state.rightRemote.spawning=!0)),i.activateCooldown(),yield Object(x.b)("model-loaded",t),a.getWorldPosition(t.object3D.position),a.getWorldQuaternion(t.object3D.quaternion),t.object3D.matrixNeedsUpdate=!0,l?(o.getWorldPosition(i.handPosition),t.setAttribute("animation__spawn-at-cursor",{property:"position",delay:500,dur:1500,from:{x:t.object3D.position.x,y:t.object3D.position.y,z:t.object3D.position.z},to:{x:i.handPosition.x,y:i.handPosition.y,z:i.handPosition.z},easing:"easeInOutBack"})):s?n.state.leftRemote.spawning=!1:n.state.rightRemote.spawning=!1,t.components["body-helper"].body&&t.components["body-helper"].body.syncToPhysics(!0),t.addEventListener("media-loaded",()=>{i.el.emit("spawned-entity-loaded",{target:t})},{once:!0})},function(){var e=this,i=arguments;return new Promise(function(n,a){var s=t.apply(e,i);function o(e){K(s,n,a,o,r,"next",e)}function r(e){K(s,n,a,o,r,"throw",e)}o(void 0)})})()},activateCooldown(){if(this.data.spawnCooldown>0){const[e,t,i]=[this.el.object3D.scale.x,this.el.object3D.scale.y,this.el.object3D.scale.z];this.el.setAttribute("visible",!1),this.el.object3D.scale.set(.001,.001,.001),this.el.object3D.matrixNeedsUpdate=!0,this.el.classList.remove("interactable"),this.el.setAttribute("body-helper",{collisionFilterMask:J.NONE}),this.cooldownTimeout=setTimeout(()=>{this.el.setAttribute("visible",!0),this.el.classList.add("interactable"),this.el.setAttribute("body-helper",{collisionFilterMask:J.DEFAULT_SPAWNER}),this.el.removeAttribute("animation__spawner-cooldown"),this.el.setAttribute("animation__spawner-cooldown",{property:"scale",delay:50,dur:350,from:{x:.001,y:.001,z:.001},to:{x:e,y:t,z:i},easing:"easeOutElastic"}),this.cooldownTimeout=null},1e3*this.data.spawnCooldown)}}});i(433);var ee=i(152),te=i.n(ee);function ie(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function ne(e,t){THREE.Mesh.call(this,e);const i=void 0!==(t=t||{}).time?t.time:0,n=void 0!==t.waterNormals?t.waterNormals:null,a=void 0!==t.sunDirection?t.sunDirection:new THREE.Vector3(.70707,.70707,0),s=new THREE.Color(void 0!==t.sunColor?t.sunColor:16777215),o=new THREE.Color(void 0!==t.waterColor?t.waterColor:8355711),r=void 0!==t.eye?t.eye:new THREE.Vector3(0,0,0),l=void 0!==t.distortionScale?t.distortionScale:20,c=void 0!==t.side?t.side:THREE.FrontSide,d=void 0!==t.fog&&t.fog,h={uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.lights,{normalSampler:{value:null},time:{value:0},size:{value:1},distortionScale:{value:20},sunColor:{value:new THREE.Color(8355711)},sunDirection:{value:new THREE.Vector3(.70707,.70707,0)},eye:{value:new THREE.Vector3},waterColor:{value:new THREE.Color(5592405)}}]),vertexShader:"\n      uniform float time;\n      varying vec4 worldPosition;\n\n      void main() {\n      \tworldPosition = modelMatrix * vec4( position, 1.0 );\n      \tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );\n      \tgl_Position = projectionMatrix * mvPosition;\n\n      }\n    ",fragmentShader:`\n      uniform float time;\n      uniform float size;\n      uniform float distortionScale;\n      uniform sampler2D normalSampler;\n      uniform vec3 sunColor;\n      uniform vec3 sunDirection;\n      uniform vec3 eye;\n      uniform vec3 waterColor;\n\n      varying vec4 worldPosition;\n\n      vec4 getNoise( vec2 uv ) {\n      \tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);\n      \tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );\n      \tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );\n      \tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );\n      \tvec4 noise = texture2D( normalSampler, uv0 ) +\n      \t\ttexture2D( normalSampler, uv1 ) +\n      \t\ttexture2D( normalSampler, uv2 ) +\n      \t\ttexture2D( normalSampler, uv3 );\n      \treturn noise * 0.5 - 1.0;\n      }\n\n      void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {\n      \tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );\n      \tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );\n      \tspecularColor += pow( direction, shiny ) * sunColor * spec;\n      \tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;\n      }\n\n      ${THREE.ShaderChunk.common}\n      ${THREE.ShaderChunk.packing}\n      ${THREE.ShaderChunk.bsdfs}\n      ${THREE.ShaderChunk.lights_pars_begin}\n\n      void main() {\n      \tvec4 noise = getNoise( worldPosition.xz * size );\n      \tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );\n\n      \tvec3 diffuseLight = vec3(0.0);\n      \tvec3 specularLight = vec3(0.0);\n\n      \tvec3 worldToEye = eye-worldPosition.xyz;\n      \tvec3 eyeDirection = normalize( worldToEye );\n      \tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );\n\n      \tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );\n      \tfloat rf0 = 0.3;\n      \tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\n      \tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;\n      \tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ), ( 0.5 + specularLight ), reflectance);\n      \tvec3 outgoingLight = albedo;\n      \tgl_FragColor = vec4( outgoingLight, 1 );\n      }\n    `},u=new THREE.ShaderMaterial({fragmentShader:h.fragmentShader,vertexShader:h.vertexShader,uniforms:THREE.UniformsUtils.clone(h.uniforms),transparent:!1,lights:!0,side:c,fog:d});u.uniforms.time.value=i,u.uniforms.normalSampler.value=n,u.uniforms.sunColor.value=s,u.uniforms.waterColor.value=o,u.uniforms.sunDirection.value=a,u.uniforms.distortionScale.value=l,u.uniforms.eye.value=r,this.material=u}function ae(){var e;return e=function*(e){const t=yield new Promise((t,i)=>(new THREE.TextureLoader).load(e,t,void 0,i));return t.wrapS=t.wrapT=THREE.RepeatWrapping,t.needsUpdate=!0,t},(ae=function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){ie(s,n,a,o,r,"next",e)}function r(e){ie(s,n,a,o,r,"throw",e)}o(void 0)})}).apply(this,arguments)}ne.prototype=Object.create(THREE.Mesh.prototype),ne.prototype.constructor=THREE.Water,AFRAME.registerComponent("water",{schema:{waterColor:{type:"color",default:"#001e0f"},distortionScale:{type:"number",default:3.7},sunColor:{type:"color",default:"#ffffff"},inclination:{type:"number",default:0},azimuth:{type:"number",default:0},distance:{type:"number",default:1},speed:{type:"number",default:.1},forceMobile:{type:"boolean",default:!1}},init(){const e=this.el.getObject3D("mesh"),t=e.geometry;e.visible=!1,function(e){return ae.apply(this,arguments)}(te.a).then(e=>{const i={textureWidth:512,textureHeight:512,waterNormals:e,sunDirection:this.data.sunDirection,sunColor:new THREE.Color(this.data.sunColor),waterColor:new THREE.Color(this.data.waterColor),distortionScale:this.data.distortionScale,fog:!1};AFRAME.utils.device.isMobile()||AFRAME.utils.device.isMobileVR()||this.data.forceMobile?this.water=new ne(t,i):(this.water=new THREE.Water(t,i),this.water.mirrorCamera.layers.set(u.reflection)),this.el.setObject3D("water",this.water)})},update(e){if(this.data.forceMobile!==e.forceMobile)return this.el.removeObject3D("water"),void this.init();if(!this.water)return;const t=this.water.material.uniforms;if(this.data.waterColor!==e.waterColor&&t.waterColor.value.setStyle(this.data.waterColor),this.data.distortionScale!==e.distortionScale&&(t.distortionScale.value=this.data.distortionScale),this.data.sunColor!==e.sunColor&&t.sunColor.value.setStyle(this.data.sunColor),this.data.inclination!==e.inclination||this.data.azimuth!==e.azimuth||this.data.distance!==e.distance){const e=Math.PI*(this.data.inclination-.5),i=2*Math.PI*(this.data.azimuth-.5),n=this.data.distance,a=n*Math.cos(i),s=n*Math.sin(i)*Math.sin(e),o=n*Math.sin(i)*Math.cos(e);t.sunDirection.value.set(a,s,o)}},tick(e){this.water&&(this.water.material.uniforms.time.value=e/1e3*this.data.speed)},remove(){this.el.removeObject3D("water"),this.el.getObject3D("mesh").visible=!0}});var se=i(293);const{Mesh:oe,PlaneBufferGeometry:re,MeshStandardMaterial:le,MeshPhongMaterial:ce,Vector2:de,TextureLoader:he,RepeatWrapping:ue}=THREE;class pe{constructor(e=new de(1,1),t=new de(1,1),i=.0025,n=!0){this.speed=e,this.scale=t,this.height=i,this.alternate=n}}class me extends oe{constructor(e,t=24,i=!1){const n=new re(10,10,t,t);n.rotateX(-Math.PI/2);const a={ripplesSpeed:{value:.25},ripplesScale:{value:1},time:{value:0}},s=i?ce:le;e.wrapS=e.wrapT=ue;const o=new s({color:21727,normalMap:e});o.name="SimpleWaterMaterial",o.onBeforeCompile=e=>{Object.assign(e.uniforms,a),e.vertexShader=e.vertexShader.replace("#include <fog_pars_vertex>","\n        #include <fog_pars_vertex>\n        varying vec3 vWPosition;\n      "),e.vertexShader=e.vertexShader.replace("#include <fog_vertex>","\n        #include <fog_vertex>\n        vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;\n      "),e.fragmentShader=e.fragmentShader.replace("#include <normalmap_pars_fragment>","\n        #include <normalmap_pars_fragment>\n\n        uniform float time;\n        uniform float ripplesSpeed;\n        uniform float ripplesScale;\n      \n        varying vec3 vWPosition;\n      \n        vec4 getNoise(vec2 uv){\n          float timeOffset = time * ripplesSpeed;\n          uv = (uv - 0.5) * (1.0 / ripplesScale);\n          vec2 uv0 = (uv/103.0)+vec2(timeOffset/17.0, timeOffset/29.0);\n          vec2 uv1 = uv/107.0-vec2(timeOffset/-19.0, timeOffset/31.0);\n          vec2 uv2 = uv/vec2(897.0, 983.0)+vec2(timeOffset/101.0, timeOffset/97.0);\n          vec2 uv3 = uv/vec2(991.0, 877.0)-vec2(timeOffset/109.0, timeOffset/-113.0);\n          vec4 noise = (texture2D(normalMap, uv0)) +\n                       (texture2D(normalMap, uv1)) +\n                       (texture2D(normalMap, uv2)) +\n                       (texture2D(normalMap, uv3));\n          return noise / 4.0;\n        }\n      "),e.fragmentShader=e.fragmentShader.replace("#include <normal_fragment_maps>","\n          // Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n          vec3 eye_pos = -vViewPosition;\n          vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n          vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n          vec2 st0 = dFdx( vUv.st );\n          vec2 st1 = dFdy( vUv.st );\n\n          float scale = sign( st1.t * st0.s - st0.t * st1.s ); // we do not care about the magnitude\n\n          vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n          vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n          vec3 N = normalize( normal );\n          mat3 tsn = mat3( S, T, N );\n\n          vec3 mapN = getNoise(vWPosition.xz).xyz * 2.0 - 1.0;\n\n          mapN.xy *= normalScale;\n          mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n          normal = normalize( tsn * mapN );\n        ")},super(n,o),this.lowQuality=i,this.waterUniforms=a,i?this.material.specular.set(16777215):this.receiveShadow=!0,this.geometry.attributes.position.dynamic=!0,this.resolution=t,this.octaves=[new pe(new de(.5,.5),new de(1,1),.01,!0),new pe(new de(.05,6),new de(1,20),.1,!1)],this.simplex=new se.a}get opacity(){return this.material.opacity}set opacity(e){this.material.opacity=e,1!==e&&(this.material.transparent=!0)}get color(){return this.material.color}get tideHeight(){return this.octaves[0].height}get tideScale(){return this.octaves[0].scale}get tideSpeed(){return this.octaves[0].speed}set tideHeight(e){this.octaves[0].height=e}get waveHeight(){return this.octaves[1].height}set waveHeight(e){this.octaves[1].height=e}get waveScale(){return this.octaves[1].scale}get waveSpeed(){return this.octaves[1].speed}set ripplesSpeed(e){this.waterUniforms.ripplesSpeed.value=e}get ripplesSpeed(){return this.waterUniforms.ripplesSpeed.value}set ripplesScale(e){this.waterUniforms.ripplesScale.value=e}get ripplesScale(){return this.waterUniforms.ripplesScale.value}update(e){const t=this.geometry.attributes.position;for(let i=0;i<=this.resolution;i++)for(let n=0;n<=this.resolution;n++){let a=0;for(let t=0;t<this.octaves.length;t++){const s=this.octaves[t];if(s.alternate){const t=this.simplex.noise(i*s.scale.x/this.resolution,n*s.scale.y/this.resolution);a+=Math.cos(t+s.speed.length()*e)*s.height}else{a+=(this.simplex.noise((i*s.scale.x+e*s.speed.x)/this.resolution,(n*s.scale.y+e*s.speed.y)/this.resolution)-.5)*s.height}}t.setY(i*(this.resolution+1)+n,a)}this.geometry.computeVertexNormals(),t.needsUpdate=!0,this.waterUniforms.time.value=e}clone(e){return new me(this.material.normalMap,this.resolution,this.lowQuality).copy(this,e)}copy(e,t=!0){return super.copy(e,t),this.opacity=e.opacity,this.color.copy(e.color),this.tideHeight=e.tideHeight,this.tideScale.copy(e.tideScale),this.tideSpeed.copy(e.tideSpeed),this.waveHeight=e.waveHeight,this.waveScale.copy(e.waveScale),this.waveSpeed.copy(e.waveSpeed),this.ripplesSpeed=e.ripplesSpeed,this.ripplesScale=e.ripplesScale,this}}function ge(e,t){return e&&t&&e.x===t.x&&e.y===t.y}let fe=null;AFRAME.registerComponent("simple-water",{schema:{opacity:{type:"number",default:1},color:{type:"color"},tideHeight:{type:"number",default:.01},tideScale:{type:"vec2",default:{x:1,y:1}},tideSpeed:{type:"vec2",default:{x:.5,y:.5}},waveHeight:{type:"number",default:.1},waveScale:{type:"vec2",default:{x:1,y:20}},waveSpeed:{type:"vec2",default:{x:.05,y:6}},ripplesScale:{type:"number",default:1},ripplesSpeed:{type:"number",default:.25}},init(){fe||(fe=(new he).load(te.a)),this.water=new me(fe,void 0,window.APP&&"low"===window.APP.quality),this.el.setObject3D("mesh",this.water)},update(e){this.data.opacity!==e.opacity&&(this.water.opacity=this.data.opacity),this.data.color!==e.color&&this.water.color.set(this.data.color),this.data.tideHeight!==e.tideHeight&&(this.water.tideHeight=this.data.tideHeight),ge(this.data.tideScale,e.tideScale)||this.water.tideScale.copy(this.data.tideScale),ge(this.data.tideSpeed,e.tideSpeed)||this.water.tideSpeed.copy(this.data.tideSpeed),this.data.waveHeight!==e.waveHeight&&(this.water.waveHeight=this.data.waveHeight),ge(this.data.waveScale,e.waveScale)||this.water.waveScale.copy(this.data.waveScale),ge(this.data.waveSpeed,e.waveSpeed)||this.water.waveSpeed.copy(this.data.waveSpeed),this.data.ripplesScale!==e.ripplesScale&&(this.water.ripplesScale=this.data.ripplesScale),this.data.ripplesSpeed!==e.ripplesSpeed&&(this.water.ripplesSpeed=this.data.ripplesSpeed)},tick(e){this.water.update(e/1e3)},remove(){this.el.removeObject3D("mesh")}});i(165),i(356),i(357);var ve=i(300),be=i(96);function ye(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}const _e=new URL(i.n(be).a,window.location.href).href;AFRAME.registerComponent("particle-emitter",{schema:{resolve:{type:"boolean",default:!0},src:{type:"string",default:_e},startColor:{type:"color"},middleColor:{type:"color"},endColor:{type:"color"},startOpacity:{type:"number",default:1},middleOpacity:{type:"number",default:1},endOpacity:{type:"number",default:1},colorCurve:{type:"string",default:"linear"},sizeCurve:{type:"string",default:"linear"},startSize:{type:"number",default:1},endSize:{type:"number",default:1},sizeRandomness:{type:"number"},ageRandomness:{type:"number"},lifetime:{type:"number",default:1},lifetimeRandomness:{type:"number"},particleCount:{type:"number",default:10},startVelocity:{type:"vec3",default:{x:0,y:0,z:1}},endVelocity:{type:"vec3",default:{x:0,y:0,z:1}},velocityCurve:{type:"string",default:"linear"},angularVelocity:{type:"number"}},init(){this.particleEmitter=new ve.a(null),this.particleEmitter.visible=!1,this.el.setObject3D("particle-emitter",this.particleEmitter),this.updateParticles=!1,this.data.src===_e&&(this.data.resolve=!1)},setTexture(e,t){var i,n=this;return(i=function*(){let i=e;if(t){let t=(yield Object(g.k)(e)).origin;t.startsWith("//")&&(t=location.protocol+t),i=Object(f.i)(t)}const a=new THREE.Texture;yield g.l.loadTextureAsync(a,i),n.data.src===e&&(n.particleEmitter.material.uniforms.map.value=a,n.particleEmitter.visible=!0,n.updateParticles=!0)},function(){var e=this,t=arguments;return new Promise(function(n,a){var s=i.apply(e,t);function o(e){ye(s,n,a,o,r,"next",e)}function r(e){ye(s,n,a,o,r,"throw",e)}o(void 0)})})()},update(e){const t=this.data,i=this.particleEmitter;e.src!==t.src&&this.setTexture(t.src,t.resolve).catch(console.error),e.startColor===t.startColor&&e.startSize===t.startSize&&e.sizeRandomness===t.sizeRandomness&&e.ageRandomness===t.ageRandomness&&e.lifetime===t.lifetime&&e.lifetimeRandomness===t.lifetimeRandomness&&e.particleCount===t.particleCount||(this.updateParticles=!0),i.startColor.set(t.startColor),i.middleColor.set(t.middleColor),i.endColor.set(t.endColor),i.startOpacity=t.startOpacity,i.middleOpacity=t.middleOpacity,i.endOpacity=t.endOpacity,i.colorCurve=t.colorCurve,i.sizeCurve=t.sizeCurve,i.startSize=t.startSize,i.endSize=t.endSize,i.sizeRandomness=t.sizeRandomness,i.ageRandomness=t.ageRandomness,i.lifetime=t.lifetime,i.lifetimeRandomness=t.lifetimeRandomness,i.particleCount=t.particleCount,i.startVelocity.copy(t.startVelocity),i.endVelocity.copy(t.endVelocity),i.velocityCurve=t.velocityCurve,i.angularVelocity=t.angularVelocity},tick(e,t){this.updateParticles&&(this.particleEmitter.updateParticles(),this.updateParticles=!1),this.particleEmitter.visible&&this.particleEmitter.update(t/1e3)}})},function(e,t,i){"use strict";i(81);function n(e,t,i){const n=i[e];if(!n)throw new Error(`Component "${e}" is not public.`);const a=n.publicProperties[t];if(!a)throw new Error(`Component "${e}"'s property "${t}" is not public.`);return{mappedComponent:n.mappedComponent,mappedProperty:a.mappedProperty,getMappedValue:a.getMappedValue}}var a=i(13);function s(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}const o=i(111).COLLISION_LAYERS;function r(e){AFRAME.GLTFModelPlus.registerComponent(e,e,(e,t,i)=>{const n=AFRAME.scenes[0];n.setAttribute(t,i),n.addEventListener("reset_scene",()=>{n.removeAttribute(t)},{once:!0})})}function l(e,t,i,n){return c.apply(this,arguments)}function c(){var e;return e=function*(e,t,i,n){let a=!0;if(n.networked){const s="video"===t||"audio"===t,o=(a=i.controls||"link"===t)||s?"#static-controlled-media":"#static-media";e.setAttribute("networked",{template:o,owner:"scene",persistent:!0,networkId:n.networked.id})}const s={};"video"!==t&&"image"!==t||(s.projection=i.projection),"video"!==t&&"audio"!==t||(s.videoPaused=!i.autoPlay,s.volume=i.volume,s.loop=i.loop,s.audioType=i.audioType,s.hidePlaybackControls=!a,"pannernode"===i.audioType&&(s.distanceModel=i.distanceModel,s.rolloffFactor=i.rolloffFactor,s.refDistance=i.refDistance,s.maxDistance=i.maxDistance,s.coneInnerAngle=i.coneInnerAngle,s.coneOuterAngle=i.coneOuterAngle,s.coneOuterGain=i.coneOuterGain),e.setAttribute("video-pause-state",{paused:s.videoPaused}));const o="link"===t?i.href:i.src;e.setAttribute("media-loader",{src:o,fitToBox:!0,resolve:!0,fileIsOwned:!0,animate:!1,mediaOptions:s})},(c=function(){var t=this,i=arguments;return new Promise(function(n,a){var o=e.apply(t,i);function r(e){s(o,n,a,r,l,"next",e)}function l(e){s(o,n,a,r,l,"throw",e)}r(void 0)})}).apply(this,arguments)}r("fog"),r("background"),AFRAME.GLTFModelPlus.registerComponent("duck","duck"),AFRAME.GLTFModelPlus.registerComponent("quack","quack"),AFRAME.GLTFModelPlus.registerComponent("sound","sound"),AFRAME.GLTFModelPlus.registerComponent("css-class","css-class"),AFRAME.GLTFModelPlus.registerComponent("interactable","css-class",(e,t)=>{e.setAttribute(t,"interactable")}),AFRAME.GLTFModelPlus.registerComponent("super-spawner","super-spawner",(e,t,i)=>{e.setAttribute("is-remote-hover-target",""),e.setAttribute("tags",{isHandCollisionTarget:!0}),e.setAttribute("hoverable-visuals",""),e.setAttribute(t,i)}),AFRAME.GLTFModelPlus.registerComponent("gltf-model-plus","gltf-model-plus"),AFRAME.GLTFModelPlus.registerComponent("media-loader","media-loader"),AFRAME.GLTFModelPlus.registerComponent("body","body-helper",e=>{e.setAttribute("body-helper",{mass:0,type:a.TYPE.STATIC,collisionFilterGroup:o.INTERACTABLES,collisionFilterMask:o.DEFAULT_SPAWNER})}),AFRAME.GLTFModelPlus.registerComponent("ammo-shape","shape-helper"),AFRAME.GLTFModelPlus.registerComponent("hide-when-quality","hide-when-quality"),AFRAME.GLTFModelPlus.registerComponent("light","light",(e,t,i)=>{0===i.distance&&(i.decay=0),e.setAttribute(t,i),i.castShadow&&setTimeout(()=>{e.components.light.light.shadow.camera.matrixNeedsUpdate=!0},0)}),AFRAME.GLTFModelPlus.registerComponent("ambient-light","ambient-light"),AFRAME.GLTFModelPlus.registerComponent("directional-light","directional-light"),AFRAME.GLTFModelPlus.registerComponent("hemisphere-light","hemisphere-light"),AFRAME.GLTFModelPlus.registerComponent("point-light","point-light"),AFRAME.GLTFModelPlus.registerComponent("spot-light","spot-light"),AFRAME.GLTFModelPlus.registerComponent("simple-water","simple-water"),AFRAME.GLTFModelPlus.registerComponent("skybox","skybox"),AFRAME.GLTFModelPlus.registerComponent("layers","layers"),AFRAME.GLTFModelPlus.registerComponent("shadow","shadow"),AFRAME.GLTFModelPlus.registerComponent("water","water"),AFRAME.GLTFModelPlus.registerComponent("scale-audio-feedback","scale-audio-feedback"),AFRAME.GLTFModelPlus.registerComponent("morph-audio-feedback","morph-audio-feedback"),AFRAME.GLTFModelPlus.registerComponent("animation-mixer","animation-mixer"),AFRAME.GLTFModelPlus.registerComponent("loop-animation","loop-animation"),AFRAME.GLTFModelPlus.registerComponent("box-collider","shape-helper",(()=>{const e=new THREE.Euler;return(t,i,n)=>{const{scale:s,rotation:o}=n;e.set(o.x,o.y,o.z);const r=(new THREE.Quaternion).setFromEuler(e);t.setAttribute(i,{type:a.SHAPE.BOX,fit:a.FIT.MANUAL,offset:n.position,halfExtents:{x:s.x/2,y:s.y/2,z:s.z/2},orientation:r})}})()),AFRAME.GLTFModelPlus.registerComponent("visible","visible",(e,t,i)=>{"object"==typeof i?e.setAttribute(t,i.visible):e.setAttribute(t,i)}),AFRAME.GLTFModelPlus.registerComponent("spawn-point","spawn-point",e=>{e.setAttribute("waypoint",{canBeSpawnPoint:!0,canBeOccupied:!1,canBeClicked:!1,willDisableMotion:!1,willDisableTeleporting:!1,willMaintainWorldUp:!0})}),AFRAME.GLTFModelPlus.registerComponent("sticky-zone","sticky-zone"),AFRAME.GLTFModelPlus.registerComponent("nav-mesh","nav-mesh",(e,t,i)=>{const n=AFRAME.scenes[0].systems.nav,a=i.zone||"character";let s=!1;e.object3D.traverse(e=>{e.isMesh&&!s&&(s=!0,n.loadMesh(e,a))}),e.setAttribute("nav-mesh")}),AFRAME.GLTFModelPlus.registerComponent("pinnable","pinnable"),AFRAME.GLTFModelPlus.registerComponent("waypoint","waypoint",(e,t,i,n)=>{i.canBeOccupied&&e.setAttribute("networked",{template:"#template-waypoint-avatar",attachTemplateToLocal:!1,owner:"scene",persistent:!0,networkId:n.networked.id}),e.setAttribute("waypoint",i)}),AFRAME.GLTFModelPlus.registerComponent("media","media",(e,t,i)=>{i.id&&e.setAttribute("networked",{template:"#interactable-media",owner:"scene",persistent:!0,networkId:i.id});const n={src:i.src,fitToBox:!i.contentSubtype,resolve:!0,fileIsOwned:!0,animate:!1,contentSubtype:i.contentSubtype};i.version&&(n.version=i.version),e.setAttribute("media-loader",n),i.pageIndex&&(e.setAttribute("media-pdf",{index:i.pageIndex}),e.setAttribute("media-pager",{index:i.pageIndex})),void 0!==i.paused&&e.setAttribute("media-video",{videoPaused:i.paused}),i.time&&e.setAttribute("media-video",{time:i.time})}),AFRAME.GLTFModelPlus.registerComponent("image","image",l),AFRAME.GLTFModelPlus.registerComponent("audio","audio",l,(e,t,i)=>"paused"===t?{name:"video-pause-state",property:t,value:i}:null),AFRAME.GLTFModelPlus.registerComponent("video","video",l,(e,t,i)=>"paused"===t?{name:"video-pause-state",property:t,value:i}:null),AFRAME.GLTFModelPlus.registerComponent("link","link",l),AFRAME.GLTFModelPlus.registerComponent("hoverable","is-remote-hover-target",e=>{e.setAttribute("is-remote-hover-target",""),e.setAttribute("tags",{isHandCollisionTarget:!0})}),AFRAME.GLTFModelPlus.registerComponent("spawner","spawner",(e,t,i)=>{e.setAttribute("media-loader",{src:i.src,resolve:!0,fileIsOwned:!0,animate:!1}),e.setAttribute("css-class","interactable"),e.setAttribute("super-spawner",{src:i.src,resolve:!0,template:"#interactable-media"}),e.setAttribute("hoverable-visuals",""),e.setAttribute("body-helper",{mass:0,type:a.TYPE.STATIC,collisionFilterGroup:o.INTERACTABLES,collisionFilterMask:o.DEFAULT_SPAWNER}),e.setAttribute("is-remote-hover-target",""),e.setAttribute("tags",{isHandCollisionTarget:!0})});const d={video:{mappedComponent:"video-pause-state",publicProperties:{paused:{mappedProperty:"paused",getMappedValue:e=>!!e}}},"loop-animation":{mappedComponent:"loop-animation",publicProperties:{paused:{mappedProperty:"paused",getMappedValue:e=>!!e}}}};AFRAME.GLTFModelPlus.registerComponent("trigger-volume","trigger-volume",(e,t,i,a,s)=>{const{size:o,target:r,enterComponent:l,enterProperty:c,enterValue:h,leaveComponent:u,leaveProperty:p,leaveValue:m}=i;let g,f,v;try{if(g=n(l,c,d),f=n(u,p,d),!(v=s[r]))throw new Error(`Couldn't find target entity with index: ${r}.`)}catch(e){return void console.warn(`Error inflating gltf component "trigger-volume": ${e.message}`)}e.setAttribute("trigger-volume",{colliders:"#avatar-pov-node",size:o,target:v,enterComponent:g.mappedComponent,enterProperty:g.mappedProperty,enterValue:g.getMappedValue(h),leaveComponent:f.mappedComponent,leaveProperty:f.mappedProperty,leaveValue:f.getMappedValue(m)})}),AFRAME.GLTFModelPlus.registerComponent("heightfield","heightfield",(e,t,i)=>{e.setAttribute("shape-helper__heightfield",{type:a.SHAPE.HEIGHTFIELD,margin:.01,fit:a.FIT.MANUAL,heightfieldDistance:i.distance,offset:i.offset,heightfieldData:i.data})}),AFRAME.GLTFModelPlus.registerComponent("trimesh","trimesh",e=>{e.setAttribute("shape-helper__trimesh",{type:a.SHAPE.MESH,margin:.01,fit:a.FIT.ALL,includeInvisible:!0})}),AFRAME.GLTFModelPlus.registerComponent("particle-emitter","particle-emitter"),AFRAME.GLTFModelPlus.registerComponent("networked-drawing-buffer","networked-drawing-buffer"),AFRAME.GLTFModelPlus.registerComponent("audio-settings","audio-settings",(e,t,i)=>{e.sceneEl.systems["hubs-systems"].audioSettingsSystem.updateAudioSettings(i)})},,,,function(e,t,i){e.exports={"loading-text":"loader__loading-text__QVcF3",loadingText:"loader__loading-text__QVcF3"}},function(e,t,i){e.exports=i.p+"assets/images/giphy_logo-e4fe68503ab5d004deb31e43636a0a7c.png"},,,function(e){e.exports={meta:{image:"sprite-system-action-spritesheet.png",size:{w:1024,h:1024},scale:"1"},frames:{"angry-off.png":{frame:{x:8,y:8,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"angry-on-hover.png":{frame:{x:154,y:8,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"angry-on.png":{frame:{x:8,y:154,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"disgust-off.png":{frame:{x:154,y:154,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"disgust-on-hover.png":{frame:{x:300,y:8,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"disgust-on.png":{frame:{x:300,y:154,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"eww-off.png":{frame:{x:8,y:300,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"eww-on-hover.png":{frame:{x:154,y:300,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"eww-on.png":{frame:{x:300,y:300,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"happy-off.png":{frame:{x:446,y:8,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"happy-on-hover.png":{frame:{x:446,y:154,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"happy-on.png":{frame:{x:446,y:300,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"hearts-off.png":{frame:{x:8,y:446,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"hearts-on-hover.png":{frame:{x:154,y:446,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"hearts-on.png":{frame:{x:300,y:446,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"sad-off.png":{frame:{x:446,y:446,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"sad-on-hover.png":{frame:{x:592,y:8,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"sad-on.png":{frame:{x:592,y:154,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"smile-off.png":{frame:{x:592,y:300,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"smile-on-hover.png":{frame:{x:592,y:446,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"smile-on.png":{frame:{x:8,y:592,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"surprise-off.png":{frame:{x:154,y:592,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"surprise-on-hover.png":{frame:{x:300,y:592,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"surprise-on.png":{frame:{x:446,y:592,w:130,h:130},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:130,h:130},sourceSize:{w:130,h:130}},"mod-badge.png":{frame:{x:592,y:592,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"recording-badge.png":{frame:{x:738,y:8,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"spawn-disabled.png":{frame:{x:738,y:152,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"spawn-hover.png":{frame:{x:738,y:296,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"spawn.png":{frame:{x:738,y:440,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"Background.png":{frame:{x:738,y:584,w:128,h:48},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:48},sourceSize:{w:128,h:48}},"camera-action.png":{frame:{x:738,y:648,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"close-action.png":{frame:{x:8,y:738,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"deserialize-action.png":{frame:{x:88,y:738,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"drop-action.png":{frame:{x:168,y:738,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"inspect-action.png":{frame:{x:248,y:738,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"mute-action.png":{frame:{x:328,y:738,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"next.png":{frame:{x:408,y:738,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"pin-action.png":{frame:{x:488,y:738,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"prev.png":{frame:{x:568,y:738,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"recenter-action.png":{frame:{x:648,y:738,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"record-action-alpha.png":{frame:{x:728,y:738,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"record-action.png":{frame:{x:882,y:8,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"remove-action.png":{frame:{x:882,y:88,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"rotate-action.png":{frame:{x:882,y:168,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"scale-action.png":{frame:{x:882,y:248,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"serialize-action.png":{frame:{x:882,y:328,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"snap-page.png":{frame:{x:882,y:408,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"spawn_message.png":{frame:{x:882,y:488,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"spawn_message_dark-hover.png":{frame:{x:882,y:568,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"spawn_message_dark.png":{frame:{x:882,y:648,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"stop-action.png":{frame:{x:882,y:728,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"undo-action.png":{frame:{x:8,y:818,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"unmute-action.png":{frame:{x:88,y:818,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){e.exports=i.p+"assets/images/emojis/emoji_0-902121d77164d8da8f8dd09d7a9ed761.png"},function(e,t,i){e.exports=i.p+"assets/images/emojis/emoji_1-7d6e0cd0fcf8476aa9773da9bb53e399.png"},function(e,t,i){e.exports=i.p+"assets/images/emojis/emoji_2-810f2d13cb607c120556d95765b8b21d.png"},function(e,t,i){e.exports=i.p+"assets/images/emojis/emoji_3-5d247ddca0eccab1da6d29b030181195.png"},function(e,t,i){e.exports=i.p+"assets/images/emojis/emoji_4-b1e61ff7ce3ac7aa29e92ab3fd5987c5.png"},function(e,t,i){e.exports=i.p+"assets/images/emojis/emoji_5-1f8e9d84efb84989cd717fc147a80a9d.png"},function(e,t,i){e.exports=i.p+"assets/images/emojis/emoji_6-bd090b380b4bde4f23a3b10040eb5623.png"},function(e,t,i){e.exports=i.p+"assets/models/emojis/emoji_0-f3f46448f25bc1d8599c39fc43fc3430.glb"},function(e,t,i){e.exports=i.p+"assets/models/emojis/emoji_1-99633c94256b7520f7833921094bedfe.glb"},function(e,t,i){e.exports=i.p+"assets/models/emojis/emoji_2-4531e5b1d197a14e76c8d47894b62db0.glb"},function(e,t,i){e.exports=i.p+"assets/models/emojis/emoji_3-167102458af413f37fc62cd5b201a010.glb"},function(e,t,i){e.exports=i.p+"assets/models/emojis/emoji_4-834ee3738e00e03227ff45809c6f2fe8.glb"},function(e,t,i){e.exports=i.p+"assets/models/emojis/emoji_5-b2763de169ccdb200ec5e8503170079d.glb"},function(e,t,i){e.exports=i.p+"assets/models/emojis/emoji_6-6df1120c791dabb88d6b1ada0d8f973d.glb"},,function(e,t){e.exports="data:image/gif;base64,R0lGODlhEAAQAIQaAAAAAAEBAQABBQEBAgEBBQMDAwAykwBk+wFk+/85Af47AwCIHgCJHgGJHgCKHgOJIPc63vc64Pc64YeHhwDySLu7wru8wru8w7y8wwD6/v///////////////////////yH+EUNyZWF0ZWQgd2l0aCBHSU1QACH5BAEKAB8ALAAAAAAQABAAAAVl4AeMZDl9KAqkLDqd6YrN9HzC4jdbTUPDMBnGQWEAKphBYKTSYR6LRQE5y+VmlUAAc+lWrMIa4nBYxXQJcabMkkUUtLGhJZNA4BiC4HyVSCJpKRhgOktmgoRVLDSELY5mTHQlKyEAOw=="},function(e,t,i){e.exports=i.p+"assets/images/audio-0205471a2825b8450c63e45f83436997.png"},,function(e,t,i){e.exports=i.p+"assets/camera_tool-a25d0894a6b635779bd4ed41f2de0411.glb"},,function(e,t,i){e.exports=i.p+"assets/images/mic_granted-5d41c8098b2c1a084f07dd3a2473983f.png"},function(e,t,i){e.exports=i.p+"assets/images/mic_granted@2x-f84d9eb002832eeeb768529e6cb1e93e.png"},function(e,t,i){e.exports=i.p+"assets/images/mic_small-b81b3397cc985eb8d3d67a4f007158cc.png"},function(e,t,i){e.exports=i.p+"assets/images/mic_small@2x-d04ff548fa26495f69249f0c34f44b72.png"},function(e,t,i){e.exports=i.p+"assets/images/add-owner-c3f352da151b4a5be71defd565720235.png"},function(e,t,i){e.exports=i.p+"assets/images/remove-owner-02b96ad3a84badda798fde00ac4c2243.png"},function(e,t){e.exports='<svg viewBox="0 0 70 70" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="path-1-inside-1" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M28 17C25.2386 17 23 19.2386 23 22V50C23 52.7614 25.2386 55 28 55H43C45.7614 55 48 52.7614 48 50V22C48 19.2386 45.7614 17 43 17H28ZM45 21H26V46H45V21Z"></path></mask><path d="M26 21V18H23V21H26ZM45 21H48V18H45V21ZM26 46H23V49H26V46ZM45 46V49H48V46H45ZM26 22C26 20.8954 26.8954 20 28 20V14C23.5817 14 20 17.5817 20 22H26ZM26 50V22H20V50H26ZM28 52C26.8954 52 26 51.1046 26 50H20C20 54.4183 23.5817 58 28 58V52ZM43 52H28V58H43V52ZM45 50C45 51.1046 44.1046 52 43 52V58C47.4183 58 51 54.4183 51 50H45ZM45 22V50H51V22H45ZM43 20C44.1046 20 45 20.8954 45 22H51C51 17.5817 47.4183 14 43 14V20ZM28 20H43V14H28V20ZM26 24H45V18H26V24ZM29 46V21H23V46H29ZM45 43H26V49H45V43ZM42 21V46H48V21H42Z" fill="currentColor" mask="url(#path-1-inside-1)"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 70 70" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="25" y="52" width="20" height="3" fill="currentColor"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M17 18C15.3431 18 14 19.3431 14 21V49C14 50.6569 15.3431 52 17 52H52C53.6569 52 55 50.6569 55 49V21C55 19.3431 53.6569 18 52 18H17ZM50 24H19V46H50V24Z" fill="currentColor"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 70 70" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M56.1704 22H16.7123C15.2406 22 14 23.226 14 24.7381V47.2622C14 48.7742 15.2406 50 16.7711 50H27.5496C28.7053 50 29.6958 49.3015 30.112 48.3081L33.2462 40.8289C33.7747 39.5677 35.0324 38.6805 36.5 38.6805C37.9676 38.6805 39.2253 39.5677 39.7538 40.8289L42.888 48.3081C43.3042 49.3015 44.2947 50 45.3916 50H56.1704C57.7594 50 59 48.7742 59 47.2622V24.7381C59 23.226 57.7594 22 56.1704 22ZM26.294 40.9274C23.5369 40.9274 21.3046 38.7226 21.3046 36C21.3046 33.2774 23.5369 31.0729 26.294 31.0729C29.0507 31.0729 31.2785 33.2774 31.2785 36C31.2785 38.7226 29.0459 40.9274 26.294 40.9274ZM46.7086 40.9251C43.9531 40.9251 41.7215 38.7214 41.7215 36C41.7215 33.2789 43.9531 31.0751 46.7086 31.0751C49.4641 31.0751 51.6957 33.2789 51.6957 36C51.6957 38.7214 49.4641 40.9251 46.7086 40.9251Z" fill="currentColor"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 90 90" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M88.5 45C88.5 69.0244 69.0244 88.5 45 88.5C20.9756 88.5 1.5 69.0244 1.5 45C1.5 20.9756 20.9756 1.5 45 1.5C69.0244 1.5 88.5 20.9756 88.5 45Z" fill="currentColor" stroke="white" stroke-width="3"></path><path opacity="0.995697" d="M14 4.5H31C36.2467 4.5 40.5 8.75329 40.5 14C40.5 19.2467 36.2467 23.5 31 23.5H14C8.75329 23.5 4.5 19.2467 4.5 14C4.5 8.75329 8.75329 4.5 14 4.5Z" transform="translate(22 32)" fill="currentColor" fill-opacity="0.01" stroke="white" stroke-width="9"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 70 70" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M36.9396 28.0771L36.9407 28.0791L42.6084 23.8706L36.9396 28.0771ZM46.1453 21.2459L46.2056 21.2012C44.9645 13.4303 37.2392 10.5728 32.3743 12.3211C29.6618 13.2959 27.4228 15.8722 27.7725 19.6208C28.5866 19.9334 29.4993 20.3901 30.4405 20.988C29.7485 20.5556 29.02 20.1659 28.2565 19.8237C28.2326 19.8128 28.2068 19.8013 28.1798 19.7896L28.136 19.7706L28.0937 19.7526C27.9853 19.7068 27.8689 19.6597 27.7781 19.623L28.9614 31.0567L28.9592 31.0566L27.7733 19.6278C20.4643 16.8238 13.9753 21.995 13.0476 27.1085C12.5303 29.9594 13.7032 33.2419 17.1044 34.8115C17.1982 34.7357 17.2955 34.6596 17.3959 34.5834C17.2963 34.6596 17.1885 34.7455 17.1049 34.8122L27.5308 39.4958L17.1057 34.8158C11.0378 39.7828 12.272 48.063 16.2093 51.4281C18.4026 53.3028 21.7772 53.8141 24.8267 51.6413C24.8271 51.6437 24.8274 51.646 24.8278 51.6483C26.0717 59.4153 33.7589 62.5507 38.6227 60.8028C41.3351 59.828 43.5405 57.1432 43.1908 53.3947L43.1887 53.3938L42.0629 41.9876C42.8049 42.023 43.5494 42.0128 44.2918 41.9565C43.5693 42.013 42.8273 42.0263 42.0704 41.9884L43.1917 53.3903C50.5007 56.1943 57.0086 51.0182 57.9363 45.9048C58.4531 43.0563 57.261 39.8491 53.8666 38.2781L53.8726 38.2733L53.8813 38.2772C59.9492 33.3103 58.733 25.03 54.7957 21.6649C52.6011 19.7892 49.2551 19.0298 46.2043 21.2065L46.204 21.2049L46.1453 21.2459ZM24.7381 50.8659C24.6885 50.2898 24.6664 49.7171 24.6708 49.1492C24.6627 49.7549 24.6868 50.3301 24.7381 50.8659ZM26.4947 41.3573C26.7594 40.8103 27.0509 40.2765 27.3679 39.7576C27.0437 40.2833 26.7535 40.8179 26.4947 41.3573ZM35.899 47.811C35.2143 46.9425 34.5955 45.9912 34.0836 44.9638L34.0848 44.9629C34.6027 45.966 35.2091 46.9197 35.899 47.811ZM42.77 53.2217L42.8006 53.2352L42.838 53.2515C42.3392 53.0395 41.811 52.7758 41.2672 52.4623C41.7518 52.7362 42.2529 52.9898 42.77 53.2217ZM53.4572 38.5906C52.3548 39.3893 51.1917 40.0449 49.9897 40.5607C51.3569 39.983 52.5339 39.2898 53.4572 38.5906ZM46.1688 26.3694L46.1608 26.4207L46.1521 26.476C46.2432 25.8756 46.3047 25.2674 46.3351 24.6529C46.3103 25.2118 46.2582 25.786 46.1688 26.3694ZM46.2315 21.5027C46.252 21.7142 46.2709 21.9316 46.2875 22.1546C46.2786 22.0527 46.2688 21.9506 46.2582 21.8485C46.2556 21.8247 46.253 21.7961 46.2504 21.7643L46.2478 21.7306L46.243 21.6663L46.2363 21.5711L46.2315 21.5027ZM36.7446 27.7097C36.2049 26.7199 35.5771 25.7805 34.8671 24.9054C35.5604 25.7504 36.1988 26.6857 36.7446 27.7097ZM28.5085 31.0408C27.3591 31.0152 26.205 31.0989 25.0634 31.2945C26.1819 31.0909 27.3412 30.9931 28.5085 31.0408ZM18.1473 34.0527C18.0911 34.0902 18.0351 34.128 17.9792 34.1662C17.9387 34.1939 17.8983 34.2218 17.858 34.2498C17.7852 34.3004 17.7128 34.3516 17.6405 34.4034C17.5975 34.4343 17.5545 34.4654 17.5117 34.4967L17.5087 34.4989C17.7096 34.35 17.9229 34.2008 18.1473 34.0527Z" fill="url(#paint0_radial)"></path><path opacity="0.65" fill-rule="evenodd" clip-rule="evenodd" d="M28.9603 31.0463L27.7733 19.6074C20.4643 16.8034 13.9753 21.9747 13.0476 27.0881C12.5303 29.939 13.7032 33.2215 17.1044 34.7911C19.5285 32.8327 24.2134 30.6976 28.9603 31.0463Z" fill="url(#paint1_radial)"></path><path opacity="0.65" fill-rule="evenodd" clip-rule="evenodd" d="M27.532 39.4763L17.1056 34.7954C11.0378 39.7623 12.272 48.0426 16.2093 51.4077C18.4045 53.2839 21.7828 53.7945 24.8343 51.6155C24.3519 48.5236 24.8343 43.6784 27.532 39.4763Z" fill="url(#paint2_radial)"></path><path opacity="0.65" fill-rule="evenodd" clip-rule="evenodd" d="M34.0831 44.9423L24.8273 51.6222C26.0684 59.3932 33.7578 62.5307 38.6228 60.7824C41.3352 59.8076 43.5405 57.1228 43.1909 53.3743C40.3075 52.2601 36.2428 49.2778 34.0831 44.9423Z" fill="url(#paint3_radial)"></path><path opacity="0.65" fill-rule="evenodd" clip-rule="evenodd" d="M42.0704 41.968L43.1917 53.3699C50.5007 56.1739 57.0086 50.9978 57.9363 45.8844C58.4536 43.0334 57.259 39.8232 53.8578 38.2536C51.5074 40.1955 47.1197 42.221 42.0704 41.968Z" fill="url(#paint4_radial)"></path><path opacity="0.65" fill-rule="evenodd" clip-rule="evenodd" d="M43.4933 33.5267L53.8813 38.2568C59.9492 33.2899 58.733 25.0096 54.7957 21.6445C52.6005 19.7683 49.2533 19.0089 46.2018 21.1879C46.3564 22.6597 46.4588 24.4579 46.1687 26.349C45.8099 28.6889 44.997 31.1531 43.4933 33.5267Z" fill="url(#paint5_radial)"></path><path opacity="0.65" fill-rule="evenodd" clip-rule="evenodd" d="M36.9358 28.0596L46.2056 21.1809C44.9645 13.4099 37.2392 10.5524 32.3742 12.3008C29.6618 13.2755 27.4228 15.8519 27.7725 19.6004C30.6226 20.6949 34.6806 23.5543 36.9358 28.0596Z" fill="url(#paint6_radial)"></path><defs><radialGradient id="paint0_radial" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(17.6669 15.2447) rotate(53.2605) scale(49.8783 48.801)"><stop stop-color="#F5F5F5"></stop><stop offset="0.412807" stop-color="#ff3464"></stop><stop offset="1" stop-color="#DBDBDB"></stop></radialGradient><radialGradient id="paint1_radial" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(19.3019 36.2829) rotate(-103.017) scale(10.8394 10.8734)"><stop stop-color="$ff3464"></stop><stop offset="1" stop-color="#ff3464" stop-opacity="0.01"></stop></radialGradient><radialGradient id="paint2_radial" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(27.1801 50.5029) rotate(-163.042) scale(10.7545 10.9388)"><stop stop-color="#ff3464"></stop><stop offset="1" stop-color="#ff3464" stop-opacity="0.01"></stop></radialGradient><radialGradient id="paint3_radial" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(43.3906 50.7488) rotate(136.694) scale(10.7723 10.8964)"><stop stop-color="#ff3464"></stop><stop offset="1" stop-color="#ff3464" stop-opacity="0.01"></stop></radialGradient><radialGradient id="paint4_radial" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(51.6998 36.7682) rotate(76.9667) scale(10.7941 10.8401)"><stop stop-color="#ff3464"></stop><stop offset="1" stop-color="#ff3464" stop-opacity="0.01"></stop></radialGradient><radialGradient id="paint5_radial" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(43.7493 22.4711) rotate(17.0544) scale(10.8065 10.917)"><stop stop-color="#ff3464"></stop><stop offset="1" stop-color="#ff3464" stop-opacity="0.01"></stop></radialGradient><radialGradient id="paint6_radial" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(27.6037 22.3039) rotate(-43.1622) scale(10.8536 10.8674)"><stop stop-color="#ff3464"></stop><stop offset="1" stop-color="#ff3464" stop-opacity="0.01"></stop></radialGradient></defs></svg>'},,,function(e,t,i){e.exports={"avatar-url-dialog":"avatar-url-dialog__avatar-url-dialog__17OoD",avatarUrlDialog:"avatar-url-dialog__avatar-url-dialog__17OoD"}},function(e,t,i){e.exports=i.p+"assets/images/link_dialog_header-b15568ca2056d8be7a58c359e6a9ca51.svg"},function(e,t,i){e.exports={"form-frame":"feedback-dialog__form-frame__1gfk_",formFrame:"feedback-dialog__form-frame__1gfk_"}},function(e,t,i){e.exports={"leave-room":"leave-room-dialog__leave-room__31Jf7",leaveRoom:"leave-room-dialog__leave-room__31Jf7"}},,,,,,,function(e,t){e.exports='<svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" class="svg-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M37.681 23.5792C36.9 22.7981 35.6337 22.7981 34.8526 23.5792L28.061 30.3708L33.6796 35.9893L40.4712 29.1977C41.2522 28.4167 41.2522 27.1503 40.4712 26.3693L37.681 23.5792ZM32.1187 37.5501L26.5002 31.9316L6.46454 51.9672C5.68349 52.7483 5.68349 54.0146 6.46454 54.7957L9.25466 57.5858C10.0357 58.3668 11.302 58.3668 12.0831 57.5858L32.1187 37.5501Z" fill="currentColor"></path><path d="M27.2783 2.46352C27.4279 2.00287 28.0797 2.00287 28.2293 2.46353L29.9356 7.71476C30.0025 7.92078 30.1945 8.06026 30.4111 8.06026L35.9326 8.06026C36.4169 8.06026 36.6183 8.68006 36.2265 8.96476L31.7595 12.2102C31.5842 12.3375 31.5109 12.5632 31.5779 12.7692L33.2841 18.0205C33.4338 18.4811 32.9065 18.8642 32.5147 18.5795L28.0477 15.334C27.8724 15.2067 27.6352 15.2067 27.4599 15.334L22.9929 18.5795C22.6011 18.8642 22.0738 18.4811 22.2235 18.0205L23.9297 12.7692C23.9967 12.5632 23.9234 12.3375 23.7481 12.2102L19.2811 8.96476C18.8893 8.68006 19.0907 8.06026 19.575 8.06026L25.0965 8.06026C25.3131 8.06026 25.5051 7.92078 25.572 7.71476L27.2783 2.46352Z" fill="currentColor"></path><path d="M48.3949 10.6377C48.5445 10.177 49.1962 10.177 49.3459 10.6377L50.2875 13.5355C50.3544 13.7415 50.5464 13.881 50.763 13.881H53.81C54.2943 13.881 54.4957 14.5008 54.1039 14.7855L51.6388 16.5764C51.4636 16.7038 51.3902 16.9295 51.4572 17.1355L52.3987 20.0333C52.5484 20.4939 52.0212 20.877 51.6293 20.5923L49.1643 18.8013C48.989 18.674 48.7517 18.674 48.5765 18.8013L46.1115 20.5923C45.7196 20.877 45.1924 20.4939 45.342 20.0333L46.2836 17.1355C46.3505 16.9295 46.2772 16.7038 46.102 16.5764L43.6369 14.7855C43.2451 14.5008 43.4465 13.881 43.9308 13.881H46.9778C47.1944 13.881 47.3864 13.7415 47.4533 13.5355L48.3949 10.6377Z" fill="currentColor"></path><path d="M49.7572 31.0731C49.9069 30.6124 50.5586 30.6124 50.7083 31.0731L51.9557 34.9123C52.0226 35.1183 52.2146 35.2577 52.4312 35.2577H56.468C56.9524 35.2577 57.1537 35.8776 56.7619 36.1623L53.4961 38.535C53.3208 38.6623 53.2475 38.888 53.3144 39.094L54.5619 42.9332C54.7116 43.3939 54.1843 43.7769 53.7925 43.4922L50.5266 41.1195C50.3514 40.9922 50.1141 40.9922 49.9389 41.1195L46.6731 43.4922C46.2812 43.7769 45.754 43.3939 45.9036 42.9332L47.1511 39.094C47.218 38.888 47.1447 38.6623 46.9694 38.535L43.7036 36.1623C43.3118 35.8776 43.5131 35.2577 43.9975 35.2577H48.0343C48.2509 35.2577 48.4429 35.1183 48.5098 34.9123L49.7572 31.0731Z" fill="currentColor"></path></svg>'},,,,function(e,t){e.exports='<svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 245 240"><style>.st0{fill:currentColor;}</style><path class="st0" d="M104.4 103.9c-5.7 0-10.2 5-10.2 11.1s4.6 11.1 10.2 11.1c5.7 0 10.2-5 10.2-11.1.1-6.1-4.5-11.1-10.2-11.1zM140.9 103.9c-5.7 0-10.2 5-10.2 11.1s4.6 11.1 10.2 11.1c5.7 0 10.2-5 10.2-11.1s-4.5-11.1-10.2-11.1z"></path><path class="st0" d="M189.5 20h-134C44.2 20 35 29.2 35 40.6v135.2c0 11.4 9.2 20.6 20.5 20.6h113.4l-5.3-18.5 12.8 11.9 12.1 11.2 21.5 19V40.6c0-11.4-9.2-20.6-20.5-20.6zm-38.6 130.6s-3.6-4.3-6.6-8.1c13.1-3.7 18.1-11.9 18.1-11.9-4.1 2.7-8 4.6-11.5 5.9-5 2.1-9.8 3.5-14.5 4.3-9.6 1.8-18.4 1.3-25.9-.1-5.7-1.1-10.6-2.7-14.7-4.3-2.3-.9-4.8-2-7.3-3.4-.3-.2-.6-.3-.9-.5-.2-.1-.3-.2-.4-.3-1.8-1-2.8-1.7-2.8-1.7s4.8 8 17.5 11.8c-3 3.8-6.7 8.3-6.7 8.3-22.1-.7-30.5-15.2-30.5-15.2 0-32.2 14.4-58.3 14.4-58.3 14.4-10.8 28.1-10.5 28.1-10.5l1 1.2c-18 5.2-26.3 13.1-26.3 13.1s2.2-1.2 5.9-2.9c10.7-4.7 19.2-6 22.7-6.3.6-.1 1.1-.2 1.7-.2 6.1-.8 13-1 20.2-.2 9.5 1.1 19.7 3.9 30.1 9.6 0 0-7.9-7.5-24.9-12.7l1.4-1.6s13.7-.3 28.1 10.5c0 0 14.4 26.1 14.4 58.3 0 0-8.5 14.5-30.6 15.2z"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 32 32" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="svg-icon"><g id="device icon"><path id="Vector 2" d="M37.5 12C39.2921 12.2907 42.9409 13.0468 43.9308 13.5486C43.5236 1.76734 37.0468 -0.180441 33.5 2C37.7222 3.12137 37.6018 9.45614 37.5 12Z" fill="#C4C4C4"></path><path id="Vector 2.1" d="M37.5 12C39.2921 12.2907 42.9409 13.0468 43.9308 13.5486C43.5236 1.76734 37.0468 -0.180441 33.5 2C37.7222 3.12137 37.6018 9.45614 37.5 12Z" fill="#EFEFEF"></path><g id="Subtract"><path fill-rule="evenodd" clip-rule="evenodd" d="M27.5209 16.7286C28.8705 16.9007 30.167 16.1431 30.6795 14.8828C31.2166 13.5623 31.744 12.3973 32.2569 11.3735C33.4626 11.4107 34.5557 11.45 35.5 11.5C40.6072 11.7706 43.9609 13.2812 46.0424 15.3205C44.6124 15.9529 42.8928 16.8012 41.241 17.6476C39.5412 18.5184 37.8927 19.3977 36.6705 20.0585C36.059 20.3892 35.5532 20.6656 35.2001 20.8596C35.0234 20.9566 34.8849 21.033 34.7903 21.0853L34.644 21.1663C34.1086 21.4638 33.8079 22.057 33.8844 22.6648L33.8935 31.1305C33.9531 31.6039 34.2344 32.0208 34.6512 32.2532C35.0731 32.4938 35.5692 32.4314 36.0506 32.2866L36.1806 32.2269C36.294 32.1746 36.4598 32.098 36.6704 32C36.9037 31.8914 37.1922 31.7565 37.5258 31.5992C37.7946 31.4724 38.0927 31.3311 38.4147 31.1773L38.6575 31.0614C40.1664 30.3413 42.8905 29.0412 44.7287 28.0867C45.9328 27.4615 47.1537 26.8042 48.2714 26.1612C47.8862 27.1642 47.3632 28.0057 46.77 28.5856L29.5 38C28.0825 36.957 28.5674 36.3965 29.432 35.3968C30.97 33.6185 33.7096 30.4509 29.0818 20.7075C23.4626 16.2822 10.8481 16.1996 5.46832 16.1644C3.72919 16.153 2.74615 16.1466 3 16C4.71545 15.0093 15.9421 11.8416 19.6582 10.9238C19.5714 11.1113 19.4879 11.2913 19.4076 11.463C19.3668 11.5502 19.3269 11.6352 19.2878 11.7179C18.8773 12.5863 18.9074 13.5989 19.369 14.4414C19.8304 15.2838 20.6675 15.8543 21.6204 15.9759L27.5209 16.7286Z" fill="currentColor"></path><path d="M30.6795 14.8828L30.2163 14.6945L30.2163 14.6945L30.6795 14.8828ZM27.5209 16.7286L27.5842 16.2326L27.5842 16.2326L27.5209 16.7286ZM32.2569 11.3735L32.2723 10.8738L31.953 10.8639L31.8099 11.1496L32.2569 11.3735ZM35.5 11.5L35.5265 11.0007L35.5265 11.0007L35.5 11.5ZM46.0424 15.3205L46.2447 15.7778L46.9192 15.4795L46.3923 14.9633L46.0424 15.3205ZM41.241 17.6476L41.469 18.0925L41.469 18.0925L41.241 17.6476ZM36.6705 20.0585L36.4327 19.6187L36.4327 19.6187L36.6705 20.0585ZM35.2001 20.8596L35.4407 21.2979L35.4408 21.2978L35.2001 20.8596ZM34.7903 21.0853L34.5485 20.6477L34.548 20.6479L34.7903 21.0853ZM34.644 21.1663L34.4018 20.7289L34.4012 20.7292L34.644 21.1663ZM33.8844 22.6648L34.3844 22.6643L34.3844 22.6332L34.3805 22.6023L33.8844 22.6648ZM33.8935 31.1305L33.3935 31.131L33.3935 31.1621L33.3974 31.193L33.8935 31.1305ZM34.6512 32.2532L34.8989 31.8188L34.8947 31.8165L34.6512 32.2532ZM36.0506 32.2866L36.1945 32.7655L36.2278 32.7555L36.2594 32.7409L36.0506 32.2866ZM36.1806 32.2269L36.3894 32.6812L36.3898 32.681L36.1806 32.2269ZM36.6704 32L36.8814 32.4533L36.8814 32.4533L36.6704 32ZM37.5258 31.5992L37.7391 32.0514L37.7391 32.0514L37.5258 31.5992ZM38.4147 31.1773L38.1994 30.7261L38.1993 30.7261L38.4147 31.1773ZM38.6575 31.0614L38.4422 30.6102L38.4422 30.6102L38.6575 31.0614ZM44.7287 28.0867L44.4983 27.643L44.4983 27.643L44.7287 28.0867ZM48.2714 26.1612L48.7381 26.3405L49.2432 25.0252L48.022 25.7278L48.2714 26.1612ZM46.77 28.5856L47.0093 29.0246L47.0701 28.9915L47.1196 28.9431L46.77 28.5856ZM29.5 38L29.2037 38.4027L29.46 38.5913L29.7393 38.439L29.5 38ZM29.432 35.3968L29.8102 35.7238V35.7238L29.432 35.3968ZM29.0818 20.7075L29.5335 20.493L29.4832 20.3872L29.3912 20.3147L29.0818 20.7075ZM5.46832 16.1644L5.46505 16.6644H5.46505L5.46832 16.1644ZM3 16L2.74994 15.567L2.74994 15.567L3 16ZM19.6582 10.9238L20.1119 11.1338L20.5495 10.1886L19.5383 10.4383L19.6582 10.9238ZM19.4076 11.463L19.8605 11.6748L19.8605 11.6748L19.4076 11.463ZM19.2878 11.7179L18.8358 11.5041L18.8357 11.5042L19.2878 11.7179ZM19.369 14.4414L19.8075 14.2011L19.8075 14.2011L19.369 14.4414ZM21.6204 15.9759L21.6837 15.4799L21.6204 15.9759ZM30.2163 14.6945C29.7892 15.7447 28.7088 16.3761 27.5842 16.2326L27.4577 17.2246C29.0321 17.4254 30.5447 16.5416 31.1427 15.0712L30.2163 14.6945ZM31.8099 11.1496C31.2905 12.1863 30.7577 13.3633 30.2163 14.6945L31.1427 15.0712C31.6754 13.7614 32.1975 12.6083 32.7039 11.5975L31.8099 11.1496ZM35.5265 11.0007C34.5764 10.9504 33.4789 10.911 32.2723 10.8738L32.2415 11.8733C33.4464 11.9104 34.5349 11.9496 35.4735 11.9993L35.5265 11.0007ZM46.3923 14.9633C44.2011 12.8166 40.7191 11.2759 35.5265 11.0007L35.4735 11.9993C40.4953 12.2654 43.7206 13.7459 45.6925 15.6777L46.3923 14.9633ZM41.469 18.0925C43.1179 17.2477 44.8276 16.4045 46.2447 15.7778L45.8402 14.8632C44.3972 15.5014 42.6677 16.3548 41.013 17.2026L41.469 18.0925ZM36.9083 20.4984C38.1286 19.8386 39.7736 18.9611 41.469 18.0925L41.013 17.2026C39.3088 18.0757 37.6568 18.9569 36.4327 19.6187L36.9083 20.4984ZM35.4408 21.2978C35.7931 21.1043 36.2979 20.8284 36.9083 20.4984L36.4327 19.6187C35.8201 19.95 35.3134 20.2269 34.9594 20.4213L35.4408 21.2978ZM35.0321 21.5229C35.1264 21.4708 35.2645 21.3946 35.4407 21.2979L34.9594 20.4213C34.7823 20.5186 34.6434 20.5952 34.5485 20.6477L35.0321 21.5229ZM34.8863 21.6037L35.0325 21.5227L34.548 20.6479L34.4018 20.7289L34.8863 21.6037ZM34.3805 22.6023C34.3295 22.1972 34.5299 21.8017 34.8869 21.6033L34.4012 20.7292C33.6872 21.1259 33.2863 21.9169 33.3883 22.7273L34.3805 22.6023ZM34.3935 31.1299L34.3844 22.6643L33.3844 22.6653L33.3935 31.131L34.3935 31.1299ZM34.8947 31.8165C34.6169 31.6615 34.4293 31.3836 34.3896 31.068L33.3974 31.193C33.4769 31.8242 33.852 32.38 34.4077 32.6898L34.8947 31.8165ZM35.9067 31.8078C35.454 31.9439 35.1332 31.9525 34.8989 31.8188L34.4034 32.6875C35.0129 33.0351 35.6843 32.9188 36.1945 32.7655L35.9067 31.8078ZM35.9718 31.7726L35.8418 31.8323L36.2594 32.7409L36.3894 32.6812L35.9718 31.7726ZM36.4594 31.5467C36.2495 31.6444 36.0843 31.7207 35.9714 31.7728L36.3898 32.681C36.5037 32.6285 36.6701 32.5516 36.8814 32.4533L36.4594 31.5467ZM37.3125 31.1469C36.9798 31.3039 36.692 31.4384 36.4594 31.5467L36.8814 32.4533C37.1153 32.3444 37.4046 32.2091 37.7391 32.0514L37.3125 31.1469ZM38.1993 30.7261C37.878 30.8795 37.5806 31.0205 37.3125 31.1469L37.7391 32.0514C38.0085 31.9243 38.3073 31.7827 38.6302 31.6285L38.1993 30.7261ZM38.4422 30.6102L38.1994 30.7261L38.6301 31.6286L38.8729 31.5127L38.4422 30.6102ZM44.4983 27.643C42.6691 28.5928 39.9535 29.8889 38.4422 30.6102L38.8729 31.5127C40.3793 30.7937 43.1119 29.4897 44.9591 28.5305L44.4983 27.643ZM48.022 25.7278C46.9126 26.3661 45.6984 27.0198 44.4983 27.643L44.9591 28.5305C46.1672 27.9031 47.3949 27.2423 48.5207 26.5946L48.022 25.7278ZM47.1196 28.9431C47.7765 28.3009 48.3341 27.3925 48.7381 26.3405L47.8046 25.982C47.4382 26.9359 46.95 27.7104 46.4205 28.2281L47.1196 28.9431ZM29.7393 38.439L47.0093 29.0246L46.5307 28.1466L29.2607 37.561L29.7393 38.439ZM29.0538 35.0697C28.843 35.3134 28.6308 35.5579 28.4674 35.7941C28.3039 36.0304 28.1557 36.3043 28.1145 36.6168C28.0235 37.3074 28.4737 37.8656 29.2037 38.4027L29.7963 37.5973C29.1089 37.0914 29.0927 36.8479 29.1059 36.7475C29.1169 36.6645 29.1634 36.5457 29.2897 36.3631C29.4161 36.1804 29.5887 35.9799 29.8102 35.7238L29.0538 35.0697ZM28.6302 20.922C30.9222 25.7476 31.3544 28.8735 31.0735 30.9728C30.7952 33.0523 29.8106 34.1947 29.0538 35.0697L29.8102 35.7238C30.5914 34.8206 31.7455 33.4901 32.0647 31.1054C32.3811 28.7404 31.8693 25.4108 29.5335 20.493L28.6302 20.922ZM5.46505 16.6644C8.15636 16.682 12.627 16.7117 17.122 17.2857C21.6411 17.8627 26.0783 18.9786 28.7725 21.1003L29.3912 20.3147C26.4662 18.0111 21.7865 16.8731 17.2486 16.2937C12.6865 15.7112 8.16005 15.682 5.47159 15.6644L5.46505 16.6644ZM2.74994 15.567C2.71449 15.5875 2.63778 15.6347 2.57251 15.7184C2.4953 15.8174 2.40557 16.0157 2.50093 16.2425C2.57364 16.4154 2.71294 16.4913 2.7561 16.5134C2.81543 16.5439 2.87237 16.5607 2.91009 16.5703C3.05002 16.6061 3.25286 16.622 3.46207 16.6323C3.90703 16.6543 4.60126 16.6588 5.46505 16.6644L5.4716 15.6644C4.59625 15.6587 3.9294 15.6542 3.51152 15.6335C3.40834 15.6284 3.32552 15.6226 3.26166 15.616C3.22991 15.6128 3.20507 15.6096 3.18627 15.6067C3.177 15.6053 3.16997 15.604 3.16491 15.603C3.15975 15.602 3.15762 15.6015 3.15795 15.6015C3.15808 15.6016 3.16273 15.6028 3.17068 15.6055C3.17813 15.6081 3.19331 15.6138 3.21289 15.6239C3.23191 15.6336 3.35604 15.6962 3.42276 15.8549C3.51215 16.0675 3.42563 16.2506 3.36106 16.3334C3.30842 16.4009 3.25378 16.4308 3.25006 16.433L2.74994 15.567ZM19.5383 10.4383C17.6705 10.8997 13.9271 11.9233 10.4371 12.955C8.69171 13.4711 7.00533 13.9904 5.64585 14.4436C4.3085 14.8894 3.23173 15.2888 2.74994 15.567L3.25006 16.433C3.62599 16.2159 4.59586 15.8477 5.9621 15.3923C7.30623 14.9442 8.98043 14.4285 10.7206 13.914C14.2019 12.8848 17.9298 11.8657 19.7781 11.4092L19.5383 10.4383ZM19.8605 11.6748C19.9412 11.5022 20.0251 11.3215 20.1119 11.1338L19.2045 10.7137C19.1178 10.901 19.0345 11.0804 18.9547 11.2512L19.8605 11.6748ZM19.7398 11.9317C19.7793 11.8481 19.8195 11.7624 19.8605 11.6748L18.9547 11.2512C18.9141 11.3379 18.8745 11.4223 18.8358 11.5041L19.7398 11.9317ZM19.8075 14.2011C19.4228 13.4991 19.3977 12.6553 19.7398 11.9316L18.8357 11.5042C18.3568 12.5174 18.392 13.6987 18.9305 14.6816L19.8075 14.2011ZM21.6837 15.4799C20.8896 15.3786 20.192 14.9032 19.8075 14.2011L18.9304 14.6816C19.4689 15.6645 20.4455 16.3301 21.5572 16.4719L21.6837 15.4799ZM27.5842 16.2326L21.6837 15.4799L21.5572 16.4719L27.4577 17.2246L27.5842 16.2326Z" fill="currentColor"></path></g><path id="Vector 2_2" d="M22 13L27.9005 13.7527C35.7204 -5.47592 43.5914 1.80677 44.1005 14.3013C44.0496 6.10544 41.4074 -0.0498744 33.7029 0.000304595C27.5393 0.0404478 24.1269 8.50061 22 13Z" fill="currentColor"></path><path id="Vector" d="M30.0146 35.5184C30.6209 34.4891 31.0856 32.6318 31.0919 29.3392C30.6547 23.0315 29.594 21.1437 28.0037 20.1879C27.075 19.6298 25.7496 19.2525 23.6724 18.9311C22.4151 18.7366 21.0244 18.5798 19.4032 18.3969C18.3173 18.2744 17.1281 18.1402 15.8062 17.9753C14.4882 17.8108 13.3113 17.65 12.2415 17.5038C10.7839 17.3046 9.52502 17.1325 8.3785 17.0155C6.3889 16.8124 5.1769 16.8342 4.37736 17.0632C3.75934 17.2402 3.34932 17.5441 2.9782 18.3246C2.54305 19.2397 2.20891 20.7381 2.00005 23.2152C2.01122 29.3363 3.26876 31.3737 4.77762 32.3943C5.64876 32.9836 6.81469 33.386 8.46877 33.7555C9.28645 33.9381 10.1726 34.1028 11.1646 34.2866L11.1946 34.2922C12.1523 34.4696 13.1959 34.663 14.2995 34.8984C16.2798 35.2154 18.1882 35.6107 19.9036 35.966C20.7256 36.1363 21.5034 36.2974 22.2235 36.4363C24.575 36.8898 26.3227 37.1091 27.6414 36.9478C28.8125 36.8045 29.5026 36.3874 30.0146 35.5184Z" stroke="currentColor" stroke-width="4"></path><path id="Vector 3" d="M36.6921 29L36.6921 23.1034C40.7408 21.1901 45.2593 18.8099 48 17.5C49.86 16.611 51.371 17.3214 51.7408 19.1901C52 20.5 51.1543 21.8739 50 22.5C48.8457 23.1261 36.6921 29 36.6921 29Z" fill="currentColor"></path></g></svg>'},,function(e,t,i){e.exports={"avatar-editor":"avatar-editor__avatar-editor__xtJ6P",avatarEditor:"avatar-editor__avatar-editor__xtJ6P"}},function(e,t,i){e.exports=i.p+"assets/images/mic_level-d197b930a4350dc80adb2446babb05e1.png"},function(e,t,i){e.exports=i.p+"assets/images/mic_level@2x-9d49309c2f0e55e5c54193237658768b.png"},,,function(e,t,i){e.exports=i.p+"assets/images/speaker_level-9567a1a6f33d4d0e59e57903b08369c9.png"},function(e,t,i){e.exports=i.p+"assets/images/speaker_level@2x-b5e6a12f613576cf5c1a1b96e8c9d8d0.png"},function(e,t,i){e.exports=i.p+"assets/sfx/tone-624e72d19fe0cea1b85ca174cb6be256.webm"},function(e,t,i){e.exports=i.p+"assets/sfx/tone-3fa0defb5172b2533fedcc1929605799.mp3"},function(e,t,i){e.exports=i.p+"assets/sfx/tone-78ae5a60f0e336f384919eee9f5a2e18.ogg"},function(e,t,i){e.exports=i.p+"assets/sfx/tone-4604a4c98f36f3e0c6980295bc5c7ffe.wav"},,,,,,,,,function(e,t){e.exports='<svg viewBox="0 0 31 31" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="15.5" cy="15.5" r="14.5" fill="currentColor" stroke="white" stroke-width="2" stroke-miterlimit="3.8637"></circle><path fill-rule="evenodd" clip-rule="evenodd" d="M18.3345 12.9125C17.944 12.522 17.3108 12.522 16.9203 12.9125L14.8338 14.999L16.7466 16.9118L18.8331 14.8253C19.2236 14.4348 19.2236 13.8016 18.8331 13.4111L18.3345 12.9125ZM16.2152 17.4432L14.3024 15.5304L7.70711 22.1257C7.31658 22.5162 7.31658 23.1494 7.70711 23.5399L8.20568 24.0385C8.59621 24.429 9.22937 24.429 9.6199 24.0385L16.2152 17.4432Z" fill="white"></path><path d="M14.539 5.58541C14.5989 5.40115 14.8595 5.40115 14.9194 5.58541L15.4653 7.26541C15.4921 7.34781 15.5688 7.40361 15.6555 7.40361H17.4219C17.6157 7.40361 17.6962 7.65153 17.5395 7.76541L16.1104 8.80371C16.0403 8.85463 16.011 8.94491 16.0378 9.02731L16.5836 10.7073C16.6435 10.8916 16.4326 11.0448 16.2759 10.9309L14.8468 9.89262C14.7767 9.84169 14.6817 9.84169 14.6116 9.89262L13.1826 10.9309C13.0258 11.0448 12.8149 10.8916 12.8748 10.7073L13.4206 9.02731C13.4474 8.94491 13.4181 8.85463 13.348 8.80371L11.9189 7.76541C11.7622 7.65153 11.8427 7.40361 12.0365 7.40361H13.8029C13.8896 7.40361 13.9664 7.34781 13.9931 7.26541L14.539 5.58541Z" fill="white"></path><path d="M21.728 8.36823C21.7878 8.18397 22.0485 8.18397 22.1084 8.36823L22.3939 9.24703C22.4207 9.32943 22.4975 9.38523 22.5841 9.38523H23.5081C23.7019 9.38523 23.7824 9.63315 23.6257 9.74703L22.8782 10.2902C22.8081 10.3411 22.7787 10.4314 22.8055 10.5138L23.091 11.3926C23.1509 11.5768 22.94 11.73 22.7833 11.6162L22.0357 11.073C21.9656 11.0221 21.8707 11.0221 21.8006 11.073L21.0531 11.6162C20.8963 11.73 20.6854 11.5768 20.7453 11.3926L21.0308 10.5138C21.0576 10.4314 21.0283 10.3411 20.9582 10.2902L20.2106 9.74703C20.0539 9.63315 20.1344 9.38523 20.3282 9.38523H21.2522C21.3388 9.38523 21.4156 9.32943 21.4424 9.24703L21.728 8.36823Z" fill="white"></path><path d="M22.1918 15.3253C22.2516 15.141 22.5123 15.141 22.5722 15.3253L22.9618 16.5246C22.9886 16.607 23.0654 16.6628 23.1521 16.6628H24.4131C24.6068 16.6628 24.6874 16.9107 24.5306 17.0246L23.5104 17.7658C23.4403 17.8167 23.411 17.907 23.4378 17.9894L23.8275 19.1887C23.8873 19.3729 23.6764 19.5261 23.5197 19.4123L22.4995 18.6711C22.4294 18.6201 22.3345 18.6201 22.2644 18.6711L21.2442 19.4123C21.0875 19.5261 20.8766 19.3729 20.9365 19.1887L21.3261 17.9894C21.3529 17.907 21.3236 17.8167 21.2535 17.7658L20.2333 17.0246C20.0766 16.9107 20.1571 16.6628 20.3509 16.6628H21.6119C21.6985 16.6628 21.7753 16.607 21.8021 16.5246L22.1918 15.3253Z" fill="white"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 33 33" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="16.5005" cy="16.5" r="14.5" fill="#404040" stroke="currentColor" stroke-width="3" stroke-miterlimit="3.8637"></circle><rect x="11.5005" y="23" width="10" height="2" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5005 9C8.84363 9 7.50049 10.3431 7.50049 12V20C7.50049 21.6569 8.84363 23 10.5005 23H22.5005C24.1573 23 25.5005 21.6569 25.5005 20V12C25.5005 10.3431 24.1573 9 22.5005 9H10.5005ZM11.5005 12C10.9482 12 10.5005 12.4477 10.5005 13V19C10.5005 19.5523 10.9482 20 11.5005 20H21.5005C22.0528 20 22.5005 19.5523 22.5005 19V13C22.5005 12.4477 22.0528 12 21.5005 12H11.5005Z" fill="white"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 33 33" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="16.5005" cy="16.5" r="14.5" fill="#404040" stroke="black" stroke-opacity="0.01" stroke-width="3" stroke-miterlimit="1"></circle><rect x="11.5005" y="23" width="10" height="2" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5005 9C8.84363 9 7.50049 10.3431 7.50049 12V20C7.50049 21.6569 8.84363 23 10.5005 23H22.5005C24.1573 23 25.5005 21.6569 25.5005 20V12C25.5005 10.3431 24.1573 9 22.5005 9H10.5005ZM11.5005 12C10.9482 12 10.5005 12.4477 10.5005 13V19C10.5005 19.5523 10.9482 20 11.5005 20H21.5005C22.0528 20 22.5005 19.5523 22.5005 19V13C22.5005 12.4477 22.0528 12 21.5005 12H11.5005Z" fill="white"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 33 33" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="16.5005" cy="16.5" r="14.5" fill="#404040" stroke="currentColor" stroke-width="3" stroke-miterlimit="3.8637"></circle><rect x="8.00049" y="11" width="14" height="11" rx="2" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M25.8032 12.7057C25.3814 12.5114 24.8337 12.5587 24.4733 12.8475L20.8237 15.7718C20.3927 16.1171 20.3927 16.677 20.8237 17.0224L24.568 20.0225C24.902 20.2901 25.3968 20.3503 25.8032 20.2032V12.7057Z" fill="white"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 33 33" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="16.5005" cy="16.5" r="14.5" fill="#404040" stroke="black" stroke-opacity="0.01" stroke-width="3" stroke-miterlimit="1"></circle><rect x="8.00049" y="11" width="14" height="11" rx="2" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M25.8032 12.7057C25.3814 12.5114 24.8337 12.5587 24.4733 12.8475L20.8237 15.7718C20.3927 16.1171 20.3927 16.677 20.8237 17.0224L24.568 20.0225C24.902 20.2901 25.3968 20.3503 25.8032 20.2032V12.7057Z" fill="white"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 33 33" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="16.5005" cy="16.5" r="14.5" fill="#404040" stroke="black" stroke-opacity="0.01" stroke-width="3" stroke-miterlimit="1"></circle><path d="M8.75049 24H24.2505C24.5266 24 24.7505 24.2239 24.7505 24.5C24.7505 24.7761 24.5266 25 24.2505 25H9.75049C9.1982 25 8.75049 24.5523 8.75049 24Z" fill="white"></path><path d="M10.0005 17.9508L14.0005 22L10.1844 23.0407C9.43889 23.2441 8.7543 22.561 8.95595 21.815L10.0005 17.9508ZM24.7934 9.8226C25.1839 10.2131 25.1839 10.8463 24.7934 11.2368L14.5497 21.4805L10.5207 17.4508L20.7637 7.20715C21.1542 6.81661 21.7874 6.8166 22.1779 7.20713L24.7934 9.8226Z" fill="white"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 33 33" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="16.5005" cy="16.5" r="14.5" fill="#404040" stroke="currentColor" stroke-width="3" stroke-miterlimit="3.8637"></circle><path d="M8.75049 24H24.2505C24.5266 24 24.7505 24.2239 24.7505 24.5C24.7505 24.7761 24.5266 25 24.2505 25H9.75049C9.1982 25 8.75049 24.5523 8.75049 24Z" fill="white"></path><path d="M10.0005 17.9508L14.0005 22L10.1844 23.0407C9.43889 23.2441 8.7543 22.561 8.95595 21.815L10.0005 17.9508ZM24.7934 9.8226C25.1839 10.2131 25.1839 10.8463 24.7934 11.2368L14.5497 21.4805L10.5207 17.4508L20.7637 7.20715C21.1542 6.81661 21.7874 6.8166 22.1779 7.20713L24.7934 9.8226Z" fill="white"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 33 33" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="16.5005" cy="16.5" r="14.5" fill="#404040" stroke="black" stroke-opacity="0.01" stroke-width="3" stroke-miterlimit="1"></circle><path fill-rule="evenodd" clip-rule="evenodd" d="M8.26715 10C7.56759 10 7.00049 10.5698 7.00049 11.2727V22.7273C7.00049 23.4302 7.56759 24 8.26715 24H24.7338C25.4334 24 26.0005 23.4302 26.0005 22.7273V11.2727C26.0005 10.5698 25.4334 10 24.7338 10H8.26715ZM9.13382 11C8.5079 11 8.00049 11.1628 8.00049 11.3636V14.6364C8.00049 14.8372 8.5079 15 9.13382 15H23.8672C24.4931 15 25.0005 14.8372 25.0005 14.6364V11.3636C25.0005 11.1628 24.4931 11 23.8672 11H9.13382Z" fill="white"></path><circle cx="16.5005" cy="19.5" r="3" stroke="#404040"></circle></svg>'},function(e,t){e.exports='<svg viewBox="0 0 33 33" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="16.5005" cy="16.5" r="14.5" fill="#404040" stroke="currentColor" stroke-width="3" stroke-miterlimit="3.8637"></circle><path fill-rule="evenodd" clip-rule="evenodd" d="M8.26715 10C7.56759 10 7.00049 10.5698 7.00049 11.2727V22.7273C7.00049 23.4302 7.56759 24 8.26715 24H24.7338C25.4334 24 26.0005 23.4302 26.0005 22.7273V11.2727C26.0005 10.5698 25.4334 10 24.7338 10H8.26715ZM9.13382 11C8.5079 11 8.00049 11.1628 8.00049 11.3636V14.6364C8.00049 14.8372 8.5079 15 9.13382 15H23.8672C24.4931 15 25.0005 14.8372 25.0005 14.6364V11.3636C25.0005 11.1628 24.4931 11 23.8672 11H9.13382Z" fill="white"></path><circle cx="16.5005" cy="19.5" r="3" stroke="#404040"></circle></svg>'},function(e,t){e.exports='<svg viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="64" cy="64" r="58" fill="#404040" stroke="currentColor" stroke-width="12" stroke-miterlimit="3.8637"></circle><rect x="58.5789" y="94.0633" width="10.8424" height="14.0748" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z" fill="white"></path><rect x="53.3186" y="19.8621" width="21.3628" height="63.6407" rx="10.6814" fill="white"></rect><path d="M53.3186 72.8113C53.3186 78.7104 58.0995 83.4926 63.997 83.4926C69.8945 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8945 19.8526 63.997 19.8526C58.0995 19.8526 53.3186 24.6347 53.3186 30.5338V72.8113Z" fill="white"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="64" cy="64" r="58" fill="#404040" stroke="currentColor" stroke-width="12" stroke-miterlimit="3.8637"></circle><rect x="58.5789" y="94.0633" width="10.8424" height="14.0748" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z" fill="white"></path><rect x="53.3186" y="19.8621" width="21.3628" height="63.6407" rx="10.6814" fill="white"></rect><path d="M53.3186 72.8113C53.3186 78.7104 58.0995 83.4926 63.997 83.4926C69.8945 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8945 19.8526 63.997 19.8526C58.0995 19.8526 53.3186 24.6347 53.3186 30.5338V72.8113Z" fill="white"></path><mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="53" y="74" width="22" height="10"><rect x="53.3186" y="74.4011" width="21.36" height="9.09143" fill="#C4C4C4"></rect></mask><g mask="url(#mask0)"><path d="M53.3186 72.8113C53.3186 78.7104 58.0995 83.4926 63.997 83.4926C69.8945 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8945 19.8526 63.997 19.8526C58.0995 19.8526 53.3186 24.6347 53.3186 30.5338V72.8113Z" fill="currentColor"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="64" cy="64" r="58" fill="#404040" stroke="currentColor" stroke-width="12" stroke-miterlimit="3.8637"></circle><rect x="58.5789" y="94.0633" width="10.8424" height="14.0748" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z" fill="white"></path><rect x="53.3186" y="19.8621" width="21.3628" height="63.6407" rx="10.6814" fill="white"></rect><path d="M53.3186 72.8113C53.3186 78.7104 58.0995 83.4926 63.997 83.4926C69.8945 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8945 19.8526 63.997 19.8526C58.0995 19.8526 53.3186 24.6347 53.3186 30.5338V72.8113Z" fill="white"></path><mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="53" y="65" width="22" height="19"><rect x="53.3186" y="65.3097" width="21.36" height="9.09143" fill="#C4C4C4"></rect><rect x="53.3186" y="74.4011" width="21.36" height="9.09143" fill="#C4C4C4"></rect></mask><g mask="url(#mask0)"><path d="M53.3186 72.8113C53.3186 78.7104 58.0995 83.4926 63.997 83.4926C69.8945 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8945 19.8526 63.997 19.8526C58.0995 19.8526 53.3186 24.6347 53.3186 30.5338V72.8113Z" fill="currentColor"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="64" cy="64" r="58" fill="#404040" stroke="currentColor" stroke-width="12" stroke-miterlimit="3.8637"></circle><rect x="58.5789" y="94.0633" width="10.8424" height="14.0748" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M49.7202 72.799C49.7202 65.9079 42.1165 62.6609 40.3617 69.3249C39.9447 70.9085 39.7242 72.5592 39.7242 74.2557C39.7242 86.1656 50.5929 95.8204 64 95.8204C77.4072 95.8204 88.2759 86.1656 88.2759 74.2557C88.2759 72.5593 88.0554 70.9085 87.6384 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8867 87.0789 64.0001 87.0789C56.1135 87.0789 49.7202 80.6856 49.7202 72.799Z" fill="white"></path><rect x="53.3187" y="19.8621" width="21.3628" height="63.6407" rx="10.6814" fill="white"></rect><path d="M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z" fill="white"></path><mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="53" y="56" width="22" height="28"><rect x="53.3187" y="56.2183" width="21.36" height="9.09143" fill="#C4C4C4"></rect><rect x="53.3187" y="65.3097" width="21.36" height="9.09143" fill="#C4C4C4"></rect><rect x="53.3187" y="74.4011" width="21.36" height="9.09143" fill="#C4C4C4"></rect></mask><g mask="url(#mask0)"><path d="M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z" fill="currentColor"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="64" cy="64" r="58" fill="#404040" stroke="currentColor" stroke-width="12" stroke-miterlimit="3.8637"></circle><rect x="58.5789" y="94.0633" width="10.8424" height="14.0748" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M49.7202 72.799C49.7202 65.9079 42.1165 62.6609 40.3617 69.3249C39.9447 70.9085 39.7242 72.5592 39.7242 74.2557C39.7242 86.1656 50.5929 95.8204 64 95.8204C77.4072 95.8204 88.2759 86.1656 88.2759 74.2557C88.2759 72.5593 88.0554 70.9085 87.6384 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8867 87.0789 64.0001 87.0789C56.1135 87.0789 49.7202 80.6856 49.7202 72.799Z" fill="white"></path><rect x="53.3187" y="19.8621" width="21.3628" height="63.6407" rx="10.6814" fill="white"></rect><path d="M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z" fill="white"></path><mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="53" y="47" width="22" height="37"><rect x="53.3187" y="47.1268" width="21.36" height="9.09143" fill="#C4C4C4"></rect><rect x="53.3187" y="56.2183" width="21.36" height="9.09143" fill="#C4C4C4"></rect><rect x="53.3187" y="65.3097" width="21.36" height="9.09143" fill="#C4C4C4"></rect><rect x="53.3187" y="74.4011" width="21.36" height="9.09143" fill="#C4C4C4"></rect></mask><g mask="url(#mask0)"><path d="M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z" fill="currentColor"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="64" cy="64" r="58" fill="#404040" stroke="currentColor" stroke-width="12" stroke-miterlimit="3.8637"></circle><rect x="58.5789" y="94.0633" width="10.8424" height="14.0748" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M49.7202 72.799C49.7202 65.9079 42.1165 62.6609 40.3617 69.3249C39.9447 70.9085 39.7242 72.5592 39.7242 74.2557C39.7242 86.1656 50.5929 95.8204 64 95.8204C77.4072 95.8204 88.2759 86.1656 88.2759 74.2557C88.2759 72.5593 88.0554 70.9085 87.6384 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8867 87.0789 64.0001 87.0789C56.1135 87.0789 49.7202 80.6856 49.7202 72.799Z" fill="white"></path><rect x="53.3187" y="19.8621" width="21.3628" height="63.6407" rx="10.6814" fill="white"></rect><path d="M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z" fill="white"></path><mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="53" y="38" width="22" height="46"><rect x="53.3187" y="38.0354" width="21.36" height="9.09143" fill="currentColor"></rect><rect x="53.3187" y="47.1268" width="21.36" height="9.09143" fill="currentColor"></rect><rect x="53.3187" y="56.2183" width="21.36" height="9.09143" fill="currentColor"></rect><rect x="53.3187" y="65.3097" width="21.36" height="9.09143" fill="currentColor"></rect><rect x="53.3187" y="74.4011" width="21.36" height="9.09143" fill="currentColor"></rect></mask><g mask="url(#mask0)"><path d="M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z" fill="currentColor"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="64" cy="64" r="58" fill="#404040" stroke="currentColor" stroke-width="12" stroke-miterlimit="3.8637"></circle><rect x="58.5789" y="94.0633" width="10.8424" height="14.0748" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M49.7202 72.799C49.7202 65.9079 42.1165 62.6609 40.3617 69.3249C39.9447 70.9085 39.7242 72.5592 39.7242 74.2557C39.7242 86.1656 50.5929 95.8204 64 95.8204C77.4072 95.8204 88.2759 86.1656 88.2759 74.2557C88.2759 72.5593 88.0554 70.9085 87.6384 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8867 87.0789 64.0001 87.0789C56.1135 87.0789 49.7202 80.6856 49.7202 72.799Z" fill="white"></path><rect x="53.3187" y="19.8621" width="21.3628" height="63.6407" rx="10.6814" fill="white"></rect><path d="M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z" fill="white"></path><mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="53" y="28" width="22" height="56"><rect x="53.3187" y="28.944" width="21.36" height="9.09143" fill="#C4C4C4"></rect><rect x="53.3187" y="38.0354" width="21.36" height="9.09143" fill="#C4C4C4"></rect><rect x="53.3187" y="47.1268" width="21.36" height="9.09143" fill="#C4C4C4"></rect><rect x="53.3187" y="56.2183" width="21.36" height="9.09143" fill="#C4C4C4"></rect><rect x="53.3187" y="65.3097" width="21.36" height="9.09143" fill="#C4C4C4"></rect><rect x="53.3187" y="74.4011" width="21.36" height="9.09143" fill="#C4C4C4"></rect></mask><g mask="url(#mask0)"><path d="M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z" fill="currentColor"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="64" cy="64" r="58" fill="#404040" stroke="currentColor" stroke-width="12" stroke-miterlimit="3.8637"></circle><rect x="58.5789" y="94.0633" width="10.8424" height="14.0748" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M49.7202 72.799C49.7202 65.9079 42.1165 62.6609 40.3617 69.3249C39.9447 70.9085 39.7242 72.5592 39.7242 74.2557C39.7242 86.1656 50.5929 95.8204 64 95.8204C77.4072 95.8204 88.2759 86.1656 88.2759 74.2557C88.2759 72.5593 88.0554 70.9085 87.6384 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8867 87.0789 64.0001 87.0789C56.1135 87.0789 49.7202 80.6856 49.7202 72.799Z" fill="white"></path><rect x="53.3187" y="19.8621" width="21.3628" height="63.6407" rx="10.6814" fill="white"></rect><path d="M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z" fill="white"></path><mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="53" y="19" width="22" height="65"><rect x="53.3187" y="19.8525" width="21.36" height="9.09143" fill="#C4C4C4"></rect><rect x="53.3187" y="28.944" width="21.36" height="9.09143" fill="#C4C4C4"></rect><rect x="53.3187" y="38.0354" width="21.36" height="9.09143" fill="#C4C4C4"></rect><rect x="53.3187" y="47.1268" width="21.36" height="9.09143" fill="#C4C4C4"></rect><rect x="53.3187" y="56.2183" width="21.36" height="9.09143" fill="#C4C4C4"></rect><rect x="53.3187" y="65.3097" width="21.36" height="9.09143" fill="#C4C4C4"></rect><rect x="53.3187" y="74.4011" width="21.36" height="9.09143" fill="#C4C4C4"></rect></mask><g mask="url(#mask0)"><path d="M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z" fill="currentColor"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="64" cy="64" r="64" fill="#404040"></circle><rect x="58.5789" y="94.0632" width="10.8424" height="14.0748" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z" fill="white"></path><rect x="53.3186" y="19.862" width="21.3628" height="63.6407" rx="10.6814" fill="white"></rect><mask id="path-5-outside-1" maskUnits="userSpaceOnUse" x="10.9819" y="11.4462" width="106.066" height="106.066" fill="black"><rect fill="white" x="10.9819" y="11.4462" width="106.066" height="106.066"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z"></path></mask><path fill-rule="evenodd" clip-rule="evenodd" d="M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z" fill="white"></path><path d="M87.4633 47.6226L90.2918 50.451L87.4633 47.6226ZM64.0148 56.929L61.1864 59.7574L64.0148 62.5858L66.8433 59.7574L64.0148 56.929ZM40.5664 40.5516L43.3948 43.38L40.5664 40.5516ZM56.9438 64.0001L59.7722 66.8285L62.6006 64.0001L59.7722 61.1716L56.9438 64.0001ZM64.0148 71.0711L66.8433 68.2427L64.0148 65.4143L61.1864 68.2427L64.0148 71.0711ZM87.4633 87.4486L90.2918 90.277L90.2918 90.277L87.4633 87.4486ZM71.0859 64.0001L68.2575 61.1716L65.4291 64.0001L68.2575 66.8285L71.0859 64.0001ZM84.6349 43.38C85.0254 43.7705 85.0254 44.4037 84.6349 44.7942L90.2918 50.451C93.8065 46.9363 93.8065 41.2378 90.2918 37.7231L84.6349 43.38ZM83.2207 43.38C83.6112 42.9894 84.2444 42.9894 84.6349 43.38L90.2918 37.7231C86.7771 34.2084 81.0786 34.2084 77.5639 37.7231L83.2207 43.38ZM66.8433 59.7574L83.2207 43.38L77.5639 37.7231L61.1864 54.1006L66.8433 59.7574ZM44.809 43.38L61.1864 59.7574L66.8433 54.1006L50.4659 37.7232L44.809 43.38ZM43.3948 43.38C43.7853 42.9895 44.4185 42.9895 44.809 43.38L50.4659 37.7232C46.9512 34.2084 41.2527 34.2084 37.738 37.7232L43.3948 43.38ZM43.3948 44.7942C43.0043 44.4037 43.0043 43.7705 43.3948 43.38L37.738 37.7232C34.2232 41.2379 34.2232 46.9364 37.738 50.4511L43.3948 44.7942ZM59.7722 61.1716L43.3948 44.7942L37.738 50.4511L54.1153 66.8285L59.7722 61.1716ZM43.3948 83.2059L59.7722 66.8285L54.1153 61.1716L37.738 77.549L43.3948 83.2059ZM43.3948 84.6201C43.0043 84.2295 43.0043 83.5964 43.3948 83.2059L37.738 77.549C34.2232 81.0637 34.2232 86.7622 37.738 90.2769L43.3948 84.6201ZM44.809 84.6201C44.4185 85.0106 43.7853 85.0106 43.3948 84.6201L37.738 90.2769C41.2527 93.7916 46.9512 93.7917 50.4659 90.2769L44.809 84.6201ZM61.1864 68.2427L44.809 84.6201L50.4659 90.2769L66.8433 73.8995L61.1864 68.2427ZM83.2207 84.6201L66.8433 68.2427L61.1864 73.8995L77.5638 90.277L83.2207 84.6201ZM84.6349 84.6201C84.2444 85.0107 83.6112 85.0107 83.2207 84.6201L77.5638 90.277C81.0786 93.7917 86.777 93.7917 90.2918 90.277L84.6349 84.6201ZM84.6349 83.2059C85.0254 83.5964 85.0254 84.2296 84.6349 84.6201L90.2918 90.277C93.8065 86.7623 93.8065 81.0638 90.2918 77.5491L84.6349 83.2059ZM68.2575 66.8285L84.6349 83.2059L90.2918 77.5491L73.9143 61.1716L68.2575 66.8285ZM84.6349 44.7942L68.2575 61.1716L73.9143 66.8285L90.2918 50.451L84.6349 44.7942Z" fill="#404040" mask="url(#path-5-outside-1)"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="64" cy="64" r="64" fill="#404040"></circle><rect x="58.5789" y="94.0632" width="10.8424" height="14.0748" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z" fill="white"></path><rect x="53.3186" y="19.862" width="21.3628" height="63.6407" rx="10.6814" fill="white"></rect><mask id="path-5-outside-1" maskUnits="userSpaceOnUse" x="10.9819" y="11.4462" width="106.066" height="106.066" fill="black"><rect fill="white" x="10.9819" y="11.4462" width="106.066" height="106.066"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z"></path></mask><path fill-rule="evenodd" clip-rule="evenodd" d="M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z" fill="#FFEAED"></path><path d="M87.4633 47.6226L90.2918 50.451L87.4633 47.6226ZM64.0148 56.929L61.1864 59.7574L64.0148 62.5858L66.8433 59.7574L64.0148 56.929ZM40.5664 40.5516L43.3948 43.38L40.5664 40.5516ZM56.9438 64.0001L59.7722 66.8285L62.6006 64.0001L59.7722 61.1716L56.9438 64.0001ZM64.0148 71.0711L66.8433 68.2427L64.0148 65.4143L61.1864 68.2427L64.0148 71.0711ZM87.4633 87.4486L90.2918 90.277L90.2918 90.277L87.4633 87.4486ZM71.0859 64.0001L68.2575 61.1716L65.4291 64.0001L68.2575 66.8285L71.0859 64.0001ZM84.6349 43.38C85.0254 43.7705 85.0254 44.4037 84.6349 44.7942L90.2918 50.451C93.8065 46.9363 93.8065 41.2378 90.2918 37.7231L84.6349 43.38ZM83.2207 43.38C83.6112 42.9894 84.2444 42.9894 84.6349 43.38L90.2918 37.7231C86.7771 34.2084 81.0786 34.2084 77.5639 37.7231L83.2207 43.38ZM66.8433 59.7574L83.2207 43.38L77.5639 37.7231L61.1864 54.1006L66.8433 59.7574ZM44.809 43.38L61.1864 59.7574L66.8433 54.1006L50.4659 37.7232L44.809 43.38ZM43.3948 43.38C43.7853 42.9895 44.4185 42.9895 44.809 43.38L50.4659 37.7232C46.9512 34.2084 41.2527 34.2084 37.738 37.7232L43.3948 43.38ZM43.3948 44.7942C43.0043 44.4037 43.0043 43.7705 43.3948 43.38L37.738 37.7232C34.2232 41.2379 34.2232 46.9364 37.738 50.4511L43.3948 44.7942ZM59.7722 61.1716L43.3948 44.7942L37.738 50.4511L54.1153 66.8285L59.7722 61.1716ZM43.3948 83.2059L59.7722 66.8285L54.1153 61.1716L37.738 77.549L43.3948 83.2059ZM43.3948 84.6201C43.0043 84.2295 43.0043 83.5964 43.3948 83.2059L37.738 77.549C34.2232 81.0637 34.2232 86.7622 37.738 90.2769L43.3948 84.6201ZM44.809 84.6201C44.4185 85.0106 43.7853 85.0106 43.3948 84.6201L37.738 90.2769C41.2527 93.7916 46.9512 93.7917 50.4659 90.2769L44.809 84.6201ZM61.1864 68.2427L44.809 84.6201L50.4659 90.2769L66.8433 73.8995L61.1864 68.2427ZM83.2207 84.6201L66.8433 68.2427L61.1864 73.8995L77.5638 90.277L83.2207 84.6201ZM84.6349 84.6201C84.2444 85.0107 83.6112 85.0107 83.2207 84.6201L77.5638 90.277C81.0786 93.7917 86.777 93.7917 90.2918 90.277L84.6349 84.6201ZM84.6349 83.2059C85.0254 83.5964 85.0254 84.2296 84.6349 84.6201L90.2918 90.277C93.8065 86.7623 93.8065 81.0638 90.2918 77.5491L84.6349 83.2059ZM68.2575 66.8285L84.6349 83.2059L90.2918 77.5491L73.9143 61.1716L68.2575 66.8285ZM84.6349 44.7942L68.2575 61.1716L73.9143 66.8285L90.2918 50.451L84.6349 44.7942Z" fill="#404040" mask="url(#path-5-outside-1)"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="64" cy="64" r="64" fill="#404040"></circle><rect x="58.5789" y="94.0632" width="10.8424" height="14.0748" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z" fill="white"></path><rect x="53.3186" y="19.862" width="21.3628" height="63.6407" rx="10.6814" fill="white"></rect><mask id="path-5-outside-1" maskUnits="userSpaceOnUse" x="10.9819" y="11.4462" width="106.066" height="106.066" fill="black"><rect fill="white" x="10.9819" y="11.4462" width="106.066" height="106.066"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z"></path></mask><path fill-rule="evenodd" clip-rule="evenodd" d="M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z" fill="#FFD2D8"></path><path d="M87.4633 47.6226L90.2918 50.451L87.4633 47.6226ZM64.0148 56.929L61.1864 59.7574L64.0148 62.5858L66.8433 59.7574L64.0148 56.929ZM40.5664 40.5516L43.3948 43.38L40.5664 40.5516ZM56.9438 64.0001L59.7722 66.8285L62.6006 64.0001L59.7722 61.1716L56.9438 64.0001ZM64.0148 71.0711L66.8433 68.2427L64.0148 65.4143L61.1864 68.2427L64.0148 71.0711ZM87.4633 87.4486L90.2918 90.277L90.2918 90.277L87.4633 87.4486ZM71.0859 64.0001L68.2575 61.1716L65.4291 64.0001L68.2575 66.8285L71.0859 64.0001ZM84.6349 43.38C85.0254 43.7705 85.0254 44.4037 84.6349 44.7942L90.2918 50.451C93.8065 46.9363 93.8065 41.2378 90.2918 37.7231L84.6349 43.38ZM83.2207 43.38C83.6112 42.9894 84.2444 42.9894 84.6349 43.38L90.2918 37.7231C86.7771 34.2084 81.0786 34.2084 77.5639 37.7231L83.2207 43.38ZM66.8433 59.7574L83.2207 43.38L77.5639 37.7231L61.1864 54.1006L66.8433 59.7574ZM44.809 43.38L61.1864 59.7574L66.8433 54.1006L50.4659 37.7232L44.809 43.38ZM43.3948 43.38C43.7853 42.9895 44.4185 42.9895 44.809 43.38L50.4659 37.7232C46.9512 34.2084 41.2527 34.2084 37.738 37.7232L43.3948 43.38ZM43.3948 44.7942C43.0043 44.4037 43.0043 43.7705 43.3948 43.38L37.738 37.7232C34.2232 41.2379 34.2232 46.9364 37.738 50.4511L43.3948 44.7942ZM59.7722 61.1716L43.3948 44.7942L37.738 50.4511L54.1153 66.8285L59.7722 61.1716ZM43.3948 83.2059L59.7722 66.8285L54.1153 61.1716L37.738 77.549L43.3948 83.2059ZM43.3948 84.6201C43.0043 84.2295 43.0043 83.5964 43.3948 83.2059L37.738 77.549C34.2232 81.0637 34.2232 86.7622 37.738 90.2769L43.3948 84.6201ZM44.809 84.6201C44.4185 85.0106 43.7853 85.0106 43.3948 84.6201L37.738 90.2769C41.2527 93.7916 46.9512 93.7917 50.4659 90.2769L44.809 84.6201ZM61.1864 68.2427L44.809 84.6201L50.4659 90.2769L66.8433 73.8995L61.1864 68.2427ZM83.2207 84.6201L66.8433 68.2427L61.1864 73.8995L77.5638 90.277L83.2207 84.6201ZM84.6349 84.6201C84.2444 85.0107 83.6112 85.0107 83.2207 84.6201L77.5638 90.277C81.0786 93.7917 86.777 93.7917 90.2918 90.277L84.6349 84.6201ZM84.6349 83.2059C85.0254 83.5964 85.0254 84.2296 84.6349 84.6201L90.2918 90.277C93.8065 86.7623 93.8065 81.0638 90.2918 77.5491L84.6349 83.2059ZM68.2575 66.8285L84.6349 83.2059L90.2918 77.5491L73.9143 61.1716L68.2575 66.8285ZM84.6349 44.7942L68.2575 61.1716L73.9143 66.8285L90.2918 50.451L84.6349 44.7942Z" fill="#404040" mask="url(#path-5-outside-1)"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="64" cy="64" r="64" fill="#404040"></circle><rect x="58.5789" y="94.0632" width="10.8424" height="14.0748" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z" fill="white"></path><rect x="53.3186" y="19.862" width="21.3628" height="63.6407" rx="10.6814" fill="white"></rect><mask id="path-5-outside-1" maskUnits="userSpaceOnUse" x="10.9819" y="11.4462" width="106.066" height="106.066" fill="black"><rect fill="white" x="10.9819" y="11.4462" width="106.066" height="106.066"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z"></path></mask><path fill-rule="evenodd" clip-rule="evenodd" d="M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z" fill="#FFAEB9"></path><path d="M64.0148 56.929L61.1864 59.7574L64.0148 62.5858L66.8433 59.7574L64.0148 56.929ZM40.5664 40.5516L43.3948 43.38L40.5664 40.5516ZM56.9438 64.0001L59.7722 66.8285L62.6006 64.0001L59.7722 61.1716L56.9438 64.0001ZM64.0148 71.0711L66.8433 68.2427L64.0148 65.4143L61.1864 68.2427L64.0148 71.0711ZM87.4633 87.4486L90.2918 90.277L90.2918 90.277L87.4633 87.4486ZM71.0859 64.0001L68.2575 61.1716L65.4291 64.0001L68.2575 66.8285L71.0859 64.0001ZM84.6349 43.38C85.0254 43.7705 85.0254 44.4037 84.6349 44.7942L90.2918 50.451C93.8065 46.9363 93.8065 41.2378 90.2918 37.7231L84.6349 43.38ZM83.2207 43.38C83.6112 42.9894 84.2444 42.9894 84.6349 43.38L90.2918 37.7231C86.7771 34.2084 81.0786 34.2084 77.5639 37.7231L83.2207 43.38ZM66.8433 59.7574L83.2207 43.38L77.5639 37.7231L61.1864 54.1006L66.8433 59.7574ZM44.809 43.38L61.1864 59.7574L66.8433 54.1006L50.4659 37.7232L44.809 43.38ZM43.3948 43.38C43.7853 42.9895 44.4185 42.9895 44.809 43.38L50.4659 37.7232C46.9512 34.2084 41.2527 34.2084 37.738 37.7232L43.3948 43.38ZM43.3948 44.7942C43.0043 44.4037 43.0043 43.7705 43.3948 43.38L37.738 37.7232C34.2232 41.2379 34.2232 46.9364 37.738 50.4511L43.3948 44.7942ZM59.7722 61.1716L43.3948 44.7942L37.738 50.4511L54.1153 66.8285L59.7722 61.1716ZM43.3948 83.2059L59.7722 66.8285L54.1153 61.1716L37.738 77.549L43.3948 83.2059ZM43.3948 84.6201C43.0043 84.2295 43.0043 83.5964 43.3948 83.2059L37.738 77.549C34.2232 81.0637 34.2232 86.7622 37.738 90.2769L43.3948 84.6201ZM44.809 84.6201C44.4185 85.0106 43.7853 85.0106 43.3948 84.6201L37.738 90.2769C41.2527 93.7916 46.9512 93.7917 50.4659 90.2769L44.809 84.6201ZM61.1864 68.2427L44.809 84.6201L50.4659 90.2769L66.8433 73.8995L61.1864 68.2427ZM83.2207 84.6201L66.8433 68.2427L61.1864 73.8995L77.5638 90.277L83.2207 84.6201ZM84.6349 84.6201C84.2444 85.0107 83.6112 85.0107 83.2207 84.6201L77.5638 90.277C81.0786 93.7917 86.777 93.7917 90.2918 90.277L84.6349 84.6201ZM84.6349 83.2059C85.0254 83.5964 85.0254 84.2296 84.6349 84.6201L90.2918 90.277C93.8065 86.7623 93.8065 81.0638 90.2918 77.5491L84.6349 83.2059ZM68.2575 66.8285L84.6349 83.2059L90.2918 77.5491L73.9143 61.1716L68.2575 66.8285ZM84.6349 44.7942L68.2575 61.1716L73.9143 66.8285L90.2918 50.451L84.6349 44.7942Z" fill="#404040" mask="url(#path-5-outside-1)"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="64" cy="64" r="64" fill="#404040"></circle><rect x="58.5789" y="94.0632" width="10.8424" height="14.0748" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z" fill="white"></path><rect x="53.3186" y="19.862" width="21.3628" height="63.6407" rx="10.6814" fill="white"></rect><mask id="path-5-outside-1" maskUnits="userSpaceOnUse" x="10.9819" y="11.4462" width="106.066" height="106.066" fill="black"><rect fill="white" x="10.9819" y="11.4462" width="106.066" height="106.066"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z"></path></mask><path fill-rule="evenodd" clip-rule="evenodd" d="M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z" fill="#FF8D9D"></path><path d="M64.0148 56.929L61.1864 59.7574L64.0148 62.5858L66.8433 59.7574L64.0148 56.929ZM40.5664 40.5516L43.3948 43.38L40.5664 40.5516ZM56.9438 64.0001L59.7722 66.8285L62.6006 64.0001L59.7722 61.1716L56.9438 64.0001ZM64.0148 71.0711L66.8433 68.2427L64.0148 65.4143L61.1864 68.2427L64.0148 71.0711ZM87.4633 87.4486L90.2918 90.277L90.2918 90.277L87.4633 87.4486ZM71.0859 64.0001L68.2575 61.1716L65.4291 64.0001L68.2575 66.8285L71.0859 64.0001ZM84.6349 43.38C85.0254 43.7705 85.0254 44.4037 84.6349 44.7942L90.2918 50.451C93.8065 46.9363 93.8065 41.2378 90.2918 37.7231L84.6349 43.38ZM83.2207 43.38C83.6112 42.9894 84.2444 42.9894 84.6349 43.38L90.2918 37.7231C86.7771 34.2084 81.0786 34.2084 77.5639 37.7231L83.2207 43.38ZM66.8433 59.7574L83.2207 43.38L77.5639 37.7231L61.1864 54.1006L66.8433 59.7574ZM44.809 43.38L61.1864 59.7574L66.8433 54.1006L50.4659 37.7232L44.809 43.38ZM43.3948 43.38C43.7853 42.9895 44.4185 42.9895 44.809 43.38L50.4659 37.7232C46.9512 34.2084 41.2527 34.2084 37.738 37.7232L43.3948 43.38ZM43.3948 44.7942C43.0043 44.4037 43.0043 43.7705 43.3948 43.38L37.738 37.7232C34.2232 41.2379 34.2232 46.9364 37.738 50.4511L43.3948 44.7942ZM59.7722 61.1716L43.3948 44.7942L37.738 50.4511L54.1153 66.8285L59.7722 61.1716ZM43.3948 83.2059L59.7722 66.8285L54.1153 61.1716L37.738 77.549L43.3948 83.2059ZM43.3948 84.6201C43.0043 84.2295 43.0043 83.5964 43.3948 83.2059L37.738 77.549C34.2232 81.0637 34.2232 86.7622 37.738 90.2769L43.3948 84.6201ZM44.809 84.6201C44.4185 85.0106 43.7853 85.0106 43.3948 84.6201L37.738 90.2769C41.2527 93.7916 46.9512 93.7917 50.4659 90.2769L44.809 84.6201ZM61.1864 68.2427L44.809 84.6201L50.4659 90.2769L66.8433 73.8995L61.1864 68.2427ZM83.2207 84.6201L66.8433 68.2427L61.1864 73.8995L77.5638 90.277L83.2207 84.6201ZM84.6349 84.6201C84.2444 85.0107 83.6112 85.0107 83.2207 84.6201L77.5638 90.277C81.0786 93.7917 86.777 93.7917 90.2918 90.277L84.6349 84.6201ZM84.6349 83.2059C85.0254 83.5964 85.0254 84.2296 84.6349 84.6201L90.2918 90.277C93.8065 86.7623 93.8065 81.0638 90.2918 77.5491L84.6349 83.2059ZM68.2575 66.8285L84.6349 83.2059L90.2918 77.5491L73.9143 61.1716L68.2575 66.8285ZM84.6349 44.7942L68.2575 61.1716L73.9143 66.8285L90.2918 50.451L84.6349 44.7942Z" fill="#404040" mask="url(#path-5-outside-1)"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="64" cy="64" r="64" fill="#404040"></circle><rect x="58.5789" y="94.0632" width="10.8424" height="14.0748" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z" fill="white"></path><rect x="53.3186" y="19.862" width="21.3628" height="63.6407" rx="10.6814" fill="white"></rect><mask id="path-5-outside-1" maskUnits="userSpaceOnUse" x="10.9819" y="11.4462" width="106.066" height="106.066" fill="black"><rect fill="white" x="10.9819" y="11.4462" width="106.066" height="106.066"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z"></path></mask><path fill-rule="evenodd" clip-rule="evenodd" d="M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z" fill="#FF7083"></path><path d="M64.0148 56.929L61.1864 59.7574L64.0148 62.5858L66.8433 59.7574L64.0148 56.929ZM40.5664 40.5516L43.3948 43.38L40.5664 40.5516ZM56.9438 64.0001L59.7722 66.8285L62.6006 64.0001L59.7722 61.1716L56.9438 64.0001ZM64.0148 71.0711L66.8433 68.2427L64.0148 65.4143L61.1864 68.2427L64.0148 71.0711ZM87.4633 87.4486L90.2918 90.277L90.2918 90.277L87.4633 87.4486ZM71.0859 64.0001L68.2575 61.1716L65.4291 64.0001L68.2575 66.8285L71.0859 64.0001ZM84.6349 43.38C85.0254 43.7705 85.0254 44.4037 84.6349 44.7942L90.2918 50.451C93.8065 46.9363 93.8065 41.2378 90.2918 37.7231L84.6349 43.38ZM83.2207 43.38C83.6112 42.9894 84.2444 42.9894 84.6349 43.38L90.2918 37.7231C86.7771 34.2084 81.0786 34.2084 77.5639 37.7231L83.2207 43.38ZM66.8433 59.7574L83.2207 43.38L77.5639 37.7231L61.1864 54.1006L66.8433 59.7574ZM44.809 43.38L61.1864 59.7574L66.8433 54.1006L50.4659 37.7232L44.809 43.38ZM43.3948 43.38C43.7853 42.9895 44.4185 42.9895 44.809 43.38L50.4659 37.7232C46.9512 34.2084 41.2527 34.2084 37.738 37.7232L43.3948 43.38ZM43.3948 44.7942C43.0043 44.4037 43.0043 43.7705 43.3948 43.38L37.738 37.7232C34.2232 41.2379 34.2232 46.9364 37.738 50.4511L43.3948 44.7942ZM59.7722 61.1716L43.3948 44.7942L37.738 50.4511L54.1153 66.8285L59.7722 61.1716ZM43.3948 83.2059L59.7722 66.8285L54.1153 61.1716L37.738 77.549L43.3948 83.2059ZM43.3948 84.6201C43.0043 84.2295 43.0043 83.5964 43.3948 83.2059L37.738 77.549C34.2232 81.0637 34.2232 86.7622 37.738 90.2769L43.3948 84.6201ZM44.809 84.6201C44.4185 85.0106 43.7853 85.0106 43.3948 84.6201L37.738 90.2769C41.2527 93.7916 46.9512 93.7917 50.4659 90.2769L44.809 84.6201ZM61.1864 68.2427L44.809 84.6201L50.4659 90.2769L66.8433 73.8995L61.1864 68.2427ZM83.2207 84.6201L66.8433 68.2427L61.1864 73.8995L77.5638 90.277L83.2207 84.6201ZM84.6349 84.6201C84.2444 85.0107 83.6112 85.0107 83.2207 84.6201L77.5638 90.277C81.0786 93.7917 86.777 93.7917 90.2918 90.277L84.6349 84.6201ZM84.6349 83.2059C85.0254 83.5964 85.0254 84.2296 84.6349 84.6201L90.2918 90.277C93.8065 86.7623 93.8065 81.0638 90.2918 77.5491L84.6349 83.2059ZM68.2575 66.8285L84.6349 83.2059L90.2918 77.5491L73.9143 61.1716L68.2575 66.8285ZM84.6349 44.7942L68.2575 61.1716L73.9143 66.8285L90.2918 50.451L84.6349 44.7942Z" fill="#404040" mask="url(#path-5-outside-1)"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="64" cy="64" r="64" fill="#404040"></circle><rect x="58.5789" y="94.0632" width="10.8424" height="14.0748" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z" fill="white"></path><rect x="53.3186" y="19.862" width="21.3628" height="63.6407" rx="10.6814" fill="white"></rect><mask id="path-5-outside-1" maskUnits="userSpaceOnUse" x="10.9819" y="11.4462" width="106.066" height="106.066" fill="black"><rect fill="white" x="10.9819" y="11.4462" width="106.066" height="106.066"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z"></path></mask><path fill-rule="evenodd" clip-rule="evenodd" d="M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z" fill="#FF6479"></path><path d="M64.0148 56.929L61.1864 59.7574L64.0148 62.5858L66.8433 59.7574L64.0148 56.929ZM47.6375 40.5516L44.809 43.38L47.6375 40.5516ZM40.5664 40.5516L43.3948 43.38L40.5664 40.5516ZM56.9438 64.0001L59.7722 66.8285L62.6006 64.0001L59.7722 61.1716L56.9438 64.0001ZM40.5664 80.3774L37.738 77.549L40.5664 80.3774ZM47.6375 87.4485L44.809 84.6201L47.6375 87.4485ZM64.0148 71.0711L66.8433 68.2427L64.0148 65.4143L61.1864 68.2427L64.0148 71.0711ZM87.4633 87.4486L90.2918 90.277L90.2918 90.277L87.4633 87.4486ZM71.0859 64.0001L68.2575 61.1716L65.4291 64.0001L68.2575 66.8285L71.0859 64.0001ZM84.6349 43.38C85.0254 43.7705 85.0254 44.4037 84.6349 44.7942L90.2918 50.451C93.8065 46.9363 93.8065 41.2378 90.2918 37.7231L84.6349 43.38ZM83.2207 43.38C83.6112 42.9894 84.2444 42.9894 84.6349 43.38L90.2918 37.7231C86.7771 34.2084 81.0786 34.2084 77.5639 37.7231L83.2207 43.38ZM66.8433 59.7574L83.2207 43.38L77.5639 37.7231L61.1864 54.1006L66.8433 59.7574ZM44.809 43.38L61.1864 59.7574L66.8433 54.1006L50.4659 37.7232L44.809 43.38ZM43.3948 43.38C43.7853 42.9895 44.4185 42.9895 44.809 43.38L50.4659 37.7232C46.9512 34.2084 41.2527 34.2084 37.738 37.7232L43.3948 43.38ZM43.3948 44.7942C43.0043 44.4037 43.0043 43.7705 43.3948 43.38L37.738 37.7232C34.2232 41.2379 34.2232 46.9364 37.738 50.4511L43.3948 44.7942ZM59.7722 61.1716L43.3948 44.7942L37.738 50.4511L54.1153 66.8285L59.7722 61.1716ZM43.3948 83.2059L59.7722 66.8285L54.1153 61.1716L37.738 77.549L43.3948 83.2059ZM43.3948 84.6201C43.0043 84.2295 43.0043 83.5964 43.3948 83.2059L37.738 77.549C34.2232 81.0637 34.2232 86.7622 37.738 90.2769L43.3948 84.6201ZM44.809 84.6201C44.4185 85.0106 43.7853 85.0106 43.3948 84.6201L37.738 90.2769C41.2527 93.7916 46.9512 93.7917 50.4659 90.2769L44.809 84.6201ZM61.1864 68.2427L44.809 84.6201L50.4659 90.2769L66.8433 73.8995L61.1864 68.2427ZM83.2207 84.6201L66.8433 68.2427L61.1864 73.8995L77.5638 90.277L83.2207 84.6201ZM84.6349 84.6201C84.2444 85.0107 83.6112 85.0107 83.2207 84.6201L77.5638 90.277C81.0786 93.7917 86.777 93.7917 90.2918 90.277L84.6349 84.6201ZM84.6349 83.2059C85.0254 83.5964 85.0254 84.2296 84.6349 84.6201L90.2918 90.277C93.8065 86.7623 93.8065 81.0638 90.2918 77.5491L84.6349 83.2059ZM68.2575 66.8285L84.6349 83.2059L90.2918 77.5491L73.9143 61.1716L68.2575 66.8285ZM84.6349 44.7942L68.2575 61.1716L73.9143 66.8285L90.2918 50.451L84.6349 44.7942Z" fill="#404040" mask="url(#path-5-outside-1)"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="64" cy="64" r="64" fill="#404040"></circle><rect x="58.5789" y="94.0632" width="10.8424" height="14.0748" fill="white"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z" fill="white"></path><rect x="53.3186" y="19.862" width="21.3628" height="63.6407" rx="10.6814" fill="white"></rect><mask id="path-5-outside-1" maskUnits="userSpaceOnUse" x="10.9819" y="11.4462" width="106.066" height="106.066" fill="black"><rect fill="white" x="10.9819" y="11.4462" width="106.066" height="106.066"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M87.4634 47.6226C89.416 45.67 89.416 42.5042 87.4634 40.5515C85.5108 38.5989 82.3449 38.5989 80.3923 40.5515L64.0149 56.929L47.6375 40.5516C45.6849 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6849 89.4011 47.6375 87.4485L64.0149 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4634 87.4486C89.416 85.4959 89.416 82.3301 87.4634 80.3775L71.0859 64.0001L87.4634 47.6226Z"></path></mask><path fill-rule="evenodd" clip-rule="evenodd" d="M87.4634 47.6226C89.416 45.67 89.416 42.5042 87.4634 40.5515C85.5108 38.5989 82.3449 38.5989 80.3923 40.5515L64.0149 56.929L47.6375 40.5516C45.6849 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6849 89.4011 47.6375 87.4485L64.0149 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4634 87.4486C89.416 85.4959 89.416 82.3301 87.4634 80.3775L71.0859 64.0001L87.4634 47.6226Z" fill="#FF3550"></path><path d="M64.0149 56.929L61.1864 59.7574L64.0149 62.5858L66.8433 59.7574L64.0149 56.929ZM40.5664 40.5516L43.3948 43.38L40.5664 40.5516ZM40.5664 47.6227L43.3948 44.7942L40.5664 47.6227ZM56.9438 64.0001L59.7722 66.8285L62.6007 64.0001L59.7722 61.1716L56.9438 64.0001ZM64.0149 71.0711L66.8433 68.2427L64.0149 65.4143L61.1864 68.2427L64.0149 71.0711ZM87.4634 87.4486L90.2918 90.277L90.2918 90.277L87.4634 87.4486ZM71.0859 64.0001L68.2575 61.1716L65.4291 64.0001L68.2575 66.8285L71.0859 64.0001ZM84.635 43.38C85.0255 43.7705 85.0255 44.4037 84.635 44.7942L90.2918 50.451C93.8065 46.9363 93.8065 41.2378 90.2918 37.7231L84.635 43.38ZM83.2207 43.38C83.6113 42.9894 84.2444 42.9894 84.635 43.38L90.2918 37.7231C86.7771 34.2084 81.0786 34.2084 77.5639 37.7231L83.2207 43.38ZM66.8433 59.7574L83.2207 43.38L77.5639 37.7231L61.1864 54.1006L66.8433 59.7574ZM44.8091 43.38L61.1864 59.7574L66.8433 54.1006L50.4659 37.7232L44.8091 43.38ZM43.3948 43.38C43.7854 42.9895 44.4185 42.9895 44.8091 43.38L50.4659 37.7232C46.9512 34.2084 41.2527 34.2084 37.738 37.7232L43.3948 43.38ZM43.3948 44.7942C43.0043 44.4037 43.0043 43.7705 43.3948 43.38L37.738 37.7232C34.2233 41.2379 34.2233 46.9364 37.738 50.4511L43.3948 44.7942ZM59.7722 61.1716L43.3948 44.7942L37.738 50.4511L54.1154 66.8285L59.7722 61.1716ZM43.3949 83.2059L59.7722 66.8285L54.1154 61.1716L37.738 77.549L43.3949 83.2059ZM43.3949 84.6201C43.0043 84.2295 43.0043 83.5964 43.3949 83.2059L37.738 77.549C34.2233 81.0637 34.2233 86.7622 37.738 90.2769L43.3949 84.6201ZM44.8091 84.6201C44.4185 85.0106 43.7854 85.0106 43.3949 84.6201L37.738 90.2769C41.2527 93.7916 46.9512 93.7917 50.4659 90.2769L44.8091 84.6201ZM61.1864 68.2427L44.8091 84.6201L50.4659 90.2769L66.8433 73.8995L61.1864 68.2427ZM83.2207 84.6201L66.8433 68.2427L61.1864 73.8995L77.5639 90.277L83.2207 84.6201ZM84.6349 84.6201C84.2444 85.0107 83.6113 85.0107 83.2207 84.6201L77.5639 90.277C81.0786 93.7917 86.7771 93.7917 90.2918 90.277L84.6349 84.6201ZM84.6349 83.2059C85.0255 83.5964 85.0255 84.2296 84.6349 84.6201L90.2918 90.277C93.8065 86.7623 93.8065 81.0638 90.2918 77.5491L84.6349 83.2059ZM68.2575 66.8285L84.6349 83.2059L90.2918 77.5491L73.9144 61.1716L68.2575 66.8285ZM84.635 44.7942L68.2575 61.1716L73.9144 66.8285L90.2918 50.451L84.635 44.7942Z" fill="#404040" mask="url(#path-5-outside-1)"></path></svg>'},function(e,t,i){e.exports={label:"spectating-label__label__3JS5A"}},,,,function(e,t){e.exports="#version 300 es\nprecision highp float;\nprecision highp int;\n\n// Keep these separate so three only sets them once\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\nlayout(std140) uniform InstanceData {\n  mat4 transforms[MAX_INSTANCES];\n  vec4 colors[MAX_INSTANCES];\n  vec4 uvTransforms[MAX_INSTANCES];\n  vec4 mapSettings[MAX_INSTANCES];\n\n  vec4 hubs_SweepParams[MAX_INSTANCES];\n\n  vec3 hubs_InteractorOnePos;\n  bool hubs_IsFrozen;\n\n  vec3 hubs_InteractorTwoPos;\n  float hubs_Time;\n\n} instanceData;\n\nout vec3 hubs_WorldPosition;\nout float fogDepth;\n\nin vec3 position;\nin vec2 uv;\n\n#ifdef PSEUDO_INSTANCING\nin float instance;\nflat out uint vInstance;\n#endif\n\n#ifdef VERTEX_COLORS\nin vec3 color;\n#endif\n\nout vec2 vUv;\nout vec4 vColor;\n\nflat out vec4 vUVTransform;\nflat out vec4 vMapSettings;\n\nvoid main() {\n  #ifdef PSEUDO_INSTANCING\n  uint instanceIndex = uint(instance);\n  #elif\n  uint instanceIndex = gl_InstanceID;\n  #endif\n\n  vColor = instanceData.colors[instanceIndex];\n\n  #ifdef VERTEX_COLORS\n  vColor *= vec4(color, 1.0);\n  #endif\n\n  vUv = uv;\n  vUVTransform = instanceData.uvTransforms[instanceIndex];\n  vMapSettings = instanceData.mapSettings[instanceIndex];\n\n  vec4 mvPosition = viewMatrix * instanceData.transforms[instanceIndex] * vec4(position, 1.0);\n\n  gl_Position = projectionMatrix * mvPosition;\n\n  hubs_WorldPosition = (instanceData.transforms[instanceIndex] * vec4(position, 1.0)).xyz;\n  vInstance = instanceIndex;\n\n  fogDepth = -mvPosition.z;\n}\n"},function(e,t){e.exports="#version 300 es\nprecision highp float;\nprecision highp int;\nprecision highp sampler2DArray;\n\nlayout(std140) uniform InstanceData {\n  mat4 transforms[MAX_INSTANCES];\n  vec4 colors[MAX_INSTANCES];\n  vec4 uvTransforms[MAX_INSTANCES];\n  vec4 mapSettings[MAX_INSTANCES];\n\n  vec4 hubs_SweepParams[MAX_INSTANCES];\n\n  vec3 hubs_InteractorOnePos;\n  bool hubs_IsFrozen;\n\n  vec3 hubs_InteractorTwoPos;\n  float hubs_Time;\n\n} instanceData;\nin vec3 hubs_WorldPosition;\n#ifdef PSEUDO_INSTANCING\nflat in uint vInstance;\n#endif\n\n\nuniform sampler2DArray map;\n\nin float fogDepth;\nuniform vec3 fogColor;\n\n// Fog Type\n// 0.0 -> disabled\n// 1.0 -> linear\n// 2.0 -> exponential\nuniform vec4 fogOptions; // r = type; g = density; b = near; a = far;\n\nin vec2 vUv;\nin vec4 vColor;\nflat in vec4 vUVTransform;\nflat in vec4 vMapSettings;\n\nout vec4 outColor;\n\nfloat applyWrapping(float value, int mode) {\n  if (mode == 0) {\n    // CLAMP_TO_EDGE - default\n    return clamp(value, 0.0, 1.0);\n  } else if (mode == 1) {\n    // REPEAT\n    return fract(value);\n  } else {\n    // MIRRORED_REPEAT\n    float n = mod(value, 2.0);\n    return mix(n, 2.0 - n, step(1.0, n));\n  }\n}\n\nvoid main() {\n  vec2 uv = vUv;\n\n  int wrapS = int(vMapSettings.y);\n  int wrapT = int(vMapSettings.z);\n  uv.s = applyWrapping(uv.s, wrapS);\n  uv.t = applyWrapping(uv.t, wrapT);\n\n  vec2 uvMin = vUVTransform.xy;\n  vec2 uvScale = vUVTransform.zw;\n  uv = uvMin + uv * uvScale;\n\n  int mapIdx = int(vMapSettings.x);\n  outColor = texture(map, vec3(uv, mapIdx)) * vColor;\n  if(outColor.a == 0.0) {\n      discard;\n  }\n\n  bool hubs_HighlightInteractorOne = instanceData.hubs_SweepParams[vInstance].z > 0.0;\n  bool hubs_HighlightInteractorTwo = instanceData.hubs_SweepParams[vInstance].w > 0.0;\n  bool hubs_IsFrozen = instanceData.hubs_IsFrozen;\n\n  if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\n\n      bool hubs_EnableSweepingEffect = true;\n      vec2 hubs_SweepParams = instanceData.hubs_SweepParams[vInstance].xy;\n      float hubs_Time = instanceData.hubs_Time;\n\n      float ratio = 0.0;\n      float size = hubs_SweepParams.t - hubs_SweepParams.s;\n\n      if (hubs_EnableSweepingEffect) {\n          float line = mod(hubs_Time / 500.0 * size, size * 3.0) + hubs_SweepParams.s - size / 3.0;\n\n          if (hubs_WorldPosition.y < line) {\n              // Highlight with a sweeping gradient.\n              ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\n          }\n      }\n\n      // Highlight with a gradient falling off with distance.\n      float pulse = 1.0 / (size + 0.2) * 8.0 + 1.0 / (size + 0.3) * 3.0 * (sin(hubs_Time / 1000.0) + 1.0);\n\n      if (hubs_HighlightInteractorOne) {\n          float dist1 = distance(hubs_WorldPosition, instanceData.hubs_InteractorOnePos);\n          ratio += -min(1.0, pow(dist1 * pulse, 3.0)) + 1.0;\n      }\n\n      if (hubs_HighlightInteractorTwo) {\n          float dist2 = distance(hubs_WorldPosition, instanceData.hubs_InteractorTwoPos);\n          ratio += -min(1.0, pow(dist2 * pulse, 3.0)) + 1.0;\n      }\n\n      ratio = min(1.0, ratio);\n\n      // Gamma corrected highlight color\n      vec3 highlightColor = vec3(0.184, 0.499, 0.933);\n\n      outColor = vec4((outColor.rgb * (1.0 - ratio)) + (highlightColor * ratio), outColor.a);\n  }\n\n  float fogType = fogOptions.r;\n\n  if (fogType > 0.5) {\n    float fogFactor = 0.0;\n\n    if (fogType < 1.5) {\n      float fogNear = fogOptions.z;\n      float fogFar = fogOptions.w;\n      fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n    } else {\n      float fogDensity = fogOptions.y;\n      fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n    }\n\n    outColor.rgb = mix( outColor.rgb, fogColor, fogFactor );\n  }\n}\n"},function(e){e.exports={meta:{image:"sprite-system-notice-spritesheet.png",size:{w:2048,h:2048},scale:"1"},frames:{"spawn-point.png":{frame:{x:8,y:8,w:512,h:512},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:512,h:512},sourceSize:{w:512,h:512}},"volume_up-hover.png":{frame:{x:536,y:8,w:256,h:256},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:256,h:256},sourceSize:{w:256,h:256}},"pause-hover.png":{frame:{x:536,y:280,w:192,h:192},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:192,h:192},sourceSize:{w:192,h:192}},"pause.png":{frame:{x:8,y:536,w:192,h:192},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:192,h:192},sourceSize:{w:192,h:192}},"play-hover.png":{frame:{x:216,y:536,w:192,h:192},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:192,h:192},sourceSize:{w:192,h:192}},"play.png":{frame:{x:424,y:536,w:192,h:192},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:192,h:192},sourceSize:{w:192,h:192}},"create_object-hover.png":{frame:{x:632,y:536,w:132,h:132},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:132,h:132},sourceSize:{w:132,h:132}},"create_object.png":{frame:{x:808,y:8,w:132,h:132},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:132,h:132},sourceSize:{w:132,h:132}},"freeze_off-hover.png":{frame:{x:808,y:156,w:132,h:132},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:132,h:132},sourceSize:{w:132,h:132}},"freeze_off.png":{frame:{x:808,y:304,w:132,h:132},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:132,h:132},sourceSize:{w:132,h:132}},"freeze_on-hover.png":{frame:{x:808,y:452,w:132,h:132},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:132,h:132},sourceSize:{w:132,h:132}},"freeze_on.png":{frame:{x:8,y:744,w:132,h:132},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:132,h:132},sourceSize:{w:132,h:132}},"mic-0.png":{frame:{x:808,y:600,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-1.png":{frame:{x:300,y:744,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-2.png":{frame:{x:588,y:744,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-3.png":{frame:{x:956,y:8,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-4.png":{frame:{x:956,y:296,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-5.png":{frame:{x:956,y:584,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-6.png":{frame:{x:8,y:892,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-7.png":{frame:{x:296,y:892,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-off-0.png":{frame:{x:584,y:892,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-off-1.png":{frame:{x:872,y:892,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-off-2.png":{frame:{x:1100,y:152,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-off-3.png":{frame:{x:1100,y:440,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-off-4.png":{frame:{x:1100,y:728,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-off-5.png":{frame:{x:8,y:1036,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-off-6.png":{frame:{x:296,y:1036,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-off-7.png":{frame:{x:584,y:1036,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"Background.png":{frame:{x:872,y:1036,w:128,h:48},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:48},sourceSize:{w:128,h:48}},"seek_back-hover.png":{frame:{x:1244,y:8,w:96,h:96},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:96,h:96},sourceSize:{w:96,h:96}},"seek_back.png":{frame:{x:1244,y:120,w:96,h:96},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:96,h:96},sourceSize:{w:96,h:96}},"seek_fwd-hover.png":{frame:{x:1244,y:232,w:96,h:96},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:96,h:96},sourceSize:{w:96,h:96}},"seek_fwd.png":{frame:{x:1244,y:344,w:96,h:96},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:96,h:96},sourceSize:{w:96,h:96}},"snap-hover.png":{frame:{x:1244,y:456,w:96,h:96},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:96,h:96},sourceSize:{w:96,h:96}},"snap.png":{frame:{x:1244,y:568,w:96,h:96},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:96,h:96},sourceSize:{w:96,h:96}},"volume_down-hover.png":{frame:{x:1244,y:680,w:96,h:96},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:96,h:96},sourceSize:{w:96,h:96}},"volume_down.png":{frame:{x:1244,y:792,w:96,h:96},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:96,h:96},sourceSize:{w:96,h:96}},"volume_up.png":{frame:{x:1244,y:904,w:96,h:96},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:96,h:96},sourceSize:{w:96,h:96}},"camera_off-disabled.png":{frame:{x:1244,y:1016,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"camera_off-hover.png":{frame:{x:1016,y:892,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"camera_off.png":{frame:{x:8,y:1180,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"camera_on-hover.png":{frame:{x:92,y:1180,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"camera_on.png":{frame:{x:176,y:1180,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"mute_off-hover.png":{frame:{x:260,y:1180,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"mute_off.png":{frame:{x:344,y:1180,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"pen_off-disabled.png":{frame:{x:428,y:1180,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"pen_off-hover.png":{frame:{x:512,y:1180,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"pen_off.png":{frame:{x:596,y:1180,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"pen_on-hover.png":{frame:{x:680,y:1180,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"pen_on.png":{frame:{x:764,y:1180,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"share_camera_off-hover.png":{frame:{x:848,y:1180,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"share_camera_off.png":{frame:{x:932,y:1180,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"share_camera_on-hover.png":{frame:{x:1016,y:1180,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"share_camera_on.png":{frame:{x:1100,y:1180,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"share_screen_off.png":{frame:{x:1184,y:1180,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"share_screen_on-hover.png":{frame:{x:1268,y:1180,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"share_screen_on.png":{frame:{x:8,y:1264,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"share_window_off-hover.png":{frame:{x:92,y:1264,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"share_window_off.png":{frame:{x:176,y:1264,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"share_window_on-hover.png":{frame:{x:260,y:1264,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"share_window_on.png":{frame:{x:344,y:1264,w:68,h:68},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:68,h:68},sourceSize:{w:68,h:68}},"mute_on-hover.png":{frame:{x:1244,y:1100,w:66,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:66,h:64},sourceSize:{w:66,h:64}},"close-white.png":{frame:{x:876,y:744,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"focus-action.png":{frame:{x:872,y:1100,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"mute_on.png":{frame:{x:952,y:1100,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"rotate-cursor.png":{frame:{x:1032,y:1100,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"snap_camera.png":{frame:{x:1112,y:1100,w:64,h:64},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:64,h:64},sourceSize:{w:64,h:64}},"mic-0_hover.png":{frame:{x:156,y:744,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-1_hover.png":{frame:{x:444,y:744,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-2_hover.png":{frame:{x:732,y:744,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-3_hover.png":{frame:{x:956,y:152,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-4_hover.png":{frame:{x:956,y:440,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-5_hover.png":{frame:{x:956,y:728,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-6_hover.png":{frame:{x:152,y:892,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-7_hover.png":{frame:{x:440,y:892,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-off-0_hover.png":{frame:{x:728,y:892,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-off-1_hover.png":{frame:{x:1100,y:8,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-off-2_hover.png":{frame:{x:1100,y:296,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-off-3_hover.png":{frame:{x:1100,y:584,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-off-4_hover.png":{frame:{x:1100,y:872,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-off-5_hover.png":{frame:{x:152,y:1036,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-off-6_hover.png":{frame:{x:440,y:1036,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}},"mic-off-7_hover.png":{frame:{x:728,y:1036,w:128,h:128},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:128,h:128},sourceSize:{w:128,h:128}}}}},function(e,t,i){e.exports=i.p+"assets/images/spritesheets/sprite-system-action-spritesheet-63df7c855b130ea65c284bd3f8e98afc.png"},function(e,t,i){e.exports=i.p+"assets/images/spritesheets/sprite-system-notice-spritesheet-0b7026f818dc58d5d33db88931d02c7a.png"},function(e,t){e.exports="attribute vec4 mvCol0;\nattribute vec4 mvCol1;\nattribute vec4 mvCol2;\nattribute vec4 mvCol3;\nattribute vec3 a_vertices;\nattribute vec2 a_uvs;\nvarying vec2 v_uvs;\nattribute float a_hubs_EnableSweepingEffect;\nvarying float v_hubs_EnableSweepingEffect;\nattribute vec2 a_hubs_SweepParams;\nvarying vec2 v_hubs_SweepParams;\nvarying vec3 hubs_WorldPosition;\n\nvoid main() {\n  mat4 mv = mat4(mvCol0, mvCol1, mvCol2, mvCol3);\n  gl_Position = projectionMatrix * modelViewMatrix * mv * vec4(a_vertices, 1.0);\n  v_uvs = a_uvs;\n  v_hubs_EnableSweepingEffect = a_hubs_EnableSweepingEffect;\n  v_hubs_SweepParams = a_hubs_SweepParams;\n\n  vec4 wt = vec4(a_vertices, 1.0);\n  hubs_WorldPosition = (mv * wt).xyz;\n}\n"},function(e,t){e.exports="precision mediump float;\n\nuniform sampler2D u_spritesheet;\n\nvarying vec2 v_uvs;\n\nvarying float v_hubs_EnableSweepingEffect;\nvarying vec2 v_hubs_SweepParams;\nvarying vec3 hubs_WorldPosition;\nuniform bool hubs_HighlightInteractorOne;\nuniform vec3 hubs_InteractorOnePos;\nuniform bool hubs_HighlightInteractorTwo;\nuniform vec3 hubs_InteractorTwoPos;\nuniform float hubs_Time;\n\n#define GAMMA_FACTOR 2.2\n\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\n\nvec4 linearToOutputTexel( vec4 value ) {\n  return LinearToGamma( value, float( GAMMA_FACTOR ) );\n}\n\nvoid main() {\n    vec4 texColor = texture2D(u_spritesheet, v_uvs);\n\n    float ratio = 0.0;\n    if (v_hubs_EnableSweepingEffect > 0.9 ) {\n        float size = v_hubs_SweepParams.t - v_hubs_SweepParams.s * 1.0;\n        float line = mod(hubs_Time / 500.0 * size, size * 3.0) + v_hubs_SweepParams.s - size / 3.0;\n        if (hubs_WorldPosition.y < line) {\n            ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\n        }\n\n    }\n    ratio = min(1.0, ratio);\n\n    vec4 highlightColor = linearToOutputTexel(vec4(0.184, 0.499, 0.933, 1.0));\n    gl_FragColor = vec4((texColor.rgb * (1.0 - ratio)) + (highlightColor.rgb * ratio), texColor.a);\n}\n"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";var _qs_truthy__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(21);const showLog=Object(_qs_truthy__WEBPACK_IMPORTED_MODULE_0__.a)("debug_log");if(showLog){const template=document.createElement("template");template.innerHTML='\n    <style>\n      #debug-log {\n        position: absolute;\n        top: 13em;\n        background: white;\n        opacity: 0.7;\n        z-index: 1000;\n      }\n      #debug-log, #debug-log-input {\n        font-family: monospace;\n        font-size: 11px;\n        width: 100%;\n      }\n\n      #debug-log-controls {\n        display: flex;\n        padding: 0.2em;\n      }\n\n      #debug-log-eval {\n        display: flex;\n        flex: 1;\n      }\n\n      #debug-log-log {\n        overflow: auto;\n        height: 30vh;\n      }\n      #debug-log-log.minimized {\n        height: auto;\n      }\n      #debug-log-log.minimized .entry {\n        display: none;\n      }\n      #debug-log-log.minimized .entry:last-child {\n        display: block;\n      }\n      #debug-log-log .entry {\n        border: 1px solid grey;\n        margin: 0.2em;\n        padding: 0.2em;\n      }\n      #debug-log-log .entry.error { background-color: pink; }\n      #debug-log-log .entry.warn { background-color: orange; }\n    </style>\n    <div id="debug-log">\n        <div id="debug-log-controls">\n          <form id="debug-log-eval">\n            <input id="debug-log-input" placeholder="&gt;&gt;" autocorrect="off" autocapitalize="none" />\n            <button>&gt;</button>\n          </form>\n          <button id="debug-log-minimize">_</button>\n        </div>\n        <div id="debug-log-log"></div>\n    </div>\n  ',document.addEventListener("DOMContentLoaded",()=>{document.body.appendChild(template.content)});const debugLog=template.content.querySelector("#debug-log-log");debugLog.addEventListener("wheel",e=>e.stopPropagation());const debugLogInput=template.content.querySelector("#debug-log-input"),debugLogEval=template.content.querySelector("#debug-log-eval");debugLogEval.onsubmit=e=>{e.preventDefault(),console.log(eval(`(${debugLogInput.value})`))};let minimized=!1;const debugLogMinimize=template.content.querySelector("#debug-log-minimize");debugLogMinimize.onclick=()=>{minimized=!minimized,debugLog.className=minimized?"minimized":"",debugLog.scrollTop=debugLog.scrollHeight-debugLog.clientHeight};const origConsoleInfo=console.info,origConsoleLog=console.log,origConsoleError=console.error,origConsoleWarn=console.warn,log=function(e,t){let i;debugLog.childNodes.length>1e3?i=debugLog.firstChild:(i=document.createElement("div")).classList.add("entry"),i.classList.remove("warn","error"),i.classList.add(e);const n=Array.from(t),a=n[0];let s;s="string"==typeof a&&a.includes("%c")?a.replace(/%c/g,""):a instanceof Error?`${a.message}\n${a.stack}`:n.map(e=>"string"==typeof e?e:JSON.stringify(e)).join(" ");const o=(new Date).toISOString().substring(11,23);i.textContent=`[${o}] ${s}`;const r=debugLog.scrollTop===debugLog.scrollHeight-debugLog.clientHeight;debugLog.append(i),r&&(debugLog.scrollTop=debugLog.scrollHeight-debugLog.clientHeight)};console.warn=function(){origConsoleWarn.apply(null,arguments),log("warn",arguments)},console.error=function(){origConsoleError.apply(null,arguments),log("error",arguments)},console.log=function(){origConsoleLog.apply(null,arguments),log("log",arguments)},console.info=function(){origConsoleInfo.apply(null,arguments),log("info",arguments)},window.onunhandledrejection=e=>log("error",[e.reason.message,e.reason.code,e.reason.name]),window.onerror=e=>log("error",[e])}},function(e,t,i){e.exports={ui:"hub__ui__3UYRO","ui-dialog":"hub__ui-dialog__vlyfc",uiDialog:"hub__ui-dialog__vlyfc","ui-interactive":"hub__ui-interactive__3bdyc",uiInteractive:"hub__ui-interactive__3bdyc","object-list":"hub__object-list__Y0_hh",objectList:"hub__object-list__Y0_hh","presence-info":"hub__presence-info__dqWyo",presenceInfo:"hub__presence-info__dqWyo","corner-button":"hub__corner-button__2KphD",cornerButton:"hub__corner-button__2KphD","profile-entry":"hub__profile-entry__1RY0R",profileEntry:"hub__profile-entry__1RY0R","form-submit":"hub__form-submit__12yem",formSubmit:"hub__form-submit__12yem","nag-corner-button":"hub__nag-corner-button__lNoyE",nagCornerButton:"hub__nag-corner-button__lNoyE","choose-scene-button":"hub__choose-scene-button__5Y0Q_",chooseSceneButton:"hub__choose-scene-button__5Y0Q_","choose-avatar":"hub__choose-avatar__22JJm",chooseAvatar:"hub__choose-avatar__22JJm","entry-button-secondary":"hub__entry-button-secondary__2ui-g",entryButtonSecondary:"hub__entry-button-secondary__2ui-g","entry-panel":"hub__entry-panel__cCmIv",entryPanel:"hub__entry-panel__cCmIv","button-container":"hub__button-container__38FOc",buttonContainer:"hub__button-container__38FOc","secondary-action-button":"hub__secondary-action-button__2KoCD",secondaryActionButton:"hub__secondary-action-button__2KoCD","leave-button":"hub__leave-button__1YK4o",leaveButton:"hub__leave-button__1YK4o",interstitial:"hub__interstitial__3WXbJ","entry-button":"hub__entry-button__1e9jM",entryButton:"hub__entry-button__1e9jM","action-button":"hub__action-button__3zqlu",actionButton:"hub__action-button__3zqlu","collapse-button":"hub__collapse-button__3N-6b",collapseButton:"hub__collapse-button__3N-6b","favorite-button":"hub__favorite-button__1Qgbp",favoriteButton:"hub__favorite-button__1Qgbp",back:"hub__back__3AZh2","form-field-text":"hub__form-field-text__tR1Lt",formFieldText:"hub__form-field-text__tR1Lt","lobby-label":"hub__lobby-label__2ktmo",lobbyLabel:"hub__lobby-label__2ktmo",label:"hub__label__1kjp1",title:"hub__title__ezGEu",name:"hub__name__2umw1","rename-button":"hub__rename-button__h-4K7",renameButton:"hub__rename-button__h-4K7",center:"hub__center__1Mvfu","wide-button":"hub__wide-button__1yqDc",wideButton:"hub__wide-button__1yqDc","screen-sharing":"hub__screen-sharing__2VF91",screenSharing:"hub__screen-sharing__2VF91",checkbox:"hub__checkbox__32dyv",close:"hub__close__gWtCN","invite-tip":"hub__invite-tip__9enoe",inviteTip:"hub__invite-tip__9enoe","loading-text":"hub__loading-text__1WDud",loadingText:"hub__loading-text__1WDud","streaming-tip":"hub__streaming-tip__1LnId",streamingTip:"hub__streaming-tip__1LnId","streaming-tip-attach-point":"hub__streaming-tip-attach-point__1oCgh",streamingTipAttachPoint:"hub__streaming-tip-attach-point__1oCgh","streaming-tip-close":"hub__streaming-tip-close__E6fwS",streamingTipClose:"hub__streaming-tip-close__E6fwS","streaming-tip-message":"hub__streaming-tip-message__XcScW",streamingTipMessage:"hub__streaming-tip-message__XcScW","ui-dialog-box-contents":"hub__ui-dialog-box-contents__PZ5qP",uiDialogBoxContents:"hub__ui-dialog-box-contents__PZ5qP",backgrounded:"hub__backgrounded__30IfD","in-room-favorite-button":"hub__in-room-favorite-button__2T-zs",inRoomFavoriteButton:"hub__in-room-favorite-button__2T-zs","help-button":"hub__help-button__3TCSZ",helpButton:"hub__help-button__3TCSZ","occupant-count":"hub__occupant-count__3eAEj",occupantCount:"hub__occupant-count__3eAEj","presence-info-selected":"hub__presence-info-selected__FRBSA",presenceInfoSelected:"hub__presence-info-selected__FRBSA","camera-mode-exit-button":"hub__camera-mode-exit-button__BqKKt",cameraModeExitButton:"hub__camera-mode-exit-button__BqKKt","corner-button-selected":"hub__corner-button-selected__Cqa93",cornerButtonSelected:"hub__corner-button-selected__Cqa93","invite-tip-attach-point":"hub__invite-tip-attach-point__2y_bz",inviteTipAttachPoint:"hub__invite-tip-attach-point__2y_bz","avatar-editor":"hub__avatar-editor__2b8-H",avatarEditor:"hub__avatar-editor__2b8-H",logo:"hub__logo__3kJSj",form:"hub__form__3kQXh",box:"hub__box__2SMbn",links:"hub__links__1C6Ce","display-name":"hub__display-name__36hFZ",displayName:"hub__display-name__36hFZ",preview:"hub__preview__2UUoU","edit-avatar":"hub__edit-avatar__22A53",editAvatar:"hub__edit-avatar__22A53","entry-dialog":"hub__entry-dialog__2Ljux",entryDialog:"hub__entry-dialog__2Ljux",favorited:"hub__favorited__3c3lB",icon:"hub__icon__1pzf7",bolded:"hub__bolded__2MYLZ",subtitle:"hub__subtitle__3kYcd","room-subtitle":"hub__room-subtitle__GhUCG",roomSubtitle:"hub__room-subtitle__GhUCG",lobby:"hub__lobby__2VW6G","profile-icon":"hub__profile-icon__fwSfD",profileIcon:"hub__profile-icon__fwSfD","button-subtitle":"hub__button-subtitle__3kkpo",buttonSubtitle:"hub__button-subtitle__3kkpo","audio-loader":"hub__audio-loader__F5ovU",audioLoader:"hub__audio-loader__F5ovU","webvr-link-container":"hub__webvr-link-container__1Vq5m",webvrLinkContainer:"hub__webvr-link-container__1Vq5m","webvr-link":"hub__webvr-link__xW04U",webvrLink:"hub__webvr-link__xW04U",secondary:"hub__secondary__22yt_"}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){AFRAME.registerSystem("my-component",{init:function(){console.log(`The "${this.name}" system is initializing!`),this.entities=[]},registerMe:function(e){this.entities.push(e)},unregisterMe:function(e){var t=this.entities.indexOf(e);this.entities.splice(t,1)}}),AFRAME.registerComponent("my-component",{init:function(){this.system.registerMe(this.el)},remove:function(){this.system.unregisterMe(this.el)}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){document.addEventListener("DOMContentLoaded",()=>{const e=THREE.AudioContext.getContext();function t(){e.resume(),setTimeout(function(){"running"===e.state&&(document.body.removeEventListener("touchend",t,!1),document.body.removeEventListener("mouseup",t,!1))},0)}document.body.addEventListener("touchend",t,!1),document.body.addEventListener("mouseup",t,!1)})},function(e,t){THREE.PositionalAudio.prototype.updateMatrixWorld=function(){const e=new THREE.Vector3,t=new THREE.Quaternion,i=new THREE.Vector3,n=new THREE.Vector3;return function(a){THREE.Object3D.prototype.updateMatrixWorld.call(this,a);let s=!1;this._lastPosition||(s=!0,this._lastPosition=new THREE.Vector3,this._lastOrientation=new THREE.Vector3,this._lastListenerPosition=new THREE.Vector3);const o=this.panner,r=o.context.listener;this.matrixWorld.decompose(e,t,i),n.set(0,0,1).applyQuaternion(t),(s||Math.abs(e.x-this._lastPosition.x)>Number.EPSILON||Math.abs(e.y-this._lastPosition.y)>Number.EPSILON||Math.abs(e.z-this._lastPosition.z)>Number.EPSILON||Math.abs(n.x-this._lastOrientation.x)>Number.EPSILON||Math.abs(n.y-this._lastOrientation.y)>Number.EPSILON||Math.abs(n.z-this._lastOrientation.z)>Number.EPSILON||r.positionX&&Math.abs(r.positionX.value-this._lastListenerPosition.x)>Number.EPSILON||r.positionY&&Math.abs(r.positionY.value-this._lastListenerPosition.y)>Number.EPSILON||r.positionZ&&Math.abs(r.positionZ.value-this._lastListenerPosition.z)>Number.EPSILON)&&(o.setPosition(e.x,e.y,e.z),o.setOrientation(n.x,n.y,n.z),this._lastPosition.x=e.x,this._lastPosition.y=e.y,this._lastPosition.z=e.z,this._lastOrientation.x=n.x,this._lastOrientation.y=n.y,this._lastOrientation.z=n.z,r.positionX&&r.positionY&&r.positionZ&&(this._lastListenerPosition.x=r.positionX.value,this._lastListenerPosition.y=r.positionY.value,this._lastListenerPosition.z=r.positionZ.value))}}()},,function(e,t){AFRAME.registerComponent("scale-in-screen-space",{schema:{baseScale:{type:"vec3",default:{x:1,y:1,z:1}},addedScale:{type:"vec3",default:{x:1,y:1,z:1}}},play(){this.didRegister||(this.didRegister=!0,this.el.sceneEl.systems["hubs-systems"].scaleInScreenSpaceSystem.register(this))},remove(){this.didRegister&&this.el.sceneEl.systems["hubs-systems"].scaleInScreenSpaceSystem.unregister(this)}})},function(e,t){AFRAME.registerComponent("bone-mute-state-indicator",{schema:{unmutedBoneName:{default:"Watch_Joint_MicON"},mutedBoneName:{default:"Watch_Joint_Muted"},onPos:{default:.81},offPos:{default:.5}},init(){this.onStateToggled=this.onStateToggled.bind(this),this.el.addEventListener("model-loaded",()=>{this.unmutedBone=this.el.object3D.getObjectByName(this.data.unmutedBoneName),this.mutedBone=this.el.object3D.getObjectByName(this.data.mutedBoneName),this.modelLoaded=!0,this.updateMuteState()})},play(){this.el.sceneEl.addEventListener("stateadded",this.onStateToggled),this.el.sceneEl.addEventListener("stateremoved",this.onStateToggled)},pause(){this.el.sceneEl.removeEventListener("stateadded",this.onStateToggled),this.el.sceneEl.removeEventListener("stateremoved",this.onStateToggled)},onStateToggled(e){"muted"!==!e.detail.state&&this.updateMuteState()},updateMuteState(){if(!this.modelLoaded)return;const e=this.el.sceneEl.is("muted");this.mutedBone.position.y=e?this.data.onPos:this.data.offPos,this.unmutedBone.position.y=e?this.data.offPos:this.data.onPos,this.mutedBone.matrixNeedsUpdate=!0,this.unmutedBone.matrixNeedsUpdate=!0}})},function(e,t){AFRAME.registerComponent("bone-visibility",{tick(){const{visible:e}=this.el.object3D;this.lastVisible!==e&&(e?this.el.object3D.scale.set(1,1,1):this.el.object3D.scale.set(1e-8,1e-8,1e-8),this.lastVisible=e,this.el.object3D.updateMatrices(!0,!0),this.el.object3D.updateMatrixWorld(!0,!0))}})},function(e,t){function i(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}AFRAME.registerComponent("fader",{schema:{direction:{type:"string",default:"none"}},init(){const e=new THREE.Mesh(new THREE.BoxGeometry,new THREE.MeshBasicMaterial({color:0,side:THREE.BackSide,opacity:0,transparent:!0,fog:!1}));e.scale.x=e.scale.y=e.scale.z=.16,e.matrixNeedsUpdate=!0,this.el.object3D.add(e),this.mesh=e},fadeOut(){return this.beginTransition("out")},fadeIn(){return this.beginTransition("in")},beginTransition(e){var t,n=this;return(t=function*(){if(n._resolveFinish)throw new Error("Cannot fade while a fade is happening.");return n.el.setAttribute("fader",{direction:e}),new Promise(t=>{n.mesh.material.opacity===("in"==e?0:1)?t():n._resolveFinish=t})},function(){var e=this,n=arguments;return new Promise(function(a,s){var o=t.apply(e,n);function r(e){i(o,a,s,r,l,"next",e)}function l(e){i(o,a,s,r,l,"throw",e)}r(void 0)})})()},tick(e,t){const i=this.mesh.material;this.mesh.visible="out"===this.data.direction||0!==i.opacity,this.mesh.visible&&("in"===this.data.direction?i.opacity=Math.max(0,i.opacity-1/750*Math.min(t,50)):"out"===this.data.direction&&(i.opacity=Math.min(1,i.opacity+1/750*Math.min(t,50))),0!==i.opacity&&1!==i.opacity||("none"!==this.data.direction&&this._resolveFinish&&(this._resolveFinish(),this._resolveFinish=null),this.el.setAttribute("fader",{direction:"none"})))}})},function(e,t){AFRAME.registerComponent("icon-button",{schema:{image:{type:"string"},hoverImage:{type:"string"},activeImage:{type:"string"},activeHoverImage:{type:"string"},disabledImage:{type:"string"},active:{type:"boolean"},disabled:{type:"boolean"},tooltip:{type:"selector"},tooltipText:{type:"string"},activeTooltipText:{type:"string"}},init(){this.el.object3D.matrixNeedsUpdate=!0,this.onHover=()=>{this.hovering=!0,this.data.tooltip&&(this.data.tooltip.object3D.visible=!0),this.updateButtonState()},this.onHoverOut=()=>{this.hovering=!1,this.data.tooltip&&(this.data.tooltip.object3D.visible=!1),this.updateButtonState()}},play(){this.updateButtonState(),this.el.object3D.addEventListener("hovered",this.onHover),this.el.object3D.addEventListener("unhovered",this.onHoverOut)},pause(){this.el.object3D.removeEventListener("hovered",this.onHover),this.el.object3D.removeEventListener("unhovered",this.onHoverOut)},update(){this.updateButtonState()},updateButtonState(){const e=this.hovering,t=this.data.active,i=this.data.disabled;let n;if(n=i?"disabledImage":t?e?"activeHoverImage":"activeImage":e?"hoverImage":"image",this.el.components.sprite?this.data[n]?this.el.setAttribute("sprite","name",this.data[n]):console.warn(`No ${n} image on me.`,this):console.error("No sprite."),this.data.tooltip&&e){const e=(this.data.active?this.data.activeTooltipText:this.data.tooltipText)+(i?" Disabled":"");this.data.tooltip.querySelector("[text]").setAttribute("text","value",e)}}})},function(e,t){AFRAME.registerComponent("text-button",{schema:{textHoverColor:{type:"string"},textColor:{type:"string"},backgroundHoverColor:{type:"string"},backgroundColor:{type:"string"}},init(){this.el.object3D.matrixNeedsUpdate=!0,this.onHover=()=>{this.hovering=!0,this.updateButtonState()},this.onHoverOut=()=>{this.hovering=!1,this.updateButtonState()},this.textEl=this.el.querySelector("[text]")},play(){this.updateButtonState(),this.el.object3D.addEventListener("hovered",this.onHover),this.el.object3D.addEventListener("unhovered",this.onHoverOut)},pause(){this.el.object3D.removeEventListener("hovered",this.onHover),this.el.object3D.removeEventListener("unhovered",this.onHoverOut)},update(){this.updateButtonState()},updateButtonState(){const e=this.hovering;this.el.setAttribute("slice9","color",e?this.data.backgroundHoverColor:this.data.backgroundColor),this.textEl&&this.textEl.setAttribute("text","color",e?this.data.textHoverColor:this.data.textColor)}});const i=function(){};AFRAME.registerComponent("text-raycast-hack",{dependencies:["text"],init(){this.el.getObject3D("text").raycast=i}})},function(e,t){AFRAME.registerComponent("block-button",{init(){this.onClick=()=>{this.block(this.owner)},NAF.utils.getNetworkedEntity(this.el).then(e=>{this.owner=e.components.networked.data.owner})},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)},block(e){window.APP.hubChannel.hide(e)}})},function(e,t){function i(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}AFRAME.registerComponent("mute-button",{init(){this.onClick=()=>{this.mute(this.owner)},NAF.utils.getNetworkedEntity(this.el).then(e=>{this.owner=e.components.networked.data.owner})},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)},mute(e){var t,n=this;return(t=function*(){n.el.sceneEl.emit("action_mute_client",{clientId:e})},function(){var e=this,n=arguments;return new Promise(function(a,s){var o=t.apply(e,n);function r(e){i(o,a,s,r,l,"next",e)}function l(e){i(o,a,s,r,l,"throw",e)}r(void 0)})})()}})},function(e,t){function i(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}AFRAME.registerComponent("kick-button",{init(){this.onClick=()=>{this.kick(this.owner)},NAF.utils.getNetworkedEntity(this.el).then(e=>{this.owner=e.components.networked.data.owner})},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)},kick(e){var t,n=this;return(t=function*(){n.el.sceneEl.emit("action_kick_client",{clientId:e})},function(){var e=this,n=arguments;return new Promise(function(a,s){var o=t.apply(e,n);function r(e){i(o,a,s,r,l,"next",e)}function l(e){i(o,a,s,r,l,"throw",e)}r(void 0)})})()}})},function(e,t){AFRAME.registerComponent("close-vr-notice-button",{init(){this.onClick=()=>{this.el.sceneEl.emit("action_vr_notice_closed")}},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}})},function(e,t){AFRAME.registerComponent("leave-room-button",{init(){this.onClick=()=>{this.el.sceneEl.emit("leave_room_requested")}},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}})},function(e,t){AFRAME.registerComponent("visible-if-permitted",{schema:{type:"string"},init(){this.updateVisibility=this.updateVisibility.bind(this),this.updateVisibility(),window.APP.hubChannel.addEventListener("permissions_updated",this.updateVisibility)},updateVisibility(){this.el.object3D.visible=this.el.sceneEl.systems.permissions.canOrWillIfCreator(this.data)},remove(){window.APP.hubChannel.removeEventListener("permissions_updated",this.updateVisibility)}})},function(e,t){AFRAME.registerComponent("visibility-on-content-types",{schema:{contentTypes:{type:"string"},contentSubtype:{type:"string"},visible:{type:"boolean",default:!0}},init(){this.updateVisibility=this.updateVisibility.bind(this),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEl=e,e.addEventListener("media_resolved",({detail:{contentType:e}})=>this.updateVisibility(e)),this.updateVisibility()}).catch(()=>{})},updateVisibility(e){const t=this.networkedEl.components["media-loader"],i=this.networkedEl.components["media-image"],n=this.networkedEl.components["media-video"],a=this.networkedEl.components["media-pdf"],s=e||n&&n.data.contentType||i&&i.data.contentType||a&&a.data.contentType;let o=!this.data.contentTypes;if(this.data.contentTypes&&s)for(const e of this.data.contentTypes.split(" ")){const t=s.toLowerCase().split(";")[0];if(t===e||e.endsWith("/")&&t.startsWith(e)){o=!0;break}}const r=!this.data.contentSubtype||t.data.contentSubtype&&t.data.contentSubtype===this.data.contentSubtype,l=!(!o||!r);this.el.object3D.visible=this.data.visible?l:!l}})},function(e,t){AFRAME.registerComponent("hide-when-pinned-and-forbidden",{schema:{whenPinned:{type:"boolean"}},init(){this._updateUI=this._updateUI.bind(this),this._updateUIOnStateChange=this._updateUIOnStateChange.bind(this),this.el.sceneEl.addEventListener("stateadded",this._updateUIOnStateChange),this.el.sceneEl.addEventListener("stateremoved",this._updateUIOnStateChange),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e,this._updateUI(),this.targetEl.addEventListener("pinned",this._updateUI),this.targetEl.addEventListener("unpinned",this._updateUI)})},remove(){this.el.sceneEl.removeEventListener("stateadded",this._updateUIOnStateChange),this.el.sceneEl.removeEventListener("stateremoved",this._updateUIOnStateChange),this.targetEl&&(this.targetEl.removeEventListener("pinned",this._updateUI),this.targetEl.removeEventListener("unpinned",this._updateUI))},_updateUIOnStateChange(e){"frozen"===e.detail&&this._updateUI()},_updateUI(){if(!this.targetEl)return;const e=this.targetEl.components.pinnable&&this.targetEl.components.pinnable.data.pinned;if(this.data.whenPinned)this.el.object3D.visible=!e;else{const t=e&&!window.APP.hubChannel.canOrWillIfCreator("pin_objects");this.el.object3D.visible=!t}}})},function(e,t,i){},function(e,t){AFRAME.registerComponent("networked-avatar",{schema:{left_hand_pose:{default:0},right_hand_pose:{default:0}}})},function(e,t){AFRAME.registerComponent("pinnable",{schema:{pinned:{default:!1}},init(){this._fireEventsAndAnimate=this._fireEventsAndAnimate.bind(this),this.el.addEventListener("media_refreshed",this._fireEventsAndAnimate),this.el.addEventListener("owned-pager-page-changed",this._fireEventsAndAnimate),this.el.addEventListener("owned-video-state-changed",this._fireEventsAndAnimate)},update(e){this._fireEventsAndAnimate(e)},_fireEventsAndAnimate(e,t){if(!this.el.components.networked||!this.el.components.networked.data)return;const i=NAF.utils.isMine(this.el),n=!!e.pinned!==this.data.pinned;if(this.data.pinned){if((n||t)&&this.el.emit("pinned",{el:this.el}),i){this.el.removeAttribute("animation__pin-start"),this.el.removeAttribute("animation__pin-end");const e=this.el.object3D.scale;this.el.setAttribute("animation__pin-start",{property:"scale",dur:200,from:{x:e.x,y:e.y,z:e.z},to:{x:1.1*e.x,y:1.1*e.y,z:1.1*e.z},easing:"easeOutElastic"}),this.el.setAttribute("animation__pin-end",{property:"scale",delay:200,dur:200,from:{x:1.1*e.x,y:1.1*e.y,z:1.1*e.z},to:{x:e.x,y:e.y,z:e.z},easing:"easeOutElastic"}),this.el.components["body-helper"]&&!this.el.sceneEl.systems.interaction.isHeld(this.el)&&this.el.setAttribute("body-helper",{type:"kinematic"})}}else(n||t)&&this.el.emit("unpinned",{el:this.el})},isHeld(e){const{leftHand:t,rightHand:i,rightRemote:n}=e.sceneEl.systems.interaction.state;return t.held===e||i.held===e||n.held===e},tick(){const e=this.isHeld(this.el),t=this.el.components.networked&&this.el.components.networked.data&&NAF.utils.isMine(this.el);let i=!1;!e&&this.wasHeld&&t&&(i=!0,this._fireEventsAndAnimate(this.data,!0)),this.wasHeld=e,this.transformObjectSystem=this.transformObjectSystem||AFRAME.scenes[0].systems["transform-selected-object"];const n=this.transformObjectSystem.transforming&&this.transformObjectSystem.target.el===this.el;!i&&!n&&this.wasTransforming&&t&&this._fireEventsAndAnimate(this.data,!0),this.wasTransforming=n}})},function(e,t,i){const n=i(111).COLLISION_LAYERS;AFRAME.registerComponent("drop-object-button",{init(){this.onClick=()=>{(NAF.utils.isMine(this.targetEl)||NAF.utils.takeOwnership(this.targetEl))&&(this.targetEl.setAttribute("floaty-object",{modifyGravityOnRelease:!1}),this.targetEl.setAttribute("body-helper",{type:"dynamic",gravity:{x:0,y:-9.8,z:0},angularDamping:.01,linearDamping:.01,linearSleepingThreshold:1.6,angularSleepingThreshold:2.5,collisionFilterMask:n.DEFAULT_INTERACTABLE}),this.targetEl.components["body-helper"].body&&this.targetEl.components["body-helper"].body.physicsBody.activate(),this.el.parentNode.removeChild(this.el))},NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e})},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}})},function(e,t){AFRAME.registerComponent("remove-networked-object-button",{init(){this.onClick=()=>{(NAF.utils.isMine(this.targetEl)||NAF.utils.takeOwnership(this.targetEl))&&(this.targetEl.setAttribute("animation__remove",{property:"scale",dur:200,to:{x:.01,y:.01,z:.01},easing:"easeInQuad"}),this.el.parentNode.removeAttribute("visibility-while-frozen"),this.el.parentNode.setAttribute("visible",!1),this.targetEl.addEventListener("animationcomplete",()=>{NAF.utils.takeOwnership(this.targetEl),this.targetEl.parentNode.removeChild(this.targetEl)}))},NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e})},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}})},function(e,t){AFRAME.registerComponent("camera-focus-button",{schema:{track:{default:!1},selector:{default:null}},init(){this.cameraSystem=this.el.sceneEl.systems["camera-tools"],NAF.utils.getNetworkedEntity(this.el).then(e=>{this.data.selector?this.targetEl=e.querySelector(this.data.selector):this.targetEl=e}),this.onClick=()=>{const e=this.cameraSystem.getMyCamera();e&&e.components["camera-tool"].focus(this.targetEl,this.data.track)}},tick(){const e=this.el.object3D.visible,t=!(!this.cameraSystem||!this.cameraSystem.getMyCamera());e!==t&&this.el.setAttribute("visible",t)},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}})},function(e,t){AFRAME.registerComponent("visible-to-owner",{init(){this.onStateChange=e=>{this.el.setAttribute("visible",e.detail.newOwner===NAF.clientId)},NAF.utils.getNetworkedEntity(this.el).then(e=>{e.addEventListener("ownership-changed",this.onStateChange),this.el.setAttribute("visible",NAF.utils.isMine(e))})}})},function(e,t){AFRAME.registerComponent("emit-state-change",{multiple:!0,schema:{state:{type:"string"},transform:{type:"string",oneof:["rising","falling"]},event:{type:"string"}},init(){this.stateadded=this.stateadded.bind(this),this.stateremoved=this.stateremoved.bind(this)},stateadded(e){e.detail===this.data.state&&this.el.emit(this.data.event)},stateremoved(e){e.detail===this.data.state&&this.el.emit(this.data.event)},update(){this.el.removeEventListener("stateadded",this.stateadded),this.el.removeEventListener("stateremoved",this.stateremoved),"rising"===this.data.transform&&this.el.addEventListener("stateadded",this.stateadded),"falling"===this.data.transform&&this.el.addEventListener("stateremoved",this.stateremoved)}})},function(e,t){AFRAME.registerComponent("action-to-event",{multiple:!0,schema:{path:{type:"string"},event:{type:"string"},withPermission:{type:"string"}},init(){this.needsPermission=!!this.data.withPermission,this.updatePermissions=()=>{this.needsPermission&&window.APP.hubChannel&&(this.hasPermission=window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission))}},play(){this.el.sceneEl.systems.permissions.onPermissionsUpdated(this.updatePermissions),this.updatePermissions()},pause(){window.APP.hubChannel.removeEventListener("permissions_updated",this.updatePermissions)},tick(){if(this.needsPermission&&!this.hasPermission)return;AFRAME.scenes[0].systems.userinput.get(this.data.path)&&this.el.emit(this.data.event)}})},function(e,t){AFRAME.registerComponent("action-to-remove",{multiple:!0,schema:{path:{type:"string"},requireOwnership:{type:"boolean",default:!0}},init(){NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEl=e})},tick(){AFRAME.scenes[0].systems.userinput.get(this.data.path)&&(this.data.requireOwnership&&this.networkedEl&&!NAF.utils.isMine(this.networkedEl)||this.el.parentNode.removeChild(this.el))}})},function(e,t){AFRAME.registerComponent("emit-scene-event-on-remove",{schema:{event:{default:null}},remove(){this.data.event&&this.el.sceneEl.emit(this.data.event,{el:this.el})}})},function(e,t){AFRAME.registerComponent("follow-in-fov",{schema:{target:{type:"selector"},offset:{type:"vec3"},speed:{type:"number",default:.003},angle:{type:"number",default:45}},init(){this.targetPos=new THREE.Vector3,this.offset=new THREE.Vector3,this.offset.copy(this.data.offset),this.snappedRot=new THREE.Euler,this.snappedQ=new THREE.Quaternion,this.snappedXForm=new THREE.Matrix4,this.snappedXFormWorld=new THREE.Matrix4,this.tempVector=new THREE.Vector3},tick(e,t){if(!this.el.object3D.visible)return;if(!this.data.target)return;const i=this.el.object3D,n=this.data.target.object3D;let a=!1;const s=AFRAME.scenes[0].systems.interaction,o=s.state.rightRemote.hovered||s.state.leftRemote.hovered;if(o){let e=o;for(;e;){if(this.el===e){a=!0;break}e=e.parentNode}}if(a?this._hoveredFrames+=1:this._hoveredFrames=0,this._applyMaskedTargetRotation(-this.data.angle*THREE.Math.DEG2RAD,n.rotation.y,0,this.snappedXFormWorld),this.targetPos.copy(this.offset),this.targetPos.applyMatrix4(this.snappedXFormWorld),i.parent&&i.parent.worldToLocal(this.targetPos),this.started){const e=(this._hoveredFrames?this.data.speed*(1/(.2*(this._hoveredFrames+5))):this.data.speed)*t;i.position.set(i.position.x+(this.targetPos.x-i.position.x)*e,i.position.y+(this.targetPos.y-i.position.y)*e,i.position.z+(this.targetPos.z-i.position.z)*e)}else i.position.copy(this.targetPos),this.started=!0;this.snappedXFormWorld.decompose(this.tempVector,i.quaternion,this.tempVector),i.matrixNeedsUpdate=!0},reset(){this.started=!1},_applyMaskedTargetRotation(e,t,i,n){const a=this.data.target.object3D;this.snappedRot.set(e,t,i,a.rotation.order),this.snappedQ.setFromEuler(this.snappedRot),this.snappedXForm.compose(a.position,this.snappedQ,a.scale),n.multiplyMatrices(a.parent.matrixWorld,this.snappedXForm)}})},function(e,t){AFRAME.registerComponent("matrix-auto-update",{schema:{target:{type:"string"}},init:function(){this._updateMatrixAutoUpdate=this._updateMatrixAutoUpdate.bind(this),this._updateMatrixAutoUpdate()},play:function(){this.el.sceneEl.addEventListener("object3dset",this._updateMatrixAutoUpdate)},pause:function(){this.el.sceneEl.removeEventListener("object3dset",this._updateMatrixAutoUpdate)},_updateMatrixAutoUpdate:function(){this.data.target?this.el.getObject3D(this.data.target).matrixAutoUpdate=!0:this.el.object3D.matrixAutoUpdate=!0}})},function(e,t){function i(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}AFRAME.registerComponent("hover-menu",{multiple:!0,schema:{template:{type:"selector"},dirs:{type:"array"},dim:{default:!0},withPermission:{type:"string"}},init(){var e,t=this;return(e=function*(){t.onFrozenStateChange=t.onFrozenStateChange.bind(t),t.hovering=!1,yield t.getHoverMenu(),t.applyHoverState()},function(){var t=this,n=arguments;return new Promise(function(a,s){var o=e.apply(t,n);function r(e){i(o,a,s,r,l,"next",e)}function l(e){i(o,a,s,r,l,"throw",e)}r(void 0)})})()},getHoverMenu(){return this.menuPromise?this.menuPromise:this.menuPromise=new Promise(e=>{const t=this.el.appendChild(document.importNode(this.data.template.content,!0).children[0]);setTimeout(()=>{if(this.menu=t,!("media-mirror-target"===this.el.parentEl.id))this.el.setAttribute("position-at-box-shape-border",{target:".hover-container",dirs:this.data.dirs,animate:!1,scale:!1});else{const e=this.el.querySelector(".hover-container");e.object3D.position.z=.001,e.object3D.matrixNeedsUpdate=!0}e(this.menu)})})},onFrozenStateChange(e){"frozen"!==!e.detail&&this.applyHoverState()},applyHoverState(){if(!this.menu)return;const e=!this.data.withPermission||window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission);this.menu.object3D.visible=e&&!this.el.sceneEl.is("frozen")&&this.hovering,this.data.dim&&this.el.object3DMap.mesh&&this.el.object3DMap.mesh.material&&this.el.object3DMap.mesh.material.color.setScalar(this.menu.object3D.visible?.5:1)},play(){this.el.sceneEl.addEventListener("stateadded",this.onFrozenStateChange),this.el.sceneEl.addEventListener("stateremoved",this.onFrozenStateChange)},pause(){this.el.sceneEl.removeEventListener("stateadded",this.onFrozenStateChange),this.el.sceneEl.removeEventListener("stateremoved",this.onFrozenStateChange)}})},function(e,t){AFRAME.registerComponent("disable-frustum-culling",{init(){this.el.object3D.traverse(e=>e.frustumCulled=!1)}})},function(e,t){AFRAME.registerComponent("set-active-camera",{init(){const e=this.el.sceneEl.systems.camera,t=e.activeCameraEl;t!==this.el&&(e.setActiveCamera(this.el),t.parentNode.removeChild(t),this.el.sceneEl.canvas.classList.remove("a-grab-cursor"))}})},function(e,t){AFRAME.registerComponent("track-pose",{schema:{path:{type:"string"}},play(){this.didRegister||(this.didRegister=!0,this.el.sceneEl.systems["hubs-systems"].cursorPoseTrackingSystem.register(this.el.object3D,this.data.path))},remove(){this.didRegister&&this.el.sceneEl.systems["hubs-systems"].cursorPoseTrackingSystem.unregister(this.el.object3D)}})},function(e,t){AFRAME.registerComponent("replay",{init:function(){this.playhead=0,this.poseIndex=0},tick:function(e,t){let i=!1;for(;!i&&this.playhead>=this.poses[this.poseIndex].timestamp;)this.el.setAttribute("position",this.poses[this.poseIndex].position),this.el.setAttribute("rotation",this.poses[this.poseIndex].rotation),this.el.object3D.matrixNeedsUpdate=!0,this.poseIndex+=1,i=this.poseIndex===this.poses.length;this.playhead+=t,i&&(this.playhead=0,this.poseIndex=0)}})},function(e,t){AFRAME.registerComponent("visibility-by-path",{schema:{path:{type:"string"}},tick(){const e=!!AFRAME.scenes[0].systems.userinput.get(this.data.path);this.el.object3D.visible!==e&&this.el.setAttribute("visible",e)}})},,,,,,,,,,,,,function(e,t){const i=AFRAME.utils.device.isMobileVR();AFRAME.registerComponent("billboard",{init:function(){this.target=new THREE.Vector3,this._updateBillboard=this._updateBillboard.bind(this),this._updateIsInView=this._updateIsInView.bind(this),i&&this.el.sceneEl.systems["frame-scheduler"].schedule(this._updateIsInView,"billboards")},remove(){i&&this.el.sceneEl.systems["frame-scheduler"].unschedule(this._updateIsInView,"billboards")},tick(){!this.isInView&&i||this._updateBillboard()},_updateIsInView:function(){const e=new THREE.Frustum,t=new THREE.Matrix4,i=new THREE.Box3,n=new THREE.Box3,a=e=>{e.geometry&&(e.updateMatrices(),e.geometry.computeBoundingBox(),n.copy(e.geometry.boundingBox).applyMatrix4(e.matrixWorld),i.expandByPoint(n.min),i.expandByPoint(n.max))},s=(n,s)=>(t.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),e.setFromMatrix(t),i.makeEmpty(),n.traverse(a),e.intersectsBox(i));return function(){if(this.el.object3D.visible){if(this.playerCamera||(this.playerCamera=document.getElementById("viewing-camera").getObject3D("camera")),this.playerCamera&&(this.isInView=!!this.el.sceneEl.is("vr-mode")||s(this.el.object3D,this.playerCamera),!this.isInView)){const e=this.el.sceneEl.systems["camera-tools"];e&&e.ifMyCameraRenderingViewfinder(e=>{this.isInView=this.isInView||s(this.el.object3D,e.camera)})}}else this.isInView=!1}}(),_updateBillboard:function(){if(!this.el.object3D.visible)return;const e=this.el.sceneEl.camera,t=this.el.object3D;e&&(this.target.setFromMatrixPosition(e.matrixWorld),t.lookAt(this.target),t.matrixNeedsUpdate=!0)}})},function(e,t){AFRAME.registerComponent("periodic-full-syncs",{init(){this.lastSync=0},tick(){const e=performance.now();e-this.lastSync>=5e3&&this.el.components&&this.el.components.networked&&(this.lastSync=e,this.el.components.networked.syncAll(null,!0))}})},function(e,t){AFRAME.registerComponent("set-max-resolution",{init(){const e=window.APP.store;this.onStoreChanged=()=>{const t=void 0===e.state.preferences.maxResolutionWidth?1920:e.state.preferences.maxResolutionWidth,i=void 0===e.state.preferences.maxResolutionHeight?1920:e.state.preferences.maxResolutionHeight;this.el.sceneEl.maxCanvasSize={width:t,height:i},this.el.sceneEl.resize()},this.onStoreChanged(),e.addEventListener("statechanged",this.onStoreChanged)}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){AFRAME.registerSystem("frame-scheduler",{init(){this.registry=new Map,this.queues=[],this.frameIndex=0},schedule(e,t){this.registry.has(t)||(this.queues.push(t),this.registry.set(t,[])),this.registry.get(t).push(e)},unschedule(e){for(let t=0;t<this.queues.length;t++){const i=this.queues[t],n=this.registry.get(i),a=n.indexOf(e);a>=0&&n.splice(a,1)}},tick:function(){for(let e=0;e<this.queues.length;e++){const t=this.queues[e],i=this.registry.get(t);0!==i.length&&i[this.frameIndex%i.length]()}this.frameIndex++}})},function(e,t){AFRAME.registerComponent("vr-mode-toggle-visibility",{schema:{invert:{type:"boolean",default:!1}},init(){this.updateComponentState=this.updateComponentState.bind(this)},play(){this.updateComponentState(),this.el.sceneEl.addEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.addEventListener("exit-vr",this.updateComponentState)},pause(){this.el.sceneEl.removeEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.removeEventListener("exit-vr",this.updateComponentState)},updateComponentState(){const e=this.el.sceneEl.is("vr-mode");this.el.setAttribute("visible",e!==this.data.invert)}}),AFRAME.registerComponent("vr-mode-toggle-playing",{multiple:!0,schema:{invert:{type:"boolean",default:!1}},init(){this.updateComponentState=this.updateComponentState.bind(this)},play(){this.updateComponentState(),this.el.sceneEl.addEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.addEventListener("exit-vr",this.updateComponentState)},pause(){this.el.sceneEl.removeEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.removeEventListener("exit-vr",this.updateComponentState)},updateComponentState(){const e=this.id,t=this.el.sceneEl.is("vr-mode");this.el.components[e][t!==this.data.invert?"play":"pause"]()}}),AFRAME.registerComponent("vr-mode-toggle-class",{multiple:!0,schema:{invert:{type:"boolean",default:!1},class:{type:"string",default:""}},init(){this.updateComponentState=this.updateComponentState.bind(this)},play(){this.updateComponentState(),this.el.sceneEl.addEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.addEventListener("exit-vr",this.updateComponentState)},pause(){this.el.sceneEl.removeEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.removeEventListener("exit-vr",this.updateComponentState)},updateComponentState(){this.el.sceneEl.is("vr-mode")?this.el.classList.add(this.data.class):this.el.classList.remove(this.data.class)}})},function(e,t){AFRAME.registerSystem("permissions",{onPermissionsUpdated(e){window.APP.hubChannel?window.APP.hubChannel.addEventListener("permissions_updated",e):window.addEventListener("hub_channel_ready",()=>window.APP.hubChannel.addEventListener("permissions_updated",e),{once:!0})},can:e=>!!window.APP.hubChannel.can(e),canOrWillIfCreator:e=>!!window.APP.hubChannel.canOrWillIfCreator(e),fetchPermissions:()=>window.APP.hubChannel.fetchPermissions()})},function(e,t){AFRAME.registerSystem("exit-on-blur",{init(){this.onBlur=this.onBlur.bind(this),this.onFocus=this.onFocus.bind(this),this.onTimeout=this.onTimeout.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.isOculusBrowser=navigator.userAgent.match(/Oculus/),this.enteredVR=!1,window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),this.el.addEventListener("enter-vr",this.onEnterVR),this.lastTimeoutCheck=0,this.exitTimeout=null},tick(e){this.isOculusBrowser&&this.enteredVR&&(0===this.lastTimeoutCheck||e-this.lastTimeoutCheck>=1e3)&&(this.lastTimeoutCheck=e,clearTimeout(this.exitTimeout),this.exitTimeout=setTimeout(this.onTimeout,3e4))},onEnterVR(){this.enteredVR=!0},onBlur(){this.el.isMobile&&(clearTimeout(this.exitTimeout),this.exitTimeout=setTimeout(this.onTimeout,3e4))},onFocus(){this.el.isMobile&&clearTimeout(this.exitTimeout)},onTimeout(){this.el.dispatchEvent(new CustomEvent("exit"))},remove(){clearTimeout(this.exitTimeout),window.removeEventListener("blur",this.onBlur)}})},function(e,t){AFRAME.registerSystem("auto-pixel-ratio",{init(){this.enabled=window.devicePixelRatio>1&&/macintosh/i.test(navigator.userAgent),this.deltas=[],this.secondsSinceMeasurementStart=0,this.secondsSinceSceneVisible=0},tick(e,t){if(this.enabled&&this.el.is("visible"))if(this.secondsSinceSceneVisible<30)this.secondsSinceSceneVisible+=t/1e3;else if("hidden"!==document.visibilityState&&(this.deltas.push(t),this.secondsSinceMeasurementStart+=t/1e3,this.secondsSinceMeasurementStart>5)){this.deltas.sort();const e=1e3/this.deltas[Math.floor(this.deltas.length/2)];if(e<50){const t=this.el.renderer.getPixelRatio()-1;console.info(`Hubs auto-pixel-ratio: Median FPS (${e.toFixed()}) was below 50. `+`Reducing pixel ratio to ${t}.`),this.el.renderer.setPixelRatio(t),t<=1&&(this.enabled=!1)}this.deltas.length=0,this.secondsSinceMeasurementStart=0}}})},,,function(e,t){AFRAME.registerSystem("listed-media",{init:function(){this.els=[]},register:function(e){this.els.push(e),this.el.emit("listed_media_changed")},unregister:function(e){this.els.splice(this.els.indexOf(e),1),this.el.emit("listed_media_changed")}}),AFRAME.registerComponent("listed-media",{init:function(){this.system.register(this.el)},remove:function(){this.system.unregister(this.el)}})},function(e,t){AFRAME.registerSystem("linked-media",{init:function(){this.handlers=[],this.addLinkageHandler=this.addLinkageHandler.bind(this),this.syncLinkage=this.syncLinkage.bind(this)},addLinkageHandler(e,t){const i=()=>{t._handlingLinkage||(e._handlingLinkage=!0,this.syncLinkage(e,t),e._handlingLinkage=!1)};if(e.components["media-loader"].data)e.addEventListener("componentchanged",i);else{const t=n=>{"media-loader"===n.detail.name&&(e.removeEventListener("componentinitialized",t),e.addEventListener("componentchanged",i))};e.addEventListener("componentinitialized",t)}return i},registerLinkage:function(e,t){this.syncLinkage(e,t);const i=this.addLinkageHandler(e,t),n=this.addLinkageHandler(t,e);e.setAttribute("linked-media",""),t.setAttribute("linked-media",""),e.components["media-video"]&&e.setAttribute("media-video","volume",0),this.handlers.push([e,t,i,n])},deregisterLinkage:function(e){for(const[t,i,n,a]of this.handlers)e!==t&&e!==i||(t.removeEventListener("componentchanged",n),i.removeEventListener("componentchanged",a)),t.components["media-video"]&&t.setAttribute("media-video","volume",.5);this.handlers=this.handlers.filter(([t,i])=>t!==e&&i!==e)},syncLinkage(e,t){if(t.components.networked&&!NAF.utils.isMine(t)&&!NAF.utils.takeOwnership(t))return;const{src:i,version:n}=e.components["media-loader"].data;if(t.setAttribute("media-loader",{src:i,version:n}),e.components["media-pdf"]){const{index:i}=e.components["media-pdf"].data;t.setAttribute("media-pdf",{index:i})}if(e.components["media-video"]){const{time:i,videoPaused:n,loop:a,hidePlaybackControls:s}=e.components["media-video"].data,o={time:i,videoPaused:n,loop:a,hidePlaybackControls:s};!t.components.networked&&(o.syncTolerance=.25),t.setAttribute("media-video",o),t.components["media-video"].updatePlaybackState(!0)}}}),AFRAME.registerComponent("linked-media",{remove:function(){this.system.deregisterLinkage(this.el)}})},function(e,t){AFRAME.registerComponent("owned-object-limiter",{schema:{counter:{type:"selector"}},init(){this.counter=this.data.counter.components["networked-counter"]},tick(){this._syncCounterRegistration();const e=this.el.sceneEl.systems.interaction.isHeld(this.el);!e&&this.wasHeld&&this.counter.timestamps.has(this.el)&&this.counter.timestamps.set(this.el,performance.now()),this.wasHeld=e},remove(){this.counter.deregister(this.el)},_syncCounterRegistration(){if(!this.el.components.networked)return;const e=this.el.components.pinnable&&this.el.components.pinnable.data.pinned;NAF.utils.isMine(this.el)&&!e?this.counter.register(this.el):this.counter.deregister(this.el)}})},function(e,t){AFRAME.registerComponent("owned-object-cleanup-timeout",{schema:{counter:{type:"selector"},ttl:{default:0}},init(){this.counter=this.data.counter.components["networked-counter"],this.timeout=Number.POSITIVE_INFINITY},tick(){if(this.el.components.networked&&NAF.utils.isMine(this.el)){const e=this.el.components.pinnable&&this.el.components.pinnable.data.pinned;NAF.utils.isMine(this.el)&&!e&&performance.now()>=this.timeout&&(this.el.parentNode.removeChild(this.el),this.timeout=Number.POSITIVE_INFINITY)}const e=this.el.sceneEl.systems.interaction.isHeld(this.el);!e&&this.wasHeld&&this.counter.timestamps.has(this.el)?this.timeout=performance.now()+1e3*this.data.ttl:e&&!this.wasHeld&&(this.timeout=Number.POSITIVE_INFINITY),this.wasHeld=e}})},function(e,t,i){const n=i(111).COLLISION_LAYERS;AFRAME.registerComponent("set-unowned-body-kinematic",{init(){this.setBodyKinematic=this.setBodyKinematic.bind(this)},play(){this.el.addEventListener("ownership-lost",this.setBodyKinematic),this.didThisOnce||(this.didThisOnce=!0,this.el.components.networked&&NAF.utils.isMine(this.el)||this.setBodyKinematic())},pause(){this.el.removeEventListener("ownership-lost",this.setBodyKinematic)},setBodyKinematic(){this.el.setAttribute("body-helper",{type:"kinematic",collisionFilterMask:n.UNOWNED_INTERACTABLE}),this.el.components["floaty-object"]&&(this.el.components["floaty-object"].locked=!0)}})},function(e,t){AFRAME.registerComponent("networked-counter",{schema:{max:{default:3}},init(){this.timestamps=new Map,this.el.object3D.visible=!1},remove(){this.timestamps.clear()},count(){return this.timestamps.size},register(e){this.data.max<=0||this.timestamps.has(e)||(this.timestamps.set(e,performance.now()),this.timestamps.size>this.data.max&&this._destroyOldest())},deregister(e){this.timestamps.has(e)&&this.timestamps.delete(e)},_destroyOldest(){const e=this.el.sceneEl.systems.interaction;let t=null,i=Number.MAX_VALUE;this.timestamps.forEach((n,a)=>{n<i&&!e.isHeld(a)&&NAF.utils.isMine(a)&&(t=a,i=n)}),this._destroy(t)},_destroy(e){e.pause(),this.deregister(e),e.parentNode.removeChild(e)}})},function(e,t){AFRAME.registerComponent("set-yxz-order",{init:function(){this.el.object3D.rotation.order="YXZ"}})},function(e,t){AFRAME.registerComponent("nav-mesh-helper",{init:function(){this.el.addEventListener("model-loaded",()=>{const e=document.querySelectorAll("[teleporter]");for(let t=0;t<e.length;t++)e[t].components.teleporter.queryCollisionEntities()})}})},function(e,t){AFRAME.registerComponent("drawing-manager",{schema:{penSpawner:{type:"selector"}},init(){this.el.object3D.visible=!1,this.drawingToPen=new Map,this.data.penSpawner.addEventListener("spawned-entity-created",()=>{this.drawingEl||this.createDrawing()})},createDrawing(){return this.createDrawingPromise||(this.createDrawingPromise=new Promise(e=>{this.drawingEl=document.createElement("a-entity"),this.drawingEl.setAttribute("networked","template: #interactable-drawing"),this.el.sceneEl.appendChild(this.drawingEl);const t=i=>{"networked-drawing"===i.detail.name&&(this.drawing=this.drawingEl.components["networked-drawing"],this.drawingEl.removeEventListener("componentinitialized",t),e())};this.drawingEl.addEventListener("componentinitialized",t)})),this.createDrawingPromise},destroyDrawing(e){this.drawing===e&&(this.drawingToPen.delete(this.drawing),this.drawing=null,this.drawingEl=null,this.createDrawingPromise=null,this.getDrawingPromise=null)},getDrawing(e){return this.getDrawingPromise||(this.getDrawingPromise=new Promise((t,i)=>{this.drawingEl?!this.drawing||this.drawingToPen.has(this.drawing)&&this.drawingToPen.get(this.drawing)!==e?i():(this.drawingToPen.set(this.drawing,e),t(this.drawing)):this.createDrawing().then(()=>{this.drawingToPen.set(this.drawing,e),t(this.drawing)})})),this.getDrawingPromise},returnDrawing(e){this.drawingToPen.has(this.drawing)&&this.drawingToPen.get(this.drawing)===e&&this.drawingToPen.delete(this.drawing)}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";i.r(t);i(181);var n=i(4),a=i(95),s=(i(647),i(833),i(834),i(96)),o=i.n(s),r=i(301),l=i.n(r),c=(i(280),i(948),i(236),i(245));i(339),i(951),i(967),i(971),i(972),i(984),i(985),i(986),i(343);var d=i(105),h=i(8),u=i(80),p=i(199),m=i(56),g=i(78),f=i.n(g),v=(i(376),i(988),i(18));const b=function(e,t,i){if(e&&e.length)for(const n of e)t.length&&t.forEach(e=>{n.addEventListener(e,i)})},y=function(e,t,i){if(e&&e.length)for(const n of e)t.length&&t.forEach(e=>{n.removeEventListener(e,i)})};AFRAME.registerComponent("mute-mic",{schema:{eventSrc:{type:"selectorAll"},toggleEvents:{type:"array"},muteEvents:{type:"array"},unmuteEvents:{type:"array"}},init:function(){this.onToggle=this.onToggle.bind(this),this.onMute=this.onMute.bind(this),this.onUnmute=this.onUnmute.bind(this)},play:function(){const{eventSrc:e,toggleEvents:t,muteEvents:i,unmuteEvents:n}=this.data;b(e,t,this.onToggle),b(e,i,this.onMute),b(e,n,this.onUnmute)},pause:function(){const{eventSrc:e,toggleEvents:t,muteEvents:i,unmuteEvents:n}=this.data;y(e,t,this.onToggle),y(e,i,this.onMute),y(e,n,this.onUnmute)},onToggle:function(){NAF.connection.adapter&&this.el.sceneEl.is("entered")&&(this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(v.w),this.el.is("muted")?(NAF.connection.adapter.enableMicrophone(!0),this.el.removeState("muted")):(NAF.connection.adapter.enableMicrophone(!1),this.el.addState("muted")))},onMute:function(){NAF.connection.adapter&&(this.el.is("muted")||(NAF.connection.adapter.enableMicrophone(!1),this.el.addState("muted")))},onUnmute:function(){this.el.is("muted")&&(NAF.connection.adapter.enableMicrophone(!0),this.el.removeState("muted"))}});i(989),i(990),i(991);AFRAME.registerComponent("in-world-hud",{init(){this.mic=this.el.querySelector(".mic"),this.spawn=this.el.querySelector(".spawn"),this.pen=this.el.querySelector(".penhud"),this.cameraBtn=this.el.querySelector(".camera-btn"),this.inviteBtn=this.el.querySelector(".invite-btn"),this.background=this.el.querySelector(".bg"),this.updateButtonStates=()=>{this.mic.setAttribute("mic-button","active",this.el.sceneEl.is("muted")),this.pen.setAttribute("icon-button","active",this.el.sceneEl.is("pen")),this.cameraBtn.setAttribute("icon-button","active",this.el.sceneEl.is("camera")),window.APP.hubChannel&&(this.spawn.setAttribute("icon-button","disabled",!window.APP.hubChannel.can("spawn_and_move_media")),this.pen.setAttribute("icon-button","disabled",!window.APP.hubChannel.can("spawn_drawing")),this.cameraBtn.setAttribute("icon-button","disabled",!window.APP.hubChannel.can("spawn_camera")))},this.onStateChange=e=>{"muted"!==e.detail&&"frozen"!==e.detail&&"pen"!==e.detail&&"camera"!==e.detail||this.updateButtonStates()},this.onMicClick=()=>{this.el.emit("action_mute")},this.onSpawnClick=()=>{window.APP.hubChannel.can("spawn_and_move_media")&&this.el.emit("action_spawn")},this.onPenClick=e=>{window.APP.hubChannel.can("spawn_drawing")&&(this.el.emit("spawn_pen",{object3D:e.object3D}),this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(v.r))},this.onCameraClick=()=>{window.APP.hubChannel.can("spawn_camera")&&this.el.emit("action_toggle_camera")},this.onInviteClick=()=>{this.el.emit("action_invite")}},play(){this.el.sceneEl.addEventListener("stateadded",this.onStateChange),this.el.sceneEl.addEventListener("stateremoved",this.onStateChange),this.el.sceneEl.systems.permissions.onPermissionsUpdated(this.updateButtonStates),this.updateButtonStates(),this.mic.object3D.addEventListener("interact",this.onMicClick),this.spawn.object3D.addEventListener("interact",this.onSpawnClick),this.pen.object3D.addEventListener("interact",this.onPenClick),this.cameraBtn.object3D.addEventListener("interact",this.onCameraClick),this.inviteBtn.object3D.addEventListener("interact",this.onInviteClick)},pause(){this.el.sceneEl.removeEventListener("stateadded",this.onStateChange),this.el.sceneEl.removeEventListener("stateremoved",this.onStateChange),window.APP.hubChannel.removeEventListener("permissions_updated",this.updateButtonStates),this.mic.object3D.removeEventListener("interact",this.onMicClick),this.spawn.object3D.removeEventListener("interact",this.onSpawnClick),this.pen.object3D.removeEventListener("interact",this.onPenClick),this.cameraBtn.object3D.removeEventListener("interact",this.onCameraClick),this.inviteBtn.object3D.removeEventListener("interact",this.onInviteClick)}}),AFRAME.registerComponent("emoji",{schema:{emitDecayTime:{default:1.5},emitFadeTime:{default:.5},emitEndTime:{default:0},particleEmitterConfig:{default:null,parse:e=>"object"==typeof e?e:JSON.parse(e),stringify:JSON.stringify}},init(){this.data.emitEndTime=performance.now()+1e3*this.data.emitDecayTime},play(){this.lastLinearVelocity=this.el.components["body-helper"].body.physicsBody.getLinearVelocity().length2(),this.lastAngularVelocity=this.el.components["body-helper"].body.physicsBody.getAngularVelocity().length2(),this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playPositionalSoundFollowing(v.q,this.el.object3D),this.particleEmitter=this.el.querySelector(".particle-emitter")},update(){!this.particleConfig&&this.data.particleEmitterConfig&&(this.particleConfig=Object.assign({},this.data.particleEmitterConfig),this.originalParticleCount=this.particleConfig.particleCount)},tick(e,t){const i=this.el.components.networked.initialized&&this.el.components.networked.isMine();if(this.particleConfig&&i){const e=performance.now(),i=this.el.components["body-helper"].body.physicsBody.getLinearVelocity().length2(),n=(i-this.lastLinearVelocity)/t*1e3;this.lastLinearVelocity=i;const a=this.el.components["body-helper"].body.physicsBody.getAngularVelocity().length2(),s=(a-this.lastAngularVelocity)/t*1e3;this.lastAngularVelocity=a,(Math.abs(n)>1e4||Math.abs(s)>1e4)&&(this.data.emitEndTime=e+1e3*this.data.emitDecayTime);const o=1e3*this.data.emitFadeTime;if(e<this.data.emitEndTime&&this.particleConfig.startOpacity<1)this.particleConfig.particleCount=this.originalParticleCount,this.particleConfig.startOpacity=1,this.particleConfig.middleOpacity=1,this.particleEmitter.setAttribute("particle-emitter",this.particleConfig,!0);else if(e>=this.data.emitEndTime&&this.particleConfig.startOpacity>.001){const t=1-Math.min(e-this.data.emitEndTime,o)/o,i=t<.001&&this.particleConfig.particleCount>0?0:this.originalParticleCount;this.particleConfig.particleCount=i,this.particleConfig.startOpacity=t,this.particleConfig.middleOpacity=t,this.particleEmitter.setAttribute("particle-emitter",this.particleConfig,!0)}}}});var _=i(486),w=i.n(_),E=i(487),x=i.n(E),S=i(488),C=i.n(S),k=i(489),A=i.n(k),T=i(490),M=i.n(T),L=i(491),R=i.n(L),P=i(492),D=i.n(P),O=i(493),H=i.n(O),j=i(494),I=i.n(j),N=i(495),F=i.n(N),V=i(496),B=i.n(V),z=i(497),U=i.n(z),W=i(498),Z=i.n(W),G=i(499),q=i.n(G),$=i(13);const Y=i(111).COLLISION_LAYERS,X=[H.a,I.a,F.a,B.a,U.a,Z.a,q.a],Q=[w.a,x.a,C.a,A.a,M.a,R.a,D.a];function K(e,t,i,n,a){const s=1&e?-1:1;a.y=0,t%2==0?(a.x=(n/2+i/2+Math.floor(e/2)*(i+n))*s,a.z=Math.floor(e/2)*i/2):0!==e&&(a.x=(i+n)*Math.floor((e+1)/2)*-s,a.z=Math.floor((e+1)/2)*i/2)}AFRAME.registerComponent("emoji-hud",{schema:{spawnerScale:{default:.1},spawnedScale:{default:.5},camera:{type:"selector"},hudAngle:{default:-.5},minHudAngle:{default:-.2},maxHudAngle:{default:.7},hudDistance:{default:.4},spawnerPlatformWidth:{default:.0625},spawnerPlatformSpacing:{default:.021}},init:(()=>{const e=new THREE.Vector3,t=new THREE.Vector3;return function(){this._onFrozen=this._onFrozen.bind(this),this._onThaw=this._onThaw.bind(this);const i=this.data.spawnerPlatformWidth,n=this.data.spawnerPlatformSpacing;this.spawnerEntities=[];for(let a=0;a<X.length;a++){const s=document.createElement("a-entity"),o=new URL(X[a],window.location.href).href;s.setAttribute("media-loader",{src:o}),s.setAttribute("hoverable-visuals",""),s.setAttribute("scale",{x:this.data.spawnerScale,y:this.data.spawnerScale,z:this.data.spawnerScale}),s.setAttribute("is-remote-hover-target",""),s.setAttribute("tags",{isHandCollisionTarget:!1}),s.setAttribute("visibility-while-frozen",{requireHoverOnNonMobile:!1}),s.setAttribute("css-class","interactable"),s.setAttribute("body-helper",{mass:0,type:$.TYPE.STATIC,collisionFilterGroup:Y.INTERACTABLES,collisionFilterMask:Y.DEFAULT_SPAWNER});const r={src:new URL(Q[a],window.location.href).href,resolve:!1,particleCount:20,startSize:.01,endSize:.2,sizeRandomness:.05,lifetime:1,lifetimeRandomness:.2,ageRandomness:1,startVelocity:{x:0,y:1,z:0},endVelocity:{x:0,y:.25,z:0},startOpacity:1,middleOpacity:1,endOpacity:0};s.addEventListener("spawned-entity-created",t=>{if(this.el.sceneEl.is("vr-mode"))return;const i=t.detail.target.object3D,n=this.data.camera.object3D;i.updateMatrices(),n.getWorldPosition(e),i.lookAt(e.x,i.position.y,e.z),i.matrixNeedsUpdate=!0}),s.addEventListener("spawned-entity-loaded",e=>{e.detail.target.querySelector(".particle-emitter").setAttribute("particle-emitter",r),e.detail.target.setAttribute("emoji",{particleEmitterConfig:r})}),s.setAttribute("super-spawner",{src:o,template:"#interactable-emoji-media",spawnScale:{x:this.data.spawnedScale,y:this.data.spawnedScale,z:this.data.spawnedScale}});const l=document.createElement("a-cylinder");l.setAttribute("visibility-while-frozen",{requireHoverOnNonMobile:!1}),l.setAttribute("material",{opacity:.2,color:"#2f7fee"}),l.setAttribute("segments-height",1),l.setAttribute("segments-radial",16),l.setAttribute("scale",{x:i/2,y:i/20,z:i/5}),l.setAttribute("rotation",{x:45,y:0,z:0}),K(a,X.length,i,n,t),s.object3D.position.copy(t),s.object3D.matrixNeedsUpdate=!0,l.object3D.position.set(t.x,-i/2,t.z+.01),l.object3D.matrixNeedsUpdate=!0,this.el.appendChild(s),this.el.appendChild(l),this.spawnerEntities.push(s)}}})(),play(){this.el.sceneEl.addEventListener("stateadded",this._onFrozen),this.el.sceneEl.addEventListener("stateremoved",this._onThaw),this._updateOffset()},pause(){this.el.sceneEl.removeEventListener("stateadded",this._onFrozen),this.el.sceneEl.removeEventListener("stateremoved",this._onThaw)},_onFrozen(e){if("frozen"===e.detail){this._updateOffset();for(let e=0;e<this.spawnerEntities.length;e++)this.spawnerEntities[e].components.tags.data.isHandCollisionTarget=!0}},_onThaw(e){if("frozen"===e.detail)for(let e=0;e<this.spawnerEntities.length;e++)this.spawnerEntities[e].components.tags.data.isHandCollisionTarget=!1},_updateOffset:function(){const e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3(1,0,0);return function(){const s=this.el.object3D,o=this.data.camera.object3D;o.updateMatrices(),t.set(0,0,-1),t.transformDirection(o.matrixWorld),i.set(0,0,-1),i.transformDirection(o.matrixWorld),i.projectOnPlane(THREE.Object3D.DefaultUp).normalize();const r=Math.sign(THREE.Object3D.DefaultUp.dot(t))*i.angleTo(t),l=r-Math.max(this.data.minHudAngle,Math.min(this.data.maxHudAngle,r));n.set(0,0,-1),n.applyAxisAngle(a,this.data.hudAngle-l),n.multiplyScalar(this.data.hudDistance),o.localToWorld(n),s.parent.worldToLocal(n),s.position.copy(n),s.updateMatrices(!0),o.getWorldPosition(e),s.lookAt(e),s.matrixNeedsUpdate=!0}}()});var J=i(380),ee=i.n(J),te=i(117),ie=i.n(te);AFRAME.registerComponent("virtual-gamepad-controls",{schema:{},init(){this.characterController=this.el.sceneEl.systems["hubs-systems"].characterController,this.onEnterVr=this.onEnterVr.bind(this),this.onExitVr=this.onExitVr.bind(this),this.onFirstInteraction=this.onFirstInteraction.bind(this),this.onMoveJoystickChanged=this.onMoveJoystickChanged.bind(this),this.onMoveJoystickEnd=this.onMoveJoystickEnd.bind(this),this.onLookJoystickChanged=this.onLookJoystickChanged.bind(this),this.onLookJoystickEnd=this.onLookJoystickEnd.bind(this),this.mockJoystickContainer=document.createElement("div"),this.mockJoystickContainer.classList.add(ie.a.mockJoystickContainer);const e=document.createElement("div");e.classList.add(ie.a.mockJoystick);const t=document.createElement("div");t.classList.add(ie.a.mockJoystick,ie.a.inner),e.appendChild(t),this.mockJoystickContainer.appendChild(e);const i=document.createElement("div");i.classList.add(ie.a.mockJoystick);const n=document.createElement("div");n.classList.add(ie.a.mockJoystick,ie.a.inner),i.appendChild(n),this.mockJoystickContainer.appendChild(i),document.body.appendChild(this.mockJoystickContainer),this.enableLeft=window.APP.store.state.preferences.enableOnScreenJoystickLeft,this.enableLeft&&this.createLeftStick(),this.enableRight=window.APP.store.state.preferences.enableOnScreenJoystickRight,this.enableRight&&this.createRightStick(),this.onPreferenceChange=this.onPreferenceChange.bind(this),window.APP.store.addEventListener("statechanged",this.onPreferenceChange),this.inVr=!1,this.moving=!1,this.rotating=!1,this.displacement=new THREE.Vector3,this.lookDy=0,this.lookDx=0,this.el.sceneEl.addEventListener("enter-vr",this.onEnterVr),this.el.sceneEl.addEventListener("exit-vr",this.onExitVr)},onPreferenceChange(){const e=window.APP.store.state.preferences.enableOnScreenJoystickLeft,t=window.APP.store.state.preferences.enableOnScreenJoystickRight;!this.enableLeft&&e?this.createLeftStick():this.enableLeft&&!e&&(this.leftStick.destroy(),this.leftTouchZone.parentNode.removeChild(this.leftTouchZone),this.leftStick=null,this.leftTouchZone=null),!this.enableRight&&t?this.createRightStick():this.enableRight&&!t&&(this.rightStick.destroy(),this.rightTouchZone.parentNode.removeChild(this.rightTouchZone),this.rightStick=null,this.rightTouchZone=null),this.enableLeft=e,this.enableRight=t},createRightStick(){this.rightTouchZone=document.createElement("div"),this.rightTouchZone.classList.add(ie.a.touchZone,ie.a.right),document.body.appendChild(this.rightTouchZone),this.rightStick=ee.a.create({zone:this.rightTouchZone,color:"white",fadeTime:0}),this.rightStick.on("start",this.onFirstInteraction),this.rightStick.on("move",this.onLookJoystickChanged),this.rightStick.on("end",this.onLookJoystickEnd)},createLeftStick(){this.leftTouchZone=document.createElement("div"),this.leftTouchZone.classList.add(ie.a.touchZone,ie.a.left),document.body.appendChild(this.leftTouchZone),this.leftStick=ee.a.create({zone:this.leftTouchZone,color:"white",fadeTime:0}),this.leftStick.on("start",this.onFirstInteraction),this.leftStick.on("move",this.onMoveJoystickChanged),this.leftStick.on("end",this.onMoveJoystickEnd)},onFirstInteraction(){this.leftStick&&this.leftStick.off("start",this.onFirstInteraction),this.rightStick&&this.rightStick.off("start",this.onFirstInteraction),this.mockJoystickContainer&&document.body.removeChild(this.mockJoystickContainer),this.mockJoystickContainer=null},onMoveJoystickChanged(e,t){if(window.APP.preferenceScreenIsVisible)return;const i=t.angle.radian,n=t.force<1?t.force:1;this.displacement.set(Math.cos(i),0,Math.sin(i)).multiplyScalar(1.85*n),this.moving=!0},onMoveJoystickEnd(){this.moving=!1,this.displacement.set(0,0,0)},onLookJoystickChanged(e,t){if(window.APP.preferenceScreenIsVisible)return;const i=t.angle.radian,n=t.force<1?t.force:1;this.rotating=!0,this.lookDy=-Math.cos(i)*n*.05,this.lookDx=Math.sin(i)*n*.05},onLookJoystickEnd(){this.rotating=!1,this.lookDx=0,this.lookDy=0,this.el.sceneEl.emit("rotateX",this.lookDx)},tick(){this.inVr||(this.moving&&this.characterController.enqueueRelativeMotion(this.displacement),this.rotating&&(this.characterController.enqueueInPlaceRotationAroundWorldUp(this.lookDy),this.el.sceneEl.emit("rotateX",this.lookDx)))},onEnterVr(){this.inVr=!0,this.leftTouchZone&&(this.leftTouchZone.style.display="none"),this.rightTouchZone&&(this.rightTouchZone.style.display="none")},onExitVr(){this.inVr=!1,this.leftTouchZone&&(this.leftTouchZone.style.display="block"),this.rightTouchZone&&(this.rightTouchZone.style.display="block")},remove(){this.el.sceneEl.removeEventListener("entervr",this.onEnterVr),this.el.sceneEl.removeEventListener("exitvr",this.onExitVr),document.body.removeChild(this.mockJoystickContainer),this.leftTouchZone&&document.body.removeChild(this.leftTouchZone),this.rightTouchZone&&document.body.removeChild(this.rightTouchZone)}});var ne=i(14);const{Vector3:ae,Quaternion:se,Matrix4:oe,Euler:re}=THREE;AFRAME.registerComponent("ik-root",{schema:{camera:{type:"string",default:".camera"},leftController:{type:"string",default:".left-controller"},rightController:{type:"string",default:".right-controller"}},update(e){this.data.camera!==e.camera&&(this.camera=this.el.querySelector(this.data.camera)),this.data.leftController!==e.leftController&&(this.leftController=this.el.querySelector(this.data.leftController)),this.data.rightController!==e.rightController&&(this.rightController=this.el.querySelector(this.data.rightController))}});const le={left:(new oe).makeRotationFromEuler(new re(-Math.PI/2,Math.PI/2,0)),right:(new oe).makeRotationFromEuler(new re(-Math.PI/2,-Math.PI/2,0))};AFRAME.registerComponent("ik-controller",{schema:{leftEye:{type:"string",default:"LeftEye"},rightEye:{type:"string",default:"RightEye"},head:{type:"string",default:"Head"},neck:{type:"string",default:"Neck"},leftHand:{type:"string",default:"LeftHand"},rightHand:{type:"string",default:"RightHand"},chest:{type:"string",default:"Spine"},rotationSpeed:{default:5},alwaysUpdate:{type:"boolean",default:!1}},init(){this._runScheduledWork=this._runScheduledWork.bind(this),this._updateIsInView=this._updateIsInView.bind(this),this.flipY=(new oe).makeRotationY(Math.PI),this.cameraForward=new oe,this.headTransform=new oe,this.hipsPosition=new ae,this.invHipsToHeadVector=new ae,this.middleEyeMatrix=new oe,this.middleEyePosition=new ae,this.invMiddleEyeToHead=new oe,this.cameraYRotation=new re,this.cameraYQuaternion=new se,this.invHipsQuaternion=new se,this.headQuaternion=new se,this.rootToChest=new oe,this.invRootToChest=new oe,this.ikRoot=function(e){for(;e&&(!e.components||!e.components["ik-root"]);)e=e.parentNode;return e&&e.components["ik-root"]}(this.el),this.isInView=!0,this.hasConvergedHips=!1,this.lastCameraTransform=new THREE.Matrix4,Object(ne.a)().then(()=>{this.playerCamera=document.getElementById("viewing-camera").getObject3D("camera")}),this.el.sceneEl.systems["frame-scheduler"].schedule(this._runScheduledWork,"ik"),this.forceIkUpdate=!0},remove(){this.el.sceneEl.systems["frame-scheduler"].unschedule(this._runScheduledWork,"ik")},update(e){this.avatar=this.el.object3D,this.data.leftEye!==e.leftEye&&(this.leftEye=this.el.object3D.getObjectByName(this.data.leftEye)),this.data.rightEye!==e.rightEye&&(this.rightEye=this.el.object3D.getObjectByName(this.data.rightEye)),this.data.head!==e.head&&(this.head=this.el.object3D.getObjectByName(this.data.head)),this.data.neck!==e.neck&&(this.neck=this.el.object3D.getObjectByName(this.data.neck)),this.data.leftHand!==e.leftHand&&(this.leftHand=this.el.object3D.getObjectByName(this.data.leftHand)),this.data.rightHand!==e.rightHand&&(this.rightHand=this.el.object3D.getObjectByName(this.data.rightHand)),this.data.chest!==e.chest&&(this.chest=this.el.object3D.getObjectByName(this.data.chest)),this.middleEyePosition.addVectors(this.leftEye.position,this.rightEye.position),this.middleEyePosition.divideScalar(2),this.middleEyeMatrix.makeTranslation(this.middleEyePosition.x,this.middleEyePosition.y,this.middleEyePosition.z),this.invMiddleEyeToHead=this.middleEyeMatrix.getInverse(this.middleEyeMatrix),this.invHipsToHeadVector.addVectors(this.chest.position,this.neck.position).add(this.head.position).negate()},tick(e,t){if(!this.ikRoot)return;const i=this.ikRoot.el.object3D;i.updateMatrices();const{camera:n,leftController:a,rightController:s}=this.ikRoot;n.object3D.updateMatrix();const o=!this.lastCameraTransform.equals(n.object3D.matrix);if(this.data.alwaysUpdate||this.forceIkUpdate||this.isInView&&(o||!this.hasConvergedHips)){o&&this.lastCameraTransform.copy(n.object3D.matrix);const{avatar:e,head:a,neck:s,chest:d,cameraForward:h,headTransform:u,invMiddleEyeToHead:p,invHipsToHeadVector:m,flipY:g,cameraYRotation:f,cameraYQuaternion:v,invHipsQuaternion:b,rootToChest:y,invRootToChest:_}=this;h.multiplyMatrices(n.object3D.matrix,g),u.multiplyMatrices(h,p),e.position.setFromMatrixPosition(u).add(m),f.setFromRotationMatrix(h,"YXZ"),f.x=0,f.z=0,v.setFromEuler(f),this._hadFirstTick?se.slerp(e.quaternion,v,e.quaternion,this.data.rotationSpeed*t/1e3):e.quaternion.copy(v),this.hasConvergedHips=(r=1e-4,l=v,c=e.quaternion,Math.abs(l.x-c.x)<r&&Math.abs(l.y-c.y)<r&&Math.abs(l.z-c.z)<r&&Math.abs(l.w-c.w)<r||Math.abs(-l.x-c.x)<r&&Math.abs(-l.y-c.y)<r&&Math.abs(-l.z-c.z)<r&&Math.abs(-l.w-c.w)<r),b.copy(e.quaternion).inverse(),a.quaternion.setFromRotationMatrix(u).premultiply(b),e.updateMatrix(),y.multiplyMatrices(e.matrix,d.matrix),_.getInverse(y),i.matrixNeedsUpdate=!0,s.matrixNeedsUpdate=!0,a.matrixNeedsUpdate=!0,d.matrixNeedsUpdate=!0}var r,l,c;const{leftHand:d,rightHand:h}=this;d&&this.updateHand(le.left,d,a.object3D,!0,this.isInView),h&&this.updateHand(le.right,h,s.object3D,!1,this.isInView),this.forceIkUpdate=!1,this._hadFirstTick||(this.ikRoot.el.object3D.visible=!0,this._hasFirstTick=!0)},updateHand(e,t,i,n,a){const s=t.matrix,o=t.el.components["personal-space-invader"];o?o.setAlwaysHidden(!i.visible):t.visible=i.visible,i.visible&&(a||this.forceIkUpdate||this.data.alwaysUpdate)&&(s.multiplyMatrices(this.invRootToChest,i.matrix),s.multiply(e),t.position.setFromMatrixPosition(s),t.rotation.setFromRotationMatrix(s),t.matrixNeedsUpdate=!0)},_runScheduledWork(){this.forceIkUpdate=!0,this._updateIsInView()},_updateIsInView:function(){const e=new THREE.Frustum,t=new THREE.Matrix4,i=new THREE.Vector3,n=(i,n)=>(t.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),e.setFromMatrix(t),e.containsPoint(n));return function(){if(!this.playerCamera)return;if(this.ikRoot.camera.object3D.getWorldPosition(i),this.isInView=n(this.playerCamera,i),!this.isInView){const e=this.el.sceneEl.systems["camera-tools"];e&&e.ifMyCameraRenderingViewfinder(e=>{this.isInView=this.isInView||n(e.camera,i)})}}}()});var ce=i(1);const de="open",he="point",ue="fist",pe="thumbUp",me="thumbDown",ge="indexDown",fe="pinch",ve="mrpDown";AFRAME.registerComponent("hand-controls2",{schema:{default:"left"},init(){this.pose=de},poseForFingers:(e,t,i)=>e||t||i?e&&t&&i?ue:!e&&t&&i?pe:e||t||!i?e||!t||i?!e||t||i?e&&t&&!i?fe:e&&!t&&i?he:(console.warn(`Did not find matching pose for thumb ${e}, index ${t}, middleRingPinky ${i}`),de):me:ge:ve:de,tick(){const e=this.data,t=AFRAME.scenes[0].systems.userinput,i="left"===e?ce.a.actions.leftHand:ce.a.actions.rightHand,n=t.get(i.thumb),a=t.get(i.index),s=t.get(i.middleRingPinky),o=this.poseForFingers(n,a,s);o!==this.pose&&(this.el.emit("hand-pose",{previous:this.pose,current:o}),this.pose=o)}});i(149);AFRAME.registerComponent("hover-visuals",{schema:{hand:{type:"string"}},init(){this.handleLeftVisuals=this.handleLeftVisuals.bind(this),this.handleRightVisuals=this.handleRightVisuals.bind(this),this.hadLeftVisualLastFrame=!1,this.hadRightVisualLastFrame=!1,this.uniforms=null,this.sweepParams=[0,1]},remove(){this.uniforms=null},tick(){this.uniforms&&this.uniforms.length&&("left"===this.data.hand?this.handleLeftVisuals():this.handleRightVisuals())},handleLeftVisuals:function(){const e=AFRAME.scenes[0].systems.interaction,t=e.state.leftHand.held||e.state.leftHand.hovered,i=!t||!Object(m.d)(t);if(i&&!this.hadLeftVisualLastFrame)return;this.hadLeftVisualLastFrame=!i;const n=this.el.object3D.matrixWorld.elements;for(let e=0,t=this.uniforms.length;e<t;e++){const t=this.uniforms[e];t.hubs_HighlightInteractorOne.value=!i,t.hubs_InteractorOnePos.value[0]=n[12],t.hubs_InteractorOnePos.value[1]=n[13],t.hubs_InteractorOnePos.value[2]=n[14]}},handleRightVisuals:function(){const e=AFRAME.scenes[0].systems.interaction,t=e.state.rightHand.held||e.state.rightHand.hovered,i=!t||!Object(m.d)(t);if(i&&!this.hadRightVisualLastFrame)return;this.hadRightVisualLastFrame=!i;const n=this.el.object3D.matrixWorld.elements;for(let e=0,t=this.uniforms.length;e<t;e++){const t=this.uniforms[e];t.hubs_SweepParams.value=this.sweepParams,t.hubs_HighlightInteractorTwo.value=!i,t.hubs_InteractorTwoPos.value[0]=n[12],t.hubs_InteractorTwoPos.value[1]=n[13],t.hubs_InteractorTwoPos.value[2]=n[14]}}}),AFRAME.registerComponent("offset-relative-to",{schema:{target:{type:"selector"},offset:{type:"vec3"},on:{type:"string"},orientation:{default:1},selfDestruct:{default:!1},lookAt:{default:!1}},init(){this.updateOffset=this.updateOffset.bind(this),Object(ne.a)().then(()=>{this.data.on?this.el.sceneEl.addEventListener(this.data.on,this.updateOffset):this.updateOffset()})},updateOffset:function(){const e=new THREE.Vector3(0,1,0),t=new THREE.Vector3(0,0,-1),i=Math.PI/2,n=new THREE.Vector3,a=new THREE.Vector3;return function(){const s=this.el.object3D,o=this.data.target.object3D;switch(n.copy(this.data.offset),o.localToWorld(n),s.parent&&s.parent.worldToLocal(n),s.position.copy(n),this.data.lookAt?(o.getWorldPosition(a),s.updateMatrices(!0),s.lookAt(a)):o.getWorldQuaternion(s.quaternion),this.data.orientation){case 8:s.rotateOnAxis(t,3*i);break;case 7:s.rotateOnAxis(t,3*i),s.rotateOnAxis(e,2*i);break;case 6:s.rotateOnAxis(t,i);break;case 5:s.rotateOnAxis(t,i),s.rotateOnAxis(e,2*i);break;case 4:s.rotateOnAxis(t,2*i),s.rotateOnAxis(e,2*i);break;case 3:s.rotateOnAxis(t,2*i);break;case 2:s.rotateOnAxis(e,2*i)}s.matrixNeedsUpdate=!0,this.data.selfDestruct&&(this.data.on&&this.el.sceneEl.removeEventListener(this.data.on,this.updateOffset),this.el.removeAttribute("offset-relative-to"))}}()});var be=i(17),ye=i(42),_e=i(126);function we(e){const{nodes:t}=e;if(!t.some(e=>"Head"===e.name)){const i=e.scenes[e.scene].nodes[0];t.push({name:"LeftEye",extensions:{MOZ_hubs_components:{}}}),t.push({name:"RightEye",extensions:{MOZ_hubs_components:{}}}),t.push({name:"Head",children:[i,t.length-1,t.length-2],extensions:{MOZ_hubs_components:{"scale-audio-feedback":""}}}),t.push({name:"Neck",children:[t.length-1]}),t.push({name:"Spine",children:[t.length-1]}),t.push({name:"Hips",children:[t.length-1]}),t.push({name:"AvatarRoot",children:[t.length-1]}),e.scenes[e.scene].nodes[0]=t.length-1}return e}AFRAME.registerComponent("player-info",{schema:{avatarSrc:{type:"string"},avatarType:{type:"string",default:ye.a.SKINNABLE}},init(){this.displayName=null,this.identityName=null,this.isOwner=!1,this.isRecording=!1,this.applyProperties=this.applyProperties.bind(this),this.updateDisplayName=this.updateDisplayName.bind(this),this.applyDisplayName=this.applyDisplayName.bind(this),this.handleModelError=this.handleModelError.bind(this),this.update=this.update.bind(this),this.isLocalPlayerInfo="avatar-rig"===this.el.id,this.playerSessionId=null,this.isLocalPlayerInfo||NAF.utils.getNetworkedEntity(this.el).then(e=>{this.playerSessionId=NAF.utils.getCreator(e);const t=window.APP.hubChannel.presence.state[this.playerSessionId];t&&this.updateDisplayNameFromPresenceMeta(t.metas[0])}),Object(_e.c)(this,"player-info")},remove(){Object(_e.a)(this,"player-info")},play(){this.el.addEventListener("model-loaded",this.applyProperties),this.el.sceneEl.addEventListener("presence_updated",this.updateDisplayName),this.isLocalPlayerInfo&&this.el.querySelector(".model").addEventListener("model-error",this.handleModelError),window.APP.store.addEventListener("statechanged",this.update),this.el.sceneEl.addEventListener("stateadded",this.update),this.el.sceneEl.addEventListener("stateremoved",this.update)},pause(){this.el.removeEventListener("model-loaded",this.applyProperties),this.el.sceneEl.removeEventListener("presence_updated",this.updateDisplayName),this.isLocalPlayerInfo&&this.el.querySelector(".model").removeEventListener("model-error",this.handleModelError),this.el.sceneEl.removeEventListener("stateadded",this.update),this.el.sceneEl.removeEventListener("stateremoved",this.update),window.APP.store.removeEventListener("statechanged",this.update)},update(){this.applyProperties()},updateDisplayName(e){!this.playerSessionId&&this.isLocalPlayerInfo&&(this.playerSessionId=NAF.clientId),this.playerSessionId&&this.playerSessionId===e.detail.sessionId&&this.updateDisplayNameFromPresenceMeta(e.detail)},updateDisplayNameFromPresenceMeta(e){this.displayName=e.profile.displayName,this.identityName=e.profile.identityName,this.isRecording=!(!e.streaming&&!e.recording),this.isOwner=!(!e.roles||!e.roles.owner),this.applyDisplayName()},applyDisplayName(){const e=window.APP.store,t=this.isLocalPlayerInfo||e.state.preferences.onlyShowNametagsInFreeze&&!this.el.sceneEl.is("frozen"),i=this.el.querySelector(".nametag");this.displayName&&i&&(i.setAttribute("text",{value:this.displayName}),i.object3D.visible=!t);const n=this.el.querySelector(".identityName");n&&this.identityName&&(n.setAttribute("text",{value:this.identityName}),n.object3D.visible=this.el.sceneEl.is("frozen"));const a=this.el.querySelector(".recordingBadge");a&&(a.object3D.visible=this.isRecording&&!t);const s=this.el.querySelector(".modBadge");s&&(s.object3D.visible=!this.isRecording&&this.isOwner&&!t)},applyProperties(e){this.applyDisplayName();const t=this.el.querySelector(".model");if(this.data.avatarSrc&&t&&(t.components["gltf-model-plus"].jsonPreprocessor=we,t.setAttribute("gltf-model-plus","src",this.data.avatarSrc)),!e||e.target===t){const e=Object(be.j)(this.el.object3D);this.el.querySelectorAll("[hover-visuals]").forEach(t=>{t.components["hover-visuals"].uniforms=e})}},handleModelError(){window.APP.store.resetToRandomDefaultAvatar()}});i(358);var Ee=i(88);const xe={open:"allOpen",thumbDown:"thumbDown",indexDown:"indexDown",mrpDown:"mrpDown",thumbUp:"thumbsUp",point:"point",fist:"allGrip",pinch:"pinch"},Se=["allOpen","thumbDown","indexDown","mrpDown","thumbsUp","point","allGrip","pinch"];AFRAME.registerComponent("hand-pose",{multiple:!0,init(){this.pose=0,this.animatePose=this.animatePose.bind(this);const e=Object(Ee.a)(this.el,"animation-mixer"),t="left"==this.id?"_L":"_R";if(this.mixer=e&&e.components["animation-mixer"].mixer,!this.mixer||!this.mixer.clipAction(xe.open+t))return console.warn("Avatar does not an 'allOpen' animation, disabling hand animations"),void this.el.removeAttribute("hand-pose");this.from=this.to=this.mixer.clipAction(xe.open+t),this.from.play(),this.networkField=`${this.id}_hand_pose`;const i=e=>{if(!e)return void window.setTimeout(()=>{i(this.el)},1e3);const t=e.components&&e.components["networked-avatar"];return t||i(e.parentEl)};this.networkedAvatar=i(this.el)},tick(){this.networkedAvatar&&this.networkedAvatar.data&&this.networkedAvatar.data[this.networkField]!==this.pose&&(this.animatePose(Se[this.pose],Se[this.networkedAvatar.data[this.networkField]]),this.pose=this.networkedAvatar.data[this.networkField])},animatePose(e,t){this.from.stop(),this.to.stop();const i="left"==this.id?"_L":"_R";this.from=this.mixer.clipAction(e+i),this.to=this.mixer.clipAction(t+i),this.from.fadeOut(.065),this.to.fadeIn(.065),this.to.play(),this.from.play(),this.mixer.update(.001)}}),AFRAME.registerComponent("hand-pose-controller",{multiple:!0,schema:{eventSrc:{type:"selector"},networkedAvatar:{type:"selector"}},init:function(){this.setHandPose=this.setHandPose.bind(this)},play:function(){this.data.eventSrc.addEventListener("hand-pose",this.setHandPose)},pause:function(){this.data.eventSrc.removeEventListener("hand-pose",this.setHandPose)},setHandPose:function(e){this.data.networkedAvatar.setAttribute("networked-avatar",`${this.id}_hand_pose`,Se.indexOf(xe[e.detail.current]))}});var Ce=i(47);const ke=2*Math.PI;AFRAME.registerComponent("hud-controller",{schema:{head:{type:"selector"},offset:{default:.7},lookCutoff:{default:20},animRange:{default:30},yawCutoff:{default:50}},init(){this.onChildHovered=this.onChildHovered.bind(this),this.removeHoverEvents=this.removeHoverEvents.bind(this),this.isYLocked=!1,this.lockedHeadPositionY=0,this.lookDir=new THREE.Vector3,this.lookEuler=new THREE.Euler,this.store=window.APP.store,this.hoverableChildren=this.el.querySelectorAll("[is-remote-hover-target]")},tick(){const e=this.el.object3D,t=this.data.head.object3D,{offset:i,lookCutoff:n,animRange:a,yawCutoff:s}=this.data,o=t.rotation.x*THREE.Math.RAD2DEG,r=function(e,t){const i=Math.abs(t-e)%ke;return i>Math.PI?ke-i:i}(t.rotation.y,e.rotation.y)*THREE.Math.RAD2DEG,l=!this.store.state.activity.hasHoveredInWorldHud;let c=1-THREE.Math.clamp(n-o,0,a)/a;l&&(c=1),1===c?(this.lockedHeadPositionY=t.position.y,this.hudLocked=!0):this.hudLocked&&o<n-a/2&&(this.hudLocked=!1),this.hudLocked&&(c=1);const d=r>=s||o<n-a/2;d&&(this.lookDir.set(0,0,-1),this.lookDir.applyQuaternion(t.quaternion),this.lookDir.add(t.position),e.position.x=this.lookDir.x,e.position.z=this.lookDir.z,e.rotation.copy(t.rotation),e.rotation.x=0,e.rotation.z=0),e.visible=(!d||l)&&this.el.sceneEl.systems["hubs-systems"].cameraSystem.mode===Ce.b,e.position.y=(this.isYLocked?this.lockedHeadPositionY:t.position.y)+i+(1-c)*i,e.rotation.x=(1-c)*THREE.Math.DEG2RAD*90,e.matrixNeedsUpdate=!0},play(){for(let e=0;e<this.hoverableChildren.length;e++)this.hoverableChildren[e].object3D.addEventListener("hovered",this.onChildHovered)},pause(){this.removeHoverEvents()},removeHoverEvents(){for(let e=0;e<this.hoverableChildren.length;e++)this.hoverableChildren[e].object3D.removeEventListener("hovered",this.onChildHovered)},onChildHovered(){this.store.state.activity.hasHoveredInWorldHud||(this.store.update({activity:{hasHoveredInWorldHud:!0}}),this.removeHoverEvents())}}),AFRAME.registerComponent("freeze-controller",{init:function(){this.onToggle=this.onToggle.bind(this)},tick:function(){const e=this.el.sceneEl;if(e.is("entered"))if(e.systems["hubs-systems"].cameraSystem.mode===Ce.c)this.el.is("frozen")&&this.onToggle(),NAF.connection.adapter.frozen||NAF.connection.adapter.toggleFreeze(),this.wasInspecting=!0;else if(this.wasInspecting)NAF.connection.adapter.frozen&&NAF.connection.adapter.toggleFreeze(),this.wasInspecting=!1;else{const t=e.systems.userinput,i=t.get(ce.a.actions.ensureFrozen),n=t.get(ce.a.actions.thaw),a=t.get(ce.a.actions.toggleFreeze);(this.el.is("frozen")&&n||!this.el.is("frozen")&&i||a)&&this.onToggle()}},onToggle:function(){window.APP.store.update({activity:{hasFoundFreeze:!0}}),NAF.connection.adapter&&(NAF.connection.adapter.toggleFreeze(),NAF.connection.adapter.frozen?(this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(v.e),this.el.addState("frozen")):(this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(v.v),this.el.removeState("frozen")))}});i(992),i(993),i(994),i(995),i(996),i(997),i(998),i(999),i(1e3),i(1001);var Ae=i(12);const Te=AFRAME.utils.device.isMobile();AFRAME.registerComponent("visibility-while-frozen",{schema:{withinDistance:{type:"number"},visible:{type:"boolean",default:!0},requireHoverOnNonMobile:{type:"boolean",default:!0},withPermission:{type:"string"},withoutPermission:{type:"string"},visibleIfOwned:{type:"boolean",default:!0}},init(){this.updateVisibility=this.updateVisibility.bind(this),this.camWorldPos=new THREE.Vector3,this.objWorldPos=new THREE.Vector3,Object(ne.a)().then(()=>{this.cam=document.getElementById("avatar-pov-node").object3D,this.updateVisibility()});let e=this.el;for(;e!==document;){if(null!==e.getAttribute("is-remote-hover-target")){this.hoverable=e;break}e=e.parentNode}!this.hoverable&&this.data.requireHoverOnNonMobile&&console.error("Didn't find a remote hover target."),this.data.visibleIfOwned||NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEl=e}).then(()=>{}),this.onStateChange=e=>{"frozen"!==!e.detail&&this.updateVisibility()},this.updateVisibility()},tick(){const e=this.el.sceneEl.is("frozen"),t=this.el.object3D.visible,i=e===!this.data.visible;!t&&i||this.updateVisibility()},updateVisibility(){if(!this.cam)return;const e=this.el.sceneEl.is("frozen");let t=!0;const i=this.el.object3D.visible;this.data.withinDistance&&(i||this.el.object3D.updateMatrices(!0,!0),Object(Ae.h)(this.cam,this.camWorldPos),this.objWorldPos.copy(this.el.object3D.position),this.el.object3D.localToWorld(this.objWorldPos),t=this.camWorldPos.distanceToSquared(this.objWorldPos)<this.data.withinDistance*this.data.withinDistance);const n=this.el.sceneEl.systems["transform-selected-object"].transforming;if(this.data.withPermission&&this.data.withoutPermission)throw new Error("only withPermission or withoutPermission can be speciifed on visibility-while-frozen, not both.");let a=!!(!this.data.withPermission&&!this.data.withoutPermission||this.data.withPermission&&window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission)||this.data.withoutPermission&&!window.APP.hubChannel.canOrWillIfCreator(this.data.withoutPermission))&&(e&&this.data.visible||!e&&!this.data.visible)&&t&&!n;this.data.requireHoverOnNonMobile&&!Te&&(a=a&&(this.hoverable&&(this.el.sceneEl.systems.interaction.state.rightRemote.hovered===this.hoverable||this.el.sceneEl.systems.interaction.state.leftRemote.hovered===this.hoverable)||i)),this.data.visibleIfOwned||(a=a&&this.networkedEl&&!NAF.utils.isMine(this.networkedEl)),i!==a&&this.el.setAttribute("visible",a)},play(){this.el.sceneEl.addEventListener("stateadded",this.onStateChange),this.el.sceneEl.addEventListener("stateremoved",this.onStateChange),this.hoverable&&(this.hoverable.object3D.addEventListener("hovered",this.updateVisibility),this.hoverable.object3D.addEventListener("unhovered",this.updateVisibility))},pause(){this.el.sceneEl.removeEventListener("stateadded",this.onStateChange),this.el.sceneEl.removeEventListener("stateremoved",this.onStateChange),this.hoverable&&(this.hoverable.object3D.addEventListener("hovered",this.updateVisibility),this.hoverable.object3D.addEventListener("unhovered",this.updateVisibility))}}),AFRAME.registerComponent("ui-class-while-frozen",{init(){this.onStateChange=e=>{"frozen"!==!e.detail&&this.el.classList.toggle("ui",this.el.sceneEl.is("frozen"))},this.el.classList.toggle("ui",this.el.sceneEl.is("frozen"))},play(){this.el.sceneEl.addEventListener("stateadded",this.onStateChange),this.el.sceneEl.addEventListener("stateremoved",this.onStateChange)},pause(){this.el.sceneEl.removeEventListener("stateadded",this.onStateChange),this.el.sceneEl.removeEventListener("stateremoved",this.onStateChange)}});i(1002);var Me=i(21);AFRAME.registerComponent("stats-plus",{schema:{default:!1},init(){this.onExpand=this.onExpand.bind(this),this.onCollapse=this.onCollapse.bind(this),this.onEnterVr=this.onEnterVr.bind(this),this.onExitVr=this.onExitVr.bind(this);const e=this.el.sceneEl;if(this.stats=function(e){const t=new window.threeStats(e.renderer),i=new window.aframeStats(e),n=e.isMobile?[]:[t,i];return new window.rStats({css:[],values:{fps:{caption:"fps",below:30},batchdraws:{caption:"Draws"},batchinstances:{caption:"Instances"},batchatlassize:{caption:"Atlas Size"}},groups:[{caption:"Framerate",values:["fps","raf","physics"]},{caption:"Batching",values:["batchdraws","batchinstances","batchatlassize"]}],plugins:n})}(e),this.statsEl=document.querySelector(".rs-base"),!this.statsEl)return;const t=document.createElement("div");t.classList.add("rs-header");const i=document.createElement("h1");i.innerHTML="Stats",t.appendChild(i);const n=document.createElement("div");n.classList.add("rs-collapse-btn"),n.innerHTML="X",n.addEventListener("click",this.onCollapse),t.appendChild(n),this.statsEl.insertBefore(t,this.statsEl.firstChild),this.fpsEl=document.createElement("div"),this.fpsEl.addEventListener("click",this.onExpand),this.fpsEl.classList.add("rs-fps-counter"),document.body.appendChild(this.fpsEl),this.lastFpsUpdate=performance.now(),this.lastFps=0,this.frameCount=0,this.inVR=e.is("vr-mode"),e.isMobile&&(this.statsEl.classList.add("rs-mobile"),this.fpsEl.classList.add("rs-mobile")),e.addEventListener("enter-vr",this.onEnterVr),e.addEventListener("exit-vr",this.onExitVr),this.vrStatsEnabled=Object(Me.a)("vrstats"),this.vrStatsEnabled&&this.initVRStats(),this.lastUpdate=0},initVRStats(){this.vrPanel=document.createElement("a-entity"),this.vrPanel.setAttribute("text",{width:.5,whiteSpace:"pre",value:"_",baseline:"bottom"}),this.vrPanel.addEventListener("loaded",()=>this.vrPanel.object3D.traverse(e=>{e.material&&(e.material.depthTest=!1)}),{once:!0}),this.el.append(this.vrPanel);const e=document.createElement("a-plane");e.setAttribute("color","#333333"),e.setAttribute("material","shader","flat"),e.setAttribute("material","depthTest",!1),e.setAttribute("width",.1),e.setAttribute("height",.12),e.setAttribute("position","-0.2 0.055 0"),this.el.append(e)},toggleVRStats(){this.vrStatsEnabled?(this.el.object3D.visible=!1,this.vrStatsEnabled=!1):(this.vrPanel||this.initVRStats(),this.el.object3D.visible=!0,this.vrStatsEnabled=!0)},update(e){e!==this.data&&(this.data?(this.statsEl.classList.remove("a-hidden"),this.fpsEl.classList.add("a-hidden")):(this.statsEl.classList.add("a-hidden"),this.fpsEl.classList.remove("a-hidden")))},tick(e){const t=this.stats;if(this.statsEl){if(this.data||this.vrStatsEnabled){t("rAF").tick(),t("FPS").frame(),t("physics").set(this.el.sceneEl.systems["hubs-systems"].physicsSystem.stepDuration);const e=this.el.sceneEl.systems["hubs-systems"].batchManagerSystem;if(e.batchingEnabled){const i=e.batchManager;t("batchdraws").set(i.batches.length),t("batchinstances").set(i.instanceCount),t("batchatlassize").set(i.atlas.arrayDepth)}t().update()}else if(!this.inVR){const e=performance.now();if(this.frameCount++,e>=this.lastFpsUpdate+1e3){const t=Math.round(this.frameCount/((e-this.lastFpsUpdate)/1e3));t!==this.lastFps&&(this.fpsEl.innerHTML=Math.round(t)+" FPS",this.lastFps=t),this.lastFpsUpdate=e,this.frameCount=0}}this.vrStatsEnabled&&e-this.lastUpdate>100&&(this.vrPanel.setAttribute("text","value",[`f ${t("fps").value().toFixed(0)}`,`r ${t("raf").value().toFixed(0)}`,`p ${t("physics").value().toFixed(0)}`,`c ${this.el.sceneEl.renderer.info.render.calls}`,`t ${(this.el.sceneEl.renderer.info.render.triangles/1e3).toFixed(0)}k`].join("\n")),this.lastUpdate=e)}},onEnterVr(){this.inVR=!0,this.el.sceneEl.isMobile&&(this.statsEl.classList.add("a-hidden"),this.fpsEl.classList.add("a-hidden"))},onExitVr(){this.inVR=!1,this.el.sceneEl.isMobile&&(this.data?this.statsEl.classList.remove("a-hidden"):this.fpsEl.classList.remove("a-hidden"))},onExpand(){this.el.setAttribute(this.name,!0)},onCollapse(){this.el.setAttribute(this.name,!1)},remove(){this.el.sceneEl.removeEventListener("enter-vr",this.hide),this.el.sceneEl.removeEventListener("exit-vr",this.show),this.statsEl&&(this.statsEl.parentNode.removeChild(this.statsEl),this.fpsEl.parentNode.removeChild(this.fpsEl))}});i(1003);var Le=i(500),Re=i.n(Le),Pe=i(501),De=i.n(Pe),Oe=i(502),He=i.n(Oe),je=i(176),Ie=i.n(je),Ne=i(11),Fe=i(503),Ve=i(113),Be=i(69),ze=i.n(Be);function Ue(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function We(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){Ue(s,n,a,o,r,"next",e)}function r(e){Ue(s,n,a,o,r,"throw",e)}o(void 0)})}}ze.a.GlobalWorkerOptions.workerSrc||(ze.a.GlobalWorkerOptions.workerSrc="https://assets-prod.reticulum.io/assets/js/pdfjs-dist@2.1.266/build/pdf.worker.js");const Ze={once:!0},Ge={type:"image/png"},qe=Object(Ve.a)(new Re.a),$e=AFRAME.utils.device.isIOS(),Ye=AFRAME.utils.device.isMobileVR()&&navigator.userAgent.match(/Firefox/),Xe=(new THREE.TextureLoader).load(He.a),Qe=[];for(let e=0;e<=20;e++){let t="[";for(let i=1;i<=20;i++)t+=e>=i?"|":" ";t+="]",Qe[e]=t}class Ke extends THREE.Texture{constructor(e,t,i){super(document.createElement("canvas")),this.image.width=e[0].width,this.image.height=e[0].height,this._ctx=this.image.getContext("2d"),this.generateMipmaps=!1,this.isVideoTexture=!0,this.minFilter=THREE.NearestFilter,this.frames=e,this.delays=t,this.disposals=i,this.frame=0,this.frameStartTime=Date.now()}update(){if(!this.frames||!this.delays||!this.disposals)return;const e=Date.now();e-this.frameStartTime>this.delays[this.frame]&&(2===this.disposals[this.frame]&&this._ctx.clearRect(0,0,this.image.width,this.image.width),this.frame=(this.frame+1)%this.frames.length,this.frameStartTime=e,this._ctx.drawImage(this.frames[this.frame],0,0,this.image.width,this.image.height),this.needsUpdate=!0)}}function Je(){return(Je=We(function*(e){return new Promise((t,i)=>{fetch(e,{mode:"cors"}).then(e=>e.arrayBuffer()).then(e=>qe(e,[e])).then(i=>{const{frames:n,delayTimes:a,disposals:s}=i;let o=0;for(let i=0;i<n.length;i++){const r=new Image;r.onload=r=>{if(o++,n[i]=r.target,o===n.length){const i=new Ke(n,a,s);i.image.src=e,i.encoding=THREE.sRGBEncoding,i.minFilter=THREE.LinearFilter,t(i)}},r.src=n[i]}}).catch(i)})})).apply(this,arguments)}function et(e){const t=document.createElement(e);return t.setAttribute("playsinline",""),t.setAttribute("webkit-playsinline",""),t.autoplay=!0,t.muted=$e,t.preload="auto",t.crossOrigin="anonymous",t}function tt(e,t){const i=Math.min(1,1/t),n=Math.min(1,t);e.object3DMap.mesh.scale.set(i,n,1),e.object3DMap.mesh.matrixNeedsUpdate=!0}function it(e){if(e.image instanceof HTMLVideoElement){const t=e.image;t.pause(),t.src="",t.load()}e.hls&&e.hls.destroy(),e.dispose()}const nt=new class{constructor(){var e,t,i;e=this,t="cache",i=new Map,t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}key(e,t){return`${e}_${t}`}set(e,t,i){const n=i.image;return this.cache.set(this.key(e,t),{texture:i,ratio:(n.videoHeight||n.height)/(n.videoWidth||n.width),count:0}),this.retain(e,t)}has(e,t){return this.cache.has(this.key(e,t))}get(e,t){return this.cache.get(this.key(e,t))}retain(e,t){const i=this.cache.get(this.key(e,t));return i.count++,i}release(e,t){const i=this.cache.get(this.key(e,t));i?(i.count--,i.count<=0&&(it(i.texture),this.cache.delete(this.key(e,t)))):console.error(`Releasing uncached texture src ${e}`)}},at=new Map,st=new Image;st.src=De.a;const ot=new THREE.Texture(st);ot.magFilter=THREE.NearestFilter,st.onload=()=>{ot.needsUpdate=!0};const rt={texture:ot,ratio:1};function lt(e){let t=Math.floor(e),i=Math.floor(t/3600);t-=3600*i;let n=Math.floor(t/60);return t-=60*n,i<10&&(i=`0${i}`),n<10&&(n=`0${n}`),t<10&&(t=`0${t}`),"00"===i?`${n}:${t}`:`${i}:${n}:${t}`}AFRAME.registerComponent("media-video",{schema:{src:{type:"string"},audioSrc:{type:"string"},contentType:{type:"string"},volume:{type:"number",default:.5},loop:{type:"boolean",default:!0},audioType:{type:"string",default:"pannernode"},hidePlaybackControls:{type:"boolean",default:!1},distanceModel:{type:"string",default:"inverse"},rolloffFactor:{type:"number",default:1},refDistance:{type:"number",default:1},maxDistance:{type:"number",default:1e4},coneInnerAngle:{type:"number",default:360},coneOuterAngle:{type:"number",default:0},coneOuterGain:{type:"number",default:0},videoPaused:{type:"boolean"},projection:{type:"string",default:"flat"},time:{type:"number"},tickRate:{default:1e3},syncTolerance:{default:2}},init(){this.onPauseStateChange=this.onPauseStateChange.bind(this),this.updateHoverMenu=this.updateHoverMenu.bind(this),this.tryUpdateVideoPlaybackState=this.tryUpdateVideoPlaybackState.bind(this),this.ensureOwned=this.ensureOwned.bind(this),this.isMineOrLocal=this.isMineOrLocal.bind(this),this.updateSrc=this.updateSrc.bind(this),this.seekForward=this.seekForward.bind(this),this.seekBack=this.seekBack.bind(this),this.volumeUp=this.volumeUp.bind(this),this.volumeDown=this.volumeDown.bind(this),this.snap=this.snap.bind(this),this.changeVolumeBy=this.changeVolumeBy.bind(this),this.togglePlaying=this.togglePlaying.bind(this),this.lastUpdate=0,this.videoMutedAt=0,this.localSnapCount=0,this.isSnapping=!1,this.videoIsLive=null,this.onSnapImageLoaded=()=>this.isSnapping=!1,this.el.setAttribute("hover-menu__video",{template:"#video-hover-menu",dirs:["forward","back"]}),this.el.components["hover-menu__video"].getHoverMenu().then(e=>{this.el.parentNode&&(this.hoverMenu=e,this.playbackControls=this.el.querySelector(".video-playback"),this.playPauseButton=this.el.querySelector(".video-playpause-button"),this.volumeUpButton=this.el.querySelector(".video-volume-up-button"),this.volumeDownButton=this.el.querySelector(".video-volume-down-button"),this.seekForwardButton=this.el.querySelector(".video-seek-forward-button"),this.seekBackButton=this.el.querySelector(".video-seek-back-button"),this.snapButton=this.el.querySelector(".video-snap-button"),this.timeLabel=this.el.querySelector(".video-time-label"),this.volumeLabel=this.el.querySelector(".video-volume-label"),this.playPauseButton.object3D.addEventListener("interact",this.togglePlaying),this.seekForwardButton.object3D.addEventListener("interact",this.seekForward),this.seekBackButton.object3D.addEventListener("interact",this.seekBack),this.volumeUpButton.object3D.addEventListener("interact",this.volumeUp),this.volumeDownButton.object3D.addEventListener("interact",this.volumeDown),this.snapButton.object3D.addEventListener("interact",this.snap),this.updateVolumeLabel(),this.updateHoverMenu(),this.updatePlaybackState())}),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEl=e,Object(m.a)(this.networkedEl.components.networked.data.networkId),this.updatePlaybackState(),this.networkedEl.addEventListener("pinned",this.updateHoverMenu),this.networkedEl.addEventListener("unpinned",this.updateHoverMenu),window.APP.hubChannel.addEventListener("permissions_updated",this.updateHoverMenu),$e||"scene"!==NAF.utils.getNetworkOwner(this.networkedEl)||setTimeout(()=>{"scene"===NAF.utils.getNetworkOwner(this.networkedEl)&&NAF.utils.takeOwnership(this.networkedEl)},2e3+Math.floor(2e3*Math.random()))}).catch(()=>{this.updatePlaybackState()});const e=this.el.sceneEl;e.audioListener=e.audioListener||new THREE.AudioListener,e.camera&&e.camera.add(e.audioListener),e.addEventListener("camera-set-active",function(t){t.detail.cameraEl.getObject3D("camera").add(e.audioListener)})},isMineOrLocal(){return!this.el.components.networked||this.networkedEl&&NAF.utils.isMine(this.networkedEl)},ensureOwned(){return!this.el.components.networked||this.networkedEl&&NAF.utils.isMine(this.networkedEl)||NAF.utils.takeOwnership(this.networkedEl)},seekForward(){!this.videoIsLive&&this.ensureOwned()&&(this.video.currentTime+=30,this.el.setAttribute("media-video","time",this.video.currentTime))},seekBack(){!this.videoIsLive&&this.ensureOwned()&&(this.video.currentTime-=10,this.el.setAttribute("media-video","time",this.video.currentTime))},changeVolumeBy(e){this.el.setAttribute("media-video","volume",THREE.Math.clamp(this.data.volume+e,0,1)),this.updateVolumeLabel()},volumeUp(){this.changeVolumeBy(.1)},volumeDown(){this.changeVolumeBy(-.1)},snap(){var e=this;return We(function*(){if(e.isSnapping)return;e.isSnapping=!0,e.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(v.b);const t=document.createElement("canvas");t.width=e.video.videoWidth,t.height=e.video.videoHeight,t.getContext("2d").drawImage(e.video,0,0,t.width,t.height);const i=yield new Promise(e=>t.toBlob(e)),n=new File([i],"snap.png",Ge);e.localSnapCount++;const{entity:a}=Object(be.a)(e.el,n,"photo-snapshot",e.localSnapCount);a.addEventListener("image-loaded",e.onSnapImageLoaded,Ze)})()},togglePlaying(){$e&&this.video.paused&&this.isMineOrLocal()?this.video.play():this.ensureOwned()&&this.tryUpdateVideoPlaybackState(!this.data.videoPaused)},onPauseStateChange(){$e&&this.video.paused&&this.isMineOrLocal()||this._ignorePauseStateChanges||(this.el.setAttribute("media-video","videoPaused",this.video.paused),this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&this.el.emit("owned-video-state-changed"))},updatePlaybackState(e){if(this.updateHoverMenu(),this.video&&(e||this.networkedEl&&!NAF.utils.isMine(this.networkedEl))&&(Math.abs(this.data.time-this.video.currentTime)>this.data.syncTolerance?this.tryUpdateVideoPlaybackState(this.data.videoPaused,this.data.time):this.tryUpdateVideoPlaybackState(this.data.videoPaused)),this.audio){const e=void 0!==window.APP.store.state.preferences.globalMediaVolume?window.APP.store.state.preferences.globalMediaVolume:100;this.audio.gain.gain.value=e/100*this.data.volume}},tryUpdateVideoPlaybackState(e,t){this._playbackStateChangeTimeout&&(clearTimeout(this._playbackStateChangeTimeout),delete this._playbackStateChangeTimeout),!1===this.videoIsLive&&void 0!==t&&(this.video.currentTime=t),this.hoverMenu&&this.playPauseButton.setAttribute("icon-button","active",e),e?this.video.pause():this.video.play().catch(()=>{e===this.data.videoPaused&&(this._playbackStateChangeTimeout=setTimeout(()=>this.tryUpdateVideoPlaybackState(e,t),1e3))})},update(e){var t=this;return We(function*(){const i=t.data.src;if(t.updatePlaybackState(),i&&i!==e.src)return t.updateSrc(e)})()},updateSrc(e){var t=this;return We(function*(){const{src:i,linkedVideoTexture:n,linkedAudioSource:a,linkedMediaElementAudioSource:s}=t.data;let o,r;t.cleanUp(),t.mesh&&t.mesh.material&&(t.mesh.material.map=null,t.mesh.material.needsUpdate=!0);try{if(n?(o=n,r=a):({texture:o,audioSourceEl:r}=yield t.createVideoTextureAudioSourceEl()),t.data.src!==i)return void it(o);if(t.mediaElementAudioSource=null,!i.startsWith("hubs://")&&!$e){const e=s||t.el.sceneEl.audioListener.context.createMediaElementSource(r);"pannernode"===t.data.audioType?(t.audio=new THREE.PositionalAudio(t.el.sceneEl.audioListener),t.audio.setDistanceModel(t.data.distanceModel),t.audio.setRolloffFactor(t.data.rolloffFactor),t.audio.setRefDistance(t.data.refDistance),t.audio.setMaxDistance(t.data.maxDistance),t.audio.panner.coneInnerAngle=t.data.coneInnerAngle,t.audio.panner.coneOuterAngle=t.data.coneOuterAngle,t.audio.panner.coneOuterGain=t.data.coneOuterGain):t.audio=new THREE.Audio(t.el.sceneEl.audioListener),t.mediaElementAudioSource=e,t.audio.setNodeSource(e),t.el.setObject3D("sound",t.audio)}if(t.video=o.image,t.video.loop=t.data.loop,t.video.addEventListener("pause",t.onPauseStateChange),t.video.addEventListener("play",t.onPauseStateChange),o.hls){const e=()=>{if(o.hls.currentLevel>=0){const e=!!t.videoIsLive;t.videoIsLive=o.hls.levels[o.hls.currentLevel].details.live,t.updateHoverMenu(),!e&&t.videoIsLive&&(Ye||(t.video.currentTime=t.video.duration-.01))}};o.hls.on(Ie.a.Events.LEVEL_LOADED,e),o.hls.on(Ie.a.Events.LEVEL_SWITCHED,e),o.hls.currentLevel>=0&&e()}else t.videoIsLive=t.video.duration===1/0,t.updateHoverMenu();if($e){const e=document.getElementById("video-unmute");t.el.appendChild(document.importNode(e.content,!0)),t.el.setAttribute("position-at-box-shape-border__unmute-ui",{target:".unmute-ui",dirs:["forward","back"]})}t.videoTexture=o,t.audioSource=r}catch(e){console.error("Error loading video",t.data.src,e),o=ot,t.videoTexture=t.audioSource=null}const l=t.data.projection;if(!t.mesh||l!==e.projection){const e=new THREE.MeshBasicMaterial;let i;"360-equirectangular"===l?(i=new THREE.SphereBufferGeometry(1,64,32)).scale(-1,1,1):(i=new THREE.PlaneBufferGeometry,e.side=THREE.DoubleSide),t.mesh=new THREE.Mesh(i,e),t.el.setObject3D("mesh",t.mesh)}t.data.contentType.startsWith("audio/")?t.mesh.material.map=Xe:t.mesh.material.map=o,t.mesh.material.needsUpdate=!0,"flat"!==l||t.data.contentType.startsWith("audio/")||tt(t.el,(o.image.videoHeight||o.image.height)/(o.image.videoWidth||o.image.width)),t.updatePlaybackState(!0),t.video&&t.video.muted&&(t.videoMutedAt=performance.now()),t.el.emit("video-loaded",{projection:l})})()},createVideoTextureAudioSourceEl(){var e=this;return We(function*(){const t=e.data.src,i=e.data.contentType;return new Promise(function(){var a=We(function*(a,s){e._audioSyncInterval&&(clearInterval(e._audioSyncInterval),e._audioSyncInterval=null);const o=et("video");let r,l,c;if(i.startsWith("audio/")?((r=new THREE.Texture).image=o,c=()=>!0):((r=new THREE.VideoTexture(o)).minFilter=THREE.LinearFilter,r.encoding=THREE.sRGBEncoding,c=()=>(r.image.videoHeight||r.image.height)&&(r.image.videoWidth||r.image.width)),t.startsWith("hubs://")){const e=t.substring(7).split("/")[1],i=yield NAF.connection.adapter.getMediaStream(e,"video");o.srcObject=new MediaStream(i.getVideoTracks())}else if(AFRAME.utils.material.isHLS(t,i))if(Ie.a.isSupported()){const i=`https://${n.a.CORS_PROXY_SERVER}/`,a=t.startsWith(i)?t.substring(i.length):t,l=()=>{r.hls&&(r.hls.stopLoad(),r.hls.detachMedia(),r.hls.destroy(),r.hls=null);const e=new Ie.a({xhrSetup:(e,t)=>{t.startsWith(i)&&(t=t.substring(i.length)),t.startsWith("http")||(t=Object(Fe.buildAbsoluteURL)(a,t.startsWith("/")?t:`/${t}`)),e.open("GET",Object(Ne.i)(t))}});r.hls=e,e.loadSource(t),e.attachMedia(o),e.on(Ie.a.Events.ERROR,function(t,i){if(i.fatal)switch(i.type){case Ie.a.ErrorTypes.NETWORK_ERROR:e.startLoad();break;case Ie.a.ErrorTypes.MEDIA_ERROR:e.recoverMediaError();break;default:return void s(t)}})};l();const d=setInterval(()=>{const i=e.data.src!==t;c()||i?clearInterval(d):(console.warn("HLS failed to read video, trying again"),l())},1e4)}else o.canPlayType(i)?(o.src=t,o.onerror=s):s("HLS unsupported");else o.src=t,o.onerror=s,e.data.audioSrc&&((l=et("audio")).src=e.data.audioSrc,l.onerror=s,e._audioSyncInterval=setInterval(()=>{Math.abs(l.currentTime-o.currentTime)>=.33&&(l.currentTime=o.currentTime),o.paused!==l.paused&&(o.paused?l.pause():l.play(),l.currentTime=o.currentTime)},1e3));const d=()=>{c()?a({texture:r,audioSourceEl:l||r.image}):setTimeout(d,500)};d()});return function(e,t){return a.apply(this,arguments)}}())})()},updateHoverMenu(){if(!this.hoverMenu)return;const e=this.el.components["media-loader"].data.linkedEl||this.el,t=e.components.pinnable&&e.components.pinnable.data.pinned;this.playbackControls.object3D.visible=!this.data.hidePlaybackControls&&!!this.video,this.timeLabel.object3D.visible=!this.data.hidePlaybackControls,this.snapButton.object3D.visible=!!this.video&&!this.data.contentType.startsWith("audio/")&&window.APP.hubChannel.can("spawn_and_move_media"),this.seekForwardButton.object3D.visible=!!this.video&&!this.videoIsLive;const i=!!this.video&&!this.videoIsLive&&(!t||window.APP.hubChannel.can("pin_objects"));this.playPauseButton.object3D.visible=this.seekForwardButton.object3D.visible=this.seekBackButton.object3D.visible=i,this.videoIsLive&&this.timeLabel.setAttribute("text","value","LIVE")},updateVolumeLabel(){this.volumeLabel.setAttribute("text","value",0===this.data.volume?"MUTE":Qe[Math.floor(this.data.volume/.05)])},tick(){if(!this.video)return;const e=this.el.sceneEl.systems.userinput,t=this.el.sceneEl.systems.interaction,i=e.get(ce.a.actions.cursor.right.mediaVolumeMod);t.state.rightRemote.hovered===this.el&&i&&this.changeVolumeBy(i);const n=e.get(ce.a.actions.cursor.left.mediaVolumeMod);t.state.leftRemote.hovered===this.el&&n&&this.changeVolumeBy(n);const a=t.isHeld(this.el);if(this.wasHeld&&!a&&(this.localSnapCount=0),this.wasHeld=a,this.hoverMenu&&this.hoverMenu.object3D.visible&&!this.videoIsLive&&this.timeLabel.setAttribute("text","value",`${lt(this.video.currentTime)} / ${lt(this.video.duration)}`),!this.data.videoPaused&&!1===this.videoIsLive&&this.networkedEl&&NAF.utils.isMine(this.networkedEl)){const e=performance.now();e-this.lastUpdate>this.data.tickRate&&(this.el.setAttribute("media-video","time",this.video.currentTime),this.lastUpdate=e)}},cleanUp(){this.mesh&&this.mesh.material&&(this.data.linkedVideoTexture||it(this.mesh.material.map))},remove(){this.cleanUp(),this._audioSyncInterval&&(clearInterval(this._audioSyncInterval),this._audioSyncInterval=null),this.audio&&(this.el.removeObject3D("sound"),this.audio.disconnect(),delete this.audio),this.networkedEl&&(this.networkedEl.removeEventListener("pinned",this.updateHoverMenu),this.networkedEl.removeEventListener("unpinned",this.updateHoverMenu)),window.APP.hubChannel.removeEventListener("permissions_updated",this.updateHoverMenu),this.video&&(this.video.removeEventListener("pause",this.onPauseStateChange),this.video.removeEventListener("play",this.onPauseStateChange)),this.hoverMenu&&(this.playPauseButton.object3D.removeEventListener("interact",this.togglePlaying),this.volumeUpButton.object3D.removeEventListener("interact",this.volumeUp),this.volumeDownButton.object3D.removeEventListener("interact",this.volumeDown),this.seekForwardButton.object3D.removeEventListener("interact",this.seekForward),this.seekBackButton.object3D.removeEventListener("interact",this.seekBack))}}),AFRAME.registerComponent("media-image",{schema:{src:{type:"string"},version:{type:"number"},projection:{type:"string",default:"flat"},contentType:{type:"string"},batch:{default:!1}},remove(){this.data.batch&&this.mesh&&this.el.sceneEl.systems["hubs-systems"].batchManagerSystem.removeObject(this.mesh),this.currentSrcIsRetained&&(nt.release(this.data.src,this.data.version),this.currentSrcIsRetained=!1)},update(e){var t=this;return We(function*(){let i,n=1;const a=t.el.sceneEl.systems["hubs-systems"].batchManagerSystem;try{const{src:a,version:s,contentType:o}=t.data;if(!a)return;let r;if(t.el.emit("image-loading"),t.mesh&&t.mesh.material.map&&(a!==e.src||s!==e.version)&&(t.mesh.material.map=null,t.mesh.material.needsUpdate=!0,t.mesh.material.map!==ot&&(nt.release(e.src,e.version),t.currentSrcIsRetained=!1)),nt.has(a,s))r=t.currentSrcIsRetained?nt.get(a,s):nt.retain(a,s);else{const e=nt.key(a,s);if("error"===a)r=rt;else if(at.has(e))yield at.get(e),r=nt.retain(a,s);else{let t;if(o.includes("image/gif"))t=function(e){return Je.apply(this,arguments)}(a);else{if(!o.startsWith("image/"))throw new Error(`Unknown image content type: ${o}`);t=Object(be.g)(a)}at.set(e,t),i=yield t,at.delete(e),r=nt.set(a,s,i)}if(t.data.src!==a||t.data.version!==s||!t.el.parentNode)return void nt.release(a,s)}i=r.texture,n=r.ratio,t.currentSrcIsRetained=!0}catch(e){console.error("Error loading image",t.data.src,e),i=ot,t.currentSrcIsRetained=!1}const s=t.data.projection;if(t.mesh&&t.data.batch&&a.removeObject(t.mesh),!t.mesh||s!==e.projection){const e=new THREE.MeshBasicMaterial;let n;if("360-equirectangular"===s){if((n=new THREE.SphereBufferGeometry(1,64,32)).scale(-1,1,1),!i.flipY){const e=n.attributes.uv.array;for(let t=1;t<e.length;t+=2)e[t]=1-e[t]}}else n=new THREE.PlaneBufferGeometry(1,1,1,1,i.flipY),e.side=THREE.DoubleSide;t.mesh=new THREE.Mesh(n,e),t.el.setObject3D("mesh",t.mesh)}t.mesh.material.transparent=!t.data.batch||i==ot||t.data.contentType.includes("image/gif"),t.mesh.material.map=i,t.mesh.material.needsUpdate=!0,"flat"===s&&tt(t.el,n),i!==ot&&t.data.batch&&a.addObject(t.mesh),t.el.emit("image-loaded",{src:t.data.src,projection:s})})()}}),AFRAME.registerComponent("media-pdf",{schema:{src:{type:"string"},projection:{type:"string",default:"flat"},contentType:{type:"string"},index:{default:0},batch:{default:!1}},init(){this.snap=this.snap.bind(this),this.canvas=document.createElement("canvas"),this.canvasContext=this.canvas.getContext("2d"),this.localSnapCount=0,this.isSnapping=!1,this.onSnapImageLoaded=()=>this.isSnapping=!1,this.texture=new THREE.CanvasTexture(this.canvas),this.texture.encoding=THREE.sRGBEncoding,this.texture.minFilter=THREE.LinearFilter,this.el.addEventListener("pager-snap-clicked",()=>this.snap())},snap(){var e=this;return We(function*(){if(e.isSnapping)return;e.isSnapping=!0,e.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(v.b);const t=yield new Promise(t=>e.canvas.toBlob(t)),i=new File([t],"snap.png",Ge);e.localSnapCount++;const{entity:n}=Object(be.a)(e.el,i,"photo-snapshot",e.localSnapCount,!1,1);n.addEventListener("image-loaded",e.onSnapImageLoaded,Ze)})()},remove(){this.data.batch&&this.mesh&&this.el.sceneEl.systems["hubs-systems"].batchManagerSystem.removeObject(this.mesh)},update(e){var t=this;return We(function*(){let i,n=1;try{const{src:a,index:s}=t.data;if(!a)return;if(t.renderTask&&(yield t.renderTask.promise,a!==t.data.src||s!==t.data.index))return;if(t.el.emit("pdf-loading"),a!==e.src){const e=t.data.src,i=yield ze.a.getDocument(a);if(e!==t.data.src)return;t.pdf=i,t.el.setAttribute("media-pager",{maxIndex:t.pdf.numPages-1})}const o=yield t.pdf.getPage(s+1);if(a!==t.data.src||s!==t.data.index)return;const r=o.getViewport({scale:3}),l=r.width,c=r.height;if(i=t.texture,n=c/l,t.canvas.width=l,t.canvas.height=c,t.renderTask=o.render({canvasContext:t.canvasContext,viewport:r}),yield t.renderTask.promise,t.renderTask=null,a!==t.data.src||s!==t.data.index)return;t.currentPageTextureIsRetained=!0}catch(e){console.error("Error loading PDF",t.data.src,e),i=ot}if(!t.mesh){const e=new THREE.MeshBasicMaterial,n=new THREE.PlaneBufferGeometry(1,1,1,1,i.flipY);e.side=THREE.DoubleSide,t.mesh=new THREE.Mesh(n,e),t.el.setObject3D("mesh",t.mesh)}t.mesh.material.transparent=i==ot,t.mesh.material.map=i,t.mesh.material.map.needsUpdate=!0,t.mesh.material.needsUpdate=!0,tt(t.el,n),i!==ot&&t.data.batch&&t.el.sceneEl.systems["hubs-systems"].batchManagerSystem.addObject(t.mesh),t.el.components["media-pager"]&&t.el.components["media-pager"].data.index!==t.data.index&&t.el.setAttribute("media-pager",{index:t.data.index}),t.el.emit("pdf-loaded",{src:t.data.src})})()}});const ct=1/(Qe.length/2),dt=7/(Qe.length/2);AFRAME.registerComponent("avatar-volume-controls",{schema:{volume:{type:"number",default:1}},init(){this.volumeUp=this.volumeUp.bind(this),this.volumeDown=this.volumeDown.bind(this),this.changeVolumeBy=this.changeVolumeBy.bind(this),this.volumeUpButton=this.el.querySelector(".avatar-volume-up-button"),this.volumeDownButton=this.el.querySelector(".avatar-volume-down-button"),this.volumeLabel=this.el.querySelector(".avatar-volume-label"),this.volumeUpButton.object3D.addEventListener("interact",this.volumeUp),this.volumeDownButton.object3D.addEventListener("interact",this.volumeDown),this.update=this.update.bind(this),window.APP.store.addEventListener("statechanged",this.update),this.updateVolumeLabel()},remove(){window.APP.store.removeEventListener("statechanged",this.update)},changeVolumeBy(e){this.el.setAttribute("avatar-volume-controls","volume",THREE.Math.clamp(this.data.volume+e,0,8)),this.updateVolumeLabel()},volumeUp(){const e=this.data.volume>1-ct?dt:ct;this.changeVolumeBy(e)},volumeDown(){const e=this.data.volume>1+ct?dt:ct;this.changeVolumeBy(-1*e)},update(){if(this.audio){const e=void 0!==window.APP.store.state.preferences.globalVoiceVolume?window.APP.store.state.preferences.globalVoiceVolume:100;this.audio.gain.gain.value=e/100*this.data.volume}},updateVolumeLabel(){const e=Math.min(Qe.length-1,this.data.volume<=1.001?Math.floor(this.data.volume/ct):Math.floor(Qe.length/2+(this.data.volume-1)/dt));this.volumeLabel.setAttribute("text","value",0===this.data.volume?"Muted":Qe[e])},tick(){if(this.audio)return;const e=this.el.parentNode.parentNode.querySelector("[networked-audio-source]");e&&(this.audio=e.components["networked-audio-source"].sound,this.update())}}),AFRAME.registerComponent("pinch-to-move",{schema:{speed:{default:.25}},init(){this.axis=[0,0]},tick(){const e=AFRAME.scenes[0].systems.userinput.get(ce.a.device.touchscreen.pinchDelta);e&&(this.axis[1]=e*this.data.speed,this.el.emit("move",{axis:this.axis}))}});const ht=function(){const e=new THREE.Quaternion,t=new THREE.Quaternion,i=new THREE.Quaternion,n=new THREE.Quaternion,a=new THREE.Quaternion,s=new THREE.Quaternion,o=new THREE.Vector3,r=new THREE.Vector3,l=new THREE.Vector3(0,1,0);return function(c,d,h){c.parent.updateMatrices(),c.updateMatrices(),c.parent.getWorldQuaternion(e),c.getWorldQuaternion(t),i.copy(c.quaternion),r.set(0,1,0).applyQuaternion(i);const u=r.dot(l);r.set(0,0,1).applyQuaternion(i);const p=Math.abs(r.dot(l));o.set(1,0,0).applyQuaternion(t),n.setFromAxisAngle(o,d),a.setFromAxisAngle(l,h),s.copy(t).premultiply(n).premultiply(a).premultiply(e.inverse()),r.set(0,1,0).applyQuaternion(s);const m=r.dot(l);r.set(0,0,1).applyQuaternion(s);const g=Math.abs(r.dot(l));g>.9&&g>p||m<0&&m<u||(c.quaternion.copy(s),c.matrixNeedsUpdate=!0,c.updateMatrices())}}();AFRAME.registerComponent("pitch-yaw-rotator",{init(){this.pendingXRotation=0,this.el.sceneEl.addEventListener("rotateX",e=>{this.pendingXRotation+=e.detail}),this.on=!0},tick(){if(this.on){const e=AFRAME.scenes[0],t=e.systems.userinput.get(e.is("entered")?ce.a.actions.cameraDelta:ce.a.actions.lobbyCameraDelta);t?ht(this.el.object3D,this.pendingXRotation+t[1],t[0]):this.pendingXRotation&&ht(this.el.object3D,this.pendingXRotation,0)}this.pendingXRotation=0}});var ut=i(72);function pt(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}const mt=Math.PI,gt=mt/2,ft=3*gt,vt=new THREE.Vector3(1,0,0),bt=new THREE.Vector3(0,0,1),yt=new THREE.Vector3(-1,0,0),_t=new THREE.Vector3(0,0,-1),wt=new THREE.Vector3(0,0,0),Et={left:{dir:yt,rotation:ft,halfExtent:"x"},right:{dir:vt,rotation:gt,halfExtent:"x"},forward:{dir:bt,rotation:0,halfExtent:"z"},back:{dir:_t,rotation:mt,halfExtent:"z"}};AFRAME.registerComponent("position-at-box-shape-border",{multiple:!0,schema:{target:{type:"string"},dirs:{default:["left","right","forward","back"]},animate:{default:!0},scale:{default:!0}},init(){this.cam=this.el.sceneEl.camera.el.object3D,this._updateBox=this._updateBox.bind(this),this._setupTarget=this._setupTarget.bind(this),this.halfExtents=new THREE.Vector3,this.el.sceneEl.systems["frame-scheduler"].schedule(this._updateBox,"media-components"),this._setupTarget()},remove(){this.el.sceneEl.systems["frame-scheduler"].unschedule(this._updateBox,"media-components")},update(){this.dirs=this.data.dirs.map(e=>Et[e])},_setupTarget(){var e,t=this;return(e=function*(){yield Object(ne.a)(),t.targetEl=t.el.querySelector(t.data.target),t.target=t.targetEl.object3D,t.targetEl.addEventListener("animationcomplete",()=>{t.targetEl.removeAttribute("animation__show")}),t.target.scale.setScalar(.01),t.target.matrixNeedsUpdate=!0},function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){pt(s,n,a,o,r,"next",e)}function r(e){pt(s,n,a,o,r,"throw",e)}o(void 0)})})()},tick(){if(!this.target)return;if(!this.el.getObject3D("mesh"))return;const e=this.targetEl.object3D.visible,t=e&&!this.wasVisible,i=this.el.object3D.scale.x!==this.previousScaleX||this.el.object3D.scale.y!==this.previousScaleY||this.el.object3D.scale.z!==this.previousScaleZ,n=this.targetEl.getAttribute("animation__show");(t||i&&n)&&this._updateBox(this.data.animate,!0),this.wasVisible=e,this.previousScaleX=this.el.object3D.scale.x,this.previousScaleY=this.el.object3D.scale.y,this.previousScaleZ=this.el.object3D.scale.z},_updateBox:function(){const e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3,s=new THREE.Vector3,o=new THREE.Vector3,r=new THREE.Vector3(.001,.001,.001);return function(l,c){if(c||this.mesh!==this.el.getObject3D("mesh")){this.mesh=this.el.getObject3D("mesh");const e=Object(ut.a)(this.el,this.mesh);this.halfExtents=e.min.clone().negate().add(e.max).multiplyScalar(.65),this.halfExtents.max(r)}if(!this.target)return;Object(Ae.h)(this.cam,e);let d=1/0,h=this.dirs[0].dir,u=this.dirs[0].halfExtent,p=this.halfExtents[u],m=this.dirs[0].rotation,g=-1.1;this.el.object3D.updateMatrices();for(let t=0;t<this.dirs.length;t++){const s=this.dirs[t].dir,r=this.dirs[t].halfExtent,l=this.halfExtents[r];i.copy(s).multiplyScalar(l),a.copy(wt),this.el.object3D.localToWorld(i),this.el.object3D.localToWorld(a),n.subVectors(e,i),n.normalize(),o.subVectors(i,a),o.normalize();const c=o.dot(n),f=i.distanceToSquared(e);c>g&&(d=f,h=s,p=l,m=this.dirs[t].rotation,u=r,g=c)}this.target.position.copy(t.copy(h).multiplyScalar(p)),this.target.rotation.set(0,m,0),s.setFromMatrixScale(this.target.parent.matrixWorld);const f=Math.sqrt(d),v=Math.max(this.halfExtents.x,this.halfExtents.z)*f,b=Math.min(this.el.sceneEl.systems["hubs-systems"].cameraSystem.mode===Ce.b?2:4,Math.max(.5,v*s.x)),y=this.data.scale?b/s.x:1;l?(this.targetEl.removeAttribute("animation__show"),this.targetEl.setAttribute("animation__show",{property:"scale",dur:300,from:{x:.8*y,y:.8*y,z:.8*y},to:{x:y,y:y,z:y},easing:"easeOutElastic"})):this.targetEl.getAttribute("animation__show")||this.target.scale.setScalar(y),this.target.matrixNeedsUpdate=!0}}()});i(1004);function xt(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function St(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){xt(s,n,a,o,r,"next",e)}function r(e){xt(s,n,a,o,r,"throw",e)}o(void 0)})}}function Ct(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function kt(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){Ct(s,n,a,o,r,"next",e)}function r(e){Ct(s,n,a,o,r,"throw",e)}o(void 0)})}}AFRAME.registerComponent("pin-networked-object-button",{schema:{tipSelector:{type:"string"},labelSelector:{type:"string"}},init(){this._updateUI=this._updateUI.bind(this),this._updateUIOnStateChange=this._updateUIOnStateChange.bind(this),this.el.sceneEl.addEventListener("stateadded",this._updateUIOnStateChange),this.el.sceneEl.addEventListener("stateremoved",this._updateUIOnStateChange),this.tipEl=this.el.parentNode.querySelector(this.data.tipSelector),this.labelEl=this.el.parentNode.querySelector(this.data.labelSelector),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e,this._updateUI(),this.targetEl.addEventListener("pinned",this._updateUI),this.targetEl.addEventListener("unpinned",this._updateUI)}),this.onHovered=()=>{this.hovering=!0,this._updateUI()},this.onUnhovered=()=>{this.hovering=!1,this._updateUI()},this.onClick=()=>{if(!NAF.utils.isMine(this.targetEl)&&!NAF.utils.takeOwnership(this.targetEl))return;const e=this.targetEl.components.pinnable&&this.targetEl.components.pinnable.data.pinned;this.targetEl.setAttribute("pinnable","pinned",!e),e||this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(v.m)}},play(){this.el.object3D.addEventListener("interact",this.onClick),this.el.object3D.addEventListener("hovered",this.onHovered),this.el.object3D.addEventListener("unhovered",this.onUnhovered)},pause(){this.el.object3D.removeEventListener("interact",this.onClick),this.el.object3D.removeEventListener("hovered",this.onHovered),this.el.object3D.removeEventListener("unhovered",this.onUnhovered)},remove(){this.el.sceneEl.removeEventListener("stateadded",this._updateUIOnStateChange),this.el.sceneEl.removeEventListener("stateremoved",this._updateUIOnStateChange),this.targetEl&&(this.targetEl.removeEventListener("pinned",this._updateUI),this.targetEl.removeEventListener("unpinned",this._updateUI))},_discordBridges:()=>window.APP.hubChannel.discordBridges(),_updateUIOnStateChange(e){"frozen"===e.detail&&this._updateUI()},_updateUI(){const{fileIsOwned:e,fileId:t}=this.targetEl.components["media-loader"].data,i=window.APP.hubChannel.can("pin_objects")&&!!(e||t&&Object(be.i)(t));this.el.object3D.visible=i,this.labelEl.object3D.visible=i;const n=this.targetEl.getAttribute("pinnable")&&this.targetEl.getAttribute("pinnable").pinned,s=this._discordBridges();this.tipEl.object3D.visible=!!(i&&!n&&this.hovering&&s.length>0),i&&(this.labelEl.setAttribute("text","value",n?"un-pin":"pin"),Object(a.a)(this.el,n))}}),AFRAME.registerComponent("mirror-media-button",{init(){var e=this;this.updateSrc=()=>{this.targetEl.parentNode&&(this.src=this.targetEl.components["media-loader"].data.src)},NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e,this.targetEl.addEventListener("media_resolved",this.updateSrc,{once:!0}),this.updateSrc()}),this.onClick=St(function*(){const t=document.querySelector("#media-mirror-target");yield Object(be.e)();const{entity:i}=Object(be.d)(e.targetEl,"#linked-media",e.src,!1,!0,t);i.object3D.scale.set(.75,.75,.75),i.object3D.matrixNeedsUpdate=!0,t.parentEl.components["follow-in-fov"].reset(),t.parentEl.object3D.visible=!0})},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}}),AFRAME.registerComponent("close-mirrored-media-button",{init(){var e=this;this.onClick=kt(function*(){e.el.object3D.visible=!1,yield Object(be.e)(),e.el.object3D.visible=!0})},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}});i(1005),i(1006),i(1007);AFRAME.registerComponent("unmute-video-button",{init(){this.onClick=()=>{const e=Object(Ee.a)(this.el,"media-video").components["media-video"];e&&e.video&&e.videoMutedAt&&(performance.now()-e.videoMutedAt<3e3||e.video.muted&&(e.video.muted=!1,this.el.setAttribute("visible",!1)))}},play(){document.addEventListener("touchstart",this.onClick)},pause(){document.removeEventListener("touchstart",this.onClick)}}),AFRAME.registerComponent("destroy-at-extreme-distances",{schema:{xMin:{default:-1e3},xMax:{default:1e3},yMin:{default:-1e3},yMax:{default:1e3},zMin:{default:-1e3},zMax:{default:1e3}},init(){this._checkForDestroy=this._checkForDestroy.bind(this),this.el.sceneEl.systems["frame-scheduler"].schedule(this._checkForDestroy,"media-components")},remove(){this.el.sceneEl.systems["frame-scheduler"].unschedule(this._checkForDestroy,"media-components")},_checkForDestroy:function(){const e=new THREE.Vector3;return function(){const{xMin:t,xMax:i,yMin:n,yMax:a,zMin:s,zMax:o}=this.data;Object(Ae.h)(this.el.object3D,e),(e.x<t||e.x>i||e.y<n||e.y>a||e.z<s||e.z>o)&&(this.el.components.networked&&!NAF.utils.isMine(this.el)||this.el.parentNode.removeChild(this.el))}}()});i(1008);var At=i(89),Tt=i(34),Mt=i(196),Lt=i(81),Rt=i(504),Pt=i.n(Rt),Dt=i(124);function Ot(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function Ht(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){Ot(s,n,a,o,r,"next",e)}function r(e){Ot(s,n,a,o,r,"throw",e)}o(void 0)})}}const jt=Object(ne.a)().then(()=>Object(Lt.b)(Pt.a)),It={"player-right-controller":{takeSnapshot:ce.a.actions.rightHand.takeSnapshot},"player-left-controller":{takeSnapshot:ce.a.actions.leftHand.takeSnapshot},"right-cursor":{takeSnapshot:ce.a.actions.cursor.right.takeSnapshot},"left-cursor":{takeSnapshot:ce.a.actions.cursor.left.takeSnapshot}},Nt=AFRAME.utils.device.isMobileVR(),Ft=["h264","vp9,opus","vp8,opus","vp9","vp8"].find(e=>window.MediaRecorder&&MediaRecorder.isTypeSupported(`video/webm; codecs=${e}`)),Vt=Ft?`video/webm; codecs=${Ft}`:null,Bt=!!document.createElement("canvas").getContext("webgl2"),zt=!!Vt&&Bt,Ut=Nt?640:1280,Wt=Nt?360:720,Zt=[3,7,15,30,60,1/0],Gt=document.createElement("canvas");function qt(){return(qt=Ht(function*(e,t,i){Gt.width=t,Gt.height=i;const n=Gt.getContext("2d"),a=n.createImageData(t,i);a.data.set(e);const s=yield Object(At.a)(a);n.scale(1,-1),n.drawImage(s,0,-i);const o=yield new Promise(e=>Gt.toBlob(e));return new File([o],"snap.png",{type:"image/png"})})).apply(this,arguments)}AFRAME.registerComponent("camera-tool",{schema:{captureDuration:{default:7},captureAudio:{default:!1},isSnapping:{default:!1},isRecording:{default:!1},label:{default:""}},init(){this.el.object3D.visible=!1,this.lastUpdate=performance.now(),this.localSnapCount=0,this.showCameraViewfinder=!Nt,this.renderTarget=new THREE.WebGLRenderTarget(1280,720,{format:THREE.RGBAFormat,minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,encoding:THREE.sRGBEncoding,depth:!1,stencil:!1}),this.camera=new THREE.PerspectiveCamera(50,1280/720,.1,3e4),this.camera.rotation.set(0,Math.PI,0),this.camera.position.set(0,0,.05),this.camera.matrixNeedsUpdate=!0,this.el.setObject3D("camera",this.camera);const e=new THREE.MeshBasicMaterial({map:this.renderTarget.texture});e.map.isVideoTexture=!0,e.map.update=()=>{this.showCameraViewfinder&&(this.viewfinderInViewThisFrame=!0)},this.el.sceneEl.addEventListener("stateadded",()=>this.updateUI()),this.el.sceneEl.addEventListener("stateremoved",()=>this.updateUI()),jt.then(t=>{const i=Object(Ae.e)(t.scene);i.scale.set(2,2,2),i.matrixNeedsUpdate=!0,this.el.setObject3D("mesh",i),this.el.object3D.visible=!0,this.el.object3D.scale.set(.5,.5,.5),this.el.object3D.matrixNeedsUpdate=!0;const n=this.el.object3D,a=function(){const e={};return function(t){const i=t.animatables[0].target;i.x=Math.max(Number.MIN_VALUE,i.x),i.y=Math.max(Number.MIN_VALUE,i.y),i.z=Math.max(Number.MIN_VALUE,i.z),i.x===e.x&&i.y===e.y&&i.z===e.z||(e.x=i.x,e.y=i.y,e.z=i.z,n.scale.set(i.x,i.y,i.z),n.matrixNeedsUpdate=!0)}}(),s={duration:200,easing:"easeOutQuad",elasticity:400,loop:0,round:!1,x:1,y:1,z:1,targets:[{x:.5,y:.5,z:.5}],update:e=>a(e),complete:e=>a(e)};Object(Dt.default)(s);const o=new THREE.PlaneBufferGeometry(.28,.28/this.camera.aspect),r=this.el.sceneEl.components["environment-map"];r&&r.applyEnvironmentMap(this.el.object3D),this.screen=new THREE.Mesh(o,e),this.screen.rotation.set(0,Math.PI,0),this.screen.position.set(0,0,-.042),this.screen.matrixNeedsUpdate=!0,this.el.setObject3D("screen",this.screen),this.selfieScreen=new THREE.Mesh(o,e),this.selfieScreen.position.set(0,.4,0),this.selfieScreen.scale.set(-2,2,2),this.selfieScreen.matrixNeedsUpdate=!0,this.el.setObject3D("selfieScreen",this.selfieScreen),this.label=this.el.querySelector(".label"),this.labelActionBackground=this.el.querySelector(".label-action-background"),this.labelBackground=this.el.querySelector(".label-background"),this.durationLabel=this.el.querySelector(".duration"),this.recordIcon=this.el.querySelector(".record-icon"),this.recordAlphaIcon=this.el.querySelector(".record-alpha-icon"),this.label.object3D.visible=!1,this.durationLabel.object3D.visible=!1,this.snapMenu=this.el.querySelector(".camera-snap-menu"),this.snapButton=this.el.querySelector(".snap-button"),this.recordButton=this.el.querySelector(".record-button"),this.cancelButton=this.el.querySelector(".cancel-button"),this.nextDurationButton=this.el.querySelector(".next-duration"),this.prevDurationButton=this.el.querySelector(".prev-duration"),this.snapButton.object3D.addEventListener("interact",()=>this.snapClicked(!0)),this.recordButton.object3D.addEventListener("interact",()=>this.snapClicked(!1)),this.cancelButton.object3D.addEventListener("interact",()=>this.cancelSnapping()),this.nextDurationButton.object3D.addEventListener("interact",()=>this.changeDuration(1)),this.prevDurationButton.object3D.addEventListener("interact",()=>this.changeDuration(-1)),this.stopButton=this.el.querySelector(".stop-button"),this.stopButton.object3D.addEventListener("interact",()=>this.stopRecording()),this.captureAudioButton=this.el.querySelector(".capture-audio"),this.captureAudioIcon=this.el.querySelector(".capture-audio-icon"),this.captureAudioButton.object3D.addEventListener("interact",()=>this.el.setAttribute("camera-tool","captureAudio",!this.data.captureAudio)),this.updateUI(),this.updateRenderTargetNextTick=!0,this.cameraSystem=this.el.sceneEl.systems["camera-tools"],this.cameraSystem.register(this.el),Object(ne.a)().then(()=>{this.playerCamera=document.getElementById("viewing-camera").getObject3D("camera")})})},remove(){this.cameraSystem.deregister(this.el),this.el.sceneEl.emit("camera_removed"),this.stopRecording()},updateViewfinder(){this.updateRenderTargetNextTick=!0},changeDuration(e){const t=Zt.findIndex(e=>this.data.captureDuration==e),i=0===t&&-1===e?Zt.length-1:(t+e)%Zt.length;this.el.setAttribute("camera-tool","captureDuration",Zt[i])},focus(e,t){this.trackTarget=t?e:null,this.lookAt(e)},lookAt:function(){const e=new THREE.Vector3;return function(t){e.setFromMatrixPosition(t.object3D.matrixWorld),this.el.object3D.lookAt(e),this.el.object3D.matrixNeedsUpdate=!0}}(),snapClicked(e){var t=this;this.data.isSnapping||(NAF.utils.isMine(this.el)||NAF.utils.takeOwnership(this.el))&&(this.el.setAttribute("camera-tool","isSnapping",!0),this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(v.a),this.snapCountdown=3,this.el.setAttribute("camera-tool","label",`${this.snapCountdown}`),this.countdownInterval=setInterval(Ht(function*(){if(!NAF.utils.isMine(t.el)&&!NAF.utils.takeOwnership(t.el))return clearInterval(t.countdownInterval),void(t.countdownInterval=null);t.snapCountdown--,0===t.snapCountdown?(clearInterval(t.countdownInterval),t.countdownInterval=null,e?(t.el.setAttribute("camera-tool",{label:"",isSnapping:!1}),t.takeSnapshotNextTick=!0):t.beginRecording(t.data.captureDuration)):(t.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(v.a),t.el.setAttribute("camera-tool","label",`${t.snapCountdown}`))}),1e3))},cancelSnapping(){clearInterval(this.countdownInterval),this.stopRecording(!0),this.updateUI()},update(){this.updateUI()},updateUI(){if(!this.label)return;const e=this.data.label,t=this.el.sceneEl.is("frozen"),i=this.data.captureDuration!==1/0,n=!i&&this.data.isRecording&&this.videoRecorder;this.label.object3D.visible=!!e&&!n;const a=this.label.object3D.visible&&this.data.isRecording&&!n;e&&this.label.setAttribute("text",{value:e,color:a?"#fafafa":"#ff3464"}),this.labelActionBackground.object3D.visible=a,this.labelBackground.object3D.visible=this.label.object3D.visible&&!a,this.stopButton.object3D.visible=n,i&&this.durationLabel.setAttribute("text","value",`${this.data.captureDuration}`),this.durationLabel.object3D.visible=i&&!this.data.isSnapping&&!t&&zt,this.recordIcon.object3D.visible=!i&&!t&&zt,this.recordAlphaIcon.object3D.visible=i&&!t&&zt,this.snapButton.object3D.visible=!this.data.isSnapping&&!t,this.recordButton.object3D.visible=!this.data.isSnapping&&!t&&zt,this.cancelButton.object3D.visible=this.data.isSnapping&&!t,this.prevDurationButton.object3D.visible=this.nextDurationButton.object3D.visible=!this.data.isSnapping&&zt&&!t&&zt,this.captureAudioIcon.setAttribute("icon-button","active",this.data.captureAudio)},beginRecording(e){var t=this;return Ht(function*(){t.videoContext||(t.videoCanvas=document.createElement("canvas"),t.videoCanvas.width=Ut,t.videoCanvas.height=Wt,t.videoContext=t.videoCanvas.getContext("2d"),t.videoImageData=t.videoContext.createImageData(Ut,Wt),t.videoPixels=new Uint8Array(Ut*Wt*4),t.videoImageData.data.set(t.videoPixels));const i=new MediaStream,n=t.videoCanvas.captureStream(25).getVideoTracks()[0],a=()=>{const e=THREE.AudioContext.getContext(),t=e.createOscillator(),n=e.createGain(),a=e.createMediaStreamDestination();n.gain.setValueAtTime(1e-4,e.currentTime),t.connect(a),n.connect(a),i.addTrack(a.stream.getAudioTracks()[0])};if(t.data.captureAudio){const e=yield NAF.connection.adapter.getMediaStream(NAF.clientId,"audio");if(e&&e.getAudioTracks().length>0){const n=THREE.AudioContext.getContext(),a=n.createMediaStreamDestination(),s=t.el.sceneEl.audioListener;s&&s.getInput().connect(a),n.createMediaStreamSource(e).connect(a);const o=a.stream.getAudioTracks()[0];i.addTrack(o)}else a()}else a();i.addTrack(n),t.videoRecorder=new MediaRecorder(i,{mimeType:Vt});const s=[],o=performance.now();t.videoRecorder.ondataavailable=e=>s.push(e.data),t.updateRenderTargetNextTick=!0,t.videoRecorder.start(),t.el.setAttribute("camera-tool",{isRecording:!0,label:" "}),t.el.sceneEl.emit("action_camera_recording_started"),e!==1/0&&(t.videoCountdown=t.data.captureDuration,t.el.setAttribute("camera-tool","label",`${t.videoCountdown}`),t.videoCountdownInterval=setInterval(()=>{t.videoCountdown--,0===t.videoCountdown?(t.stopRecording(),t.videoCountdownInterval=null):t.el.setAttribute("camera-tool","label",`${t.videoCountdown}`)},1e3)),t.videoRecorder._free=()=>s.length=0,t.videoRecorder.onstop=Ht(function*(){if(t.el.sceneEl.emit("action_camera_recording_ended"),0===s.length)return;const e=s[0].type,i=performance.now()-o,n=new Blob(s,{type:e});s.length=0;const{entity:a,orientation:r}=Object(be.a)(t.el,new File([n],"capture",{type:e.split(";")[0]}),"video-camera",t.localSnapCount,!!t.playerIsBehindCamera);a.addEventListener("video-loaded",()=>{(t.data.captureAudio||i<=31e3)&&setTimeout(()=>{(NAF.utils.isMine(a)||NAF.utils.takeOwnership(a))&&a.components["media-video"].tryUpdateVideoPlaybackState(!0)},t.data.captureAudio?0:3*i+100)},{once:!0}),t.localSnapCount++,r.then(()=>t.el.sceneEl.emit("object_spawned",{objectType:Tt.b.CAMERA}))})})()},stopRecording(e){this.videoRecorder&&(e&&(this.videoRecorder.onstop=()=>{},this.videoRecorder._free()),this.videoRecorder.stop(),this.videoRecorder=null,e||this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(v.b)),clearInterval(this.videoCountdownInterval),this.videoCountdownInterval=null,this.el.setAttribute("camera-tool","label",""),this.el.setAttribute("camera-tool",{isRecording:!1,isSnapping:!1})},tick(){const e=AFRAME.scenes[0].systems.interaction,t=AFRAME.scenes[0].systems.userinput,i=e.state.leftHand.held===this.el,n=e.state.rightHand.held===this.el,a=e.state.rightRemote.held===this.el,s=i&&t.get(e.options.leftHand.grabPath)||n&&t.get(e.options.rightHand.grabPath)||a&&t.get(e.options.rightRemote.grabPath),o=i||n||a;this.updateSnapMenuOrientation(),s&&(this.localSnapCount=0),this.showCameraViewfinder=o||!Nt||this.data.isSnapping||this.videoRecorder,this.screen&&this.selfieScreen&&(this.screen.visible=this.selfieScreen.visible=!!this.showCameraViewfinder),(o||this.data.isSnapping||this.videoRecorder)&&performance.now()-this.lastUpdate>=1e3/(this.videoRecorder?25:6)&&(this.updateRenderTargetNextTick=!0);const r=this.isHoldingSnapshotTrigger();window.APP.hubChannel.can("spawn_camera")&&(!r||this.data.isSnapping||this.snapTriggerTimeout?r||this.data.isSnapping||!this.snapTriggerTimeout||(clearTimeout(this.snapTriggerTimeout),this.snapTriggerTimeout=null,this.takeSnapshotNextTick=!0):this.snapTriggerTimeout=setTimeout(()=>{if(this.isHoldingSnapshotTrigger()){this.el.setAttribute("camera-tool","isSnapping",!0),this.beginRecording(1/0);const e=setInterval(()=>{this.isHoldingSnapshotTrigger()||(this.stopRecording(),clearInterval(e))},500)}this.snapTriggerTimeout=null},500))},tock:function(){const e=this.el.sceneEl,t=this.renderer||e.renderer,i=performance.now(),n=this.cameraSystem.playerHead;if(this.trackTarget&&(this.trackTarget.parentNode?this.lookAt(this.trackTarget):this.trackTarget=null),!this.playerHud){const e=document.getElementById("player-hud");this.playerHud=e&&e.object3D}if(this.takeSnapshotNextTick||this.updateRenderTargetNextTick&&(this.viewfinderInViewThisFrame||this.videoRecorder)){if(n){let e=1;const t=this.el.sceneEl.systems["local-audio-analyser"];t&&n.el.components["scale-audio-feedback"]&&(e=Object(Mt.a)(this.el.object3D,n,1,2,t.volume)),n.visible=!0,n.scale.set(e,e,e),n.updateMatrices(!0,!0),n.updateMatrixWorld(!0,!0)}let a=!1;if(this.playerHud&&(a=this.playerHud.visible,this.playerHud.visible=!1,this.el.sceneEl.systems["hubs-systems"]))for(const e of Object.values(this.el.sceneEl.systems["hubs-systems"].spriteSystem.meshes))e.visible=!1;const s=this.el.sceneEl.systems["personal-space-bubble"];if(s)for(let e=0,t=s.invaders.length;e<t;e++)s.invaders[e].disable();const o=t.vr.enabled,r=e.object3D.onAfterRender;if(delete e.object3D.onAfterRender,t.vr.enabled=!1,zt&&this.videoRecorder&&!this.videoRenderTarget&&(this.videoRenderTarget=new THREE.WebGLRenderTarget(Ut,Wt,{format:THREE.RGBAFormat,minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,encoding:THREE.sRGBEncoding,depth:!1,stencil:!1}),t.setRenderTarget(this.videoRenderTarget)),t.setRenderTarget(this.renderTarget),t.render(e.object3D,this.camera),t.setRenderTarget(null),t.vr.enabled=o,e.object3D.onAfterRender=r,n&&(n.visible=!1,n.scale.set(1e-8,1e-8,1e-8),n.updateMatrices(!0,!0),n.updateMatrixWorld(!0,!0)),this.playerHud&&(this.playerHud.visible=a,this.el.sceneEl.systems["hubs-systems"]))for(const e of Object.values(this.el.sceneEl.systems["hubs-systems"].spriteSystem.meshes))e.visible=!0;if(s)for(let e=0,t=s.invaders.length;e<t;e++)s.invaders[e].enable();this.lastUpdate=i,this.videoRecorder&&(function(e,t,i,n,a,s,o,r,l,c,d){const h=e.context,u=e.properties.get(t).__webglFramebuffer,p=e.properties.get(o).__webglFramebuffer;u&&p&&(h.bindFramebuffer(h.READ_FRAMEBUFFER,u),h.bindFramebuffer(h.DRAW_FRAMEBUFFER,p),h.checkFramebufferStatus(h.READ_FRAMEBUFFER)===h.FRAMEBUFFER_COMPLETE&&h.blitFramebuffer(i,n,a,s,r,l,c,d,h.COLOR_BUFFER_BIT,h.LINEAR))}(t,this.renderTarget,0,0,1280,720,this.videoRenderTarget,0,Wt,Ut,0),t.readRenderTargetPixels(this.videoRenderTarget,0,0,Ut,Wt,this.videoPixels),this.videoImageData.data.set(this.videoPixels),this.videoContext.putImageData(this.videoImageData,0,0)),this.updateRenderTargetNextTick=!1,this.viewfinderInViewThisFrame=!1}this.takeSnapshotNextTick&&(this.snapPixels||(this.snapPixels=new Uint8Array(3686400)),t.readRenderTargetPixels(this.renderTarget,0,0,1280,720,this.snapPixels),function(e,t,i){return qt.apply(this,arguments)}(this.snapPixels,1280,720).then(e=>{const{orientation:t}=Object(be.a)(this.el,e,"photo-camera",this.localSnapCount,!!this.playerIsBehindCamera);t.then(()=>{this.el.sceneEl.emit("object_spawned",{objectType:Tt.b.CAMERA})})}),e.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(v.b),this.takeSnapshotNextTick=!1,this.localSnapCount++)},isHoldingSnapshotTrigger:function(){const e=AFRAME.scenes[0].systems.interaction,t=AFRAME.scenes[0].systems.userinput,i=e.state.leftHand.held===this.el,n=e.state.rightHand.held===this.el,a=e.state.rightRemote.held===this.el,s=e.state.leftRemote.held===this.el;let o;if(n?o="player-right-controller":i?o="player-left-controller":a?o="right-cursor":s&&(o="left-cursor"),o){const e=It[o];if(t.get(e.takeSnapshot))return!0}return!!t.get(ce.a.actions.takeSnapshot)},updateSnapMenuOrientation:function(){const e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3;return function(){if(!this.playerCamera)return;this.el.object3D.getWorldPosition(t),this.playerCamera.getWorldPosition(e),i.subVectors(e,t),n.set(0,0,1),this.el.object3D.localToWorld(n),a.subVectors(n,t),a.normalize(),i.normalize();const s=a.dot(i)<0;this.playerIsBehindCamera!==s&&(this.playerIsBehindCamera=s,this.snapMenu.object3D.rotation.set(0,this.playerIsBehindCamera?Math.PI:0,0),this.snapMenu.object3D.matrixNeedsUpdate=!0)}}()});i(1009),i(1010),i(1011),i(1012),i(1013),i(1014);AFRAME.registerComponent("clone-media-button",{init(){this.updateSrc=()=>{if(!this.targetEl.parentNode)return;const e=this.src=this.targetEl.components["media-loader"].data.src,t=e&&"video/vnd.hubs-webrtc"!==Object(Ne.c)(e);this.el.object3D.visible=!!t},NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e,this.targetEl.addEventListener("media_resolved",this.updateSrc,{once:!0}),this.updateSrc()}),this.onClick=()=>{const{entity:e}=Object(be.d)(this.targetEl,"#interactable-media",this.src);e.object3D.scale.copy(this.targetEl.object3D.scale),e.object3D.matrixNeedsUpdate=!0,e.setAttribute("offset-relative-to",{target:"#avatar-pov-node",offset:{x:0,y:0,z:-1.5*this.targetEl.object3D.scale.z}})}},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}});var $t=i(77),Yt=i(57),Xt=i.n(Yt);function Qt(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function Kt(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){Qt(s,n,a,o,r,"next",e)}function r(e){Qt(s,n,a,o,r,"throw",e)}o(void 0)})}}let Jt=!1,ei=null;const ti=AFRAME.utils.device.isMobileVR(),ii=()=>new Promise(e=>{const t=document.querySelector("a-scene");t.addEventListener("2d-interstitial-gesture-complete",e,{once:!0}),t.emit("2d-interstitial-gesture-required")});function ni(e,t,i){return ai.apply(this,arguments)}function ai(){return(ai=Kt(function*(e,t,i){const n=document.querySelector("a-scene");if(n.is("vr-mode"))if(Jt=!0,ei=t,ti)yield n.exitVR(),i||(yield ii(),yield Object($t.a)());else{const t=document.querySelector(".vr-notice");t.object3D.visible=!0,t.setAttribute("follow-in-fov",{angle:e?39:-15})}else ti&&Object($t.c)()&&(yield ii(),yield Object($t.a)())})).apply(this,arguments)}function si(e){return oi.apply(this,arguments)}function oi(){return(oi=Kt(function*(e){if(!e&&!Jt)return;Jt=!1,document.querySelector(".vr-notice").object3D.visible=!1;const t=document.querySelector("a-scene");ti?Xt.a.isFullscreen?(yield Xt.a.exit(),yield ii(),yield t.enterVR()):yield t.enterVR():t.is("vr-mode")||(yield t.enterVR())})).apply(this,arguments)}function ri(){return Jt}function li(){return(li=Kt(function*(){Jt&&(ei&&(ei(),ei=null),yield si())})).apply(this,arguments)}function ci(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function di(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){ci(s,n,a,o,r,"next",e)}function r(e){ci(s,n,a,o,r,"throw",e)}o(void 0)})}}function hi(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function ui(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){hi(s,n,a,o,r,"next",e)}function r(e){hi(s,n,a,o,r,"throw",e)}o(void 0)})}}function pi(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function mi(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){pi(s,n,a,o,r,"next",e)}function r(e){pi(s,n,a,o,r,"throw",e)}o(void 0)})}}AFRAME.registerComponent("open-media-button",{schema:{onlyOpenLink:{type:"boolean"}},init(){var e=this;this.label=this.el.querySelector("[text]"),this.updateSrc=di(function*(){if(!e.targetEl.parentNode)return;const t=e.src=e.targetEl.components["media-loader"].data.src,i=t&&"video/vnd.hubs-webrtc"!==Object(Ne.c)(t),n=e.el.sceneEl.systems.permissions.canOrWillIfCreator("update_hub");if(e.el.object3D.visible=!!i,i){let i="open link";e.data.onlyOpenLink||((yield Object(Ne.f)(t))?i="use avatar":(yield Object(Ne.g)(t))&&n?i="use scene":(yield Object(Ne.e)(t))&&(i="visit room")),e.label.setAttribute("text","value",i)}}),this.onClick=di(function*(){const t=e.el.sceneEl.systems.permissions.canOrWillIfCreator("update_hub"),i=function(){var e=di(function*(){return yield ni(!1,()=>{},!0)});return function(){return e.apply(this,arguments)}}();if(e.data.onlyOpenLink)yield i(),window.open(e.src);else if(yield Object(Ne.f)(e.src)){const t=new URL(e.src).pathname.split("/").pop();window.APP.store.update({profile:{avatarId:t}}),e.el.sceneEl.emit("avatar_updated")}else(yield Object(Ne.g)(e.src))&&t?e.el.sceneEl.emit("scene_media_selected",e.src):(yield Object(Ne.e)(e.src))?(yield i(),location.href=e.src):(yield i(),window.open(e.src))}),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e,this.targetEl.addEventListener("media_resolved",this.updateSrc,{once:!0}),this.updateSrc()})},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}}),AFRAME.registerComponent("refresh-media-button",{init(){var e=this;this.updateVisibility=this.updateVisibility.bind(this),this.onClick=ui(function*(){const t=e.el.sceneEl.systems["hubs-systems"].soundEffectsSystem;if(e.targetEl){e.targetEl.components["media-loader"].refresh(),e.el.object3D.visible=!1;const i=t.playPositionalSoundFollowing(v.h,e.targetEl.object3D,!0);e.targetEl.addEventListener("media_refreshed",()=>{t.stopPositionalAudio(i),e.el.object3D.visible=!0,e.updateVisibility()},{once:!0})}}),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e,window.APP.hubChannel.addEventListener("permissions_updated",this.updateVisibility),this.targetEl&&(this.targetEl.addEventListener("pinned",this.updateVisibility),this.targetEl.addEventListener("unpinned",this.updateVisibility)),this.updateVisibility()})},updateVisibility(){if(!this.targetEl)return;const e=this.targetEl.components.pinnable&&this.targetEl.components.pinnable.data.pinned;this.el.object3D.visible=!e&&window.APP.hubChannel.can("spawn_and_move_media")||window.APP.hubChannel.can("pin_objects")},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)},remove(){window.APP.hubChannel.removeEventListener("permissions_updated",this.updateVisibility),this.targetEl&&(this.targetEl.removeEventListener("pinned",this.updateVisibility),this.targetEl.removeEventListener("unpinned",this.updateVisibility))}}),AFRAME.registerComponent("tweet-media-button",{init(){NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e}).catch(()=>{this.el.object3D.visible=!1}),this.onClick=()=>{const e=window.APP.hubChannel&&window.APP.hubChannel.discordBridges().length>0?`Taken in ${location.hostname} `:`Taken in ${location.hostname} - `+`join me now at ${n.a.SHORTLINK_DOMAIN}/${window.APP.hubChannel.hubId}! `,{src:t,contentSubtype:i}=this.targetEl.components["media-loader"].data;this.el.sceneEl.emit("action_media_tweet",{url:t,contentSubtype:i,text:e,el:this.targetEl})}},play(){n.a.AVAILABLE_INTEGRATIONS.twitter?this.el.object3D.addEventListener("interact",this.onClick):this.el.object3D.visible=!1},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}});AFRAME.registerComponent("remix-avatar-button",{init(){var e=this;this.label=this.el.querySelector("[text]"),this.label.setAttribute("text","value","copy avatar"),this.updateSrc=mi(function*(){e.src=e.targetEl.components["media-loader"].data.src;try{e.avatar=yield Object(ye.d)(Object(Ne.d)(e.src)),e.el.object3D.visible=e.avatar&&e.avatar.allow_remixing&&"avatar_listing"===e.avatar.type}catch(t){console.error(t),e.el.object3D.visible=!1}}),this.onClick=mi(function*(){if(!e.copying&&e.avatar){try{e.copying=!0,e.label.setAttribute("text","value","Copying..."),yield Object(ye.h)(e.avatar.avatar_id,e.avatar.name),e.label.setAttribute("text","value","Copied!")}catch(t){e.label.setAttribute("text","value","Error")}setTimeout(()=>{e.label.setAttribute("text","value","copy avatar"),e.copying=!1},2e3)}}),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e,this.targetEl.addEventListener("media_resolved",this.updateSrc,{once:!0}),this.updateSrc()})},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}});const gi={type:"kinematic",collisionFilterMask:i(111).COLLISION_LAYERS.HANDS},fi={AXIS:"axis",PUPPET:"puppet",CURSOR:"cursor",ALIGN:"align",SCALE:"scale"},vi=Math.PI/10,bi=new THREE.Quaternion,yi=new THREE.Vector3,_i=new THREE.Quaternion,wi=new THREE.Vector3,Ei=new THREE.Vector3,xi=new THREE.Quaternion,Si=new THREE.Quaternion,Ci=.001;AFRAME.registerComponent("transform-button",{schema:{mode:{type:"string",oneof:Object.values(fi),default:fi.CURSOR},axis:{type:"vec3",default:null}},init(){let e,t;NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e}),Object(ne.a)().then(()=>{e=document.getElementById("player-left-controller"),t=document.getElementById("player-right-controller")}),this.onGrabStart=i=>{e&&t&&this.targetEl&&(NAF.utils.isMine(this.targetEl)||NAF.utils.takeOwnership(this.targetEl))&&(this.targetEl.body&&this.targetEl.setAttribute("body-helper",gi),this.transformSystem=this.transformSystem||AFRAME.scenes[0].systems["transform-selected-object"],this.transformSystem.startTransform(this.targetEl.object3D,"right-cursor"===i.object3D.el.id?t.object3D:"left-cursor"===i.object3D.el.id?e.object3D:i.object3D,this.data))},this.onGrabEnd=()=>{this.transformSystem=this.transformSystem||AFRAME.scenes[0].systems["transform-selected-object"],this.transformSystem.stopTransform()}},play(){this.el.object3D.addEventListener("interact",this.onGrabStart),this.el.object3D.addEventListener("holdable-button-down",this.onGrabStart),this.el.object3D.addEventListener("holdable-button-up",this.onGrabEnd)},pause(){this.el.object3D.removeEventListener("interact",this.onGrabStart),this.el.object3D.removeEventListener("holdable-button-down",this.onGrabStart),this.el.object3D.removeEventListener("holdable-button-up",this.onGrabEnd)}}),AFRAME.registerSystem("transform-selected-object",{init(){this.target=null,this.mode=null,this.transforming=!1,this.axis=new THREE.Vector3,this.store=window.APP.store,this.startQ=new THREE.Quaternion,this.dxStore=0,this.dxApplied=0,this.dyAll=0,this.dyStore=0,this.dyApplied=0,this.raycasters={},this.puppet={initialControllerOrientation:new THREE.Quaternion,initialControllerOrientation_inverse:new THREE.Quaternion,initialObjectOrientation:new THREE.Quaternion,currentControllerOrientation:new THREE.Quaternion,controllerOrientationDelta:new THREE.Quaternion},this.planarInfo={plane:new THREE.Mesh(new THREE.PlaneBufferGeometry(1e5,1e5,2,2),new THREE.MeshBasicMaterial({visible:!1,wireframe:!0,side:THREE.DoubleSide,transparent:!0,opacity:.3})),normal:new THREE.Vector3,intersections:[],previousPointOnPlane:new THREE.Vector3,currentPointOnPlane:new THREE.Vector3,deltaOnPlane:new THREE.Vector3,finalProjectedVec:new THREE.Vector3},this.el.object3D.add(this.planarInfo.plane)},stopTransform:function(){const e=new THREE.Quaternion,t=new THREE.Quaternion(0,1,0,0),i=new THREE.Quaternion;return function(){var n,a;this.transforming=!1,this.mode===fi.CURSOR&&(this.target.getWorldQuaternion(e),n=e,a=this.startQ,Math.abs(n.x-a.x)<Ci&&Math.abs(n.y-a.y)<Ci&&Math.abs(n.z-a.z)<Ci&&Math.abs(n.w-a.w)<Ci&&(e.multiply(t),this.target.parent.getWorldQuaternion(i),i.inverse(),this.target.quaternion.copy(i).multiply(e),this.target.matrixNeedsUpdate=!0))}}(),startPlaneCasting(){const{plane:e,intersections:t,previousPointOnPlane:i}=this.planarInfo;this.el.camera.getWorldQuaternion(bi),e.quaternion.copy(bi),this.target.getWorldPosition(e.position),e.matrixNeedsUpdate=!0,e.updateMatrixWorld(!0),t.length=0,this.raycasters.right=this.raycasters.right||document.getElementById("right-cursor-controller").components["cursor-controller"].raycaster,this.raycasters.left=this.raycasters.left||document.getElementById("left-cursor-controller").components["cursor-controller"].raycaster;const n="player-left-controller"===this.hand.el.id?this.raycasters.left:this.raycasters.right,a=n.far;n.far=1e3,e.raycast(n,t),n.far=a,this.transforming=!!t[0],this.transforming&&(i.copy(t[0].point),this.target.getWorldQuaternion(_i),wi.set(0,0,-1).applyQuaternion(bi),Ei.set(0,0,-1).applyQuaternion(_i),this.sign=wi.dot(Ei)>0?1:-1,wi.set(0,1,0),Ei.set(0,1,0).applyQuaternion(_i),this.sign2=wi.dot(Ei)>0?1:-1,this.dyAll=0,this.dyStore=0,this.dyApplied=0,this.dxAll=0,this.dxStore=0,this.dxApplied=0)},startTransform(e,t,i){if(this.target=e,this.hand=t,this.mode=i.mode,this.transforming=!0,this.mode!==fi.ALIGN){if(this.store.update({activity:{hasRotated:!0}}),this.mode===fi.CURSOR&&this.target.getWorldQuaternion(this.startQ),this.mode===fi.PUPPET)return this.target.getWorldQuaternion(this.puppet.initialObjectOrientation),this.hand.getWorldQuaternion(this.puppet.initialControllerOrientation),void this.puppet.initialControllerOrientation_inverse.copy(this.puppet.initialControllerOrientation).inverse();this.mode===fi.AXIS&&this.axis.copy(i.axis),this.startPlaneCasting()}else this.store.update({activity:{hasRecentered:!0}})},puppetingTick(){const{currentControllerOrientation:e,controllerOrientationDelta:t,initialControllerOrientation_inverse:i,initialObjectOrientation:n}=this.puppet;this.hand.getWorldQuaternion(e),t.copy(i).premultiply(e),this.target.quaternion.copy(n).premultiply(t).premultiply(t),this.target.matrixNeedsUpdate=!0},cursorAxisOrScaleTick(){const{plane:e,normal:t,intersections:i,previousPointOnPlane:n,currentPointOnPlane:a,deltaOnPlane:s,finalProjectedVec:o}=this.planarInfo;this.target.getWorldPosition(e.position),this.el.camera.getWorldPosition(wi),e.matrixNeedsUpdate=!0;const r=wi.sub(e.position).length();i.length=0;const l="player-left-controller"===this.hand.el.id?this.raycasters.left:this.raycasters.right,c=l.far;l.far=1e3,e.raycast(l,i),l.far=c;const d=i[0];if(!d)return;t.set(0,0,-1).applyQuaternion(e.quaternion),a.copy(d.point),s.copy(a).sub(n);if(o.copy(s).projectOnPlane(t).applyQuaternion(xi.copy(e.quaternion).inverse()).multiplyScalar(10/r),this.mode===fi.CURSOR){const e=AFRAME.scenes[0].systems.userinput.get(ce.a.actions.transformModifier);this.dyAll=this.dyStore+o.y,this.dyApplied=e?this.dyAll:Math.round(this.dyAll/vi)*vi,this.dyStore=this.dyAll-this.dyApplied,this.dxAll=this.dxStore+o.x,this.dxApplied=e?this.dxAll:Math.round(this.dxAll/vi)*vi,this.dxStore=this.dxAll-this.dxApplied,this.mode===fi.CURSOR&&(this.target.getWorldQuaternion(_i),wi.set(1,0,0).applyQuaternion(e?bi:_i),xi.setFromAxisAngle(wi,e?-this.dyApplied:this.sign2*this.sign*-this.dyApplied),e?wi.set(0,1,0).applyQuaternion(bi):wi.set(0,1,0),Si.setFromAxisAngle(wi,this.dxApplied),this.target.quaternion.premultiply(xi).premultiply(Si)),this.target.matrixNeedsUpdate=!0}else this.mode===fi.AXIS&&(this.dxAll=this.dxStore+o.x,this.dxApplied=Math.round(this.dxAll/vi)*vi,this.dxStore=this.dxAll-this.dxApplied,this.target.quaternion.multiply(xi.setFromAxisAngle(this.axis,-this.sign*this.dxApplied)),this.target.matrixNeedsUpdate=!0);n.copy(a)},tick(){if(this.transforming&&this.mode!==fi.SCALE)return this.mode===fi.ALIGN?(this.el.camera.getWorldPosition(yi),this.target.lookAt(yi),void(this.transforming=!1)):void(this.mode!==fi.PUPPET?this.cursorAxisOrScaleTick():this.puppetingTick())}}),AFRAME.registerComponent("transform-button-selector",{tick(){this.userinput=this.userinput||this.el.sceneEl.systems.userinput,this.userinput.get(ce.a.actions.rightHand.pose)||this.userinput.get(ce.a.actions.leftHand.pose)?this.el.components["transform-button"].data.mode!==fi.PUPPET&&this.el.setAttribute("transform-button","mode",fi.PUPPET):this.el.components["transform-button"].data.mode!==fi.CURSOR&&this.el.setAttribute("transform-button","mode",fi.CURSOR)}});const ki=new THREE.Vector3(0,0,1),Ai=2*Math.PI;AFRAME.registerComponent("visible-if-transforming",{schema:{hand:{type:"string"}},init(){},tick(e){const t=AFRAME.scenes[0].systems["transform-selected-object"].transforming&&-1!==AFRAME.scenes[0].systems["transform-selected-object"].hand.el.id.indexOf(this.data.hand);this.el.getAttribute("visible")!==t&&this.el.setAttribute("visible",AFRAME.scenes[0].systems["transform-selected-object"].transforming),t&&(this.el.object3D.quaternion.setFromAxisAngle(ki,Ai*Math.sin(e/1e3)),this.el.object3D.matrixNeedsUpdate=!0)}});const Ti=function(){const e=new THREE.Matrix4,t=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3,s=new THREE.Vector3;return function(o,r){return o.updateMatrices(),s.setFromMatrixPosition(o.matrixWorld),r.updateMatrices(),a.setFromMatrixPosition(r.matrixWorld),i.subVectors(a,s),i.y=0,i.normalize(),t.set(0,1,0),n.crossVectors(i,t),e.makeBasis(n,t,i.multiplyScalar(-1)),e.elements[12]=a.x,e.elements[13]=a.y,e.elements[14]=a.z,e}}(),Mi=new THREE.Mesh(new THREE.PlaneBufferGeometry(1e5,1e5,2,2),new THREE.MeshBasicMaterial({visible:!0,wireframe:!1,side:THREE.DoubleSide,transparent:!0,opacity:.3})),Li=new THREE.Mesh(new THREE.PlaneBufferGeometry(1e5,1e5,2,2),new THREE.MeshBasicMaterial({visible:!0,wireframe:!1,side:THREE.DoubleSide,transparent:!0,opacity:.3}));AFRAME.registerComponent("scale-button",{init(){this.isScaling=!1,this.planeRotation=new THREE.Matrix4,this.planeUp=new THREE.Vector3,this.planeRight=new THREE.Vector3,this.intersections=[],this.initialIntersectionPoint=new THREE.Vector3,this.intersectionPoint=new THREE.Vector3,this.initialObjectScale=new THREE.Vector3,this.desiredObjectScale=new THREE.Vector3,this.deltaScale=new THREE.Vector3,this.objectMatrix=new THREE.Matrix4,this.dragVector=new THREE.Vector3,this.currentObjectScale=new THREE.Vector3,NAF.utils.getNetworkedEntity(this.el).then(e=>{this.objectToScale=e.object3D});const e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3;this.startScaling=n=>{if(this.isScaling||!this.objectToScale)return;this.didGetObjectReferences||(this.didGetObjectReferences=!0,this.leftEventer=document.getElementById("left-cursor").object3D,this.leftCursorController=document.getElementById("left-cursor-controller"),this.leftRaycaster=this.leftCursorController.components["cursor-controller"].raycaster,this.rightCursorController=document.getElementById("right-cursor-controller"),this.rightRaycaster=this.rightCursorController.components["cursor-controller"].raycaster,this.viewingCamera=document.getElementById("viewing-camera").object3D),this.plane=n.object3D===this.leftEventer?Mi:Li,Object(Ae.l)(this.plane,Ti(this.viewingCamera,this.el.object3D)),this.planeRotation.extractRotation(this.plane.matrixWorld),this.planeUp.set(0,1,0).applyMatrix4(this.planeRotation),this.planeRight.set(1,0,0).applyMatrix4(this.planeRotation),this.raycaster=n.object3D===this.leftEventer?this.leftRaycaster:this.rightRaycaster;const a=this.raycastOnPlane();a&&(this.isScaling=!0,this.initialIntersectionPoint.copy(a.point),this.objectToScale.updateMatrices(),this.initialObjectScale.setFromMatrixScale(this.objectToScale.matrixWorld),this.initialDistanceToObject=i.subVectors(e.setFromMatrixPosition(this.viewingCamera.matrixWorld),t.setFromMatrixPosition(this.el.object3D.matrixWorld)).length(),window.APP.store.update({activity:{hasScaled:!0}}),this.transformSelectedObjectSystem=this.transformSelectedObjectSystem||this.el.sceneEl.systems["transform-selected-object"],this.transformSelectedObjectSystem.transforming=!0,this.transformSelectedObjectSystem.mode=fi.SCALE,this.transformSelectedObjectSystem.target=this.objectToScale,this.transformSelectedObjectSystem.hand=n.object3D===this.leftEventer?this.leftCursorController.object3D:this.rightCursorController.object3D)},this.endScaling=e=>{this.isScaling&&(e.object3D===this.leftEventer&&this.raycaster===this.leftRaycaster||e.object3D!==this.leftEventer&&this.raycaster===this.rightRaycaster)&&(this.isScaling=!1,this.transformSelectedObjectSystem=this.transformSelectedObjectSystem||this.el.sceneEl.systems["transform-selected-object"],this.transformSelectedObjectSystem.transforming=!1)},this.el.object3D.addEventListener("holdable-button-down",this.startScaling),this.el.object3D.addEventListener("holdable-button-up",this.endScaling)},raycastOnPlane(){this.intersections.length=0;const e=this.raycaster.far;return this.raycaster.far=1e3,this.plane.raycast(this.raycaster,this.intersections),this.raycaster.far=e,this.intersections[0]},tick(){if(!this.isScaling)return;const e=this.raycastOnPlane();if(!e)return;this.intersectionPoint.copy(e.point),this.dragVector.subVectors(this.intersectionPoint,this.initialIntersectionPoint);const t=(this.dragVector.dot(this.planeUp)+this.dragVector.dot(this.planeRight))/this.initialDistanceToObject;let i=1;t>0?i=1+t:t<0&&(i=1/(1+Math.abs(t))),this.desiredObjectScale.copy(this.initialObjectScale).multiplyScalar(i),this.objectToScale.updateMatrices(),this.currentObjectScale.setFromMatrixScale(this.objectToScale.matrixWorld),this.deltaScale.set(this.desiredObjectScale.x/this.currentObjectScale.x,this.desiredObjectScale.y/this.currentObjectScale.y,this.desiredObjectScale.z/this.currentObjectScale.z),this.objectMatrix.copy(this.objectToScale.matrixWorld),this.objectMatrix.scale(this.deltaScale),Object(Ae.l)(this.objectToScale,this.objectMatrix)}});i(1015),i(1016);const Ri=function(e,t){this.geometry=new THREE.BufferGeometry,this.vertices=new Float32Array(3*e*2),this.uvs=new Float32Array(2*e*2),this.width=t,this.geometry.addAttribute("position",new THREE.BufferAttribute(this.vertices,3).setDynamic(!0)),this.material=new THREE.MeshBasicMaterial({side:THREE.DoubleSide,transparent:!0}),this.mesh=new THREE.Mesh(this.geometry,this.material),this.mesh.drawMode=THREE.TriangleStripDrawMode,this.mesh.frustumCulled=!1,this.mesh.vertices=this.vertices,this.direction=new THREE.Vector3,this.numPoints=e};function Pi(e,t,i,n){return n.x=e.x+t.x*i,n.y=e.y+t.y*i-4.9*i*i,n.z=e.z+t.z*i,n}Ri.prototype={setDirection:function(e){const t=new THREE.Vector3(0,1,0);this.direction.copy(e).cross(t).normalize().multiplyScalar(this.width/2)},setWidth:function(e){this.width=e},setPoint:function(){const e=new THREE.Vector3,t=new THREE.Vector3;return function(i,n){e.copy(n).add(this.direction),t.copy(n).sub(this.direction);let a=6*i;this.vertices[a++]=e.x,this.vertices[a++]=e.y,this.vertices[a++]=e.z,this.vertices[a++]=t.x,this.vertices[a++]=t.y,this.vertices[a++]=t.z,this.geometry.attributes.position.needsUpdate=!0}}()};const Di=function(){const e=new THREE.Vector3;return function(t,i,n,a,s,o,r){e.copy(i).sub(t);const l=e.length();a.far=l,a.set(t,e.normalize());const c=a.intersectObjects(n,!0);return!!(c.length>0&&function(e,t,i){const n=t.angleTo(e);return THREE.Math.RAD2DEG*n<=i}(c[0].face.normal,s,o))&&(r.copy(c[0].point),!0)}}();const Oi=new THREE.Vector3(0,0,-1),Hi=new THREE.Vector3(0,1,0),ji=new THREE.Quaternion,Ii=new THREE.Vector3,Ni=new THREE.Vector3;AFRAME.registerComponent("teleporter",{schema:{start:{type:"string"},confirm:{type:"string"},speed:{default:12},collisionEntities:{default:""},hitCylinderColor:{type:"color",default:"#99ff99"},hitCylinderRadius:{default:.25,min:0},outerRadius:{default:.6,min:0},hitCylinderHeight:{default:.3,min:0}},init(){this.characterController=this.el.sceneEl.systems["hubs-systems"].characterController,this.isTeleporting=!1,this.rayCurve=new Ri(20,.025),this.rayCurve.mesh.visible=!1,this.teleportEntity=document.createElement("a-entity"),this.teleportEntity.setObject3D("mesh",this.rayCurve.mesh),this.el.sceneEl.appendChild(this.teleportEntity),this.p0=new THREE.Vector3,this.v0=new THREE.Vector3,this.parabola=Array.from(new Array(this.rayCurve.numPoints),()=>new THREE.Vector3),this.hit=!1,this.hitPoint=new THREE.Vector3,this.meshes=[],this.raycaster=new THREE.Raycaster,this.rigWorldPosition=new THREE.Vector3,this.newRigWorldPosition=new THREE.Vector3,this.teleportOriginWorldPosition=new THREE.Vector3,this.teleportEventDetail={oldPosition:this.rigWorldPosition,newPosition:this.newRigWorldPosition,hitPoint:this.hitPoint},this.prevHitHeight=0,this.direction=new THREE.Vector3,this.hitEntity=this.createHitEntity(),this.hitEntity.object3D.visible=!1,this.el.sceneEl.appendChild(this.hitEntity),this.queryCollisionEntities()},queryCollisionEntities:function(){this.collisionEntities=[].slice.call(this.el.sceneEl.querySelectorAll(this.data.collisionEntities)),this.meshes=this.collisionEntities.map(function(e){return e.getObject3D("mesh")}).filter(function(e){return e})},remove(){this.stopPlayingTeleportSound()},stopPlayingTeleportSound(){if(this.teleportingSound){this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.stopSoundNode(this.teleportingSound.source),this.teleportingSound=null}},tick(e,t){if(!this.el.sceneEl.is("entered"))return;const i=this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem,n=AFRAME.scenes[0].systems.userinput,{start:a,confirm:s,speed:o}=this.data,r=this.el.object3D;if(this.isTeleporting||!n.get(a)||this.characterController.isTeleportingDisabled||window.APP.store.state.preferences.disableTeleporter||(this.isTeleporting=!0,this.timeTeleporting=0,this.hit=!1,this.rayCurve.mesh.visible=!0,this.rayCurve.mesh.updateMatrixWorld(),this.rayCurve.mesh.material.opacity=.1,this.rayCurve.mesh.material.color.set(16711680),this.rayCurve.mesh.material.needsUpdate=!0,this.teleportingSound=i.playSoundLoopedWithGain(v.u),this.teleportingSound&&(this.teleportingSound.gain.gain.value=.005)),!this.isTeleporting)return;if(this.teleportingSound&&(this.teleportingSound.gain.gain.value=Math.min(.025,this.teleportingSound.gain.gain.value+2e-5*t)),n.get(s)){if(this.hitEntity.setAttribute("visible",!1),this.isTeleporting=!1,this.rayCurve.mesh.visible=!1,this.teleportingSound&&this.stopPlayingTeleportSound(),!this.hit||this.timeTeleporting<400)return;return this.characterController.teleportTo(this.hitPoint),void i.playSoundOneShot(v.t)}this.timeTeleporting+=t,r.updateMatrixWorld(),r.matrixWorld.decompose(this.p0,ji,Ii),this.direction.copy(Oi).applyQuaternion(ji).normalize(),this.rayCurve.setDirection(this.direction),this.el.object3D.updateMatrices();const l=Ni.setFromMatrixColumn(this.characterController.avatarPOV.object3D.matrixWorld,1).length();this.v0.copy(this.direction).multiplyScalar(o*Math.sqrt(l));let c=this.rayCurve.numPoints-1;this.hit=!1,this.parabola[0].copy(this.p0);const d=1/(this.rayCurve.numPoints-1);for(let e=1;e<this.rayCurve.numPoints;e++){const t=e*d;if(Pi(this.p0,this.v0,t,Ii),this.parabola[e].copy(Ii),Di(this.parabola[e-1],this.parabola[e],this.meshes,this.raycaster,Hi,45,this.hitPoint)){this.hit=!0,c=e;break}}this.characterController.isTeleportingDisabled&&(this.hit=!1);const h=this.timeTeleporting>400?1:this.timeTeleporting/400,u=h*(c/(this.rayCurve.numPoints-1))/(this.rayCurve.numPoints-1);for(let e=0;e<this.rayCurve.numPoints;e++){const t=e*u;Pi(this.p0,this.v0,t,Ii),this.rayCurve.setPoint(e,Ii)}const p=this.hit?65280:16711680,m=this.hit&&this.timeTeleporting>=400?.3:.1;if(this.rayCurve.material.color.set(p),this.rayCurve.material.opacity=m,this.hitEntity.setAttribute("visible",this.hit),this.hit){this.hitEntity.setAttribute("position",this.hitPoint),this.hitEntity.object3D.traverse(e=>{e.matrixNeedsUpdate=!0});const e=.3*function(e){return e<.5?.5*((e=2*e-1)*e*e+1):.5*(e=2*e-1)*e*e+.5}(h),t=this.data.outerRadius-this.data.hitCylinderRadius,i=(this.data.outerRadius-function(e){return e*e}(h)*t)/this.data.outerRadius;this.outerTorus.object3D.scale.set(i,i,1),this.torus.setAttribute("material","opacity",e),this.cylinder.setAttribute("material","opacity",e)}},createHitEntity(){const e=this.data,t=document.createElement("a-entity");return t.className="hitEntity",this.torus=document.createElement("a-entity"),this.torus.setAttribute("geometry",{primitive:"torus",radius:e.hitCylinderRadius,radiusTubular:.01,segmentsRadial:16,segmentsTubular:18}),this.torus.setAttribute("rotation",{x:90,y:0,z:0}),this.torus.setAttribute("material",{shader:"flat",color:e.hitCylinderColor,side:"double",depthTest:!1}),t.appendChild(this.torus),this.cylinder=document.createElement("a-entity"),this.cylinder.setAttribute("position",{x:0,y:e.hitCylinderHeight/2,z:0}),this.cylinder.setAttribute("geometry",{primitive:"cylinder",segmentsHeight:1,radius:e.hitCylinderRadius,height:e.hitCylinderHeight,openEnded:!0}),this.cylinder.setAttribute("material",{shader:"flat",color:e.hitCylinderColor,side:"double",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAQCAYAAADXnxW3AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAADJJREFUeNpEx7ENgDAAAzArK0JA6f8X9oewlcWStU1wBGdwB08wgjeYm79jc2nbYH0DAC/+CORJxO5fAAAAAElFTkSuQmCC",transparent:!0,depthTest:!1}),t.appendChild(this.cylinder),this.outerTorus=document.createElement("a-entity"),this.outerTorus.setAttribute("geometry",{primitive:"torus",radius:e.outerRadius,radiusTubular:.01,segmentsRadial:16,segmentsTubular:18}),this.outerTorus.setAttribute("rotation",{x:90,y:0,z:0}),this.outerTorus.setAttribute("material",{shader:"flat",color:e.hitCylinderColor,side:"double",opacity:.3,depthTest:!1}),this.outerTorus.setAttribute("id","outerTorus"),t.appendChild(this.outerTorus),t}});i(1017),i(1018),i(1019),i(1020);function Fi(e,t){return e&&e.components&&e.components.tags&&e.components.tags.data[t]}AFRAME.registerComponent("tags",{schema:{isHandCollisionTarget:{default:!1},isHoldable:{default:!1},offersHandConstraint:{default:!1},offersRemoteConstraint:{default:!1},togglesHoveredActionSet:{default:!1},singleActionButton:{default:!1},holdableButton:{default:!1},isPen:{default:!1},isHoverMenuChild:{default:!1},isStatic:{default:!1},inspectable:{default:!1}},update(){this.didUpdateOnce&&console.warn("Do not edit tags with .setAttribute"),this.didUpdateOnce=!0},remove(){const e=this.el.sceneEl.systems.interaction;e.isHeld(this.el)&&(e.release(this.el),this.el.sceneEl.systems["hubs-systems"].constraintsSystem.release(this.el))}});var Vi=i(505),Bi=i.n(Vi);const zi=16;function Ui(e,t,i){return e||(.5+t)*i}const Wi={roboto:{json:(Zi="https://cdn.aframe.io/fonts/Roboto-msdf.json",fetch(Zi).then(e=>e.json()).then(e=>{if(Zi.indexOf("/Roboto-msdf.json")>=0)for(const t of e.chars)t.yoffset+=30;return e.widthFactor=function(e){let t=0,i=0,n=0;for(const a of e.chars)t+=a.xadvance,a.id>=48&&a.id<=57&&(n++,i+=a.xadvance);return n?i/n:t/e.chars.length}(e),e})),texture:function(e){return new Promise((t,i)=>{(new THREE.ImageLoader).load(e,e=>{const i=new THREE.Texture;i.image=e,i.needsUpdate=!0,i.anisotropy=zi,t(i)},void 0,t=>{console.error("Error loading font image",e,t),i(null)})})}("https://cdn.aframe.io/fonts/Roboto-msdf.png")}};var Zi;AFRAME.registerComponent("text",{multiple:!0,schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:"roboto"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},negate:{type:"boolean",default:!0},opacity:{type:"number",default:1},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:!0},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},xOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){const e=this.getShaderData(this.data);this.shaderObject=new AFRAME.shaders.msdf.Shader,this.shaderObject.el=this.el,this.shaderObject.init(e),this.shaderObject.update(e),this.shaderObject.material.transparent=e.transparent,this.shaderObject.material.side=e.side,this.geometry=Bi()(),this.mesh=new THREE.Mesh(this.geometry,this.shaderObject.material),this.el.setObject3D(this.attrName,this.mesh)},update:function(e){const t=this.data,i=this.getShaderData(this.data);this.shaderObject.update(i),this.shaderObject.material.transparent=i.transparent,this.shaderObject.material.side=i.side,e.font!==t.font&&this.updateFont().catch(e=>console.error(e)),null!=this.currentFont&&(this.updateGeometry(this.geometry,this.currentFont),this.updateLayout(this.currentFont))},remove:function(){this.geometry.dispose(),this.geometry=null,this.el.removeObject3D(this.attrName),this.shaderObject.material.dispose(),this.shaderObject.material=null,delete this.shaderObject},getShaderData:function(){const e={};return function(t){return e.alphaTest=t.alphaTest,e.color=t.color,e.opacity=t.opacity,e.side=function(e){switch(e){case"back":return THREE.FrontSide;case"double":return THREE.DoubleSide;default:return THREE.BackSide}}(t.side),e.transparent=t.transparent,e.negate=t.negate,e}}(),updateFont:function(){const e=this.data,t=this.geometry;return this.mesh.visible=!1,Promise.all([Wi[e.font].json,Wi[e.font].texture]).then(([e,i])=>{if(1!==e.pages.length)throw new Error("Currently only single-page bitmap fonts are supported.");this.currentFont=e,this.updateGeometry(t,e),this.shaderObject.update({map:i}),this.updateLayout(e),this.mesh.visible=!0})},updateLayout:function(e){const t=this.el,i=this.data,n=this.geometry,a=this.mesh;if(!n.layout)return;const s=t.getAttribute("geometry"),o=i.width||s&&s.width||1,r=o/Ui(i.wrapPixels,i.wrapCount,e.widthFactor),l=n.layout,c=r*(l.height+l.descender);s&&"plane"===s.primitive&&(s.width||t.setAttribute("geometry","width",o),s.height||t.setAttribute("geometry","height",c));const d="align"===i.anchor?i.align:i.anchor;let h,u;if("left"===d)h=0;else if("right"===d)h=-1*l.width;else{if("center"!==d)throw new TypeError("Invalid text.anchor property value",d);h=-1*l.width/2}const p=i.baseline;if("bottom"===p)u=0;else if("top"===p)u=-1*l.height+l.ascender;else{if("center"!==p)throw new TypeError("Invalid text.baseline property value",p);u=-1*l.height/2}a.position.x=h*r+i.xOffset,a.position.y=u*r,a.position.z=i.zOffset,a.scale.set(r,-1*r,r),a.matrixNeedsUpdate=!0},updateGeometry:function(){const e={},t={},i=/\\n/g,n=/\\t/g;return function(a,s){const o=this.data;t.font=s,t.lineHeight=o.lineHeight&&isFinite(o.lineHeight)?o.lineHeight:s.common.lineHeight,t.text=o.value.toString().replace(i,"\n").replace(n,"\t"),t.width=Ui(o.wrapPixels,o.wrapCount,s.widthFactor),a.update(Object.assign(e,o,t)),a.boundingBox=null,a.boundingSphere=null}}()});i(1033),i(1034);AFRAME.registerComponent("inspect-button",{tick(){if(!this.initializedInTick){if(this.initializedInTick=!0,this.inspectable=Object(Ce.f)(this.el),!this.inspectable)return void console.error("You put an inspect button but I could not find what you want to inspect.",this.el);this.el.object3D.addEventListener("holdable-button-down",()=>{this.el.sceneEl.systems["hubs-systems"].cameraSystem.inspect(this.inspectable.object3D)}),this.el.object3D.addEventListener("holdable-button-up",()=>{this.el.sceneEl.systems["hubs-systems"].cameraSystem.uninspect()})}}});i(1035);const Gi={global:"global",inputFocused:"inputFocused",rightCursorHoveringOnPen:"rightCursorHoveringOnPen",rightCursorHoveringOnCamera:"rightCursorHoveringOnCamera",rightCursorHoveringOnInteractable:"rightCursorHoveringOnInteractable",rightCursorHoveringOnUI:"rightCursorHoveringOnUI",rightCursorHoveringOnVideo:"rightCursorHoveringOnVideo",rightCursorHoveringOnNothing:"rightCursorHoveringOnNothing",rightCursorHoldingPen:"rightCursorHoldingPen",rightCursorHoldingCamera:"rightCursorHoldingCamera",rightCursorHoldingInteractable:"rightCursorHoldingInteractable",rightCursorHoldingUI:"rightCursorHoldingUI",rightCursorHoldingNothing:"rightCursorHoldingNothing",leftCursorHoveringOnPen:"leftCursorHoveringOnPen",leftCursorHoveringOnCamera:"leftCursorHoveringOnCamera",leftCursorHoveringOnInteractable:"leftCursorHoveringOnInteractable",leftCursorHoveringOnUI:"leftCursorHoveringOnUI",leftCursorHoveringOnVideo:"leftCursorHoveringOnVideo",leftCursorHoveringOnNothing:"leftCursorHoveringOnNothing",leftCursorHoldingPen:"leftCursorHoldingPen",leftCursorHoldingCamera:"leftCursorHoldingCamera",leftCursorHoldingInteractable:"leftCursorHoldingInteractable",leftCursorHoldingUI:"leftCursorHoldingUI",leftCursorHoldingNothing:"leftCursorHoldingNothing",rightHandTeleporting:"rightHandTeleporting",rightHandHoveringOnPen:"rightHandHoveringOnPen",rightHandHoveringOnCamera:"rightHandHoveringOnCamera",rightHandHoveringOnInteractable:"rightHandHoveringOnInteractable",rightHandHoveringOnNothing:"rightHandHoveringOnNothing",rightHandHoldingPen:"rightHandHoldingPen",rightHandHoldingCamera:"rightHandHoldingCamera",rightHandHoldingInteractable:"rightHandHoldingInteractable",leftHandTeleporting:"leftHandTeleporting",leftHandHoveringOnPen:"leftHandHoveringOnPen",leftHandHoveringOnCamera:"leftHandHoveringOnCamera",leftHandHoveringOnInteractable:"leftHandHoveringOnInteractable",leftHandHoldingPen:"leftHandHoldingPen",leftHandHoldingCamera:"leftHandHoldingCamera",leftHandHoldingInteractable:"leftHandHoldingInteractable",leftHandHoveringOnNothing:"leftHandHoveringOnNothing",debugUserInput:"debugUserInput",inspecting:"inspecting"};var qi=i(52),$i=i.n(qi),Yi=i(0),Xi=i.n(Yi),Qi=i(604),Ki=i(1291),Ji=i(264),en=i(16),tn=i(506),nn=i.n(tn),an=i(507),sn=i.n(an),on=i(294),rn=i.n(on),ln=i(295),cn=i.n(ln),dn=i(508),hn=i.n(dn),un=i(509),pn=i.n(un),mn=i(223),gn=i.n(mn),fn=i(224),vn=i.n(fn),bn=i(201),yn=i.n(bn),_n=i(2),wn=i.n(_n),En=i(5),xn=i.n(En),Sn=i(225),Cn=i.n(Sn),kn=i(3),An=i(83),Tn=i.n(An),Mn=i(19),Ln=i(197);function Rn(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}const{detect:Pn}=i(105),Dn=Pn(),On={yes:"yes",no:"no",maybe:"maybe"};const Hn=[/cardboard/i];function jn(){return In.apply(this,arguments)}function In(){var e;return e=function*(){const e=navigator.userAgent,t="chrome"===Dn.name&&/SamsungBrowser/.test(e),i=AFRAME.utils.device.isMobile(),n=AFRAME.utils.device.isMobileVR(),a=window.hasNativeWebVRImplementation,s=!(!a||"chrome"!==Dn.name||t),o=AFRAME.utils.device.isIOS(),r="firefox"===Dn.name,l=void 0===navigator.mediaDevices,c=o?l?On.maybe:On.yes:On.no,d=!(!i||o||"chrome"!==Dn.name||t);let h=[];try{("chrome"!==Dn.name||i)&&(h=a||d?yield navigator.getVRDisplays():[])}catch(e){console.warn("navigator.getVRDisplays() failed",e)}const u=/Oculus/.test(e),p=n?On.no:o&&l?On.maybe:On.yes;let m=i||!a&&r?On.no:On.maybe,g=On.no,f=On.no;(function(e){return/\WAndroid\W/.test(e)})(e)&&(f=u?On.yes:On.maybe);let v=function(e){return/\WAndroid\W/.test(e)}(e)&&!n?On.maybe:On.no;if(g=d&&h.find(e=>e.capabilities.canPresent&&/cardboard/i.test(e.displayName))?On.yes:On.no,a){m=h.find(e=>e.capabilities.canPresent&&!Hn.find(t=>t.test(e.displayName)))?On.yes:On.no,h.find(e=>/daydream/i.test(e.displayName))?(v=On.yes,m=On.no):s&&(v=On.no)}return{screen:p,generic:m,gearvr:f,daydream:v,cardboard:g,safari:c}},(In=function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){Rn(s,n,a,o,r,"next",e)}function r(e){Rn(s,n,a,o,r,"throw",e)}o(void 0)})}).apply(this,arguments)}const Nn=AFRAME.utils.device.isMobileVR();function Fn(){return navigator.share&&!Nn}function Vn(e){if(Fn())return navigator.share(e);{const{title:t,url:i}=e,n=550,a=420,s=(screen.width-n)/2,o=`scrollbars=no,menubar=no,toolbar=no,status=no,width=${n},height=${a},top=${(screen.height-a)/2},left=${s}`,r=`https://twitter.com/intent/tweet?url=${encodeURIComponent(i)}&text=${encodeURIComponent(t)}`;return window.open(r,"_blank",o),Promise.resolve()}}var Bn,zn,Un,Wn=i(29),Zn=i.n(Wn),Gn=i(28),qn=i.n(Gn),$n=i(40),Yn=i.n($n),Xn=i(23),Qn=i(605);function Kn(){return(Kn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function Jn(e,t){if(null==e)return{};var i,n,a=function(e,t){if(null==e)return{};var i,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)i=s[n],t.indexOf(i)>=0||(a[i]=e[i]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)i=s[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}class ea extends Xi.a.Component{render(){const e=this.props,{history:t,stateKey:i,stateValue:n}=e,a=Jn(e,["history","stateKey","stateValue"]);return!t.location.state&&!n||t.location.state&&(t.location.state[i]===n||!t.location.state[i]&&!n)?Xi.a.createElement(Qn.a,Kn({path:"/"},a)):null}}Bn=ea,zn="propTypes",Un={stateKey:wn.a.string,stateValue:wn.a.string,history:wn.a.object},zn in Bn?Object.defineProperty(Bn,zn,{value:Un,enumerable:!0,configurable:!0,writable:!0}):Bn[zn]=Un;var ta=ea,ia=i(510),na=i.n(ia),aa=i(511),sa=i.n(aa),oa=i(20),ra=i(302),la=i.n(ra);function ca(){return(ca=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}class da extends Yi.Component{render(){return Xi.a.createElement(oa.a,ca({title:"Promote User"},this.props),Xi.a.createElement("div",{className:la.a.message},Xi.a.createElement(kn.a,{id:"promote.message"})),Xi.a.createElement("button",{className:la.a.confirmButton,onClick:()=>{this.props.onConfirm(),this.props.onClose()}},Xi.a.createElement(kn.a,{id:"promote.confirm-prefix"}),Xi.a.createElement("span",null,this.props.displayName)),Xi.a.createElement("button",{className:la.a.cancelButton,onClick:()=>this.props.onClose()},Xi.a.createElement(kn.a,{id:"promote.cancel"})))}}!function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(da,"propTypes",{displayName:wn.a.string,onConfirm:wn.a.func,onClose:wn.a.func});var ha=i(58),ua=i.n(ha);function pa(){return(pa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function ma(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function ga(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){ma(s,n,a,o,r,"next",e)}function r(e){ma(s,n,a,o,r,"throw",e)}o(void 0)})}}function fa(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class va extends Yi.Component{constructor(...e){super(...e),fa(this,"state",{avatarThumbnailUrl:null})}kick(){const{clientId:e,performConditionalSignIn:t,hubChannel:i,onClose:n}=this.props;t(()=>i.can("kick_users"),ga(function*(){return yield i.kick(e)}),"kick-user"),n()}hide(){const{clientId:e,onClose:t,hubChannel:i}=this.props;i.hide(e),t()}mute(){const{clientId:e,performConditionalSignIn:t,hubChannel:i,onClose:n}=this.props;t(()=>i.can("mute_users"),ga(function*(){return yield i.mute(e)}),"mute-user"),n()}addOwner(){var e=this;const{clientId:t,performConditionalSignIn:i,hubChannel:n,onClose:a}=this.props,{profile:s}=this.getPresenceEntry();i(()=>n.can("update_roles"),ga(function*(){a(),e.props.showNonHistoriedDialog(da,{displayName:s.displayName,onConfirm:()=>n.addOwner(t)})}),"add-owner")}removeOwner(){const{clientId:e,performConditionalSignIn:t,hubChannel:i,onClose:n}=this.props;t(()=>i.can("update_roles"),ga(function*(){return yield i.removeOwner(e)}),"remove-owner"),n()}unhide(){const{clientId:e,hubChannel:t,onClose:i}=this.props;t.unhide(e),i()}getPresenceEntry(){if(!this.props.presences)return null;const e=Object.entries(this.props.presences).find(([e])=>e===this.props.clientId);if(!e)return{profile:{},roles:{}};const t=e[1].metas;return t[t.length-1]}componentDidMount(){const{profile:e}=this.getPresenceEntry();e.avatarId&&Object(ye.f)(e.avatarId).then(e=>this.setState({avatarThumbnailUrl:e}))}render(){const{profile:e,roles:t}=this.getPresenceEntry(),{displayName:i,identityName:n}=e,{hubChannel:a,clientId:s,onClose:o}=this.props,r=Xi.a.createElement("div",{className:ua.a.title},i,Xi.a.createElement("div",{className:ua.a.identityName},n)),l=a.canOrWillIfCreator("kick_users"),c=a.canOrWillIfCreator("mute_users"),d=!!t.owner,h=!!t.creator,u=!!t.signed_in,p=a.canOrWillIfCreator("update_roles")&&!d&&!h,m=a.canOrWillIfCreator("update_roles")&&d&&!h,g=a.isHidden(s);return Xi.a.createElement(oa.a,pa({className:ua.a.clientInfoDialog,title:r,wide:!0},this.props),Xi.a.createElement("div",{className:ua.a.roomInfo},Xi.a.createElement("div",{className:ua.a.clientProfileImage},Xi.a.createElement("img",{src:this.state.avatarThumbnailUrl})),Xi.a.createElement("div",{className:ua.a.primaryActionButtons},p&&Xi.a.createElement("button",{onClick:()=>this.addOwner(),disabled:!u,title:u?"Promote":`${e.displayName} is signed out.`},Xi.a.createElement("img",{className:ua.a.buttonIcon,src:na.a}),Xi.a.createElement(kn.a,{id:"client-info.add-owner"})),m&&Xi.a.createElement("button",{onClick:()=>this.removeOwner()},Xi.a.createElement("img",{className:ua.a.buttonIcon,src:sa.a}),Xi.a.createElement(kn.a,{id:"client-info.remove-owner"})),!g&&Xi.a.createElement("button",{onClick:()=>this.hide()},Xi.a.createElement(kn.a,{id:"client-info.hide-button"})),g&&Xi.a.createElement("button",{onClick:()=>this.unhide()},Xi.a.createElement(kn.a,{id:"client-info.unhide-button"})),c&&Xi.a.createElement("button",{onClick:()=>this.mute()},Xi.a.createElement(kn.a,{id:"client-info.mute-button"})),l&&Xi.a.createElement("button",{onClick:()=>this.kick()},Xi.a.createElement(kn.a,{id:"client-info.kick-button"})),Xi.a.createElement("button",{className:ua.a.cancel,onClick:o},Xi.a.createElement(kn.a,{id:"client-info.cancel"})))))}}fa(va,"propTypes",{clientId:wn.a.string,history:wn.a.object,hubChannel:wn.a.object,presences:wn.a.object,performConditionalSignIn:wn.a.func,onClose:wn.a.func,showNonHistoriedDialog:wn.a.func});var ba=i(15),ya=i(381),_a=i.n(ya);function wa(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Ea extends Yi.Component{constructor(...e){super(...e),wa(this,"doneWithInitialLoad",!1),wa(this,"state",{loadingNum:0,loadedNum:0}),wa(this,"onObjectLoading",()=>{!this.doneWithInitialLoad&&this.loadingTimeout&&(window.clearTimeout(this.loadingTimeout),this.loadingTimeout=null),this.setState(e=>({loadingNum:e.loadingNum+1}))}),wa(this,"onObjectLoaded",()=>{this.setState(e=>({loadedNum:e.loadedNum+1})),this.tryFinishLoading()}),wa(this,"tryFinishLoading",()=>{!this.doneWithInitialLoad&&this.loadingTimeout&&window.clearTimeout(this.loadingTimeout),this.environmentSceneLoaded&&(this.loadingTimeout=window.setTimeout(()=>{this.doneWithInitialLoad=!0,this.props.onLoaded&&this.props.onLoaded()},1500))})}componentDidMount(){this.props.scene.addEventListener("model-loading",this.onObjectLoading),this.props.scene.addEventListener("image-loading",this.onObjectLoading),this.props.scene.addEventListener("pdf-loading",this.onObjectLoading),this.props.scene.addEventListener("model-loaded",this.onObjectLoaded),this.props.scene.addEventListener("image-loaded",this.onObjectLoaded),this.props.scene.addEventListener("pdf-loaded",this.onObjectLoaded),this.props.scene.addEventListener("model-error",this.onObjectLoaded),this.props.scene.addEventListener("environment-scene-loaded",()=>{this.environmentSceneLoaded=!0,this.tryFinishLoading()},{once:!0})}componentWillUnmount(){this.props.scene.removeEventListener("model-loading",this.onObjectLoading),this.props.scene.removeEventListener("image-loading",this.onObjectLoading),this.props.scene.removeEventListener("pdf-loading",this.onObjectLoading),this.props.scene.removeEventListener("model-loaded",this.onObjectLoaded),this.props.scene.removeEventListener("image-loaded",this.onObjectLoaded),this.props.scene.removeEventListener("pdf-loaded",this.onObjectLoaded),this.props.scene.removeEventListener("model-error",this.onObjectLoaded)}render(){const e=Xi.a.createElement("h4",{className:_a.a.loadingText},Xi.a.createElement(kn.a,{id:"loader.entering_lobby"})),t=0===this.state.loadingNum?" ":`${Math.min(this.state.loadedNum,this.state.loadingNum)} / ${this.state.loadingNum} `,i=Xi.a.createElement("h4",{className:_a.a.loadingText},Xi.a.createElement(kn.a,{id:"loader.loading"}),t,Xi.a.createElement(kn.a,{id:1!==this.state.loadingNum?"loader.objects":"loader.object"}),"...");return Xi.a.createElement(kn.b,{locale:ba.a,messages:ba.b},Xi.a.createElement("div",{className:"loading-panel"},Xi.a.createElement("img",{className:"loading-panel__logo",src:n.a.image("logo")}),Xi.a.createElement(Ln.a,{name:"hide_powered_by"},Xi.a.createElement("div",{className:"loading-panel__powered-by"},Xi.a.createElement("span",{className:"loading-panel__powered-by__prefix"},Xi.a.createElement(kn.a,{id:"home.powered_by_prefix"})),Xi.a.createElement("a",{href:"https://github.com/mozilla/hubs-cloud"},Xi.a.createElement(kn.a,{id:"home.powered_by_link"})))),this.props.finished?e:i,Xi.a.createElement("div",{className:"loader-wrap loader-bottom"},Xi.a.createElement("div",{className:"loader"},Xi.a.createElement("div",{className:"loader-center"})))))}}wa(Ea,"propTypes",{scene:wn.a.object,finished:wn.a.bool,onLoaded:wn.a.func});var xa=Ea;const Sa=e=>Xi.a.createElement("div",{className:"autoexit-panel"},Xi.a.createElement("div",{className:"autoexit-panel__title"},Xi.a.createElement(kn.a,{id:"autoexit.title"}),Xi.a.createElement("span",null,e.secondsRemaining),Xi.a.createElement(kn.a,{id:"autoexit.title_units"})),Xi.a.createElement("div",{className:"autoexit-panel__subtitle"},Xi.a.createElement(kn.a,{id:e.message})),Xi.a.createElement(Xn.b,null,Xi.a.createElement("div",{className:"autoexit-panel__cancel-button",onClick:e.onCancel},Xi.a.createElement(kn.a,{id:"autoexit.cancel"}))));Sa.propTypes={message:wn.a.string,secondsRemaining:wn.a.number,onCancel:wn.a.func};var Ca=Sa,ka=i(512),Aa=i.n(ka),Ta=i(513),Ma=i.n(Ta),La=i(514),Ra=i.n(La),Pa=(i(515),i(516)),Da=i.n(Pa);function Oa(){return(Oa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function Ha(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),n.forEach(function(t){ja(e,t,i[t])})}return e}function ja(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ia(e){const t=Ha({},e);return delete t.src,Xi.a.createElement("div",Oa({},t,{dangerouslySetInnerHTML:{__html:e.src}}))}function Na(e){const t=Ha({},e);return delete t.src,Xi.a.createElement("button",Oa({},t,{dangerouslySetInnerHTML:{__html:e.src}}))}function Fa(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),n.forEach(function(t){Va(e,t,i[t])})}return e}function Va(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Ia.propTypes={src:wn.a.string},Na.propTypes={src:wn.a.string};const Ba=e=>Xi.a.createElement(Xn.b,null,Xi.a.createElement("button",{autoFocus:e.autoFocus,className:xn()([{[qn.a.entryButton]:!0,[qn.a.entryButtonSecondary]:e.secondary}]),onClick:e.onClick},Xi.a.createElement(Ia,{src:e.iconSrc,className:qn.a.icon}),Xi.a.createElement("div",{className:qn.a.label},Xi.a.createElement("div",{className:qn.a.contents},Xi.a.createElement("span",null,Xi.a.createElement(kn.a,{id:e.prefixMessageId})),Xi.a.createElement("span",{className:qn.a.bolded},Xi.a.createElement(kn.a,{id:e.mediumMessageId})),e.subtitle&&Xi.a.createElement("div",{className:qn.a.subtitle},Xi.a.createElement(kn.a,{id:e.subtitle}))))));Ba.propTypes={onClick:wn.a.func,autoFocus:wn.a.bool,iconSrc:wn.a.string,secondary:wn.a.bool,prefixMessageId:wn.a.string,mediumMessageId:wn.a.string,subtitle:wn.a.string,isInHMD:wn.a.bool};const za=AFRAME.utils.device.isMobile()||AFRAME.utils.device.isMobileVR(),Ua=e=>{const t=Fa({},e,{iconSrc:za?Aa.a:Ma.a,prefixMessageId:"entry.screen-prefix",mediumMessageId:za?"entry.mobile-screen":"entry.desktop-screen"});return Xi.a.createElement(Ba,t)},Wa=e=>{const t=Fa({},e,{iconSrc:Ra.a,prefixMessageId:"entry.generic-prefix",mediumMessageId:"entry.generic-medium",subtitle:za?null:"entry.generic-subtitle-desktop"});return Xi.a.createElement(Ba,t)},Za=e=>{const t=Fa({},e,{iconSrc:Da.a,prefixMessageId:"entry.daydream-prefix",mediumMessageId:"entry.daydream-medium"});return Xi.a.createElement(Ba,t)};var Ga=i(100),qa=i(7),$a=i(50),Ya=i(84),Xa=i.n(Ya),Qa=i(37),Ka=i(115),Ja=i(33),es=i(174);function ts(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function is(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){ts(s,n,a,o,r,"next",e)}function r(e){ts(s,n,a,o,r,"throw",e)}o(void 0)})}}function ns(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class as extends Yi.Component{constructor(e){var t;super(e),t=this,ns(this,"state",{avatarId:null,displayName:null,avatar:null}),ns(this,"getStateFromProfile",()=>{const{displayName:e,avatarId:t}=this.props.store.state.profile;return{displayName:e,avatarId:t}}),ns(this,"storeUpdated",()=>this.setState(this.getStateFromProfile())),ns(this,"saveStateAndFinish",e=>{e&&e.preventDefault();const{displayName:t}=this.props.store.state.profile,{hasChangedName:i}=this.props.store.state.activity,n=i||this.state.displayName!==t;this.props.store.update({activity:{hasChangedName:n,hasAcceptedProfile:!0},profile:{displayName:this.state.displayName,avatarId:this.state.avatarId}}),this.props.finished(),this.scene.emit("avatar_updated")}),ns(this,"stopPropagation",e=>{e.stopPropagation()}),ns(this,"setAvatarFromMediaResult",({detail:{entry:e,selectAction:t}})=>{"avatar"!==e.type&&"avatar_listing"!==e.type||"use"!==t||(this.setState({avatarId:e.id}),Object(en.f)(this.props.history,this.props.history.location.state.key,"profile",{avatarId:e.id}))}),ns(this,"refetchAvatar",is(function*(){const e=yield Object(ye.d)(t.state.avatarId);t.state.avatarId===e.avatar_id&&t.setState({avatar:e})})),this.state=this.getStateFromProfile(),e.avatarId&&(this.state.avatarId=e.avatarId),this.props.store.addEventListener("statechanged",this.storeUpdated),this.scene=document.querySelector("a-scene")}componentDidMount(){this.nameInput&&(this.nameInput.addEventListener("keydown",this.stopPropagation),this.nameInput.addEventListener("keypress",this.stopPropagation),this.nameInput.addEventListener("keyup",this.stopPropagation)),this.scene.addEventListener("action_selected_media_result_entry",this.setAvatarFromMediaResult),this.scene.addEventListener("action_avatar_saved",this.refetchAvatar),this.refetchAvatar()}componentDidUpdate(e,t){t.avatarId!==this.state.avatarId&&this.refetchAvatar()}componentWillUnmount(){this.props.store.removeEventListener("statechanged",this.storeUpdated),this.nameInput&&(this.nameInput.removeEventListener("keydown",this.stopPropagation),this.nameInput.removeEventListener("keypress",this.stopPropagation),this.nameInput.removeEventListener("keyup",this.stopPropagation)),this.scene.removeEventListener("action_selected_media_result_entry",this.setAvatarFromMediaResult),this.scene.removeEventListener("action_avatar_saved",this.refetchAvatar)}render(){const{formatMessage:e}=this.props.intl;return Xi.a.createElement("div",{className:Xa.a.profileEntry},Xi.a.createElement("div",{className:Xa.a.close},Xi.a.createElement("button",{autoFocus:!0,onClick:()=>this.props.onClose()},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Ja.faTimes})))),Xi.a.createElement("form",{onSubmit:this.saveStateAndFinish,className:Xa.a.form},Xi.a.createElement("div",{className:xn()([Xa.a.box])},Xi.a.createElement("label",{htmlFor:"#profile-entry-display-name",className:Xa.a.title},Xi.a.createElement(kn.a,{id:"profile.header"})),this.props.displayNameOverride?Xi.a.createElement("span",{className:Xa.a.displayName},this.props.displayNameOverride):Xi.a.createElement("input",{id:"profile-entry-display-name",className:Xa.a.formFieldText,value:this.state.displayName,onFocus:e=>Object(Qa.b)(e.target),onBlur:()=>Object(Qa.a)(),onChange:e=>this.setState({displayName:e.target.value}),required:!0,spellCheck:"false",pattern:$a.a.definitions.profile.properties.displayName.pattern,title:e({id:"profile.display_name.validation_warning"}),ref:e=>this.nameInput=e}),this.state.avatar?Xi.a.createElement("div",{className:Xa.a.preview},Xi.a.createElement(es.a,{avatarGltfUrl:this.state.avatar.gltf_url}),this.state.avatar.account_id===this.props.store.credentialsAccountId&&Xi.a.createElement(Ka.a,{stateKey:"overlay",stateValue:"avatar-editor",stateDetail:{avatarId:this.state.avatarId,hideDelete:!0,returnToProfile:!0},history:this.props.history,className:Xa.a.editAvatar},Xi.a.createElement(qa.a,{icon:Ga.faPencilAlt})),Xi.a.createElement("div",{className:Xa.a.chooseAvatar},Xi.a.createElement("a",{onClick:()=>this.props.mediaSearchStore.sourceNavigateWithNoNav("avatars","use")},Xi.a.createElement(kn.a,{id:"profile.choose_avatar"})))):Xi.a.createElement("div",{className:Xa.a.preview},Xi.a.createElement(es.a,null),Xi.a.createElement("div",{className:Xa.a.chooseAvatar},Xi.a.createElement("a",{onClick:()=>this.props.mediaSearchStore.sourceNavigateWithNoNav("avatars","use")},Xi.a.createElement(kn.a,{id:"profile.choose_avatar"})))),Xi.a.createElement("input",{className:Xa.a.formSubmit,type:"submit",value:e({id:"profile.save"})}),Xi.a.createElement("div",{className:Xa.a.links},Xi.a.createElement(Mn.a,{name:"show_terms"},Xi.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:n.a.link("terms_of_use","https://github.com/mozilla/hubs/blob/master/TERMS.md")},Xi.a.createElement(kn.a,{id:"profile.terms_of_use"}))),Xi.a.createElement(Mn.a,{name:"show_privacy"},Xi.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:n.a.link("privacy_notice","https://github.com/mozilla/hubs/blob/master/PRIVACY.md")},Xi.a.createElement(kn.a,{id:"profile.privacy_notice"})))))),Xi.a.createElement("img",{className:Xa.a.logo,src:n.a.image("logo")}))}}ns(as,"propTypes",{displayNameOverride:wn.a.string,store:wn.a.object,mediaSearchStore:wn.a.object,messages:wn.a.object,finished:wn.a.func,intl:wn.a.object,history:wn.a.object,avatarId:wn.a.string,onClose:wn.a.func});var ss=Object(kn.d)(as),os=i(218),rs=i(219),ls=i(128),cs=i(263),ds=i(517),hs=i(10),us=i.n(hs),ps=i(114),ms=i(244);function gs(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const fs=AFRAME.utils.device.isMobile(),vs=AFRAME.utils.device.isMobileVR(),bs={videos:"https://privacy.microsoft.com/en-us/privacystatement",images:"https://privacy.microsoft.com/en-us/privacystatement",gifs:"https://tenor.com/legal-privacy",sketchfab:"https://sketchfab.com/privacy",poly:"https://policies.google.com/privacy",youtube:"https://policies.google.com/privacy",twitch:"https://www.twitch.tv/p/legal/privacy-policy/"},ys={sketchfab:[{text:"Featured",params:{filter:"featured"}},{text:"Animals",params:{filter:"animals-pets"}},{text:"Architecture",params:{filter:"architecture"}},{text:"Art",params:{filter:"art-abstract"}},{text:"Vehicles",params:{filter:"cars-vehicles"}},{text:"Characters",params:{filter:"characters-creatures"}},{text:"Culture",params:{filter:"cultural-heritage-history"}},{text:"Gadgets",params:{filter:"electronics-gadgets"}},{text:"Fashion",params:{filter:"fashion-style"}},{text:"Food",params:{filter:"food-drink"}},{text:"Furniture",params:{filter:"furniture-home"}},{text:"Music",params:{filter:"music"}},{text:"Nature",params:{filter:"nature-plants"}},{text:"News",params:{filter:"news-politics"}},{text:"People",params:{filter:"people"}},{text:"Places",params:{filter:"places-travel"}},{text:"Science",params:{filter:"science-technology"}},{text:"Sports",params:{filter:"sports-fitness"}},{text:"Weapons",params:{filter:"weapons-military"}}],poly:[{text:"Featured",params:{filter:""}},{text:"Animals",params:{filter:"animals"}},{text:"Architecture",params:{filter:"architecture"}},{text:"Art",params:{filter:"art"}},{text:"Food",params:{filter:"food"}},{text:"Nature",params:{filter:"nature"}},{text:"Objects",params:{filter:"objects"}},{text:"People",params:{filter:"people"}},{text:"Scenes",params:{filter:"scenes"}},{text:"Transport",params:{filter:"transport"}}],avatars:[{text:"Featured",params:{filter:"featured"}},{text:"My Avatars",params:{filter:"my-avatars"}},{text:"Newest",params:{filter:""}}],favorites:[],scenes:[{text:"Featured",params:{filter:"featured"}},{text:"My Scenes",params:{filter:"my-scenes"}}]};class _s extends Yi.Component{constructor(e){super(e),gs(this,"state",{query:"",facets:[],showNav:!0,selectNextResult:!1,clearStashedQueryOnClose:!1}),gs(this,"storeUpdated",()=>{const e=this.getStoreAndHistoryState(this.props);this.setState(e),this.state.selectNextResult&&(e.result&&e.result.entries.length>0?this.selectEntry(e.result.entries[0]):this.close())}),gs(this,"sourceChanged",()=>{!this.inputRef||fs||vs||this.inputRef.focus()}),gs(this,"getUrlSource",e=>e.get("media_source")||Object(en.g)(this.props.history.location).substring(7)),gs(this,"getStoreAndHistoryState",e=>{const t=new URLSearchParams(e.history.location.search),i=e.mediaSearchStore.result,n={result:i,query:this.state.query||t.get("q")||""},a=this.getUrlSource(t);return n.showNav=!("false"===t.get("media_nav")),n.selectAction=t.get("selectAction")||"spawn",i&&i.suggestions&&i.suggestions.length>0?n.facets=i.suggestions.map(e=>({text:e,params:{q:e}})):n.facets=ys[a]||[],n}),gs(this,"handleQueryUpdated",(e,t)=>{this.setState({result:null}),this._sendQueryTimeout&&(clearTimeout(this._sendQueryTimeout),this._sendQueryTimeout=null),t?this.props.mediaSearchStore.filterQueryNavigate("",e):this._sendQueryTimeout=setTimeout(()=>{this.props.mediaSearchStore.filterQueryNavigate("",e),this._sendQueryTimeout=null},500),this.setState({query:e})}),gs(this,"handleEntryClicked",(e,t)=>{e.preventDefault(),t.lucky_query?(this.setState({clearStashedQueryOnClose:!0}),this.handleQueryUpdated(t.lucky_query,!0)):this.selectEntry(t)}),gs(this,"onCopyAvatar",()=>{this.handleFacetClicked({params:{filter:"my-avatars"}})}),gs(this,"onCopyScene",()=>{this.handleFacetClicked({params:{filter:"my-scenes"}})}),gs(this,"onShowSimilar",(e,t)=>{this.handleFacetClicked({params:{similar_to:e,similar_name:t}})}),gs(this,"selectEntry",e=>{this.props.onMediaSearchResultEntrySelected&&(this.props.onMediaSearchResultEntrySelected(e,this.state.selectAction),this.close())}),gs(this,"handleSourceClicked",e=>{this.props.mediaSearchStore.sourceNavigate(e)}),gs(this,"handleFacetClicked",e=>{this.setState({query:""},()=>{const t=this.getSearchClearedSearchParams(!0,!0,!0);for(const[i,n]of Object.entries(e.params))t.set(i,n);Object(en.d)(this.props.history,this.props.history.location.pathname,t.toString())})}),gs(this,"getSearchClearedSearchParams",(e,t,i)=>this.props.mediaSearchStore.getSearchClearedSearchParams(this.props.history.location,e,t,i)),gs(this,"pushExitMediaBrowserHistory",(e=!0)=>{this.props.mediaSearchStore.pushExitMediaBrowserHistory(this.props.history,e)}),gs(this,"showCustomMediaDialog",e=>{const t="scenes"===e,i="avatars"===e;this.pushExitMediaBrowserHistory(!i);const n=t?"change_scene":i?"avatar_url":"create";Object(en.e)(this.props.history,"modal",n)}),gs(this,"close",()=>{Object($t.b)();const e=this.getUrlSource(new URLSearchParams(this.props.history.location.search));this.pushExitMediaBrowserHistory("avatars"!==e&&"favorites"!==e),this.state.clearStashedQueryOnClose&&this.props.mediaSearchStore.clearStashedQuery()}),gs(this,"handlePager",e=>{this.setState({result:null}),this.props.mediaSearchStore.pageNavigate(e),this.browserDiv.scrollTop=0}),this.state=this.getStoreAndHistoryState(e),this.props.mediaSearchStore.addEventListener("statechanged",this.storeUpdated),this.props.mediaSearchStore.addEventListener("sourcechanged",this.sourceChanged)}componentDidMount(){}componentWillUnmount(){this.props.mediaSearchStore.removeEventListener("statechanged",this.storeUpdated),this.props.mediaSearchStore.removeEventListener("sourcechanged",this.sourceChanged)}render(){const{formatMessage:e}=this.props.intl,t=new URLSearchParams(this.props.history.location.search),i=this.getUrlSource(t),a="scenes"===i,s=!("favorites"===i)&&(!a||this.props.hubChannel.canOrWillIfCreator("update_hub")),o=this.state.result&&this.state.result.entries||[],r="favorites"===i,l="avatars"!==i&&"scenes"!==i,c=this.state.facets&&this.state.facets.length>0&&this.state.facets;if(this.state.selectNextResult)return Xi.a.createElement("div",null);const d=e=>{"avatars"===e?this.showCustomMediaDialog(e):this.props.performConditionalSignIn(()=>!a||this.props.hubChannel.can("update_hub"),()=>this.showCustomMediaDialog(e),"change-scene")},h=t.get("filter")||t.get("similar_to")&&"similar"||!t.get("q")&&"",u=this.state.result&&this.state.result.meta,p=!(!u||!u.next_cursor),m=t.get("cursor"),g=u&&u.page||0,f=u&&u.source||null,v=["bing_images","tenor"].includes(f);return Xi.a.createElement("div",{className:us.a.mediaBrowser,ref:e=>this.browserDiv=e},Xi.a.createElement("div",{className:xn()([us.a.box,us.a.darkened])},Xi.a.createElement("div",{className:xn()(us.a.header,{[us.a.noSearch]:r})},Xi.a.createElement("div",{className:us.a.headerLeft},Xi.a.createElement("button",{onClick:()=>this.close()},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Ja.faTimes})))),Xi.a.createElement("div",{className:us.a.headerCenter},"favorites"===i&&Xi.a.createElement("div",{className:us.a.favoritesHeader},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:ls.faStar})),Xi.a.createElement(kn.a,{id:"media-browser.favorites-header"})),!r&&Xi.a.createElement("div",{className:us.a.search},Xi.a.createElement("i",{className:us.a.searchIcon},Xi.a.createElement(qa.a,{icon:rs.faSearch})),Xi.a.createElement("input",{type:"text",autoFocus:!fs&&!vs,ref:e=>this.inputRef=e,placeholder:e({id:`media-browser.search-placeholder.${i}`}),onFocus:e=>Object(Qa.b)(e.target),onBlur:()=>Object(Qa.a)(),onKeyDown:e=>{"Enter"===e.key&&e.ctrlKey?o.length>0&&!this._sendQueryTimeout?this.handleEntryClicked(e,o[0]):""!==this.state.query.trim()?(this.handleQueryUpdated(this.state.query,!0),this.setState({selectNextResult:!0})):this.close():("Escape"===e.key||"Enter"===e.key&&fs)&&e.target.blur()},value:this.state.query,onChange:e=>this.handleQueryUpdated(e.target.value)}),Xi.a.createElement("i",{className:us.a.searchClear,onClick:()=>this.handleQueryUpdated("",!0)},Xi.a.createElement(qa.a,{icon:Ja.faTimes}))),Xi.a.createElement("div",{className:us.a.engineAttribution},!r&&"scenes"!==i&&"avatars"!==i&&"favorites"!==i&&Xi.a.createElement("div",{className:us.a.engineAttributionContents},Xi.a.createElement(kn.a,{id:`media-browser.powered_by.${i}`}),bs[i]&&Xi.a.createElement("a",{href:bs[i],target:"_blank",rel:"noreferrer noopener"},Xi.a.createElement(kn.a,{id:"media-browser.privacy_policy"}))),"scenes"===i&&Xi.a.createElement("div",{className:us.a.engineAttributionContents},Xi.a.createElement(Mn.a,{name:"enable_spoke"},Xi.a.createElement(kn.a,{id:`media-browser.powered_by.${i}`}),Xi.a.createElement("a",{href:"/spoke",target:"_blank",rel:"noreferrer noopener"},Xi.a.createElement(kn.a,{id:"editor-name"}))),n.a.feature("enable_spoke")&&n.a.feature("show_issue_report_link")&&"|",Xi.a.createElement(Mn.a,{name:"show_issue_report_link"},Xi.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:n.a.link("issue_report","/#/report")},Xi.a.createElement(kn.a,{id:"media-browser.report_issue"})))))),Xi.a.createElement("div",{className:us.a.headerRight},s&&Xi.a.createElement("a",{onClick:()=>d(i),className:us.a.createButton},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:["scenes","avatars"].includes(i)?ds.faLink:cs.faCloudUploadAlt}))),s&&Xi.a.createElement("a",{onClick:()=>d(i),className:us.a.createLink},Xi.a.createElement(kn.a,{id:`media-browser.add_custom_${this.state.result&&a?"scene":"avatars"===i?"avatar":"object"}`})))),this.state.showNav&&Xi.a.createElement("div",{className:us.a.nav},ps.a.map(e=>Xi.a.createElement("a",{onClick:()=>this.handleSourceClicked(e),key:e,className:xn()({[us.a.navSource]:!0,[us.a.navSourceSelected]:i===e})},Xi.a.createElement(kn.a,{id:`media-browser.nav_title.${e}`}))),Xi.a.createElement("div",{className:us.a.navRightPad},""),Xi.a.createElement("div",{className:us.a.navScrollArrow},Xi.a.createElement(qa.a,{icon:os.faAngleRight}))),(c||"similar"===h)&&Xi.a.createElement("div",{className:us.a.facets},c&&c.map((e,t)=>Xi.a.createElement("a",{onClick:()=>this.handleFacetClicked(e),key:t,className:xn()(us.a.facet,{selected:e.params.filter===h})},e.text)),"similar"===h&&Xi.a.createElement("a",{className:xn()(us.a.facet,"selected")},Xi.a.createElement(kn.a,{id:"media-browser.similar-to-facet",values:{name:t.get("similar_name")}}))),this.props.mediaSearchStore.isFetching||this._sendQueryTimeout||o.length>0||!l?Xi.a.createElement(ms.a,{entries:o,hasNext:p,hasPrevious:m,page:g,isVariableWidth:v,history:this.props.history,urlSource:i,handleEntryClicked:this.handleEntryClicked,onCopyAvatar:this.onCopyAvatar,onCopyScene:this.onCopyScene,onShowSimilar:this.onShowSimilar,handlePager:this.handlePager}):Xi.a.createElement("div",{className:us.a.emptyString},Xi.a.createElement(kn.a,{id:`media-browser.empty.${i}`}))))}}gs(_s,"propTypes",{mediaSearchStore:wn.a.object,history:wn.a.object,intl:wn.a.object,hubChannel:wn.a.object,onMediaSearchResultEntrySelected:wn.a.func,performConditionalSignIn:wn.a.func});var ws=Object(kn.d)(_s),Es=i(518),xs=i(382),Ss=i.n(xs),Cs=i(118),ks=i.n(Cs),As=i(75),Ts=i.n(As);function Ms(){return(Ms=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function Ls(e,t){if(null==e)return{};var i,n,a=function(e,t){if(null==e)return{};var i,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)i=s[n],t.indexOf(i)>=0||(a[i]=e[i]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)i=s[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function Rs(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Ps={"giphy.com":Ss.a,"media.giphy.com":Ss.a},Ds=AFRAME.utils.device.isMobile()||AFRAME.utils.device.isMobileVR(),Os="Paste a URL to an image, video, model, scene, or upload.",Hs=`Tip: You can paste URLs directly into ${ba.b["app-name"]} with Ctrl+V`,js=Xi.a.createElement("span",null,"For models, try"," ",Xi.a.createElement("a",{href:"https://sketchfab.com/search?features=downloadable&type=models",target:"_blank",rel:"noopener noreferrer"},"Sketchfab")," ","and"," ",Xi.a.createElement("a",{href:"http://poly.google.com/",target:"_blank",rel:"noopener noreferrer"},"Google Poly"),Xi.a.createElement(Mn.a,{name:"show_model_collection_link"},", or our"," ",Xi.a.createElement("a",{href:n.a.link("model_collection","https://sketchfab.com/mozillareality"),target:"_blank",rel:"noopener noreferrer"},"collection")),"."),Is=Xi.a.createElement("div",null,Xi.a.createElement("p",null,Os),Xi.a.createElement("p",null,js)),Ns=Xi.a.createElement("div",null,Xi.a.createElement("p",null,Os),Xi.a.createElement("p",null,js),Xi.a.createElement("p",null,Hs));let Fs="";const Vs="file-input";class Bs extends Yi.Component{constructor(...e){super(...e),Rs(this,"state",{url:"",file:null,fileName:""}),Rs(this,"onUrlChange",e=>{let t=this.state.attributionImage;if(e.target&&e.target.value&&e.target.validity.valid){const i=new URL(e.target.value);t=Ps[i.hostname]}this.setState({url:e.target&&e.target.value,attributionImage:t})}),Rs(this,"onFileChange",e=>{this.setState({file:e.target.files[0],fileName:e.target.files[0].name})}),Rs(this,"reset",e=>{e.preventDefault(),this.setState({url:"",file:null,fileName:""}),this.fileInput.value=null}),Rs(this,"onCreateClicked",e=>{e.preventDefault(),this.props.onCreate(this.state.file||this.state.url||Object(Ne.a)(location.href,Ts.a)),this.props.onClose()})}componentDidMount(){this.setState({url:Fs})}componentWillUnmount(){Fs=this.state.url}render(){const e=this.props,{onCreate:t,onClose:i}=e,n=Ls(e,["onCreate","onClose"]),a=Xi.a.createElement(Xn.b,null,Xi.a.createElement("label",{className:xn()(ks.a.smallButton,ks.a.cancelIcon),onClick:this.reset},Xi.a.createElement(qa.a,{icon:Ja.faTimes}))),s=Xi.a.createElement(Xn.b,null,Xi.a.createElement("label",{htmlFor:Vs,className:xn()(ks.a.smallButton,ks.a.uploadIcon)},Xi.a.createElement(qa.a,{icon:Es.faPaperclip}))),o=Xi.a.createElement("label",{className:xn()(ks.a.leftSideOfInput)},this.state.fileName),r=Xi.a.createElement("input",{className:xn()(ks.a.leftSideOfInput),placeholder:"Image/Video/glTF URL",onFocus:e=>Object(Qa.b)(e.target),onBlur:()=>Object(Qa.a)(),onChange:this.onUrlChange,type:"url",value:this.state.url});return Xi.a.createElement(oa.a,Ms({title:"Create Object",onClose:this.props.onClose},n),Xi.a.createElement("div",null,Ds?Is:Ns,Xi.a.createElement("form",{onSubmit:this.onCreateClicked},Xi.a.createElement("div",{className:ks.a.addMediaForm},Xi.a.createElement("input",{id:Vs,ref:e=>this.fileInput=e,className:ks.a.hideFileInput,type:"file",onChange:this.onFileChange}),Xi.a.createElement("div",{className:ks.a.inputBorder},this.state.file?o:r,this.state.url||this.state.fileName?a:s),Xi.a.createElement("div",{className:ks.a.buttons},Xi.a.createElement(Xn.b,null,Xi.a.createElement("button",{className:ks.a.actionButton},Xi.a.createElement("span",null,"Create")))),this.state.attributionImage?Xi.a.createElement("div",null,Xi.a.createElement("img",{src:this.state.attributionImage})):null))))}}Rs(Bs,"propTypes",{onCreate:wn.a.func,onClose:wn.a.func});var zs=i(177),Us=i.n(zs),Ws=i(151);function Zs(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function Gs(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){Zs(s,n,a,o,r,"next",e)}function r(e){Zs(s,n,a,o,r,"throw",e)}o(void 0)})}}function qs(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class $s extends Yi.Component{constructor(e){var t;super(e),t=this,qs(this,"state",{url:"",submitting:!1}),qs(this,"onUrlChange",e=>{const t=e.target,i=t.value;this.setState({url:i}),t.setCustomValidity(""),this.urlValidationPromise=new Promise(function(){var e=Gs(function*(e){t.setCustomValidity((yield Object(Ws.b)(i.trim()))?"":ba.b["invalid-scene-url"]),e()});return function(t){return e.apply(this,arguments)}}())}),qs(this,"reset",e=>{e.preventDefault(),this.setState({url:""})}),qs(this,"onSubmit",function(){var e=Gs(function*(e){e.preventDefault(),t.setState({submitting:!0});const i=e.target;t.state.url&&(yield t.urlValidationPromise,i.checkValidity()?(t.props.onChange(t.state.url.trim()),t.props.onClose()):(i.reportValidity(),t.setState({submitting:!1})))});return function(t){return e.apply(this,arguments)}}()),this.urlValidationPromise=null}render(){const{onChange:e,onClose:t}=this.props;return Xi.a.createElement(oa.a,{title:"Custom Scene",onClose:this.props.onClose},Xi.a.createElement("div",null,Xi.a.createElement("div",null,Xi.a.createElement("p",null,"Paste a URL to a"," ",Xi.a.createElement(Mn.a,{name:"enable_spoke"},Xi.a.createElement("a",{href:"/spoke",target:"_blank",rel:"noopener noreferrer"},Xi.a.createElement(kn.a,{id:"editor-name"}))," "),"scene or a URL to a"," ",Xi.a.createElement("a",{href:"https://en.wikipedia.org/wiki/GlTF#GLB",target:"_blank",rel:"noopener noreferrer"},"GLB"),".")),Xi.a.createElement("form",{onSubmit:this.onSubmit},Xi.a.createElement("div",{className:Us.a.changeSceneForm},Xi.a.createElement("div",{className:Us.a.inputBorder},Xi.a.createElement("input",{className:xn()(Us.a.leftSideOfInput),placeholder:"Scene URL",onFocus:e=>Object(Qa.b)(e.target),onBlur:()=>Object(Qa.a)(),onChange:this.onUrlChange,type:"url",value:this.state.url})),Xi.a.createElement("div",{className:Us.a.buttons},Xi.a.createElement("button",{className:Us.a.actionButton,disabled:this.state.submitting},Xi.a.createElement(kn.a,{id:"change-scene-dialog.change-scene"}))),Xi.a.createElement(Mn.a,{name:"enable_spoke"},Xi.a.createElement("div",{className:Us.a.spokeCreate},Xi.a.createElement("div",null,Xi.a.createElement(kn.a,{id:"change-scene-dialog.create-in-spoke"})),Xi.a.createElement("a",{className:Us.a.spokeLaunch,href:"/spoke/new",target:"_blank",rel:"noopener noreferrer"},Xi.a.createElement(kn.a,{id:"change-scene-dialog.new-spoke-project"}))))))))}}qs($s,"propTypes",{onChange:wn.a.func,onClose:wn.a.func});var Ys=i(519),Xs=i.n(Ys);function Qs(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Ks extends Yi.Component{constructor(...e){super(...e),Qs(this,"state",{url:""}),Qs(this,"onUrlChange",e=>{this.setState({url:e.target&&e.target.value})}),Qs(this,"onChangeClicked",e=>{e.preventDefault(),this.state.url&&this.props.onChange(this.state.url),this.props.onClose()})}render(){return Xi.a.createElement(oa.a,{title:"Custom Avatar URL",className:Xs.a.avatarUrlDialog,onClose:this.props.onClose},Xi.a.createElement("p",null,"Paste a URL to a"," ",Xi.a.createElement("a",{href:"https://en.wikipedia.org/wiki/GlTF#GLB",target:"_blank",rel:"noopener noreferrer"},"GLB"),"."),Xi.a.createElement("form",{className:"form",onSubmit:this.onChangeClicked},Xi.a.createElement("input",{className:"url-field",placeholder:"Avatar GLB URL",onFocus:e=>Object(Qa.b)(e.target),onBlur:()=>Object(Qa.a)(),onChange:this.onUrlChange,type:"url",value:this.state.url}),Xi.a.createElement("button",{className:"submit"},Xi.a.createElement(kn.a,{id:"avatar-url-dialog.apply"}))))}}function Js(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Qs(Ks,"propTypes",{onChange:wn.a.func,onClose:wn.a.func});class eo extends Yi.Component{constructor(...e){super(...e),Js(this,"state",{copyButtonActive:!1,shareButtonActive:!1}),Js(this,"shareClicked",e=>{this.setState({shareButtonActive:!0}),Vn({url:e,title:`Join me now in ${ba.b["share-hashtag"]}!`}).then(()=>{this.setState({shareButtonActive:!1})})}),Js(this,"copyClicked",e=>{this.setState({copyButtonActive:!0}),setTimeout(()=>this.setState({copyButtonActive:!1}),5e3),Cn()(e)})}render(){const{entryCode:e,embedUrl:t}=this.props,i=function(e,t){let i=`${e}`;for(;i.length<t;)i=`0${i}`;return i}(e,6),a=`${n.a.SHORTLINK_DOMAIN}/${this.props.hubId}`,s="https://"+a,o=`<iframe src="${t}" style="width: 1024px; height: 768px;" allow="microphone; camera; vr; speaker;"></iframe>`;return Xi.a.createElement("div",{className:xn()({[Yn.a.dialog]:!0,[Yn.a.modal]:this.props.isModal})},!this.props.isModal&&Xi.a.createElement("div",{className:Yn.a.attachPoint}),Xi.a.createElement("div",null,Xi.a.createElement(kn.a,{id:`invite.or_visit${this.props.isModal?"_modal":""}`})),Xi.a.createElement("div",{className:Yn.a.domain},Xi.a.createElement("input",{type:"text",readOnly:!0,onFocus:e=>e.target.select(),value:a})),Xi.a.createElement("div",{className:Yn.a.buttons},Xi.a.createElement(Xn.b,null,Xi.a.createElement("button",{className:Yn.a.linkButton,onClick:this.copyClicked.bind(this,s)},Xi.a.createElement("span",null,this.state.copyButtonActive?"copied!":"copy"))),this.props.allowShare&&Fn()&&Xi.a.createElement(Xn.b,null,Xi.a.createElement("button",{className:Yn.a.linkButton,onClick:this.shareClicked.bind(this,s)},Xi.a.createElement("span",null,this.state.shareButtonActive?"sharing...":"share"))),this.props.allowShare&&!Fn()&&Xi.a.createElement(Xn.b,null,Xi.a.createElement("button",{className:Yn.a.linkButton,onClick:this.shareClicked.bind(this,s)},Xi.a.createElement(kn.a,{id:"invite.tweet"})))),Xi.a.createElement(Xn.b,null,Xi.a.createElement("button",{className:Yn.a.close,onClick:()=>this.props.onClose()},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Ja.faTimes})))),Xi.a.createElement("div",{className:Yn.a.linkCode},Xi.a.createElement(kn.a,{id:`invite.enter_via${this.props.isModal?"_modal":""}`}),Xi.a.createElement("a",{href:`https://${n.a.SHORTLINK_DOMAIN}`,target:"_blank",className:Yn.a.hubLinkLink,rel:"noopener noreferrer"},n.a.SHORTLINK_DOMAIN),Xi.a.createElement(kn.a,{id:"invite.and_enter_code"})),Xi.a.createElement("div",{className:Yn.a.code},i.split("").map((e,t)=>Xi.a.createElement("div",{className:xn()({[Yn.a.digit]:!0,[Yn.a[`digit_${t}`]]:!0}),key:`link_code_${t}`},e))),Xi.a.createElement("div",{className:Yn.a.codeDuration},Xi.a.createElement(kn.a,{id:"invite.duration_of_code"})),t&&Xi.a.createElement("div",{className:Yn.a.embed},Xi.a.createElement("div",null,Xi.a.createElement(kn.a,{id:"invite.embed"})),Xi.a.createElement("div",{className:Yn.a.embedText},Xi.a.createElement("input",{type:"text",readOnly:!0,onFocus:e=>{e.target.select(),this.setState({showEmbedTip:!0})},onBlur:()=>this.setState({showEmbedTip:!1}),value:o})),this.state.showEmbedTip&&Xi.a.createElement("div",{className:Yn.a.embedTipWrap},Xi.a.createElement("div",{className:Yn.a.embedTip},Xi.a.createElement("div",{className:Yn.a.embedTipAttachPoint}),Xi.a.createElement(kn.a,{id:"invite.embed-tip"})))),this.props.hasPush&&Xi.a.createElement("div",{className:Yn.a.subscribe},Xi.a.createElement("input",{id:"subscribe",type:"checkbox",onChange:()=>this.props.onSubscribeChanged(),checked:this.props.isSubscribed}),Xi.a.createElement("label",{htmlFor:"subscribe"},Xi.a.createElement(kn.a,{id:"entry.notify_me"}))),this.props.isModal&&Xi.a.createElement("button",{className:Yn.a.enterVrButton,onClick:()=>this.props.onClose()},Xi.a.createElement(kn.a,{id:"entry.return-to-vr"})))}}function to(){return(to=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function io(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Js(eo,"propTypes",{entryCode:wn.a.number,hubId:wn.a.string,allowShare:wn.a.bool,isModal:wn.a.bool,onClose:wn.a.func,hasPush:wn.a.bool,isSubscribed:wn.a.bool,onSubscribeChanged:wn.a.func,embedUrl:wn.a.string});class no extends Yi.Component{constructor(e){super(e),io(this,"state",{inviteButtonText:"invite a hubs team member"}),io(this,"inviteClicked",()=>{this.setState({inviteButtonText:"OK! We'll be there shortly."}),this.props.hubChannel.requestSupport()})}render(){return Xi.a.createElement(oa.a,to({title:"Let's Chat!"},this.props),Xi.a.createElement("div",null,Xi.a.createElement("div",null,Xi.a.createElement("p",null,"Have an idea for Hubs? Having trouble?"),Xi.a.createElement("p",null,"We'd love to chat. Someone from our team will join you in just a few minutes.")),Xi.a.createElement("div",{className:"invite-team-form"},Xi.a.createElement("div",{className:"invite-team-form__buttons"},Xi.a.createElement(Xn.b,null,Xi.a.createElement("button",{className:"invite-team-form__action-button",onClick:this.inviteClicked},Xi.a.createElement("span",null,this.state.inviteButtonText)))))))}}io(no,"propTypes",{hubChannel:wn.a.object});var ao=i(520),so=i.n(ao),oo=i(119),ro=i.n(oo);class lo extends Yi.Component{render(){const{linkCode:e}=this.props;return Xi.a.createElement("div",{className:ro.a.dialog},Xi.a.createElement(Xn.b,null,Xi.a.createElement("div",{className:ro.a.close,onClick:()=>this.props.onClose()},Xi.a.createElement("span",null,""))),Xi.a.createElement("div",null,!e&&Xi.a.createElement("div",null,Xi.a.createElement("div",{className:xn()("loading-panel",ro.a.codeLoadingPanel)},Xi.a.createElement("div",{className:"loader-wrap"},Xi.a.createElement("div",{className:"loader"},Xi.a.createElement("div",{className:"loader-center"}))))),e&&Xi.a.createElement("div",{className:ro.a.contents},Xi.a.createElement("img",{className:ro.a.imageHeader,src:so.a}),Xi.a.createElement("div",{className:ro.a.header},Xi.a.createElement(kn.a,{id:"link.connect_headset"})),Xi.a.createElement("div",null,Xi.a.createElement(kn.a,{id:"link.in_your_browser"})),Xi.a.createElement("a",{href:`https://${n.a.SHORTLINK_DOMAIN}`,className:ro.a.domain,target:"_blank",rel:"noopener noreferrer"},n.a.SHORTLINK_DOMAIN),Xi.a.createElement("div",null,Xi.a.createElement(kn.a,{id:"link.enter_code"})),e&&Xi.a.createElement("div",{className:ro.a.code},e.split("").map((e,t)=>Xi.a.createElement("span",{className:ro.a.digit,key:`link_code_${t}`},e))),Xi.a.createElement("div",{className:ro.a.keepOpen},Xi.a.createElement(kn.a,{id:"link.do_not_close"})),Xi.a.createElement(Xn.b,null,Xi.a.createElement("button",{className:ro.a.closeButton,onClick:()=>this.props.onClose()},Xi.a.createElement(kn.a,{id:"link.cancel"}))))))}}function co(){return(co=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function ho(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}!function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(lo,"propTypes",{linkCode:wn.a.string,onClose:wn.a.func});class uo extends Yi.Component{constructor(...e){super(...e),ho(this,"state",{copyLinkButtonText:"copy"}),ho(this,"copyLinkClicked",e=>{Cn()(e),this.setState({copyLinkButtonText:"copied!"})})}render(){const e=this.copyLinkClicked.bind(this,document.location);return Xi.a.createElement(oa.a,co({title:"Open in Safari"},this.props),Xi.a.createElement("div",null,Xi.a.createElement("div",null,ba.b["app-name"]," does not support your current browser on iOS. Copy and paste this link directly in Safari."),Xi.a.createElement("div",{className:"invite-form"},Xi.a.createElement("input",{type:"text",readOnly:!0,onFocus:e=>e.target.select(),value:document.location,className:"invite-form__link_field"}),Xi.a.createElement("div",{className:"invite-form__buttons"},Xi.a.createElement(Xn.b,null,Xi.a.createElement("button",{className:"invite-form__action-button",onClick:e},Xi.a.createElement("span",null,this.state.copyLinkButtonText)))))))}}var po=i(140),mo=i(101),go=i.n(mo);function fo(){return(fo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function vo(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),n.forEach(function(t){bo(e,t,i[t])})}return e}function bo(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class yo extends Yi.Component{constructor(e){super(e),bo(this,"onSubmit",e=>{e.preventDefault(),e.stopPropagation(),this.props.onChange(this.state),this.props.onClose()}),bo(this,"onRoomAccessSettingsChange",e=>this.setState({allow_promotion:"public"===e.target.value})),this.state=e.initialSettings}renderCheckbox(e,t,i){return Xi.a.createElement("label",{className:xn()(go.a.permission,{[go.a.permissionDisabled]:t}),key:e},Xi.a.createElement("input",{type:"checkbox",checked:this.state.member_permissions[e],disabled:t,onChange:i||(t=>this.setState({member_permissions:vo({},this.state.member_permissions,{[e]:t.target.checked})}))}),Xi.a.createElement(kn.a,{id:`room-settings.${e}`}))}render(){const{showRoomAccessSettings:e}=this.props;return Xi.a.createElement(oa.a,fo({title:"Room Settings"},this.props),Xi.a.createElement("form",{onSubmit:this.onSubmit,className:go.a.roomSettingsForm},Xi.a.createElement("span",{className:go.a.subtitle},Xi.a.createElement(kn.a,{id:"room-settings.name-subtitle"})),Xi.a.createElement("input",{name:"name",type:"text",required:!0,autoComplete:"off",placeholder:"Room name",value:this.state.name,onFocus:e=>Object(Qa.b)(e.target),onBlur:()=>Object(Qa.a)(),onChange:e=>this.setState({name:e.target.value}),className:go.a.nameField}),Xi.a.createElement("span",{className:go.a.subtitle},Xi.a.createElement(kn.a,{id:"room-settings.description-subtitle"})),Xi.a.createElement("textarea",{name:"description",rows:"5",autoComplete:"off",placeholder:"Room description",value:this.state.description,onFocus:e=>Object(Qa.b)(e.target),onBlur:()=>Object(Qa.a)(),onChange:e=>this.setState({description:e.target.value}),className:go.a.descriptionField}),e&&Xi.a.createElement(Xi.a.Fragment,null,Xi.a.createElement("span",{className:go.a.subtitle},Xi.a.createElement(kn.a,{id:"room-settings.room-access-subtitle"})),Xi.a.createElement("div",{className:go.a.selectContainer},Xi.a.createElement("label",null,Xi.a.createElement("input",{type:"radio",value:"private",checked:!this.state.allow_promotion,onChange:this.onRoomAccessSettingsChange}),Xi.a.createElement("div",null,Xi.a.createElement(kn.a,{id:"room-settings.access-private"}),Xi.a.createElement("span",null,Xi.a.createElement(kn.a,{id:"room-settings.access-private-subtitle"})))),Xi.a.createElement("label",null,Xi.a.createElement("input",{type:"radio",value:"public",checked:this.state.allow_promotion,onChange:this.onRoomAccessSettingsChange}),Xi.a.createElement("div",null,Xi.a.createElement(kn.a,{id:"room-settings.access-public"}),Xi.a.createElement("span",null,Xi.a.createElement(kn.a,{id:"room-settings.access-public-subtitle"})))))),Xi.a.createElement("span",{className:go.a.subtitle},Xi.a.createElement(kn.a,{id:"room-settings.permissions-subtitle"})),Xi.a.createElement("div",{className:go.a.permissions},this.renderCheckbox("spawn_and_move_media",!1,e=>{const t={spawn_and_move_media:e.target.checked};e.target.checked||(t.spawn_camera=!1,t.pin_objects=!1),this.setState({member_permissions:vo({},this.state.member_permissions,t)})}),Xi.a.createElement("div",{className:go.a.permissionsGroup},this.renderCheckbox("spawn_camera",!this.state.member_permissions.spawn_and_move_media),this.renderCheckbox("pin_objects",!this.state.member_permissions.spawn_and_move_media)),this.renderCheckbox("spawn_drawing")),Xi.a.createElement("button",{type:"submit",className:go.a.nextButton},Xi.a.createElement(kn.a,{id:"room-settings.apply"}))))}}bo(yo,"propTypes",{initialSettings:wn.a.object,onChange:wn.a.func,onClose:wn.a.func,showRoomAccessSettings:wn.a.bool});var _o=i(303),wo=i.n(_o);function Eo(){return(Eo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}class xo extends Yi.Component{render(){return Xi.a.createElement(oa.a,Eo({title:"Close Room"},this.props),Xi.a.createElement("div",{className:wo.a.message},Xi.a.createElement(kn.a,{id:"close-room.message"})),Xi.a.createElement("button",{className:wo.a.confirmButton,onClick:()=>{this.props.onConfirm(),this.props.onClose()}},Xi.a.createElement(kn.a,{id:"close-room.confirm"})),Xi.a.createElement("button",{className:wo.a.cancelButton,onClick:()=>this.props.onClose()},Xi.a.createElement(kn.a,{id:"close-room.cancel"})))}}!function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(xo,"propTypes",{onConfirm:wn.a.func,onClose:wn.a.func});var So=i(107),Co=i.n(So);const ko=["feedback","invite","object_pin"],Ao=["freeze_gesture","menu_hover","feedback"];let To=null,Mo={};const Lo=AFRAME.utils.device.isMobile(),Ro=AFRAME.utils.device.isMobileVR(),Po=()=>Ro?"standalone":Lo?"mobile":"desktop",Do={desktop:{top:["pen_mode","video_share_mode","mute_mode"],bottom:["look","locomotion","turning","spawn_menu","object_grab","object_zoom","object_scale","freeze_gesture","menu_hover","object_rotate_button","object_scale_button","object_pin","invite","pen_color","pen_size","feedback"]},mobile:{top:["pen_mode","video_share_mode","freeze_mode","mute_mode"],bottom:["look","locomotion","spawn_menu","object_grab","freeze_gesture","object_rotate_button","object_scale_button","object_pin","invite","feedback"]},standalone:{top:[],bottom:[]}}[Po()],Oo=e=>(null===To&&(To=JSON.parse(localStorage.getItem("__hubs_finished_tips"))),!(!To[e]||!To[e].finished)),Ho=e=>{const t=JSON.parse(localStorage.getItem("__hubs_finished_tips"));t[e]={finished:!0},localStorage.setItem("__hubs_finished_tips",JSON.stringify(t)),To=null},jo=(e,t)=>{const i=e.split(".")[1],n=ko.includes(i)?[i]:Do[t];for(let e=0;e<n.length;e++){const t=n[e];Ao.includes(t)&&t!==i||Ho(t)}},Io=()=>{localStorage.setItem("__hubs_finished_tips",JSON.stringify({})),To=null,window.APP.store.resetTipActivityFlags(),window.APP.store.resetConfirmedBroadcastedRooms(),Mo={}},No={look:function(e){if(e.activeSets.includes(Gi.rightCursorHoldingPen)||e.activeSets.includes(Gi.leftCursorHoldingPen))return 0;return e.get(Lo?ce.a.device.touchscreen.touchCameraDelta:ce.a.device.smartMouse.cameraDelta)?2:1},locomotion:function(e){if(e.activeSets.includes(Gi.rightCursorHoldingPen)||e.activeSets.includes(Gi.leftCursorHoldingPen))return 0;const t=e.get(ce.a.actions.characterAcceleration);return!t||0===t[0]&&0===t[1]?1:2},turning:function(e){return e.activeSets.includes(Gi.rightCursorHoldingPen)||e.activeSets.includes(Gi.leftCursorHoldingPen)?0:e.get(ce.a.actions.snapRotateLeft)||e.get(ce.a.actions.snapRotateRight)?2:1},spawn_menu:function(e,t,i){return e.activeSets.includes(Gi.rightCursorHoldingPen)||e.activeSets.includes(Gi.leftCursorHoldingPen)?0:0===i.count()?1:2},freeze_gesture:function(e,t,i){return 0===i.count()?0:e.activeSets.includes(Gi.rightCursorHoldingInteractable)?0:e.activeSets.includes(Gi.rightCursorHoldingPen)?0:e.activeSets.includes(Gi.leftCursorHoldingInteractable)?0:e.activeSets.includes(Gi.leftCursorHoldingPen)?0:t.is("frozen")&&(e.activeSets.includes(Gi.rightCursorHoveringOnInteractable)||e.activeSets.includes(Gi.leftCursorHoveringOnInteractable))?2:t.is("frozen")?0:1},menu_hover:function(e,t,i){return 0===i.count()?0:t.is("frozen")?e.activeSets.includes(Gi.rightCursorHoldingPen)?0:e.activeSets.includes(Gi.leftCursorHoldingPen)?0:t.is("frozen")&&(e.activeSets.includes(Gi.rightCursorHoveringOnInteractable)||e.activeSets.includes(Gi.leftCursorHoveringOnInteractable))?2:1:0},invite:function(e,t){return e.activeSets.includes(Gi.rightCursorHoldingPen)?0:e.activeSets.includes(Gi.rightCursorHoldingCamera)?0:e.activeSets.includes(Gi.rightCursorHoldingInteractable)?0:e.activeSets.includes(Gi.leftCursorHoldingPen)?0:e.activeSets.includes(Gi.leftCursorHoldingCamera)?0:e.activeSets.includes(Gi.leftCursorHoldingInteractable)?0:t.is("copresent")?2:1},object_grab:function(e,t,i){return t.is("frozen")?0:0===i.count()?0:e.activeSets.includes(Gi.rightCursorHoldingPen)?0:e.activeSets.includes(Gi.rightCursorHoldingCamera)?0:e.activeSets.includes(Gi.rightCursorHoldingInteractable)?2:e.activeSets.includes(Gi.leftCursorHoldingPen)?0:e.activeSets.includes(Gi.leftCursorHoldingCamera)?0:e.activeSets.includes(Gi.leftCursorHoldingInteractable)?2:1},object_rotate_button:function(e,t,i,n){return t.is("frozen")?0===i.count()?0:n&&n.state.activity.hasRotated?2:1:0},object_scale_button:function(e,t,i,n){return t.is("frozen")?0===i.count()?0:n&&n.state.activity.hasScaled?2:1:0},object_recenter_button:function(e,t,i,n){return t.is("frozen")?0===i.count()?0:n&&n.state.activity.hasRecentered?2:1:0},object_pin:function(e,t,i,n){return t.is("frozen")?0===i.count()?0:n&&n.state.activity.hasPinned?2:1:0},object_zoom:function(e,t){return t.is("frozen")?0:e.activeSets.includes(Gi.rightCursorHoldingPen)?0:e.activeSets.includes(Gi.rightCursorHoldingCamera)?0:e.activeSets.includes(Gi.rightCursorHoldingInteractable)||e.activeSets.includes(Gi.leftCursorHoldingInteractable)?e.activeSets.includes(Gi.leftCursorHoldingPen)?0:e.activeSets.includes(Gi.leftCursorHoldingCamera)?0:e.get(ce.a.actions.cursor.right.modDelta)?2:e.get(ce.a.actions.cursor.left.modDelta)?2:1:0},object_scale:function(e,t){return t.is("frozen")?0:e.activeSets.includes(Gi.rightCursorHoldingPen)?0:e.activeSets.includes(Gi.rightCursorHoldingCamera)?0:e.activeSets.includes(Gi.leftCursorHoldingPen)?0:e.activeSets.includes(Gi.leftCursorHoldingCamera)?0:e.activeSets.includes(Gi.rightCursorHoldingInteractable)||e.activeSets.includes(Gi.leftCursorHoldingInteractable)?e.get(ce.a.actions.cursor.right.scaleGrabbedGrabbable)||e.get(ce.a.actions.cursor.left.scaleGrabbedGrabbable)?2:1:0},pen_color:function(e){return e.activeSets.includes(Gi.rightCursorHoldingPen)||e.activeSets.includes(Gi.leftCursorHoldingPen)?e.get(ce.a.actions.cursor.right.penNextColor)||e.get(ce.a.actions.cursor.right.penPrevColor)?2:e.get(ce.a.actions.cursor.left.penNextColor)||e.get(ce.a.actions.cursor.left.penPrevColor)?2:1:0},pen_size:function(e){return e.activeSets.includes(Gi.rightCursorHoldingPen)||e.activeSets.includes(Gi.leftCursorHoldingPen)?e.get(ce.a.actions.cursor.right.scalePenTip)||e.get(ce.a.actions.cursor.left.scalePenTip)?2:1:0},pen_mode:function(e){return e.activeSets.includes(Gi.rightCursorHoldingPen)||e.activeSets.includes(Gi.leftCursorHoldingPen)?1:0},freeze_mode:function(e,t){return t.is("frozen")?1:0},video_share_mode:function(e,t){return t.is("sharing_video")?1:0},mute_mode:function(e,t){return t.is("muted")?1:0},feedback:function(){return 0}};AFRAME.registerSystem("tips",{init:function(){this.activeTips={},this._finishedScopes={},this._performStep=this._performStep.bind(this),null===localStorage.getItem("__hubs_finished_tips")&&localStorage.setItem("__hubs_finished_tips",JSON.stringify({}))},tick:function(){if(Ro)return;if(!this._userinput&&(this._userinput=this.el.systems.userinput,!this._userinput))return;if(!this._mediaCounter&&(this._mediaCounter=document.querySelector("#media-counter")&&document.querySelector("#media-counter").components["networked-counter"],!this._mediaCounter))return;const e=Do,t=this.activeTips.top,i=this.activeTips.bottom;this._performStep(e.top,"top"),this._performStep(e.bottom,"bottom"),t===this.activeTips.top&&i===this.activeTips.bottom||this.el.emit("tips_changed",this.activeTips)},_performStep:function(e,t){if(Mo[t])return;let i=null,n=0;for(let t=0;t<e.length;t++){const a=e[t];if(Oo(a))n++;else{switch(No[a](this._userinput,this.el,this._mediaCounter,window.APP.store)){case 2:Ho(a);break;case 1:i=`${Po()}.${a}`}if(i)break}}this.activeTips[t]=i,n===e.length&&(Mo[t]=!0)}});class Fo extends Yi.Component{render(){const{tip:e,tipRegion:t,broadcastTarget:i,pushHistoryState:n}=this.props,a=[Co.a.tipRoot];let s;return[".spawn_menu","_button"].find(t=>e.endsWith(t))?(a.push(Co.a.tourTipRoot),s=Xi.a.createElement("div",{className:Co.a.splitTip},Xi.a.createElement(kn.a,{id:`tips.${e}-pre`}),Xi.a.createElement("div",{className:xn()({[Co.a.splitTipIcon]:!0,[Co.a[e.split(".")[1]+"-icon"]]:!0})}),Xi.a.createElement(kn.a,{id:`tips.${e}-post`}))):"discord"===e?s=Xi.a.createElement("div",{className:Co.a.tip},Xi.a.createElement("span",null,`Chat in this room is being bridged to ${i} on Discord.`)):"embed"===e?s=Xi.a.createElement("div",{className:Co.a.tip},Xi.a.createElement(kn.a,{id:"embed.presence-warning"})):e.endsWith(".feedback")?s=Xi.a.createElement("div",{className:Co.a.tip},Xi.a.createElement(kn.a,{id:`tips.${e}`}),"",Xi.a.createElement("button",{className:Co.a.tipLink,onClick:()=>{jo(e,t),n("modal","feedback")}},Xi.a.createElement(kn.a,{id:`tips.${e}-link`}))):(a.push(Co.a.tourTipRoot),s=Xi.a.createElement("div",{className:Co.a.tip},Xi.a.createElement(kn.a,{id:`tips.${e}`}))),Xi.a.createElement("div",{className:xn()(a)},Xi.a.createElement("button",{className:Co.a.tipCancel,onClick:()=>this.props.onClose?this.props.onClose(e,t):jo(e,t)},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Ja.faTimes}))),s)}}function Vo(){return(Vo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}!function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(Fo,"propTypes",{history:wn.a.object,tip:wn.a.string,tipRegion:wn.a.string,broadcastTarget:wn.a.string,pushHistoryState:wn.a.func,onClose:wn.a.func});class Bo extends Yi.Component{render(){return Xi.a.createElement(oa.a,Vo({title:"Share Screen"},this.props),Xi.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},Xi.a.createElement("p",null,"Your browser doesn't seem to support screen sharing.",Xi.a.createElement("br",null),"To share your screen in $",ba.b["app-name"],", you can use Firefox."),Xi.a.createElement("a",{className:"info-dialog--action-button",target:"_blank",rel:"noreferrer noopener",href:"https://www.mozilla.org/firefox"},"Download Firefox"),Xi.a.createElement("p",{style:{fontSize:"0.8em"}},"You can try",Xi.a.createElement("a",{href:"https://www.webrtc-experiment.com/screen-sharing/#5591174797993739",target:"_blank",rel:"noopener noreferrer"},"testing WebRTC screen sharing"),"in your browser.")))}}function zo(){return(zo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}class Uo extends Yi.Component{render(){return Xi.a.createElement(oa.a,zo({title:"WebAssembly Unsupported"},this.props),Xi.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},Xi.a.createElement("p",null,"Your browser doesn't seem to support WebAssembly.",Xi.a.createElement("br",null),"Please update or switch to a newer browser.")))}}function Wo(){return(Wo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}class Zo extends Yi.Component{render(){return Xi.a.createElement(oa.a,Wo({title:"Enter in VR"},this.props),Xi.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},Xi.a.createElement("p",null,"To enter with Oculus or SteamVR, you can use Firefox."),Xi.a.createElement(Xn.b,null,Xi.a.createElement("a",{className:"info-dialog--action-button",href:"https://www.mozilla.org/firefox",target:"_blank",rel:"noreferrer noopener"},"Download Firefox")),Xi.a.createElement("p",{style:{fontSize:"0.8em"}},"For a list of browsers with experimental VR support, visit"," ",Xi.a.createElement(Xn.b,null,Xi.a.createElement("a",{href:"https://webvr.rocks",target:"_blank",rel:"noopener noreferrer"},"WebVR Rocks")))))}}var Go=i(521),qo=i.n(Go);function $o(){return($o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}class Yo extends Yi.Component{render(){return Xi.a.createElement(oa.a,$o({wide:!0,title:""},this.props),Xi.a.createElement("iframe",{className:qo.a.formFrame,src:"https://docs.google.com/forms/d/e/1FAIpQLSe1C-7hCA1XMT8IL8XBnjlxMAU1JXrwAW8YkbmbBJ4B3pDSsw/viewform?embedded=true",frameBorder:"0",marginHeight:"0",marginWidth:"0"},"Loading..."))}}var Xo=i(304),Qo=i.n(Xo);function Ko(){return(Ko=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}class Jo extends Yi.Component{render(){return Xi.a.createElement(oa.a,Ko({title:"Help"},this.props),Xi.a.createElement("div",{className:Qo.a.helpDialog},Xi.a.createElement("div",null,"To get started, you can take a tour."),Xi.a.createElement("div",null,"Or, you can"," ",Xi.a.createElement("a",{href:n.a.link("features",ba.b["help.docs_url"]),rel:"noreferrer noopener",target:"_blank"},"browse the documentation"),"."),Xi.a.createElement("button",{className:Qo.a.tourButton,onClick:e=>{e.preventDefault(),Io(),this.props.onClose()}},"Start Tour"),Xi.a.createElement("a",{className:Qo.a.docsLink,href:n.a.link("features",ba.b["help.docs_url"]),rel:"noreferrer noopener",target:"_blank"},"Browse Documentation")))}}!function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(Jo,"propTypes",{onClose:wn.a.func});var er=i(522),tr=i.n(er);function ir(){return(ir=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}class nr extends Yi.Component{render(){return Xi.a.createElement(oa.a,ir({title:"Leave Room"},this.props),Xi.a.createElement("div",{className:tr.a.leaveRoom},Xi.a.createElement("div",null,Xi.a.createElement(kn.a,{id:`leave-room-dialog.${this.props.messageType}.message`})),Xi.a.createElement("a",{href:this.props.destinationUrl,rel:"noopener noreferrer"},Xi.a.createElement(kn.a,{id:`leave-room-dialog.${this.props.messageType}.confirm`}))))}}!function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(nr,"propTypes",{messageType:wn.a.string,destinationUrl:wn.a.string});var ar=i(243),sr=i(523),or=i(524);const rr=0,lr=1,cr=2,dr=3,hr=4,ur=5;function pr(e){return e.components["media-video"]&&e.components["media-video"].data.contentType.startsWith("audio/")?lr:e.components["media-video"]?rr:e.components["media-image"]?cr:e.components["media-pdf"]?dr:e.components["gltf-model-plus"]?hr:ur}function mr(e,t){return pr(e)-pr(t)}function gr(){return(gr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function fr(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class vr extends Yi.Component{constructor(...e){super(...e),fr(this,"state",{enableLights:!1,mediaEntities:[]}),fr(this,"enqueueWaypointTravel",function(){const e=new THREE.Matrix4,t=new THREE.Matrix4;return function(){this.viewingCamera.object3D.updateMatrices(),e.copy(this.viewingCamera.object3D.matrixWorld),Object(Ae.a)(e,e),t.makeTranslation(0,-1.6,.15),e.multiply(t),Object(Ae.k)(e,Math.PI,e),this.props.scene.systems["hubs-systems"].characterController.enqueueWaypointTravelTo(e,!0,{willDisableMotion:!1,willDisableTeleporting:!1,snapToNavMesh:!1,willMaintainInitialOrientation:!1}),this.props.onClose()}}().bind(this))}componentDidMount(){this.updateMediaEntities=this.updateMediaEntities.bind(this),this.navigateNext=this.navigateNext.bind(this),this.navigatePrev=this.navigatePrev.bind(this),this.navigate=this.navigate.bind(this),this.viewingCamera=document.getElementById("viewing-camera"),this.pin=this.pin.bind(this),this.unpin=this.unpin.bind(this),this.props.scene.addEventListener("uninspect",this.props.onClose);const e=this.props.scene.systems["hubs-systems"].cameraSystem;this.setState({enableLights:e.enableLights}),this.updateMediaEntities(),this.props.scene.addEventListener("listed_media_changed",()=>this.updateMediaEntities())}updateMediaEntities(){const e=[...this.props.scene.systems["listed-media"].els];e.sort(mr),this.setState({mediaEntities:e})}pin(){(NAF.utils.isMine(this.props.el)||NAF.utils.takeOwnership(this.props.el))&&(this.props.el.setAttribute("pinnable","pinned",!0),this.props.el.emit("pinned",{el:this.props.el}),this.props.onPinChanged&&this.props.onPinChanged())}unpin(){(NAF.utils.isMine(this.props.el)||NAF.utils.takeOwnership(this.props.el))&&(this.props.el.setAttribute("pinnable","pinned",!1),this.props.el.emit("unpinned",{el:this.props.el}),this.props.onPinChanged&&this.props.onPinChanged())}toggleLights(){const e=this.props.scene.systems["hubs-systems"].cameraSystem;e.enableLights=!e.enableLights,localStorage.setItem("show-background-while-inspecting",e.enableLights.toString()),this.setState({enableLights:e.enableLights}),e.enableLights?e.showEverythingAsNormal():e.hideEverythingButThisObject(this.props.el.object3D)}navigateNext(){this.navigate(1)}navigatePrev(){this.navigate(-1)}navigate(e){const{mediaEntities:t}=this.state;let i=(t.indexOf(this.props.el)+e)%t.length;i=-1===i?t.length-1:i,this.props.onNavigated&&this.props.onNavigated(t[i])}remove(){if(this._isRemoving)return;this._isRemoving=!0;const e=this.props.el;(NAF.utils.isMine(e)||NAF.utils.takeOwnership(e))&&(e.setAttribute("animation__remove",{property:"scale",dur:200,to:{x:.01,y:.01,z:.01},easing:"easeInQuad"}),e.addEventListener("animationcomplete",()=>{const t=this.state.mediaEntities.length<=1;this.props.scene.systems["hubs-systems"].cameraSystem.uninspect(),NAF.utils.takeOwnership(e),e.parentNode.removeChild(e),t?this.props.onClose():this.navigateNext(),this._isRemoving=!1}))}render(){const{pinned:e,onClose:t}=this.props,i=this.props.el.components.tags&&this.props.el.components.tags.data.isStatic;return Xi.a.createElement(oa.a,gr({noOverlay:!0,wide:!0},this.props),Xi.a.createElement("div",{className:ua.a.roomInfo},Xi.a.createElement("div",{className:ua.a.titleAndClose},Xi.a.createElement("button",{autoFocus:!0,className:qn.a.collapseButton,onClick:t},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Ja.faTimes}))),Xi.a.createElement("a",{className:ua.a.objectDisplayString,href:this.props.src,target:"_blank",rel:"noopener noreferrer"},Xi.a.createElement(kn.a,{id:"object-info.open-link"}))),Xi.a.createElement("div",{className:ua.a.actionButtonSections},Xi.a.createElement("div",{className:ua.a.leftActionButtons},this.state.mediaEntities.length>1&&Xi.a.createElement("button",{className:ua.a.navigationButton,onClick:this.navigatePrev},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:sr.faChevronLeft})))),Xi.a.createElement("div",{className:ua.a.primaryActionButtons},Xi.a.createElement("button",{onClick:this.toggleLights.bind(this)},Xi.a.createElement(kn.a,{id:`object-info.${this.state.enableLights?"lower":"raise"}-lights`})),this.props.scene.is("entered")&&Xi.a.createElement("button",{onClick:this.enqueueWaypointTravel},Xi.a.createElement(kn.a,{id:"object-info.waypoint"})),this.props.scene.is("entered")&&!e&&!i&&this.props.hubChannel&&this.props.hubChannel.can("spawn_and_move_media")?Xi.a.createElement("button",{onClick:this.remove.bind(this)},Xi.a.createElement(kn.a,{id:"object-info.remove-button"})):Xi.a.createElement("div",{className:ua.a.actionButtonPlaceholder}),this.props.scene.is("entered")&&!i&&this.props.hubChannel&&this.props.hubChannel.can("pin_objects")&&Xi.a.createElement("button",{className:e?"":ua.a.primaryActionButton,onClick:e?this.unpin:this.pin},Xi.a.createElement(kn.a,{id:`object-info.${e?"unpin-button":"pin-button"}`})),Xi.a.createElement("a",{className:ua.a.cancelText,href:"#",onClick:t},Xi.a.createElement(kn.a,{id:"client-info.cancel"}))),Xi.a.createElement("div",{className:ua.a.rightActionButtons},this.state.mediaEntities.length>1&&Xi.a.createElement("button",{className:ua.a.navigationButton,onClick:this.navigateNext},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:or.faChevronRight})))))))}}fr(vr,"propTypes",{scene:wn.a.object,el:wn.a.object,pinned:wn.a.bool,src:wn.a.string,onClose:wn.a.func,onPinChanged:wn.a.func,onNavigated:wn.a.func,hubChannel:wn.a.object});var br=i(178),yr=i.n(br);function _r(){return(_r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}class wr extends Yi.Component{renderSignInDisclaimer(e){return Xi.a.createElement("div",null,Xi.a.createElement("div",null,"You'll need to sign in to ",Xi.a.createElement("span",{className:yr.a.oauthTypeName},e)," to access this room."),Xi.a.createElement("br",null),Xi.a.createElement("div",null,"We'll ask for access to your e-mail address so you can skip signing in next time."),Xi.a.createElement("p",{className:yr.a.privacyNotice},"By proceeding, you agree to the"," ",Xi.a.createElement(Mn.a,{name:"show_terms"},Xi.a.createElement("a",{rel:"noopener noreferrer",target:"_blank",href:n.a.link("terms_of_use","https://github.com/mozilla/hubs/blob/master/TERMS.md")},"terms of use")," "),n.a.feature("show_terms")&&n.a.feature("show_privacy")&&"and ",Xi.a.createElement(Mn.a,{name:"show_privacy"},Xi.a.createElement("a",{rel:"noopener noreferrer",target:"_blank",href:n.a.link("privacy_notice","https://github.com/mozilla/hubs/blob/master/PRIVACY.md")},"privacy notice")),"."))}renderTweetDisclaimer(){return Xi.a.createElement("div",{className:yr.a.twitterMessage},Xi.a.createElement(kn.a,{id:"oauth-dialog.message.twitter"}))}render(){const e=this.props.oauthInfo&&this.props.oauthInfo[0],t=e&&"twitter"===e.type;return Xi.a.createElement(oa.a,_r({title:"",closable:t},this.props),Xi.a.createElement("div",null,e&&("twitter"===e.type?this.renderTweetDisclaimer():this.renderSignInDisclaimer(e.type)),Xi.a.createElement("div",{className:"invite-form"},Xi.a.createElement("div",{className:`invite-form__buttons ${yr.a.oauthButtons}`},e?Xi.a.createElement("a",{href:e.url,key:e.type,className:xn()({[yr.a.oauthButton]:!0,[yr.a.oauthTwitterButton]:"twitter"===e.type,[yr.a.oauthDiscordButton]:"discord"===e.type})},Xi.a.createElement(kn.a,{id:`oauth-dialog.sign-in.${e.type}`})):Xi.a.createElement("div",{className:"loader-wrap loader-mid"},Xi.a.createElement("div",{className:"loader"},Xi.a.createElement("div",{className:"loader-center"})))))))}}!function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(wr,"propTypes",{oauthInfo:wn.a.array});var Er=i(85),xr=i.n(Er),Sr=i(383),Cr=i.n(Sr),kr=i(525),Ar=i.n(kr),Tr=i(526),Mr=i.n(Tr),Lr=i(527),Rr=i.n(Lr),Pr=i(528),Dr=i.n(Pr),Or=i(82);i(1198),i(1199),i(1200),i(1201);function Hr(){return(Hr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function jr(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}const Ir=Ar()(),Nr=Mr()(),Fr=Rr()(),Vr=Dr()(),Br=(e,t)=>{const i=t.getCurrentContent(),n=i.createEntity("emoji","IMMUTABLE",{emojiUnicode:e}).getLastCreatedEntityKey(),a=t.getSelection();let s,o=0,r=0;const l=Or.Modifier.removeRange(i,a,"backward"),c=l.getSelectionAfter();s=Or.Modifier.insertText(l,c,e,null,n),o=c.getAnchorOffset();const d=c.getAnchorKey();o===(r=i.getBlockForKey(d).getLength())&&(s=Or.Modifier.insertText(s,s.getSelectionAfter()," "));const h=Or.EditorState.push(t,s,"insert-emoji");return Or.EditorState.forceSelection(h,s.getSelectionAfter())};class zr extends Yi.Component{constructor(e){super(),this.state={editorState:Object(Sr.createEditorStateWithText)(e.history.location.state.detail.text||""),suggestions:[]}}componentDidMount(){setTimeout(()=>{this.editorRef.focus(),this.setState({editorState:Br("",this.state.editorState)})})}sendTweet(){var e,t=this;return(e=function*(){const e={media_stored_file_url:t.props.history.location.state.detail.url,body:t.state.editorState.getCurrentContent().getPlainText()};t.setState({posting:!0}),yield Object(h.d)("/api/v1/twitter/tweets","POST",e),t.setState({posting:!1,posted:!0})},function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){jr(s,n,a,o,r,"next",e)}function r(e){jr(s,n,a,o,r,"throw",e)}o(void 0)})})()}renderPostedDialog(){return Xi.a.createElement(oa.a,Hr({wide:!0,allowOverflow:!0,closable:!1,title:""},this.props),Xi.a.createElement("div",{className:xr.a.posted},Xi.a.createElement("div",{className:xr.a.message},Xi.a.createElement(kn.a,{id:"tweet-dialog.posted"})),Xi.a.createElement("div",{className:xr.a.buttons},Xi.a.createElement("button",{className:xr.a.tweetButton,onClick:()=>this.props.onClose()},Xi.a.createElement(kn.a,{id:"tweet-dialog.close"})))))}renderTweetDialog(){const{EmojiSuggestions:e,EmojiSelect:t}=Ir,{CharCounter:i}=Vr,{url:n,contentSubtype:a}=this.props.history.location.state.detail;return Xi.a.createElement(oa.a,Hr({wide:!0,allowOverflow:!0,title:"",additionalClass:xr.a.dialogBackground},this.props),Xi.a.createElement("div",{className:xr.a.tweet},Xi.a.createElement("div",{className:xr.a.editor,onClick:()=>this.editorRef.focus()},Xi.a.createElement("div",{className:xr.a.editorInner},Xi.a.createElement(Cr.a,{ref:e=>this.editorRef=e,editorState:this.state.editorState,onChange:e=>this.setState({editorState:e}),plugins:[Ir,Nr,Fr,Vr]})),Xi.a.createElement("div",{className:xr.a.emojiButton},Xi.a.createElement(t,null)),Xi.a.createElement("div",{className:xr.a.emojiSuggestions},Xi.a.createElement(e,null)),this.state.editorState.getCurrentContent().getPlainText().length>200&&Xi.a.createElement("div",{className:xr.a.counter},Xi.a.createElement(i,{editorState:this.state.editorState,limit:280})," / 280"),Xi.a.createElement("div",{className:xr.a.media},a&&a.startsWith("video")?Xi.a.createElement("video",{src:n,width:450,height:255,controls:!0}):Xi.a.createElement("img",{src:Object(Ne.j)(n,450,255)}))),this.state.posting?Xi.a.createElement("div",{className:xn()(["loader-wrap","loader-mid",xr.a.tweetLoader])},Xi.a.createElement("div",{className:"loader"},Xi.a.createElement("div",{className:"loader-center"}))):Xi.a.createElement("div",{className:xr.a.buttons},Xi.a.createElement("button",{className:xr.a.tweetButton,onClick:()=>this.sendTweet(),disabled:this.state.editorState.getCurrentContent().getPlainText().length>280},Xi.a.createElement(kn.a,{id:"tweet-dialog.tweet"})))))}render(){return this.state.posted?this.renderPostedDialog():this.renderTweetDialog()}}!function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(zr,"propTypes",{history:wn.a.object,onClose:wn.a.func});var Ur=i(73),Wr=i.n(Ur),Zr=i(296),Gr=i.n(Zr);function qr(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class $r extends Yi.Component{constructor(...e){super(...e),qr(this,"state",{pendingMessage:""}),qr(this,"sendMessage",e=>{e.preventDefault(),this.props.onSendMessage&&this.props.onSendMessage(this.state.pendingMessage),this.setState({pendingMessage:""})})}render(){const e=this.state.pendingMessage.split("\n").length,t=28*e+"px",i=28*e+20+"px",n=this.props.discordBridges.map(e=>"#"+e).join(", "),a=`${this.props.occupantCount-1} other${this.props.occupantCount>2?"s":""}`,s=this.props.occupantCount<=1?"Nobody is here yet...":this.props.discordBridges.length?`Send message to ${a} and ${n}...`:`Send message to ${a}...`;return Xi.a.createElement("form",{onSubmit:this.sendMessage},Xi.a.createElement("div",{className:xn()({[Wr.a.messageEntry]:!0,[Wr.a.messageEntryDisabled]:this.props.occupantCount<=1}),style:{height:i}},Xi.a.createElement("textarea",{className:xn()([Wr.a.messageEntryInput,"chat-focus-target"]),value:this.state.pendingMessage,rows:e,style:{height:t},onFocus:e=>Object(Qa.b)(e.target),onBlur:()=>Object(Qa.a)(),onChange:e=>this.setState({pendingMessage:e.target.value}),disabled:this.props.occupantCount<=1,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey?"Escape"===e.key&&e.target.blur():this.sendMessage(e)},placeholder:s}),Xi.a.createElement(Xn.b,null,Xi.a.createElement(Na,{className:xn()([Wr.a.messageEntryButton,Wr.a.messageEntrySubmit]),disabled:this.props.occupantCount<=1,type:"submit",src:Gr.a}))))}}qr($r,"propTypes",{discordBridges:wn.a.array,occupantCount:wn.a.number,onSendMessage:wn.a.func});var Yr=$r,Xr=i(265),Qr=i.n(Xr);class Kr extends Yi.Component{render(){const e=["leave","fly","grow","shrink","duck","debug","vrstats","scene <scene url>","rename <new name>"];return Object(Me.a)("video_capture")&&e.push("capture [stop]"),Xi.a.createElement("div",{className:xn()({[Qr.a.commandHelp]:!0,[Qr.a.commandHelpOnTop]:this.props.onTop})},e.map(e=>(""===this.props.matchingPrefix||e.split(" ")[0].startsWith(this.props.matchingPrefix.split(" ")[0]))&&Xi.a.createElement("div",{className:Qr.a.entry,key:e},Xi.a.createElement("div",{className:Qr.a.command},"/",e),Xi.a.createElement("div",null,Xi.a.createElement(kn.a,{id:`commands.${e.split(" ")[0]}`})))))}}!function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(Kr,"propTypes",{matchingPrefix:wn.a.string,onTop:wn.a.bool});var Jr=i(529),el=i.n(Jr),tl=i(530),il=i(116),nl=i(31),al=i.n(nl),sl=i(531),ol=i.n(sl),rl=i(384);const ll={},cl={BASE:!0,HEAD:!0,HTML:!0,META:!0,NOFRAME:!0,NOSCRIPT:!0,PARAM:!0,SCRIPT:!0,STYLE:!0,TITLE:!0},dl=["A","ABBR","ADDRESS","AREA","ARTICLE","ASIDE","AUDIO","B","BASE","BDI","BDO","BLOCKQUOTE","BODY","BR","BUTTON","CANVAS","CAPTION","CENTER","CITE","CODE","COL","COLGROUP","COMMAND","DATALIST","DD","DEL","DETAILS","DFN","DIV","DL","DT","EM","EMBED","FIELDSET","FIGCAPTION","FIGURE","FONT","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEAD","HEADER","HGROUP","HR","HTML","I","IFRAME","IMG","INPUT","INS","KBD","KEYGEN","LABEL","LEGEND","LI","LINK","MAP","MARK","MATH","MENU","META","METER","NAV","NOBR","NOSCRIPT","OBJECT","OL","OPTION","OPTGROUP","OUTPUT","P","PARAM","PRE","PROGRESS","Q","RP","RT","RUBY","S","SAMP","SCRIPT","SECTION","SELECT","SMALL","SOURCE","SPAN","STRONG","STYLE","SUB","SUMMARY","SUP","SVG","TABLE","TBODY","TD","TEXTAREA","TFOOT","TH","THEAD","TIME","TITLE","TR","TRACK","U","UL","VAR","VIDEO","WBR"];function hl(e){const t={},i=document.body.appendChild(document.createElement(e)),n=getComputedStyle(i);for(let e=0;e<n.length;e++)t[n[e]]=n[n[e]];return document.body.removeChild(i),t}function ul(){for(let e=0;e<dl.length;e++)cl[dl[e]]||(ll[dl[e]]=hl(dl[e]))}var pl=i(67),ml=i.n(pl),gl=i(242),fl=i(220),vl=i(532),bl=i(226),yl=i(533),_l=i.n(yl),wl=i(534),El=i.n(wl),xl=i(535);function Sl(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Cl(e,t){const i=new URLSearchParams(e.location.search);Object(h.j)()&&document.location.host!==n.a.RETICULUM_SERVER?(i.set("client_id",t),Object(en.d)(e,e.location.pathname,i.toString())):Object(en.d)(e,Object(en.h)(e.location,`/clients/${t}`),i.toString())}class kl extends Yi.Component{constructor(...e){super(...e),Sl(this,"navigateToClientInfo",e=>{Cl(this.props.history,e)}),Sl(this,"domForPresence",([e,t])=>{const i=t.metas[t.metas.length-1],n=i.context,a=i.profile,s=i.streaming||i.recording?Xi.a.createElement(qa.a,{icon:bl.faVideo}):function(e){return e&&e.hmd?Xi.a.createElement(Ia,{src:El.a}):e&&e.mobile?Xi.a.createElement(qa.a,{icon:xl.faMobileAlt}):e&&e.discord?Xi.a.createElement(Ia,{src:_l.a}):Xi.a.createElement(qa.a,{icon:vl.faDesktop})}(n),o=n&&n.discord,r=i.roles&&i.roles.owner&&Xi.a.createElement("span",{className:ml.a.moderatorBadge,title:"Moderator"},"");return Xi.a.createElement(Xn.b,{key:e},Xi.a.createElement("div",{className:ml.a.row},Xi.a.createElement("div",{className:ml.a.icon},Xi.a.createElement("i",null,s)),Xi.a.createElement("div",{className:xn()({[ml.a.listItem]:!0})},e===this.props.sessionId?Xi.a.createElement(Ka.a,{className:ml.a.self,stateKey:"overlay",stateValue:"profile",history:this.props.history},a&&a.displayName,r,Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Ga.faPencilAlt}))):Xi.a.createElement("div",null,o?Xi.a.createElement("span",null,a&&a.displayName):Xi.a.createElement("button",{className:ml.a.clientLink,onClick:()=>this.navigateToClientInfo(e)},a&&a.displayName),r)),Xi.a.createElement("div",{className:ml.a.presence},Xi.a.createElement(kn.a,{id:`presence.in_${i.presence}`}))))})}componentDidMount(){document.querySelector(".a-canvas").addEventListener("mouseup",()=>{this.props.onExpand(!1)},{once:!0})}renderExpandedList(){return Xi.a.createElement("div",{className:ml.a.presenceList},Xi.a.createElement("div",{className:ml.a.attachPoint}),Xi.a.createElement("div",{className:ml.a.contents},Xi.a.createElement("div",{className:ml.a.rows},Object.entries(this.props.presences||{}).filter(([e])=>e===this.props.sessionId).map(this.domForPresence),Object.entries(this.props.presences||{}).filter(([e])=>e!==this.props.sessionId).map(this.domForPresence)),Xi.a.createElement("div",{className:ml.a.signIn},this.props.signedIn?Xi.a.createElement("div",null,Xi.a.createElement("span",null,Xi.a.createElement(kn.a,{id:"sign-in.as"})," ",Object(gl.a)(this.props.email))," ",Xi.a.createElement("a",{onClick:this.props.onSignOut},Xi.a.createElement(kn.a,{id:"sign-in.out"}))):Xi.a.createElement("a",{onClick:this.props.onSignIn},Xi.a.createElement(kn.a,{id:"sign-in.in"})))))}render(){const e=this.props.presences?Object.entries(this.props.presences).length:0;return Xi.a.createElement("div",null,Xi.a.createElement("div",{title:"Members",onClick:()=>{this.props.onExpand(!this.props.expanded)},className:xn()({[Zn.a.presenceInfo]:!0,[Zn.a.presenceInfoSelected]:this.props.expanded})},Xi.a.createElement(qa.a,{icon:fl.faUsers}),Xi.a.createElement("span",{className:Zn.a.occupantCount},e)),this.props.expanded&&this.renderExpandedList())}}function Al(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function Tl(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){Al(s,n,a,o,r,"next",e)}function r(e){Al(s,n,a,o,r,"throw",e)}o(void 0)})}}Sl(kl,"propTypes",{presences:wn.a.object,history:wn.a.object,sessionId:wn.a.string,signedIn:wn.a.bool,email:wn.a.string,onSignIn:wn.a.func,onSignOut:wn.a.func,expanded:wn.a.bool,onExpand:wn.a.func});const Ml=document.createElement("canvas"),Ll=/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|[\ud83c[\ude32-\ude3a]|[\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/,Rl=new THREE.TextureLoader,Pl=1024,Dl=(e,t,i,n,a)=>{const s=e.split("\n").length>1,o=s?al.a.messageWrapMulti:al.a.messageWrap,r=e.startsWith("`")&&e.endsWith("`"),l={[al.a.messageBody]:!0,[al.a.messageBodyMulti]:s,[al.a.messageBodyMono]:r},c=n&&i&&a&&NAF.clientId!==i,d=c?()=>Cl(a,i):()=>{};s||(e=(e=>{const t=e.split(" "),i=[];let n=0;for(let e=0;e<t.length;e++){const a=t[e];a.startsWith(":")&&a.endsWith(":")?n++:n+=a.length,i.push(a),n>=40&&(n=0,i.push("\n"))}return i.join(" ")})(e));const h=(r?e.substring(1,e.length-1):e).trim();return Xi.a.createElement("div",{className:o},t&&Xi.a.createElement("div",{onClick:d,className:xn()({[al.a.messageSource]:!0,[al.a.messageSourceLink]:c})},t,":"),Xi.a.createElement("div",{className:xn()(l)},Xi.a.createElement(ol.a,{properties:{target:"_blank",rel:"noopener referrer"}},Object(rl.toArray)(h))))};function Ol(e,t,i){const n=1===e.split("\n").length,a=Ml.getContext("2d"),s=Object(rl.toArray)(e),o=i&&1===s.length&&s[0].props&&s[0].props.children.match&&s[0].props.children.match(Ll),r=document.createElement("div");r.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),r.setAttribute("class",`${al.a.presenceLog} ${al.a.presenceLogSpawn}`),document.body.appendChild(r);const l=Xi.a.createElement("div",{className:xn()({[al.a.presenceLogEntry]:!o,[al.a.presenceLogEntryOneLine]:!o&&n,[al.a.presenceLogEmoji]:o})},Dl(e,t));return new Promise(e=>{$i.a.render(l,r,()=>{const t=r.offsetWidth,i=r.offsetHeight,n=i/t,s=Pl*Math.min(1,1/n)/r.offsetWidth;Ml.width=t*s,Ml.height=i*s;const o=encodeURIComponent(`\n          <svg xmlns="http://www.w3.org/2000/svg" width="${Ml.width}px" height="${Ml.height}px">\n            <foreignObject width="100%" height="100%" style="transform: scale(${s});">\n              ${function(e){if(0===Object.keys(ll).length&&ul(),e.nodeType!==Node.ELEMENT_NODE)throw new TypeError;const t=[],i=e.querySelectorAll("*");for(let e=0;e<i.length;e++){const a=i[e];if(!cl[a.tagName]){const i=getComputedStyle(a),s=(n=(n=a.tagName).toUpperCase(),ll[n]||(ll[n]=hl(n)),ll[n]);t[e]=a.style.cssText;for(let e=0;e<i.length;e++){const t=i[e];t.startsWith("-webkit")||i[t]!==s[t]&&(a.style[t]=i[t])}}}var n;const a=e.outerHTML;for(let e=0;e<i.length;e++)i[e].style.cssText=t[e];return a}(r)}\n            </foreignObject>\n          </svg>\n    `),l=new Image;l.onload=()=>{a.drawImage(l,0,0),$i.a.unmountComponentAtNode(r),r.remove(),l.onload=null,l.src="",Ml.toBlob(n=>e([n,t,i]))},l.src="data:image/svg+xml,"+o})})}function Hl(){return(Hl=Tl(function*({name:e,type:t,body:i}){if("chat"!==t)return;const[n,a,s]=yield Ol(i,e,!1),o=document.createElement("a-entity"),r=document.createElement("a-entity");document.querySelector("a-scene").appendChild(o),o.appendChild(r),o.setAttribute("class","ui"),o.setAttribute("is-remote-hover-target",{}),o.setAttribute("follow-in-fov",{target:"#avatar-pov-node",offset:{x:0,y:0,z:-.8}});const l=URL.createObjectURL(n);r.setAttribute("animation__float",{property:"position",dur:1e4,from:{x:0,y:0,z:0},to:{x:0,y:.05,z:-.05},easing:"easeOutQuad"}),o.setAttribute("animation__spawn",{property:"scale",dur:200,from:{x:.1,y:.1,z:.1},to:{x:1,y:1,z:1},easing:"easeOutElastic"}),r.setAttribute("animation__opacity",{property:"meshMaterial.opacity",isRawProperty:!0,delay:3e3,dur:8e3,from:1,to:0,easing:"easeInQuad"}),r.addEventListener("animationcomplete__opacity",()=>{o.parentNode.removeChild(o)}),Rl.load(l,e=>{const t=new THREE.MeshBasicMaterial;t.transparent=!0,t.map=e,t.generateMipmaps=!1,t.needsUpdate=!0;const i=new THREE.PlaneBufferGeometry(1,1,1,1,e.flipY),n=new THREE.Mesh(i,t);r.setObject3D("mesh",n),r.meshMaterial=t;r.object3DMap.mesh.scale.set(a/400,s/400,1)})})).apply(this,arguments)}function jl(e,t){return Il.apply(this,arguments)}function Il(){return(Il=Tl(function*(e,t){if(0===e.length)return;try{if(new URL(Object(be.f)(e)).host)return void document.querySelector("a-scene").emit("add_media",e)}catch(e){}const[i]=yield Ol(e,t,!0);document.querySelector("a-scene").emit("add_media",new File([i],"message.png",{type:"image/png"}))})).apply(this,arguments)}function Nl(e){return Xi.a.createElement("div",{className:e.className},e.maySpawn&&Xi.a.createElement("button",{className:xn()(al.a.iconButton,al.a.spawnMessage),onClick:()=>jl(e.body)}),Dl(e.body,e.name,e.sessionId,e.includeFromLink,e.history))}function Fl(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Nl.propTypes={name:wn.a.string,maySpawn:wn.a.bool,body:wn.a.string,sessionId:wn.a.string,history:wn.a.object,className:wn.a.string,includeFromLink:wn.a.bool};const Vl=AFRAME.utils.device.isMobile();class Bl extends Yi.Component{constructor(...e){super(...e),Fl(this,"state",{pendingMessage:""}),Fl(this,"sendMessage",e=>{e.preventDefault(),this.props.onSendMessage&&this.props.onSendMessage(this.state.pendingMessage),this.setState({pendingMessage:""})})}render(){const e=this.state.pendingMessage.split("\n").length,t=28*e+"px",i=28*e+20+"px",n=this.props.discordBridges.map(e=>"#"+e).join(", ");return Xi.a.createElement("form",{onSubmit:this.sendMessage},Xi.a.createElement("div",{className:xn()({[Wr.a.messageEntryInRoom]:!0,[Wr.a.messageEntryOnMobile]:Vl}),style:{height:i}},this.state.pendingMessage.startsWith("/")&&Xi.a.createElement(Kr,{matchingPrefix:this.state.pendingMessage.substring(1)}),Xi.a.createElement("input",{id:"message-entry-media-input",type:"file",style:{display:"none"},accept:Vl?"image/*":"*",multiple:!0,onChange:e=>{if(this.props.onObjectCreated)for(const t of e.target.files)this.props.onObjectCreated(t)}}),this.props.enableSpawning&&Xi.a.createElement("label",{htmlFor:"message-entry-media-input",title:"Upload",className:xn()([Wr.a.messageEntryButton,Wr.a.messageEntryButtonInRoom,Wr.a.messageEntryUpload])},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Vl?tl.faCamera:il.faPlus}))),Xi.a.createElement("textarea",{style:{height:t},className:xn()([Wr.a.messageEntryInput,Wr.a.messageEntryInputInRoom,"chat-focus-target",!this.props.enableSpawning&&Wr.a.messageEntryInputNoSpawn]),value:this.state.pendingMessage,rows:e,onFocus:e=>{Object(Qa.b)(e.target)},onBlur:()=>{Object(Qa.a)()},onChange:e=>{e.stopPropagation(),this.setState({pendingMessage:e.target.value})},onKeyDown:e=>{"Enter"!==e.key||e.ctrlKey||e.shiftKey?"Enter"===e.key&&e.ctrlKey?(jl(e.target.value),this.setState({pendingMessage:""}),e.target.blur()):"Escape"===e.key&&e.target.blur():this.sendMessage(e)},placeholder:this.props.discordBridges.length?`Send to room and ${n}...`:"Send to room..."}),this.props.enableSpawning&&Xi.a.createElement(Na,{title:"Create",className:xn()([Wr.a.messageEntrySpawn]),src:el.a,onClick:()=>{this.state.pendingMessage.length>0?(jl(this.state.pendingMessage),this.setState({pendingMessage:""})):Object(en.e)(this.props.history,"modal","create")}}),Xi.a.createElement(Na,{type:"submit",title:"Submit",className:xn()([Wr.a.messageEntryButton,Wr.a.messageEntryButtonInRoom,Wr.a.messageEntrySubmit]),src:Gr.a})))}}Fl(Bl,"propTypes",{discordBridges:wn.a.array,onSendMessage:wn.a.func,onObjectCreated:wn.a.func,history:wn.a.object,enableSpawning:wn.a.bool});var zl=Bl,Ul=i(536),Wl=i.n(Ul);function Zl(){return(Zl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function Gl(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),n.forEach(function(t){ql(e,t,i[t])})}return e}function ql(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function $l(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function Yl(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){$l(s,n,a,o,r,"next",e)}function r(e){$l(s,n,a,o,r,"throw",e)}o(void 0)})}}const Xl="/api/v1/avatars",Ql=[{name:"Quilt",url:"https://tryquilt.io/?gltf=$AVATAR_GLTF"}],Kl=!0,Jl=[...Ql,{name:"Skindex Editor",url:"https://www.minecraftskins.com/skin-editor"},{name:"MinecraftSkins.net Editor",url:"https://www.minecraftskins.net/skineditor"}],ec=function(){var e=Yl(function*(e){const{avatars:t}=yield Object(h.d)(`${Xl}/${e}`);return t[0]});return function(t){return e.apply(this,arguments)}}();class tc extends Yi.Component{constructor(e){var t;super(e),t=this,ql(this,"state",{baseAvatarResults:[],editorLinks:Ql,previewGltfUrl:null}),ql(this,"componentDidMount",Yl(function*(){if(t.props.avatarId){const e=yield ec(t.props.avatarId);e.creatorAttribution=e.attributions&&e.attributions.creator||"",Object.assign(t.inputFiles,e.files),t.setState({avatar:e,previewGltfUrl:e.base_gltf_url})}else{const{entries:e}=yield Object(h.d)("/api/v1/media/search?filter=base&source=avatar_listings"),i=e.map(e=>({id:e.id,name:e.name,gltfs:e.gltfs,images:e.images}));if(i.length){const e=i[Math.floor(Math.random()*i.length)];t.setState({baseAvatarResults:i,avatar:{name:"My Avatar",files:{},base_gltf_url:e.gltfs.base,parent_avatar_listing_id:e.id},previewGltfUrl:e.gltfs.avatar})}else t.setState({avatar:{name:"My Avatar",files:{}}})}})),ql(this,"createOrUpdateAvatar",e=>Object(h.d)(e.avatar_id?`${Xl}/${e.avatar_id}`:Xl,e.avatar_id?"PUT":"POST",{avatar:e}).then(({avatars:e})=>e[0])),ql(this,"uploadAvatar",function(){var e=Yl(function*(e){if(e.preventDefault(),t.inputFiles.glb&&t.inputFiles.glb instanceof File){const e=new THREE.GLTFLoader,i=URL.createObjectURL(t.inputFiles.glb),n=console.log,a=yield new Promise((t,a)=>e.createParser(i,t,n,a));URL.revokeObjectURL(i);const{body:s}=a.extensions.KHR_binary_glTF,o=JSON.stringify(Object(ye.c)(a.json));t.inputFiles.gltf=new File([o],"file.gltf",{type:"model/gltf"}),t.inputFiles.bin=new File([s],"file.bin",{type:"application/octet-stream"})}t.inputFiles.thumbnail=new File([yield t.preview.getWrappedInstance().snapshot()],"thumbnail.png",{type:"image/png"});const i=["gltf","bin","base_map","emissive_map","normal_map","orm_map","thumbnail"].filter(e=>null===t.inputFiles[e]||t.inputFiles[e]instanceof File);t.setState({uploading:!0});const n=yield Promise.all(i.map(e=>t.inputFiles[e]&&Object(be.m)(t.inputFiles[e]))),a=Gl({},t.state.avatar,{attributions:{creator:t.state.avatar.creatorAttribution},files:n.map((e,t)=>[i[t],e&&[e.file_id,e.meta.access_token,e.meta.promotion_token]]).reduce((e,[t,i])=>Gl({},e,{[t]:i}),{})});yield t.createOrUpdateAvatar(a),t.setState({uploading:!1}),t.props.onSave&&t.props.onSave()});return function(t){return e.apply(this,arguments)}}()),ql(this,"deleteAvatar",function(){var e=Yl(function*(e){e.preventDefault(),yield Object(h.d)(`${Xl}/${t.state.avatar.avatar_id}`,"DELETE"),t.props.onSave&&t.props.onSave()});return function(t){return e.apply(this,arguments)}}()),ql(this,"fileField",(e,t,i,n=!1,a)=>Xi.a.createElement("div",{className:xn()("file-input-row",{disabled:n}),key:e,title:a},Xi.a.createElement("label",{htmlFor:`avatar-file_${e}`},Xi.a.createElement("div",{className:"img-box"}),Xi.a.createElement("span",null,t)),Xi.a.createElement("input",{id:`avatar-file_${e}`,type:"file",accept:i,disabled:n,onChange:t=>{const i=t.target.files[0];t.target.value=null,this.inputFiles[e]=i,URL.revokeObjectURL(this.state.previewGltfUrl);const n=URL.createObjectURL(this.inputFiles.glb);this.setState({previewGltfUrl:n,avatar:Gl({},this.state.avatar,{files:Gl({},this.state.avatar.files,{[e]:URL.createObjectURL(i)})})})}}),this.state.avatar.files[e]&&Xi.a.createElement("a",{onClick:()=>{this.inputFiles[e]=null,URL.revokeObjectURL(this.state.avatar.files[e]),this.setState({avatar:Gl({},this.state.avatar,{files:Gl({},this.state.avatar.files,{[e]:null})})},()=>this.setState({previewGltfUrl:this.getPreviewUrl()}))}},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Ja.faTimes}))))),ql(this,"mapField",(e,t,i,n=!1,a)=>Xi.a.createElement("div",{className:"file-input-row",key:e,title:a},Xi.a.createElement("label",{htmlFor:`avatar-file_${e}`},Xi.a.createElement("div",{className:"img-box"},this.state.avatar.files[e]?Xi.a.createElement("img",{src:this.state.avatar.files[e]}):Xi.a.createElement(qa.a,{icon:cs.faCloudUploadAlt})),Xi.a.createElement("span",null,t)),Xi.a.createElement("input",{id:`avatar-file_${e}`,type:"file",accept:i,disabled:n,onChange:t=>{const i=t.target.files[0];t.target.value=null,this.inputFiles[e]=i,URL.revokeObjectURL(this.state.avatar.files[e]),this.setState({avatar:Gl({},this.state.avatar,{files:Gl({},this.state.avatar.files,{[e]:URL.createObjectURL(i)})})})}}),this.state.avatar.files[e]&&Xi.a.createElement("a",{onClick:()=>{this.inputFiles[e]=null,URL.revokeObjectURL(this.state.avatar.files[e]),this.setState({avatar:Gl({},this.state.avatar,{files:Gl({},this.state.avatar.files,{[e]:null})})})}},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Ja.faTimes}))))),ql(this,"textField",(e,t,i,n)=>Xi.a.createElement("div",{className:"text-field-container"},Xi.a.createElement("label",{htmlFor:`#avatar-${e}`},t),Xi.a.createElement("input",{id:`avatar-${e}`,type:"text",disabled:i,required:n,placeholder:t,className:"text-field",value:this.state.avatar[e]||"",onChange:t=>this.setState({avatar:Gl({},this.state.avatar,{[e]:t.target.value})})}))),ql(this,"getPreviewUrl",e=>{if(e){const t=this.state.baseAvatarResults.find(t=>t.id===e);if(t)return t.gltfs.avatar}return this.inputFiles.glb?URL.createObjectURL(this.inputFiles.glb):this.state.avatar.base_gltf_url}),ql(this,"selectListingField",(e,i)=>Xi.a.createElement("div",{className:"select-container"},Xi.a.createElement("label",{htmlFor:`#avatar-${e}`},i),Xi.a.createElement("select",{id:`avatar-${e}`,value:this.state.avatar[e]||"",onChange:function(){var i=Yl(function*(i){const n=i.target.value;t.setState({avatar:Gl({},t.state.avatar,{[e]:n}),previewGltfUrl:t.getPreviewUrl(n)})});return function(e){return i.apply(this,arguments)}}(),placeholder:i,className:"select"},this.state.baseAvatarResults.map(e=>Xi.a.createElement("option",{key:e.id,value:e.id},e.name)),Xi.a.createElement("option",{value:""},"Custom GLB...")),Xi.a.createElement("img",{className:"arrow",src:gn.a,srcSet:vn.a+" 2x"}))),ql(this,"selectListingGrid",(e,t)=>Xi.a.createElement("div",{className:"select-grid-container"},Xi.a.createElement("label",{htmlFor:`#avatar-${e}`},t),Xi.a.createElement("div",{className:"select-grid"},this.state.baseAvatarResults.map(t=>Xi.a.createElement("div",{onClick:()=>this.setState({avatar:Gl({},this.state.avatar,{[e]:t.id}),previewGltfUrl:this.getPreviewUrl(t.id)}),key:t.id,className:xn()("item",{selected:t.id===this.state.avatar[e]}),style:{paddingBottom:`${t.images.preview.width/t.images.preview.height*100}%`}},Xi.a.createElement("img",{src:t.images.preview.url})))),Xi.a.createElement("input",{id:"avatar-file_glb",type:"file",accept:"model/gltf+binary,.glb",onChange:t=>{const i=t.target.files[0];t.target.value=null,this.inputFiles.glb=i,URL.revokeObjectURL(this.state.avatar.files.glb),this.setState({avatar:Gl({},this.state.avatar,{[e]:"",files:Gl({},this.state.avatar.files,{glb:URL.createObjectURL(i)})}),previewGltfUrl:this.getPreviewUrl("")})}}),Xi.a.createElement("label",{htmlFor:"avatar-file_glb",className:xn()("item","custom",{selected:""===this.state.avatar[e]})},Xi.a.createElement(qa.a,{icon:cs.faCloudUploadAlt})," Custom GLB"))),ql(this,"textarea",(e,t,i)=>Xi.a.createElement("div",null,Xi.a.createElement("textarea",{id:`avatar-${e}`,disabled:i,placeholder:t,className:"textarea",value:this.state.avatar[e]||"",onChange:t=>this.setState({avatar:Gl({},this.state.avatar,{[e]:t.target.value})})}))),ql(this,"checkbox",(e,t,i,n)=>Xi.a.createElement("div",{className:"checkbox-container",title:t},Xi.a.createElement("input",{id:`avatar-${e}`,type:"checkbox",className:"checkbox",disabled:n,checked:!!this.state.avatar[e],onChange:t=>this.setState({avatar:Gl({},this.state.avatar,{[e]:t.target.checked})})}),Xi.a.createElement("label",{htmlFor:`#avatar-${e}`},i))),ql(this,"handleGltfLoaded",e=>{const t=e.parser.json.extensions&&e.parser.json.extensions.MOZ_hubs_avatar;let i=t&&t.editors||Ql;Kl&&(i=i.filter(e=>Jl.some(t=>t.name===e.name&&t.url===e.url))),this.setState({editorLinks:i})}),this.inputFiles={}}render(){const{debug:e}=this.props,{avatar:t}=this.state;return Xi.a.createElement("div",{className:xn()(Wl.a.avatarEditor,this.props.className)},this.props.onClose&&Xi.a.createElement("a",{className:"close-button",onClick:this.props.onClose},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Ja.faTimes}))),this.state.avatar?this.props.signedIn?Xi.a.createElement("form",{onSubmit:this.uploadAvatar,className:"center"},this.textField("name","Name",!1,!0),Xi.a.createElement("div",{className:"split"},Xi.a.createElement("div",{className:"form-body"},e&&this.textField("avatar_id","Avatar ID",!0),e&&this.textField("parent_avatar_id","Parent Avatar ID"),e&&this.textField("parent_avatar_listing_id","Parent Avatar Listing ID"),e&&this.textarea("description","Description"),!!this.state.baseAvatarResults.length&&this.selectListingGrid("parent_avatar_listing_id","Model"),Xi.a.createElement("label",null,"Skin"),this.mapField("base_map","Base Map","image/*"),Xi.a.createElement("details",null,Xi.a.createElement("summary",null,"Advanced"),this.mapField("emissive_map","Emissive Map","image/*"),this.mapField("normal_map","Normal Map","image/*"),this.mapField("orm_map","ORM Map","image/*",!1,"Occlussion (r), Roughness (g), Metallic (b)")),Xi.a.createElement("label",null,"Share Settings"),this.checkbox("allow_promotion",`Allow ${ba.b["company-name"]} to promote your avatar, and show it in search results.`,Xi.a.createElement("span",null,"Allow"," ",Xi.a.createElement("a",{href:n.a.link("promotion","https://github.com/mozilla/hubs/blob/master/PROMOTION.md"),target:"_blank",rel:"noopener noreferrer"},"Promotion"))),this.checkbox("allow_remixing","Allow others to edit and re-publish your avatar as long as they give you credit.",Xi.a.createElement("span",null,"Allow"," ",Xi.a.createElement("a",{href:n.a.link("remixing","https://github.com/mozilla/hubs/blob/master/REMIXING.md"),target:"_blank",rel:"noopener noreferrer"},"Remixing")," ",Xi.a.createElement("span",{className:"license"},"(under"," ",Xi.a.createElement("a",{href:"https://creativecommons.org/licenses/by/3.0/",target:"_blank",rel:"noopener noreferrer"},"CC-BY 3.0"),")"))),this.textField("creatorAttribution","Attribution (optional)",!1,!1)),Xi.a.createElement(es.a,Zl({className:"preview",avatarGltfUrl:this.state.previewGltfUrl,onGltfLoaded:this.handleGltfLoaded},this.inputFiles,{ref:e=>this.preview=e}))),Xi.a.createElement("div",{className:"info"},Xi.a.createElement(Mn.a,{name:"show_avatar_editor_link"},Xi.a.createElement("p",null,Xi.a.createElement(kn.a,{id:"avatar-editor.external-editor-info"}),this.state.editorLinks.map(({name:e,url:t})=>Xi.a.createElement("a",{key:e,target:"_blank",rel:"noopener noreferrer",href:t.replace("$AVATAR_GLTF",encodeURIComponent(this.state.previewGltfUrl))},e)))),Xi.a.createElement(Mn.a,{name:"show_avatar_pipelines_link"},Xi.a.createElement("p",null,Xi.a.createElement(kn.a,{id:"avatar-editor.info"}),Xi.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/MozillaReality/hubs-avatar-pipelines"},Xi.a.createElement(kn.a,{id:"avatar-editor.info-link"}))))),Xi.a.createElement("div",null,Xi.a.createElement("input",{disabled:this.state.uploading,className:"form-submit",type:"submit",value:this.state.uploading?"Uploading...":"Save"})),!this.props.hideDelete&&Xi.a.createElement("div",{className:"delete-avatar"},this.state.confirmDelete?Xi.a.createElement("span",null,"are you sure? ",Xi.a.createElement("a",{onClick:this.deleteAvatar},"yes")," /"," ",Xi.a.createElement("a",{onClick:()=>this.setState({confirmDelete:!1})},"no")):Xi.a.createElement("a",{onClick:()=>this.setState({confirmDelete:!0}),title:t.has_listings?"Other users already using this avatar will still be able to use it, but it will be removed from 'My Avatars' and search results.":""},t.has_listings?"delist":"delete"," avatar"))):Xi.a.createElement("a",{onClick:this.props.onSignIn},Xi.a.createElement(kn.a,{id:"sign-in.in"})):Xi.a.createElement("div",{className:"loader"},Xi.a.createElement("div",{className:"loader-center"})))}}ql(tc,"propTypes",{avatarId:wn.a.string,onSignIn:wn.a.func,onSave:wn.a.func,onClose:wn.a.func,signedIn:wn.a.bool,hideDelete:wn.a.bool,debug:wn.a.bool,className:wn.a.string});var ic=i(537),nc=i.n(ic),ac=i(538),sc=i.n(ac),oc=i(539),rc=i.n(oc);function lc(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class cc extends Yi.Component{constructor(...e){super(...e),lc(this,"state",{volume:0})}componentDidMount(){this.startAnalyser()}componentWillUnmount(){this.stopAnalyser()}stopAnalyser(){null!=this.micUpdateInterval&&clearInterval(this.micUpdateInterval)}startAnalyser(){this.micUpdateInterval&&clearInterval(this.micUpdateInterval);const e=rc()(100);let t=0;this.micUpdateInterval=setInterval(()=>{const i=this.props.scene.systems["local-audio-analyser"];t=Math.max(i.volume,t),e.push(Date.now(),i.volume);const n=e.movingAverage(),a=0===t?0:n/t;Math.abs(this.state.volume-a)>.05&&this.setState({volume:a})},50)}render(){const e={clip:`rect(${111-Math.floor(111*this.state.volume)}px, 111px, 111px, 0px)`};return Xi.a.createElement("div",{className:"audio-setup-panel__levels__icon"},!this.props.muteOnEntry&&Xi.a.createElement("svg",{width:"111",height:"111",viewBox:"0 0 111 111",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Xi.a.createElement("circle",{cx:"55.5",cy:"55.5",r:"55.5",fill:"currentColor",fillOpacity:"0.8"})),!this.props.muteOnEntry&&Xi.a.createElement("div",{className:"audio-setup-panel__levels__icon__talking",style:e},Xi.a.createElement("svg",{width:"111",height:"111",viewBox:"0 0 111 111",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Xi.a.createElement("circle",{cx:"55.5",cy:"55.5",r:"55.5",fill:"currentColor",fillOpacity:"0.8"}))),this.props.hasAudioTrack&&!this.props.muteOnEntry?Xi.a.createElement("img",{src:nc.a,srcSet:sc.a+" 2x",className:"audio-setup-panel__levels__icon-part"}):Xi.a.createElement("img",{src:rn.a,srcSet:cn.a+" 2x",className:"audio-setup-panel__levels__icon-part"}),this.props.hasAudioTrack&&!this.props.muteOnEntry&&Xi.a.createElement("div",{className:"audio-setup-panel__levels__test_label"},Xi.a.createElement(kn.a,{id:"audio.talk_to_test"})))}}lc(cc,"propTypes",{hasAudioTrack:wn.a.bool,muteOnEntry:wn.a.bool,scene:wn.a.object});var dc=i(39),hc=i.n(dc),uc=i(540);function pc(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class mc extends Yi.Component{constructor(e){super(e),pc(this,"state",{isDragging:!1}),this.myRoot=Xi.a.createRef(),this.stopDragging=this.stopDragging.bind(this),this.drag=this.drag.bind(this),window.addEventListener("mouseup",this.stopDragging),window.addEventListener("mousemove",this.drag)}componentWillUnmount(){window.removeEventListener("mouseup",this.stopDragging),window.removeEventListener("mousemove",this.drag)}stopDragging(){this.setState({isDragging:!1})}drag(e){if(!this.state.isDragging)return;const t=Math.max(0,Math.min((e.clientX-this.myRoot.current.offsetLeft)/this.myRoot.current.clientWidth,1));this.props.onChange(this.props.min+t*(this.props.max-this.props.min))}render(){return Xi.a.createElement("div",{className:xn()(hc.a.numberWithRange)},Xi.a.createElement("div",{className:xn()(hc.a.numberInNumberWithRange)},Xi.a.createElement("input",{type:"text",value:this.props.currentValue.toFixed(2),onClick:e=>{e.preventDefault(),e.target.focus(),e.target.select()},onChange:e=>{const t=parseInt(e.target.value);this.props.onChange(t||0,!0)}})),Xi.a.createElement("div",{ref:this.myRoot,className:xn()(hc.a.rangeSlider),onMouseDown:e=>{e.preventDefault(),this.setState({isDragging:!0});const t=Math.max(0,Math.min((e.clientX-this.myRoot.current.offsetLeft)/this.myRoot.current.clientWidth,1));this.props.onChange(this.props.min+t*(this.props.max-this.props.min))}},Xi.a.createElement("input",{type:"range",min:this.props.min,max:this.props.max,value:this.props.currentValue,onChange:e=>{this.props.onChange(e.target.value)}})))}}function gc(){return(gc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function fc(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}pc(mc,"propTypes",{min:wn.a.number,max:wn.a.number,currentValue:wn.a.number,onChange:wn.a.func});const vc={CHECK_BOX:1,SELECT:2,NUMBER_WITH_RANGE:3,MAX_RESOLUTION:4};class bc extends Yi.Component{render(){return Xi.a.createElement("div",{className:xn()(hc.a.maxResolutionPreferenceItem)},Xi.a.createElement("input",{tabIndex:"0",type:"number",step:"1",min:"0",value:void 0===this.props.store.state.preferences.maxResolutionWidth?1920:this.props.store.state.preferences.maxResolutionWidth,onClick:e=>{e.preventDefault(),e.target.focus(),e.target.select()},onChange:e=>{const t=parseInt(e.target.value);this.props.store.update({preferences:{maxResolutionWidth:t||0}})}}),"x",Xi.a.createElement("input",{tabIndex:"0",type:"number",step:"1",min:"0",value:void 0===this.props.store.state.preferences.maxResolutionHeight?1920:this.props.store.state.preferences.maxResolutionHeight,onClick:e=>{e.preventDefault(),e.target.focus(),e.target.select()},onChange:e=>{const t=parseInt(e.target.value);this.props.store.update({preferences:{maxResolutionHeight:t||0}})}}))}}fc(bc,"propTypes",{store:wn.a.object});class yc extends Yi.Component{constructor(...e){super(...e),fc(this,"state",{hovered:!1,selectHovered:!1}),fc(this,"storeUpdated",()=>{this.forceUpdate()})}UNSAFE_componentWillMount(){this.renderControls=this.renderControls.bind(this),this.props.store.addEventListener("statechanged",this.storeUpdated),Object(ne.a)().then(()=>{this.sfx=AFRAME.scenes[0].systems["hubs-systems"].soundEffectsSystem})}componentWillUnmount(){this.props.store.removeEventListener("statechanged",this.storeUpdated)}renderControls(){let e,t;switch(this.props.prefType){case vc.CHECK_BOX:return t=this.props.store.state.preferences[this.props.storeKey],Xi.a.createElement("div",{className:xn()(hc.a.checkbox)},Xi.a.createElement("input",{tabIndex:"0",type:"checkbox",checked:void 0===t?this.props.defaultBool:t,onChange:()=>{this.props.store.update({preferences:{[this.props.storeKey]:!this.props.store.state.preferences[this.props.storeKey]}})}}));case vc.MAX_RESOLUTION:return Xi.a.createElement(bc,{store:this.props.store});case vc.SELECT:return e=this.props.options.map((e,t)=>{const i={},n=this.props.store.state.preferences[this.props.storeKey];return e.value!==n&&(void 0!==n&&""!==n||e.value!==this.props.defaultString)||(i.selected="selected"),Xi.a.createElement("option",gc({key:`${this.props.storeKey}_${t}`,value:e.value},i),e.text)}),Xi.a.createElement("div",{className:hc.a.dropdown},Xi.a.createElement("select",{tabIndex:"0",className:xn()({[hc.a.hovered]:this.state.hovered,[hc.a.selectHovered]:this.state.selectHovered}),onMouseEnter:()=>{this.setState({selectHovered:!0})},onMouseLeave:()=>{this.setState({selectHovered:!1})},onChange:e=>{this.props.store.update({preferences:{[this.props.storeKey]:e.target.value}})}},e),Xi.a.createElement("img",{className:hc.a.dropdownArrow,src:gn.a,srcSet:vn.a+" 2x"}));case vc.NUMBER_WITH_RANGE:return Xi.a.createElement(mc,{min:this.props.min,max:this.props.max,currentValue:void 0!==this.props.store.state.preferences[this.props.storeKey]?this.props.store.state.preferences[this.props.storeKey]:this.props.defaultNumber,onChange:(e,t)=>{this.props.store.update({preferences:{[this.props.storeKey]:Number.parseFloat(e)}}),t&&this.sfx&&this.sfx.playSoundOneShot(v.n)}});default:return Xi.a.createElement("div",null)}}render(){const e=this.props.prefType===vc.CHECK_BOX;return Xi.a.createElement("div",{className:xn()({[hc.a.hovered]:this.state.hovered},hc.a.preferenceListItem,!e&&hc.a.preferenceListNonCheckbox),onMouseEnter:()=>{this.setState({hovered:!0})},onMouseLeave:()=>{this.setState({hovered:!1})}},Xi.a.createElement("div",{className:xn()(hc.a.checkboxMargin)},e?this.renderControls():Xi.a.createElement("span",null,"")),Xi.a.createElement("div",{className:xn()(hc.a.part,hc.a.left,hc.a.label)},Xi.a.createElement(kn.a,{id:`preferences.${this.props.storeKey}`})),Xi.a.createElement("div",{className:xn()(hc.a.part,hc.a.right)},!e&&this.renderControls(),Xi.a.createElement("button",{className:xn()(hc.a.resetToDefaultButton),onClick:()=>{switch(this.props.prefType){case vc.MAX_RESOLUTION:this.props.store.update({preferences:{maxResolutionWidth:void 0,maxResolutionHeight:void 0}});break;default:this.props.store.update({preferences:{[this.props.storeKey]:void 0}})}this.forceUpdate()}},Xi.a.createElement("i",{title:"Reset to default"},Xi.a.createElement(qa.a,{icon:uc.faUndo})))))}}fc(yc,"propTypes",{store:wn.a.object,storeKey:wn.a.string,prefType:wn.a.number,min:wn.a.number,max:wn.a.number,onChange:wn.a.func,options:wn.a.array,defaultNumber:wn.a.number,defaultString:wn.a.string,defaultBool:wn.a.bool}),Object(kn.c)([...Tn.a]);const _c=AFRAME.utils.device.isMobile()||AFRAME.utils.device.isMobileVR();class wc extends Yi.Component{UNSAFE_componentWillMount(){window.APP.preferenceScreenIsVisible=!0}componentWillUnmount(){window.APP.preferenceScreenIsVisible=!1}render(){const e=e=>Xi.a.createElement(yc,{key:e.key,store:this.props.store,storeKey:e.key,prefType:e.prefType,min:e.min,max:e.max,currentValue:e.currentValue,onChange:e.onChange,options:e.options,defaultNumber:e.defaultNumber,defaultString:e.defaultString,defaultBool:e.defaultBool}),t=[{key:"muteMicOnEntry",prefType:vc.CHECK_BOX,defaultBool:!1},{key:"onlyShowNametagsInFreeze",prefType:vc.CHECK_BOX,defaultBool:!1},{key:"allowMultipleHubsInstances",prefType:vc.CHECK_BOX,defaultBool:!1},{key:"maxResolution",prefType:vc.MAX_RESOLUTION},{key:"materialQualitySetting",prefType:vc.SELECT,options:[{value:"low",text:"Low"},{value:"high",text:"High"}],defaultString:_c?"low":"high"},{key:"globalVoiceVolume",prefType:vc.NUMBER_WITH_RANGE,min:0,max:200,defaultNumber:100},{key:"globalMediaVolume",prefType:vc.NUMBER_WITH_RANGE,min:0,max:200,defaultNumber:100},{key:"snapRotationDegrees",prefType:vc.NUMBER_WITH_RANGE,min:0,max:90,defaultNumber:45},{key:"disableMovement",prefType:vc.CHECK_BOX,defaultBool:!1},{key:"disableBackwardsMovement",prefType:vc.CHECK_BOX,defaultBool:!1},{key:"disableStrafing",prefType:vc.CHECK_BOX,defaultBool:!1},{key:"disableTeleporter",prefType:vc.CHECK_BOX,defaultBool:!1}].map(e),i=[{key:"enableOnScreenJoystickLeft",prefType:vc.CHECK_BOX,defaultBool:!1},{key:"enableOnScreenJoystickRight",prefType:vc.CHECK_BOX,defaultBool:!1}].map(e);return Xi.a.createElement(kn.b,{locale:ba.a,messages:ba.b},Xi.a.createElement("div",{className:xn()(hc.a.preferencesPanel)},Xi.a.createElement("div",{className:xn()(hc.a.panelMargin)},Xi.a.createElement("button",{autoFocus:!0,className:xn()(hc.a.closeButton),onClick:e=>this.props.onClose(e)},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Ja.faTimes}))),Xi.a.createElement("div",{className:xn()(hc.a.contentContainer)},Xi.a.createElement("div",{className:xn()(hc.a.sectionBar)},Xi.a.createElement("div",{className:xn()(hc.a.sectionTitle)},Xi.a.createElement("span",null,"General"))),Xi.a.createElement("div",{className:xn()(hc.a.scrollingContent)},t),Xi.a.createElement("div",{className:xn()(hc.a.sectionBar)},Xi.a.createElement("div",{className:xn()(hc.a.sectionTitle)},Xi.a.createElement("span",null,"Touchscreen"))),Xi.a.createElement("div",{className:xn()(hc.a.scrollingContent)},i)))))}}!function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(wc,"propTypes",{onClose:wn.a.func,store:wn.a.object});var Ec=i(541),xc=i.n(Ec),Sc=i(542),Cc=i.n(Sc),kc=i(543),Ac=i.n(kc),Tc=i(544),Mc=i.n(Tc),Lc=i(545),Rc=i.n(Lc),Pc=i(546),Dc=i.n(Pc);class Oc extends Yi.Component{constructor(e){super(e),function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"state",{tonePlaying:!1}),this.playTestTone=this.playTestTone.bind(this),this.toneClip=document.createElement("audio"),this.toneClip.canPlayType("audio/webm")?this.toneClip.src=Ac.a:this.toneClip.canPlayType("audio/mpeg")?this.toneClip.src=Mc.a:this.toneClip.canPlayType("audio/ogg")?this.toneClip.src=Rc.a:this.toneClip.src=Dc.a}componentWillUnmount(){this.toneClip.pause(),this.toneClip.currentTime=0,null!=this.testToneTimeout&&clearTimeout(this.testToneTimeout)}playTestTone(){null!=this.testToneTimeout&&clearTimeout(this.testToneTimeout),this.toneClip.currentTime=0,this.toneClip.play(),this.setState({tonePlaying:!0}),this.testToneTimeout=setTimeout(()=>{this.setState({tonePlaying:!1})},1393)}render(){const e=`audio-setup-panel__levels__icon_clickable__${this.state.tonePlaying?"playing":"pending"}`;return Xi.a.createElement(Xn.b,null,Xi.a.createElement("div",{className:"audio-setup-panel__levels__icon_clickable",onClick:this.playTestTone},Xi.a.createElement("img",{src:xc.a,srcSet:Cc.a+" 2x",className:"audio-setup-panel__levels__icon-part"}),Xi.a.createElement("div",{className:e},Xi.a.createElement("svg",{width:"111",height:"111",viewBox:"0 0 111 111",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Xi.a.createElement("circle",{cx:"55.5",cy:"55.5",r:"55.5",fill:"currentColor",fillOpacity:"0.8"}))),Xi.a.createElement("div",{className:"audio-setup-panel__levels__test_label"},Xi.a.createElement(kn.a,{id:"audio.click_to_test"}))))}}function Hc({name:e,body:{src:t},className:i,maySpawn:a,hubId:s}){const o=Object(h.e)(t),r=Vn.bind(null,{url:o,title:`Taken in ${ba.b["share-hashtag"]}, join me at https://${n.a.SHORTLINK_DOMAIN}/${s}`});return Xi.a.createElement("div",{className:i},a&&Xi.a.createElement("button",{className:xn()(al.a.iconButton,al.a.share),onClick:r}),Xi.a.createElement("div",{className:al.a.mediaBody},Xi.a.createElement("span",null,Xi.a.createElement("b",null,e)),Xi.a.createElement("span",null,"took a ",Xi.a.createElement("b",null,Xi.a.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer"},"photo")),".")),Xi.a.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer"},Xi.a.createElement("img",{src:t})))}function jc({name:e,body:{src:t},className:i,maySpawn:a,hubId:s}){const o=Vn.bind(null,{url:t,title:`Taken in ${ba.b["share-hashtag"]}, join me at https://${n.a.SHORTLINK_DOMAIN}/${s}`});return Xi.a.createElement("div",{className:i},a&&Xi.a.createElement("button",{className:xn()(al.a.iconButton,al.a.share),onClick:o}),Xi.a.createElement("div",{className:al.a.mediaBody},Xi.a.createElement("span",null,Xi.a.createElement("b",null,e)),Xi.a.createElement("span",null,"took a ",Xi.a.createElement("b",null,Xi.a.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer"},"video")),".")))}function Ic({name:e,body:{src:t},className:i,maySpawn:n}){return Xi.a.createElement("div",{className:i},n&&Xi.a.createElement("button",{className:xn()(al.a.iconButton,al.a.spawnMessage),onClick:()=>(function(e){document.querySelector("a-scene").emit("add_media",e)})(t)}),Xi.a.createElement("div",{className:al.a.mediaBody},e&&Xi.a.createElement("div",{className:al.a.messageSource},e,":")),Xi.a.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer"},Xi.a.createElement("img",{src:Object(Ne.i)(t)})))}function Nc(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Hc.propTypes={name:wn.a.string,maySpawn:wn.a.bool,body:wn.a.object,className:wn.a.string,hubId:wn.a.string},jc.propTypes={name:wn.a.string,maySpawn:wn.a.bool,body:wn.a.object,className:wn.a.string,hubId:wn.a.string},Ic.propTypes={name:wn.a.string,maySpawn:wn.a.bool,body:wn.a.object,className:wn.a.string};class Fc extends Yi.Component{constructor(e){super(e),Nc(this,"domForEntry",e=>{const t={[al.a.presenceLogEntry]:!0,[al.a.presenceLogEntryWithButton]:("chat"===e.type||"image"===e.type)&&e.maySpawn,[al.a.presenceLogChat]:"chat"===e.type,[al.a.expired]:!!e.expired},i=!!(e.sessionId?Object(h.f)(this.props.presences,e.sessionId):{}).discord;switch(e.type){case"join":case"entered":return Xi.a.createElement("div",{key:e.key,className:xn()(t)},Xi.a.createElement("b",null,e.name),"",Xi.a.createElement(kn.a,{id:`presence.${e.type}_${e.presence}`}));case"leave":return Xi.a.createElement("div",{key:e.key,className:xn()(t)},Xi.a.createElement("b",null,e.name),"",Xi.a.createElement(kn.a,{id:`presence.${e.type}`}));case"display_name_changed":return Xi.a.createElement("div",{key:e.key,className:xn()(t)},Xi.a.createElement("b",null,e.oldName),"",Xi.a.createElement(kn.a,{id:"presence.name_change"}),"",Xi.a.createElement("b",null,e.newName),".");case"scene_changed":return Xi.a.createElement("div",{key:e.key,className:xn()(t)},Xi.a.createElement("b",null,e.name),"",Xi.a.createElement(kn.a,{id:"presence.scene_change"}),"",Xi.a.createElement("b",null,e.sceneName),".");case"hub_name_changed":return Xi.a.createElement("div",{key:e.key,className:xn()(t)},Xi.a.createElement("b",null,e.name),"",Xi.a.createElement(kn.a,{id:"presence.hub_name_change"}),"",Xi.a.createElement("b",null,e.hubName),".");case"chat":return Xi.a.createElement(Nl,{key:e.key,name:e.name,className:xn()(t),body:e.body,maySpawn:e.maySpawn,sessionId:e.sessionId,includeFromLink:this.props.inRoom&&!i,history:this.props.history});case"image":return Xi.a.createElement(Ic,{key:e.key,name:e.name,className:xn()(t,al.a.media),body:e.body,maySpawn:e.maySpawn});case"photo":return Xi.a.createElement(Hc,{key:e.key,name:e.name,className:xn()(t,al.a.media),body:e.body,maySpawn:e.maySpawn,hubId:this.props.hubId});case"video":return Xi.a.createElement(jc,{key:e.key,name:e.name,className:xn()(t,al.a.media),body:e.body,maySpawn:e.maySpawn,hubId:this.props.hubId});case"log":return Xi.a.createElement("div",{key:e.key,className:xn()(t)},e.body)}})}render(){const e={[al.a.presenceLog]:!0,[al.a.presenceLogInRoom]:this.props.inRoom};return Xi.a.createElement("div",{className:xn()(e)},this.props.entries.map(this.domForEntry))}}Nc(Fc,"propTypes",{entries:wn.a.array,inRoom:wn.a.bool,hubId:wn.a.string,history:wn.a.object,presences:wn.a.object});var Vc=i(547),Bc=i(548),zc=i(549),Uc=i(297),Wc=i(550),Zc=i(298);function Gc(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const qc=new Map([[rr,"Video"],[lr,"Audio"],[cr,"Image"],[dr,"PDF"],[ur,"Unknown Media Type"],[hr,"Model"]]),$c=new Map([[rr,bl.faVideo],[lr,zc.faMusic],[cr,Uc.faImage],[dr,Wc.faNewspaper],[ur,Zc.faQuestion],[hr,Bc.faCube]]);class Yc extends Yi.Component{constructor(...e){super(...e),Gc(this,"state",{inspecting:!1,mediaEntities:[]})}componentDidMount(){document.querySelector(".a-canvas").addEventListener("mouseup",()=>{this.props.expanded&&this.props.onExpand(!1,!0)}),this.updateMediaEntities=this.updateMediaEntities.bind(this),this.updateMediaEntities(),this.props.scene.addEventListener("listed_media_changed",()=>this.updateMediaEntities())}updateMediaEntities(){const e=[...this.props.scene.systems["listed-media"].els];e.sort(mr),this.setState({mediaEntities:e})}componentDidUpdate(){}domForEntity(e,t){return Xi.a.createElement("div",{key:t,className:ml.a.rowNoMargin,onMouseDown:()=>{this.props.onExpand(!1,!1),this.props.onInspectObject(e)},onMouseOut:()=>{this.props.expanded&&!AFRAME.utils.device.isMobileVR()&&AFRAME.scenes[0].systems["hubs-systems"].cameraSystem.uninspect()},onMouseOver:()=>{AFRAME.scenes[0].systems["hubs-systems"].cameraSystem.uninspect(),AFRAME.scenes[0].systems["hubs-systems"].cameraSystem.inspect(e.object3D,1.5,!0)}},Xi.a.createElement("div",{title:qc.get(pr(e)),className:ml.a.icon},Xi.a.createElement(qa.a,{icon:$c.get(pr(e))})),Xi.a.createElement("div",{className:xn()({[ml.a.listItem]:!0})},Xi.a.createElement("div",{className:ml.a.presence},Xi.a.createElement("p",null,function(e){const t=e.components["media-loader"].data.src,i=t.split("/"),n=i[i.length-1].split("?")[0];let a=-1;for(let e=0;e<i.length;e++)-1!==i[e].indexOf("http")&&(a=e);let s="",o="";if(-1!==a&&i.length>a+3){const e=(s=i[a+2]).split(".");e.length>1&&(o=`${e[e.length-2]}.${e[e.length-1]}`)}return`${-1!==t.indexOf("poly.google")?"Google Poly":-1!==t.indexOf("sketchfab.com")?"Sketchfab":-1!==t.indexOf("youtube.com")?"YouTube":o} ... ${n.substr(0,4)}`}(e)))))}renderExpandedList(){return Xi.a.createElement("div",{className:ml.a.presenceList},Xi.a.createElement("div",{className:ml.a.contents},Xi.a.createElement("div",{className:ml.a.rows},this.state.mediaEntities.map(this.domForEntity.bind(this)))))}render(){return Xi.a.createElement("div",null,Xi.a.createElement("div",{title:"Media",onClick:()=>{this.props.onExpand(!this.props.expanded&&this.state.mediaEntities.length>0,!AFRAME.utils.device.isMobileVR())},className:xn()({[Zn.a.objectList]:!0,[Zn.a.presenceInfoSelected]:this.props.expanded})},Xi.a.createElement(qa.a,{icon:Vc.faCubes}),Xi.a.createElement("span",{className:Zn.a.occupantCount},this.state.mediaEntities.length)),this.props.expanded&&this.renderExpandedList())}}Gc(Yc,"propTypes",{onInspectObject:wn.a.func,onExpand:wn.a.func,scene:wn.a.object,expanded:wn.a.bool});var Xc=i(551),Qc=i(287),Kc=i(552),Jc=i(553),ed=i(554),td=i(24),id=i.n(td);function nd(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class ad extends Yi.Component{constructor(...e){super(...e),nd(this,"state",{expanded:!1})}unexpand(){this.state.expanded&&!this.props.showAsOverlay&&this.setState({expanded:!1})}componentDidMount(){this.onMouseUp=()=>this.unexpand(),this.acanvas=document.querySelector(".a-canvas"),this.acanvas.addEventListener("mouseup",this.onMouseUp)}componentWillUnmount(){this.acanvas.removeEventListener("mouseup",this.onMouseUp)}renderExpandedMenu(){const e=xn()([id.a.row,id.a.settingsRow]),t=xn()([id.a.row,id.a.settingsRow,id.a.rowHeader]),i=this.props.showAsOverlay,a=!!this.props.hubChannel.canOrWillIfCreator("update_hub"),s=!!this.props.hubChannel.canOrWillIfCreator("close_hub"),o=!!this.props.hubScene&&!i,r=a||o||s,l=this.props.scene.is("entered")&&!!this.props.hubChannel.canOrWillIfCreator("kick_users")&&!i;return Xi.a.createElement("div",{className:xn()({[id.a.settingsMenuDrop]:!this.props.showAsOverlay,[id.a.settingsMenuOverlay]:this.props.showAsOverlay})},!this.props.showAsOverlay&&Xi.a.createElement("div",{className:id.a.attachPoint}),Xi.a.createElement("div",{className:id.a.contents},this.props.showAsOverlay&&Xi.a.createElement("button",{autoFocus:!0,className:id.a.closeButton,onClick:()=>this.props.onCloseOverlay()},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Ja.faTimes}))),Xi.a.createElement("div",{className:id.a.rows},!i&&Xi.a.createElement("div",{className:t},Xi.a.createElement(kn.a,{id:"settings.row-profile"})),Xi.a.createElement("div",{className:e},Xi.a.createElement("div",{className:id.a.icon},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Xc.faUserAlt}))),Xi.a.createElement("div",{className:id.a.listItem},Xi.a.createElement(Ka.a,{stateKey:"overlay",stateValue:"profile",history:this.props.history,onClick:()=>this.unexpand()},Xi.a.createElement(kn.a,{id:"settings.change-avatar"})))),Xi.a.createElement("div",{className:e},Xi.a.createElement("div",{className:id.a.icon},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:ls.faStar}))),Xi.a.createElement("div",{className:id.a.listItem},Xi.a.createElement("div",{className:id.a.listItemLink,onClick:()=>{this.props.performConditionalSignIn(()=>this.props.hubChannel.signedIn,()=>{Object($t.a)(),this.props.mediaSearchStore.sourceNavigateWithNoNav("favorites","use")},"favorite-rooms")}},Xi.a.createElement(kn.a,{id:"settings.favorites"})))),Xi.a.createElement("div",{className:e},Xi.a.createElement("div",{className:id.a.icon},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Qc.faCog}))),Xi.a.createElement("div",{className:id.a.listItem},Xi.a.createElement("div",{className:id.a.listItemLink,onClick:()=>{this.props.showPreferencesScreen()}},Xi.a.createElement(kn.a,{id:"settings.preferences"})))),r&&!i&&Xi.a.createElement("div",{className:t},Xi.a.createElement(kn.a,{id:"settings.row-room"})),a&&Xi.a.createElement("div",{className:e},Xi.a.createElement("div",{className:id.a.icon},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Uc.faImage}))),Xi.a.createElement("div",{className:id.a.listItem},Xi.a.createElement("div",{className:id.a.listItemLink,onClick:()=>{this.props.performConditionalSignIn(()=>this.props.hubChannel.can("update_hub"),()=>{Object($t.a)(),this.props.mediaSearchStore.sourceNavigateWithNoNav("scenes","use"),this.unexpand()},"change-scene")}},Xi.a.createElement(kn.a,{id:"settings.change-scene"})))),a&&Xi.a.createElement("div",{className:e},Xi.a.createElement("div",{className:id.a.icon},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Ga.faPencilAlt}))),Xi.a.createElement("div",{className:id.a.listItem},Xi.a.createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.props.performConditionalSignIn(()=>this.props.hubChannel.can("update_hub"),()=>{this.props.pushHistoryState("modal","room_settings"),this.unexpand()},"room-settings")}},Xi.a.createElement(kn.a,{id:"settings.room-settings"})))),s&&Xi.a.createElement("div",{className:e},Xi.a.createElement("div",{className:id.a.icon},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Kc.faDoorClosed}))),Xi.a.createElement("div",{className:id.a.listItem},Xi.a.createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.props.performConditionalSignIn(()=>this.props.hubChannel.can("update_hub"),()=>{this.props.pushHistoryState("modal","close_room"),this.unexpand()},"close-room")}},Xi.a.createElement(kn.a,{id:"settings.close-room"})))),o&&Xi.a.createElement("div",{className:e},Xi.a.createElement("div",{className:id.a.icon},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Jc.faInfoCircle}))),Xi.a.createElement("div",{className:id.a.listItem},Xi.a.createElement(Ka.a,{stateKey:"modal",stateValue:"room_info",history:this.props.history,onClick:()=>this.unexpand()},Xi.a.createElement(kn.a,{id:"settings.room-info"})))),!i&&Xi.a.createElement("div",{className:e},Xi.a.createElement("div",{className:id.a.icon},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:il.faPlus}))),Xi.a.createElement("div",{className:id.a.listItem},Xi.a.createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.props.showNonHistoriedDialog(nr,{destinationUrl:"/",messageType:"create-room"}),this.unexpand()}},Xi.a.createElement(kn.a,{id:"settings.create-room"})))),l&&!i?Xi.a.createElement("div",{className:t},Xi.a.createElement(kn.a,{id:"settings.row-tools"})):Xi.a.createElement("div",null),l?Xi.a.createElement("div",{className:e},Xi.a.createElement("div",{className:id.a.icon},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:bl.faVideo}))),Xi.a.createElement("div",{className:id.a.listItem},Xi.a.createElement("div",{className:id.a.listItemLink,onClick:()=>{this.props.toggleStreamerMode(!0),this.unexpand()}},Xi.a.createElement(kn.a,{id:"settings.enable-streamer-mode"})))):Xi.a.createElement("div",null),this.props.showAsOverlay&&Xi.a.createElement("div",{className:e},Xi.a.createElement("div",{className:xn()([id.a.listItem,id.a.secondaryLinkItem])},Xi.a.createElement("div",{className:id.a.secondaryButton,onClick:()=>this.props.onCloseOverlay()},Xi.a.createElement(kn.a,{id:"settings.return-to-vr"})))),!i&&Xi.a.createElement("div",{className:xn()([id.a.bottomLinksMain])},Xi.a.createElement(Mn.a,{name:"show_whats_new_link"},Xi.a.createElement("a",{href:"/whats-new",target:"_blank",rel:"noreferrer noopener"},Xi.a.createElement(kn.a,{id:"settings.whats-new"}))),Xi.a.createElement("button",{onClick:e=>{e.preventDefault(),Io(),this.setState({expanded:!1})}},Xi.a.createElement(kn.a,{id:"settings.tips"})),Xi.a.createElement(Mn.a,{name:"show_controls_link"},Xi.a.createElement("a",{href:n.a.link("controls","https://github.com/mozilla/hubs/wiki/Hubs-Controls"),target:"_blank",rel:"noreferrer noopener"},Xi.a.createElement(kn.a,{id:"settings.controls"})))),!i&&Xi.a.createElement("div",{className:xn()([id.a.bottomLinks])},Xi.a.createElement(Mn.a,{name:"show_features_link"},Xi.a.createElement("a",{href:n.a.link("features",ba.b["help.docs_url"]),target:"_blank",rel:"noreferrer noopener"},Xi.a.createElement(kn.a,{id:"settings.features"}))),Xi.a.createElement(Mn.a,{name:"show_community_link"},Xi.a.createElement("a",{href:n.a.link("community","https://discord.gg/wHmY4nd"),target:"_blank",rel:"noreferrer noopener"},Xi.a.createElement(kn.a,{id:"settings.community"}))),Xi.a.createElement(Mn.a,{name:"show_feedback_ui"},Xi.a.createElement("button",{onClick:e=>{e.preventDefault(),this.props.pushHistoryState("modal","feedback")}},Xi.a.createElement(kn.a,{id:"settings.send-feedback"}))),Xi.a.createElement(Mn.a,{name:"show_issue_report_link"},Xi.a.createElement("a",{className:id.a.bottomLink,href:n.a.link("issue_report","/#/report"),target:"_blank",rel:"noreferrer noopener"},Xi.a.createElement(kn.a,{id:"settings.report"}))),Xi.a.createElement(Mn.a,{name:"show_terms"},Xi.a.createElement("a",{className:id.a.bottomLink,href:n.a.link("terms_of_use","https://github.com/mozilla/hubs/blob/master/TERMS.md"),target:"_blank",rel:"noreferrer noopener"},Xi.a.createElement(kn.a,{id:"settings.terms"}))),Xi.a.createElement(Mn.a,{name:"show_privacy"},Xi.a.createElement("a",{className:id.a.bottomLink,href:n.a.link("privacy_notice","https://github.com/mozilla/hubs/blob/master/PRIVACY.md"),target:"_blank",rel:"noreferrer noopener"},Xi.a.createElement(kn.a,{id:"settings.privacy"})))))))}render(){return Xi.a.createElement("div",null,!this.props.showAsOverlay&&Xi.a.createElement(qa.a,{icon:ed.faBars,onClick:()=>this.setState({expanded:!this.state.expanded}),className:xn()({[Zn.a.cornerButton]:!0,[Zn.a.cornerButtonSelected]:this.state.expanded})}),this.props.showAsOverlay?Xi.a.createElement("div",{className:id.a.settingsMenuOverlayWrap},this.renderExpandedMenu()):this.state.expanded&&this.renderExpandedMenu())}}nd(ad,"propTypes",{history:wn.a.object,isStreaming:wn.a.bool,toggleStreamerMode:wn.a.func,mediaSearchStore:wn.a.object,scene:wn.a.object,showAsOverlay:wn.a.bool,onCloseOverlay:wn.a.func,hubScene:wn.a.object,hubChannel:wn.a.object,performConditionalSignIn:wn.a.func,showNonHistoriedDialog:wn.a.func,showPreferencesScreen:wn.a.func,pushHistoryState:wn.a.func});var sd=i(154),od=i.n(sd);const rd=AFRAME.utils.device.isMobile();class ld extends Yi.Component{render(){return Xi.a.createElement("div",{className:od.a.treatment},Xi.a.createElement("div",{className:od.a.screenshot},this.props.hubScene&&Xi.a.createElement("img",{className:od.a.screenshot,src:this.props.hubScene.screenshot_url})),Xi.a.createElement("a",{href:"/",target:"_blank",rel:"noopener noreferrer",className:od.a.logo},Xi.a.createElement("img",{src:n.a.image("logo")})),Xi.a.createElement("div",{className:od.a.mainPanel},Xi.a.createElement("div",{className:od.a.hubName},this.props.hubName),this.props.onLoadClicked&&(rd?Xi.a.createElement("a",{href:this.props.baseUrl,target:"_blank",className:od.a.loadButton,rel:"noreferrer noopener"},Xi.a.createElement(kn.a,{id:"embed.load-button"})):Xi.a.createElement("button",{className:od.a.loadButton,onClick:this.props.onLoadClicked},Xi.a.createElement(kn.a,{id:"embed.load-button"})))))}}!function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(ld,"propTypes",{hubName:wn.a.string,hubScene:wn.a.object,baseUrl:wn.a.string,onLoadClicked:wn.a.func});var cd=i(36),dd=i.n(cd),hd=i(555),ud=i.n(hd),pd=i(556),md=i.n(pd),gd=i(557),fd=i.n(gd),vd=i(558),bd=i.n(vd),yd=i(559),_d=i.n(yd),wd=i(560),Ed=i.n(wd),xd=i(561),Sd=i.n(xd),Cd=i(562),kd=i.n(Cd),Ad=i(563),Td=i.n(Ad),Md=i(564),Ld=i.n(Md),Rd=i(565),Pd=i.n(Rd),Dd=i(566),Od=i.n(Dd),Hd=i(567),jd=i.n(Hd),Id=i(568),Nd=i.n(Id),Fd=i(569),Vd=i.n(Fd),Bd=i(570),zd=i.n(Bd),Ud=i(571),Wd=i.n(Ud),Zd=i(572),Gd=i.n(Zd),qd=i(573),$d=i.n(qd),Yd=i(574),Xd=i.n(Yd),Qd=i(575),Kd=i.n(Qd),Jd=i(576),eh=i.n(Jd),th=i(577),ih=i.n(th),nh=i(578),ah=i.n(nh),sh=i(579),oh=i.n(sh);function rh(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const lh={on:[Ld.a,Pd.a,Od.a,jd.a,Nd.a,Vd.a,zd.a,Wd.a],off:[Gd.a,$d.a,Xd.a,Kd.a,eh.a,ih.a,ah.a,oh.a]},ch=()=>{};class dh extends Yi.Component{constructor(e){super(e),rh(this,"state",{showVideoShareOptions:!1,lastActiveMediaSource:null,micLevel:0,cameraDisabled:!1,penDisabled:!1,mediaDisabled:!1}),rh(this,"onPermissionsUpdated",()=>{this.setState({cameraDisabled:!window.APP.hubChannel.can("spawn_camera"),penDisabled:!window.APP.hubChannel.can("spawn_drawing"),mediaDisabled:!window.APP.hubChannel.can("spawn_and_move_media")})}),rh(this,"componentDidMount",()=>{let e=0;this.micUpdateInterval&&clearInterval(this.micUpdateInterval),this.micUpdateInterval=setInterval(()=>{const t=this.props.scene.systems["local-audio-analyser"].volume;e=Math.max(t,e);const i=Object(Mt.b)(t,e);i!==this.state.micLevel&&this.setState({micLevel:i})},50),window.APP.hubChannel.addEventListener("permissions_updated",this.onPermissionsUpdated),this.onPermissionsUpdated()}),rh(this,"componentWillUnmount",()=>{this.micUpdateInterval&&clearInterval(this.micUpdateInterval),window.APP.hubChannel.removeEventListener("permissions_updated",this.onPermissionsUpdated)}),rh(this,"handleVideoShareClicked",e=>{"screen"!==e||navigator.mediaDevices.getDisplayMedia?this.props.videoShareMediaSource?this.props.onEndShareVideo():(this.props.onShareVideo(e),this.setState({lastActiveMediaSource:e})):this.props.onShareVideoNotCapable()}),rh(this,"buildVideoSharingButtons",()=>{const e=AFRAME.utils.device.isMobile()||AFRAME.utils.device.isMobileVR(),t=[],i=this.props.videoShareMediaSource||this.state.lastActiveMediaSource||(e?"camera":"screen");this.state.showVideoShareOptions&&(t.push(i),["screen","camera"].forEach(e=>{-1===t.indexOf(e)&&t.push(e)}));const n=()=>{e||(clearTimeout(this.hideVideoSharingButtonTimeout),this.props.videoShareMediaSource||this.setState({showVideoShareOptions:!0}))},a=e=>e[0].toUpperCase()+e.slice(1),s=(e,t)=>t?"screen"===e?md.a:bd.a:"screen"===e?fd.a:_d.a;return Xi.a.createElement("div",{className:xn()(dd.a.iconButton,{[dd.a.disabled]:this.state.mediaDisabled,[dd.a.videoShare]:!0}),title:null!==this.props.videoShareMediaSource?"Stop sharing":`Share ${a(i)}${this.state.mediaDisabled?" Disabled":""}`,onClick:this.state.mediaDisabled?ch:()=>{this.state.showVideoShareOptions||this.handleVideoShareClicked(i)},onMouseOver:this.state.mediaDisabled?ch:n},Xi.a.createElement(Ia,{className:xn()(dd.a.iconButtonIcon),src:s(i,this.props.videoShareMediaSource===i)}),t.length>0&&Xi.a.createElement("div",{className:xn()(dd.a.videoShareExtraOptions),onMouseOut:()=>{this.hideVideoSharingButtonTimeout=setTimeout(()=>{this.setState({showVideoShareOptions:!1})},250)}},t.map(e=>Xi.a.createElement("div",{key:e,className:xn()(dd.a.iconButton,{[dd.a.disabled]:this.state.mediaDisabled}),title:this.props.videoShareMediaSource===e?"Stop sharing":`Share ${a(e)}${this.state.mediaDisabled?" Disabled":""}`,onClick:this.state.mediaDisabled?ch:()=>this.handleVideoShareClicked(e),onMouseOver:this.state.mediaDisabled?ch:n},Xi.a.createElement(Ia,{className:xn()(dd.a.iconButtonIcon),src:s(e,this.props.videoShareMediaSource===e)})))))}),this.state.cameraDisabled=!window.APP.hubChannel.can("spawn_camera"),this.state.penDisabled=!window.APP.hubChannel.can("spawn_drawing"),this.state.mediaDisabled=!window.APP.hubChannel.can("spawn_and_move_media")}render(){const e=this.buildVideoSharingButtons(),t=AFRAME.utils.device.isMobile(),i=(e,t)=>Xi.a.createElement("div",{className:xn()(dd.a.topTip)},t&&Xi.a.createElement("button",{className:dd.a.tipCancel,onClick:t},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Ja.faTimes}))),!this.props.frozen&&Xi.a.createElement("div",{className:xn()([dd.a.attachPoint,dd.a[`attach_${e.split(".")[1]}`]])}),Xi.a.createElement(kn.a,{id:`tips.${e}`}));let n;this.props.watching?n=Xi.a.createElement("div",{className:xn()([dd.a.topTip,dd.a.topTipNoHud])},Xi.a.createElement("button",{className:dd.a.tipCancel,onClick:()=>this.props.onWatchEnded()},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Ja.faTimes}))),Xi.a.createElement(kn.a,{id:`tips.${t?"mobile":"desktop"}.watching`}),!t&&Xi.a.createElement("button",{className:dd.a.tipCancelText,onClick:()=>this.props.onWatchEnded()},Xi.a.createElement(kn.a,{id:"tips.watching.back"}))):this.props.showVideoShareFailed?n=i(`${t?"mobile":"desktop"}.video_share_failed`,this.props.hideVideoShareFailedTip):this.props.activeTip&&(n=i(this.props.activeTip));const a=this.state.micLevel,s=lh[this.props.muted?"off":"on"][a];return Xi.a.createElement("div",{className:xn()(dd.a.container,dd.a.top,dd.a.unselectable,Zn.a.uiInteractive)},this.props.frozen||this.props.watching?Xi.a.createElement("div",{className:xn()(Zn.a.uiInteractive,dd.a.panel)},n):Xi.a.createElement("div",{className:xn()(Zn.a.uiInteractive,dd.a.panel)},n,e,Xi.a.createElement("div",{className:xn()(dd.a.iconButton),title:this.props.muted?"Unmute Mic":"Mute Mic",onClick:this.props.onToggleMute},Xi.a.createElement(Ia,{className:xn()(dd.a.iconButtonIcon),src:s})),Xi.a.createElement("div",{className:xn()(dd.a.iconButton,{[dd.a.disabled]:this.state.mediaDisabled}),title:`Create${this.state.mediaDisabled?" Disabled":""}`,onClick:this.state.mediaDisabled?ch:()=>this.props.mediaSearchStore.sourceNavigateToDefaultSource()},Xi.a.createElement(Ia,{className:xn()(dd.a.iconButtonIcon,dd.a.spawn),src:ud.a})),Xi.a.createElement("div",{className:xn()(dd.a.iconButton,{[dd.a.disabled]:this.state.penDisabled}),title:`Pen${this.state.penDisabled?" Disabled":""}`,onClick:this.state.penDisabled?ch:this.props.onSpawnPen},Xi.a.createElement(Ia,{className:xn()(dd.a.iconButtonIcon),src:this.props.isCursorHoldingPen?Sd.a:Ed.a})),Xi.a.createElement("div",{className:xn()(dd.a.iconButton,{[dd.a.disabled]:this.state.cameraDisabled}),title:`Camera${this.state.cameraDisabled?" Disabled":""}`,onClick:this.state.cameraDisabled?ch:this.props.onSpawnCamera},Xi.a.createElement(Ia,{className:xn()(dd.a.iconButtonIcon),src:this.props.hasActiveCamera?Td.a:kd.a}))))}}rh(dh,"propTypes",{scene:wn.a.object,muted:wn.a.bool,isCursorHoldingPen:wn.a.bool,hasActiveCamera:wn.a.bool,frozen:wn.a.bool,watching:wn.a.bool,onWatchEnded:wn.a.func,videoShareMediaSource:wn.a.string,showVideoShareFailed:wn.a.bool,hideVideoShareFailedTip:wn.a.func,activeTip:wn.a.string,history:wn.a.object,onToggleMute:wn.a.func,onSpawnPen:wn.a.func,onSpawnCamera:wn.a.func,onShareVideo:wn.a.func,onEndShareVideo:wn.a.func,onShareVideoNotCapable:wn.a.func,mediaSearchStore:wn.a.object,isStreaming:wn.a.bool,showStreamingTip:wn.a.bool,hideStreamingTip:wn.a.func});var hh={TopHUD:dh},uh=i(580),ph=i.n(uh);class mh extends Yi.Component{render(){return Xi.a.createElement("div",{className:ph.a.label},Xi.a.createElement(kn.a,{id:"lobby.watching"}),Xi.a.createElement("b",null,this.props.name))}}!function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(mh,"propTypes",{name:wn.a.string});var gh=i(305);function fh(){return(fh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function vh(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),n.forEach(function(t){bh(e,t,i[t])})}return e}function bh(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function yh(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function _h(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){yh(s,n,a,o,r,"next",e)}function r(e){yh(s,n,a,o,r,"throw",e)}o(void 0)})}}const wh=Object(Me.a)("avatarEditorDebug");Object(kn.c)([...Tn.a]);const Eh=[/\Wvive\W/i,/\Wrift\W/i],xh=["/media"],Sh=["media_source"],Ch=["/media/scenes","/media/avatars","/media/favorites"],kh=["media_source"],Ah=["scenes","avatars","favorites"];function Th(){return(Th=_h(function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter(e=>e.label&&"audioinput"===e.kind).map(e=>e.label)})).apply(this,arguments)}const Mh=AFRAME.utils.device.isMobile(),Lh=AFRAME.utils.device.isMobileVR(),Rh=Mh||Lh,Ph=10;class Dh extends Yi.Component{constructor(e){var t;super(e),t=this,bh(this,"willCompileAndUploadMaterials",!1),bh(this,"state",{enterInVR:!1,entered:!1,dialog:null,showShareDialog:!1,broadcastTipDismissed:!1,linkCode:null,linkCodeCancel:null,miniInviteActivated:!1,didConnectToNetworkedScene:!1,noMoreLoadingUpdates:!1,hideLoader:!1,showPrefs:!1,watching:!1,isStreaming:!1,showStreamingTip:!1,waitingOnAudio:!1,mediaStream:null,audioTrack:null,audioTrackClone:null,micDevices:[],autoExitTimerStartedAt:null,autoExitTimerInterval:null,autoExitMessage:null,secondsRemainingBeforeAutoExit:1/0,muted:!1,frozen:!1,exited:!1,signedIn:!1,videoShareMediaSource:null,showVideoShareFailed:!1,objectInfo:null,objectSrc:"",isObjectListExpanded:!1,isPresenceListExpanded:!1}),bh(this,"onConcurrentLoad",()=>{Object(Me.a)("allow_multi")||this.props.store.state.preferences.allowMultipleHubsInstances||this.startAutoExitTimer("autoexit.concurrent_subtitle")}),bh(this,"onIdleDetected",()=>{this.props.disableAutoExitOnIdle||this.state.isStreaming||this.startAutoExitTimer("autoexit.idle_subtitle")}),bh(this,"onActivityDetected",()=>{this.state.autoExitTimerInterval&&this.endAutoExitTimer()}),bh(this,"storeUpdated",()=>{this.forceUpdate()}),bh(this,"showContextualSignInDialog",()=>{const{signInMessageId:e,authChannel:i,signInCompleteMessageId:n,signInContinueTextId:a,onContinueAfterSignIn:s}=this.props;this.showNonHistoriedDialog(po.a,{message:ba.b[e],onSignIn:function(){var e=_h(function*(e){const{authComplete:o}=yield i.startAuthentication(e,t.props.hubChannel);t.showNonHistoriedDialog(po.a,{authStarted:!0,onClose:s}),yield o,t.setState({signedIn:!0}),t.showNonHistoriedDialog(po.a,{authComplete:!0,message:ba.b[n],continueText:ba.b[a],onClose:s,onContinue:s})});return function(t){return e.apply(this,arguments)}}(),onClose:s})}),bh(this,"updateSubscribedState",()=>{const e=this.props.subscriptions&&this.props.subscriptions.isSubscribed();this.setState({isSubscribed:e})}),bh(this,"toggleFavorited",()=>{this.props.performConditionalSignIn(()=>this.props.hubChannel.signedIn,()=>{const e=this.isFavorited();this.props.hubChannel[e?"unfavorite":"favorite"](),this.setState({isFavorited:!e})},"favorite-room")}),bh(this,"isFavorited",()=>void 0!==this.state.isFavorited?this.state.isFavorited:this.props.initialIsFavorited),bh(this,"onLoadingFinished",()=>{this.setState({noMoreLoadingUpdates:!0}),this.props.scene.emit("loading_finished"),this.props.scene.addState("loaded"),this.props.onLoaded&&this.props.onLoaded()}),bh(this,"onSceneLoaded",()=>{this.setState({sceneLoaded:!0})}),bh(this,"onAframeStateChanged",e=>{"muted"!==e.detail&&"frozen"!==e.detail||this.setState({[e.detail]:this.props.scene.is(e.detail)})}),bh(this,"onShareVideoEnabled",e=>{this.setState({videoShareMediaSource:e.detail.source})}),bh(this,"onShareVideoDisabled",()=>{this.setState({videoShareMediaSource:null})}),bh(this,"onShareVideoFailed",()=>{this.setState({showVideoShareFailed:!0})}),bh(this,"toggleMute",()=>{this.props.scene.emit("action_mute")}),bh(this,"shareVideo",e=>{this.props.scene.emit(`action_share_${e}`)}),bh(this,"endShareVideo",()=>{this.props.scene.emit("action_end_video_sharing")}),bh(this,"spawnPen",()=>{this.props.scene.emit("penButtonPressed")}),bh(this,"onSubscribeChanged",_h(function*(){t.props.subscriptions&&(yield t.props.subscriptions.toggle(),t.updateSubscribedState())})),bh(this,"handleForceEntry",()=>{this.props.forcedVREntryType&&(this.props.forcedVREntryType.startsWith("daydream")?this.enterDaydream():this.props.forcedVREntryType.startsWith("vr")?this.enterVR():this.props.forcedVREntryType.startsWith("2d")&&this.enter2D())}),bh(this,"startAutoExitTimer",e=>{if(this.state.autoExitTimerInterval)return;const t=setInterval(()=>{let e=1/0;if(this.state.autoExitTimerStartedAt){const t=(new Date-this.state.autoExitTimerStartedAt)/1e3;e=Math.max(0,Math.floor(Ph-t))}this.setState({secondsRemainingBeforeAutoExit:e}),this.checkForAutoExit()},500);this.setState({autoExitTimerStartedAt:new Date,autoExitTimerInterval:t,autoExitMessage:e})}),bh(this,"checkForAutoExit",()=>{0===this.state.secondsRemainingBeforeAutoExit&&(this.endAutoExitTimer(),this.exit())}),bh(this,"exit",e=>{window.removeEventListener("concurrentload",this.onConcurrentLoad),window.removeEventListener("idle_detected",this.onIdleDetected),window.removeEventListener("activity_detected",this.onActivityDetected),this.props.exitScene&&this.props.exitScene(e),this.setState({exited:!0})}),bh(this,"isWaitingForAutoExit",()=>this.state.secondsRemainingBeforeAutoExit<=Ph),bh(this,"endAutoExitTimer",()=>{clearInterval(this.state.autoExitTimerInterval),this.setState({autoExitTimerStartedAt:null,autoExitTimerInterval:null,autoExitMessage:null,secondsRemainingBeforeAutoExit:1/0})}),bh(this,"performDirectEntryFlow",function(){var e=_h(function*(e){t.setState({enterInVR:e,waitingOnAudio:!0}),(yield function(){return Th.apply(this,arguments)}()).length>0?(yield t.setMediaStreamToDefault(),t.beginOrSkipAudioSetup()):t.pushHistoryState("entry_step","mic_grant"),t.setState({waitingOnAudio:!1})});return function(t){return e.apply(this,arguments)}}()),bh(this,"enter2D",_h(function*(){yield t.performDirectEntryFlow(!1)})),bh(this,"enterVR",_h(function*(){t.props.forcedVREntryType||t.props.availableVREntryTypes.generic!==On.maybe?yield t.performDirectEntryFlow(!0):t.pushHistoryState("modal","webvr")})),bh(this,"enterDaydream",_h(function*(){yield t.performDirectEntryFlow(!0)})),bh(this,"micDeviceChanged",function(){var e=_h(function*(e){const i={audio:{deviceId:{exact:[e.target.value]}}};yield t.fetchAudioTrack(i),yield t.setupNewMediaStream()});return function(t){return e.apply(this,arguments)}}()),bh(this,"setMediaStreamToDefault",_h(function*(){let e=!1;const{lastUsedMicDeviceId:i}=t.props.store.state.settings;return e=i?yield t.fetchAudioTrack({audio:{deviceId:{ideal:i}}}):yield t.fetchAudioTrack({audio:!0}),yield t.setupNewMediaStream(),{hasAudio:e}})),bh(this,"fetchAudioTrack",function(){var e=_h(function*(e){t.state.audioTrack&&t.state.audioTrack.stop(),t.state.audioTrackClone&&t.state.audioTrackClone.stop();try{const i=(yield navigator.mediaDevices.getUserMedia(e)).getAudioTracks()[0];if(t.setState({audioTrack:i}),/Oculus/.test(navigator.userAgent)){const n=function(){var i=_h(function*(){console.warn("Oculus Browser 6 bug hit: Audio stream track ended without calling stop. Recreating audio stream.");const i=yield navigator.mediaDevices.getUserMedia(e),a=i.getAudioTracks()[0],s=a.clone();yield NAF.connection.adapter.setLocalMediaStream(i),t.props.scene.is("muted")&&(console.warn("re-muting microphone"),NAF.connection.adapter.enableMicrophone(!1),a.enabled=!1),t.setState({mediaStream:i,audioTrack:a,audioTrackClone:s});const o=new MediaStream;o.addTrack(s),t.props.scene.emit("local-media-stream-created",{mediaStream:o}),a.addEventListener("ended",n,{once:!0})});return function(){return i.apply(this,arguments)}}();i.addEventListener("ended",n,{once:!0})}return!0}catch(e){return t.setState({audioTrack:null}),!1}});return function(t){return e.apply(this,arguments)}}()),bh(this,"setupNewMediaStream",_h(function*(){const e=new MediaStream;if(yield t.fetchMicDevices(),t.state.audioTrack){e.addTrack(t.state.audioTrack);const i=t.micDeviceIdForMicLabel(t.micLabelForMediaStream(e));i&&t.props.store.update({settings:{lastUsedMicDeviceId:i}});const n=new MediaStream,a=t.state.audioTrack.clone();t.setState({audioTrackClone:a}),n.addTrack(a),t.props.scene.emit("local-media-stream-created",{mediaStream:n})}t.setState({mediaStream:e})})),bh(this,"onMicGrantButton",_h(function*(){if(t.props.location.state&&"mic_grant"===t.props.location.state.entry_step){const{hasAudio:e}=yield t.setMediaStreamToDefault();e?t.pushHistoryState("entry_step","mic_granted"):t.beginOrSkipAudioSetup()}else t.beginOrSkipAudioSetup()})),bh(this,"beginOrSkipAudioSetup",()=>{this.props.forcedVREntryType&&this.props.forcedVREntryType.endsWith("_now")?this.onAudioReadyButton():this.pushHistoryState("entry_step","audio")}),bh(this,"fetchMicDevices",()=>new Promise(e=>{navigator.mediaDevices.enumerateDevices().then(t=>{this.setState({micDevices:t.filter(e=>"audioinput"===e.kind).map(e=>({deviceId:e.deviceId,label:e.label}))},e)})})),bh(this,"shouldShowHmdMicWarning",()=>!Mh&&!AFRAME.utils.device.isMobileVR()&&(!!this.state.enterInVR&&(!!this.hasHmdMicrophone()&&!Eh.find(e=>this.selectedMicLabel().match(e))))),bh(this,"hasHmdMicrophone",()=>!!this.state.micDevices.find(e=>Eh.find(t=>e.label.match(t)))),bh(this,"micLabelForMediaStream",e=>e&&e.getAudioTracks().length>0&&e.getAudioTracks()[0].label||""),bh(this,"selectedMicLabel",()=>this.micLabelForMediaStream(this.state.mediaStream)),bh(this,"micDeviceIdForMicLabel",e=>this.state.micDevices.filter(t=>t.label===e).map(e=>e.deviceId)[0]),bh(this,"selectedMicDeviceId",()=>this.micDeviceIdForMicLabel(this.selectedMicLabel())),bh(this,"shouldShowFullScreen",()=>(Mh||AFRAME.utils.device.isMobileVR())&&!AFRAME.utils.device.isIOS()&&!this.state.enterInVR&&Xt.a.enabled),bh(this,"onAudioReadyButton",_h(function*(){t.state.enterInVR||(yield Object($t.a)()),Object(en.a)(t.props.history);const e=t.props.store.state.preferences.muteMicOnEntry||!1;yield t.props.enterScene(t.state.mediaStream,t.state.enterInVR,e),t.setState({entered:!0,showShareDialog:!1});const i=t.state.mediaStream;i&&(i.getAudioTracks().length>0&&console.log(`Using microphone: ${i.getAudioTracks()[0].label}`),i.getVideoTracks().length>0&&console.log("Screen sharing enabled."))})),bh(this,"attemptLink",_h(function*(){t.pushHistoryState("overlay","link");const{code:e,cancel:i,onFinished:n}=yield t.props.linkChannel.generateCode();t.setState({linkCode:e,linkCodeCancel:i}),n.then(()=>{t.setState({log:!1,linkCode:null,linkCodeCancel:null}),t.exit()})})),bh(this,"showShareDialog",()=>{this.props.store.update({activity:{hasOpenedShare:!0}}),this.setState({showShareDialog:!0})}),bh(this,"toggleShareDialog",_h(function*(){t.props.store.update({activity:{hasOpenedShare:!0}}),t.setState({showShareDialog:!t.state.showShareDialog})})),bh(this,"createObject",e=>{this.props.scene.emit("add_media",e)}),bh(this,"changeScene",e=>{this.props.hubChannel.updateScene(e)}),bh(this,"setAvatarUrl",e=>{this.props.store.update({profile:vh({},this.props.store.state.profile,{avatarId:e})}),this.props.scene.emit("avatar_updated")}),bh(this,"closeDialog",()=>{this.state.dialog?this.setState({dialog:null}):this.props.history.goBack(),ri()?si():Object($t.b)()}),bh(this,"showNonHistoriedDialog",(e,t={})=>{this.setState({dialog:Xi.a.createElement(e,vh({onClose:this.closeDialog},t))})}),bh(this,"toggleStreamerMode",e=>{this.props.scene.systems["hubs-systems"].characterController.fly=e,e?(this.props.hubChannel.beginStreaming(),this.setState({isStreaming:!0,showStreamingTip:!0})):(this.props.hubChannel.endStreaming(),this.setState({isStreaming:!1}))}),bh(this,"renderDialog",(e,t={})=>Xi.a.createElement(e,vh({onClose:this.closeDialog},t))),bh(this,"showSignInDialog",()=>{this.showNonHistoriedDialog(po.a,{message:ba.b["sign-in.prompt"],onSignIn:function(){var e=_h(function*(e){const{authComplete:i}=yield t.props.authChannel.startAuthentication(e,t.props.hubChannel);t.showNonHistoriedDialog(po.a,{authStarted:!0}),yield i,t.setState({signedIn:!0}),t.closeDialog()});return function(t){return e.apply(this,arguments)}}()})}),bh(this,"signOut",_h(function*(){yield t.props.authChannel.signOut(t.props.hubChannel),t.setState({signedIn:!1})})),bh(this,"showWebRTCScreenshareUnsupportedDialog",()=>{this.pushHistoryState("modal","webrtc-screenshare")}),bh(this,"onMiniInviteClicked",()=>{const e=`https://${n.a.SHORTLINK_DOMAIN}/${this.props.hubId}`;this.setState({miniInviteActivated:!0}),setTimeout(()=>{this.setState({miniInviteActivated:!1})},5e3),Fn()?navigator.share({title:document.title,url:e}):Cn()(e)}),bh(this,"sendMessage",e=>{this.props.onSendMessage(e)}),bh(this,"occupantCount",()=>this.props.presences?Object.entries(this.props.presences).length:0),bh(this,"onStoreChanged",()=>{const e=this.props.store.state.confirmedBroadcastedRooms.includes(this.props.hubId);e!==this.state.broadcastTipDismissed&&this.setState({broadcastTipDismissed:e})}),bh(this,"confirmBroadcastedRoom",()=>{this.props.store.update({confirmedBroadcastedRooms:[this.props.hubId]})}),bh(this,"discordBridges",()=>this.props.presences?Object(h.c)(this.props.presences):[]),bh(this,"hasEmbedPresence",()=>{if(!this.props.presences)return!1;for(const e of Object.values(this.props.presences))for(const t of e.metas)if(t.context&&t.context.embed)return!0;return!1}),bh(this,"pushHistoryState",(e,t)=>Object(en.e)(this.props.history,e,t)),bh(this,"renderInterstitialPrompt",()=>Xi.a.createElement(kn.b,{locale:ba.a,messages:ba.b},Xi.a.createElement("div",{className:Zn.a.interstitial,onClick:()=>this.props.onInterstitialPromptClicked()},Xi.a.createElement("div",null,Xi.a.createElement(kn.a,{id:"interstitial.prompt"}))))),bh(this,"renderExitedPane",()=>{let e=null;if("closed"===this.props.roomUnavailableReason)e=Xi.a.createElement("div",null,"Sorry, this room is no longer available.",Xi.a.createElement("p",null),Xi.a.createElement(Mn.a,{name:"show_terms"},"A room may be closed if we receive reports that it violates our"," ",Xi.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:n.a.link("terms_of_use","https://github.com/mozilla/hubs/blob/master/TERMS.md")},"Terms of Use"),".",Xi.a.createElement("br",null)),"If you have questions, contact us at"," ",Xi.a.createElement("a",{href:`mailto:${ba.b["contact-email"]}`},Xi.a.createElement(kn.a,{id:"contact-email"})),".",Xi.a.createElement("p",null),Xi.a.createElement(Mn.a,{name:"show_source_link"},"If you'd like to run your own server, Hubs's source code is available on"," ",Xi.a.createElement("a",{href:"https://github.com/mozilla/hubs"},"GitHub"),"."));else if("no_data_channels"===this.props.platformUnsupportedReason)e=Xi.a.createElement("div",null,"Your browser does not support"," ",Xi.a.createElement("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/createDataChannel#Browser_compatibility",rel:"noreferrer noopener"},"WebRTC Data Channels"),", which is required to use ",ba.b["app-name"],".",Xi.a.createElement("br",null),'If you"d like to use ',ba.b["app-name"]," with Oculus or SteamVR, you can"," ",Xi.a.createElement("a",{href:"https://www.mozilla.org/firefox",rel:"noreferrer noopener"},"Download Firefox"),".");else{const t=`exit.subtitle.${this.props.roomUnavailableReason||this.props.platformUnsupportedReason||"exited"}`;e=Xi.a.createElement("div",null,Xi.a.createElement(kn.a,{id:t}),Xi.a.createElement("p",null),!["left","disconnected","scene_error"].includes(this.props.roomUnavailableReason)&&Xi.a.createElement("div",null,"You can also ",Xi.a.createElement("a",{href:"/"},"create a new room"),"."))}return Xi.a.createElement(kn.b,{locale:ba.a,messages:ba.b},Xi.a.createElement("div",{className:"exited-panel"},Xi.a.createElement("img",{className:"exited-panel__logo",src:n.a.image("logo")}),Xi.a.createElement("div",{className:"exited-panel__subtitle"},e)))}),bh(this,"renderBotMode",()=>Xi.a.createElement("div",{className:"loading-panel"},Xi.a.createElement("img",{className:"loading-panel__logo",src:n.a.image("logo")}),Xi.a.createElement("input",{type:"file",id:"bot-audio-input",accept:"audio/*"}),Xi.a.createElement("input",{type:"file",id:"bot-data-input",accept:"application/json"}))),bh(this,"renderEntryStartPanel",()=>{const{hasAcceptedProfile:e,hasChangedName:t}=this.props.store.state.activity,i=this.props.hubIsBound?!e:!t;return Xi.a.createElement("div",{className:qn.a.entryPanel},Xi.a.createElement("div",{className:qn.a.name},this.props.hubChannel.canOrWillIfCreator("update_hub")?Xi.a.createElement("button",{className:qn.a.renameButton,onClick:()=>this.props.performConditionalSignIn(()=>this.props.hubChannel.can("update_hub"),()=>this.pushHistoryState("modal","room_settings"),"room-settings")},this.props.hubName):Xi.a.createElement("span",null,this.props.hubName),Xi.a.createElement("button",{onClick:()=>this.setState({watching:!0}),className:qn.a.collapseButton},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Ja.faTimes}))),Xi.a.createElement("button",{onClick:()=>this.toggleFavorited(),className:xn()({[qn.a.entryFavoriteButton]:!0,[qn.a.favoriteButton]:!0,[qn.a.favorited]:this.isFavorited()})},Xi.a.createElement("i",{title:"Favorite"},Xi.a.createElement(qa.a,{icon:ls.faStar})))),Xi.a.createElement("div",{className:qn.a.roomSubtitle},Xi.a.createElement(kn.a,{id:"entry.lobby"})),Xi.a.createElement("div",{className:qn.a.center},Xi.a.createElement(Yr,{occupantCount:this.occupantCount(),discordBridges:this.discordBridges(),onSendMessage:this.sendMessage})),!this.state.waitingOnAudio&&!this.props.entryDisallowed&&Xi.a.createElement("div",{className:qn.a.buttonContainer},!Lh&&Xi.a.createElement("button",{onClick:e=>{e.preventDefault(),this.attemptLink()},className:xn()([qn.a.secondaryActionButton,qn.a.wideButton])},Xi.a.createElement(kn.a,{id:"entry.device-medium"}),Xi.a.createElement("div",{className:qn.a.buttonSubtitle},Xi.a.createElement(kn.a,{id:Mh?"entry.device-subtitle-mobile":"entry.device-subtitle-desktop"}))),Xi.a.createElement("button",{autoFocus:!0,onClick:e=>{if(e.preventDefault(),i||!this.props.forcedVREntryType){this.props.hubChannel.sendEnteringEvent();const e=i?"profile":"device";this.pushHistoryState("entry_step",e)}else this.handleForceEntry()},className:xn()([qn.a.actionButton,qn.a.wideButton])},Xi.a.createElement(kn.a,{id:"entry.enter-room"}))),this.props.entryDisallowed&&!this.state.waitingOnAudio&&Xi.a.createElement("div",{className:qn.a.buttonContainer},Xi.a.createElement("a",{onClick:e=>{e.preventDefault(),this.setState({watching:!0})},className:xn()([qn.a.secondaryActionButton,qn.a.wideButton])},Xi.a.createElement(kn.a,{id:"entry.entry-disallowed"}),Xi.a.createElement("div",{className:qn.a.buttonSubtitle},Xi.a.createElement(kn.a,{id:"entry.entry-disallowed-subtitle"})))),this.state.waitingOnAudio&&Xi.a.createElement("div",null,Xi.a.createElement("div",{className:"loader-wrap loader-mid"},Xi.a.createElement("div",{className:"loader"},Xi.a.createElement("div",{className:"loader-center"})))))}),bh(this,"renderDevicePanel",()=>Xi.a.createElement("div",{className:qn.a.entryPanel},Xi.a.createElement("div",{onClick:()=>{this.props.hubChannel.sendEnteringCancelledEvent(),this.props.history.goBack()},className:qn.a.back},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:gh.faArrowLeft})),Xi.a.createElement(kn.a,{id:"entry.back"})),Xi.a.createElement("div",{className:qn.a.title},Xi.a.createElement(kn.a,{id:"entry.choose-device"})),this.state.waitingOnAudio?Xi.a.createElement("div",{className:qn.a.audioLoader},Xi.a.createElement("div",{className:"loader-wrap loader-mid"},Xi.a.createElement("div",{className:"loader"},Xi.a.createElement("div",{className:"loader-center"})))):Xi.a.createElement("div",{className:qn.a.buttonContainer},this.props.availableVREntryTypes.cardboard!==On.no&&Xi.a.createElement("div",{className:qn.a.secondary,onClick:this.enterVR},Xi.a.createElement(kn.a,{id:"entry.cardboard"})),this.props.availableVREntryTypes.generic!==On.no&&Xi.a.createElement(Wa,{secondary:!0,onClick:this.enterVR}),this.props.availableVREntryTypes.daydream===On.yes&&Xi.a.createElement(Za,{secondary:!0,onClick:this.enterDaydream,subtitle:null}),this.props.availableVREntryTypes.screen===On.yes&&Xi.a.createElement(Ua,{autoFocus:!0,onClick:this.enter2D})))),bh(this,"renderMicPanel",e=>Xi.a.createElement("div",{className:"mic-grant-panel"},Xi.a.createElement("div",{onClick:()=>this.props.history.goBack(),className:qn.a.back},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:gh.faArrowLeft})),Xi.a.createElement(kn.a,{id:"entry.back"})),Xi.a.createElement("div",{className:"mic-grant-panel__grant-container"},Xi.a.createElement("div",{className:"mic-grant-panel__title"},Xi.a.createElement(kn.a,{id:e?"audio.granted-title":"audio.grant-title"})),Xi.a.createElement("div",{className:"mic-grant-panel__subtitle"},Xi.a.createElement(kn.a,{id:e?"audio.granted-subtitle":"audio.grant-subtitle"})),Xi.a.createElement("div",{className:"mic-grant-panel__button-container"},e?Xi.a.createElement("button",{autoFocus:!0,className:"mic-grant-panel__button",onClick:this.onMicGrantButton},Xi.a.createElement("img",{src:nn.a,srcSet:sn.a+" 2x"})):Xi.a.createElement("button",{autoFocus:!0,className:"mic-grant-panel__button",onClick:this.onMicGrantButton},Xi.a.createElement("img",{src:rn.a,srcSet:cn.a+" 2x"}))),Xi.a.createElement("div",{className:"mic-grant-panel__next-container"},Xi.a.createElement("button",{autoFocus:!0,className:xn()("mic-grant-panel__next"),onClick:this.onMicGrantButton},Xi.a.createElement(kn.a,{id:"audio.granted-next"})))))),bh(this,"renderAudioSetupPanel",()=>{const e=Rh?"audio.subtitle-mobile":"audio.subtitle-desktop",t=this.props.store.state.preferences.muteMicOnEntry||!1;return Xi.a.createElement("div",{className:"audio-setup-panel"},Xi.a.createElement("div",{onClick:()=>{this.props.forcedVREntryType&&this.props.hubChannel.sendEnteringCancelledEvent(),this.props.history.goBack()},className:qn.a.back},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:gh.faArrowLeft})),Xi.a.createElement(kn.a,{id:"entry.back"})),Xi.a.createElement("div",null,Xi.a.createElement("div",{className:"audio-setup-panel__title"},Xi.a.createElement(kn.a,{id:"audio.title"})),Xi.a.createElement("div",{className:"audio-setup-panel__subtitle"},(Rh||this.state.enterInVR)&&Xi.a.createElement(kn.a,{id:e})),Xi.a.createElement("div",{className:"audio-setup-panel__levels"},Xi.a.createElement(cc,{scene:this.props.scene,hasAudioTrack:!!this.state.audioTrack,muteOnEntry:t}),Xi.a.createElement(Oc,null)),this.state.audioTrack&&this.state.micDevices.length>1?Xi.a.createElement("div",{className:"audio-setup-panel__device-chooser"},Xi.a.createElement("select",{className:"audio-setup-panel__device-chooser__dropdown",value:this.selectedMicDeviceId(),onChange:this.micDeviceChanged},this.state.micDevices.map(e=>Xi.a.createElement("option",{key:e.deviceId,value:e.deviceId},"",e.label))),Xi.a.createElement("img",{className:"audio-setup-panel__device-chooser__mic-icon",src:hn.a,srcSet:pn.a+" 2x"}),Xi.a.createElement("img",{className:"audio-setup-panel__device-chooser__dropdown-arrow",src:gn.a,srcSet:vn.a+" 2x"})):Xi.a.createElement("div",null),this.shouldShowHmdMicWarning()&&Xi.a.createElement("div",{className:"audio-setup-panel__hmd-mic-warning"},Xi.a.createElement("img",{src:o.a,srcSet:yn.a+" 2x",className:"audio-setup-panel__hmd-mic-warning__icon"}),Xi.a.createElement("span",{className:"audio-setup-panel__hmd-mic-warning__label"},Xi.a.createElement(kn.a,{id:"audio.hmd-mic-warning"})))),Xi.a.createElement("div",{className:"audio-setup-panel__mute-container"},Xi.a.createElement("input",{id:"mute-on-entry",type:"checkbox",onChange:()=>this.props.store.update({preferences:{muteMicOnEntry:!this.props.store.state.preferences.muteMicOnEntry}}),checked:this.props.store.state.preferences.muteMicOnEntry||!1}),Xi.a.createElement("label",{htmlFor:"mute-on-entry"},Xi.a.createElement(kn.a,{id:"entry.mute-on-entry"}))),Xi.a.createElement("div",{className:"audio-setup-panel__enter-button-container"},Xi.a.createElement("button",{autoFocus:!0,className:"audio-setup-panel__enter-button",onClick:this.onAudioReadyButton},Xi.a.createElement(kn.a,{id:"audio.enter-now"}))))}),bh(this,"isInModalOrOverlay",()=>!(!this.state.entered||!xh.find(e=>Object(en.g)(this.props.history.location).startsWith(e))&&!Sh.find(e=>new URLSearchParams(this.props.history.location.search).get(e)))||(!(this.state.entered||!Ch.find(e=>Object(en.g)(this.props.history.location).startsWith(e))&&!kh.find((e,t)=>new URLSearchParams(this.props.history.location.search).get(e)===Ah[t]))||(!(!this.state.objectInfo||!this.state.objectInfo.object3D)||!!(this.props.history&&this.props.history.location.state&&(this.props.history.location.state.modal||this.props.history.location.state.overlay)||this.state.dialog)))),e.showSafariDialog&&(this.state.dialog=Xi.a.createElement(uo,{closable:!1})),e.showWebAssemblyDialog&&(this.state.dialog=Xi.a.createElement(Uo,{closable:!1})),e.mediaSearchStore.setHistory(e.history),this.exitEventHandler=()=>this.exit()}componentDidUpdate(e){const{hubChannel:t,showSignInDialog:i}=this.props;if(t){const{signedIn:e}=t;e!==this.state.signedIn&&this.setState({signedIn:e})}e.showSignInDialog!==i&&(i?this.showContextualSignInDialog():this.closeDialog()),!this.willCompileAndUploadMaterials&&this.state.noMoreLoadingUpdates&&(this.willCompileAndUploadMaterials=!0,window.requestAnimationFrame(()=>{window.setTimeout(()=>{if(!this.props.isBotMode)try{this.props.scene.renderer.compileAndUploadMaterials(this.props.scene.object3D,this.props.scene.camera)}catch{this.exit("scene_error")}this.state.hideLoader||this.setState({hideLoader:!0})},0)}))}componentDidMount(){window.addEventListener("concurrentload",this.onConcurrentLoad),window.addEventListener("idle_detected",this.onIdleDetected),window.addEventListener("activity_detected",this.onActivityDetected),document.querySelector(".a-canvas").addEventListener("mouseup",()=>{this.state.showShareDialog&&this.setState({showShareDialog:!1})}),this.props.scene.addEventListener("didConnectToNetworkedScene",()=>{this.setState({didConnectToNetworkedScene:!0})},{once:!0}),this.props.scene.addEventListener("loaded",this.onSceneLoaded),this.props.scene.addEventListener("stateadded",this.onAframeStateChanged),this.props.scene.addEventListener("stateremoved",this.onAframeStateChanged),this.props.scene.addEventListener("share_video_enabled",this.onShareVideoEnabled),this.props.scene.addEventListener("share_video_disabled",this.onShareVideoDisabled),this.props.scene.addEventListener("share_video_failed",this.onShareVideoFailed),this.props.scene.addEventListener("exit",this.exitEventHandler),this.props.scene.addEventListener("action_exit_watch",()=>this.setState({watching:!1,hide:!1})),this.props.scene.addEventListener("action_toggle_ui",()=>this.setState({hide:!this.state.hide}));const e=this.props.scene;this.props.store.addEventListener("statechanged",this.onStoreChanged);const t=this.props.history.listen((e,i)=>{const n=e.state;if("POP"===i&&n&&n.entry_step&&this.state.entered)return t(),void Object(en.b)(this.props.history)});this.props.history.location.state&&!Object(en.g)(this.props.history.location).startsWith("/media")&&Object(en.c)(this.props.history),this.setState({audioContext:{playSound:t=>{e.emit(t)},onMouseLeave:()=>{}}}),this.props.forcedVREntryType&&this.props.forcedVREntryType.endsWith("_now")&&this.props.scene.addEventListener("loading_finished",()=>{setTimeout(()=>this.handleForceEntry(),1e3)},{once:!0}),this.playerRig=e.querySelector("#avatar-rig")}UNSAFE_componentWillMount(){this.props.store.addEventListener("statechanged",this.storeUpdated)}componentWillUnmount(){this.props.scene.removeEventListener("loaded",this.onSceneLoaded),this.props.scene.removeEventListener("exit",this.exitEventHandler),this.props.scene.removeEventListener("share_video_enabled",this.onShareVideoEnabled),this.props.scene.removeEventListener("share_video_disabled",this.onShareVideoDisabled),this.props.scene.removeEventListener("share_video_failed",this.onShareVideoFailed),this.props.store.removeEventListener("statechanged",this.storeUpdated)}render(){if(this.props.hide||this.state.hide)return Xi.a.createElement("div",null);const e=this.state.exited||this.props.roomUnavailableReason||this.props.platformUnsupportedReason,t=this.props.showPreload,i=!(t||this.state.hideLoader&&this.state.didConnectToNetworkedScene||this.props.showSafariDialog||this.props.showWebAssemblyDialog),a={[Zn.a.ui]:!0,"ui-root":!0,"in-modal-or-overlay":this.isInModalOrOverlay()},s=navigator.serviceWorker&&"PushManager"in window;if(this.props.showOAuthDialog&&!this.props.showInterstitialPrompt)return Xi.a.createElement(kn.b,{locale:ba.a,messages:ba.b},Xi.a.createElement("div",{className:xn()(a)},Xi.a.createElement(wr,{onClose:this.props.onCloseOAuthDialog,oauthInfo:this.props.oauthInfo})));if(e)return this.renderExitedPane();if(i&&this.state.showPrefs)return Xi.a.createElement("div",null,Xi.a.createElement(xa,{scene:this.props.scene,finished:this.state.noMoreLoadingUpdates,onLoaded:this.onLoadingFinished}),Xi.a.createElement(wc,{onClose:()=>{this.setState({showPrefs:!1})},store:this.props.store}));if(i)return Xi.a.createElement(xa,{scene:this.props.scene,finished:this.state.noMoreLoadingUpdates,onLoaded:this.onLoadingFinished});if(this.state.showPrefs)return Xi.a.createElement(wc,{onClose:()=>{this.setState({showPrefs:!1})},store:this.props.store});if(this.props.showInterstitialPrompt)return this.renderInterstitialPrompt();if(this.props.isBotMode)return this.renderBotMode();const o=this.props.embed,r=this.state.entered,l=this.state.watching,c=r||l,d=r||l||t,u=`${location.protocol}//${location.host}${location.pathname}`,p=!!(this.props.history&&this.props.history.location.state&&this.props.history.location.state.entry_step),m=this.props.availableVREntryTypes&&!t&&(this.isWaitingForAutoExit()?Xi.a.createElement(Ca,{message:this.state.autoExitMessage,secondsRemaining:this.state.secondsRemainingBeforeAutoExit,onCancel:this.endAutoExitTimer}):Xi.a.createElement("div",{className:qn.a.entryDialog},Xi.a.createElement(ta,{stateKey:"entry_step",stateValue:"device",history:this.props.history},this.renderDevicePanel()),Xi.a.createElement(ta,{stateKey:"entry_step",stateValue:"mic_grant",history:this.props.history},this.renderMicPanel(!1)),Xi.a.createElement(ta,{stateKey:"entry_step",stateValue:"mic_granted",history:this.props.history},this.renderMicPanel(!0)),Xi.a.createElement(ta,{stateKey:"entry_step",stateValue:"audio",history:this.props.history},this.renderAudioSetupPanel()),Xi.a.createElement(ta,{stateKey:"entry_step",stateValue:"",history:this.props.history},this.renderEntryStartPanel()))),g=xn()({[Zn.a.uiInteractive]:!this.isInModalOrOverlay(),[Zn.a.uiDialogBoxContents]:!0,[Zn.a.backgrounded]:this.isInModalOrOverlay()}),f=r&&Lh,v=this.props.presenceLogEntries||[],b=e=>{const t=e.components["media-loader"].data.src;this.setState({objectInfo:e,objectSrc:t});const i=this.props.scene.systems["hubs-systems"].cameraSystem;i.uninspect(),i.inspect(e.object3D,1.5,!0)},y=this.props.mediaSearchStore.getUrlMediaSource(this.props.history.location),_=y&&(["scenes","avatars","favorites"].includes(y)||this.state.entered),w=this.props.activeTips&&this.props.activeTips.top||this.state.showVideoShareFailed,E=function(e){const{search:t}=e,i=new URLSearchParams(t),n=Object(en.g)(e);return n.startsWith("/client")||i.get("client_id")?i.get("client_id")||n.substring(9):null}(this.props.history.location),x=!!E,S=!(!this.state.objectInfo||!this.state.objectInfo.object3D),C=this.discordBridges(),k=C.map(e=>"#"+e).join(", "),A=this.hasEmbedPresence(),T=C.length>0,M=(T||A&&!this.props.embed)&&!this.state.broadcastTipDismissed,L=!(w||r||o||t||l||w||p||this.props.store.state.activity.hasOpenedShare||!(this.occupantCount()<=1)),R=!r&&!o&&!t&&!l&&!L&&!this.state.showShareDialog&&this.props.hubChannel&&this.props.hubChannel.canOrWillIfCreator("update_hub"),P=this.props.hubIsBound?Object(h.g)(this.props.presences,this.props.sessionId).displayName:null,D=this.state.isStreaming,O=D&&this.state.showStreamingTip&&Xi.a.createElement("div",{className:xn()([Zn.a.streamingTip])},Xi.a.createElement("div",{className:xn()([Zn.a.streamingTipAttachPoint])}),Xi.a.createElement("button",{title:"Dismiss",className:Zn.a.streamingTipClose,onClick:()=>this.setState({showStreamingTip:!1})},Xi.a.createElement(qa.a,{icon:Ja.faTimes})),Xi.a.createElement("div",{className:Zn.a.streamingTipMessage},Xi.a.createElement(kn.a,{id:"tips.streaming"}))),H=Object(_e.b)(),j=H&&H.displayName;return Xi.a.createElement(Xn.a.Provider,{value:this.state.audioContext},Xi.a.createElement(kn.b,{locale:ba.a,messages:ba.b},Xi.a.createElement("div",{className:xn()(a)},this.state.dialog,t&&Xi.a.createElement(ld,{hubName:this.props.hubName,hubScene:this.props.hubScene,baseUrl:u,onLoadClicked:this.props.onPreloadLoadClicked}),Xi.a.createElement(ta,{stateKey:"overlay",stateValue:"profile",history:this.props.history,render:e=>Xi.a.createElement(ss,fh({},e,{displayNameOverride:P,finished:()=>this.pushHistoryState(),onClose:()=>this.pushHistoryState(),store:this.props.store,mediaSearchStore:this.props.mediaSearchStore,avatarId:e.location.state.detail&&e.location.state.detail.avatarId}))}),Xi.a.createElement(ta,{stateKey:"overlay",stateValue:"avatar-editor",history:this.props.history,render:e=>Xi.a.createElement(tc,{className:Zn.a.avatarEditor,signedIn:this.state.signedIn,onSignIn:this.showSignInDialog,onSave:()=>{e.location.state.detail&&e.location.state.detail.returnToProfile?this.props.history.goBack():(this.props.history.goBack(),this.props.mediaSearchStore.sourceNavigateWithNoNav("avatars","use")),this.props.onAvatarSaved()},onClose:()=>this.props.history.goBack(),store:this.props.store,debug:wh,avatarId:e.location.state.detail&&e.location.state.detail.avatarId,hideDelete:e.location.state.detail&&e.location.state.detail.hideDelete})}),_&&Xi.a.createElement(ws,{history:this.props.history,mediaSearchStore:this.props.mediaSearchStore,hubChannel:this.props.hubChannel,onMediaSearchResultEntrySelected:(e,t)=>{"room"===e.type?this.showNonHistoriedDialog(nr,{destinationUrl:e.url,messageType:"join-room"}):this.props.onMediaSearchResultEntrySelected(e,t)},performConditionalSignIn:this.props.performConditionalSignIn}),Xi.a.createElement(ta,{stateKey:"entry_step",stateValue:"profile",history:this.props.history,render:e=>Xi.a.createElement(ss,fh({},e,{displayNameOverride:P,finished:()=>{this.props.forcedVREntryType?(this.pushHistoryState(),this.handleForceEntry()):this.pushHistoryState("entry_step","device")},onClose:()=>this.pushHistoryState(),store:this.props.store,mediaSearchStore:this.props.mediaSearchStore,avatarId:e.location.state.detail&&e.location.state.detail.avatarId}))}),Xi.a.createElement(ta,{stateKey:"modal",stateValue:"room_settings",history:this.props.history,render:()=>this.renderDialog(yo,{showRoomAccessSettings:this.props.hubChannel.can("update_hub_promotion"),initialSettings:{name:this.props.hubName,description:this.props.hubDescription,member_permissions:this.props.hubMemberPermissions,allow_promotion:this.props.hubAllowPromotion},onChange:e=>this.props.hubChannel.updateHub(e)})}),Xi.a.createElement(ta,{stateKey:"modal",stateValue:"close_room",history:this.props.history,render:()=>this.renderDialog(xo,{onConfirm:()=>this.props.hubChannel.closeHub()})}),Xi.a.createElement(ta,{stateKey:"modal",stateValue:"support",history:this.props.history,render:()=>this.renderDialog(no,{hubChannel:this.props.hubChannel})}),Xi.a.createElement(ta,{stateKey:"modal",stateValue:"create",history:this.props.history,render:()=>this.renderDialog(Bs,{onCreate:this.createObject})}),Xi.a.createElement(ta,{stateKey:"modal",stateValue:"change_scene",history:this.props.history,render:()=>this.renderDialog($s,{onChange:this.changeScene})}),Xi.a.createElement(ta,{stateKey:"modal",stateValue:"avatar_url",history:this.props.history,render:()=>this.renderDialog(Ks,{onChange:this.setAvatarUrl})}),Xi.a.createElement(ta,{stateKey:"modal",stateValue:"webvr",history:this.props.history,render:()=>this.renderDialog(Zo)}),Xi.a.createElement(ta,{stateKey:"modal",stateValue:"webrtc-screenshare",history:this.props.history,render:()=>this.renderDialog(Bo)}),Xi.a.createElement(ta,{stateKey:"modal",stateValue:"room_info",history:this.props.history,render:()=>this.renderDialog(ar.a,{store:this.props.store,scene:this.props.hubScene,hubName:this.props.hubName,hubDescription:this.props.hubDescription})}),Xi.a.createElement(ta,{stateKey:"modal",stateValue:"feedback",history:this.props.history,render:()=>this.renderDialog(Yo,{history:this.props.history,onClose:()=>this.pushHistoryState("modal",null)})}),Xi.a.createElement(ta,{stateKey:"modal",stateValue:"help",history:this.props.history,render:()=>this.renderDialog(Jo,{history:this.props.history,onClose:()=>this.pushHistoryState("modal",null)})}),Xi.a.createElement(ta,{stateKey:"modal",stateValue:"tweet",history:this.props.history,render:()=>this.renderDialog(zr,{history:this.props.history,onClose:this.closeDialog})}),x&&Xi.a.createElement(va,{clientId:E,onClose:this.closeDialog,history:this.props.history,presences:this.props.presences,hubChannel:this.props.hubChannel,showNonHistoriedDialog:this.showNonHistoriedDialog,performConditionalSignIn:this.props.performConditionalSignIn}),S&&Xi.a.createElement(vr,{scene:this.props.scene,el:this.state.objectInfo,src:this.state.objectSrc,pinned:this.state.objectInfo&&this.state.objectInfo.components.networked.data.persistent,hubChannel:this.props.hubChannel,onPinChanged:()=>b(this.state.objectInfo),onNavigated:e=>b(e),onClose:()=>{this.props.scene.systems["hubs-systems"].cameraSystem.mode===Ce.c&&this.props.scene.systems["hubs-systems"].cameraSystem.uninspect(),this.setState({isObjectListExpanded:!1,objectInfo:null})}}),(!c&&!this.state.isObjectListExpanded&&!S||this.isWaitingForAutoExit())&&Xi.a.createElement("div",{className:Zn.a.uiDialog},Xi.a.createElement(Fc,{entries:v,presences:this.props.presences,hubId:this.props.hubId,history:this.props.history}),Xi.a.createElement("div",{className:g},m)),d&&Xi.a.createElement(Fc,{inRoom:!0,presences:this.props.presences,entries:v,hubId:this.props.hubId,history:this.props.history}),r&&this.props.activeTips&&this.props.activeTips.bottom&&(!v||0===v.length)&&!M&&Xi.a.createElement(Fo,{tip:this.props.activeTips.bottom,tipRegion:"bottom",pushHistoryState:this.pushHistoryState}),d&&M&&Xi.a.createElement(Fo,{tip:T?"discord":"embed",broadcastTarget:k,onClose:()=>this.confirmBroadcastedRoom()}),d&&!this.state.objectInfo&&!this.state.frozen&&Xi.a.createElement(zl,{discordBridges:C,onSendMessage:this.sendMessage,onObjectCreated:this.createObject,enableSpawning:r,history:this.props.history}),this.state.frozen&&Xi.a.createElement("button",{className:Zn.a.leaveButton,onClick:()=>this.exit("left")},Xi.a.createElement(kn.a,{id:"entry.leave-room"})),!this.state.frozen&&!l&&!t&&Xi.a.createElement("div",{className:xn()({[Yn.a.inviteContainer]:!0,[Yn.a.inviteContainerBelowHud]:r,[Yn.a.inviteContainerInverted]:this.state.showShareDialog})},!o&&!D&&Xi.a.createElement("button",{className:xn()({[Yn.a.inviteButton]:!0,[Yn.a.hideSmallScreens]:this.occupantCount()>1&&r,[Yn.a.inviteButtonLowered]:w}),onClick:()=>this.toggleShareDialog()},Xi.a.createElement(kn.a,{id:"entry.share-button"})),R&&Xi.a.createElement("button",{className:xn()([Zn.a.chooseSceneButton]),onClick:()=>{this.props.performConditionalSignIn(()=>this.props.hubChannel.can("update_hub"),()=>{Object($t.a)(),this.props.mediaSearchStore.sourceNavigateWithNoNav("scenes","use")},"change-scene")}},Xi.a.createElement(kn.a,{id:"entry.change-scene"})),L&&Xi.a.createElement("div",{className:Zn.a.inviteTip},Xi.a.createElement("div",{className:Zn.a.inviteTipAttachPoint}),Xi.a.createElement(kn.a,{id:`entry.${Mh?"mobile":"desktop"}.invite-tip`})),!o&&this.occupantCount()>1&&!w&&r&&!D&&Xi.a.createElement("button",{onClick:this.onMiniInviteClicked,className:Yn.a.inviteMiniButton},Xi.a.createElement("span",null,this.state.miniInviteActivated?navigator.share?"sharing...":"copied!":`${n.a.SHORTLINK_DOMAIN}/`+this.props.hubId)),o&&Xi.a.createElement("a",{href:u,className:Yn.a.enterButton,target:"_blank",rel:"noopener noreferrer"},Xi.a.createElement(kn.a,{id:"entry.open-in-window"})),this.state.showShareDialog&&Xi.a.createElement(eo,{allowShare:!Lh,entryCode:this.props.hubEntryCode,embedUrl:this.props.embedToken&&!Rh?`${u}?embed_token=${this.props.embedToken}`:null,hasPush:s,isSubscribed:void 0===this.state.isSubscribed?this.props.initialIsSubscribed:this.state.isSubscribed,onSubscribeChanged:()=>this.onSubscribeChanged(),hubId:this.props.hubId,onClose:()=>this.setState({showShareDialog:!1})})),Xi.a.createElement(ta,{stateKey:"overlay",stateValue:"invite",history:this.props.history,render:()=>Xi.a.createElement(eo,{allowShare:!!navigator.share,entryCode:this.props.hubEntryCode,hubId:this.props.hubId,isModal:!0,onClose:()=>{this.props.history.goBack(),si()}})}),Xi.a.createElement(ta,{stateKey:"overlay",stateValue:"link",history:this.props.history,render:()=>Xi.a.createElement(lo,{linkCode:this.state.linkCode,onClose:()=>{this.state.linkCodeCancel(),this.setState({linkCode:null,linkCodeCancel:null}),this.props.history.goBack()}})}),D&&Xi.a.createElement("button",{title:"Exit Camera Mode",onClick:()=>this.toggleStreamerMode(!1),className:xn()([Zn.a.cornerButton,Zn.a.cameraModeExitButton])},Xi.a.createElement(qa.a,{icon:Ja.faTimes})),O,Xi.a.createElement(Yc,{scene:this.props.scene,onExpand:(e,t)=>{e?this.setState({isPresenceListExpanded:!1,isObjectListExpanded:e}):this.setState({isObjectListExpanded:e}),t&&(this.setState({objectInfo:null}),this.props.scene.systems["hubs-systems"].cameraSystem.mode===Ce.c&&this.props.scene.systems["hubs-systems"].cameraSystem.uninspect())},expanded:this.state.isObjectListExpanded&&!this.state.isPresenceListExpanded,onInspectObject:e=>b(e)}),Xi.a.createElement(kl,{history:this.props.history,presences:this.props.presences,sessionId:this.props.sessionId,signedIn:this.state.signedIn,email:this.props.store.state.credentials.email,onSignIn:this.showSignInDialog,onSignOut:this.signOut,expanded:!this.state.isObjectListExpanded&&this.state.isPresenceListExpanded,onExpand:e=>{e?this.setState({isPresenceListExpanded:e,isObjectListExpanded:!1}):this.setState({isPresenceListExpanded:e})}}),!D&&!t&&Xi.a.createElement(ad,{history:this.props.history,mediaSearchStore:this.props.mediaSearchStore,isStreaming:D,toggleStreamerMode:this.toggleStreamerMode,hubChannel:this.props.hubChannel,hubScene:this.props.hubScene,scene:this.props.scene,showAsOverlay:f,onCloseOverlay:()=>si(!0),performConditionalSignIn:this.props.performConditionalSignIn,showNonHistoriedDialog:this.showNonHistoriedDialog,showPreferencesScreen:()=>{this.setState({showPrefs:!0})},pushHistoryState:this.pushHistoryState}),!r&&!D&&!Mh&&j&&Xi.a.createElement(mh,{name:j}),c&&Xi.a.createElement("div",{className:Zn.a.topHud},Xi.a.createElement(hh.TopHUD,{scene:this.props.scene,history:this.props.history,mediaSearchStore:this.props.mediaSearchStore,muted:this.state.muted,frozen:this.state.frozen,watching:this.state.watching,onWatchEnded:()=>this.setState({watching:!1}),videoShareMediaSource:this.state.videoShareMediaSource,showVideoShareFailed:this.state.showVideoShareFailed,hideVideoShareFailedTip:()=>this.setState({showVideoShareFailed:!1}),activeTip:this.props.activeTips&&this.props.activeTips.top,isCursorHoldingPen:this.props.isCursorHoldingPen,hasActiveCamera:this.props.hasActiveCamera,onToggleMute:this.toggleMute,onSpawnPen:this.spawnPen,onSpawnCamera:()=>this.props.scene.emit("action_toggle_camera"),onShareVideo:this.shareVideo,onEndShareVideo:this.endShareVideo,onShareVideoNotCapable:()=>this.showWebRTCScreenshareUnsupportedDialog(),isStreaming:D,showStreamingTip:this.state.showStreamingTip,hideStreamingTip:()=>{this.setState({showStreamingTip:!1})}}),l||D?Xi.a.createElement("div",{className:Zn.a.nagCornerButton},Xi.a.createElement("button",{onClick:()=>this.setState({hide:!0})},Xi.a.createElement(kn.a,{id:"hide-ui.prompt"}))):Xi.a.createElement(Ln.a,{name:"show_feedback_ui"},Xi.a.createElement("div",{className:Zn.a.nagCornerButton},Xi.a.createElement("button",{onClick:()=>this.pushHistoryState("modal","help"),className:Zn.a.helpButton},Xi.a.createElement("i",null,Xi.a.createElement(qa.a,{icon:Zc.faQuestion}))))),!l&&!D&&Xi.a.createElement(Mn.a,{name:"show_feedback_ui"},Xi.a.createElement("div",{className:Zn.a.nagCornerButton},Xi.a.createElement("button",{onClick:()=>this.pushHistoryState("modal","feedback")},Xi.a.createElement(kn.a,{id:"feedback.prompt"})))),!D&&Xi.a.createElement("button",{onClick:()=>this.toggleFavorited(),className:xn()({[qn.a.favorited]:this.isFavorited(),[Zn.a.inRoomFavoriteButton]:!0})},Xi.a.createElement("i",{title:"Favorite"},Xi.a.createElement(qa.a,{icon:ls.faStar})))))))}}bh(Dh,"propTypes",{enterScene:wn.a.func,exitScene:wn.a.func,onSendMessage:wn.a.func,disableAutoExitOnIdle:wn.a.bool,forcedVREntryType:wn.a.string,isBotMode:wn.a.bool,store:wn.a.object,mediaSearchStore:wn.a.object,scene:wn.a.object,authChannel:wn.a.object,hubChannel:wn.a.object,linkChannel:wn.a.object,hubEntryCode:wn.a.number,availableVREntryTypes:wn.a.object,environmentSceneLoaded:wn.a.bool,entryDisallowed:wn.a.bool,roomUnavailableReason:wn.a.string,platformUnsupportedReason:wn.a.string,hubId:wn.a.string,hubName:wn.a.string,hubDescription:wn.a.string,hubAllowPromotion:wn.a.bool,hubMemberPermissions:wn.a.object,hubScene:wn.a.object,hubIsBound:wn.a.bool,isSupportAvailable:wn.a.bool,presenceLogEntries:wn.a.array,presences:wn.a.object,sessionId:wn.a.string,subscriptions:wn.a.object,initialIsSubscribed:wn.a.bool,initialIsFavorited:wn.a.bool,showSignInDialog:wn.a.bool,signInMessageId:wn.a.string,signInCompleteMessageId:wn.a.string,signInContinueTextId:wn.a.string,onContinueAfterSignIn:wn.a.func,showSafariDialog:wn.a.bool,showWebAssemblyDialog:wn.a.bool,showOAuthDialog:wn.a.bool,onCloseOAuthDialog:wn.a.func,oauthInfo:wn.a.array,isCursorHoldingPen:wn.a.bool,hasActiveCamera:wn.a.bool,onMediaSearchResultEntrySelected:wn.a.func,onAvatarSaved:wn.a.func,activeTips:wn.a.object,location:wn.a.object,history:wn.a.object,showInterstitialPrompt:wn.a.bool,onInterstitialPromptClicked:wn.a.func,performConditionalSignIn:wn.a.func,hide:wn.a.bool,showPreload:wn.a.bool,onPreloadLoadClicked:wn.a.func,embed:wn.a.bool,embedToken:wn.a.string,onLoaded:wn.a.func});var Oh=Dh,Hh=i(198),jh=i(65),Ih=i.n(jh),Nh=i(76),Fh=i(106);function Vh(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function Bh(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){Vh(s,n,a,o,r,"next",e)}function r(e){Vh(s,n,a,o,r,"throw",e)}o(void 0)})}}function zh(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Uh=864e5,Wh=2592e6;function Zh(e,t){return e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()}const Gh=["update_hub","update_hub_promotion","update_roles","close_hub","mute_users","kick_users"],qh=Gh+["tweet","spawn_camera","spawn_drawing","spawn_and_move_media","pin_objects"];class $h extends Nh.a{constructor(e,t){var i;super(),i=this,zh(this,"setPhoenixChannel",e=>{this.channel=e,this.presence=new Fh.a(e)}),zh(this,"setPermissionsFromToken",e=>{this._permissions=Ih()(e),n.a.setIsAdmin("ret_admin"===this._permissions.postgrest_role),this.dispatchEvent(new CustomEvent("permissions_updated"));const t=new Date(1e3*this._permissions.exp-6e4)-new Date;setTimeout(Bh(function*(){const e=yield i.fetchPermissions();i.dispatchEvent(new CustomEvent("permissions-refreshed",{detail:e}))}),t)}),zh(this,"sendEnteringEvent",Bh(function*(){i.channel.push("events:entering",{})})),zh(this,"sendEnteringCancelledEvent",Bh(function*(){i.channel.push("events:entering_cancelled",{})})),zh(this,"sendEnteredEvent",Bh(function*(){if(!i.channel)return void console.warn("No phoenix channel initialized before room entry.");let e="Screen";if(navigator.getVRDisplays){const t=(yield navigator.getVRDisplays()).find(e=>e.isPresenting);t&&(e=t.displayName)}let t=0;NAF.connection.adapter&&NAF.connection.adapter.publisher&&(t=NAF.connection.adapter.publisher.initialOccupants.length);const n=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),n.forEach(function(t){zh(e,t,i[t])})}return e}({},i.getEntryTimingFlags(),{initialOccupantCount:t,entryDisplayType:e,userAgent:navigator.userAgent});i.channel.push("events:entered",n)})),zh(this,"getEntryTimingFlags",()=>{const e={isNewDaily:!0,isNewMonthly:!0,isNewDayWindow:!0,isNewMonthWindow:!0},t=this.store.state.activity.lastEnteredAt;if(!t)return e;const i=new Date,n=new Date(t),a=i-n;return e.isNewDaily=!function(e,t){return Zh(e,t)&&e.getDate()==t.getDate()}(i,n),e.isNewMonthly=!Zh(i,n),e.isNewDayWindow=a>Uh,e.isNewMonthWindow=a>Wh,e}),zh(this,"sendObjectSpawnedEvent",e=>{if(!this.channel)return void console.warn("No phoenix channel initialized before object spawn.");const t={object_type:e};this.channel.push("events:object_spawned",t)}),zh(this,"sendProfileUpdate",()=>{this.channel.push("events:profile_updated",{profile:this.store.state.profile})}),zh(this,"updateScene",e=>{if(!this._permissions.update_hub)return"unauthorized";this.channel.push("update_scene",{url:e})}),zh(this,"updateHub",e=>{if(!this._permissions.update_hub)return"unauthorized";this.channel.push("update_hub",e)}),zh(this,"closeHub",()=>{if(!this._permissions.close_hub)return"unauthorized";this.channel.push("close_hub",{})}),zh(this,"subscribe",e=>{this.channel.push("subscribe",{subscription:e})}),zh(this,"allowNAFTraffic",e=>{this.channel.push(e?"unblock_naf":"block_naf",{})}),zh(this,"unsubscribe",e=>new Promise(t=>this.channel.push("unsubscribe",{subscription:e}).receive("ok",t))),zh(this,"sendMessage",(e,t="chat")=>{e&&this.channel.push("message",{body:e,type:t})}),zh(this,"_getCreatorAssignmentToken",()=>{const e=this.store.state.creatorAssignmentTokens&&this.store.state.creatorAssignmentTokens.find(e=>e.hubId===this.hubId);return e&&e.creatorAssignmentToken}),zh(this,"signIn",e=>new Promise((t,i)=>{const n=this._getCreatorAssignmentToken();this.channel.push("sign_in",{token:e,creator_assignment_token:n}).receive("ok",({perms_token:e})=>{this.setPermissionsFromToken(e),this._signedIn=!0,t()}).receive("error",e=>{"invalid_token"===e.reason?(console.warn("sign in failed",e),t()):(console.error("sign in failed",e),i())})})),zh(this,"signOut",()=>new Promise((e,t)=>{this.channel.push("sign_out").receive("ok",Bh(function*(){i._signedIn=!1;const t=i.channel.params();delete t.auth_token,delete t.perms_token,yield i.fetchPermissions(),e()})).receive("error",t)})),zh(this,"getHost",()=>new Promise((e,t)=>{this.channel.push("get_host").receive("ok",t=>{e(t.host)}).receive("error",t)})),zh(this,"getTwitterOAuthURL",()=>new Promise((e,t)=>{this.channel.push("oauth",{type:"twitter"}).receive("ok",t=>{e(t.oauth_url)}).receive("error",t)})),zh(this,"discordBridges",()=>this.presence&&this.presence.state?Object(h.c)(this.presence.state):[]),zh(this,"pin",(e,t,i,n,a)=>{const s={id:e,gltf_node:t};return i&&a&&(s.file_id=i,s.file_access_token=n,s.promotion_token=a),new Promise((e,t)=>{this.channel.push("pin",s).receive("ok",e).receive("error",t)})}),zh(this,"unpin",(e,t)=>{const i={id:e};t&&(i.file_id=t),this.channel.push("unpin",i)}),zh(this,"fetchPermissions",()=>new Promise((e,t)=>{this.channel.push("refresh_perms_token").receive("ok",t=>{this.setPermissionsFromToken(t.perms_token),e({permsToken:t.perms_token,permissions:this._permissions})}).receive("error",t)})),zh(this,"mute",e=>this.channel.push("mute",{session_id:e})),zh(this,"addOwner",e=>this.channel.push("add_owner",{session_id:e})),zh(this,"removeOwner",e=>this.channel.push("remove_owner",{session_id:e})),zh(this,"hide",e=>{NAF.connection.adapter.block(e),this.channel.push("block",{session_id:e}),this._blockedSessionIds.add(e)}),zh(this,"unhide",e=>{this._blockedSessionIds.has(e)&&(NAF.connection.adapter.unblock(e),NAF.connection.entities.completeSync(e),this.channel.push("unblock",{session_id:e}),this._blockedSessionIds.delete(e))}),zh(this,"isHidden",e=>this._blockedSessionIds.has(e)),zh(this,"kick",function(){var e=Bh(function*(e){const t=yield i.fetchPermissions();NAF.connection.adapter.kick(e,t),i.channel.push("kick",{session_id:e})});return function(t){return e.apply(this,arguments)}}()),zh(this,"requestSupport",()=>this.channel.push("events:request_support",{})),zh(this,"favorite",()=>this.channel.push("favorite",{})),zh(this,"unfavorite",()=>this.channel.push("unfavorite",{})),zh(this,"disconnect",()=>{this.channel&&this.channel.socket.disconnect()}),this.store=e,this.hubId=t,this._signedIn=!!this.store.state.credentials.token,this._permissions={},this._blockedSessionIds=new Set}get signedIn(){return this._signedIn}can(e){if(!qh.includes(e))throw new Error(`Invalid permission name: ${e}`);return this._permissions&&this._permissions[e]}canOrWillIfCreator(e){return!(!this._getCreatorAssignmentToken()||!Gh.includes(e))||this.can(e)}migrateToSocket(e,t){var i=this;return Bh(function*(){let n;i.presence&&(n={onJoin:i.presence.caller.onJoin,onLeave:i.presence.caller.onLeave,onSync:i.presence.caller.onSync},i.presence.onJoin(function(){}),i.presence.onLeave(function(){}),i.presence.onSync(function(){})),i.channel=yield Object(h.m)(i.channel,e,t),i.presence=new Fh.a(i.channel),n&&(i.presence.onJoin(n.onJoin),i.presence.onLeave(n.onLeave),i.presence.onSync(n.onSync))})()}beginStreaming(){this.channel.push("events:begin_streaming",{})}endStreaming(){this.channel.push("events:end_streaming",{})}beginRecording(){this.channel.push("events:begin_recording",{})}endRecording(){this.channel.push("events:end_recording",{})}}var Yh=i(262),Xh=i(125);function Qh(e,t){const i=t.boundingData,n=(i[3]-i[0])*(i[4]-i[1])*(i[5]-i[2]);return!(n<.1)&&(!(e<100)&&e/n>1e3)}function Kh(e){if(e.count){return!0===Qh(e.count,e)||e.count}{const t=Kh(e.left);if(!0===t)return!0;const i=Kh(e.right);if(!0===i)return!0;const n=t+i;return!0===Qh(n,e)||n}}const Jh=function(){const e="shape-helper__",t=[];return function(i){const n=i.object3DMap.mesh;for(;t.length>0;){const{id:e,entity:i}=t.pop();i.removeAttribute(e)}if(console.group("traverseMeshesAndAddShapes"),document.querySelector(["[shape-helper__trimesh]","[shape-helper__heightfield]"]))console.log("heightfield or trimesh found on scene");else{console.log("collision not found in scene");let a=!1;n.traverse(e=>{!e.isMesh||THREE.Sky&&e.__proto__==THREE.Sky.prototype||e.name.startsWith("Floor_Plan")||e.name.startsWith("Ground_Plane")||!e.geometry.boundsTree||!function(e){const t=e.boundsTree._roots;for(let e=0;e<t.length;++e)return!0===Kh(t[e]);return!1}(e.geometry)||(a=!0)});let s=null;a&&(console.log("mesh contains high triangle density region"),s=document.querySelector("[nav-mesh]")),s?(console.log("mesh density exceeded, using floor plan only"),s.setAttribute(e+"floorPlan",{type:$.SHAPE.MESH,margin:.01,fit:$.FIT.ALL,includeInvisible:!0}),t.push({id:e+"floorPlan",entity:s})):a?(i.setAttribute(e+"defaultFloor",{type:$.SHAPE.BOX,margin:.01,halfExtents:{x:4e3,y:.5,z:4e3},offset:{x:0,y:-.5,z:0},fit:$.FIT.MANUAL}),t.push({id:e+"defaultFloor",entity:i}),console.log("adding default floor collision")):(i.setAttribute(e+"environment",{type:$.SHAPE.MESH,margin:.01,fit:$.FIT.ALL}),t.push({id:e+"environment",entity:i}),console.log("adding mesh shape for all visible meshes"))}console.groupEnd()}}();function eu(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function tu(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class iu{constructor(e,t,i,n,a,s){var o=this;tu(this,"log",e=>{this.addToPresenceLog({type:"log",body:e})}),tu(this,"dispatch",e=>{if(e.startsWith("/")){const t=e.substring(1).split(/\s+/);this.dispatchCommand(t[0],...t.slice(1)),document.activeElement.blur()}else this.hubChannel.sendMessage(e)}),tu(this,"dispatchCommand",function(){var e,t=(e=function*(e,...t){if(!o.scene.is("entered"))return void o.addToPresenceLog({type:"log",body:"You must enter the room to use this command."});const i=document.querySelector("#avatar-rig"),n=[.0625,.125,.25,.5,1,1.5,3,5,7.5,12.5],a=i.object3D.scale;let s,r;const l=o.scene.systems["capture-system"];switch(e){case"fly":o.scene.systems["hubs-systems"].characterController.fly?(o.scene.systems["hubs-systems"].characterController.fly=!1,o.addToPresenceLog({type:"log",body:"Fly mode disabled."})):(o.scene.systems["hubs-systems"].characterController.fly=!0,o.addToPresenceLog({type:"log",body:"Fly mode enabled."}));break;case"grow":for(let e=0;e<n.length;e++)if(n[e]>a.x){i.object3D.scale.set(n[e],n[e],n[e]),i.object3D.matrixNeedsUpdate=!0;break}break;case"shrink":for(let e=n.length-1;e>=0;e--)if(a.x>n[e]){i.object3D.scale.set(n[e],n[e],n[e]);break}break;case"leave":o.entryManager.exitScene(),o.remountUI({roomUnavailableReason:"left"});break;case"duck":jl(Object(Ne.a)(location.href,Ts.a)),Math.random()<.01?o.scene.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(v.s):o.scene.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(v.o);break;case"debug":(r=document.querySelector("a-scene").systems["hubs-systems"].physicsSystem).setDebug(!r.debugEnabled);break;case"vrstats":document.getElementById("stats").components["stats-plus"].toggleVRStats();break;case"scene":t[0]?(yield Object(Ws.b)(t[0]))?"unauthorized"===(s=o.hubChannel.updateScene(t[0]))&&o.addToPresenceLog({type:"log",body:"You do not have permission to change the scene."}):o.addToPresenceLog({type:"log",body:ba.b["invalid-scene-url"]}):o.hubChannel.canOrWillIfCreator("update_hub")&&o.mediaSearchStore.sourceNavigateWithNoNav("scenes","use");break;case"rename":"unauthorized"===(s=o.hubChannel.rename(t.join(" ")))&&o.addToPresenceLog({type:"log",body:"You do not have permission to rename this room."});break;case"capture":if(!l.available()){o.log("Capture unavailable.");break}"stop"===t[0]?l.started()?(l.stop(),o.log("Capture stopped.")):o.log("Capture already stopped."):l.started()?o.log("Capture already running."):(l.start(),o.log("Capture started."))}},function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){eu(s,n,a,o,r,"next",e)}function r(e){eu(s,n,a,o,r,"throw",e)}o(void 0)})});return function(e){return t.apply(this,arguments)}}()),this.scene=e,this.entryManager=t,this.hubChannel=i,this.addToPresenceLog=n,this.remountUI=a,this.mediaSearchStore=s}}var nu=i(127);function au(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function su(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){au(s,n,a,o,r,"next",e)}function r(e){au(s,n,a,o,r,"throw",e)}o(void 0)})}}function ou(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const ru=Object(Me.a)("bot"),lu=AFRAME.utils.device.isMobile(),cu=Object(nu.a)(),du=AFRAME.utils.device.isMobileVR(),hu=Object(Me.a)("debug"),uu=new URLSearchParams(location.search),pu=AFRAME.utils.device.isIOS();class mu{constructor(e,t,i,n){var a=this;ou(this,"init",()=>{this.whenSceneLoaded(()=>{this.rightCursorController.components["cursor-controller"].enabled=!1,this.leftCursorController.components["cursor-controller"].enabled=!1})}),ou(this,"hasEntered",()=>this._entered),ou(this,"enterScene",function(){var e=su(function*(e,t,i){if(document.getElementById("viewing-camera").removeAttribute("scene-preview-camera"),a.scene.systems["hubs-systems"].waypointSystem.moveToSpawnPoint(),hu&&(NAF.connection.adapter.session.options.verbose=!0),t&&(a.scene.addState("vr-entered"),navigator.getVRDisplays(),yield si(!0)),(lu||cu||Object(Me.a)("mobile"))&&a.avatarRig.setAttribute("virtual-gamepad-controls",{}),a._setupPlayerRig(),a._setupBlocking(),a._setupKicking(),a._setupMedia(e),a._setupCamera(),!Object(Me.a)("offline")){if(a._spawnAvatar(),a.scene.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(v.d),ru)return a._runBot(e),void a.scene.addState("entered");e&&(yield NAF.connection.adapter.setLocalMediaStream(e)),a.scene.classList.remove("hand-cursor"),a.scene.classList.add("no-cursor"),a.rightCursorController.components["cursor-controller"].enabled=!0,a.leftCursorController.components["cursor-controller"].enabled=!0,a._entered=!0,su(function*(){for(;t&&!(yield navigator.getVRDisplays()).find(e=>e.isPresenting);)yield Object(u.a)();a.hubChannel.sendEnteredEvent().then(()=>{a.store.update({activity:{lastEnteredAt:(new Date).toISOString()}})})})(),setTimeout(()=>a.store.bumpEntryCount(),3e4),a.scene.addState("entered"),i&&a.scene.emit("action_mute")}});return function(t,i,n){return e.apply(this,arguments)}}()),ou(this,"whenSceneLoaded",e=>{this.scene.hasLoaded?e():this.scene.addEventListener("loaded",e)}),ou(this,"enterSceneWhenLoaded",(e,t)=>{this.whenSceneLoaded(()=>this.enterScene(e,t))}),ou(this,"exitScene",()=>{this.scene.exitVR(),NAF.connection.adapter&&NAF.connection.adapter.localMediaStream&&NAF.connection.adapter.localMediaStream.getTracks().forEach(e=>e.stop()),this.hubChannel&&this.hubChannel.disconnect(),this.scene.renderer&&this.scene.renderer.setAnimationLoop(null),this.scene.parentNode.removeChild(this.scene)}),ou(this,"_setupPlayerRig",()=>{this._setPlayerInfoFromProfile(),this.scene.addEventListener("avatar_updated",()=>this._setPlayerInfoFromProfile(!0)),this.store.addEventListener("statechanged",()=>this._setPlayerInfoFromProfile());const e=parseInt(uu.get("avatar_scale"),10);e&&this.avatarRig.setAttribute("scale",{x:e,y:e,z:e})}),ou(this,"_setPlayerInfoFromProfile",function(){var e=su(function*(e=!1){const t=a.store.state.profile.avatarId;if(!e&&a._lastFetchedAvatarId===t)return;a._lastFetchedAvatarId=t;const i=yield Object(ye.e)(t);a.avatarRig.setAttribute("player-info",{avatarSrc:i,avatarType:Object(ye.g)(t)})});return function(){return e.apply(this,arguments)}}()),ou(this,"_setupKicking",()=>{document.body.addEventListener("kicked",({detail:e})=>{const{clientId:t}=e,{entities:i}=NAF.connection.entities;for(const e in i){const n=i[e];NAF.utils.getCreator(n)===t&&(n.components.networked.data.persistent?(NAF.utils.takeOwnership(n),this._unpinElement(n),n.parentNode.removeChild(n)):NAF.entities.removeEntity(e))}})}),ou(this,"_setupBlocking",()=>{document.body.addEventListener("blocked",e=>{NAF.connection.entities.removeEntitiesOfClient(e.detail.clientId)}),document.body.addEventListener("unblocked",e=>{NAF.connection.entities.completeSync(e.detail.clientId,!0)})}),ou(this,"_pinElement",function(){var e=su(function*(e){const{networkId:t}=e.components.networked.data,{fileId:i,src:n}=e.components["media-loader"].data;let s,o;if(i){s=new URL(n).searchParams.get("token");const e=Object(be.i)(i);e&&(o=e.promotionToken)}const r=function(e){if(!NAF.utils.isMine(e))return;const t=e.object3D,i=e.components,n=i.networked.data.networkId,a={},s={name:n,extensions:{HUBS_components:a}},o=(e,t)=>e.length===t.length&&e.every((e,i)=>e===t[i]),r=t.quaternion.toArray(),l=t.position.toArray(),c=t.scale.toArray();if(o(r,[0,0,0,1])||(s.rotation=r),o(l,[0,0,0])||(s.translation=l),o(c,[1,1,1])||(s.scale=c),i["media-loader"]){const e=i["media-loader"].data.src,t=i["media-loader"].data.version,s=i["media-loader"].data.contentSubtype;if(e.startsWith("hubs://")&&e.endsWith("/video"))return null;a.media={src:e,version:t,contentSubtype:s,id:n},i["media-pdf"]&&(a.media.pageIndex=i["media-pdf"].data.index),i["media-video"]&&i["media-video"].data.videoPaused&&(a.media.paused=!0,a.media.time=i["media-video"].data.time)}return a.pinnable={pinned:!0},s}(e);if(r){e.setAttribute("networked",{persistent:!0}),e.setAttribute("media-loader",{fileIsOwned:!0});try{yield a.hubChannel.pin(t,r,i,s,o),a.store.update({activity:{hasPinned:!0}})}catch(t){"invalid_token"===t.reason?(yield a.authChannel.signOut(a.hubChannel),a._signInAndPinOrUnpinElement(e)):console.warn("Pin failed for unknown reason",t)}}});return function(t){return e.apply(this,arguments)}}()),ou(this,"_signInAndPinOrUnpinElement",(e,t)=>{const i=t?()=>this._pinElement(e):su(function*(){yield a._unpinElement(e)});this.performConditionalSignIn(()=>this.hubChannel.signedIn,i,t?"pin":"unpin",()=>{this._disableSignInOnPinAction=!0,e.setAttribute("pinnable","pinned",!t),this._disableSignInOnPinAction=!1})}),ou(this,"_unpinElement",e=>{const t=e.components,i=t.networked;if(!i||!i.data||!NAF.utils.isMine(e))return;const n=t.networked.data.networkId;e.setAttribute("networked",{persistent:!1});const a=t["media-loader"],s=a.data&&a.data.fileId;this.hubChannel.unpin(n,s)}),ou(this,"_setupMedia",e=>{const t={x:0,y:0,z:-1.5},i=(e,i)=>{if(!this.hubChannel.can("spawn_and_move_media"))return;const{entity:n,orientation:a}=Object(be.b)(e,"#interactable-media",i,null,!(e instanceof MediaStream),!0);return a.then(e=>{n.setAttribute("offset-relative-to",{target:"#avatar-pov-node",offset:t,orientation:e})}),n};this.scene.addEventListener("add_media",e=>{const t=e.detail instanceof File?Tt.a.FILE:Tt.a.URL;i(e.detail,t)});const n=(e,t)=>{if(this._disableSignInOnPinAction)return;const i=e.detail.el;NAF.utils.isMine(i)&&this._signInAndPinOrUnpinElement(e.detail.el,t)};let s;this.scene.addEventListener("pinned",e=>n(e,!0)),this.scene.addEventListener("unpinned",e=>n(e,!1)),this.scene.addEventListener("object_spawned",e=>{this.hubChannel.sendObjectSpawnedEvent(e.detail.objectType)}),this.scene.addEventListener("action_spawn",()=>{ni(!1,()=>window.APP.mediaSearchStore.pushExitMediaBrowserHistory()),window.APP.mediaSearchStore.sourceNavigateToDefaultSource()}),this.scene.addEventListener("action_invite",()=>{ni(!1,()=>this.history.goBack()),Object(en.e)(this.history,"overlay","invite")}),this.scene.addEventListener("action_kick_client",({detail:{clientId:e}})=>{this.performConditionalSignIn(()=>this.hubChannel.can("kick_users"),su(function*(){return yield window.APP.hubChannel.kick(e)}),"kick-user")}),this.scene.addEventListener("action_mute_client",({detail:{clientId:e}})=>{this.performConditionalSignIn(()=>this.hubChannel.can("mute_users"),()=>window.APP.hubChannel.mute(e),"mute-user")}),this.scene.addEventListener("action_vr_notice_closed",()=>(function(){return li.apply(this,arguments)})()),document.addEventListener("paste",e=>{if((e.target.matches("input, textarea")||"true"===e.target.contentEditable)&&document.activeElement===e.target)return;const t=document.querySelector(".ui-root");if(t&&t.classList.contains("in-modal-or-overlay"))return;const n=e.clipboardData.getData("text"),a=e.clipboardData.files&&e.clipboardData.files;if(n)i(n,Tt.a.URL);else for(const e of a)i(e,Tt.a.CLIPBOARD)}),document.addEventListener("dragover",e=>e.preventDefault()),document.addEventListener("drop",e=>{e.preventDefault();let t=e.dataTransfer.getData("url");if(!t)try{t=new URL(e.dataTransfer.getData("text")).href}catch(e){}const n=e.dataTransfer.files;if(t)i(t,Tt.a.URL);else for(const e of n)i(e,Tt.a.FILE)});let o=!1;const r=function(){var t=su(function*(t,n){if(o)return;let r;o=!0;try{r=n?yield navigator.mediaDevices.getDisplayMedia(t):yield navigator.mediaDevices.getUserMedia(t)}catch(e){return o=!1,void a.scene.emit("share_video_failed")}(r?r.getVideoTracks():[]).length>0&&(r.getVideoTracks().forEach(t=>e.addTrack(t)),yield NAF.connection.adapter.setLocalMediaStream(e),(s=i(e,void 0)).setAttribute("emit-scene-event-on-remove","event:action_end_video_sharing")),a.scene.emit("share_video_enabled",{source:n?"screen":"camera"}),a.scene.addState("sharing_video"),o=!1});return function(e,i){return t.apply(this,arguments)}}();this.scene.addEventListener("action_share_camera",()=>{r({video:{mediaSource:"camera",width:pu?{max:1280}:{max:1280,ideal:720},frameRate:30}})}),this.scene.addEventListener("action_share_screen",()=>{r({video:{width:screen.width/screen.height*720,height:720,frameRate:30},audio:!0},!0)}),this.scene.addEventListener("action_end_video_sharing",su(function*(){if(!o){o=!0,s&&s.parentNode&&(NAF.utils.takeOwnership(s),s.parentNode.removeChild(s));for(const t of e.getVideoTracks())e.removeTrack(t);yield NAF.connection.adapter.setLocalMediaStream(e),s=null,a.scene.emit("share_video_disabled"),a.scene.removeState("sharing_video"),o=!1}})),this.scene.addEventListener("action_selected_media_result_entry",function(){var e=su(function*(e){const{entry:t,selectAction:n}=e.detail;if("spawn"!==n)return;const a=ri()&&!du;yield si(),a?setTimeout(()=>{i(t.url,Tt.a.URL)},3e3):i(t.url,Tt.a.URL)});return function(t){return e.apply(this,arguments)}}()),this.mediaSearchStore.addEventListener("media-exit",()=>{si()})}),ou(this,"_setupCamera",()=>{this.scene.addEventListener("action_toggle_camera",()=>{if(!this.hubChannel.can("spawn_camera"))return;const e=this.scene.systems["camera-tools"].getMyCamera();if(e)e.parentNode.removeChild(e),this.scene.removeState("camera");else{const e=document.createElement("a-entity");e.setAttribute("networked",{template:"#interactable-camera"}),e.setAttribute("offset-relative-to",{target:"#avatar-pov-node",offset:{x:0,y:0,z:-1.5}}),this.scene.appendChild(e),this.scene.addState("camera")}setTimeout(()=>this.scene.emit("camera_toggled"))}),this.scene.addEventListener("photo_taken",e=>this.hubChannel.sendMessage({src:e.detail},"photo")),this.scene.addEventListener("video_taken",e=>this.hubChannel.sendMessage({src:e.detail},"video"))}),ou(this,"_spawnAvatar",()=>{this.avatarRig.setAttribute("networked","template: #remote-avatar; attachTemplateToLocal: false;"),this.avatarRig.setAttribute("networked-avatar",""),this.avatarRig.emit("entered")}),ou(this,"_runBot",function(){var e=su(function*(e){const t=document.createElement("audio");let i,n;do{i=document.querySelector("#bot-audio-input"),n=document.querySelector("#bot-data-input"),yield Object(u.a)()}while(!i||!n);const a=()=>{t.loop=!0,t.muted=!0,t.crossorigin="anonymous",t.src=URL.createObjectURL(i.files[0]),document.body.appendChild(t)};i.files&&i.files.length>0?a():i.onchange=a;const s=document.querySelector("#avatar-pov-node"),o=document.querySelector("#player-left-controller"),r=document.querySelector("#player-right-controller"),l=()=>{fetch(URL.createObjectURL(n.files[0])).then(e=>e.json()).then(e=>{s.setAttribute("replay",""),s.components.replay.poses=e.camera.poses,o.setAttribute("replay",""),o.components.replay.poses=e.left.poses,o.removeAttribute("visibility-by-path"),o.removeAttribute("track-pose"),o.setAttribute("visible",!0),r.setAttribute("replay",""),r.components.replay.poses=e.right.poses,r.removeAttribute("visibility-by-path"),r.removeAttribute("track-pose"),r.setAttribute("visible",!0)})};n.files&&n.files.length>0?l():n.onchange=l,yield new Promise(e=>t.addEventListener("canplay",e)),e.addTrack(t.captureStream?t.captureStream().getAudioTracks()[0]:t.mozCaptureStream?t.mozCaptureStream().getAudioTracks()[0]:null),yield NAF.connection.adapter.setLocalMediaStream(e),t.play()});return function(t){return e.apply(this,arguments)}}()),this.hubChannel=e,this.authChannel=t,this.availableVREntryTypes=i,this.store=window.APP.store,this.mediaSearchStore=window.APP.mediaSearchStore,this.scene=document.querySelector("a-scene"),this.rightCursorController=document.getElementById("right-cursor-controller"),this.leftCursorController=document.getElementById("left-cursor-controller"),this.avatarRig=document.getElementById("avatar-rig"),this._entered=!1,this.performConditionalSignIn=()=>{},this.history=n}}function gu(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function fu(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){gu(s,n,a,o,r,"next",e)}function r(e){gu(s,n,a,o,r,"throw",e)}o(void 0)})}}function vu(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const bu=5e3;function yu(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),i=window.atob(t),n=new Uint8Array(i.length);for(let e=0;e<i.length;++e)n[e]=i.charCodeAt(e);return n}class _u{constructor(e){var t=this;vu(this,"setHubChannel",e=>{this.hubChannel=e}),vu(this,"setRegistration",e=>{this.registration=e}),vu(this,"setRegistrationFailed",()=>{this.registration=null}),vu(this,"setVapidPublicKey",e=>{this.vapidPublicKey=e}),vu(this,"setSubscribed",e=>{this._isSubscribed=e}),vu(this,"isSubscribed",()=>this._isSubscribed),vu(this,"getCurrentEndpoint",fu(function*(){if(!navigator.serviceWorker)return null;const e=performance.now();for(;void 0===t.registration&&performance.now()-e<bu;)yield Object(u.a)();if(performance.now()-e>=bu&&console.warn("Service worker registration timed out."),!t.registration||!t.registration.pushManager)return null;for(;void 0===t.vapidPublicKey;)yield Object(u.a)();if(null===t.vapidPublicKey)return null;try{const e=yu(t.vapidPublicKey);if("granted"!==(yield t.registration.pushManager.permissionState({userVisibleOnly:!0,applicationServerKey:e})))return null}catch(e){return null}const i=yield t.registration.pushManager.getSubscription();return i?i.endpoint:null})),vu(this,"toggle",fu(function*(){if(t.registration){if(t._isSubscribed){const e=yield t.registration.pushManager.getSubscription(),i=yield t.hubChannel.unsubscribe(e);i&&!1===i.has_remaining_subscriptions&&e.unsubscribe()}else{let e=yield t.registration.pushManager.getSubscription();if(!e){const i=yu(t.vapidPublicKey);e=yield t.registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:i})}t.hubChannel.subscribe(e)}t._isSubscribed=!t._isSubscribed}})),this.hubId=e}}i(372),i(1210);var wu=i(48);const Eu=new AFRAME.THREE.Vector3,xu=new AFRAME.THREE.Vector3,Su=Object(Me.a)("debug"),Cu=AFRAME.utils.device.isMobileVR();function ku(e){const t=new THREE.SphereBufferGeometry(e,10,10),i=new THREE.WireframeGeometry(t),n=new THREE.LineSegments(i);return n.material.opacity=.5,n.material.transparent=!0,n}AFRAME.registerSystem("personal-space-bubble",{schema:{debug:{default:!1},enabled:{default:!0}},init(){this.invaders=[],this.bubbles=[],this.tickCount=0,this._updateInvaders=this._updateInvaders.bind(this)},registerBubble(e){this.bubbles.push(e)},unregisterBubble(e){const t=this.bubbles.indexOf(e);-1!==t&&this.bubbles.splice(t,1)},registerInvader(e){NAF.utils.getNetworkedEntity(e.el).then(t=>{NAF.utils.getNetworkOwner(t)!==NAF.clientId&&this.invaders.push(e)})},unregisterInvader(e){const t=this.invaders.indexOf(e);-1!==t&&this.invaders.splice(t,1)},update(){for(let e=0;e<this.bubbles.length;e++)this.bubbles[e].updateDebug();for(let e=0;e<this.invaders.length;e++)this.invaders[e].updateDebug(),this.data.enabled||this.invaders[e].setInvading(!1);this.data.enabled?this.el.addState("spacebubble"):this.el.removeState("spacebubble")},tick(){this._updateInvaders(),this.tickCount++},_updateInvaders:function(){const e=[],t=(t,i,n)=>{const a=i[t];Eu.setFromMatrixPosition(a.el.object3D.matrixWorld);const s=xu.distanceToSquared(Eu),o=n.data.radius+a.data.radius;s<o*o&&(e[t]=!0)},i=(t,i)=>{i[t].invading!==e[t]&&i[t].setInvading(e[t])};return function(){if(this.data.enabled&&0!==this.invaders.length){e.length=0;for(let t=0;t<this.invaders.length;t++)this.invaders[t].el.object3D.updateMatrices(),e[t]=!1;for(let e=0;e<this.bubbles.length;e++){const i=this.bubbles[e];if(i.el.object3D.updateMatrices(),xu.setFromMatrixPosition(i.el.object3D.matrixWorld),Cu)t(this.tickCount%this.invaders.length,this.invaders,i);else for(let e=0;e<this.invaders.length;e++)t(e,this.invaders,i)}if(Cu)i(this.tickCount%this.invaders.length,this.invaders);else for(let e=0;e<this.invaders.length;e++)i(e,this.invaders)}}}()}),AFRAME.registerComponent("space-invader-mesh",{schema:{meshName:{type:"string"}},update(){this.targetMesh=this.el.object3D.getObjectByName(this.data.meshName)}});AFRAME.registerComponent("personal-space-invader",{schema:{radius:{type:"number",default:.1},useMaterial:{default:!1},debug:{default:!1},invadingOpacity:{default:.3}},init(){if(this.el.sceneEl.systems["personal-space-bubble"].registerInvader(this),this.data.useMaterial){const e=function(e){for(;e&&(!e.components||!e.components["space-invader-mesh"]);)e=e.parentNode;return e&&e.components["space-invader-mesh"].targetMesh}(this.el);e&&(this.targetMesh=e)}this.invading=!1,this.alwaysHidden=!1},update(){this.radiusSquared=this.data.radius*this.data.radius,this.updateDebug()},setAlwaysHidden(e){this.alwaysHidden=e,this.applyInvasionToMesh(this.invading)},updateDebug(){this.el.sceneEl.systems["personal-space-bubble"].data.debug||this.data.debug?!this.el.object3DMap["psb-debug"]&&this.el.setObject3D("psb-debug",ku(this.data.radius)):this.el.object3DMap["psb-debug"]&&this.el.removeObject3D("psb-debug")},remove(){this.el.sceneEl.systems["personal-space-bubble"].unregisterInvader(this)},setInvading(e){this.invading!==e&&(this.applyInvasionToMesh(e),this.invading=e)},disable(){this.invading&&this.applyInvasionToMesh(!1),this.disabled=!0,this.updateBoneVisibility()},enable(){this.disabled=!1,this.applyInvasionToMesh(this.invading),this.updateBoneVisibility()},updateBoneVisibility(){this.el.components["bone-visibility"]&&this.el.components["bone-visibility"].tick()},applyInvasionToMesh(e){this.disabled||(this.targetMesh&&this.targetMesh.material&&!this.alwaysHidden?Object(wu.a)(this.targetMesh,t=>{t.opacity=e?this.data.invadingOpacity:1,t.transparent=e}):this.el.object3D.visible=!e&&!this.alwaysHidden)}}),AFRAME.registerComponent("personal-space-bubble",{schema:{radius:{type:"number",default:.8},debug:{default:!1}},init(){this.system.registerBubble(this)},update(){this.radiusSquared=this.data.radius*this.data.radius,this.updateDebug()},updateDebug(){Su&&(this.system.data.debug||this.data.debug?!this.el.object3DMap["psb-debug"]&&this.el.setObject3D("psb-debug",ku(this.data.radius)):this.el.object3DMap["psb-debug"]&&this.el.removeObject3D("psb-debug"))},remove(){this.system.unregisterBubble(this)}});i(1211),i(1212),i(1213),i(1214);const Au=new URLSearchParams(location.search),Tu=1e3*(parseInt(Au.get("idle_timeout"),10)||7200),Mu=ce.a.actions.characterAcceleration,Lu=[ce.a.actions.startGazeTeleport,ce.a.actions.rightHand.startTeleport,ce.a.actions.leftHand.startTeleport,ce.a.actions.snapRotateRight,ce.a.actions.snapRotateLeft,ce.a.actions.cursor.right.grab,ce.a.actions.cursor.left.grab,ce.a.actions.rightHand.grab,ce.a.actions.leftHand.grab,ce.a.actions.angularVelocity];AFRAME.registerSystem("idle-detector",{init(){this.resetTimeout=this.resetTimeout.bind(this),this.idleTimeout=null,this.lastInputCheck=0;const e=["click","pointerdown","touchstart","keyup"];for(const t of e)window.addEventListener(t,this.resetTimeout);this.resetTimeout()},resetTimeout(){this.idleTimeout&&clearTimeout(this.idleTimeout),this.idleTimeout=setTimeout(this.onIdleTimeout,Tu),window.dispatchEvent(new CustomEvent("activity_detected"))},onIdleTimeout(){window.dispatchEvent(new CustomEvent("idle_detected"))},tick(e){if(e-this.lastInputCheck<1e3)return;const t=this.el.systems.userinput;let i=!1;for(const e of Lu)i=i||!!t.get(e);const n=t.get(Mu);(i||!(!n||!n[0])||!(!n||!n[1]))&&this.resetTimeout()},remove(){}});AFRAME.registerSystem("camera-tools",{init(){this.cameraEls=[],this.cameraUpdateCount=0,this.ticks=0,this.updateMyCamera=this.updateMyCamera.bind(this),Object(ne.a)().then(()=>{const e=document.querySelector("#avatar-rig .model");e.addEventListener("model-loading",()=>this.playerHead=null),e.addEventListener("model-loaded",this.updatePlayerHead.bind(this)),this.updatePlayerHead(),this.updateMyCamera()})},updatePlayerHead(){const e=document.getElementById("avatar-head");this.playerHead=e&&e.object3D},register(e){this.cameraEls.push(e),e.addEventListener("ownership-changed",this.updateMyCamera),this.updateMyCamera()},deregister(e){this.cameraEls=this.cameraEls.filter(t=>t!==e),e.removeEventListener("ownership-changed",this.updateMyCamera),this.updateMyCamera()},getMyCamera(){return this.myCamera},ifMyCameraRenderingViewfinder(e){if(!this.myCamera)return;const t=this.myCamera.components["camera-tool"];t&&t.showCameraViewfinder&&t.camera&&e(t)},updateMyCamera(){this.cameraEls?this.myCamera=this.cameraEls.find(NAF.utils.isMine):this.myCamera=null},tick(){if(this.ticks++,this.ticks%10==0){if(0==this.cameraEls.length)return;this.cameraUpdateCount++,this.cameraEls[this.cameraUpdateCount%this.cameraEls.length].components["camera-tool"].updateViewfinder()}}});const Ru={[WheelEvent.DOM_DELTA_PIXEL]:500,[WheelEvent.DOM_DELTA_LINE]:10,[WheelEvent.DOM_DELTA_PAGE]:2},Pu=(()=>{let e=null;return function(){return e||(e=document.querySelector(".ui-root")),e&&e.classList.contains("in-modal-or-overlay")}})();class Du{constructor(){this.events=[],this.coords=[0,0],this.movementXY=[0,0],this.buttonLeft=!1,this.buttonRight=!1,this.buttonMiddle=!1,this.wheel=0;const e=this.events.push.bind(this.events),t=document.querySelector("canvas");t.addEventListener("contextmenu",e=>{if(2===e.button)return e.preventDefault(),e.stopPropagation(),!1}),["mousedown","wheel"].map(i=>t.addEventListener(i,e,{passive:!1})),["mousemove","mouseup"].map(t=>window.addEventListener(t,e,{passive:!1})),document.addEventListener("wheel",e=>{Pu()||window.APP.preferenceScreenIsVisible||e.preventDefault()},{passive:!1})}process(e){if("wheel"===e.type)return this.wheel+=(e.deltaX+e.deltaY)/Ru[e.deltaMode],!0;const t=0===e.button,i=1===e.button,n=2===e.button;if(this.coords[0]=e.clientX/window.innerWidth*2-1,this.coords[1]=-e.clientY/window.innerHeight*2+1,this.movementXY[0]+=e.movementX,this.movementXY[1]+=e.movementY,"mousedown"===e.type&&t)this.mouseDownLeftThisFrame=!0,this.buttonLeft=!0;else if("mousedown"===e.type&&n)this.mouseDownRightThisFrame=!0,this.buttonRight=!0;else if("mousedown"===e.type&&i)this.mouseDownMiddleThisFrame=!0,this.buttonMiddle=!0;else if("mouseup"===e.type&&t){if(this.mouseDownLeftThisFrame)return!1;this.buttonLeft=!1}else if("mouseup"===e.type&&n){if(this.mouseDownRightThisFrame)return!1;this.buttonRight=!1}else if("mouseup"===e.type&&i){if(this.mouseDownMiddleThisFrame)return!1;this.buttonMiddle=!1}return!0}write(e){this.movementXY[0]=0,this.movementXY[1]=0,this.wheel=0,this.didStopProcessingEarly=!1,this.mouseDownLeftThisFrame=!1,this.mouseDownRightThisFrame=!1,this.mouseDownMiddleThisFrame=!1;for(let e=0;e<this.events.length;e++){const t=this.events[e];if(!this.process(t)){this.didStopProcessingEarly=!0,this.events.splice(0,e);break}}this.didStopProcessingEarly||(this.events.length=0),e.setVector2(ce.a.device.mouse.coords,this.coords[0],this.coords[1]),e.setVector2(ce.a.device.mouse.movementXY,this.movementXY[0],this.movementXY[1]),e.setValueType(ce.a.device.mouse.buttonLeft,this.buttonLeft),e.setValueType(ce.a.device.mouse.buttonRight,this.buttonRight),e.setValueType(ce.a.device.mouse.buttonMiddle,this.buttonMiddle),e.setValueType(ce.a.device.mouse.wheel,this.wheel)}}function Ou(e){return{items:e||[],has(e){return-1!==this.items.indexOf(e)},add(e){this.has(e)||this.items.push(e)},delete(e){const t=this.items.indexOf(e);-1!==t&&(this.items[t]=this.items[this.items.length-1],this.items.pop())},clear(){this.items.length=0}}}window.oncontextmenu=e=>{Pu()||e.preventDefault()};class Hu{constructor(){this.seenKeys=new Ou,this.keys={},this.events=[],["keydown","keyup"].map(e=>document.addEventListener(e,e=>{if(e.key)return this.events.push(e),("keydown"!==e.type||"/"!==e.key||["TEXTAREA","INPUT"].includes(document.activeElement&&document.activeElement.nodeName)||document.activeElement&&"true"===document.activeElement.contentEditable)&&(!e.ctrlKey||"1"!==e.key&&"2"!==e.key&&"3"!==e.key&&"4"!==e.key&&"5"!==e.key&&"6"!==e.key&&"7"!==e.key&&"8"!==e.key&&"9"!==e.key&&"0"!==e.key)&&("Tab"!==e.key||window.APP&&window.APP.preferenceScreenIsVisible)?void 0:(e.preventDefault(),!1)})),["blur"].map(e=>window.addEventListener(e,this.events.push.bind(this.events)))}write(e){for(let e=0;e<this.events.length;e++){const t=this.events[e];if("blur"===t.type)this.keys={},this.seenKeys.clear();else{const e=t.key.toLowerCase();this.keys[e]="keydown"===t.type,this.seenKeys.add(e)}}this.events.length=0;for(let t=0;t<this.seenKeys.items.length;t++){const i=this.seenKeys.items[t],n=ce.a.device.keyboard.key(i);e.setValueType(n,this.keys[i])}}}class ju{constructor(){this.events=[],document.querySelector("a-scene").addEventListener("penButtonPressed",this.events.push.bind(this.events))}write(e){for(e.setValueType(ce.a.device.hud.penButton,0!==this.events.length);this.events.length;)this.events.pop()}}class Iu{constructor(e){this.gamepad=e,this.buttonMap=[{name:"a",buttonId:0},{name:"b",buttonId:1},{name:"x",buttonId:2},{name:"y",buttonId:3},{name:"leftBumper",buttonId:4},{name:"rightBumper",buttonId:5},{name:"leftTrigger",buttonId:6},{name:"rightTrigger",buttonId:7},{name:"back",buttonId:8},{name:"start",buttonId:9},{name:"leftJoystick",buttonId:10},{name:"rightJoystick",buttonId:11},{name:"dpadUp",buttonId:12},{name:"dpadDown",buttonId:13},{name:"dpadLeft",buttonId:14},{name:"dpadRight",buttonId:15}],this.axisMap=[{name:"leftJoystickHorizontal",axisId:0},{name:"leftJoystickVertical",axisId:1},{name:"rightJoystickHorizontal",axisId:2},{name:"rightJoystickVertical",axisId:3}]}write(e){if(this.gamepad=navigator.getGamepads()[this.gamepad.index],this.gamepad.connected){const t=ce.a.device.xbox;this.buttonMap.forEach(i=>{const n=t.button(i.name),a=this.gamepad.buttons[i.buttonId];e.setValueType(n.pressed,!!a.pressed),e.setValueType(n.touched,!!a.touched),e.setValueType(n.value,a.value)}),e.setValueType(t.axesSum,0),this.axisMap.forEach(i=>{e.setValueType(t.axis(i.name),this.gamepad.axes[i.axisId]),e.setValueType(t.axesSum,e.get(t.axesSum)+Math.abs(this.gamepad.axes[i.axisId]))}),this.gamepad.hapticActuators&&this.gamepad.hapticActuators[0]&&e.setValueType(ce.a.haptics.actuators[this.gamepad.hand],this.gamepad.hapticActuators[0])}}}const Nu="undefined"!=typeof window&&window.THREE,Fu=Nu&&Nu.Vector3||function(){},Vu=Nu&&Nu.Quaternion||function(){},Bu="undefined"!=typeof window&&window.THREE&&new Nu.Vector3(0,0,-1);function zu(){return{position:new Fu,direction:new Fu,orientation:new Vu,fromOriginAndDirection:function(e,t){return this.position=e,this.direction=t,this.orientation=this.orientation.setFromUnitVectors(Bu,t),this},fromCameraProjection:function(e,t,i){return this.position.setFromMatrixPosition(e.matrixWorld),this.direction.set(t,i,.5).unproject(e).sub(this.position).normalize(),this.fromOriginAndDirection(this.position,this.direction),this},copy:function(e){this.position.copy(e.position),this.direction.copy(e.direction),this.orientation.copy(e.orientation)}}}const Uu=.175,Wu=-.3,Zu=-.03,Gu=0,qu=0,$u=-.175,Yu=function(){const e=new THREE.Euler,t=new THREE.Vector3,i=new THREE.Quaternion,n=new THREE.Vector3;return function(a,s,o,r){return o.updateMatrices(),n.copy(o.position),n.y=n.y-r,t.set(Uu*("left"===s?-1:"right"===s?1:0),Wu,Zu),t.multiplyScalar(r),t.applyAxisAngle(o.up,o.rotation.y),n.add(t),t.set(Gu,qu,$u),t.multiplyScalar(r),i.fromArray(a.orientation),e.setFromQuaternion(i),e.set(e.x,e.y,0),t.applyEuler(e),n.add(t),n}}(),Xu=function e(t){navigator.getVRDisplays&&navigator.getVRDisplays().then(i=>{i[0]&&i[0].stageParameters&&i[0].stageParameters.sittingToStandingTransform?t.fromArray(i[0].stageParameters.sittingToStandingTransform):setTimeout(()=>{e(t)},1e3)})},Qu=new THREE.Vector3(1,1,1),Ku=new THREE.Matrix4,Ju=ce.a.device.oculusgo.touchpad,ep=ce.a.device.oculusgo.trigger;class tp{constructor(e){this.gamepad=e,this.rayObjectRotation=new THREE.Quaternion,this.pose=new zu,this.q=new THREE.Quaternion,this.sittingToStandingMatrix=(new THREE.Matrix4).makeTranslation(0,1.6,0),Xu(this.sittingToStandingMatrix),this.matrix=new THREE.Matrix4,this.orientation=new THREE.Quaternion,Object(ne.a)().then(()=>{this.rayObject=document.querySelector("#player-right-controller").object3D,this.headObject3D=document.querySelector("#avatar-pov-node").object3D}),navigator.getGamepads()}write(e){if(this.rayObject&&this.headObject3D&&(navigator.getGamepads(),this.gamepad.connected)){e.setValueType(Ju.axisX,this.gamepad.axes[0]),e.setValueType(Ju.axisY,this.gamepad.axes[1]),e.setValueType(Ju.pressed,this.gamepad.buttons[0].pressed),e.setValueType(Ju.touched,this.gamepad.buttons[0].touched),e.setValueType(Ju.value,this.gamepad.buttons[0].value),e.setValueType(ep.pressed,this.gamepad.buttons[1].pressed),e.setValueType(ep.touched,this.gamepad.buttons[1].touched),e.setValueType(ep.value,this.gamepad.buttons[1].value),this.rayObject.updateMatrices(),this.rayObject.getWorldQuaternion(this.q),e.setValueType(ce.a.actions.rayObjectRotation,this.q);const t=this.rayObject.matrixWorld;this.rayObjectRotation.setFromRotationMatrix(Ku.extractRotation(this.rayObject.matrixWorld)),this.pose.position.setFromMatrixPosition(t),this.pose.direction.set(0,0,-1).applyQuaternion(this.rayObjectRotation),this.pose.fromOriginAndDirection(this.pose.position,this.pose.direction),e.setPose(ce.a.device.oculusgo.pose,this.pose),this.gamepad.pose.orientation&&e.setMatrix4(ce.a.device.oculusgo.matrix,this.matrix.compose(Yu(this.gamepad.pose,this.gamepad.hand,this.headObject3D,1.6),this.orientation.fromArray(this.gamepad.pose.orientation),Qu).premultiply(this.sittingToStandingMatrix))}}}const ip=new THREE.Vector3(1,1,1),np=ce.a.device.gearVRController.button("touchpad"),ap=ce.a.device.gearVRController.button("trigger"),sp=ce.a.device.gearVRController.axis("touchpadX"),op=ce.a.device.gearVRController.axis("touchpadY"),rp=new THREE.Matrix4;class lp{constructor(e){this.gamepad=e,this.buttonMap=[{name:"touchpad",buttonId:0},{name:"trigger",buttonId:1}],this.axisMap=[{name:"touchpadX",axisId:0},{name:"touchpadY",axisId:1}],this.rayObjectRotation=new THREE.Quaternion,this.selector=`#player-${e.hand}-controller`,this.pose=new zu,this.sittingToStandingMatrix=(new THREE.Matrix4).makeTranslation(0,1.6,0),Xu(this.sittingToStandingMatrix),this.matrix=new THREE.Matrix4,this.orientation=new THREE.Quaternion}write(e){if(navigator.getGamepads(),this.gamepad.connected){const t=this.gamepad.buttons[0];e.setValueType(np.pressed,!!t.pressed),e.setValueType(np.touched,!!t.touched),e.setValueType(np.value,!!t.value);const i=this.gamepad.buttons[1];e.setValueType(ap.pressed,!!i.pressed),e.setValueType(ap.touched,!!i.touched),e.setValueType(ap.value,!!i.value),e.setValueType(sp,this.gamepad.axes[0]),e.setValueType(op,this.gamepad.axes[1]),this.rayObject||(this.rayObject=document.querySelector(this.selector).object3D),this.rayObject.updateMatrixWorld(),this.rayObjectRotation.setFromRotationMatrix(rp.extractRotation(this.rayObject.matrixWorld)),this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld),this.pose.direction.set(0,0,-1).applyQuaternion(this.rayObjectRotation),this.pose.fromOriginAndDirection(this.pose.position,this.pose.direction),e.setPose(ce.a.device.gearVRController.pose,this.pose),this.headObject3D=this.headObject3D||document.querySelector("#avatar-pov-node").object3D,this.gamepad.pose.orientation&&e.setMatrix4(ce.a.device.gearVRController.matrix,this.matrix.compose(Yu(this.gamepad.pose,this.gamepad.hand,this.headObject3D,1.6),this.orientation.fromArray(this.gamepad.pose.orientation),ip).premultiply(this.sittingToStandingMatrix))}}}const cp=new THREE.Vector3(1,1,1),dp=[{name:"thumbStick",buttonId:0},{name:"trigger",buttonId:1},{name:"grip",buttonId:2},{name:"x",buttonId:3},{name:"y",buttonId:4}],hp=[{name:"thumbStick",buttonId:0},{name:"trigger",buttonId:1},{name:"grip",buttonId:2},{name:"a",buttonId:3},{name:"b",buttonId:4}],up=(new THREE.Matrix4).makeTranslation(-.025,-.03,.1),pp=(new THREE.Matrix4).makeTranslation(.025,-.03,.1),mp=new THREE.Matrix4;class gp{constructor(e){this.rayObjectRotation=new THREE.Quaternion,navigator.getVRDisplays();const t={left:dp,right:hp},i={left:ce.a.device.leftOculusTouch,right:ce.a.device.rightOculusTouch};this.gamepad=e,this.pose=new zu,this.buttonMap=t[e.hand],this.axisMap=[{name:"joyX",axisId:0},{name:"joyY",axisId:1}],this.sittingToStandingMatrix=(new THREE.Matrix4).makeTranslation(0,1.6,0),Xu(this.sittingToStandingMatrix),this.matrix=new THREE.Matrix4,this.path=i[e.hand],this.selector=`#player-${e.hand}-controller`,this.position=new THREE.Vector3,this.orientation=new THREE.Quaternion,this.handOffset="left"===this.gamepad.hand?up:pp}write(e){this.gamepad&&(this.gamepad=navigator.getGamepads()[this.gamepad.index],this.gamepad&&this.gamepad.connected&&(this.buttonMap.forEach(t=>{const i=this.path.button(t.name),n=this.gamepad.buttons[t.buttonId];e.setValueType(i.pressed,!!n.pressed),e.setValueType(i.touched,!!n.touched),e.setValueType(i.value,n.value)}),e.setValueType(this.path.axesSum,0),this.axisMap.forEach(t=>{e.setValueType(this.path.axis(t.name),this.gamepad.axes[t.axisId]),e.setValueType(this.path.axesSum,e.get(this.path.axesSum)+Math.abs(this.gamepad.axes[t.axisId]))}),this.rayObject=this.rayObject||document.querySelector(this.selector).object3D,this.rayObject.updateMatrixWorld(),this.rayObjectRotation.setFromRotationMatrix(mp.extractRotation(this.rayObject.matrixWorld)),this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld),this.pose.direction.set(0,0,-1).applyQuaternion(this.rayObjectRotation),this.pose.orientation.copy(this.rayObjectRotation),e.setPose(this.path.pose,this.pose),this.gamepad.pose.position&&this.gamepad.pose.orientation&&e.setMatrix4(this.path.matrix,this.matrix.compose(this.position.fromArray(this.gamepad.pose.position),this.orientation.fromArray(this.gamepad.pose.orientation),cp).premultiply(this.sittingToStandingMatrix).multiply(this.handOffset)),this.gamepad.hapticActuators&&this.gamepad.hapticActuators[0]&&e.setValueType(ce.a.haptics.actuators[this.gamepad.hand],this.gamepad.hapticActuators[0])))}}const fp=new THREE.Vector3(1,1,1),vp=(new THREE.Matrix4).makeTranslation(0,0,-.04),bp=new THREE.Matrix4,yp=ce.a.device.daydream.button("touchpad"),_p=ce.a.device.daydream.axis("touchpadX"),wp=ce.a.device.daydream.axis("touchpadY"),Ep=ce.a.device.daydream.pose,xp=ce.a.device.daydream.matrix;class Sp{constructor(e){this.gamepad=e,this.rayObjectRotation=new THREE.Quaternion,this.selector=`#player-${e.hand||"right"}-controller`,this.pose=new zu,this.sittingToStandingMatrix=(new THREE.Matrix4).makeTranslation(0,1.6,0),Xu(this.sittingToStandingMatrix),this.matrix=new THREE.Matrix4,this.orientation=new THREE.Quaternion}write(e){if(this.gamepad=navigator.getGamepads()[0],this.gamepad&&this.gamepad.connected){const t=this.gamepad.buttons[0];e.setValueType(yp.pressed,!!t.pressed),e.setValueType(yp.touched,!!t.touched),e.setValueType(yp.value,!!t.value),e.setValueType(_p,this.gamepad.axes[0]),e.setValueType(wp,this.gamepad.axes[1]),this.rayObject||(this.rayObject=document.querySelector(this.selector).object3D),this.rayObject.updateMatrixWorld(),this.rayObjectRotation.setFromRotationMatrix(bp.extractRotation(this.rayObject.matrixWorld)),this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld),this.pose.direction.set(0,0,-1).applyQuaternion(this.rayObjectRotation),this.pose.fromOriginAndDirection(this.pose.position,this.pose.direction),e.setPose(Ep,this.pose),this.headObject3D=this.headObject3D||document.querySelector("#avatar-pov-node").object3D,this.gamepad.pose.orientation&&e.setMatrix4(xp,this.matrix.compose(Yu(this.gamepad.pose,this.gamepad.hand,this.headObject3D,1.6),this.orientation.fromArray(this.gamepad.pose.orientation),fp).premultiply(this.sittingToStandingMatrix).multiply(vp))}}}const Cp=new THREE.Vector3(1,1,1),kp=(new THREE.Matrix4).compose(new THREE.Vector3(0,0,.13),(new THREE.Quaternion).setFromEuler(new THREE.Euler(-40*THREE.Math.DEG2RAD,0,0)),new THREE.Vector3(1,1,1)),Ap=new THREE.Quaternion,Tp=new THREE.Matrix4;class Mp{constructor(e){navigator.getVRDisplays(),this.gamepad=e,"OpenVR Cosmos"===this.gamepad.id?(Ap.setFromAxisAngle(new THREE.Vector3(1,0,0),-Math.PI/12),this.buttonMap=[{name:"trigger",buttonId:0},{name:"grip",buttonId:1},{name:"primary",buttonId:2},{name:"secondary",buttonId:3},{name:"joystick",buttonId:4},{name:"bumper",buttonId:5}],this.axisMap=[{name:"joyX",axisId:0},{name:"joyY",axisId:1}]):"HTC Vive Focus Plus Controller"===this.gamepad.id?(Ap.setFromAxisAngle(new THREE.Vector3(1,0,0),Math.PI/15),this.buttonMap=[{name:"touchpad",buttonId:0},{name:"trigger",buttonId:1},{name:"grip",buttonId:2}],this.axisMap=[{name:"touchX",axisId:0},{name:"touchY",axisId:1}]):4===this.gamepad.axes.length?(Ap.setFromAxisAngle(new THREE.Vector3(1,0,0),-Math.PI/12),this.buttonMap=[{name:"touchpad",buttonId:0},{name:"trigger",buttonId:1},{name:"grip",buttonId:2},{name:"primary",buttonId:3},{name:"secondary",buttonId:4},{name:"joystick",buttonId:5},{name:"index",buttonId:6},{name:"middle",buttonId:7},{name:"ring",buttonId:8},{name:"pinky",buttonId:9}],this.axisMap=[{name:"touchX",axisId:0},{name:"touchY",axisId:1},{name:"joyX",axisId:2},{name:"joyY",axisId:3}]):(Ap.setFromAxisAngle(new THREE.Vector3(1,0,0),-Math.PI/12),this.buttonMap=[{name:"touchpad",buttonId:0},{name:"trigger",buttonId:1},{name:"grip",buttonId:2},{name:"primary",buttonId:3}],this.axisMap=[{name:"touchX",axisId:0},{name:"touchY",axisId:1}]),this.pose=new zu,this.rayObjectRotation=new THREE.Quaternion,this.path=ce.a.device.vive[e.hand||"right"],this.sittingToStandingMatrix=(new THREE.Matrix4).makeTranslation(0,1.6,0),Xu(this.sittingToStandingMatrix),this.matrix=new THREE.Matrix4,this.position=new THREE.Vector3,this.orientation=new THREE.Quaternion}write(e){const t=navigator.getGamepads();if(t.length<this.gamepad.index+1)return;if(this.gamepad=t[this.gamepad.index],!this.gamepad.connected)return;if(this.buttonMap.forEach(t=>{const i=this.path.button(t.name),n=this.gamepad.buttons[t.buttonId];e.setValueType(i.pressed,!!n.pressed),e.setValueType(i.touched,!!n.touched),e.setValueType(i.value,n.value)}),e.setValueType(this.path.axesSum,0),this.axisMap.forEach(t=>{e.setValueType(this.path.axis(t.name),this.gamepad.axes[t.axisId]),e.setValueType(this.path.axesSum,e.get(this.path.axesSum)+Math.abs(this.gamepad.axes[t.axisId]))}),!this.selector){if(!this.gamepad.hand)return;this.path=ce.a.device.vive[this.gamepad.hand],this.selector=`#player-${this.gamepad.hand}-controller`,console.warn("gamepad hand eventually specified")}const i=document.querySelector(this.selector).object3D;i.updateMatrixWorld(),this.rayObjectRotation.setFromRotationMatrix(Tp.extractRotation(i.matrixWorld)),this.pose.position.setFromMatrixPosition(i.matrixWorld),this.pose.direction.set(0,0,-1).applyQuaternion(Ap).applyQuaternion(this.rayObjectRotation),this.pose.fromOriginAndDirection(this.pose.position,this.pose.direction),e.setPose(this.path.pose,this.pose),this.gamepad.pose.position&&this.gamepad.pose.orientation&&e.setMatrix4(this.path.matrix,this.matrix.compose(this.position.fromArray(this.gamepad.pose.position),this.orientation.fromArray(this.gamepad.pose.orientation),Cp).premultiply(this.sittingToStandingMatrix).multiply(kp)),this.gamepad.hapticActuators&&this.gamepad.hapticActuators[0]&&e.setValueType(ce.a.haptics.actuators[this.gamepad.hand],this.gamepad.hapticActuators[0])}}const Lp=new THREE.Vector3(1,1,1),Rp=(new THREE.Matrix4).compose(new THREE.Vector3(0,-.017,.13),(new THREE.Quaternion).setFromEuler(new THREE.Euler(-40*THREE.Math.DEG2RAD,0,0)),new THREE.Vector3(1,1,1)),Pp=new THREE.Matrix4;class Dp{constructor(e){this.rayObject=null,this.rayObjectRotation=new THREE.Quaternion,navigator.getVRDisplays(),this.gamepad=e,this.pose=new zu,e.hand&&(this.selector=`#player-${e.hand}-controller`),this.sittingToStandingMatrix=(new THREE.Matrix4).makeTranslation(0,1.6,0),Xu(this.sittingToStandingMatrix),this.matrix=new THREE.Matrix4,this.position=new THREE.Vector3,this.orientation=new THREE.Quaternion}write(e){if(!this.gamepad)return;if(this.gamepad=navigator.getGamepads()[this.gamepad.index],!this.gamepad||!this.gamepad.connected)return;const t=ce.a.device.wmr[this.gamepad.hand||"right"];if(e.setValueType(t.touchpad.pressed,this.gamepad.buttons[0].pressed),e.setValueType(t.touchpad.touched,this.gamepad.buttons[0].touched),e.setValueType(t.touchpad.value,this.gamepad.buttons[0].value),e.setValueType(t.trigger.pressed,this.gamepad.buttons[1].pressed),e.setValueType(t.trigger.touched,this.gamepad.buttons[1].touched),e.setValueType(t.trigger.value,this.gamepad.buttons[1].value),e.setValueType(t.grip.pressed,this.gamepad.buttons[2].pressed),e.setValueType(t.grip.touched,this.gamepad.buttons[2].touched),e.setValueType(t.grip.value,this.gamepad.buttons[2].value),e.setValueType(t.menu.pressed,this.gamepad.buttons[3].pressed),e.setValueType(t.menu.touched,this.gamepad.buttons[3].touched),e.setValueType(t.menu.value,this.gamepad.buttons[3].value),e.setValueType(t.touchpad.axisX,this.gamepad.axes[0]),e.setValueType(t.touchpad.axisY,this.gamepad.axes[1]),e.setValueType(t.joystick.axisX,this.gamepad.axes[2]),e.setValueType(t.joystick.axisY,this.gamepad.axes[3]),!this.selector){if(!this.gamepad.hand)return;this.selector=`#player-${this.gamepad.hand}-controller`}this.rayObject=this.rayObject||document.querySelector(this.selector).object3D,this.rayObject.updateMatrixWorld(),this.rayObjectRotation.setFromRotationMatrix(Pp.extractRotation(this.rayObject.matrixWorld)),this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld),this.pose.direction.set(0,0,-1).applyQuaternion(this.rayObjectRotation),this.pose.fromOriginAndDirection(this.pose.position,this.pose.direction),e.setPose(t.pose,this.pose),this.gamepad.pose.position&&this.gamepad.pose.orientation&&e.setMatrix4(t.matrix,this.matrix.compose(this.position.fromArray(this.gamepad.pose.position),this.orientation.fromArray(this.gamepad.pose.orientation),Lp).premultiply(this.sittingToStandingMatrix).multiply(Rp)),this.gamepad.hapticActuators&&this.gamepad.hapticActuators[0]&&e.setValueType(ce.a.haptics.actuators[this.gamepad.hand],this.gamepad.hapticActuators[0])}}const Op=2*Math.PI;class Hp{constructor(e){this.items=new Array(e).fill(0),this.writePtr=0}push(e){this.items[this.writePtr]=e,this.writePtr=(this.writePtr+1)%this.items.length}}const jp=Math.abs,Ip=(e,t)=>{const i=e-t,n=e+Op-t,a=e-(t+Op);return jp(i)<jp(n)&&jp(i)<jp(a)?i:jp(n)<jp(a)?n:a},Np=e=>{let t=0;for(let i=0;i<e.length;i++){t+=e[i]}return t/e.length};class Fp{constructor(){this.hmdEuler=new THREE.Euler,this.hmdQuaternion=new THREE.Quaternion,this.prevX=this.hmdEuler.x,this.prevY=this.hmdEuler.y,this.dXBuffer=new Hp(6),this.dYBuffer=new Hp(6),this.hasPolyfill=window.webvrpolyfill,this.hasPolyfill&&(this.vrDisplay=window.webvrpolyfill.getPolyfillDisplays()[0],this.frameData=new window.webvrpolyfill.constructor.VRFrameData)}write(e){if(!this.hasPolyfill||!this.vrDisplay||!this.frameData)return;const t=this.hmdEuler;if(this.vrDisplay.getFrameData(this.frameData),null!==this.frameData.pose.orientation&&(this.hmdQuaternion.fromArray(this.frameData.pose.orientation),t.setFromQuaternion(this.hmdQuaternion,"YXZ")),t.x<.475*-Math.PI)return;const i=Ip(t.x,this.prevX),n=Ip(t.y,this.prevY);this.dXBuffer.push(Math.abs(i)<.001?0:i),this.dYBuffer.push(Math.abs(n)<.001?0:n),this.averageDeltaX=Np(this.dXBuffer.items),this.averageDeltaY=Np(this.dYBuffer.items),this.prevX=t.x,this.prevY=t.y,e.setValueType(ce.a.device.gyro.averageDeltaX,this.averageDeltaX),e.setValueType(ce.a.device.gyro.averageDeltaY,this.averageDeltaY)}}function Vp(e){const t=this.el.sceneEl.systems["hubs-systems"].physicsSystem.world;if(t){const i=Ammo.getPointer(e.physicsBody),n=t.collisions.get(i);if(n)for(let e=0;e<n.length;e++){const i=t.object3Ds.get(n[e]);if(Fi(i.el,"isHandCollisionTarget"))return i.el}}return null}const Bp=new Map,zp=new Map;function Up(e){if(!e)return null;if(Bp.get(e))return null;return zp.get(e)||Up(e.parent)}function Wp(e){return Fi(e,"singleActionButton")||Fi(e,"holdableButton")}AFRAME.registerComponent("is-remote-hover-target",{init:function(){zp.set(this.el.object3D,this.el)},remove:function(){zp.delete(this.el.object3D)}}),AFRAME.registerComponent("is-not-remote-hover-target",{init:function(){Bp.set(this.el.object3D,this.el)},remove:function(){Bp.delete(this.el.object3D)}}),AFRAME.registerSystem("interaction",{updateCursorIntersection:function(e,t){return t?(this.leftRemoteHoverTarget=e&&Up(e.object),this.leftRemoteHoverTarget):(this.rightRemoteHoverTarget=e&&Up(e.object),this.rightRemoteHoverTarget)},isHeld(e){return this.state.leftHand.held===e||this.state.rightHand.held===e||this.state.rightRemote.held===e||this.state.leftRemote.held===e},release(e){this.state.leftHand.held===e&&(this.state.leftHand.held=null),this.state.leftHand.hovered===e&&(this.state.leftHand.hovered=null),this.state.leftHand.held===e&&(this.state.leftHand.held=null),this.state.rightHand.hovered===e&&(this.state.rightHand.hovered=null),this.state.rightRemote.held===e&&(this.state.rightRemote.held=null),this.state.rightRemote.hovered===e&&(this.state.rightRemote.hovered=null),this.state.leftRemote.held===e&&(this.state.leftRemote.held=null),this.state.leftRemote.hovered===e&&(this.state.leftRemote.hovered=null)},getRightRemoteHoverTarget(){return this.rightRemoteHoverTarget},getLeftRemoteHoverTarget(){return this.leftRemoteHoverTarget},init:function(){this.options={leftHand:{entity:null,grabPath:ce.a.actions.leftHand.grab,dropPath:ce.a.actions.leftHand.drop,hoverFn:Vp},rightHand:{entity:null,grabPath:ce.a.actions.rightHand.grab,dropPath:ce.a.actions.rightHand.drop,hoverFn:Vp},rightRemote:{entity:null,grabPath:ce.a.actions.cursor.right.grab,dropPath:ce.a.actions.cursor.right.drop,hoverFn:this.getRightRemoteHoverTarget},leftRemote:{entity:null,grabPath:ce.a.actions.cursor.left.grab,dropPath:ce.a.actions.cursor.left.drop,hoverFn:this.getLeftRemoteHoverTarget}},this.state={leftHand:{hovered:null,held:null,spawning:null},rightHand:{hovered:null,held:null,spawning:null},rightRemote:{hovered:null,held:null,spawning:null},leftRemote:{hovered:null,held:null,spawning:null}},this.previousState={leftHand:{hovered:null,held:null,spawning:null},rightHand:{hovered:null,held:null,spawning:null},rightRemote:{hovered:null,held:null,spawning:null},leftRemote:{hovered:null,held:null,spawning:null}},Object(ne.a)().then(()=>{this.options.leftHand.entity=document.getElementById("player-left-controller"),this.options.rightHand.entity=document.getElementById("player-right-controller"),this.options.rightRemote.entity=document.getElementById("right-cursor"),this.options.leftRemote.entity=document.getElementById("left-cursor"),this.ready=!0})},tickInteractor(e,t){const i=AFRAME.scenes[0].systems.userinput;if(t.held){const n=t.held.components.networked,a=n&&n.data&&n.data.owner!==NAF.clientId;(i.get(e.dropPath)||a)&&(t.held=null)}else if(t.hovered=e.hoverFn.call(this,e.entity.components["body-helper"]&&e.entity.components["body-helper"].body?e.entity.components["body-helper"].body:null),t.hovered){const n=t.hovered,a=this.el.is("frozen"),s=n.components.pinnable&&n.components.pinnable.data.pinned;Fi(n,"isHoldable")&&i.get(e.grabPath)&&(a||!s)&&Object(m.c)(n)&&(t.held=n)}},tick2(){this.el.is("entered")&&(Object.assign(this.previousState.rightHand,this.state.rightHand),Object.assign(this.previousState.rightRemote,this.state.rightRemote),Object.assign(this.previousState.leftHand,this.state.leftHand),Object.assign(this.previousState.leftRemote,this.state.leftRemote),this.options.leftHand.entity.object3D.visible&&!this.state.leftRemote.held&&this.tickInteractor(this.options.leftHand,this.state.leftHand),this.options.rightHand.entity.object3D.visible&&!this.state.rightRemote.held&&this.tickInteractor(this.options.rightHand,this.state.rightHand),this.state.rightHand.held||this.state.rightHand.hovered||this.tickInteractor(this.options.rightRemote,this.state.rightRemote),this.state.leftHand.held||this.state.leftHand.hovered||this.tickInteractor(this.options.leftRemote,this.state.leftRemote))}});const Zp=function(e,t,i,n,a){return i.setFromMatrixPosition(e.matrixWorld),n.set(t[0],t[1],.5).unproject(e).sub(i).normalize(),a.fromOriginAndDirection(i,n),a};class Gp{constructor(){this.prevButtonLeft=!1,this.clickedOnAnything=!1,this.cursorPose=new zu,this.prevCursorPose=new zu,this.origin=new THREE.Vector3,this.prevOrigin=new THREE.Vector3,this.direction=new THREE.Vector3,this.prevDirection=new THREE.Vector3}write(e){if(this.prevCursorPose.copy(this.cursorPose),this.prevOrigin.copy(this.origin),this.prevDirection.copy(this.prevDirection),!this.cursorController){const e=document.getElementById("right-cursor-controller");e&&e.components&&(this.cursorController=e.components["cursor-controller"])}if(!this.camera){const e=document.getElementById("viewing-camera");e&&e.components&&(this.camera=e.components.camera.camera)}const t=e.get(ce.a.device.mouse.buttonLeft),i=e.get(ce.a.device.mouse.buttonRight);if(t&&!this.prevButtonLeft&&this.cursorController){const e=[];this.cursorController.raycaster.intersectObjects(AFRAME.scenes[0].systems["hubs-systems"].cursorTargettingSystem.targets,!0,e);const t=e.find(e=>e.object.el),i=t&&Up(t.object),n=AFRAME.scenes[0].systems.userinput,a=t&&t.object.el.matches(".interactable, .interactable *, .occupiable-waypoint-icon, .teleport-waypoint-icon"),s=i&&i.components.pinnable&&i.components.pinnable.data.pinned,o=AFRAME.scenes[0].is("frozen"),r=i&&i.components.networked&&i.components.networked.data.template,l=r&&"#static-controlled-media"===r,c=r&&"#static-media"===r;this.clickedOnAnything=a&&(o||!s)&&i&&Object(m.c)(i)&&!l&&!c||n.activeSets.includes(Gi.rightCursorHoldingPen)||n.activeSets.includes(Gi.rightCursorHoldingInteractable)||n.activeSets.includes(Gi.rightCursorHoldingCamera)}if(this.prevButtonLeft=t,t||(this.clickedOnAnything=!1),!this.clickedOnAnything&&t||i){const t=e.get(ce.a.device.mouse.movementXY);t&&e.setVector2(ce.a.device.smartMouse.cameraDelta,t[0],t[1]),e.setValueType(ce.a.device.smartMouse.shouldMoveCamera,!0)}if(this.camera){const t=e.get(ce.a.device.mouse.coords);e.setPose(ce.a.device.smartMouse.cursorPose,Zp(this.camera,t,this.origin,this.direction,this.cursorPose))}}}function qp(e,t){return void 0!==t.find(t=>t.touch.identifier===e.identifier)}function $p(e,t){return void 0!==t.find(t=>t.job===e)}function Yp(e,t,i){if(qp(e,i)||$p(t,i))return void console.error("cannot reassign touches or jobs. unassign first");const n={job:t,touch:e};return i.push(n),n}function Xp(e,t,i){i.splice(i.findIndex(function(i){return i.touch.identifier===e.identifier&&i.job===t}),1)}function Qp(e,t){return t.find(t=>t.job===e)}function Kp(e,t){return t.find(t=>t.touch.identifier===e.identifier)}const Jp="MOVE CURSOR",em="MOVE CAMERA",tm="FIRST PINCHER",im="SECOND PINCHER",nm=[ce.a.device.touchscreen.tap1,ce.a.device.touchscreen.tap2,ce.a.device.touchscreen.tap3,ce.a.device.touchscreen.tap4,ce.a.device.touchscreen.tap5];function am(e,t,i,n){const a=e-i,s=t-n;return Math.sqrt(a*a+s*s)}const sm=(()=>{let e;return function(){return e||(e=document.getElementById("viewing-camera").components.camera.camera),e}})();class om{constructor(){this.raycaster=new THREE.Raycaster(new THREE.Vector3,new THREE.Vector3,0,100),this.assignments=[],this.pinch={initialDistance:0,currentDistance:0,delta:0},this.pendingTap={maxTouchCount:0,startedAt:0},this.tapIndexToWriteNextFrame=0,this.events=[],["touchstart","touchend","touchmove","touchcancel"].map(e=>document.querySelector("canvas").addEventListener(e,this.events.push.bind(this.events)))}end(e){if(qp(e,this.assignments)){const t=Kp(e,this.assignments);switch(t.job){case Jp:case em:t.framesUntilGrab>=0?t.framesUntilUnassign=t.framesUntilGrab+2:Xp(t.touch,t.job,this.assignments);break;case tm:if(Xp(t.touch,t.job,this.assignments),this.pinch={initialDistance:0,currentDistance:0,delta:0},$p(im,this.assignments)){const e=Qp(im,this.assignments);if(Xp(e.touch,e.job,this.assignments),$p(em,this.assignments)){const t=Yp(e.touch,tm,this.assignments);t.clientX=e.clientX,t.clientY=e.clientY}else{const t=Yp(e.touch,em,this.assignments);t.clientX=e.clientX,t.clientY=e.clientY,t.delta=[0,0]}}break;case im:if(Xp(t.touch,t.job,this.assignments),this.pinch={initialDistance:0,currentDistance:0,delta:0},$p(tm,this.assignments)&&!$p(em,this.assignments)){const e=Qp(tm,this.assignments);Xp(e.touch,e.job,this.assignments);const t=Yp(e.touch,em,this.assignments);t.clientX=e.clientX,t.clientY=e.clientY,t.delta=[0,0]}}}else console.warn("touch does not have a job",e);0===this.assignments.length&&(this.pendingTap.maxTouchCount>0&&performance.now()-this.pendingTap.startedAt<=125&&(this.tapIndexToWriteNextFrame=this.pendingTap.maxTouchCount),this.pendingTap={maxTouchCount:0})}move(e){if(!qp(e,this.assignments))return void(e.target.classList[0]&&e.target.classList[0].startsWith("virtual-gamepad-controls")||console.warn("touch does not have job",e));const t=Kp(e,this.assignments);switch(t.job){case Jp:t.cursorPose.fromCameraProjection(sm(),e.clientX/window.innerWidth*2-1,-e.clientY/window.innerHeight*2+1);break;case em:t.delta[0]+=e.clientX-t.clientX,t.delta[1]+=e.clientY-t.clientY,t.clientX=e.clientX,t.clientY=e.clientY;break;case tm:case im:if(t.clientX=e.clientX,t.clientY=e.clientY,$p(tm,this.assignments)&&$p(im,this.assignments)){const e=Qp(tm,this.assignments),t=Qp(im,this.assignments),i=am(e.clientX,e.clientY,t.clientX,t.clientY);this.pinch.delta+=i-this.pinch.currentDistance,this.pinch.currentDistance=i}}}start(e){if(qp(e,this.assignments))return void console.error("touch already has a job");const t=0===this.assignments.length,i=1===this.assignments.length,n=2===this.assignments.length,a=!!Qp(im,this.assignments);if(t||n&&a){let t;!function(e,t){if(AFRAME.scenes[0].systems.interaction.state.rightRemote.held)return!0;const i=[];t.setFromCamera({x:e.clientX/window.innerWidth*2-1,y:-e.clientY/window.innerHeight*2+1},sm()),t.intersectObjects(AFRAME.scenes[0].systems["hubs-systems"].cursorTargettingSystem.targets,!0,i);const n=i.find(e=>e.object.el),a=n&&n.object.el.matches(".interactable, .interactable *, .occupiable-waypoint-icon, .teleport-waypoint-icon"),s=n&&Up(n.object),o=s&&s.components.pinnable&&s.components.pinnable.data.pinned,r=AFRAME.scenes[0].is("frozen"),l=s&&s.components.networked&&s.components.networked.data.template;return a&&(r||!o)&&!(l&&"#static-controlled-media"===l)&&!(l&&"#static-media"===l)&&s&&Object(m.c)(s)}(e,this.raycaster)?(t=Yp(e,em,this.assignments)).delta=[0,0]:(t=Yp(e,Jp,this.assignments)).framesUntilGrab=2,t.clientX=e.clientX,t.clientY=e.clientY,t.cursorPose=(new zu).fromCameraProjection(sm(),e.clientX/window.innerWidth*2-1,-e.clientY/window.innerHeight*2+1)}else if(i||n){const t=Qp(Jp,this.assignments);if(i&&t&&t.framesUntilGrab<0){const t=Yp(e,tm,this.assignments);t.clientX=e.clientX,t.clientY=e.clientY}else{if(i){const e=this.assignments[0];Xp(e.touch,e.job,this.assignments);const t=Yp(e.touch,tm,this.assignments);t.clientX=e.clientX,t.clientY=e.clientY}const t=Qp(tm,this.assignments);if(!t){const t=Yp(e,tm,this.assignments);return t.clientX=e.clientX,void(t.clientY=e.clientY)}{const i=Yp(e,im,this.assignments);i.clientX=e.clientX,i.clientY=e.clientY;const n=am(t.clientX,t.clientY,i.clientX,i.clientY);this.pinch={initialDistance:n,currentDistance:n,delta:0}}}}0===this.pendingTap.maxTouchCount&&this.assignments.length>0&&(this.pendingTap.startedAt=performance.now()),this.pendingTap.maxTouchCount=Math.max(this.pendingTap.maxTouchCount,this.assignments.length)}process(e){switch(e.type){case"touchstart":for(const t of e.changedTouches)this.start(t);break;case"touchmove":for(const t of e.touches)this.move(t);break;case"touchend":case"touchcancel":for(const t of e.changedTouches)this.end(t)}}write(e){this.pinch&&(this.pinch.delta=0);const t=$p(em,this.assignments)&&Qp(em,this.assignments);for(t&&(t.delta[0]=0,t.delta[1]=0),this.events.forEach(e=>{this.process(e)});this.events.length;)this.events.pop();const i=ce.a.device.touchscreen,n=$p(Jp,this.assignments),a=$p(em,this.assignments);if(n||a){e.setValueType(i.isTouching,!0);const t=Qp(Jp,this.assignments)||Qp(em,this.assignments);e.setPose(i.cursorPose,t.cursorPose)}if(e.setValueType(i.isTouchingGrabbable,!1),n){const t=Qp(Jp,this.assignments);e.setValueType(i.isTouchingGrabbable,t.framesUntilGrab<=0),t.framesUntilGrab--,t.framesUntilUnassign>=0&&(0===t.framesUntilUnassign&&Xp(t.touch,t.job,this.assignments),t.framesUntilUnassign--)}if(a){const t=Qp(em,this.assignments).delta;e.setVector2(i.touchCameraDelta,t[0]/window.innerWidth,t[1]/window.innerHeight)}e.setValueType(i.pinch.delta,this.pinch.delta),e.setValueType(i.pinch.initialDistance,this.pinch.initialDistance),e.setValueType(i.pinch.currentDistance,this.pinch.currentDistance),this.tapIndexToWriteNextFrame&&this.tapIndexToWriteNextFrame<nm.length&&e.setValueType(nm[this.tapIndexToWriteNextFrame-1],!0),this.tapIndexToWriteNextFrame=0,e.setValueType(i.anything,0!==this.assignments.length)}}const rm={noop:function(){},copy:function(e,t,i){e.setValueType(i.value,e.get(t.value))},scale:function(e){return function(t,i,n){void 0!==t.get(i.value)&&t.setValueType(n.value,t.get(i.value)*e)}},scaleExp:function(e,t=1){return function(i,n,a){void 0!==i.get(n.value)&&(1===t?i.setValueType(a.value,i.get(n.value)*e):i.setValueType(a.value,Math.pow(i.get(n.value),t)*e))}},deadzone:function(e){return function(t,i,n){t.setValueType(n.value,Math.abs(t.get(i.value))<e?0:t.get(i.value))}},split_vec2:function(e,t,i){const n=e.get(t.value);void 0!==n&&(e.setValueType(i.x,n[0]),e.setValueType(i.y,n[1]))},compose_vec2:function(e,t,i){const n=e.get(t.x),a=e.get(t.y);void 0!==n&&void 0!==a&&e.setVector2(i.value,n,a)},negate:function(e,t,i){e.setValueType(i.value,-e.get(t.value))},copyIfFalse:function(e,t,i){e.setValueType(i.value,e.get(t.bool)?void 0:e.get(t.value))},copyIfTrue:function(e,t,i){e.setValueType(i.value,e.get(t.bool)?e.get(t.value):void 0)},copyVec2IfTrue:function(e,t,i){if(e.get(t.bool)){const n=e.get(t.value);e.setVector2(i.value,n[0],n[1])}},zeroIfDefined:function(e,t,i){e.setValueType(i.value,void 0!==e.get(t.bool)?0:e.get(t.value))},true:function(e,t,i){e.setValueType(i.value,!0)},rising:function(e,t,i,n){return e.setValueType(i.value,e.get(t.value)&&!1===n),!!e.get(t.value)},risingWithFrameDelay:function(e){return function(t,i,n,a={values:new Array(e)}){return t.setValueType(n.value,a.values.shift()),a.values.push(t.get(i.value)&&!a.prev),a.prev=t.get(i.value),a}},falling:function(e,t,i,n){return e.setValueType(i.value,!e.get(t.value)&&n),!!e.get(t.value)},vec2Zero:function(e,t,i){e.setVector2(i.value,0,0)},poseFromCameraProjection:function(){let e;const t=new zu;return function(i,n,a){e||(e=document.getElementById("viewing-camera").components.camera.camera);const s=i.get(n.value);i.setPose(a.value,t.fromCameraProjection(e,s[0],s[1]))}},vec2dpad:function(e,t=!1,i=!1){const n=e*e;return function(e,a,s){if(!e.get(a.value))return;const[o,r]=e.get(a.value),l=o*o+r*r<n?"center":(c=((c=Math.atan2(t?-o:o,i?-r:r))*THREE.Math.RAD2DEG+180+45)%360)>0&&c<90?"north":c>=90&&c<180?"west":c>=180&&c<270?"south":"east";var c;s[l]&&e.setValueType(s[l],!0)}},always:function(e){return function(t,i,n){t.setValueType(n.value,e)}},wasd_to_vec2:function(e,{w:t,a:i,s:n,d:a},{vec2:s}){let o=0,r=0;e.get(i)&&(o-=1),e.get(a)&&(o+=1),e.get(t)&&(r+=1),e.get(n)&&(r-=1),e.setVector2(s,o,r)},add_vec2:function(e,t,i){const n=e.get(t.first),a=e.get(t.second);n&&a?e.setVector2(i.value,n[0]+a[0],n[1]+a[1]):a?e.setVector2(i.value,a[0],a[1]):n&&e.setVector2(i.value,n[0],n[1])},max_vec2:function(e,t,i){const n=e.get(t.first),a=e.get(t.second);if(n&&a){const t=n[0]*n[0]+n[1]*n[1]>a[0]*a[0]+a[1]*a[1]?n:a;e.setVector2(i.value,t[0],t[1])}else a?e.setVector2(i.value,a[0],a[1]):n&&e.setVector2(i.value,n[0],n[1])},normalize_vec2:function(e,t,i){const n=e.get(t.value);if(n)if(0===n[0]&&0===n[0])e.setVector2(i.value,n[0],n[1]);else{const t=Math.sqrt(n[0]*n[0]+n[1]*n[1]);e.setVector2(i.value,n[0]/t,n[1]/t)}},all:function(e,t,i){for(let n=0,a=t.length;n<a;n++){const a=t[n];if(!e.get(a))return void e.setValueType(i.value,!1)}e.setValueType(i.value,!0)},any:function(e,t,i){for(let n=0,a=t.length;n<a;n++){const a=t[n];if(e.get(a))return void e.setValueType(i.value,!0)}e.setValueType(i.value,!1)},touch_axis_scroll:(e=1,t)=>(function(i,n,a,s={value:0,touching:!1}){return(void 0===t||Math.abs(i.get(n.value)-s.value)>=t)&&i.setValueType(a.value,s.touching&&i.get(n.touching)?e*(i.get(n.value)-s.value):0),s.value=i.get(n.value),s.touching=i.get(n.touching),s}),diff_vec2:function(e,t,i,n=[0,0]){const a=e.get(t.value);return a&&(e.setVector2(i.value,a[0]-n[0],a[1]-n[1]),n[0]=a[0],n[1]=a[1]),n}},lm=e=>{for(const t in e)for(const i of e[t])i.sets||(i.sets=[]),i.sets.push(t);return e},cm="/vars/mouse-and-keyboard/drop_pen_with_p",dm="/vars/mouse-and-keyboard/drop_pen_with_hud",hm=new URLSearchParams(location.search),um=parseFloat(hm.get("izs"))||-10,pm=e=>`/keyboard-mouse-user/keyboard-var/${e}`,mm=lm({[Gi.global]:[{src:{},dest:{value:ce.a.actions.cursor.right.hideLine},xform:rm.always(!0)},{src:{},dest:{value:ce.a.actions.cursor.right.wake},xform:rm.always(!0)},{src:{},dest:{value:ce.a.actions.cursor.left.wake},xform:rm.always(!1)},{src:{w:ce.a.device.keyboard.key("arrowup"),a:ce.a.device.keyboard.key("arrowleft"),s:ce.a.device.keyboard.key("arrowdown"),d:ce.a.device.keyboard.key("arrowright")},dest:{vec2:"/var/mouse-and-keyboard/arrows_vec2"},xform:rm.wasd_to_vec2},{src:{w:ce.a.device.keyboard.key("w"),a:ce.a.device.keyboard.key("a"),s:ce.a.device.keyboard.key("s"),d:ce.a.device.keyboard.key("d")},dest:{vec2:"/var/mouse-and-keyboard/wasd_vec2"},xform:rm.wasd_to_vec2},{src:{first:"/var/mouse-and-keyboard/wasd_vec2",second:"/var/mouse-and-keyboard/arrows_vec2"},dest:{value:"/var/mouse-and-keyboard/keyboardCharacterAcceleration"},xform:rm.max_vec2},{src:{value:"/var/mouse-and-keyboard/keyboardCharacterAcceleration"},dest:{value:ce.a.actions.characterAcceleration},xform:rm.normalize_vec2},{src:{value:ce.a.device.mouse.wheel},dest:{value:ce.a.actions.dCharSpeed},xform:rm.scale(-.3)},{src:{value:ce.a.device.keyboard.key("shift")},dest:{value:ce.a.actions.boost},xform:rm.copy,priority:1},{src:{value:ce.a.device.keyboard.key("Escape")},dest:{value:ce.a.actions.camera.exitMirror},xform:rm.falling},{src:{value:ce.a.device.keyboard.key("q")},dest:{value:ce.a.actions.snapRotateLeft},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("g")},dest:{value:ce.a.actions.toggleFly},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("`")},dest:{value:ce.a.actions.toggleUI},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("e")},dest:{value:ce.a.actions.snapRotateRight},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("Tab")},dest:{value:ce.a.actions.toggleFreeze},xform:rm.rising},{src:{value:ce.a.device.keyboard.key(" ")},dest:{value:ce.a.actions.ensureFrozen},xform:rm.copy},{src:{value:ce.a.device.keyboard.key(" ")},dest:{value:ce.a.actions.thaw},xform:rm.falling},{src:{value:ce.a.device.keyboard.key("p")},dest:{value:cm},xform:rm.rising},{src:{value:ce.a.device.hud.penButton},dest:{value:dm},xform:rm.rising},{src:[dm,cm],dest:{value:"/vars/mouse-and-keyboard/togglePen"},xform:rm.any},{src:{value:"/vars/mouse-and-keyboard/togglePen"},dest:{value:ce.a.actions.spawnPen},xform:rm.rising,priority:100},{src:{value:ce.a.device.keyboard.key("c")},dest:{value:ce.a.actions.toggleCamera},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("x")},dest:{value:ce.a.actions.takeSnapshot},xform:rm.copy},{src:{value:ce.a.device.smartMouse.cursorPose},dest:{value:ce.a.actions.cursor.right.pose},xform:rm.copy},{src:{value:ce.a.device.mouse.coords},dest:{value:"/var/mouseCoordsDelta"},xform:rm.diff_vec2},{src:{value:"/var/mouseCoordsDelta"},dest:{x:"/var/mouseCoordsX",y:"/var/mouseCoordsY"},xform:rm.split_vec2},{src:{value:"/var/mouseCoordsX"},dest:{value:"/var/mouseCoordsXScaled"},xform:rm.scale(-Math.PI)},{src:{value:"/var/mouseCoordsY"},dest:{value:"/var/mouseCoordsYScaled"},xform:rm.scale(2*Math.PI/3)},{src:{x:"/var/mouseCoordsXScaled",y:"/var/mouseCoordsYScaled"},dest:{value:"/var/actions/cameraDelta"},xform:rm.compose_vec2},{src:{value:"/var/actions/cameraDelta",bool:ce.a.device.smartMouse.shouldMoveCamera},dest:{value:ce.a.actions.cameraDelta},xform:rm.copyVec2IfTrue},{src:{value:ce.a.actions.cameraDelta},dest:{value:ce.a.actions.lobbyCameraDelta},xform:rm.copy},{src:{value:ce.a.device.keyboard.key("m")},dest:{value:ce.a.actions.muteMic},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("t")},dest:{value:ce.a.actions.focusChat},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("/")},dest:{value:ce.a.actions.focusChatCommand},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("Escape")},dest:{value:ce.a.actions.mediaExit},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("1")},dest:{value:"/var/shift+1"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+1"},dest:{value:ce.a.actions.mediaSearch1},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("2")},dest:{value:"/var/shift+2"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+2"},dest:{value:ce.a.actions.mediaSearch2},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("3")},dest:{value:"/var/shift+3"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+3"},dest:{value:ce.a.actions.mediaSearch3},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("4")},dest:{value:"/var/shift+4"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+4"},dest:{value:ce.a.actions.mediaSearch4},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("5")},dest:{value:"/var/shift+5"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+5"},dest:{value:ce.a.actions.mediaSearch5},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("6")},dest:{value:"/var/shift+6"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+6"},dest:{value:ce.a.actions.mediaSearch6},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("7")},dest:{value:"/var/shift+7"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+7"},dest:{value:ce.a.actions.mediaSearch7},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("8")},dest:{value:"/var/shift+8"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+8"},dest:{value:ce.a.actions.mediaSearch8},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("l")},dest:{value:ce.a.actions.logDebugFrame},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("k")},dest:{value:ce.a.actions.logInteractionState},xform:rm.rising},{src:{value:ce.a.device.mouse.buttonRight},dest:{value:ce.a.actions.startGazeTeleport},xform:rm.rising,priority:100},{src:{value:ce.a.device.mouse.buttonRight},dest:{value:ce.a.actions.stopGazeTeleport},xform:rm.falling,priority:100},{src:{value:ce.a.device.keyboard.key("o")},dest:{value:ce.a.actions.nextCameraMode},xform:rm.rising}],[Gi.rightCursorHoldingPen]:[{src:{bool:ce.a.device.keyboard.key("shift"),value:ce.a.device.keyboard.key("q")},dest:{value:"/var/shift+q"},xform:rm.copyIfTrue,priority:1},{src:{value:"/var/shift+q"},dest:{value:ce.a.actions.cursor.right.penPrevColor},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("shift"),value:ce.a.device.keyboard.key("e")},dest:{value:"/var/shift+e"},xform:rm.copyIfTrue,priority:1},{src:{value:"/var/shift+e"},dest:{value:ce.a.actions.cursor.right.penNextColor},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("shift"),value:ce.a.device.keyboard.key("q")},dest:{value:"/var/notshift+q"},xform:rm.copyIfFalse,priority:1},{src:{value:"/var/notshift+q"},dest:{value:ce.a.actions.snapRotateLeft},xform:rm.rising,priority:200},{src:{bool:ce.a.device.keyboard.key("shift"),value:ce.a.device.keyboard.key("e")},dest:{value:"/var/notshift+e"},xform:rm.copyIfFalse,priority:1},{src:{value:"/var/notshift+e"},dest:{value:ce.a.actions.snapRotateRight},xform:rm.rising,priority:200},{src:{value:ce.a.device.mouse.buttonLeft},dest:{value:ce.a.actions.cursor.right.startDrawing},xform:rm.rising,priority:3},{src:{value:ce.a.device.mouse.buttonLeft},dest:{value:ce.a.actions.cursor.right.stopDrawing},xform:rm.falling,priority:3},{src:{value:pm("wheelWithShift")},dest:{value:"/var/cursorScalePenTipWheel"},xform:rm.copy,priority:200},{src:{value:"/var/cursorScalePenTipWheel"},dest:{value:ce.a.actions.cursor.right.scalePenTip},xform:rm.scale(.03)},{src:{value:ce.a.device.mouse.buttonRight},dest:{value:"/vars/mouse-and-keyboard/drop_pen_with_RMB"},xform:rm.falling,priority:200},{src:{value:ce.a.device.keyboard.key("Escape")},dest:{value:"/vars/mouse-and-keyboard/drop_pen_with_esc"},xform:rm.rising},{src:["/vars/mouse-and-keyboard/drop_pen_with_RMB","/vars/mouse-and-keyboard/drop_pen_with_esc",cm,dm],dest:{value:"/vars/mouse-and-keyboard/togglePen"},xform:rm.any},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("z")},dest:{value:ce.a.actions.cursor.right.undoDrawing},priority:1001,xform:rm.rising},{src:{value:"/vars/mouse-and-keyboard/togglePen"},dest:{value:ce.a.actions.cursor.right.drop},xform:rm.rising,priority:200},{src:{value:"/vars/mouse-and-keyboard/togglePen"},dest:{value:ce.a.actions.pen.remove},xform:rm.rising,priority:200}],[Gi.rightCursorHoldingCamera]:[{src:{value:ce.a.device.mouse.buttonLeft},dest:{value:ce.a.actions.cursor.right.drop},xform:rm.falling,priority:2},{src:{value:pm("wheelWithShift")},dest:{value:ce.a.actions.cursor.right.scaleGrabbedGrabbable},xform:rm.noop,priority:2}],[Gi.rightCursorHoldingInteractable]:[{src:{bool:ce.a.device.keyboard.key("shift"),value:ce.a.device.mouse.wheel},dest:{value:pm("wheelWithShift")},xform:rm.copyIfTrue,priority:1},{src:{bool:ce.a.device.keyboard.key("shift"),value:ce.a.device.mouse.wheel},dest:{value:pm("wheelWithoutShift")},xform:rm.copyIfFalse,priority:1},{src:{value:pm("wheelWithoutShift")},dest:{value:ce.a.actions.cursor.right.modDelta},xform:rm.copy},{src:{value:pm("wheelWithShift")},dest:{value:ce.a.actions.cursor.right.scaleGrabbedGrabbable},xform:rm.copy},{src:{value:ce.a.device.mouse.buttonLeft},dest:{value:ce.a.actions.cursor.right.drop},xform:rm.falling,priority:2}],[Gi.rightCursorHoldingUI]:[{src:{value:ce.a.device.mouse.buttonLeft},dest:{value:ce.a.actions.cursor.right.drop},xform:rm.falling,priority:3},{src:{value:ce.a.device.keyboard.key("shift")},dest:{value:ce.a.actions.transformModifier},xform:rm.copy,priority:1}],[Gi.rightCursorHoveringOnInteractable]:[{src:{value:ce.a.device.mouse.buttonLeft},dest:{value:ce.a.actions.cursor.right.grab},xform:rm.rising,priority:1},{src:{value:ce.a.device.mouse.buttonRight},dest:{value:"/vars/mouse-and-keyboard/startInspectingViaMouse"},xform:rm.rising,priority:200},{src:{value:ce.a.device.keyboard.key("f")},dest:{value:"/vars/mouse-and-keyboard/startInspectingViaKeyboard"},xform:rm.rising,priority:200},{src:["/vars/mouse-and-keyboard/startInspectingViaMouse","/vars/mouse-and-keyboard/startInspectingViaKeyboard"],dest:{value:ce.a.actions.startInspecting},xform:rm.any,priority:201}],[Gi.rightCursorHoveringOnVideo]:[{src:{value:ce.a.device.mouse.wheel},dest:{value:ce.a.actions.cursor.right.mediaVolumeMod},xform:rm.scale(-.3),priority:1}],[Gi.inputFocused]:[{src:{value:"/device/keyboard"},dest:{value:ce.a.noop},xform:rm.noop,priority:1e3}],[Gi.rightCursorHoveringOnUI]:[{src:{value:ce.a.device.mouse.buttonLeft},dest:{value:ce.a.actions.cursor.right.grab},xform:rm.rising}],[Gi.inspecting]:[{src:{value:ce.a.device.keyboard.key("space")},dest:{value:pm("space-rising")},xform:rm.rising},{src:[ce.a.device.keyboard.key("w"),ce.a.device.keyboard.key("a"),ce.a.device.keyboard.key("s"),ce.a.device.keyboard.key("d"),ce.a.device.keyboard.key("q"),ce.a.device.keyboard.key("e"),pm("space-rising")],dest:{value:"/vars/mouse-and-keyboard/stopInspectingViaKeyboardEscape"},xform:rm.any},{src:{value:ce.a.device.mouse.wheel},dest:{value:ce.a.actions.inspectZoom},xform:rm.scale(um),priority:1},{src:{value:ce.a.device.mouse.movementXY},dest:{x:"/var/movementX",y:"/var/movementY"},xform:rm.split_vec2},{src:{bool:ce.a.device.mouse.buttonMiddle,value:"/var/movementY"},dest:{value:"/var/middle-mouse-move-y"},xform:rm.copyIfTrue},{src:{value:"/var/middle-mouse-move-y"},dest:{value:ce.a.actions.inspectPanY},xform:rm.scale(.001)},{src:{value:ce.a.device.keyboard.key("f")},dest:{value:"/vars/mouse-and-keyboard/stopInspectingViaKeyboardFocusRelease"},xform:rm.falling},{src:{value:ce.a.device.mouse.buttonRight},dest:{value:"/vars/mouse-and-keyboard/stopInspectingViaMouse"},xform:rm.falling,priority:101},{src:["/vars/mouse-and-keyboard/stopInspectingViaMouse","/vars/mouse-and-keyboard/stopInspectingViaKeyboardEscape","/vars/mouse-and-keyboard/stopInspectingViaKeyboardFocusRelease"],dest:{value:ce.a.actions.stopInspecting},xform:rm.any}],[Gi.debugUserInput]:[{src:{value:ce.a.device.keyboard.key("m")},dest:{value:ce.a.actions.debugUserInput.describeCurrentMasks},xform:rm.rising,priority:10}]}),gm="vars/touchscreen/touchCameraDelta",fm=lm({[Gi.global]:[{src:{},dest:{value:ce.a.actions.cursor.right.hideLine},xform:rm.always(!0)},{src:{value:ce.a.device.touchscreen.pinch.delta},dest:{value:"/vars/touchscreen/pinchDeltaForward"},xform:rm.scale(.25)},{src:{value:ce.a.device.touchscreen.tap2},dest:{value:ce.a.actions.toggleFreeze},xform:rm.copy},{src:{},dest:{value:"/vars/touchscreen/zero"},xform:rm.always(0)},{src:{x:"/vars/touchscreen/zero",y:"/vars/touchscreen/pinchDeltaForward"},dest:{value:ce.a.actions.characterAcceleration},xform:rm.compose_vec2},{src:{value:ce.a.device.touchscreen.cursorPose},dest:{value:ce.a.actions.cursor.right.pose},xform:rm.copy},{src:{value:ce.a.device.touchscreen.touchCameraDelta},dest:{x:"vars/touchscreen/touchCameraDelta/x",y:"vars/touchscreen/touchCameraDelta/y"},xform:rm.split_vec2},{src:{value:"vars/touchscreen/touchCameraDelta/x"},dest:{value:"vars/touchscreen/touchCameraDelta/x/scaled"},xform:rm.scale(Math.PI)},{src:{value:"vars/touchscreen/touchCameraDelta/y"},dest:{value:"vars/touchscreen/touchCameraDelta/y/scaled"},xform:rm.scale(Math.PI/2)},{src:{x:"vars/touchscreen/touchCameraDelta/x/scaled",y:"vars/touchscreen/touchCameraDelta/y/scaled"},dest:{value:gm},xform:rm.compose_vec2},{src:{value:ce.a.device.gyro.averageDeltaX},dest:{value:"vars/gyro/gyroCameraDelta/x/scaled"},xform:rm.scale(1)},{src:{value:ce.a.device.gyro.averageDeltaY},dest:{value:"vars/gyro/gyroCameraDelta/y/scaled"},xform:rm.scale(1)},{src:{x:"vars/gyro/gyroCameraDelta/y/scaled",y:"vars/gyro/gyroCameraDelta/x/scaled"},dest:{value:"vars/gyro/gyroCameraDelta"},xform:rm.compose_vec2},{src:{first:gm,second:"vars/gyro/gyroCameraDelta"},dest:{value:ce.a.actions.cameraDelta},xform:rm.add_vec2},{src:{value:gm},dest:{value:ce.a.actions.lobbyCameraDelta},xform:rm.copy},{src:{value:ce.a.device.touchscreen.isTouchingGrabbable},dest:{value:ce.a.actions.cursor.right.grab},xform:rm.rising},{src:{value:ce.a.device.hud.penButton},dest:{value:"/vars/touchscreen/togglePen"},xform:rm.rising},{src:{value:"/vars/touchscreen/togglePen"},dest:{value:ce.a.actions.spawnPen},xform:rm.rising,priority:2}],[Gi.rightCursorHoldingInteractable]:[{src:{value:ce.a.device.touchscreen.isTouchingGrabbable},dest:{value:ce.a.actions.cursor.right.drop},xform:rm.falling,priority:1}],[Gi.rightCursorHoveringOnPen]:[],[Gi.rightCursorHoldingPen]:[{src:{value:ce.a.device.touchscreen.isTouchingGrabbable},dest:{value:ce.a.actions.cursor.right.startDrawing},xform:rm.risingWithFrameDelay(5),priority:2},{src:{value:ce.a.device.touchscreen.isTouchingGrabbable},dest:{value:ce.a.actions.cursor.right.stopDrawing},xform:rm.falling,priority:2},{src:{value:"/vars/touchscreen/togglePen"},dest:{value:ce.a.actions.cursor.right.drop},xform:rm.rising,priority:3},{src:{value:"/vars/touchscreen/togglePen"},dest:{value:ce.a.actions.pen.remove},xform:rm.rising,priority:3}],[Gi.inspecting]:[{src:{value:ce.a.device.touchscreen.anything},dest:{value:ce.a.actions.stopInspecting},xform:rm.rising},{src:{value:ce.a.device.touchscreen.pinch.delta},dest:{value:ce.a.actions.inspectZoom},xform:rm.scale(.025),priority:1}]}),vm=lm({[Gi.global]:[{src:{value:ce.a.device.keyboard.key("l")},dest:{value:ce.a.actions.logDebugFrame},xform:rm.rising}]}),bm=ce.a.device.leftOculusTouch.button,ym=ce.a.device.leftOculusTouch.axis,_m=ce.a.device.leftOculusTouch.pose,wm=ce.a.device.rightOculusTouch.button,Em=ce.a.device.rightOculusTouch.axis,xm=ce.a.device.rightOculusTouch.pose,Sm="/touch/var/right/grip/RisingGrab",Cm="/touch/var/left/grip/RisingGrab",km="/touch/var/buttons/lower",Am="/touch/var/buttons/upper",Tm=e=>"/oculus-touch-user-vars/"+e,Mm=Tm("leftGripPressed1"),Lm=Tm("leftGripPressed2"),Rm=Tm("rightGripPressed1"),Pm=Tm("rightGripPressed2"),Dm=Tm("leftTriggerPressed1"),Om=Tm("leftTriggerPressed2"),Hm=Tm("rightTriggerPressed1"),jm=Tm("rightTriggerPressed2"),Im=lm({[Gi.global]:[{src:{value:ce.a.device.leftOculusTouch.matrix},dest:{value:ce.a.actions.leftHand.matrix},xform:rm.copy},{src:{value:ce.a.device.rightOculusTouch.matrix},dest:{value:ce.a.actions.rightHand.matrix},xform:rm.copy},{src:["/touch/var/buttons/ensureFrozen","/touch/var/keyboard/ensureFrozen"],dest:{value:ce.a.actions.ensureFrozen},xform:rm.any},{src:["/touch/var/buttons/thaw","/touch/var/keyboard/thaw"],dest:{value:ce.a.actions.thaw},xform:rm.any},{src:{value:bm("grip").pressed},dest:{value:Mm},xform:rm.copy},{src:{value:bm("grip").pressed},dest:{value:Lm},xform:rm.copy},{src:{value:Mm},dest:{value:ce.a.actions.leftHand.middleRingPinky},xform:rm.copy},{src:[bm("x").touched,bm("y").touched,bm("thumbStick").touched],dest:{value:ce.a.actions.leftHand.thumb},xform:rm.any},{src:{value:bm("trigger").pressed},dest:{value:Dm},xform:rm.copy},{src:{value:bm("trigger").pressed},dest:{value:Om},xform:rm.copy},{src:{value:Dm},dest:{value:ce.a.actions.leftHand.index},xform:rm.copy},{src:{value:wm("grip").pressed},dest:{value:Rm},xform:rm.copy},{src:{value:wm("grip").pressed},dest:{value:Pm},xform:rm.copy},{src:{value:Rm},dest:{value:ce.a.actions.rightHand.middleRingPinky},xform:rm.copy},{src:[wm("a").touched,wm("b").touched,wm("thumbStick").touched],dest:{value:ce.a.actions.rightHand.thumb},xform:rm.any},{src:{value:wm("trigger").pressed},dest:{value:Hm},xform:rm.copy},{src:{value:wm("trigger").pressed},dest:{value:jm},xform:rm.copy},{src:{value:Hm},dest:{value:ce.a.actions.rightHand.index},xform:rm.copy},{src:{x:ym("joyX"),y:ym("joyY")},dest:{value:"/touch/var/left/joy"},xform:rm.compose_vec2},{src:{value:"/touch/var/left/joy"},dest:{north:"/touch/var/leftDpad/north",south:"/touch/var/leftDpad/south",east:"/touch/var/leftDpad/east",west:"/touch/var/leftDpad/west",center:"/touch/var/leftDpad/center"},xform:rm.vec2dpad(.2,!1,!0)},{src:{value:Em("joyY")},dest:{value:"/touch/var/right/joyY1"},xform:rm.copy},{src:{value:Em("joyY")},dest:{value:"/touch/var/right/joyY2"},xform:rm.copy},{src:{x:Em("joyX"),y:"/touch/var/right/joyY1"},dest:{value:"/touch/var/right/joy"},xform:rm.compose_vec2},{src:{value:"/touch/var/right/joy"},dest:{north:"/touch/var/rightDpad/north",south:"/touch/var/rightDpad/south",east:"/touch/var/rightDpad/east",west:"/touch/var/rightDpad/west",center:"/touch/var/rightDpad/center"},xform:rm.vec2dpad(.2,!1,!0)},{src:{value:"/touch/var/rightDpad/east"},dest:{value:"/touch/var//right/snap-right"},xform:rm.rising,priority:1},{src:{value:ce.a.device.keyboard.key("e")},dest:{value:"/touch/var//keyboard/snap-right"},xform:rm.rising},{src:["/touch/var//right/snap-right","/touch/var//keyboard/snap-right"],dest:{value:ce.a.actions.snapRotateRight},xform:rm.any},{src:{value:ce.a.device.keyboard.key("Tab")},dest:{value:ce.a.actions.toggleFreeze},xform:rm.rising},{src:{value:ce.a.device.keyboard.key(" ")},dest:{value:"/touch/var/keyboard/ensureFrozen"},xform:rm.copy},{src:[bm("x").pressed,wm("a").pressed],dest:{value:km},xform:rm.any},{src:[bm("y").pressed,wm("b").pressed],dest:{value:Am},xform:rm.any},{src:{value:km},dest:{value:"/touch/var/buttons/ensureFrozen"},xform:rm.copy},{src:{value:km},dest:{value:"/touch/var/buttons/thaw"},xform:rm.falling},{src:{value:ce.a.device.keyboard.key(" ")},dest:{value:"/touch/var/keyboard/thaw"},xform:rm.falling},{src:{value:"/touch/var/rightDpad/west"},dest:{value:"/touch/var//right/snap-left"},xform:rm.rising,priority:1},{src:{value:ce.a.device.keyboard.key("q")},dest:{value:"/touch/var//keyboard/snap-left"},xform:rm.rising},{src:["/touch/var//right/snap-left","/touch/var//keyboard/snap-left"],dest:{value:ce.a.actions.snapRotateLeft},xform:rm.any},{src:{value:ym("joyY")},dest:{value:"/touch/var/left/joy/y/deadzoned"},xform:rm.deadzone(.1)},{src:{value:"/touch/var/left/joy/y/deadzoned"},dest:{value:"/touch/var/left/scaledJoyY"},xform:rm.scale(-1.5)},{src:{value:ym("joyX")},dest:{value:"/touch/var/left/joy/x/deadzoned"},xform:rm.deadzone(.1)},{src:{value:"/touch/var/left/joy/x/deadzoned"},dest:{value:"/touch/var/left/scaledJoyX"},xform:rm.scale(1.5)},{src:{x:"/touch/var/left/scaledJoyX",y:"/touch/var/left/scaledJoyY"},dest:{value:"/touch/var/characterAcceleration"},xform:rm.compose_vec2},{src:{w:ce.a.device.keyboard.key("arrowup"),a:ce.a.device.keyboard.key("arrowleft"),s:ce.a.device.keyboard.key("arrowdown"),d:ce.a.device.keyboard.key("arrowright")},dest:{vec2:"/var/keyboard/arrows_vec2"},xform:rm.wasd_to_vec2},{src:{w:ce.a.device.keyboard.key("w"),a:ce.a.device.keyboard.key("a"),s:ce.a.device.keyboard.key("s"),d:ce.a.device.keyboard.key("d")},dest:{vec2:"/var/keyboard/wasd_vec2"},xform:rm.wasd_to_vec2},{src:{first:"/var/keyboard/wasd_vec2",second:"/var/keyboard/arrows_vec2"},dest:{value:"/var/keyboard/characterAcceleration"},xform:rm.max_vec2},{src:{first:"/touch/var/characterAcceleration",second:"/var/keyboard/characterAcceleration"},dest:{value:"/var/oculus-touch/nonNormalizedCharacterAcceleration"},xform:rm.max_vec2},{src:{value:"/var/oculus-touch/nonNormalizedCharacterAcceleration",override:"/device/overrides/foo"},dest:{value:ce.a.actions.characterAcceleration},xform:rm.copy},{src:{value:ce.a.device.keyboard.key("shift")},dest:{value:"/var/keyboard-oculus/boost"},xform:rm.copy},{src:{value:bm("y").pressed},dest:{value:"/var/left-oculus/boost"},xform:rm.copy},{src:{value:wm("b").pressed},dest:{value:"/var/right-oculus/boost"},xform:rm.copy},{src:{value:bm("thumbStick").pressed},dest:{value:ce.a.actions.nextCameraMode},xform:rm.rising},{src:{value:wm("thumbStick").pressed},dest:{value:ce.a.actions.toggleFly},xform:rm.rising},{src:["/var/keyboard-oculus/boost","/var/left-oculus/boost","/var/right-oculus/boost"],dest:{value:ce.a.actions.boost},xform:rm.any},{src:{value:ce.a.device.keyboard.key("t")},dest:{value:ce.a.actions.focusChat},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("/")},dest:{value:ce.a.actions.focusChatCommand},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("Escape")},dest:{value:ce.a.actions.mediaExit},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("p")},dest:{value:ce.a.actions.spawnPen},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("c")},dest:{value:ce.a.actions.toggleCamera},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("x")},dest:{value:ce.a.actions.takeSnapshot},xform:rm.copy},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("1")},dest:{value:"/var/shift+1"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+1"},dest:{value:ce.a.actions.mediaSearch1},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("2")},dest:{value:"/var/shift+2"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+2"},dest:{value:ce.a.actions.mediaSearch2},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("3")},dest:{value:"/var/shift+3"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+3"},dest:{value:ce.a.actions.mediaSearch3},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("4")},dest:{value:"/var/shift+4"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+4"},dest:{value:ce.a.actions.mediaSearch4},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("5")},dest:{value:"/var/shift+5"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+5"},dest:{value:ce.a.actions.mediaSearch5},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("6")},dest:{value:"/var/shift+6"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+6"},dest:{value:ce.a.actions.mediaSearch6},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("7")},dest:{value:"/var/shift+7"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+7"},dest:{value:ce.a.actions.mediaSearch7},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("8")},dest:{value:"/var/shift+8"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+8"},dest:{value:ce.a.actions.mediaSearch8},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("l")},dest:{value:ce.a.actions.logDebugFrame},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("k")},dest:{value:ce.a.actions.logInteractionState},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("m")},dest:{value:ce.a.actions.muteMic},xform:rm.rising},{src:{value:_m},dest:{value:ce.a.actions.cursor.left.pose},xform:rm.copy},{src:{value:xm},dest:{value:ce.a.actions.cursor.right.pose},xform:rm.copy},{src:{value:xm},dest:{value:ce.a.actions.rightHand.pose},xform:rm.copy},{src:{value:_m},dest:{value:ce.a.actions.leftHand.pose},xform:rm.copy},{src:{value:jm},dest:{value:ce.a.actions.rightHand.stopTeleport},xform:rm.falling,priority:1},{src:{value:Om},dest:{value:ce.a.actions.leftHand.stopTeleport},xform:rm.falling,priority:1},{src:[bm("y").pressed,bm("x").pressed,bm("trigger").pressed,bm("grip").pressed],dest:{value:"/touch/var/left/wake"},xform:rm.any},{src:{value:"/touch/var/left/wake"},dest:{value:ce.a.actions.cursor.left.wake},xform:rm.rising},{src:[wm("b").pressed,wm("a").pressed,wm("trigger").pressed,wm("grip").pressed],dest:{value:"/touch/var/right/wake"},xform:rm.any},{src:{value:"/touch/var/right/wake"},dest:{value:ce.a.actions.cursor.right.wake},xform:rm.rising}],[Gi.leftHandHoveringOnNothing]:[{src:{value:Om},dest:{value:ce.a.actions.leftHand.startTeleport},xform:rm.rising,priority:1}],[Gi.rightCursorHoveringOnUI]:[{src:{value:jm},dest:{value:ce.a.actions.cursor.right.grab},xform:rm.rising,priority:2}],[Gi.leftCursorHoveringOnUI]:[{src:{value:Om},dest:{value:ce.a.actions.cursor.left.grab},xform:rm.rising,priority:2}],[Gi.rightCursorHoveringOnVideo]:[{src:{value:Em("joyY")},dest:{value:ce.a.actions.cursor.right.mediaVolumeMod},xform:rm.scale(-.01)}],[Gi.leftCursorHoveringOnVideo]:[{src:{value:ym("joyY")},dest:{value:ce.a.actions.cursor.left.mediaVolumeMod},xform:rm.scale(-.01)}],[Gi.rightCursorHoveringOnNothing]:[{src:{value:jm},dest:{value:ce.a.actions.rightHand.startTeleport},xform:rm.rising,priority:1}],[Gi.leftCursorHoveringOnNothing]:[{src:{value:Om},dest:{value:ce.a.actions.leftHand.startTeleport},xform:rm.rising,priority:1}],[Gi.leftHandHoveringOnInteractable]:[{src:{value:Lm},dest:{value:Cm},xform:rm.rising},{src:{value:Om},dest:{value:"/touch/var/left/trigger/RisingGrab"},xform:rm.rising,priority:2},{src:[Cm],dest:{value:ce.a.actions.leftHand.grab},xform:rm.any,priority:2}],[Gi.inspecting]:[{src:{value:Am},dest:{value:ce.a.actions.stopInspecting},xform:rm.falling}],[Gi.leftHandHoldingInteractable]:[{src:{value:Lm},dest:{value:ce.a.actions.leftHand.drop},xform:rm.falling}],[Gi.leftHandHoveringOnPen]:[],[Gi.leftHandHoldingPen]:[{src:{value:Om},dest:{value:ce.a.actions.leftHand.startDrawing},xform:rm.rising,priority:3},{src:{value:Om},dest:{value:ce.a.actions.leftHand.stopDrawing},xform:rm.falling,priority:3},{src:{value:"/touch/var/leftDpad/east",override:"/device/overrides/foo"},dest:{value:ce.a.actions.leftHand.penNextColor},xform:rm.rising,priority:2},{src:{value:"/touch/var/leftDpad/west",override:"/device/overrides/foo"},dest:{value:ce.a.actions.leftHand.penPrevColor},xform:rm.rising,priority:2},{src:{value:"/touch/var/left/joy/y/deadzoned"},dest:{value:ce.a.actions.leftHand.scalePenTip},xform:rm.scaleExp(-.005,5),priority:1},{src:{value:bm("y").pressed},dest:{value:ce.a.actions.leftHand.switchDrawMode},xform:rm.rising,priority:1},{src:{value:bm("x").pressed},dest:{value:ce.a.actions.leftHand.undoDrawing},xform:rm.rising,priority:1}],[Gi.rightCursorHoveringOnInteractable]:[{src:{value:Pm},dest:{value:Sm},xform:rm.rising,priority:2},{src:{value:jm},dest:{value:"/touch/var/right/trigger/RisingGrab"},xform:rm.rising,priority:2},{src:[Sm],dest:{value:ce.a.actions.cursor.right.grab},xform:rm.any,priority:2},{src:{value:Am},dest:{value:ce.a.actions.startInspecting},xform:rm.rising}],[Gi.leftCursorHoveringOnInteractable]:[{src:{value:Lm},dest:{value:Cm},xform:rm.rising,priority:2},{src:{value:Om},dest:{value:"/touch/var/left/trigger/RisingGrab"},xform:rm.rising,priority:2},{src:[Cm],dest:{value:ce.a.actions.cursor.left.grab},xform:rm.any,priority:2},{src:{value:Am},dest:{value:ce.a.actions.startInspecting},xform:rm.rising}],[Gi.rightCursorHoldingUI]:[{src:{value:jm},dest:{value:"/touch/var/right/cursorDrop2"},xform:rm.falling,priority:5}],[Gi.leftCursorHoldingUI]:[{src:{value:Om},dest:{value:"/touch/var/left/cursorDrop2"},xform:rm.falling,priority:5}],[Gi.rightCursorHoldingInteractable]:[{src:{value:Em("joyY")},dest:{value:ce.a.actions.cursor.right.modDelta},xform:rm.scale(.1)},{src:{value:Pm},dest:{value:"/touch/var/right/cursorDrop1"},xform:rm.falling,priority:3},{src:["/touch/var/right/cursorDrop1","/touch/var/right/cursorDrop2"],dest:{value:ce.a.actions.cursor.right.drop},xform:rm.any,priority:2}],[Gi.leftCursorHoldingInteractable]:[{src:{value:ym("joyY")},dest:{value:ce.a.actions.cursor.left.modDelta},xform:rm.scale(.1)},{src:{value:Lm},dest:{value:"/touch/var/left/cursorDrop1"},xform:rm.falling,priority:3},{src:["/touch/var/left/cursorDrop1","/touch/var/left/cursorDrop2"],dest:{value:ce.a.actions.cursor.left.drop},xform:rm.any,priority:2}],[Gi.rightCursorHoveringOnPen]:[],[Gi.rightCursorHoldingPen]:[{src:{value:jm},dest:{value:ce.a.actions.cursor.right.startDrawing},xform:rm.rising,priority:3},{src:{value:jm},dest:{value:ce.a.actions.cursor.right.stopDrawing},xform:rm.falling,priority:3},{src:{value:wm("b").pressed},dest:{value:ce.a.actions.cursor.right.undoDrawing},xform:rm.rising,priority:1}],[Gi.leftCursorHoldingPen]:[{src:{value:Om},dest:{value:ce.a.actions.cursor.left.startDrawing},xform:rm.rising,priority:3},{src:{value:Om},dest:{value:ce.a.actions.cursor.left.stopDrawing},xform:rm.falling,priority:3},{src:{value:bm("y").pressed},dest:{value:ce.a.actions.cursor.left.undoDrawing},xform:rm.rising,priority:1}],[Gi.rightHandHoveringOnInteractable]:[{src:{value:Pm},dest:{value:Sm},xform:rm.rising,priority:2},{src:{value:jm},dest:{value:"/touch/var/right/trigger/RisingGrab"},xform:rm.rising,priority:2},{src:[Sm],dest:{value:ce.a.actions.rightHand.grab},xform:rm.any,priority:2}],[Gi.rightHandHoldingInteractable]:[{src:{value:Pm},dest:{value:"/touch/var/right/rightHandDrop2"},xform:rm.falling,priority:3},{src:["/touch/var/right/rightHandDrop2"],dest:{value:ce.a.actions.rightHand.drop},xform:rm.any,priority:2}],[Gi.rightHandHoveringOnPen]:[],[Gi.rightHandHoldingPen]:[{src:{value:jm},dest:{value:ce.a.actions.rightHand.startDrawing},xform:rm.rising,priority:3},{src:{value:jm},dest:{value:ce.a.actions.rightHand.stopDrawing},xform:rm.falling,priority:3},{src:{value:"/touch/var/rightDpad/east"},dest:{value:ce.a.actions.rightHand.penNextColor},xform:rm.rising,priority:2},{src:{value:"/touch/var/rightDpad/west"},dest:{value:ce.a.actions.rightHand.penPrevColor},xform:rm.rising,priority:2},{src:{value:Em("joyY")},dest:{value:"/touch/var/right/joy/y/deadzoned"},xform:rm.deadzone(.1)},{src:{value:"/touch/var/right/joy/y/deadzoned"},dest:{value:ce.a.actions.rightHand.scalePenTip},xform:rm.scaleExp(-.005,5),priority:2},{src:{value:Pm},dest:{value:ce.a.actions.rightHand.drop},xform:rm.falling,priority:3},{src:{value:wm("b").pressed},dest:{value:ce.a.actions.rightHand.switchDrawMode},xform:rm.rising,priority:1},{src:{value:wm("a").pressed},dest:{value:ce.a.actions.rightHand.undoDrawing},xform:rm.rising,priority:1}],[Gi.rightCursorHoveringOnCamera]:[],[Gi.rightHandHoveringOnCamera]:[],[Gi.leftHandHoveringOnCamera]:[],[Gi.rightHandHoldingCamera]:[{src:{value:jm},dest:{value:ce.a.actions.rightHand.takeSnapshot},xform:rm.copy,priority:4}],[Gi.leftHandHoldingCamera]:[{src:{value:Om},dest:{value:ce.a.actions.leftHand.takeSnapshot},xform:rm.copy,priority:4}],[Gi.rightCursorHoldingCamera]:[{src:{value:jm},dest:{value:ce.a.actions.cursor.right.takeSnapshot},xform:rm.copy,priority:4}],[Gi.leftCursorHoldingCamera]:[{src:{value:Om},dest:{value:ce.a.actions.cursor.left.takeSnapshot},xform:rm.copy,priority:4}],[Gi.rightHandHoveringOnNothing]:[],[Gi.inputFocused]:[{src:{value:"/device/keyboard"},dest:{value:ce.a.noop},xform:rm.noop,priority:1e3}]}),Nm=e=>`/vive-user/vive-var/${e}`,Fm=`${name}left/wake`,Vm=`${name}right/wake`,Bm=ce.a.device.vive.left.button,zm=ce.a.device.vive.left.axis,Um=ce.a.device.vive.left.pose,Wm=Nm("left/joy"),Zm=Nm("left/joy/scaled"),Gm=Nm("left/joyX/scaled"),qm=Nm("left/joyY/scaled"),$m=Nm("left/joyY/deadzoned"),Ym=Nm("left/touch"),Xm=Nm("left/touch/scaled"),Qm=Nm("left/touchX/scaled"),Km=Nm("left/touchY"),Jm=Nm("left/touchY/scaled"),eg=Nm("left/dpad/north1"),tg=Nm("left/dpad/south1"),ig=Nm("left/dpad/east1"),ng=Nm("left/dpad/west1"),ag=Nm("left/dpad/center1"),sg=Nm("left/dpad/north2"),og=Nm("left/dpad/south2"),rg=Nm("left/dpad/east2"),lg=Nm("left/dpad/west2"),cg=Nm("left/dpad/center2"),dg=Nm("left/trigger/falling/stopDrawing"),hg=Nm("left/grip/falling/stopDrawing"),ug=Nm("left/trigger/rising/grab"),pg=Nm("left/grab/rising/grab"),mg=Nm("left/touchpad/rising2"),gg=Nm("left/touchpad/rising1"),fg=Nm("left/touch/characterAcceleration"),vg=Nm("left/characterAcceleration"),bg=Nm("nonNormalizedCharacterAcceleration"),yg=Nm("left/boost"),_g=Nm("left/drawing/undo"),wg=ce.a.device.vive.right.button,Eg=ce.a.device.vive.right.axis,xg=ce.a.device.vive.right.pose,Sg=Nm("right/touch"),Cg=Nm("right/joy"),kg=Nm("right/joyY/deadzoned"),Ag=Nm("right/dpad/north1"),Tg=Nm("right/dpad/south1"),Mg=Nm("right/dpad/east1"),Lg=Nm("right/dpad/west1"),Rg=Nm("right/dpad/center"),Pg=Nm("right/dpad/north2"),Dg=Nm("right/dpad/south2"),Og=Nm("right/dpad/east2"),Hg=Nm("right/dpad/west2"),jg=Nm("right/dpad/center2"),Ig=Nm("right/dpad/centerStrip"),Ng=Nm("right/touchpad/rising"),Fg=Nm("right/touchpad/falling"),Vg=Nm("right/boost"),Bg=Nm("right/trigger/rising/grab"),zg=Nm("right/grab/rising/grab"),Ug=Nm("right/cursorDrop1"),Wg=Nm("right/cursorDrop2"),Zg=Nm("left/cursorDrop1"),Gg=Nm("left/cursorDrop2"),qg=Nm("right/trigger/stopTeleport"),$g=Nm("right/touchpad/stopTeleport"),Yg=Nm("right/drawing/undo"),Xg=Nm("dpad/ensureFrozen"),Qg=Nm("keyboard/ensureFrozen"),Kg=Nm("buttons/ensureFrozen"),Jg=Nm("dpad/thaw"),ef=Nm("keyboard/thaw"),tf=Nm("buttons/thaw"),nf=Nm("buttons/freeze"),af=Nm("buttons/inspect"),sf=Nm("right/snap-right"),of=Nm("right/snap-left"),rf=Nm("right/snap-right2"),lf=Nm("right/snap-left2"),cf=e=>`/vive-user/keyboard-var/${e}`,df=cf("snap-right"),hf=cf("snap-left"),uf=cf("characterAcceleration"),pf=cf("wasd_vec2"),mf=cf("arrows_vec2"),gf=cf("boost"),ff=Nm("leftGripPressed1"),vf=Nm("leftGripPressed2"),bf=Nm("rightGripPressed1"),yf=Nm("rightGripPressed2"),_f=Nm("leftTriggerPressed1"),wf=Nm("leftTriggerPressed2"),Ef=Nm("leftTouchpadPressed1"),xf=Nm("leftTouchpadPressed2"),Sf=Nm("rightTriggerPressed1"),Cf=Nm("rightTriggerPressed2"),kf=Nm("leftTouchpadFallingStopTeleport"),Af=Nm("leftTriggerFallingStopTeleport"),Tf=Nm("leftGripFallingWhileHoldingPen"),Mf=lm({[Gi.global]:[{src:{value:ce.a.device.vive.left.matrix},dest:{value:ce.a.actions.leftHand.matrix},xform:rm.copy},{src:{value:ce.a.device.vive.right.matrix},dest:{value:ce.a.actions.rightHand.matrix},xform:rm.copy},{src:[Xg,Qg,Kg],dest:{value:ce.a.actions.ensureFrozen},xform:rm.any},{src:[Jg,ef,tf],dest:{value:ce.a.actions.thaw},xform:rm.any},{src:{value:Bm("grip").pressed},dest:{value:ff},xform:rm.copy},{src:{value:ff},dest:{value:ce.a.actions.leftHand.middleRingPinky},xform:rm.copy},{src:{value:Bm("grip").pressed},dest:{value:vf},xform:rm.copy},{src:[Bm("touchpad").touched,Bm("primary").touched],dest:{value:ce.a.actions.leftHand.thumb},xform:rm.any},{src:{value:_f},dest:{value:ce.a.actions.leftHand.index},xform:rm.copy},{src:{value:Bm("trigger").pressed},dest:{value:_f},xform:rm.copy},{src:{value:Bm("trigger").pressed},dest:{value:wf},xform:rm.copy},{src:{value:wg("grip").pressed},dest:{value:bf},xform:rm.copy},{src:{value:wg("grip").pressed},dest:{value:yf},xform:rm.copy},{src:{value:bf},dest:{value:ce.a.actions.rightHand.middleRingPinky},xform:rm.copy},{src:[wg("touchpad").touched,wg("primary").touched],dest:{value:ce.a.actions.rightHand.thumb},xform:rm.any},{src:{value:wg("trigger").pressed},dest:{value:Sf},xform:rm.copy},{src:{value:wg("trigger").pressed},dest:{value:Cf},xform:rm.copy},{src:{value:Sf},dest:{value:ce.a.actions.rightHand.index},xform:rm.copy},{src:{x:zm("touchX"),y:zm("touchY")},dest:{value:Ym},xform:rm.compose_vec2},{src:{value:Ym},dest:{north:eg,south:tg,east:ig,west:ng,center:ag},xform:rm.vec2dpad(.35)},{src:{value:Bm("touchpad").pressed},dest:{value:Ef},xform:rm.copy},{src:{value:Bm("touchpad").pressed},dest:{value:xf},xform:rm.copy},{src:{x:Eg("touchX"),y:Eg("touchY")},dest:{value:Sg},xform:rm.compose_vec2},{src:{value:Sg},dest:{north:Ag,south:Tg,east:Mg,west:Lg,center:Rg},xform:rm.vec2dpad(.35,!1,!0)},{src:{x:Eg("joyX"),y:Eg("joyY")},dest:{value:Cg},xform:rm.compose_vec2},{src:{value:Cg},dest:{north:Pg,south:Dg,east:Og,west:Hg,center:jg},xform:rm.vec2dpad(.35,!1,!0)},{src:[Ag,Tg,Rg],dest:{value:Ig},xform:rm.any},{src:{value:wg("touchpad").pressed},dest:{value:Ng},xform:rm.rising},{src:{value:wg("touchpad").pressed},dest:{value:Fg},xform:rm.falling},{src:{bool:Ng,value:Mg},dest:{value:sf},xform:rm.copyIfTrue,priority:1},{src:{value:Og},dest:{value:rf},xform:rm.rising,priority:1},{src:{value:ce.a.device.keyboard.key("e")},dest:{value:df},xform:rm.rising},{src:[sf,rf,df],dest:{value:ce.a.actions.snapRotateRight},xform:rm.any},{src:{value:ce.a.device.keyboard.key("Tab")},dest:{value:ce.a.actions.toggleFreeze},xform:rm.rising},{src:{value:ce.a.device.keyboard.key(" ")},dest:{value:Qg},xform:rm.copy},{src:{value:ce.a.device.keyboard.key(" ")},dest:{value:ef},xform:rm.falling},{src:{value:ce.a.device.keyboard.key("p")},dest:{value:ce.a.actions.spawnPen},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("c")},dest:{value:ce.a.actions.toggleCamera},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("x")},dest:{value:ce.a.actions.takeSnapshot},xform:rm.copy},{src:{value:wg("touchpad").pressed,bool:Ig},dest:{value:Xg},root:"rootForFrozenOverrideWhenHolding",xform:rm.copyIfTrue},{src:{value:Fg},dest:{value:Jg},xform:rm.copy},{src:{bool:Ng,value:Lg},dest:{value:of},xform:rm.copyIfTrue,priority:1},{src:{value:Hg},dest:{value:lf},xform:rm.rising,priority:1},{src:{value:ce.a.device.keyboard.key("q")},dest:{value:hf},xform:rm.rising},{src:[of,lf,hf],dest:{value:ce.a.actions.snapRotateLeft},xform:rm.any},{src:{value:zm("touchX")},dest:{value:Qm},xform:rm.scale(1.5)},{src:{value:Km},dest:{value:Jm},xform:rm.scale(1.5)},{src:{x:Qm,y:Jm},dest:{value:Xm},xform:rm.compose_vec2},{src:{bool:xf,value:Xm},dest:{value:fg},xform:rm.copyIfTrue},{src:{value:zm("joyX")},dest:{value:Gm},xform:rm.scale(1.5)},{src:{value:zm("joyY")},dest:{value:qm},xform:rm.scale(1.5)},{src:{x:Gm,y:qm},dest:{value:Zm},xform:rm.compose_vec2},{src:{first:Zm,second:fg},dest:{value:vg},xform:rm.max_vec2},{src:{w:ce.a.device.keyboard.key("arrowup"),a:ce.a.device.keyboard.key("arrowleft"),s:ce.a.device.keyboard.key("arrowdown"),d:ce.a.device.keyboard.key("arrowright")},dest:{vec2:mf},xform:rm.wasd_to_vec2},{src:{w:ce.a.device.keyboard.key("w"),a:ce.a.device.keyboard.key("a"),s:ce.a.device.keyboard.key("s"),d:ce.a.device.keyboard.key("d")},dest:{vec2:pf},xform:rm.wasd_to_vec2},{src:{value:ce.a.device.keyboard.key("t")},dest:{value:ce.a.actions.focusChat},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("/")},dest:{value:ce.a.actions.focusChatCommand},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("Escape")},dest:{value:ce.a.actions.mediaExit},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("1")},dest:{value:"/var/shift+1"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+1"},dest:{value:ce.a.actions.mediaSearch1},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("2")},dest:{value:"/var/shift+2"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+2"},dest:{value:ce.a.actions.mediaSearch2},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("3")},dest:{value:"/var/shift+3"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+3"},dest:{value:ce.a.actions.mediaSearch3},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("4")},dest:{value:"/var/shift+4"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+4"},dest:{value:ce.a.actions.mediaSearch4},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("5")},dest:{value:"/var/shift+5"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+5"},dest:{value:ce.a.actions.mediaSearch5},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("6")},dest:{value:"/var/shift+6"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+6"},dest:{value:ce.a.actions.mediaSearch6},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("7")},dest:{value:"/var/shift+7"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+7"},dest:{value:ce.a.actions.mediaSearch7},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("8")},dest:{value:"/var/shift+8"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+8"},dest:{value:ce.a.actions.mediaSearch8},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("l")},dest:{value:ce.a.actions.logDebugFrame},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("k")},dest:{value:ce.a.actions.logInteractionState},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("m")},dest:{value:ce.a.actions.muteMic},xform:rm.rising},{src:{first:pf,second:mf},dest:{value:uf},xform:rm.max_vec2},{src:{first:vg,second:uf},dest:{value:bg},xform:rm.max_vec2},{src:{value:bg},dest:{value:ce.a.actions.characterAcceleration},xform:rm.normalize_vec2},{src:{value:ce.a.device.keyboard.key("shift")},dest:{value:gf},xform:rm.copy},{src:{value:Bm("primary").pressed},dest:{value:yg},xform:rm.copy},{src:{value:wg("primary").pressed},dest:{value:Vg},xform:rm.copy},{src:[gf,yg,Vg],dest:{value:ce.a.actions.boost},xform:rm.any},{src:{value:Um},dest:{value:ce.a.actions.cursor.left.pose},xform:rm.copy},{src:{value:xg},dest:{value:ce.a.actions.cursor.right.pose},xform:rm.copy},{src:{value:xg},dest:{value:ce.a.actions.rightHand.pose},xform:rm.copy},{src:{value:Um},dest:{value:ce.a.actions.leftHand.pose},xform:rm.copy},{src:[Bm("primary").pressed,Bm("trigger").pressed,Bm("grip").pressed,Bm("touchpad").pressed],dest:{value:Fm},xform:rm.any},{src:{value:Fm},dest:{value:ce.a.actions.cursor.left.wake},xform:rm.rising},{src:[wg("primary").pressed,wg("trigger").pressed,wg("grip").pressed,wg("touchpad").pressed],dest:{value:Vm},xform:rm.any},{src:{value:Vm},dest:{value:ce.a.actions.cursor.right.wake},xform:rm.rising},{src:[wg("secondary").pressed,Bm("secondary").pressed,wg("bumper").pressed,Bm("bumper").pressed],dest:{value:nf},xform:rm.any},{src:[wg("primary").pressed,Bm("primary").pressed],dest:{value:af},xform:rm.any},{src:{value:nf},dest:{value:Kg},xform:rm.copy},{src:{value:nf},dest:{value:tf},xform:rm.falling}],[Gi.rightHandTeleporting]:[{src:{value:Cf},dest:{value:qg},xform:rm.falling,priority:1},{src:{value:wg("touchpad").pressed},dest:{value:$g},xform:rm.falling},{src:[qg,$g],dest:{value:ce.a.actions.rightHand.stopTeleport},xform:rm.any}],[Gi.leftHandHoveringOnNothing]:[{src:{value:wf},dest:{value:ce.a.actions.leftHand.startTeleport},xform:rm.rising}],[Gi.leftHandTeleporting]:[{src:{value:wf},dest:{value:Af},xform:rm.falling,priority:1},{src:[Af,kf,Tf],dest:{value:ce.a.actions.leftHand.stopTeleport},xform:rm.any}],[Gi.rightHandHoveringOnNothing]:[{src:{value:Cf},dest:{value:ce.a.actions.rightHand.startTeleport},xform:rm.rising,priority:1}],[Gi.rightCursorHoveringOnNothing]:[],[Gi.leftCursorHoveringOnNothing]:[],[Gi.rightCursorHoveringOnUI]:[{src:{value:Cf},dest:{value:ce.a.actions.cursor.right.grab},xform:rm.rising,priority:1}],[Gi.leftCursorHoveringOnUI]:[{src:{value:wf},dest:{value:ce.a.actions.cursor.left.grab},xform:rm.rising,priority:1}],[Gi.rightCursorHoveringOnVideo]:[{src:{value:Eg("touchY"),touching:wg("touchpad").touched},dest:{value:ce.a.actions.cursor.right.mediaVolumeMod},xform:rm.touch_axis_scroll(.1)},{src:{value:Eg("joyY")},dest:{value:ce.a.actions.cursor.right.mediaVolumeMod},xform:rm.scale(.02)}],[Gi.leftCursorHoveringOnVideo]:[{src:{value:zm("touchY"),touching:Bm("touchpad").touched},dest:{value:ce.a.actions.cursor.left.mediaVolumeMod},xform:rm.touch_axis_scroll(.1)},{src:{value:zm("joyY")},dest:{value:ce.a.actions.cursor.left.mediaVolumeMod},xform:rm.scale(.02)}],[Gi.leftHandHoveringOnInteractable]:[{src:{value:vf},dest:{value:pg},xform:rm.rising},{src:{value:wf},dest:{value:ug},xform:rm.rising,priority:1},{src:[pg],dest:{value:ce.a.actions.leftHand.grab},xform:rm.any}],[Gi.leftHandHoldingInteractable]:[{src:{value:vf},dest:{value:ce.a.actions.leftHand.drop},xform:rm.falling,priority:1}],[Gi.leftHandHoveringOnPen]:[],[Gi.leftHandHoldingPen]:[{src:{value:xf},dest:{value:kf},xform:rm.falling,priority:1},{src:{value:xf},dest:{value:gg},xform:rm.rising,priority:1},{src:{bool:gg,value:ag},dest:{value:ce.a.actions.leftHand.startTeleport},xform:rm.copyIfTrue,priority:1},{src:{value:wf},dest:{value:ce.a.actions.leftHand.startDrawing},xform:rm.rising,priority:2},{src:{value:wf},dest:{value:dg},xform:rm.falling,priority:2},{src:{value:vf},dest:{value:hg},xform:rm.falling,priority:1},{src:{value:vf},dest:{value:Tf},xform:rm.falling,priority:1},{src:[dg,hg],dest:{value:ce.a.actions.leftHand.stopDrawing},xform:rm.any},{src:{value:xf},dest:{value:mg},xform:rm.rising,priority:1},{src:{bool:mg,value:eg},dest:{value:ce.a.actions.leftHand.penNextColor},xform:rm.copyIfTrue,priority:2},{src:{bool:mg,value:tg},dest:{value:ce.a.actions.leftHand.penPrevColor},xform:rm.copyIfTrue,priority:2},{src:{value:zm("touchX"),touching:Bm("touchpad").touched},dest:{value:ce.a.actions.leftHand.scalePenTip},xform:rm.touch_axis_scroll(.05)},{src:[wg("primary").pressed,Bm("secondary").pressed],dest:{value:_g},xform:rm.any,priority:1},{src:{value:_g},dest:{value:ce.a.actions.leftHand.undoDrawing},xform:rm.rising},{src:{value:Bm("primary").pressed},dest:{value:ce.a.actions.leftHand.switchDrawMode},xform:rm.rising,priority:2}],[Gi.rightCursorHoveringOnInteractable]:[{src:{value:yf},dest:{value:zg},xform:rm.rising},{src:{value:Cf},dest:{value:Bg},xform:rm.rising,priority:1},{src:[zg],dest:{value:ce.a.actions.cursor.right.grab},xform:rm.any},{src:{value:af},dest:{value:ce.a.actions.startInspecting},xform:rm.rising}],[Gi.leftCursorHoveringOnInteractable]:[{src:{value:vf},dest:{value:pg},xform:rm.rising},{src:{value:wf},dest:{value:ug},xform:rm.rising,priority:1},{src:[pg],dest:{value:ce.a.actions.cursor.left.grab},xform:rm.any},{src:{value:af},dest:{value:ce.a.actions.startInspecting},xform:rm.rising}],[Gi.rightCursorHoldingUI]:[{src:{value:Cf},dest:{value:Wg},xform:rm.falling,priority:4}],[Gi.leftCursorHoldingUI]:[{src:{value:wf},dest:{value:Gg},xform:rm.falling,priority:4}],[Gi.rightCursorHoldingInteractable]:[{src:{value:Eg("touchY"),touching:wg("touchpad").touched},dest:{value:ce.a.actions.cursor.right.modDelta},xform:rm.touch_axis_scroll(-1)},{src:{value:Eg("joyY")},dest:{value:ce.a.actions.cursor.right.modDelta},xform:rm.scale(-.02)},{src:{value:yf},dest:{value:Ug},xform:rm.falling,priority:1},{src:[Ug,Wg],dest:{value:ce.a.actions.cursor.right.drop},xform:rm.any},{src:{},dest:{value:Xg},root:"rootForFrozenOverrideWhenHolding",xform:rm.always(!1)}],[Gi.leftCursorHoldingInteractable]:[{src:{value:zm("touchY"),touching:Bm("touchpad").touched},dest:{value:ce.a.actions.cursor.left.modDelta},xform:rm.touch_axis_scroll(-1)},{src:{value:zm("joyY")},dest:{value:ce.a.actions.cursor.left.modDelta},xform:rm.scale(-.02),priority:1},{src:{value:vf},dest:{value:Zg},xform:rm.falling,priority:1},{src:[Zg,Gg],dest:{value:ce.a.actions.cursor.left.drop},xform:rm.any},{src:{},dest:{value:Xg},root:"rootForFrozenOverrideWhenHolding",xform:rm.always(!1)}],[Gi.rightCursorHoveringOnPen]:[],[Gi.leftCursorHoveringOnPen]:[],[Gi.rightCursorHoldingPen]:[{src:[Ug],dest:{value:ce.a.actions.cursor.right.drop},xform:rm.noop,priority:1},{src:[Wg],dest:{value:ce.a.actions.cursor.right.drop},xform:rm.noop,priority:1},{src:{value:yf},dest:{value:ce.a.actions.cursor.right.drop},xform:rm.rising,priority:1},{src:{bool:Ng,value:Rg},dest:{value:ce.a.actions.rightHand.startTeleport},xform:rm.copyIfTrue,priority:2},{src:{value:Cf},dest:{value:ce.a.actions.cursor.right.startDrawing},xform:rm.rising,priority:3},{src:{value:Cf},dest:{value:ce.a.actions.cursor.right.stopDrawing},xform:rm.falling,priority:3},{src:{value:Eg("touchX"),touching:wg("touchpad").touched},dest:{value:ce.a.actions.cursor.right.scalePenTip},xform:rm.touch_axis_scroll(.1)},{src:{bool:Ng,value:Ag},dest:{value:ce.a.actions.cursor.right.penNextColor},xform:rm.copyIfTrue,priority:2},{src:{bool:Ng,value:Tg},dest:{value:ce.a.actions.cursor.right.penPrevColor},xform:rm.copyIfTrue,priority:2},{src:{value:wg("primary").pressed},dest:{value:ce.a.actions.cursor.right.undoDrawing},xform:rm.rising,priority:2}],[Gi.leftCursorHoldingPen]:[{src:[Zg],dest:{value:ce.a.actions.cursor.left.drop},xform:rm.noop,priority:1},{src:[Gg],dest:{value:ce.a.actions.cursor.left.drop},xform:rm.noop,priority:1},{src:{value:vf},dest:{value:ce.a.actions.cursor.left.drop},xform:rm.rising,priority:1},{src:{value:wf},dest:{value:ce.a.actions.cursor.left.startDrawing},xform:rm.rising,priority:3},{src:{value:wf},dest:{value:ce.a.actions.cursor.left.stopDrawing},xform:rm.falling,priority:3},{src:{value:zm("touchX"),touching:Bm("touchpad").touched},dest:{value:ce.a.actions.cursor.left.scalePenTip},xform:rm.touch_axis_scroll(.1)},{src:{value:xf},dest:{value:gg},xform:rm.rising,priority:1},{src:{bool:gg,value:eg},dest:{value:ce.a.actions.cursor.left.penNextColor},xform:rm.copyIfTrue,priority:2},{src:{bool:gg,value:tg},dest:{value:ce.a.actions.cursor.left.penPrevColor},xform:rm.copyIfTrue,priority:2},{src:{value:Bm("primary").pressed},dest:{value:ce.a.actions.cursor.left.undoDrawing},xform:rm.rising,priority:2}],[Gi.rightHandHoveringOnInteractable]:[{src:{value:yf},dest:{value:zg},xform:rm.rising},{src:{value:Cf},dest:{value:Bg},xform:rm.rising,priority:2},{src:[zg],dest:{value:ce.a.actions.rightHand.grab},xform:rm.any}],[Gi.rightHandHoldingInteractable]:[{src:{value:yf},dest:{value:ce.a.actions.rightHand.drop},xform:rm.falling,priority:1},{src:{},dest:{value:Xg},root:"rootForFrozenOverrideWhenHolding",xform:rm.always(!1)}],[Gi.rightHandHoveringOnPen]:[],[Gi.rightHandHoldingPen]:[{src:{bool:Ng,value:Rg},dest:{value:ce.a.actions.rightHand.startTeleport},xform:rm.copyIfTrue},{src:{value:Cf},dest:{value:ce.a.actions.rightHand.startDrawing},xform:rm.rising,priority:3},{src:{value:Cf},dest:{value:ce.a.actions.rightHand.stopDrawing},xform:rm.falling,priority:3},{src:{bool:Ng,value:Ag},dest:{value:ce.a.actions.rightHand.penNextColor},xform:rm.copyIfTrue,priority:2},{src:{bool:Ng,value:Tg},dest:{value:ce.a.actions.rightHand.penPrevColor},xform:rm.copyIfTrue,priority:2},{src:{value:Eg("touchX"),touching:wg("touchpad").touched},dest:{value:ce.a.actions.rightHand.scalePenTip},xform:rm.touch_axis_scroll(.05)},{src:[Bm("primary").pressed,wg("secondary").pressed],dest:{value:Yg},xform:rm.any,priority:1},{src:{value:Yg},dest:{value:ce.a.actions.rightHand.undoDrawing},xform:rm.rising},{src:{value:wg("primary").pressed},dest:{value:ce.a.actions.rightHand.switchDrawMode},xform:rm.rising,priority:2}],[Gi.rightCursorHoveringOnCamera]:[],[Gi.leftCursorHoveringOnCamera]:[],[Gi.rightHandHoveringOnCamera]:[],[Gi.leftHandHoveringOnCamera]:[],[Gi.rightHandHoldingCamera]:[{src:{value:Cf},dest:{value:ce.a.actions.rightHand.takeSnapshot},xform:rm.copy,priority:3},{src:{value:Cf},dest:{value:ce.a.noop},xform:rm.falling,priority:3}],[Gi.leftHandHoldingCamera]:[{src:{value:Bm("trigger").pressed},dest:{value:ce.a.actions.leftHand.takeSnapshot},xform:rm.copy}],[Gi.rightCursorHoldingCamera]:[{src:{value:Cf},dest:{value:ce.a.actions.cursor.right.takeSnapshot},xform:rm.copy,priority:3},{src:{value:Cf},dest:{value:ce.a.noop},xform:rm.falling,priority:3}],[Gi.leftCursorHoldingCamera]:[{src:{value:wf},dest:{value:ce.a.actions.cursor.left.takeSnapshot},xform:rm.copy,priority:3},{src:{value:wf},dest:{value:ce.a.noop},xform:rm.falling,priority:3}],[Gi.inputFocused]:[{src:{value:"/device/keyboard"},dest:{value:ce.a.noop},xform:rm.noop,priority:1e3}]}),Lf=lm({[Gi.global]:[{src:{value:zm("touchY")},dest:{value:Km},xform:rm.copy}],[Gi.leftHandHoldingPen]:[{src:{value:vf},dest:{value:ce.a.actions.leftHand.drop},xform:rm.rising,priority:2}],[Gi.rightHandHoldingPen]:[{src:{value:yf},dest:{value:ce.a.actions.rightHand.drop},xform:rm.rising,priority:2}]}),Rf=lm({[Gi.global]:[{src:{value:zm("touchY")},dest:{value:Km},xform:rm.copy}]}),Pf=lm({[Gi.global]:[{src:{value:zm("touchY")},dest:{value:Km},xform:rm.negate}],[Gi.leftHandHoldingPen]:[{src:{value:vf},dest:{value:ce.a.actions.leftHand.drop},xform:rm.rising,priority:2}],[Gi.rightHandHoldingPen]:[{src:{value:yf},dest:{value:ce.a.actions.rightHand.drop},xform:rm.rising,priority:2}]}),Df=lm({[Gi.global]:[{src:{value:zm("touchY")},dest:{value:Km},xform:rm.copy}],[Gi.leftHandHoldingPen]:[{src:{x:zm("joyX"),y:zm("joyY")},dest:{value:Wm},xform:rm.compose_vec2,priority:1},{src:{value:Wm},dest:{north:sg,south:og,east:rg,west:lg,center:cg},xform:rm.vec2dpad(.35,!1,!0)},{src:{value:vf},dest:{value:ce.a.actions.leftHand.drop},xform:rm.rising,priority:2},{src:{value:rg,override:"/device/overrides/foo"},dest:{value:ce.a.actions.leftHand.penNextColor},xform:rm.rising,priority:2},{src:{value:lg,override:"/device/overrides/foo"},dest:{value:ce.a.actions.leftHand.penPrevColor},xform:rm.rising,priority:2},{src:{value:zm("joyY")},dest:{value:$m},xform:rm.deadzone(.1),priority:1},{src:{value:$m},dest:{value:ce.a.actions.leftHand.scalePenTip},xform:rm.scaleExp(-.005,5),priority:1}],[Gi.rightHandHoldingPen]:[{src:{value:yf},dest:{value:ce.a.actions.rightHand.drop},xform:rm.rising,priority:2},{src:{value:Og},dest:{value:ce.a.actions.rightHand.penNextColor},xform:rm.rising,priority:2},{src:{value:Hg},dest:{value:ce.a.actions.rightHand.penPrevColor},xform:rm.rising,priority:2},{src:{value:Eg("joyY")},dest:{value:kg},xform:rm.deadzone(.1)},{src:{value:kg},dest:{value:ce.a.actions.rightHand.scalePenTip},xform:rm.scaleExp(-.005,5),priority:1}],[Gi.inspecting]:[{src:{value:af},dest:{value:ce.a.actions.stopInspecting},xform:rm.falling}]}),Of=ce.a.device.wmr.left.grip.pressed,Hf=ce.a.device.wmr.right.grip.pressed,jf=ce.a.device.wmr.right.trigger.pressed,If=ce.a.device.wmr.v("right/joy/north"),Nf=ce.a.device.wmr.v("right/grip/rising"),Ff=ce.a.device.wmr.v("right/trigger/rising"),Vf=ce.a.device.wmr.v("right/grip/falling"),Bf=ce.a.device.wmr.v("right/trigger/falling");function zf(e){return{padWest:ce.a.device.wmr.v(e+"/pad/west"),padEast:ce.a.device.wmr.v(e+"/pad/east"),padNorth:ce.a.device.wmr.v(e+"/pad/north"),padSouth:ce.a.device.wmr.v(e+"/pad/south"),padCenter:ce.a.device.wmr.v(e+"/pad/center"),padCenterStrip:ce.a.device.wmr.v(e+"/pad/centerStrip")}}function Uf(e){const{padWest:t,padEast:i,padNorth:n,padSouth:a,padCenter:s,padCenterStrip:o}=zf(e),r=ce.a.device.wmr.v(e+"/pad");return[{src:{x:ce.a.device.wmr[e].touchpad.axisX,y:ce.a.device.wmr[e].touchpad.axisY},dest:{value:r},xform:rm.compose_vec2},{src:{value:r},dest:{west:t,east:i,north:n,south:a,center:s},xform:rm.vec2dpad(.5,!1,!1)},{src:[n,s,a],dest:{value:o},xform:rm.any}]}const Wf={src:{},dest:{value:ce.a.actions.ensureFrozen},xform:rm.always(!1)};function Zf(e,t){const i=ce.a.device.wmr[e].touchpad.axisY,n=ce.a.device.wmr[e].trigger.pressed,a=ce.a.device.wmr[e].touchpad.pressed,s=ce.a.device.wmr[e].touchpad.touched,o=ce.a.device.wmr.v(e+"/pad/rising"),r=ce.a.device.wmr.v(e+"/pad/centerStrip/touched"),{padWest:l,padEast:c,padCenter:d,padCenterStrip:h}=zf(e),u=t?ce.a.actions.cursor[e]:ce.a.actions[e+"Hand"];return[Wf,...Uf(e),{src:{value:n},dest:{value:u.startDrawing},xform:rm.rising},{src:{value:n},dest:{value:u.stopDrawing},xform:rm.falling},{src:{value:a},dest:{value:o},xform:rm.rising},{src:{bool:o,value:l},dest:{value:u.penPrevColor},xform:rm.copyIfTrue},{src:{bool:o,value:c},dest:{value:u.penNextColor},xform:rm.copyIfTrue},{src:[h,s],dest:{value:r},xform:rm.all},{src:{value:i,touching:r},dest:{value:u.scalePenTip},xform:rm.touch_axis_scroll(-.05)},{src:[o,d],dest:{value:u.undoDrawing},xform:rm.all}]}function Gf(e){const t=ce.a.device.wmr[e].touchpad.touched,i=ce.a.device.wmr[e].trigger.pressed,n=ce.a.device.wmr[e].grip.pressed,a=ce.a.actions[e+"Hand"];return[{src:{value:t},dest:{value:a.thumb},xform:rm.copy},{src:{value:i},dest:{value:a.index},xform:rm.copy},{src:{value:n},dest:{value:a.middleRingPinky},xform:rm.copy}]}function qf(e,t){const i=t?ce.a.actions.cursor[e]:ce.a.actions[e+"Hand"];return[Wf,{src:{value:ce.a.device.wmr[e].trigger.pressed},dest:{value:i.takeSnapshot},xform:rm.copy}]}const $f=lm({[Gi.global]:[{src:{value:ce.a.device.wmr.left.matrix},dest:{value:ce.a.actions.leftHand.matrix},xform:rm.copy},{src:{value:ce.a.device.wmr.right.matrix},dest:{value:ce.a.actions.rightHand.matrix},xform:rm.copy},{src:{value:ce.a.device.wmr.left.pose},dest:{value:ce.a.actions.leftHand.pose},xform:rm.copy},{src:{value:ce.a.device.wmr.right.pose},dest:{value:ce.a.actions.cursor.right.pose},xform:rm.copy},{src:{value:ce.a.device.wmr.right.pose},dest:{value:ce.a.actions.rightHand.pose},xform:rm.copy},...Gf("left"),...Gf("right"),...function(){const e=ce.a.device.wmr.left.touchpad.pressed,t=ce.a.device.wmr.right.touchpad.pressed,i=ce.a.device.wmr.v("left/touchpad/falling"),n=ce.a.device.wmr.v("right/touchpad/falling"),a=ce.a.device.wmr.k("space/falling");return[{src:[ce.a.device.keyboard.key(" "),e,t],dest:{value:ce.a.actions.ensureFrozen},xform:rm.any},{src:{value:ce.a.device.keyboard.key(" ")},dest:{value:a},xform:rm.falling},{src:{value:ce.a.device.keyboard.key("Tab")},dest:{value:ce.a.actions.toggleFreeze},xform:rm.rising},{src:{value:e},dest:{value:i},xform:rm.falling},{src:{value:t},dest:{value:n},xform:rm.falling},{src:[a,i,n],dest:{value:ce.a.actions.thaw},xform:rm.any}]}(),...function(){const e=ce.a.device.wmr.v("right/joy"),t=ce.a.device.wmr.v("right/joy/west"),i=ce.a.device.wmr.v("right/joy/East"),n=ce.a.device.wmr.v("right/joy/west/rising"),a=ce.a.device.wmr.v("right/joy/east/rising"),s=ce.a.device.wmr.k("q/rising"),o=ce.a.device.wmr.k("e/rising");return[{src:{x:ce.a.device.wmr.right.joystick.axisX,y:ce.a.device.wmr.right.joystick.axisY},dest:{value:e},xform:rm.compose_vec2},{src:{value:e},dest:{north:If,west:t,east:i},xform:rm.vec2dpad(.2,!1,!1)},{src:{value:If},dest:{value:ce.a.actions.rightHand.startTeleport},xform:rm.rising},{src:{value:t},dest:{value:n},xform:rm.rising},{src:{value:i},dest:{value:a},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("q")},dest:{value:s},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("e")},dest:{value:o},xform:rm.rising},{src:[n,s],dest:{value:ce.a.actions.snapRotateLeft},xform:rm.any},{src:[a,o],dest:{value:ce.a.actions.snapRotateRight},xform:rm.any}]}(),...function(){const e=ce.a.device.wmr.k("wasd_vec2"),t=ce.a.device.wmr.k("arrows_vec2"),i=ce.a.device.wmr.k("characterAcceleration"),n=ce.a.device.wmr.v("left/joy/x/deadzoned"),a=ce.a.device.wmr.v("left/joy/y/deadzoned"),s=ce.a.device.wmr.v("left/joy/x/scaled"),o=ce.a.device.wmr.v("left/joy/y/scaled"),r=ce.a.device.wmr.v("left/characterAcceleration");return[{src:{w:ce.a.device.keyboard.key("arrowup"),a:ce.a.device.keyboard.key("arrowleft"),s:ce.a.device.keyboard.key("arrowdown"),d:ce.a.device.keyboard.key("arrowright")},dest:{vec2:t},xform:rm.wasd_to_vec2},{src:{w:ce.a.device.keyboard.key("w"),a:ce.a.device.keyboard.key("a"),s:ce.a.device.keyboard.key("s"),d:ce.a.device.keyboard.key("d")},dest:{vec2:e},xform:rm.wasd_to_vec2},{src:{first:e,second:t},dest:{value:i},xform:rm.max_vec2},{src:{value:ce.a.device.wmr.left.joystick.axisX},dest:{value:n},xform:rm.deadzone(.1)},{src:{value:n},dest:{value:s},xform:rm.scale(1.5)},{src:{value:ce.a.device.wmr.left.joystick.axisY},dest:{value:a},xform:rm.deadzone(.1)},{src:{value:a},dest:{value:o},xform:rm.scale(-1.5)},{src:{x:s,y:o},dest:{value:r},xform:rm.compose_vec2},{src:{first:r,second:i},dest:{value:ce.a.actions.characterAcceleration},xform:rm.max_vec2},{src:[ce.a.device.wmr.left.trigger.pressed,ce.a.device.wmr.right.trigger.pressed,ce.a.device.keyboard.key("shift")],dest:{value:ce.a.actions.boost},xform:rm.any}]}(),{src:{value:ce.a.device.keyboard.key("m")},dest:{value:ce.a.actions.muteMic},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("t")},dest:{value:ce.a.actions.focusChat},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("/")},dest:{value:ce.a.actions.focusChatCommand},xform:rm.rising},{src:{value:ce.a.device.keyboard.key("Escape")},dest:{value:ce.a.actions.mediaExit},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("1")},dest:{value:"/var/shift+1"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+1"},dest:{value:ce.a.actions.mediaSearch1},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("2")},dest:{value:"/var/shift+2"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+2"},dest:{value:ce.a.actions.mediaSearch2},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("3")},dest:{value:"/var/shift+3"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+3"},dest:{value:ce.a.actions.mediaSearch3},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("4")},dest:{value:"/var/shift+4"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+4"},dest:{value:ce.a.actions.mediaSearch4},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("5")},dest:{value:"/var/shift+5"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+5"},dest:{value:ce.a.actions.mediaSearch5},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("6")},dest:{value:"/var/shift+6"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+6"},dest:{value:ce.a.actions.mediaSearch6},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("7")},dest:{value:"/var/shift+7"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+7"},dest:{value:ce.a.actions.mediaSearch7},xform:rm.rising},{src:{bool:ce.a.device.keyboard.key("control"),value:ce.a.device.keyboard.key("8")},dest:{value:"/var/shift+8"},priority:1001,xform:rm.copyIfTrue},{src:{value:"/var/shift+8"},dest:{value:ce.a.actions.mediaSearch8},xform:rm.rising}],[Gi.leftHandHoveringOnNothing]:[],[Gi.rightCursorHoveringOnNothing]:[],[Gi.rightHandHoveringOnNothing]:[],[Gi.rightHandTeleporting]:[{src:{value:If},dest:{value:ce.a.actions.rightHand.stopTeleport},xform:rm.falling}],[Gi.rightCursorHoveringOnUI]:[{src:{value:jf},dest:{value:ce.a.actions.cursor.right.grab},xform:rm.rising}],[Gi.rightCursorHoveringOnVideo]:[...function(){const e="right",t=ce.a.device.wmr.right.touchpad.axisY,i=ce.a.device.wmr.right.touchpad.touched,n=ce.a.device.wmr.v("right/pad/centerStrip/touched"),{padCenterStrip:a}=zf(e);return[...Uf(e),{src:[a,i],dest:{value:n},xform:rm.all},{src:{value:t,touching:n},dest:{value:ce.a.actions.cursor.right.mediaVolumeMod},xform:rm.touch_axis_scroll(-.1)}]}()],[Gi.leftHandHoveringOnInteractable]:[{src:{value:Of},dest:{value:ce.a.actions.leftHand.grab},xform:rm.rising}],[Gi.rightCursorHoveringOnInteractable]:[{src:{value:Hf},dest:{value:Nf},xform:rm.rising},{src:{value:jf},dest:{value:Ff},xform:rm.rising},{src:[Nf,Ff],dest:{value:ce.a.actions.cursor.right.grab},xform:rm.any}],[Gi.rightHandHoveringOnInteractable]:[{src:{value:Hf},dest:{value:ce.a.actions.rightHand.grab},xform:rm.rising}],[Gi.leftHandHoldingInteractable]:[Wf,{src:{value:Of},dest:{value:ce.a.actions.leftHand.drop},xform:rm.falling}],[Gi.rightCursorHoldingInteractable]:[Wf,...function(){const{padNorth:e,padSouth:t}=zf("right"),i=ce.a.device.wmr.v("right/pad/northOrSouth"),n=ce.a.device.wmr.v("right/pad/northOrSouth/pressed"),a=ce.a.device.wmr.v("right/pad/northOrSouthpressed/y");return[...Uf("right"),{src:[e,t],dest:{value:i},xform:rm.any},{src:[i,ce.a.device.wmr.right.touchpad.pressed],dest:{value:n},xform:rm.all},{src:{bool:n,value:ce.a.device.wmr.right.touchpad.axisY},dest:{value:a},xform:rm.copyIfTrue},{src:{value:a},dest:{value:ce.a.actions.cursor.right.modDelta},xform:rm.scale(.1)}]}(),{src:{value:Hf},dest:{value:Vf},xform:rm.falling},{src:{value:jf},dest:{value:Bf},xform:rm.falling},{src:[Vf,Bf],dest:{value:ce.a.actions.cursor.right.drop},xform:rm.any}],[Gi.rightHandHoldingInteractable]:[Wf,{src:{value:Hf},dest:{value:ce.a.actions.rightHand.drop},xform:rm.falling}],[Gi.leftHandHoveringOnPen]:[],[Gi.rightCursorHoveringOnPen]:[],[Gi.rightHandHoveringOnPen]:[],[Gi.leftHandHoldingPen]:Zf("left"),[Gi.rightCursorHoldingPen]:Zf("right",!0),[Gi.rightHandHoldingPen]:Zf("right"),[Gi.leftHandHoveringOnCamera]:[],[Gi.rightCursorHoveringOnCamera]:[],[Gi.rightHandHoveringOnCamera]:[],[Gi.leftHandHoldingCamera]:qf("left"),[Gi.rightCursorHoldingCamera]:qf("right",!0),[Gi.rightHandHoldingCamera]:qf("right"),[Gi.inputFocused]:[{src:{value:"/device/keyboard"},dest:{value:ce.a.noop},xform:rm.noop,priority:1e3}]}),Yf=ce.a.device.xbox.button,Xf=ce.a.device.xbox.axis,Qf=ce.a.device.xbox.v("scaledRightJoystickVertical"),Kf=ce.a.device.xbox.v("scaledLeftJoystickCursorDelta"),Jf=ce.a.device.xbox.v("deadzonedRightJoystickHorizontal"),ev=ce.a.device.xbox.v("deadzonedRightJoystickVertical"),tv=ce.a.device.xbox.v("deadzonedLeftJoystickHorizontal"),iv=ce.a.device.xbox.v("deadzonedLeftJoystickVertical"),nv=ce.a.device.xbox.v("vec2Zero"),av=ce.a.device.xbox.v("zero");function sv(e){const t=ce.a.device.xbox.v("scaledLeftJoystickHorizontal"),i=ce.a.device.xbox.v("scaledLeftJoystickVertical"),n=ce.a.device.xbox.v("scaledLeftJoystickForwardAcceleration");return[{src:{value:tv},dest:{value:t},xform:rm.scale(1.5)},{src:{value:iv},dest:{value:i},xform:rm.scale(-1.25)},{src:{bool:Yf("leftTrigger").pressed,value:i},dest:{value:n},xform:e?rm.copyIfFalse:rm.copy},{src:{x:t,y:n},dest:{value:ce.a.actions.characterAcceleration},xform:rm.compose_vec2}]}const ov=lm({[Gi.rightCursorHoldingPen]:[{src:{value:Yf("rightTrigger").pressed},dest:{value:ce.a.actions.cursor.right.startDrawing},xform:rm.rising,priority:200},{src:{value:Yf("rightTrigger").pressed},dest:{value:ce.a.actions.cursor.right.stopDrawing},xform:rm.falling,priority:200},{src:{value:Yf("b").pressed},dest:{value:ce.a.actions.cursor.right.drop},xform:rm.rising},{src:{value:Yf("y").pressed},dest:{value:ce.a.actions.cursor.right.undoDrawing},xform:rm.rising,priority:200},{src:{value:Yf("a").pressed},dest:{value:ce.a.actions.cursor.right.penNextColor},xform:rm.rising},{src:{value:Yf("x").pressed},dest:{value:ce.a.actions.cursor.right.penPrevColor},xform:rm.rising}],[Gi.global]:[{src:{},dest:{value:ce.a.actions.cursor.right.hideLine},xform:rm.always(!0)},{src:{value:Xf("rightJoystickHorizontal")},dest:{value:Jf},xform:rm.deadzone(.1)},{src:{value:Jf},dest:{value:ce.a.actions.angularVelocity},xform:rm.scale(.6)},{src:{value:Xf("rightJoystickVertical")},dest:{value:ev},xform:rm.deadzone(.1)},{src:{value:ev},dest:{value:Qf},xform:rm.scale(-.125)},{src:{},dest:{value:av},xform:rm.always(0)},{src:{x:av,y:Qf},dest:{value:ce.a.actions.cameraDelta},xform:rm.compose_vec2},{src:{value:ce.a.actions.cameraDelta},dest:{value:ce.a.actions.lobbyCameraDelta},xform:rm.copy},{src:{value:Xf("leftJoystickHorizontal")},dest:{value:tv},xform:rm.deadzone(.1)},{src:{value:Xf("leftJoystickVertical")},dest:{value:iv},xform:rm.deadzone(.1)},{src:{value:Yf("leftTrigger").pressed},dest:{value:ce.a.actions.boost},xform:rm.copy},{src:{value:Yf("leftBumper").pressed},dest:{value:ce.a.actions.snapRotateLeft},xform:rm.rising},{src:{value:Yf("rightBumper").pressed},dest:{value:ce.a.actions.snapRotateRight},xform:rm.rising},{src:{},dest:{value:nv},xform:rm.vec2Zero},{src:{value:nv},dest:{value:ce.a.actions.cursor.right.pose},xform:rm.poseFromCameraProjection()},{src:{value:Yf("y").pressed},dest:{value:ce.a.actions.spawnPen},xform:rm.rising,priority:100},{src:{value:Yf("dpadUp").pressed},dest:{value:ce.a.actions.ensureFrozen},xform:rm.copy},{src:{value:Yf("dpadUp").pressed},dest:{value:ce.a.actions.thaw},xform:rm.falling},{src:{value:Yf("start").pressed},dest:{value:ce.a.actions.toggleFreeze},xform:rm.rising},{src:{value:Yf("a").pressed},dest:{value:ce.a.actions.startGazeTeleport},xform:rm.rising},{src:{value:Yf("a").pressed},dest:{value:ce.a.actions.stopGazeTeleport},xform:rm.falling}],[Gi.rightCursorHoldingNothing]:[...sv()],[Gi.rightCursorHoldingInteractable]:[...sv(!0),{src:{value:Yf("rightTrigger").pressed},dest:{value:ce.a.actions.cursor.right.drop},xform:rm.falling,priority:100},{src:{value:iv},dest:{value:Kf},xform:rm.scale(.25)},{src:{bool:Yf("leftTrigger").pressed,value:Kf},dest:{value:ce.a.actions.cursor.right.modDelta},xform:rm.copyIfTrue}],[Gi.rightCursorHoveringOnUI]:[{src:{value:Yf("rightTrigger").pressed},dest:{value:ce.a.actions.cursor.right.grab},xform:rm.rising}],[Gi.rightCursorHoveringOnInteractable]:[...sv(),{src:{value:Yf("rightTrigger").pressed},dest:{value:ce.a.actions.cursor.right.grab},xform:rm.rising,priority:100}]}),rv=e=>`/vars/daydream/${e}`,lv=rv("touchpad/axis"),cv=rv("touchpad/rising"),dv=rv("touchpad/falling"),hv=rv("touchpad/pressed"),uv=rv("dpad/north"),pv=rv("dpad/south"),mv=rv("dpad/east"),gv=rv("dpad/west"),fv=rv("dpad/center"),vv=rv("brushSizeDelta"),bv=rv("cursorModDelta"),yv=rv("dropSouth"),_v=rv("dropCenter"),wv=[{src:{value:fv,bool:cv},dest:{value:ce.a.actions.cursor.right.grab},xform:rm.copyIfTrue,priority:100}],Ev=[{src:{value:fv,bool:cv},dest:{value:_v},xform:rm.copyIfTrue,priority:100},{src:{value:pv,bool:cv},dest:{value:yv},xform:rm.copyIfTrue,priority:100},{src:[_v,yv],dest:{value:ce.a.actions.cursor.right.drop},xform:rm.any}],xv=lm({[Gi.global]:[{src:{value:ce.a.device.daydream.matrix},dest:{value:ce.a.actions.rightHand.matrix},xform:rm.copy},{src:{x:ce.a.device.daydream.axis("touchpadX"),y:ce.a.device.daydream.axis("touchpadY")},dest:{value:lv},xform:rm.compose_vec2},{src:{value:ce.a.device.daydream.button("touchpad").pressed},dest:{value:cv},xform:rm.rising},{src:{value:ce.a.device.daydream.button("touchpad").pressed},dest:{value:dv},xform:rm.falling},{src:{value:ce.a.device.daydream.button("touchpad").pressed},dest:{value:hv},xform:rm.copy},{src:{value:lv},dest:{north:uv,south:pv,east:mv,west:gv,center:fv},xform:rm.vec2dpad(.5)},{src:{value:mv,bool:cv},dest:{value:ce.a.actions.snapRotateRight},xform:rm.copyIfTrue},{src:{value:gv,bool:cv},dest:{value:ce.a.actions.snapRotateLeft},xform:rm.copyIfTrue},{src:{value:fv,bool:cv},dest:{value:ce.a.actions.rightHand.startTeleport},xform:rm.copyIfTrue},{src:{value:ce.a.device.daydream.pose},dest:{value:ce.a.actions.cursor.right.pose},xform:rm.copy},{src:{value:ce.a.device.daydream.pose},dest:{value:ce.a.actions.rightHand.pose},xform:rm.copy}],[Gi.rightCursorHoveringOnInteractable]:wv,[Gi.rightCursorHoveringOnUI]:wv,[Gi.rightCursorHoveringOnVideo]:[{src:{value:ce.a.device.daydream.axis("touchpadY"),touching:ce.a.device.daydream.button("touchpad").touched},dest:{value:ce.a.actions.cursor.right.mediaVolumeMod},xform:rm.touch_axis_scroll(-.1)}],[Gi.rightCursorHoldingInteractable]:[{src:{value:dv},dest:{value:ce.a.actions.cursor.right.drop},xform:rm.copy},{src:{value:ce.a.device.daydream.axis("touchpadY"),touching:ce.a.device.daydream.button("touchpad").touched},dest:{value:bv},xform:rm.touch_axis_scroll()},{src:{value:bv},dest:{value:ce.a.actions.cursor.right.modDelta},xform:rm.copy}],[Gi.rightHandTeleporting]:[{src:{value:dv},dest:{value:ce.a.actions.rightHand.stopTeleport},xform:rm.copy}],[Gi.rightCursorHoldingPen]:[{src:{value:uv,bool:cv},dest:{value:ce.a.actions.cursor.right.startDrawing},xform:rm.copyIfTrue,priority:100},{src:{value:dv},dest:{value:ce.a.actions.cursor.right.stopDrawing},xform:rm.copy,priority:100},{src:{value:ce.a.device.daydream.axis("touchpadX"),touching:ce.a.device.daydream.button("touchpad").touched},dest:{value:vv},xform:rm.touch_axis_scroll(-.1)},{src:{value:vv,bool:hv},dest:{value:ce.a.actions.cursor.right.scalePenTip},xform:rm.copyIfFalse,priority:100},{src:{value:mv,bool:cv},dest:{value:ce.a.actions.cursor.right.penPrevColor},xform:rm.copyIfTrue,priority:100},{src:{value:gv,bool:cv},dest:{value:ce.a.actions.cursor.right.penNextColor},xform:rm.copyIfTrue,priority:100},{src:{value:bv,bool:hv},dest:{value:ce.a.actions.cursor.right.modDelta},xform:rm.copyIfFalse,priority:100},...Ev],[Gi.rightCursorHoldingCamera]:[{src:{value:dv},xform:rm.noop,priority:100},{src:{value:uv,bool:cv},dest:{value:ce.a.actions.cursor.right.takeSnapshot},xform:rm.copy,priority:100},...Ev]}),Sv=lm({[Gi.global]:[{src:{value:ce.a.device.touchscreen.isTouching},dest:{value:ce.a.actions.startGazeTeleport},xform:rm.rising},{src:{value:ce.a.device.touchscreen.isTouching},dest:{value:ce.a.actions.stopGazeTeleport},xform:rm.falling}]});function Cv(e){const t=e.v("touchpad"),i=e.button("touchpad"),n=e.button("trigger"),a=e.axis("touchpadX"),s=e.axis("touchpadXForPen"),o=e.axis("touchpadY"),r=e.axis("touchpadYForPen"),l=e.v("touchpad/rising"),c=e.v("touchpad/falling"),d=e.v("trigger/rising"),h=e.v("trigger/falling"),u=e.v("dpad/north"),p=e.v("dpad/south"),m=e.v("dpad/east"),g=e.v("dpad/west"),f=e.v("dpad/center"),v=e.v("dpad/centerStrip"),b=e.v("dpad/bottomCenterStrip"),y="/vars/oculus-go/togglePen",_={src:{value:d},dest:{value:ce.a.actions.cursor.right.grab},xform:rm.copy,priority:200},w={src:{value:h},dest:{value:ce.a.actions.cursor.right.drop},xform:rm.copy,priority:200};return lm({[Gi.global]:[{src:{value:e.matrix},dest:{value:ce.a.actions.rightHand.matrix},xform:rm.copy},{src:{value:n.pressed},dest:{value:d},xform:rm.rising},{src:{value:n.pressed},dest:{value:h},xform:rm.falling},{src:{value:i.pressed},dest:{value:l},xform:rm.rising,priority:100},{src:{value:i.pressed},dest:{value:c},xform:rm.falling,priority:100},{src:{x:a,y:o},dest:{value:t},xform:rm.compose_vec2},{src:{value:a},dest:{value:s},xform:rm.copy},{src:{value:o},dest:{value:r},xform:rm.copy},{src:{value:t},dest:{north:u,south:p,east:m,west:g,center:f},xform:rm.vec2dpad(.3)},{src:[f,p],dest:{value:b},xform:rm.any},{src:[u,b],dest:{value:v},xform:rm.any},{src:{value:v,bool:i.pressed},dest:{value:ce.a.actions.ensureFrozen},priority:100,xform:rm.copyIfTrue},{src:{value:c},dest:{value:ce.a.actions.thaw},xform:rm.copy},{src:{value:m,bool:l},dest:{value:ce.a.actions.snapRotateRight},xform:rm.copyIfTrue,priority:100},{src:{value:g,bool:l},dest:{value:ce.a.actions.snapRotateLeft},xform:rm.copyIfTrue,priority:100},{src:{value:d},dest:{value:ce.a.actions.rightHand.startTeleport},xform:rm.copy,priority:100},{src:{value:e.pose},dest:{value:ce.a.actions.cursor.right.pose},xform:rm.copy},{src:{value:e.pose},dest:{value:ce.a.actions.rightHand.pose},xform:rm.copy},{src:{value:i.touched},dest:{value:ce.a.actions.rightHand.thumb},xform:rm.copy},{src:{value:n.pressed},dest:{value:ce.a.actions.rightHand.index},xform:rm.copy},{src:{value:n.pressed},dest:{value:ce.a.actions.rightHand.middleRingPinky},xform:rm.copy}],[Gi.rightCursorHoveringOnInteractable]:[_],[Gi.rightCursorHoveringOnUI]:[_],[Gi.rightCursorHoldingUI]:[w],[Gi.rightCursorHoveringOnVideo]:[{src:{value:o,touching:i.touched},dest:{value:ce.a.actions.cursor.right.mediaVolumeMod},xform:rm.touch_axis_scroll(-.1)}],[Gi.rightCursorHoldingInteractable]:[{src:{value:h},dest:{value:ce.a.actions.cursor.right.drop},xform:rm.copy,priority:200},{src:{value:o,touching:i.touched},dest:{value:ce.a.actions.cursor.right.modDelta},xform:rm.touch_axis_scroll()},{src:{value:v},priority:200,xform:rm.noop}],[Gi.rightHandTeleporting]:[{src:{value:h},dest:{value:ce.a.actions.rightHand.stopTeleport},xform:rm.copy,priority:100}],[Gi.rightCursorHoldingPen]:[{src:{value:d},dest:{value:ce.a.actions.cursor.right.startDrawing},xform:rm.copy,priority:300},{src:{value:h},dest:{value:ce.a.actions.cursor.right.stopDrawing},xform:rm.copy,priority:300},{src:{value:s,touching:i.touched},dest:{value:ce.a.actions.cursor.right.scalePenTip},xform:rm.touch_axis_scroll(.1,.1),priority:200},{src:{value:r,touching:i.touched},dest:{value:ce.a.actions.cursor.right.modDelta},xform:rm.touch_axis_scroll(1,.1),priority:200},{src:{value:b,bool:c},dest:{value:y},xform:rm.copyIfTrue,priority:300},{src:{value:y},dest:{value:ce.a.actions.cursor.right.drop},xform:rm.rising,priority:200},{src:{value:y},dest:{value:ce.a.actions.pen.remove},xform:rm.rising,priority:200},{src:{value:m,bool:l},dest:{value:ce.a.actions.cursor.right.penPrevColor},xform:rm.copyIfTrue,priority:200},{src:{value:g,bool:l},dest:{value:ce.a.actions.cursor.right.penNextColor},xform:rm.copyIfTrue,priority:200},{src:{value:u,bool:l},dest:{value:ce.a.actions.cursor.right.undoDrawing},xform:rm.copyIfTrue,priority:200}],[Gi.rightCursorHoldingCamera]:[{src:{value:d},dest:{value:ce.a.actions.cursor.right.takeSnapshot},xform:rm.copy,priority:300}]})}const kv=Object(Me.a)("dui");let Av,Tv;class Mv{constructor(e){this.gamepad=e}write(e){this.gamepad.connected&&(this.gamepad.buttons.forEach((t,i)=>{const n=ce.a.device.gamepad(this.gamepad.index).button(i);e.setValueType(n.pressed,!!t.pressed),e.setValueType(n.touched,!!t.touched),e.setValueType(n.value,t.value)}),this.gamepad.axes.forEach((t,i)=>{e.setValueType(ce.a.device.gamepad(this.gamepad.index).axis(i),t)}))}}const Lv={},Rv=Cv(ce.a.device.oculusgo),Pv=Cv(ce.a.device.gearVRController);const Dv=(e,t)=>{for(const i in e.dest)if(-1!==e.dest[i].indexOf(t))return!0;return!1},Ov=(e,t)=>{for(const i of e)if(Dv(i,t))return!0;return!1},Hv=(e,t)=>{for(const i of Object.values(e.src))if(!i.startsWith("/device/")&&!Ov(t,i))return!1;return!0};function jv(e){return""!==e}function Iv(e,t){const i=e.split("/").filter(jv),n=t.split("/").filter(jv);if(i.length>n.length)return!1;for(let e=0;e<i.length;e++)if(i[e]!==n[e])return!1;return!0}function Nv(e,t){if(void 0===e.priority&&(e.priority=0),void 0===t.priority&&(t.priority=0),t.priority>=e.priority)return!1;for(const i in e.src){const n=e.src[i];for(const e in t.src){const i=t.src[e];if(-1!==i.indexOf(n)&&Iv(n,i))return!0}}return!1}function Fv(e,t){for(let i=0;i<e.sets.length;i++)if(t.includes(e.sets[i]))return!0;return!1}AFRAME.registerSystem("userinput",{get(e){if(this.frame)return this.frame.get(e)},toggleSet(e,t){this.pendingSetChanges.push(e),this.pendingSetChanges.push(!!t)},init(){this.frame={generation:0,values:{},generations:{},get:function(e){if(this.generations[e]===this.generation)return this.values[e]},setValueType:function(e,t){this.values[e]=t,this.generations[e]=this.generation},setVector2:function(e,t,i){const n=this.values[e]||[];n[0]=t,n[1]=i,this.values[e]=n,this.generations[e]=this.generation},setPose:function(e,t){this.setValueType(e,t)},setMatrix4:function(e,t){const i=this.values[e]||new THREE.Matrix4;i.copy(t),this.values[e]=i,this.generations[e]=this.generation}},this.prevActiveSets=[],this.activeSets=[Gi.global],this.pendingSetChanges=[],this.xformStates=new Map,this.activeDevices=new Ou([new ju]);const e=AFRAME.utils.device.isMobile(),t=AFRAME.utils.device.isMobileVR(),i=Object(nu.a)();e||t||i?t&&!i||(this.activeDevices.add(new om),this.activeDevices.add(new Hu),this.activeDevices.add(new Fp)):(this.activeDevices.add(new Du),this.activeDevices.add(new Gp),this.activeDevices.add(new Hu)),this.isMobile=e,this.isMobileVR=t,this.registeredMappings=new Set([vm]),this.registeredMappingsChanged=!0;const n=new Map;n.set(Dp,$f),n.set(Mp,Mf),n.set(gp,Im),n.set(tp,Rv),n.set(lp,Pv),n.set(Sp,xv);const a=new Map;a.set(Iu,ov),a.set(Mv,Lv);const s=e=>{e instanceof Mp&&e.gamepad&&("OpenVR Cosmos"===e.gamepad.id?this.registeredMappings.add(Df):"HTC Vive Focus Plus Controller"===e.gamepad.id?this.registeredMappings.add(Pf):4===e.gamepad.axes.length?this.registeredMappings.add(Rf):this.registeredMappings.add(Lf))},o=e=>{e instanceof Mp&&e.gamepad&&(this.registeredMappings.delete(Df),this.registeredMappings.delete(Pf),this.registeredMappings.delete(Rf),this.registeredMappings.delete(Lf))},r=()=>{const e=this.el.sceneEl.is("vr-mode"),t=AFRAME.utils.device.isMobile(),i=Object(nu.a)();if(e){console.log("Using VR bindings."),this.registeredMappings.delete(t||i?fm:mm);for(let e=0;e<this.activeDevices.items.length;e++){const t=this.activeDevices.items[e],i=n.get(t.constructor);i&&this.registeredMappings.add(i),s(t)}t&&jn().then(e=>{e.cardboard===On.yes&&(this.registeredMappings.add(Sv),this.registeredMappingsChanged=!0)})}else{console.log("Using Non-VR bindings.");for(let e=0;e<this.activeDevices.items.length;e++){const t=this.activeDevices.items[e];o(t),this.registeredMappings.delete(n.get(t.constructor))}this.registeredMappings.add(t||i?fm:mm)}for(let e=0;e<this.activeDevices.items.length;e++){const t=this.activeDevices.items[e],i=a.get(t.constructor);i&&this.registeredMappings.add(i)}this.registeredMappingsChanged=!0},l=e=>{let t;for(let t=0;t<this.activeDevices.items.length;t++){const i=this.activeDevices.items[t];if(i.gamepad&&i.gamepad.index===e.gamepad.index)return void console.warn("connected already fired for gamepad",e.gamepad)}t=e.gamepad.id.startsWith("OpenVR Gamepad")||"HTC Vive Focus Plus Controller"===e.gamepad.id||"OpenVR Cosmos"===e.gamepad.id?new Mp(e.gamepad):e.gamepad.id.startsWith("Oculus Touch")||e.gamepad.id.startsWith("Pico Neo 2")?new gp(e.gamepad):e.gamepad.id.startsWith("Spatial Controller")?new Dp(e.gamepad):"Oculus Go Controller"===e.gamepad.id||"Pico G2 Controller"===e.gamepad.id?new tp(e.gamepad):"Gear VR Controller"===e.gamepad.id||"HTC Vive Focus Controller"===e.gamepad.id?new lp(e.gamepad):"Daydream Controller"===e.gamepad.id?new Sp(e.gamepad):"standard"===e.gamepad.mapping?new Iu(e.gamepad):new Mv(e.gamepad),this.activeDevices.add(t),r()};window.addEventListener("gamepadconnected",l,!1),window.addEventListener("gamepaddisconnected",e=>{for(let t=0;t<this.activeDevices.items.length;t++){const i=this.activeDevices.items[t];if(i.gamepad&&i.gamepad.index===e.gamepad.index)return this.registeredMappings.delete(n.get(i.constructor)||a.get(i.constructor)),void this.activeDevices.delete(i)}r()},!1);for(const e of navigator.getGamepads())e&&l({gamepad:e});this.el.sceneEl.addEventListener("enter-vr",r),this.el.sceneEl.addEventListener("exit-vr",r),r()},maybeToggleXboxMapping(){if(Object(nu.a)()||this.isMobile||this.isMobileVR)return;const e=(this.get(ce.a.device.vive.left.axesSum)||0)+(this.get(ce.a.device.vive.right.axesSum)||0)+(this.get(ce.a.device.leftOculusTouch.axesSum)||0)+(this.get(ce.a.device.rightOculusTouch.axesSum)||0),t=this.get(ce.a.device.mouse.movementXY),i=(t&&(t[0]||t[1]))>2||e>.5,n=this.registeredMappings.has(ov);i&&n?(this.registeredMappings.delete(ov),this.registeredMappingsChanged=!0):this.get(ce.a.device.xbox.axesSum)>.5&&!n&&(this.registeredMappings.add(ov),this.registeredMappingsChanged=!0)},tick2(){this.frame.generation+=1;const e=this.registeredMappingsChanged;e&&(this.registeredMappingsChanged=!1,this.prevSortedBindings=this.sortedBindings,this.sortedBindings=function(e){const t=[];for(const i of e)for(const e in i)for(const n of i[e])t.push(n);const i=[];for(;t.length>0;){const e=t.shift();Hv(e,i)?i.push(e):t.push(e)}return i}(this.registeredMappings),this.prevSortedBindings||(this.prevSortedBindings=this.sortedBindings),this.masks=function(e){const t=new Array(e.length);for(let i=0;i<e.length;i++){const n=t[i]=[],a=e[i];for(let t=0;t<e.length;t++)Nv(e[t],a)&&n.push(t)}return t}(this.sortedBindings)),this.prevActiveSets.length=0;for(let e=0;e<this.activeSets.length;e++){const t=this.activeSets[e];this.prevActiveSets.push(t)}!function(){if(Av=Av||document.getElementById("player-left-controller")&&document.getElementById("player-left-controller").components.teleporter,Tv=Tv||document.getElementById("player-right-controller")&&document.getElementById("player-right-controller").components.teleporter,!Av||!Tv)return;const e=AFRAME.scenes[0].systems.userinput,{leftHand:t,rightHand:i,rightRemote:n,leftRemote:a}=AFRAME.scenes[0].systems.interaction.state;e.toggleSet(Gi.leftHandHoldingInteractable,t.held),e.toggleSet(Gi.rightHandHoldingInteractable,i.held),e.toggleSet(Gi.leftCursorHoldingInteractable,a.held),e.toggleSet(Gi.rightCursorHoldingInteractable,n.held),e.toggleSet(Gi.leftHandHoveringOnNothing,!(a.held||a.hovered||t.held||t.hovered)),e.toggleSet(Gi.rightHandHoveringOnNothing,!(n.held||n.hovered||i.held||i.hovered)),e.toggleSet(Gi.leftCursorHoveringOnNothing,!(t.held||t.hovered||a.held||a.hovered)),e.toggleSet(Gi.rightCursorHoveringOnNothing,!(i.held||i.hovered||n.held||n.hovered)),e.toggleSet(Gi.leftHandHoveringOnPen,!t.held&&t.hovered&&t.hovered.components.tags&&t.hovered.components.tags.data.isPen),e.toggleSet(Gi.rightHandHoveringOnPen,!i.held&&i.hovered&&i.hovered.components.tags&&i.hovered.components.tags.data.isPen),e.toggleSet(Gi.leftCursorHoveringOnPen,!t.held&&!t.hovered&&!a.held&&a.hovered&&a.hovered.components.tags&&a.hovered.components.tags.data.isPen),e.toggleSet(Gi.rightCursorHoveringOnPen,!i.held&&!i.hovered&&!n.held&&n.hovered&&n.hovered.components.tags&&n.hovered.components.tags.data.isPen),e.toggleSet(Gi.leftHandHoveringOnCamera,!t.held&&t.hovered&&t.hovered.components["camera-tool"]),e.toggleSet(Gi.rightHandHoveringOnCamera,!i.held&&i.hovered&&i.hovered.components["camera-tool"]),e.toggleSet(Gi.leftCursorHoveringOnCamera,!t.held&&!t.hovered&&!a.held&&a.hovered&&a.hovered.components["camera-tool"]),e.toggleSet(Gi.rightCursorHoveringOnCamera,!i.held&&!i.hovered&&!n.held&&n.hovered&&n.hovered.components["camera-tool"]),e.toggleSet(Gi.leftHandHoveringOnInteractable,!t.held&&t.hovered&&(t.hovered.components.tags&&t.hovered.components.tags.data.offersHandConstraint||t.hovered.components["super-spawner"])),e.toggleSet(Gi.rightHandHoveringOnInteractable,!i.held&&i.hovered&&(i.hovered.components.tags&&i.hovered.components.tags.data.offersHandConstraint||i.hovered.components["super-spawner"])),e.toggleSet(Gi.leftCursorHoveringOnInteractable,!t.held&&!t.hovered&&!a.held&&a.hovered&&(a.hovered.components.tags&&a.hovered.components.tags.data.offersRemoteConstraint||a.hovered.components.tags&&a.hovered.components.tags.data.togglesHoveredActionSet||a.hovered.components["super-spawner"])),e.toggleSet(Gi.rightCursorHoveringOnInteractable,!i.held&&!i.hovered&&!n.held&&n.hovered&&(n.hovered.components.tags&&n.hovered.components.tags.data.offersRemoteConstraint||n.hovered.components.tags&&n.hovered.components.tags.data.togglesHoveredActionSet||n.hovered.components["super-spawner"])),e.toggleSet(Gi.leftHandHoveringOnVideo,!t.held&&t.hovered&&t.hovered.components["media-video"]),e.toggleSet(Gi.rightHandHoveringOnVideo,!i.held&&i.hovered&&i.hovered.components["media-video"]),e.toggleSet(Gi.leftCursorHoveringOnVideo,!t.held&&!t.hovered&&!a.held&&a.hovered&&a.hovered.components["media-video"]),e.toggleSet(Gi.rightCursorHoveringOnVideo,!i.held&&!i.hovered&&!n.held&&n.hovered&&n.hovered.components["media-video"]),e.toggleSet(Gi.leftHandHoldingPen,t.held&&t.held.components.tags&&t.held.components.tags.data.isPen),e.toggleSet(Gi.rightHandHoldingPen,i.held&&i.held.components.tags&&i.held.components.tags.data.isPen),e.toggleSet(Gi.rightCursorHoldingPen,!i.held&&!i.hovered&&n.held&&n.held.components.tags&&n.held.components.tags.data.isPen),e.toggleSet(Gi.leftCursorHoldingPen,!t.held&&!t.hovered&&a.held&&a.held.components.tags&&a.held.components.tags.data.isPen),e.toggleSet(Gi.leftHandHoldingCamera,t.held&&t.held.components["camera-tool"]),e.toggleSet(Gi.rightHandHoldingCamera,i.held&&i.held.components["camera-tool"]),e.toggleSet(Gi.leftCursorHoldingCamera,!t.held&&!t.hovered&&a.held&&a.held.components["camera-tool"]),e.toggleSet(Gi.rightCursorHoldingCamera,!i.held&&!i.hovered&&n.held&&n.held.components["camera-tool"]),e.toggleSet(Gi.leftCursorHoveringOnUI,!t.held&&!t.hovered&&!a.held&&Wp(a.hovered)),e.toggleSet(Gi.rightCursorHoveringOnUI,!i.held&&!i.hovered&&!n.held&&Wp(n.hovered)),e.toggleSet(Gi.leftCursorHoldingNothing,!t.held&&!a.held),e.toggleSet(Gi.rightCursorHoldingNothing,!i.held&&!n.held),e.toggleSet(Gi.leftCursorHoldingUI,!t.held&&!t.hovered&&a.held&&a.held.components.tags&&a.held.components.tags.data.holdableButton),e.toggleSet(Gi.rightCursorHoldingUI,!i.held&&!i.hovered&&n.held&&n.held.components.tags&&n.held.components.tags.data.holdableButton),e.toggleSet(Gi.leftHandTeleporting,Av.isTeleporting),e.toggleSet(Gi.rightHandTeleporting,Tv.isTeleporting),e.toggleSet(Gi.inputFocused,"INPUT"===document.activeElement.nodeName||"TEXTAREA"===document.activeElement.nodeName||"true"===document.activeElement.contentEditable),e.toggleSet(Gi.debugUserInput,kv),AFRAME.scenes[0]&&AFRAME.scenes[0].systems["hubs-systems"]&&e.toggleSet(Gi.inspecting,AFRAME.scenes[0].systems["hubs-systems"].cameraSystem.mode===Ce.c)}();for(let e=0,t=this.pendingSetChanges.length;e<t;e+=2){const t=this.pendingSetChanges[e];if(this.pendingSetChanges[e+1])this.activeSets.includes(t)||this.activeSets.push(t);else{const e=this.activeSets.indexOf(t);e>-1&&this.activeSets.splice(e,1)}}const t=function(e,t){if(e.length!==t.length)return!0;for(let i=0,n=e.length;i<n;i++){const n=e[i];let a=!1;for(let e=0,i=t.length;e<i;e++)if(n===t[e]){a=!0;break}if(!a)return!0}return!1}(this.prevActiveSets,this.activeSets);if(this.pendingSetChanges.length=0,e||t||!this.actives&&!this.masked){this.prevActives=this.actives,this.prevMasked=this.masked;const{actives:e,masked:t}=function(e,t,i){const n=new Array(e.length);for(let t=0;t<e.length;t++)n[t]=Fv(e[t],i);const a=new Array(e.length);for(let i=0;i<e.length;i++){const s=a[i]=[],o=t[i];for(let t=0;t<e.length;t++)n[t]&&-1!==o.indexOf(t)&&s.push(t)}return{actives:n,masked:a}}(this.sortedBindings,this.masks,this.activeSets);this.actives=e,this.masked=t}for(let e=0;e<this.activeDevices.items.length;e++)this.activeDevices.items[e].write(this.frame);for(let i=0;i<this.sortedBindings.length;i++){if(!this.actives[i]||this.masked[i].length>0)continue;const n=this.sortedBindings[i];let a=!0;if(!e&&t&&this.prevSortedBindings){const e=this.prevSortedBindings.indexOf(n);a=e>-1&&this.prevActives[e]&&0===this.prevMasked[e].length}a||this.xformStates.delete(n);const{src:s,dest:o,xform:r,debug:l}=n;let c;l&&(c=this.frame.get(o.value));const d=r(this.frame,s,o,this.xformStates.get(n));l&&console.log(`${JSON.stringify(s.value)} (${s.value&&JSON.stringify(this.frame.get(s.value))}) to ${JSON.stringify(o)}: ${c} -> ${this.frame.get(o.value)}`),void 0!==d&&this.xformStates.set(n,d)}this.prevSortedBindings=this.sortedBindings,this.maybeToggleXboxMapping()}});const Vv=["/actions/","/device/","/var/"],Bv="-----------------------------------",zv=(e,t)=>"number"==typeof t?`${t>=0?"+":""}${t.toFixed(3)}`:t;AFRAME.registerSystem("userinput-debug",{active:!0,tick(){if(!this.active)return;const e=AFRAME.scenes[0].systems.userinput;if(this.userinputFrameStatus){const t=[],{frame:i}=e;for(const e in i.values){if(!i.get(e))continue;if(!Vv.some(t=>e.startsWith(t)))continue;let n=JSON.stringify(i.get(e),zv);n&&(n=n.replace(/{"(\w{3,})":/g,'{\n  "$1":').replace(/,"(\w{3,})":/g,',\n  "$1":')),t.push(`${e} -> ${n}`)}this.userinputFrameStatus.textContent=t.join("\n")}if(e.get(ce.a.actions.debugUserInput.describeCurrentMasks)&&console.log(function(e){const t=[];return e.masked.forEach((i,n)=>{let a;e.actives[n]&&(i.length&&(a=JSON.stringify(e.sortedBindings[n],zv),t.push(Bv),t.push(`Binding #${n}:`),a&&(a=a.replace(/{"(\w{3,})":/g,'{\n  "$1":').replace(/,"(\w{3,})":/g,',\n  "$1":')),t.push(`${a}\n`)),i.forEach(i=>{(a=JSON.stringify(e.sortedBindings[i],zv))&&(a=a.replace(/{"(\w{3,})":/g,'{\n  "$1":').replace(/,"(\w{3,})":/g,',\n  "$1":')),t.push(`- Masked by #${i}:\n${a}`)}),i.length&&t.push("\n"))}),t.join("\n")}(e)),e.get(ce.a.actions.logDebugFrame)){Object(Me.a)("userinput_debug")&&!this.userinputFrameStatus&&(this.userinputFrameStatus=document.createElement("div"),this.userinputFrameStatus.id="userinput-frame-status",this.userinputFrameStatus.style="\n          position: absolute;\n          z-index: 2;\n          left: 0; bottom: 0;\n          background: white;\n          white-space: pre;\n          font-family: monospace;\n          font-size: 8pt;\n        ",document.body.append(this.userinputFrameStatus)),console.log(e),console.log("sorted",e.sortedBindings),console.log("actives",e.actives),console.log("masks",e.masks),console.log("masked",e.masked),console.log("devices",e.activeDevices),console.log("activeSets",e.activeSets),console.log("frame",e.frame),console.log("xformStates",e.xformStates);const{sortedBindings:t,actives:i,masked:n}=e;for(const e in t){const a=[];if(n[e].length>0)for(const i of n[e])a.push(JSON.stringify(t[i]));this.logBindings&&console.log("binding: ",e,"\n",t[e],"\n","dest: ",t[e].dest&&Object.values(t[e].dest),"\n","active: ",i[e],"\n","maskedBy: ",n[e],"\n",a.join("\n"),"\n")}}}});const Uv=[ce.a.actions.mediaSearch1,ce.a.actions.mediaSearch2,ce.a.actions.mediaSearch3,ce.a.actions.mediaSearch4,ce.a.actions.mediaSearch5,ce.a.actions.mediaSearch6,ce.a.actions.mediaSearch7,ce.a.actions.mediaSearch8];AFRAME.registerSystem("ui-hotkeys",{init(){this.mediaSearchStore=window.APP.mediaSearchStore},tick:function(){this.userinput||(this.userinput=this.el.systems.userinput),this.userinput.get(ce.a.actions.focusChat)&&this.focusChat(),this.userinput.get(ce.a.actions.focusChatCommand)&&this.focusChat("/"),this.userinput.get(ce.a.actions.mediaExit)&&(window.APP.history.location.state&&"avatar-editor"!==window.APP.history.location.state.value&&"link"!==window.APP.history.location.state.value&&this.mediaSearchStore.pushExitMediaBrowserHistory(),this.el.emit("action_exit_watch"));for(let e=0;e<Uv.length;e++)this.userinput.get(Uv[e])&&window.APP.hubChannel.can("spawn_and_move_media")&&this.mediaSearchStore.sourceNavigate(ps.a[e]);this.userinput.get(ce.a.actions.toggleCamera)&&this.el.emit("action_toggle_camera"),this.userinput.get(ce.a.actions.toggleUI)&&this.el.sceneEl.is("entered")&&this.el.emit("action_toggle_ui")},focusChat:function(e){const t=document.querySelector(".chat-focus-target");t&&(t.focus(),e&&(t.value=e))}});const Wv=function(){};AFRAME.registerComponent("overwrite-raycast-as-noop",{init(){this.el.object3D.raycast=Wv,this.mesh=this.el.getObject3D("mesh"),this.mesh?this.mesh.raycast=Wv:this.el.addEventListener("model-loaded",()=>{this.mesh=this.el.getObject3D("mesh"),this.mesh&&(this.mesh.raycast=Wv)})}});class Zv{constructor(){this.targets=[],this.setDirty=this.setDirty.bind(this),this.dirty=!0,this.observer=new MutationObserver(this.setDirty),Object(ne.a)().then(()=>{const e=document.querySelector("a-scene");this.rightRemote=document.getElementById("right-cursor-controller"),this.leftRemote=document.getElementById("left-cursor-controller"),this.observer.observe(e,{childList:!0,attributes:!0,subtree:!0}),e.addEventListener("object3dset",this.setDirty),e.addEventListener("object3dremove",this.setDirty)})}setDirty(){this.dirty=!0}tick(e){this.dirty&&(this.populateEntities(this.targets),this.dirty=!1),this.rightRemote&&this.rightRemote.components["cursor-controller"].tick2(e),this.leftRemote&&this.leftRemote.components["cursor-controller"].tick2(e,!0)}populateEntities(e){e.length=0;const t=AFRAME.scenes[0].querySelectorAll(".collidable, .interactable, .ui, .drawing, .occupiable-waypoint-icon, .teleport-waypoint-icon");for(let i=0;i<t.length;i++)t[i].object3D&&e.push(t[i].object3D)}remove(){this.observer.disconnect(),AFRAME.scenes[0].removeEventListener("object3dset",this.setDirty),AFRAME.scenes[0].removeEventListener("object3dremove",this.setDirty)}}function Gv(e,t,i,n,a){const s=e.is("vr-mode")&&Fi(i.held,"isPen")&&i.held.children[0].components.pen.intersection;return e.is("entered")&&!t.hovered&&!t.held&&!n&&!s&&a}class qv{constructor(){this.wakeLeft=!1,this.wakeRight=!1,Object(ne.a)().then(()=>{this.domContentLoadedButComponentsMayNotHave=!0})}tick(e,t,i){if(!this.domContentLoadedButComponentsMayNotHave)return;this.gotComponentReferences||(this.gotComponentReferences=!0,this.rightCursorController=document.getElementById("right-cursor-controller").components["cursor-controller"],this.leftCursorController=document.getElementById("left-cursor-controller").components["cursor-controller"],this.rightHandTeleporter=document.getElementById("player-right-controller").components.teleporter,this.leftHandTeleporter=document.getElementById("player-left-controller").components.teleporter,this.gazeTeleporter=document.getElementById("gaze-teleport").components.teleporter);const n=e.state.rightRemote,a=e.state.leftRemote,s=e.state.leftHand,o=e.state.rightHand;t.get(ce.a.actions.cursor.right.wake)&&(this.wakeRight=!0,a.held||(this.wakeLeft=!1)),t.get(ce.a.actions.cursor.left.wake)&&(this.wakeLeft=!0,n.held||(this.wakeRight=!1));const r=e.el.systems["hubs-systems"].cameraSystem.inspected,l=!r&&Gv(i,s,a,this.leftHandTeleporter.isTeleporting||this.gazeTeleporter.isTeleporting,this.wakeLeft),c=AFRAME.utils.device.isMobile()||Object(nu.a)()||!r&&Gv(i,o,n,this.rightHandTeleporter.isTeleporting||this.gazeTeleporter.isTeleporting,this.wakeRight);l||(a.hovered=null),c||(n.hovered=null),this.leftCursorController.enabled=l,this.rightCursorController.enabled=c}}var $v=i(204);const Yv={debugDrawMode:THREE.AmmoDebugConstants.DrawWireframe,gravity:{x:0,y:-9.8,z:0}};class Xv{constructor(e){const t=i(1215),n=i(1216),a=t.bind(void 0,{locateFile:e=>e.endsWith(".wasm")?n:e});this.bodies=[],this.bodyHelpers=[],this.shapeHelpers=[],this.debugRequested=!1,this.debugEnabled=!1,this.scene=e,this.stepDuration=0,a().then(()=>{this.world=new $v.c(Yv);for(const e of this.bodyHelpers)e.alive&&e.init2();for(const e of this.shapeHelpers)e.alive&&e.init2();this.shapeHelpers.length=0,this.bodyHelpers.length=0})}setDebug(e){this.debugRequested=e}tick(e){if(this.world){this.debugRequested!==this.debugEnabled&&(this.debugEnabled=this.debugRequested,this.debugEnabled?this.world.getDebugDrawer(this.scene).enable():this.world.getDebugDrawer(this.scene).disable());for(let e=0;e<this.bodies.length;e++)this.bodies[e].updateShapes(),this.bodies[e].type!==$.TYPE.DYNAMIC&&this.bodies[e].syncToPhysics();const t=performance.now();this.world.step(e/1e3),this.stepDuration=performance.now()-t;for(let e=0;e<this.bodies.length;e++)this.bodies[e].type===$.TYPE.DYNAMIC&&this.bodies[e].syncFromPhysics()}}addBody(e){this.bodies.push(e)}removeBody(e){const t=this.bodies.indexOf(e);-1!==t&&this.bodies.splice(t,1)}registerBodyHelper(e){this.world?e.init2():this.bodyHelpers.push(e)}registerShapeHelper(e){this.world?e.init2():this.shapeHelpers.push(e)}}const Qv={};class Kv{constructor(e){this.prevLeftHand={held:null,spawning:!1},this.prevRightHand={held:null,spawning:!1},this.prevRightRemote={held:null,spawning:!1},this.prevLeftRemote={held:null,spawning:!1},this.physicsSystem=e,this.constraints={},this.constraintPairs={}}tickInteractor(e,t,i,n){if(this.physicsSystem.world)if(n.held!==i.held){if(n.held&&n.held.components.tags&&n.held.components.tags.data[e]){const e=n.held.id;this.constraintPairs[e]&&-1!==this.constraintPairs[e].indexOf(t)&&(this.constraintPairs[e].splice(this.constraintPairs[e].indexOf(t),1),0===this.constraintPairs[e].length&&delete this.constraintPairs[e],this.constraints[t].destroy(),delete this.constraints[t]),(!this.constraintPairs[e]||this.constraintPairs[e].length<1)&&n.held.setAttribute("body-helper",{activationState:$.ACTIVATION_STATE.ACTIVE_TAG})}if(!i.spawning&&i.held&&i.held.components.tags.data[e])if(!i.held.components.networked||NAF.utils.isMine(i.held)||NAF.utils.takeOwnership(i.held)){i.held.setAttribute("body-helper",{type:"dynamic",activationState:$.ACTIVATION_STATE.DISABLE_DEACTIVATION});const e=i.held.id,n=i.held.components["body-helper"].body,a=document.querySelector(`#${t}`).components["body-helper"].body;a&&a.physicsBody&&(this.constraints[t]=new $v.b(Qv,n,a,this.physicsSystem.world),this.constraintPairs[e]||(this.constraintPairs[e]=[]),this.constraintPairs[e].push(t))}else console.log("Failed to obtain ownership while trying to create constraint on networked object.")}else if(!i.spawning&&n.spawning&&i.held&&i.held.components.tags&&i.held.components.tags.data[e]){i.held.setAttribute("body-helper",{type:"dynamic",activationState:$.ACTIVATION_STATE.DISABLE_DEACTIVATION});const e=i.held.id,n=i.held.components["body-helper"].body,a=document.querySelector(`#${t}`).components["body-helper"].body;a&&a.physicsBody&&(this.constraints[t]=new $v.b({},n,a,this.physicsSystem.world),this.constraintPairs[e]||(this.constraintPairs[e]=[]),this.constraintPairs[e].push(t))}}tick(){const e=AFRAME.scenes[0].systems.interaction;e.ready&&(this.tickInteractor("offersHandConstraint",e.options.leftHand.entity.id,e.state.leftHand,this.prevLeftHand),this.tickInteractor("offersHandConstraint",e.options.rightHand.entity.id,e.state.rightHand,this.prevRightHand),this.tickInteractor("offersRemoteConstraint",e.options.rightRemote.entity.id,e.state.rightRemote,this.prevRightRemote),this.tickInteractor("offersRemoteConstraint",e.options.leftRemote.entity.id,e.state.leftRemote,this.prevLeftRemote),Object.assign(this.prevLeftHand,e.state.leftHand),Object.assign(this.prevRightHand,e.state.rightHand),Object.assign(this.prevRightRemote,e.state.rightRemote),Object.assign(this.prevLeftRemote,e.state.leftRemote))}release(e){this.prevLeftHand.held===e&&(this.prevLeftHand.held=null,this.prevLeftHand.spawning=!1),this.prevLeftHand.held===e&&(this.prevLeftHand.held=null,this.prevLeftHand.spawning=!1),this.prevRightRemote.held===e&&(this.prevRightRemote.held=null,this.prevRightRemote.spawning=!1),this.prevLeftRemote.held===e&&(this.prevLeftRemote.held=null,this.prevLeftRemote.spawning=!1)}}const Jv={collisionFilterMask:i(111).COLLISION_LAYERS.HANDS},eb=(()=>{const e=new THREE.Vector3,t=new THREE.Vector3;return function(i,n){return i.getWorldPosition(e),n.getWorldPosition(t),e.distanceTo(t)}})();function tb(e,t,i){return e&&(e===t.held||e===i.held)}class ib{constructor(){this.initialScale=new THREE.Vector3}tick(){const e=AFRAME.scenes[0].systems.interaction;if(!e.ready)return;const{leftHand:t,rightHand:i,rightRemote:n,leftRemote:a}=e.state,s=tb(t.held,i,n)||tb(a.held,i,n),o=t.held||a.held;let r,l;s&&(r=t.held?e.options.leftHand.entity.object3D:e.options.leftRemote.entity.object3D,l=i.held?e.options.rightHand.entity.object3D:e.options.rightRemote.entity.object3D,r===this.previousLeftStretcher&&l===this.previousRightStretcher&&o===this.stretched||(this.initialStretchDistance=eb(r,l),this.stretched=o,this.initialScale.copy(this.stretched.object3D.scale),this.stretched.components["ammo-body"]&&this.stretched.setAttribute("ammo-body",Jv)),this.stretched.object3D.scale.copy(this.initialScale).multiplyScalar(eb(r,l)/this.initialStretchDistance),this.stretched.object3D.matrixNeedsUpdate=!0),this.previousLeftStretcher=r,this.previousRightStretcher=l}}class nb{tick(){this.didInteractThisFrame=!1;const e=AFRAME.scenes[0].systems.interaction,t=AFRAME.scenes[0].systems.userinput;if(AFRAME.scenes[0].systems["hubs-systems"].cameraSystem.mode===Ce.c)return;const i=e.state.rightRemote.hovered;i&&t.get(e.options.rightRemote.grabPath)&&i.components.tags&&i.components.tags.data.singleActionButton&&(this.didInteractThisFrame=!0,i.object3D.dispatchEvent({type:"interact",object3D:e.options.rightRemote.entity.object3D}));const n=e.state.leftRemote.hovered;n&&t.get(e.options.leftRemote.grabPath)&&n.components.tags&&n.components.tags.data.singleActionButton&&(this.didInteractThisFrame=!0,n.object3D.dispatchEvent({type:"interact",object3D:e.options.leftRemote.entity.object3D}))}}class ab{tick(){const e=AFRAME.scenes[0].systems.interaction,t=e.state.rightRemote.held;this.prevHeld&&this.prevHeld!==t&&this.prevHeld.object3D.dispatchEvent({type:"holdable-button-up",object3D:e.options.rightRemote.entity.object3D}),t&&this.prevHeld!==t&&t.object3D.dispatchEvent({type:"holdable-button-down",object3D:e.options.rightRemote.entity.object3D}),this.prevHeld=t;const i=e.state.leftRemote.held;this.prevHeldLeft&&this.prevHeldLeft!==i&&this.prevHeldLeft.object3D.dispatchEvent({type:"holdable-button-up",object3D:e.options.leftRemote.entity.object3D}),i&&this.prevHeldLeft!==i&&i.object3D.dispatchEvent({type:"holdable-button-down",object3D:e.options.leftRemote.entity.object3D}),this.prevHeldLeft=i}}const sb=function(){const e=["icon-button","text-button","pin-networked-object-button","mic-button","inspect-button"];return function(t){for(let i=0;i<e.length;i++)if(t[e[i]])return!0;return!1}}();function ob(e){if(!e)return null;if(sb(e.components)||e.classList.contains("teleport-waypoint-icon")||e.classList.contains("occupiable-waypoint-icon"))return e;if(e.children)for(let t=0;t<e.children.length;t++)if(sb(e.children[t].components)||e.children[t].classList.contains("teleport-waypoint-icon")||e.children[t].classList.contains("occupiable-waypoint-icon"))return e.children[t];return null}function rb(e,t){if(e.object3D.dispatchEvent(t),e.children)for(let i=0;i<e.children.length;i++)(sb(e.children[i].components)||e.children[i].classList.contains("teleport-waypoint-icon")||e.children[i].classList.contains("occupiable-waypoint-icon"))&&e.children[i].object3D.dispatchEvent(t)}const lb={type:"hovered"},cb={type:"unhovered"};class db{tick(){const e=AFRAME.scenes[0].systems.interaction,t=ob(e.state.rightRemote.hovered),i=ob(e.state.leftRemote.hovered);this.prevButton&&this.prevButton!==t&&rb(this.prevButton,cb),t&&this.prevButton!==t&&rb(t,lb),this.prevButton=t,this.prevButtonLeft&&this.prevButtonLeft!==i&&rb(this.prevButtonLeft,cb),i&&this.prevButtonLeft!==i&&rb(i,lb),this.prevButtonLeft=i}}function hb(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class ub{constructor(e){hb(this,"scaleMenus",(()=>{const e=new THREE.Vector3;return function(){if(this.drawingMenus&&0!==this.drawingMenus.length){this.camera.object3D.getWorldPosition(e);for(let t=0;t<this.drawingMenus.length;t++){const i=this.drawingMenus[t];if(i.object3D.visible&&!i.getAttribute("animation__show")){const t=e.distanceTo(i.object3D.position);i.object3D.scale.setScalar(this.getMenuScale(t)),i.object3D.matrixNeedsUpdate=!0}}}}})()),hb(this,"handleButtons",(()=>{const e=["rightRemote","leftRemote"];return function(){const t=AFRAME.scenes[0].systems.interaction,i=AFRAME.scenes[0].systems.userinput;for(let n=0;n<e.length;n++){const a=e[n];if(t.state[a]){const e=t.state[a].hovered;if(e&&i.get(t.options[a].grabPath)&&e.components.tags&&e.components.tags.data.singleActionButton&&this.buttonMap[e.object3D.uuid]){const t=this.buttonMap[e.object3D.uuid];e.classList.contains("undo-drawing")?(t.components["networked-drawing"].undoDraw(),this.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(v.l)):e.classList.contains("delete-drawing")?(NAF.utils.takeOwnership(t),this.sceneEl.removeChild(t)):e.classList.contains("serialize-drawing")&&t.components["networked-drawing"].serializeDrawing().then(()=>{const t=this.buttonMap[e.object3D.uuid];NAF.utils.takeOwnership(t),this.sceneEl.removeChild(t)})}}}}})()),hb(this,"showMenu",(()=>{const e=new THREE.Vector3,t=new THREE.Vector3;return function(i,n){const a=i.children[0];if(!(a.object3D.visible&&(s=.25,o=n,r=this.lastIntersection,Math.abs(o.x-r.x)<s&&Math.abs(o.y-r.y)<s&&Math.abs(o.z-r.z)<s))){this.camera.object3D.getWorldPosition(t),e.subVectors(t,n).normalize().multiplyScalar(.1),a.object3D.position.copy(n).add(e),a.object3D.lookAt(t),a.object3D.matrixNeedsUpdate=!0,a.object3D.visible=!0,this.lastIntersection.copy(n);const s=i.components.networked.isMine();a.querySelector(".undo-drawing").object3D.visible=s,a.querySelector(".serialize-drawing").object3D.visible=s&&window.APP.hubChannel.can("spawn_and_move_media");const o=t.distanceTo(a.object3D.position),r=this.getMenuScale(o);a.removeAttribute("animation__show"),a.setAttribute("animation__show",{property:"scale",dur:300,from:{x:.8*r,y:.8*r,z:.8*r},to:{x:r,y:r,z:r},easing:"easeOutElastic"}),a.addEventListener("animationcomplete",()=>{a.removeAttribute("animation__show")},{once:!0})}var s,o,r}})()),this.sceneEl=e,this.sceneEl.addEventListener("stateremoved",this.hideMenus.bind(this)),this.lastIntersection=new THREE.Vector3,this.drawingMenus=[],this.buttonMap={},Object(ne.a)().then(()=>{this.cursorControllers=document.querySelectorAll("[cursor-controller]"),this.camera=this.sceneEl.querySelector("#avatar-pov-node")})}tick(){if(this.cursorControllers&&0!==this.cursorControllers.length&&this.camera&&this.sceneEl.is("frozen")&&window.APP.hubChannel.can("spawn_drawing")){const e=this.getHovered();if(e)for(let t=0;t<this.cursorControllers.length;t++)if(this.cursorControllers[t].components["cursor-controller"].intersection){const i=this.cursorControllers[t].components["cursor-controller"].intersection.point;this.showMenu(e,i)}this.handleButtons(),this.scaleMenus()}}getMenuScale(e){return e<=1.5?.5:Math.min(3,e-1)}getHovered(){const e=AFRAME.scenes[0].systems.interaction;let t=null;return e.state.leftRemote&&e.state.leftRemote.hovered&&e.state.leftRemote.hovered.classList.contains("drawing")?t=e.state.leftRemote.hovered:e.state.rightRemote&&e.state.rightRemote.hovered&&e.state.rightRemote.hovered.classList.contains("drawing")&&(t=e.state.rightRemote.hovered),t}hideMenus(){if(this.drawingMenus)for(let e=0;e<this.drawingMenus.length;e++)this.drawingMenus[e].object3D.visible=!1}registerDrawingMenu(e){const t=e.querySelector(".drawing-menu");this.drawingMenus.push(t);const i=t.querySelector(".undo-drawing");this.buttonMap[i.object3D.uuid]=e;const n=t.querySelector(".delete-drawing");this.buttonMap[n.object3D.uuid]=e;const a=t.querySelector(".serialize-drawing");this.buttonMap[a.object3D.uuid]=e}unregisterDrawingMenu(e){const t=e.querySelector(".drawing-menu"),i=this.drawingMenus.indexOf(t);-1!==i&&this.drawingMenus.splice(i,1);const n=t.querySelector(".undo-drawing");delete this.buttonMap[n.object3D.uuid];const a=t.querySelector(".delete-drawing");delete this.buttonMap[a.object3D.uuid];const s=t.querySelector(".serialize-drawing");delete this.buttonMap[s.object3D.uuid]}}function pb(e){return e.components["hover-menu"]||e.components["hover-menu__video"]||e.components["hover-menu__pager"]||e.components["hover-menu__hubs-item"]||e.components["hover-menu__link"]||e.components["hover-menu__photo"]}function mb(e){if(!e)return null;const t=pb(e);if(t)return t;if(!e.components.tags||!e.components.tags.data.isHoverMenuChild)return null;let i=e.parentNode;for(;!pb(i);)i=i.parentNode;return pb(i)}class gb{tick(){const e=AFRAME.scenes[0].systems.interaction,t=mb(e.state.rightRemote.hovered);this.prevHoverMenu&&this.prevHoverMenu!==t&&(this.prevHoverMenu.hovering=!1,this.prevHoverMenu.applyHoverState()),t&&this.prevHoverMenu!==t&&(t.hovering=!0,t.applyHoverState()),this.prevHoverMenu=t;const i=mb(e.state.leftRemote.hovered);this.prevHoverMenu2&&this.prevHoverMenu2!==i&&(this.prevHoverMenu2.hovering=!1,this.prevHoverMenu2.applyHoverState()),i&&this.prevHoverMenu2!==i&&(i.hovering=!0,i.applyHoverState()),this.prevHoverMenu2=i}}class fb{maybeSpawn(e,t,i){const n=AFRAME.scenes[0].systems.userinput,a=e.hovered&&e.hovered.components["super-spawner"];a&&a.spawnedMediaScale&&!a.cooldownTimeout&&n.get(i)&&window.APP.hubChannel.can("spawn_and_move_media")&&this.performSpawn(e,t,i,n,a)}performSpawn(e,t,i,n,a){t.object3D.updateMatrices(),t.object3D.matrix.decompose(t.object3D.position,t.object3D.quaternion,t.object3D.scale);const s=a.data,o=Object(be.b)(s.src,s.template,Tt.a.SPAWNER,null,s.resolve,!0,!1,s.mediaOptions).entity;a.el.object3D.getWorldPosition(o.object3D.position),a.el.object3D.getWorldQuaternion(o.object3D.quaternion),o.object3D.matrixNeedsUpdate=!0,a.el.emit("spawned-entity-created",{target:o}),e.held=o,a.activateCooldown(),e.spawning=!0,o.addEventListener("media-loaded",()=>{o.object3D.scale.copy(a.spawnedMediaScale),o.object3D.matrixNeedsUpdate=!0,e.spawning=!1,a.el.emit("spawned-entity-loaded",{target:o})},{once:!0})}tick(){const e=AFRAME.scenes[0].systems.interaction;e.ready&&(this.maybeSpawn(e.state.leftHand,e.options.leftHand.entity,e.options.leftHand.grabPath),this.maybeSpawn(e.state.rightHand,e.options.rightHand.entity,e.options.rightHand.grabPath),this.maybeSpawn(e.state.rightRemote,e.options.rightRemote.entity,e.options.rightRemote.grabPath),this.maybeSpawn(e.state.leftRemote,e.options.leftRemote.entity,e.options.leftRemote.grabPath))}}function vb(e,t,i){e.held=t.held,e.hovered=t.hovered,e.isTeleporting=i}const bb={DROP:.1,PICKUP:.2,BUTTON_PRESSED:.2,HOVER:.08,STRETCH_BASE:.05,STRETCH_DISTANCE:.2,TELEPORTING:.08,TELEPORTED:.2};function yb(e,t,i){return e.held&&!t.held?bb.DROP:!e.held&&t.held?bb.PICKUP:!e.hovered&&t.hovered?bb.HOVER:i?bb.TELEPORTING:e.isTeleporting&&!i?bb.TELEPORTED:0}class _b{constructor(){this.state={rightHand:{held:null,hovered:null,isTeleporting:!1},rightRemote:{held:null,hovered:null,isTeleporting:!1},leftHand:{held:null,hovered:null,isTeleporting:!1},leftRemote:{held:null,hovered:null,isTeleporting:!1}}}tick(e,t,i){const n=AFRAME.scenes[0].systems.userinput,a=n.get(ce.a.haptics.actuators.left),s=n.get(ce.a.haptics.actuators.right);if(!a&&!s)return;const o=AFRAME.scenes[0].systems.interaction,{leftHand:r,rightHand:l,rightRemote:c,leftRemote:d}=o.state;this.leftTeleporter=this.leftTeleporter||document.querySelector("#player-left-controller").components.teleporter,this.rightTeleporter=this.rightTeleporter||document.querySelector("#player-right-controller").components.teleporter;const h=yb(this.state.leftHand,r,this.leftTeleporter.isTeleporting),u=yb(this.state.rightHand,l,this.rightTeleporter.isTeleporting),p=yb(this.state.rightRemote,c,!1),m=yb(this.state.leftRemote,d,!1),g=t?bb.BUTTON_PRESSED:0,f=i?bb.BUTTON_PRESSED:0,v=(b=e).stretcherLeft&&b.stretcherRight?THREE.Math.clamp(bb.STRETCH_BASE+bb.STRETCH_DISTANCE*Math.abs(eb(b.stretcherLeft,b.stretcherRight)-b.initialStretchDistance),0,.5):0;var b;const y=Math.max(h,m,v,g),_=Math.max(u,p,v,f);y&&a&&a.pulse(y,15),_&&s&&s.pulse(_,15),vb(this.state.rightHand,l,this.rightTeleporter.isTeleporting),vb(this.state.leftHand,r,this.leftTeleporter.isTeleporting),vb(this.state.rightRemote,c,!1),vb(this.state.leftRemote,d,!1)}}var wb=i(299);const Eb=new Array(3),xb=new Array(4),Sb=112,Cb=new THREE.Color(1,1,1),kb=(new THREE.Matrix4).makeScale(0,0,0);function Ab(e){return e*Sb+(4*e*4+32)}const Tb=new THREE.Layers;Tb.set(Ce.a);class Mb extends wb.b{constructor(e,t){super(e,"InstanceData",new ArrayBuffer(Ab(e)));let i=this.offset;this.hubs_sweepParams=new Float32Array(this.data,i,4*e),i+=this.hubs_sweepParams.byteLength,this.hubs_interactorOnePos=new Float32Array(this.data,i,3),i+=this.hubs_interactorOnePos.byteLength,this.hubs_isFrozen=new Uint32Array(this.data,i,1),i+=this.hubs_isFrozen.byteLength,this.hubs_interactorTwoPos=new Float32Array(this.data,i,3),i+=this.hubs_interactorTwoPos.byteLength,this.hubs_time=new Float32Array(this.data,i,1),i+=this.hubs_time.byteLength,this.offset=i,this.meshToEl=t;const n=AFRAME.utils.device.isMobile(),a=AFRAME.utils.device.isMobileVR();this.isTouchscreen=n&&!a}update(e){const t=AFRAME.scenes[0].systems.interaction;if(!t.ready)return;const i=AFRAME.scenes[0].systems["hubs-systems"].cameraSystem,n=i.mode===Ce.c&&!i.enableLights;let a,s;for(let e=0;e<this.meshes.length;e++){const i=this.meshes[e];if(!i)continue;i.updateMatrices();const o=i.visible&&i.parent&&i.parent.visible&&i.el.object3D.visible&&i.el.object3D.parent&&i.el.object3D.parent.visible;this.setInstanceTransform(e,!o||n&&!i.layers.test(Tb)?kb:i.matrixWorld),this.setInstanceColor(e,i.material.color||Cb,i.material.opacity||1);const r=this.meshToEl.get(i);if(r){const i=r.object3D,n=r.components["hoverable-visuals"];if(n){const o=i.matrixWorld.elements[13],l=i.matrixWorld.elements[4],c=i.matrixWorld.elements[5],d=i.matrixWorld.elements[6],h=Math.sqrt(l*l+c*c+d*d)*n.geometryRadius,u=r.components.pinnable&&r.components.pinnable.data.pinned,p=!!r.components["super-spawner"],m=r.sceneEl.is("frozen"),g=!p&&u&&!m;let f,v;t.state.leftRemote.hovered!==r||t.state.leftRemote.held?t.state.leftHand.hovered!==r||t.state.leftHand.held||(a=t.options.leftHand.entity.object3D,f=!0):(a=t.options.leftRemote.entity.object3D,f=!0),t.state.rightRemote.hovered!==r||t.state.rightRemote.held?t.state.rightHand.hovered!==r||t.state.rightHand.held||(s=t.options.rightHand.entity.object3D,v=!0):(s=t.options.rightRemote.entity.object3D,v=!0),xb[0]=o-h,xb[1]=o+h,xb[2]=!!f&&!g&&!this.isTouchscreen,xb[3]=!!v&&!g&&!this.isTouchscreen,this.hubs_sweepParams.set(xb,4*e)}}}a&&(Eb[0]=a.matrixWorld.elements[12],Eb[1]=a.matrixWorld.elements[13],Eb[2]=a.matrixWorld.elements[14],this.hubs_interactorOnePos.set(Eb)),s&&(Eb[0]=s.matrixWorld.elements[12],Eb[1]=s.matrixWorld.elements[13],Eb[2]=s.matrixWorld.elements[14],this.hubs_interactorTwoPos.set(Eb)),this.hubs_time[0]=e,this.hubs_isFrozen[0]=AFRAME.scenes[0].is("frozen")?1:0}}var Lb=i(584),Rb=i.n(Lb),Pb=i(585),Db=i.n(Pb);const Ob=500,Hb=Ab(Ob);class jb{constructor(e,t){this.meshToEl=new WeakMap;const i=t.context;Object(Me.a)("disableBatching")?console.warn("Batching disabled by user via disableBatching. Disabling batching."):window.WebGL2RenderingContext&&i instanceof WebGL2RenderingContext?Hb>i.getParameter(i.MAX_UNIFORM_BLOCK_SIZE)?console.warn("Insufficient MAX_UNIFORM_BLOCK_SIZE, Disabling batching"):(this.batchingEnabled=!0,this.ubo=new Mb(Ob,this.meshToEl),this.batchManager=new wb.a(e,t,{maxInstances:Ob,ubo:this.ubo,shaders:{unlit:{vertexShader:Rb.a,fragmentShader:Db.a}}})):console.warn("Batching requires WebGL 2. Disabling batching.")}addObject(e){if(!this.batchingEnabled)return 0;let t=0;return e.traverse(e=>{e.isMesh&&this.batchManager.addMesh(e)&&t++}),t}removeObject(e){this.batchingEnabled&&e.traverse(e=>{e.isMesh&&this.batchManager.removeMesh(e)})}tick(e){this.batchingEnabled&&this.batchManager.update(e)}}var Ib=i(261);class Nb{constructor(){}tick(e,t,i){const n=e.state,a=e.previousState;(n.leftHand.held!==a.leftHand.held||n.rightHand.held!==a.rightHand.held||n.rightRemote.held!==a.rightRemote.held||Wp(n.rightRemote.hovered)&&n.rightRemote.hovered!==a.rightRemote.hovered||n.leftRemote.held!==a.leftRemote.held||Wp(n.leftRemote.hovered)&&n.leftRemote.hovered!==a.leftRemote.hovered)&&i.playSoundOneShot(v.f),t.get(ce.a.actions.logInteractionState)&&console.log("Interaction System State\nleftHand held",n.leftHand.held,"\nleftHand hovered",n.leftHand.hovered,"\nrightHand held",n.rightHand.held,"\nrightHand hovered",n.rightHand.hovered,"\nrightRemote held",n.rightRemote.held,"\nrightRemote hovered",n.rightRemote.hovered,"\nleftRemote held",n.leftRemote.held,"\nleftRemote hovered",n.leftRemote.hovered)}}var Fb=i(385),Vb=i(586),Bb=i(587),zb=i.n(Bb),Ub=i(588),Wb=i.n(Ub),Zb=i(589),Gb=i.n(Zb),qb=i(590),$b=i.n(qb),Yb=i(591),Xb=i.n(Yb);function Qb(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}const Kb=Object(Ve.a)(new Xb.a);function Jb(e){return function(){var t,i=(t=function*(t,i,n){const s=t.getImageData(0,0,i,n),o="action"===e?Object(a.b)("action-color"):Object(a.b)("notice-background-color"),r=yield Kb(s.data.buffer,[s.data.buffer],{type:e,color:o});t.putImageData(new ImageData(r,i,n),0,0)},function(){var e=this,i=arguments;return new Promise(function(n,a){var s=t.apply(e,i);function o(e){Qb(s,n,a,o,r,"next",e)}function r(e){Qb(s,n,a,o,r,"throw",e)}o(void 0)})});return function(e,t,n){return i.apply(this,arguments)}}()}const ey=["#version 300 es","#define attribute in","#define varying out","#define texture2D texture","#extension GL_OVR_multiview : require","layout(num_views = 2) in;","uniform mat4 modelViewMatrix;","uniform mat4 modelViewMatrix2;","#define modelViewMatrix (gl_ViewID_OVR==0u?modelViewMatrix:modelViewMatrix2)","uniform mat4 projectionMatrix;","uniform mat4 projectionMatrix2;","#define projectionMatrix (gl_ViewID_OVR==0u?projectionMatrix:projectionMatrix2)",""].join("\n"),ty=["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;",""].join("\n"),iy=["#version 300 es","#define varying in","out highp vec4 pc_fragColor;","#define gl_FragColor pc_fragColor","#define texture2D texture",""].join("\n"),ny="";function ay(e){return!!e.visible&&(!e.parent||ay(e.parent))}AFRAME.registerComponent("sprite",{schema:{name:{type:"string"}},tick(){if(!this.didRegisterWithSystem&&!this.didFailToRegister&&this.el.sceneEl.systems["hubs-systems"]){const e=this.el.sceneEl.systems["hubs-systems"].spriteSystem.add(this);this.didRegisterWithSystem=e>0,this.didFailToRegister=e<0}},update(){this.didRegisterWithSystem&&this.el.sceneEl.systems["hubs-systems"].spriteSystem.updateUVs(this)},remove(){this.didRegisterWithSystem&&this.el.sceneEl.systems["hubs-systems"].spriteSystem.remove(this)}});const sy=function(){const e=new Map;return function(t,i,n){let a=e.get(t);if(a)return a;{if(!i.frames[t])return-1===n.indexOf(t)&&n.push(t),a={x:0,y:0,w:0,h:0},e.set(t,a),a;const s=i.meta.size,o=i.frames[t].frame;return a={x:o.x/s.w,y:o.y/s.h,w:o.w/s.w,h:o.h/s.h},e.set(t,a),a}}}(),oy=e=>Fb.frames[e.data.name]?"action":"notice",ry=["action","notice"],ly=function(){const e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3,s={distance:0,point:a,object:null};return function(o,r){this.updateMatrices(),e.set(-.5,.5,0).applyMatrix4(this.matrixWorld),t.set(.5,.5,0).applyMatrix4(this.matrixWorld),i.set(-.5,-.5,0).applyMatrix4(this.matrixWorld);let l=o.ray.intersectTriangle(e,i,t,!1,a);if(null===l&&(n.set(.5,-.5,0).applyMatrix4(this.matrixWorld),null===(l=o.ray.intersectTriangle(t,i,n,!1,a))))return;const c=o.ray.origin.distanceTo(a);c<o.near||c>o.far||(s.distance=c,s.point=a,s.object=this,r.push(s))}}();function cy(e){return e&&e.components?e.components["hoverable-visuals"]?e.components["hoverable-visuals"]:cy(e.parentEl):null}function dy(e){const t=cy(e.el);if(!t)return!1;const i=t.el.components.pinnable&&t.el.components.pinnable.data.pinned,n=!!t.el.components["super-spawner"],a=t.el.sceneEl.is("frozen"),s=!n&&i&&!a;return t.data.enableSweepingEffect&&!s}function hy(e){const t=new THREE.BufferGeometry;t.addAttribute("a_vertices",new THREE.BufferAttribute(new Float32Array(3*e*4),3,!1)),t.addAttribute("a_hubs_EnableSweepingEffect",new THREE.BufferAttribute(new Float32Array(4*e),1,!1)),t.addAttribute("a_hubs_SweepParams",new THREE.BufferAttribute(new Float32Array(4*e*2),2,!1)),t.addAttribute("a_uvs",new THREE.BufferAttribute(new Float32Array(2*e*4),2,!1));const i=new THREE.InterleavedBuffer(new Float32Array(16*e*4),16);t.addAttribute("mvCol0",new THREE.InterleavedBufferAttribute(i,4,0,!1)),t.addAttribute("mvCol1",new THREE.InterleavedBufferAttribute(i,4,4,!1)),t.addAttribute("mvCol2",new THREE.InterleavedBufferAttribute(i,4,8,!1)),t.addAttribute("mvCol3",new THREE.InterleavedBufferAttribute(i,4,12,!1));const n=new Array(6*e);for(let t=0;t<e;t++)n[3*t*2+0]=4*t+0,n[3*t*2+1]=4*t+2,n[3*t*2+2]=4*t+1,n[3*t*2+3]=4*t+1,n[3*t*2+4]=4*t+2,n[3*t*2+5]=4*t+3;return t.setIndex(n),t}const uy=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class py{raycast(e,t){for(let i=0;i<ry.length;i++){const n=ry[i],a=this.slots[n];for(let i=0,s=a.length;i<s;i++){if(!a[i])continue;const s=this.indexWithSprite[n].get(i).el.object3D;ay(s)&&ly.call(s,e,t)}}return t}constructor(e){this.missingSprites=[],this.maxSprites=1024,this.slots={action:new Array(this.maxSprites),notice:new Array(this.maxSprites)},this.spriteWithIndex={action:new Map,notice:new Map},this.indexWithSprite={action:new Map,notice:new Map},this.stack={action:new Array(this.maxSprites),notice:new Array(this.maxSprites)},this.meshes={};for(const e of Object.values(this.stack))for(let t=0;t<this.maxSprites;t++)e[t]=this.maxSprites-1-t;const t=String.prototype.concat(e.renderer.vr.multiview?ey:ty,Gb.a),i=String.prototype.concat(e.renderer.vr.multiview?iy:ny,$b.a),n=Object(ne.a)();Promise.all([n]).then(()=>{for(const[n,a]of[[zb.a,"action"],[Wb.a,"notice"]])Promise.all([Object(be.g)(n,Jb(a)),Object(ne.a)()]).then(([n])=>{const s=new THREE.RawShaderMaterial({uniforms:{u_spritesheet:{value:n},hubs_Time:{value:0}},vertexShader:t,fragmentShader:i,side:THREE.DoubleSide,transparent:!0}),o=this.meshes[a]=new THREE.Mesh(hy(this.maxSprites),s),r=document.createElement("a-entity");r.classList.add("ui"),e.appendChild(r),r.setObject3D("mesh",o),o.frustumCulled=!1,o.renderOrder=window.APP.RENDER_ORDER.HUD_ICONS,o.raycast=this.raycast.bind(this)})})}tick(e){if(this.meshes.action&&this.meshes.notice)for(let t=0;t<ry.length;t++){const i=ry[t],n=this.meshes[i];n.material.uniforms.hubs_Time.value=e,n.material.uniformsNeedUpdate=!0;const a=n.geometry.attributes.mvCol0.data,s=n.geometry.attributes.a_hubs_EnableSweepingEffect,o=n.geometry.attributes.a_hubs_SweepParams;for(let e=0,t=this.slots[i].length;e<t;e++){if(!this.slots[i][e])continue;const t=this.indexWithSprite[i].get(e);if(ay(t.el.object3D)){const i=dy(t)?1:0;if(s.array[4*e+0]=i,s.array[4*e+1]=i,s.array[4*e+2]=i,s.array[4*e+3]=i,s.needsUpdate=!0,i){const i=cy(t.el),n=i.sweepParams[0],a=i.sweepParams[1];o.setXY(4*e+0,n,a),o.setXY(4*e+1,n,a),o.setXY(4*e+2,n,a),o.setXY(4*e+3,n,a),o.needsUpdate=!0}t.el.object3D.updateMatrices();const n=t.el.object3D.matrixWorld;a.array.set(n.elements,4*e*16+0),a.array.set(n.elements,4*e*16+16),a.array.set(n.elements,4*e*16+32),a.array.set(n.elements,4*e*16+48),a.needsUpdate=!0}else a.array.set(uy,4*e*16+0),a.array.set(uy,4*e*16+16),a.array.set(uy,4*e*16+32),a.array.set(uy,4*e*16+48),a.needsUpdate=!0}}}updateUVs(e){const t=oy(e),i=this.meshes[t],n=this.spriteWithIndex[t],a=i.material.uniforms.u_spritesheet.value.flipY,s=n.get(e),o=sy(e.data.name,"action"===t?Fb:Vb,this.missingSprites),r=i.geometry.attributes.a_uvs;r.setXY(4*s+0,o.x,a?1-o.y:o.y),r.setXY(4*s+1,o.x+o.w,a?1-o.y:o.y),r.setXY(4*s+2,o.x,a?1-o.y-o.h:o.y+o.h),r.setXY(4*s+3,o.x+o.w,a?1-o.y-o.h:o.y+o.h),r.needsUpdate=!0}add(e){if(!this.meshes.action||!this.meshes.notice)return 0;const t=oy(e),i=this.stack[t].pop();if(void 0===i)return console.error("Too many sprites"),-1;const n=this.slots[t],a=this.spriteWithIndex[t],s=this.indexWithSprite[t],o=this.meshes[t];n[i]=!0,a.set(e,i),s.set(i,e),this.updateUVs(e);const r=o.geometry.attributes.a_vertices;return r.setXYZ(4*i+0,-.5,.5,0),r.setXYZ(4*i+1,.5,.5,0),r.setXYZ(4*i+2,-.5,-.5,0),r.setXYZ(4*i+3,.5,-.5,0),r.needsUpdate=!0,1}remove(e){const t=oy(e),i=this.slots[t],n=this.spriteWithIndex[t],a=this.indexWithSprite[t],s=this.stack[t],o=this.meshes[t],r=n.get(e);n.delete(e),a.delete(r),i[r]=!1,s.push(r);const l=o.geometry.attributes.mvCol0.data;l.array.set(uy,4*r*16+0),l.array.set(uy,4*r*16+16),l.array.set(uy,4*r*16+32),l.array.set(uy,4*r*16+48),l.needsUpdate=!0}}const my=function(){const e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3,s=new THREE.Matrix4,o=new THREE.Vector3;let r=1;return function(l,c,d){l.updateMatrices(),c.updateMatrices(),Object(Ae.a)(s.copy(l.matrixWorld),s).extractBasis(a,e,t),o.setFromMatrixPosition(l.matrixWorld).add(a.addVectors(e.multiplyScalar(1.6),t.multiplyScalar(.15))),n.subVectors(o,a.setFromMatrixPosition(c.matrixWorld));const h=n.length();return h<(h<.2*a.setFromMatrixColumn(c.matrixWorld,0).length())?(r=1e-5,n.set(0,0,-1)):r=.1+.05*h,i.copy(n).projectOnPlane(e.set(0,1,0)).normalize(),d.makeBasis(a.crossVectors(i,e).multiplyScalar(r),e.multiplyScalar(r),i.multiplyScalar(-1*r)).setPosition(o)}}();function gy(e){return e.canBeOccupied&&e.canBeSpawnPoint}function fy(e){return!e.canBeOccupied&&e.canBeSpawnPoint}function vy(e,t){return new Promise(i=>{const n=document.importNode(document.getElementById(t).content.children[0]);e.appendChild(n,!0),setTimeout(()=>{i(n)},0)})}function by(e,t){return function(e){const t=[];return e.canBeClicked&&e.canBeOccupied?t.push("occupiable-waypoint-icon"):e.canBeClicked&&!e.canBeOccupied?t.push("teleport-waypoint-icon"):fy(e)||gy(e),t}(t).map(t=>vy(e,t))}function yy(e){return e.data.canBeOccupied&&e.data.isOccupied&&e.el.components.networked&&NAF.utils.isMine(e.el)}function _y(e){e.el.setAttribute("waypoint",{isOccupied:!1})}function wy(e){e.filter(yy).forEach(_y)}function Ey(e){return e.object3D.uuid}class xy{constructor(e,t){this.helperMat4=new THREE.Matrix4,this.scene=e,this.loading=[],this.ready=[],this.waypointForTemplateEl={},this.elementsFromTemplatesFor={},this.eventHandlers=[],this.lostOwnershipOfWaypoint=this.lostOwnershipOfWaypoint.bind(this),Object(ne.a)().then(()=>{vy(e,"waypoint-preview-avatar-template").then(e=>{this.waypointPreviewAvatar=e,this.waypointPreviewAvatar.object3D.visible=!1})}),this.characterController=t}releaseAnyOccupiedWaypoints(){wy(this.ready),this.currentWaypoint&&this.currentWaypoint.el.removeEventListener("ownership-lost",this.lostOwnershipOfWaypoint)}teleportToWaypoint(e,t){return function(){this.releaseAnyOccupiedWaypoints(),t.el.object3D.updateMatrices(),this.characterController.enqueueWaypointTravelTo(t.el.object3D.matrixWorld,!1,t.data)}.bind(this)}tryTeleportToOccupiableWaypoint(e,t){return function(){const e=this.ready.filter(yy);this.tryToOccupy(t).then(i=>{i&&(t.el.object3D.updateMatrices(),this.characterController.enqueueWaypointTravelTo(t.el.object3D.matrixWorld,!1,t.data),wy(e.filter(e=>e!==t)))})}.bind(this)}setupEventHandlersFor(e){return function(t){const i=Ey(t);if(this.eventHandlers[i]=this.eventHandlers[i]||{},e.data.canBeClicked&&(t.classList.contains("teleport-waypoint-icon")||t.classList.contains("occupiable-waypoint-icon"))){const n=()=>{e.el.object3D.updateMatrices(),this.waypointPreviewAvatar&&!this.waypointForTemplateEl[i].data.willMaintainInitialOrientation&&(this.waypointPreviewAvatar.object3D.visible=!0,e.el.object3D.updateMatrices(),Object(Ae.l)(this.waypointPreviewAvatar.object3D,e.el.object3D.matrixWorld))},a=()=>{this.waypointPreviewAvatar&&(this.waypointPreviewAvatar.object3D.visible=!1)};t.object3D.addEventListener("hovered",n),t.object3D.addEventListener("unhovered",a),this.eventHandlers[i].hovered=n,this.eventHandlers[i].unhovered=a}if(Fi(t,"singleActionButton")&&e.data.canBeClicked){let n=()=>{console.log("interacted with",t,"associated with waypoint",e)};t.classList.contains("teleport-waypoint-icon")?n=this.teleportToWaypoint(t,e):t.classList.contains("occupiable-waypoint-icon")&&(n=this.tryTeleportToOccupiableWaypoint(t,e)),t.object3D.addEventListener("interact",n),this.eventHandlers[i].interact=n}}.bind(this)}registerComponent(e){this.loading.push(e);const t=this.setupEventHandlersFor(e),i=Ey(e.el);this.elementsFromTemplatesFor[i]=this.elementsFromTemplatesFor[i]||[],Promise.all(by(this.scene,e.data)).then(n=>{const a=this.loading.indexOf(e);if(-1===a)return null;this.loading.splice(a,1),this.ready.push(e),this.elementsFromTemplatesFor[i].push(...n),n.forEach(t=>{this.waypointForTemplateEl[Ey(t)]=e}),n.forEach(t)})}unregisterComponent(e){const t=this.loading.indexOf(e);-1!==t&&this.loading.splice(t,1);const i=this.ready.indexOf(e);if(-1!==i){this.ready.splice(i,1);const t=Ey(e.el),n=this.elementsFromTemplatesFor[t];for(let e=0;e<n.length;e++){const t=n[e],i=Ey(t);if(this.eventHandlers[i]){["interact","hovered","unhovered"].map(e=>{this.eventHandlers[i][e]&&(t.object3D.removeEventListener(e,this.eventHandlers[i][e]),delete this.eventHandlers[i][e])})}t.parentNode.removeChild(t)}this.elementsFromTemplatesFor[t].length=0}}getUnoccupiableSpawnPoint(){const e=this.ready.filter(e=>fy(e.data));return e.length&&e.splice(Math.floor(Math.random()*e.length),1)[0]}lostOwnershipOfWaypoint(e){this.currentWaypoint&&this.currentWaypoint.el===e.detail.el&&(this.mightNeedRespawn=!0,this.ownershipLostTime=performance.now())}tryToOccupy(e){return new Promise(t=>{(function(e){return e.data.canBeOccupied&&(NAF.utils.isMine(e.el)||!(e.data.isOccupied&&NAF.utils.getNetworkOwner(e.el)&&NAF.connection.connectedClients[NAF.utils.getNetworkOwner(e.el)]))})(e)&&function(e){return NAF.utils.isMine(e)||NAF.utils.takeOwnership(e)}(e.el)?(!function(e){e.el.setAttribute("waypoint",{isOccupied:!0})}(e),this.currentWaypoint&&this.currentWaypoint.el.removeEventListener("ownership-lost",this.lostOwnershipOfWaypoint),this.currentWaypoint=e,e.el.addEventListener("ownership-lost",this.lostOwnershipOfWaypoint),t(!0)):t(!1)})}tryToOccupyAnyOf(e){if(!e.length)return Promise.resolve(null);const t=e.splice(Math.floor(Math.random()*e.length),1)[0];return this.tryToOccupy(t).then(i=>i?Promise.resolve(t):this.tryToOccupyAnyOf(e))}moveToSpawnPoint(){return this.currentMoveToSpawn?this.currentMoveToSpawn:(this.nextMoveToSpawn||(this.waitOneTick=!0,this.nextMoveToSpawn=new Promise(e=>{this.nextMoveToSpawnResolve=e})),this.nextMoveToSpawn)}moveToUnoccupiableSpawnPoint(){const e=this.getUnoccupiableSpawnPoint();return e&&(this.releaseAnyOccupiedWaypoints(),e.el.object3D.updateMatrices(),this.characterController.enqueueWaypointTravelTo(e.el.object3D.matrixWorld,!0,e.data)),e}tick(){if(this.waitOneTick)return void(this.waitOneTick=!1);if(!this.currentMoveToSpawn&&this.nextMoveToSpawn){let e;this.mightNeedRespawn=!1,this.currentMoveToSpawn=this.nextMoveToSpawn,this.currentMoveToSpawnResolve=this.nextMoveToSpawnResolve,this.nextMoveToSpawn=null,this.nextMoveToSpawnResolve=null;const t=this.ready.filter(yy);this.tryToOccupyAnyOf(this.ready.filter(e=>gy(e.data))).then(i=>{if(i){const n=i;wy(t.filter(e=>e!==n)),n.el.object3D.updateMatrices(),this.characterController.enqueueWaypointTravelTo(n.el.object3D.matrixWorld,!0,n.data),e=n}else null===i&&(e=this.moveToUnoccupiableSpawnPoint());this.currentMoveToSpawnResolve(e),this.currentMoveToSpawn=null,this.currentMoveToSpawnResolve=null})}else this.mightNeedRespawn&&performance.now()-this.ownershipLostTime<8e3&&(this.mightNeedRespawn=!1,this.moveToSpawnPoint());const e=(e,t)=>{(e.classList.contains("teleport-waypoint-icon")||e.classList.contains("occupiable-waypoint-icon"))&&(e.object3D.visible=this.scene.is("frozen"),e.object3D.visible&&(this.viewingCamera=this.viewingCamera||document.getElementById("viewing-camera").object3D,Object(Ae.l)(e.object3D,my(t.el.object3D,this.viewingCamera,this.helperMat4))))};this.ready.forEach(function(t){this.elementsFromTemplatesFor[Ey(t.el)].forEach(i=>e(i,t))}.bind(this))}}AFRAME.registerComponent("waypoint",{schema:{canBeSpawnPoint:{default:!1},canBeOccupied:{default:!1},canBeClicked:{default:!1},willDisableMotion:{default:!1},willDisableTeleporting:{default:!1},snapToNavMesh:{default:!1},willMaintainInitialOrientation:{default:!1},willMaintainWorldUp:{default:!0},isOccupied:{default:!1}},init(){this.system=this.el.sceneEl.systems["hubs-systems"].waypointSystem,this.didRegisterWithSystem=!1},play(){this.didRegisterWithSystem||(this.el.components.networked&&Object(m.a)(this.el.components.networked.data.networkId),this.system.registerComponent(this,this.el.sceneEl),this.didRegisterWithSystem=!0)},remove(){this.didRegisterWithSystem?this.system.unregisterComponent(this):console.warn("Waypoint removed without ever having registered with the system.")}});var Sy=i(200);const Cy=[];const ky=function(){let e,t;return function(i){return e=e||document.getElementById("avatar-pov-node"),t=t||document.getElementById("avatar-rig"),e.object3D.updateMatrices(),t.object3D.updateMatrices(),i?e.object3D.matrixWorld.elements[13]-t.object3D.matrixWorld.elements[13]:e.object3D.matrix.elements[13]}}();function Ay(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Ty="character",My=Object(Me.a)("waypointLerp"),Ly=function(){const e=new THREE.Matrix4,t=new THREE.Matrix4,i=new THREE.Matrix4;return function(n,a,s,o){return i.makeTranslation(s.x,s.y,s.z),e.extractRotation(n),a||Object(Ae.a)(e,e),t.copy(e).multiply(i),o.setFromMatrixPosition(t)}}(),Ry=45*THREE.Math.DEG2RAD,Py=3.2;class Dy{constructor(e){Ay(this,"teleportTo",function(){const e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3;return function(s){this.isMotionDisabled=!1,this.avatarRig.object3D.getWorldPosition(e),this.avatarPOV.object3D.getWorldPosition(t),n.copy(s),n.y+=this.avatarPOV.object3D.position.y,i.copy(n).sub(t),a.copy(e).add(i),this.findPositionOnNavMesh(a,a,this.avatarRig.object3D.position,!0),this.avatarRig.object3D.matrixNeedsUpdate=!0}}()),Ay(this,"travelByWaypoint",function(){const e=new THREE.Matrix4,t=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Matrix4,a=new THREE.Matrix4,s=new THREE.Vector3,o=new THREE.Vector3,r=new THREE.Matrix4;return function(l,c,d){this.avatarPOV.object3D.updateMatrices(),this.fly||c||(this.fly=!0,this.shouldLandWhenPossible=!0,this.shouldUnoccupyWaypointsOnceMoving=!0),e.copy(l),Object(Ae.k)(e,Math.PI,r),c?(t.setFromMatrixPosition(e),this.findPositionOnNavMesh(t,t,i,!0),r.setPosition(i),n.makeTranslation(0,ky(),-.15)):n.makeTranslation(0,1.6,-.15),r.multiply(n),d&&(a.extractRotation(this.avatarPOV.object3D.matrixWorld),s.setFromMatrixScale(r),o.setFromMatrixPosition(r),r.copy(a).scale(s).setPosition(o)),Object(Ae.b)(this.avatarPOV.object3D.matrixWorld,r,r),Object(Ae.d)(this.avatarRig.object3D,this.avatarPOV.object3D,r)}}()),Ay(this,"tick",function(){const e=new THREE.Matrix4,t=new THREE.Matrix4,i=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3,s=new THREE.Vector3,o=new THREE.Matrix4,r=new THREE.Matrix4,l=new THREE.Matrix4,c=new THREE.Vector3,d=new THREE.Vector3;return function(h,u){if(!this.scene.is("entered"))return;const p=this.scene.is("vr-mode");this.sfx=this.sfx||this.scene.systems["hubs-systems"].soundEffectsSystem,this.waypointSystem=this.waypointSystem||this.scene.systems["hubs-systems"].waypointSystem,!this.activeWaypoint&&this.waypoints.length&&(this.activeWaypoint=this.waypoints.splice(0,1)[0],this.isMotionDisabled=this.activeWaypoint.waypointComponentData.willDisableMotion,this.isTeleportingDisabled=this.activeWaypoint.waypointComponentData.willDisableTeleporting,this.avatarPOV.object3D.updateMatrices(),this.waypointTravelTime=p&&!My||this.activeWaypoint.isInstant?0:(new THREE.Vector3).setFromMatrixPosition(this.avatarPOV.object3D.matrixWorld).distanceTo(c.setFromMatrixPosition(this.activeWaypoint.transform))/50*1e3,Object(Ae.k)(this.avatarPOV.object3D.matrixWorld,Math.PI,o),o.multiply(l.makeTranslation(0,-1*ky(),-.15)),this.waypointTravelStartTime=h,!p&&this.waypointTravelTime>100&&this.sfx.playSoundOneShot(v.y));const m=0===this.waypointTravelTime||h>=this.waypointTravelStartTime+this.waypointTravelTime;if(this.activeWaypoint&&!m){const e=THREE.Math.clamp((h-this.waypointTravelStartTime)/this.waypointTravelTime,0,1);Object(Ae.j)(o,this.activeWaypoint.transform,Object(Sy.a)(e),r),this.travelByWaypoint(r,!1,this.activeWaypoint.waypointComponentData.willMaintainInitialOrientation)}var g;this.activeWaypoint&&(this.waypoints.length||m)&&(this.travelByWaypoint(this.activeWaypoint.transform,this.activeWaypoint.waypointComponentData.snapToNavMesh,this.activeWaypoint.waypointComponentData.willMaintainInitialOrientation),g=this.activeWaypoint.transform,Cy.push(g),this.activeWaypoint=null,(p||this.waypointTravelTime>0)&&this.sfx.playSoundOneShot(v.x));const f=AFRAME.scenes[0].systems.userinput,b=this.fly;f.get(ce.a.actions.toggleFly)&&(this.shouldLandWhenPossible=!1,this.avatarRig.messageDispatch.dispatch("/fly"));const y=b&&!this.fly;!this.fly&&this.shouldLandWhenPossible&&(this.shouldLandWhenPossible=!1),this.fly&&(this.navNode=null);const _=window.APP.store.state.preferences,w=f.get(ce.a.actions.snapRotateLeft),E=f.get(ce.a.actions.snapRotateRight);w&&(this.dXZ+=void 0===_.snapRotationDegrees?Ry:_.snapRotationDegrees*Math.PI/180),E&&(this.dXZ-=void 0===_.snapRotationDegrees?Ry:_.snapRotationDegrees*Math.PI/180),(w||E)&&this.scene.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(v.p);const x=f.get(ce.a.actions.characterAcceleration);if(x){const e=-1*x[1];this.relativeMotion.set(this.relativeMotion.x+(_.disableMovement||_.disableStrafing?0:x[0]),this.relativeMotion.y,this.relativeMotion.z+(_.disableMovement?0:_.disableBackwardsMovement?Math.min(0,e):e))}const S=p?0:.85;if(this.nextRelativeMotion.copy(this.relativeMotion).multiplyScalar(S),this.relativeMotion.multiplyScalar(1-S),this.avatarPOV.object3D.updateMatrices(),Object(Ae.k)(this.avatarPOV.object3D.matrixWorld,this.dXZ,e),t.copy(e),!this.isMotionDisabled){const o=d.setFromMatrixColumn(this.avatarPOV.object3D.matrixWorld,1).length(),r=this.relativeMotion.lengthSq()>1e-6;r&&(Ly(e,this.fly,this.relativeMotion.multiplyScalar((f.get(ce.a.actions.boost)?2:1)*Py*Math.sqrt(o)*u/1e3),i),t.makeTranslation(i.x,i.y,i.z).multiply(e));const l=y||this.shouldLandWhenPossible,c=l||r;let h=0;c&&(this.findPOVPositionAboveNavMesh(n.setFromMatrixPosition(this.avatarPOV.object3D.matrixWorld),a.setFromMatrixPosition(t),s,l),h=a.distanceToSquared(s),this.fly&&this.shouldLandWhenPossible&&h<.5&&!this.activeWaypoint?(this.shouldLandWhenPossible=!1,this.fly=!1,t.setPosition(s)):this.fly||t.setPosition(s)),!this.activeWaypoint&&this.shouldUnoccupyWaypointsOnceMoving&&r&&(this.shouldUnoccupyWaypointsOnceMoving=!1,this.waypointSystem.releaseAnyOccupiedWaypoints(),this.fly&&this.shouldLandWhenPossible&&c&&h<3&&(t.setPosition(s),this.shouldLandWhenPossible=!1,this.fly=!1))}Object(Ae.d)(this.avatarRig.object3D,this.avatarPOV.object3D,t),this.relativeMotion.copy(this.nextRelativeMotion),this.dXZ=0}}()),Ay(this,"findPOVPositionAboveNavMesh",function(){const e=new THREE.Vector3,t=new THREE.Vector3;return function(i,n,a,s){const o=ky(!0);return e.copy(i),e.y-=o,t.copy(n),t.y-=o,this.findPositionOnNavMesh(e,t,a,s),a.y+=o,a}}()),this.scene=e,this.fly=!1,this.shouldLandWhenPossible=!1,this.waypoints=[],this.waypointTravelStartTime=0,this.waypointTravelTime=0,this.navGroup=null,this.navNode=null,this.relativeMotion=new THREE.Vector3(0,0,0),this.nextRelativeMotion=new THREE.Vector3(0,0,0),this.dXZ=0,this.scene.addEventListener("nav-mesh-loaded",()=>{this.navGroup=null,this.navNode=null}),Object(ne.a)().then(()=>{this.avatarPOV=document.getElementById("avatar-pov-node"),this.avatarRig=document.getElementById("avatar-rig")})}enqueueWaypointTravelTo(e,t,i){this.waypoints.push({transform:(Cy.shift()||new THREE.Matrix4).copy(e),isInstant:t,waypointComponentData:i})}enqueueRelativeMotion(e){e.z*=-1,this.relativeMotion.add(e)}enqueueInPlaceRotationAroundWorldUp(e){this.dXZ+=e}getClosestNode(e){const t=this.scene.systems.nav.pathfinder;return t.zones[Ty].groups[this.navGroup]?t.getClosestNode(e,Ty,this.navGroup,!0)||t.getClosestNode(e,Ty,this.navGroup):null}findPositionOnNavMesh(e,t,i,n){const a=this.scene.systems.nav.pathfinder;if(Ty in a.zones)return this.navGroup=n||null===this.navGroup?a.getGroup(Ty,t,!0,!0):this.navGroup,this.navNode=n||null===this.navNode||void 0===this.navNode?this.getClosestNode(t):this.navNode,null===this.navNode||void 0===this.navNode?i.copy(t):this.navNode=a.clampStep(e,t,this.navNode,Ty,this.navGroup,i),i}}class Oy{constructor(){this.pairs=[]}register(e,t){this.pairs.push({object3D:e,path:t})}unregister(e){this.pairs=this.pairs.filter(t=>t.object3D!==e)}tick(){for(let e=0;e<this.pairs.length;e++){const t=AFRAME.scenes[0].systems.userinput.get(this.pairs[e].path);if(t){const i=this.pairs[e].object3D;i.matrix.copy(t),i.matrix.decompose(i.position,i.quaternion,i.scale),i.matrixIsModified=!0,i.matrixWorldNeedsUpdate=!0}}}}const Hy=.2;class jy{constructor(){!function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"tick",function(){const e=new THREE.Vector3;return function(){this.viewingCamera=this.viewingCamera||document.getElementById("viewing-camera");for(let t=0;t<this.components.length;t++){const i=this.components[t],n=Math.sqrt(Object(Ae.m)(i.el.object3D,this.viewingCamera.object3D));if(n<Hy)i.el.object3D.scale.set(1e-5,1e-6,1e-5);else{const t=i.el.object3D.parent;t.updateMatrices(),e.setFromMatrixScale(t.matrixWorld),i.el.object3D.scale.set(1/e.x*(i.data.baseScale.x+n*i.data.addedScale.x),1/e.y*(i.data.baseScale.y+n*i.data.addedScale.y),1/e.z*(i.data.baseScale.z+n*i.data.addedScale.z))}i.el.object3D.matrixNeedsUpdate=!0}}}()),this.components=[]}register(e){this.components.push(e)}unregister(e){this.components=this.components.filter(t=>t!==e)}}function Iy(e,t){e.setDistanceModel(t.mediaDistanceModel),e.setRolloffFactor(t.mediaRolloffFactor),e.setRefDistance(t.mediaRefDistance),e.setMaxDistance(t.mediaMaxDistance),e.panner.coneInnerAngle=t.mediaConeInnerAngle,e.panner.coneOuterAngle=t.mediaConeOuterAngle,e.panner.coneOuterGain=t.mediaConeOuterGain}function Ny(e,t){e.setDistanceModel(t.avatarDistanceModel),e.setRolloffFactor(t.avatarRolloffFactor),e.setRefDistance(t.avatarRefDistance),e.setMaxDistance(t.avatarMaxDistance)}class Fy{constructor(e){!function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"onSceneReset",()=>{this.updateAudioSettings(this.defaultSettings)}),this.sceneEl=e,this.defaultSettings={avatarDistanceModel:"inverse",avatarRolloffFactor:2,avatarRefDistance:1,avatarMaxDistance:1e4,mediaVolume:.5,mediaDistanceModel:"inverse",mediaRolloffFactor:1,mediaRefDistance:1,mediaMaxDistance:1e4,mediaConeInnerAngle:360,mediaConeOuterAngle:0,mediaConeOuterGain:0},this.audioSettings=this.defaultSettings,this.mediaAudioSources=[],this.avatarAudioSources=[],this.sceneEl.addEventListener("reset_scene",this.onSceneReset)}registerMediaAudioSource(e){this.mediaAudioSources.push(e),Iy(e,this.audioSettings)}unregisterMediaAudioSource(e){this.mediaAudioSources.splice(this.mediaAudioSources.indexOf(e,1))}registerAvatarAudioSource(e){this.avatarAudioSources.push(e),Ny(e,this.audioSettings)}unregisterAvatarAudioSource(e){this.avatarAudioSources.splice(this.avatarAudioSources.indexOf(e,1))}updateAudioSettings(e){this.audioSettings=Object.assign({},this.defaultSettings,e);for(const t of this.mediaAudioSources)Iy(t,e);for(const t of this.avatarAudioSources)Ny(t,e)}}AFRAME.registerComponent("audio-source",{schema:{type:{type:"string"}},init(){this.audioSource=null,"avatar"===this.data.type?(this.onSoundSourceSet=this.onSoundSourceSet.bind(this),this.el.addEventListener("sound-source-set",this.onSoundSourceSet)):"media"===this.data.type&&(this.onVideoLoaded=this.onVideoLoaded.bind(this),this.el.addEventListener("video-loaded",this.onVideoLoaded))},onSoundSourceSet(){const e=this.el.sceneEl.systems["hubs-systems"].audioSettingsSystem,t=this.el.components["networked-audio-source"];this.audioSource&&e.unregisterAvatarAudioSource(this.audioSource),t&&(this.audioSource=t.sound,e.registerAvatarAudioSource(this.audioSource))},onVideoLoaded(){const e=this.el.sceneEl.systems["hubs-systems"].audioSettingsSystem,t=this.el.components["media-video"];this.audioSource&&e.unregisterMediaAudioSource(this.audioSource),t&&(this.audioSource=t.audio,e.registerMediaAudioSource(this.audioSource))},remove(){if(!this.audioSource)return;const e=this.el.sceneEl.systems["hubs-systems"].audioSettingsSystem;"avatar"===this.data.type?(e.unregisterAvatarAudioSource(this.audioSource),this.el.removeEventListener("sound-source-set",this.onSoundSourceSet)):"media"===this.data.type&&(e.unregisterMediaAudioSource(this.audioSource),this.el.removeEventListener("video-loaded",this.onVideoLoaded))}}),AFRAME.registerSystem("hubs-systems",{init(){Object(ne.a)().then(()=>{this.DOMContentDidLoad=!0}),this.cursorTogglingSystem=new qv,this.interactionSfxSystem=new Nb,this.superSpawnerSystem=new fb,this.cursorTargettingSystem=new Zv,this.physicsSystem=new Xv(this.el.object3D),this.constraintsSystem=new Kv(this.physicsSystem),this.twoPointStretchingSystem=new ib,this.singleActionButtonSystem=new nb,this.holdableButtonSystem=new ab,this.hoverButtonSystem=new db,this.hoverMenuSystem=new gb,this.hapticFeedbackSystem=new _b,this.soundEffectsSystem=new v.z(this.el),this.scenePreviewCameraSystem=new Ib.a,this.spriteSystem=new py(this.el),this.batchManagerSystem=new jb(this.el.object3D,this.el.renderer),this.cameraSystem=new Ce.e(this.batchManagerSystem),this.drawingMenuSystem=new ub(this.el),this.characterController=new Dy(this.el),this.waypointSystem=new xy(this.el,this.characterController),this.cursorPoseTrackingSystem=new Oy,this.scaleInScreenSpaceSystem=new jy,this.audioSettingsSystem=new Fy(this.el)},tick(e,t){if(!this.DOMContentDidLoad)return;const i=AFRAME.scenes[0].systems;i.userinput.tick2(),i.interaction.tick2(),this.characterController.tick(e,t),this.cursorTogglingSystem.tick(i.interaction,i.userinput,this.el),this.interactionSfxSystem.tick(i.interaction,i.userinput,this.soundEffectsSystem),this.superSpawnerSystem.tick(),this.cursorPoseTrackingSystem.tick(),this.cursorTargettingSystem.tick(e),this.scaleInScreenSpaceSystem.tick(),this.constraintsSystem.tick(),this.twoPointStretchingSystem.tick(),this.singleActionButtonSystem.tick(),this.holdableButtonSystem.tick(),this.hoverButtonSystem.tick(),this.drawingMenuSystem.tick(),this.hoverMenuSystem.tick(),this.hapticFeedbackSystem.tick(this.twoPointStretchingSystem,this.singleActionButtonSystem.didInteractLeftThisFrame,this.singleActionButtonSystem.didInteractRightThisFrame),this.soundEffectsSystem.tick(),this.scenePreviewCameraSystem.tick(),this.physicsSystem.tick(t),this.spriteSystem.tick(e,t),this.batchManagerSystem.tick(e),this.cameraSystem.tick(this.el,t),this.waypointSystem.tick(e,t)},remove(){this.cursorTargettingSystem.remove()}}),AFRAME.registerSystem("capture-system",{init(){this._gotAudioTrack=!1,this._recorderTimeout=null},_initRecorder(){if(!this.available())return;this._stream=new MediaStream;const e=this.el.canvas.captureStream().getVideoTracks()[0];this._stream.addTrack(e),this._recorder=new MediaRecorder(this._stream,{mimeType:"video/webm; codecs=vp8"});const t=[];this._recorder.ondataavailable=e=>{t.push(e.data)},this._recorder.onstop=()=>{if(0===t.length)return;const e=t[0].type,i=new Blob(t,{type:e});t.length=0,this.el.emit("add_media",new File([i],"capture",{type:e}))}},available:()=>Object(Me.a)("video_capture")&&window.MediaRecorder&&MediaRecorder.isTypeSupported("video/webm; codecs=vp8"),started(){return this._recorder&&"inactive"!==this._recorder.state},_tryAddingAudioTrack(){if(this._gotAudioTrack||!this.el.audioListener)return;const e=this.el.audioListener,t=e.context.createMediaStreamDestination();e.getInput().connect(t);const i=t.stream.getAudioTracks()[0];this._stream.addTrack(i),this._gotAudioTrack=!0},start(){this._recorder||this._initRecorder(),this._tryAddingAudioTrack(),this.started()||(this._recorder.start(),this._recorderTimeout=setTimeout(()=>{this.started()&&this._recorder.stop()},15e3))},stop(){this.started()&&(clearTimeout(this._recorderTimeout),this._recorder.stop())}});i(1217),i(1218),i(377);var Vy=i(173);i(1219),i(1220),i(1221);AFRAME.registerComponent("scalable-when-grabbed",{tick:function(){const e=AFRAME.scenes[0].systems.userinput,t=AFRAME.scenes[0].systems.interaction;let i;t.state.rightRemote.held===this.el&&(i=e.get(ce.a.actions.cursor.right.scaleGrabbedGrabbable)),t.state.leftRemote.held===this.el&&(i=e.get(ce.a.actions.cursor.left.scaleGrabbedGrabbable)),i&&(this.el.object3D.scale.addScalar(i).clampScalar(.1,100),this.el.object3D.matrixNeedsUpdate=!0)}});i(1222),i(373),i(1223);const By=new THREE.Color(23/255,64/255,118/255),zy=new THREE.Color(190/255,190/255,190/255),Uy=new THREE.Color(150/255,80/255,150/255),Wy=new THREE.Color(23/255,64/255,118/255);AFRAME.registerComponent("cursor-controller",{schema:{cursor:{type:"selector"},camera:{type:"selector"},far:{default:100},near:{default:.01},defaultDistance:{default:4},minDistance:{default:.18}},init:function(){this.enabled=!1,this.data.cursor.addEventListener("loaded",()=>{this.data.cursor.object3DMap.mesh.renderOrder=window.APP.RENDER_ORDER.CURSOR},{once:!0}),this.intersection=null,this.raycaster=new THREE.Raycaster,this.raycaster.firstHitOnly=!0,this.distance=this.data.far,this.color=new THREE.Color(0,0,0);const e=new THREE.BufferGeometry;e.addAttribute("position",new THREE.BufferAttribute(new Float32Array(6),3)),this.line=new THREE.Line(e,new THREE.LineBasicMaterial({color:"white",opacity:.2,transparent:!0,visible:!1})),this.el.setObject3D("line",this.line)},update:function(){this.raycaster.far=this.data.far,this.raycaster.near=this.data.near},tick2:(()=>{const e=[],t=new THREE.Vector3,i=new THREE.Vector3;return function(n,a){const s=AFRAME.scenes[0].systems.userinput,o=s.get(a?ce.a.actions.cursor.left.pose:ce.a.actions.cursor.right.pose),r=s.get(a?ce.a.actions.cursor.left.hideLine:ce.a.actions.cursor.right.hideLine);if(this.data.cursor.object3D.visible=this.enabled&&!!o,this.line.material.visible=!(!this.enabled||r),this.intersection=null,!this.enabled||!o)return;this.el.sceneEl.systems["hubs-systems"].characterController.avatarPOV.object3D.updateMatrices();const l=i.setFromMatrixColumn(this.el.sceneEl.systems["hubs-systems"].characterController.avatarPOV.object3D.matrixWorld,1).length();this.raycaster.far=this.data.far*l,this.raycaster.near=this.data.near*l;const c=AFRAME.scenes[0].systems.interaction,d=a?!!c.state.leftRemote.held:!!c.state.rightRemote.held;d||(e.length=0,this.raycaster.ray.origin=o.position,this.raycaster.ray.direction=o.direction,this.raycaster.intersectObjects(AFRAME.scenes[0].systems["hubs-systems"].cursorTargettingSystem.targets,!0,e),this.intersection=e[0],this.intersectionIsValid=!!c.updateCursorIntersection(this.intersection,a),this.distance=this.intersectionIsValid?this.intersection.distance:this.data.defaultDistance*l);const{cursor:h,minDistance:u,far:p,camera:m}=this.data,g=s.get(a?ce.a.actions.cursor.left.modDelta:ce.a.actions.cursor.right.modDelta)||0;d&&!s.activeSets.includes(a?Gi.leftCursorHoldingUI:Gi.rightCursorHoldingUI)&&(this.distance=THREE.Math.clamp(this.distance-g,u,p*l)),h.object3D.position.copy(o.position).addScaledVector(o.direction,this.distance),Object(Ae.h)(m.object3D,t),t.y=h.object3D.position.y,h.object3D.lookAt(t),h.object3D.matrixNeedsUpdate=!0;const f=AFRAME.scenes[0].systems["transform-selected-object"];if(f.transforming&&(a&&"player-left-controller"===f.hand.el.id||!a&&"player-right-controller"===f.hand.el.id)?this.color.copy(Uy).lerpHSL(Wy,.5+.5*Math.sin(n/1e3)):this.intersectionIsValid||d?this.color.copy(By):this.color.copy(zy),this.data.cursor.object3DMap.mesh.material.color.equals(this.color)||(this.data.cursor.object3DMap.mesh.material.color.copy(this.color),this.data.cursor.object3DMap.mesh.material.needsUpdate=!0),this.line.material.visible){const e=o.position,t=h.object3D.position,i=this.line.geometry.attributes.position.array;i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=t.x,i[4]=t.y,i[5]=t.z,this.line.geometry.attributes.position.needsUpdate=!0,this.line.geometry.computeBoundingSphere()}}})()});i(1224);var Zy=i(97);const Gy={"player-right-controller":{startDrawing:ce.a.actions.rightHand.startDrawing,stopDrawing:ce.a.actions.rightHand.stopDrawing,undoDrawing:ce.a.actions.rightHand.undoDrawing,switchDrawMode:ce.a.actions.rightHand.switchDrawMode,penNextColor:ce.a.actions.rightHand.penNextColor,penPrevColor:ce.a.actions.rightHand.penPrevColor,scalePenTip:ce.a.actions.rightHand.scalePenTip},"player-left-controller":{startDrawing:ce.a.actions.leftHand.startDrawing,stopDrawing:ce.a.actions.leftHand.stopDrawing,undoDrawing:ce.a.actions.leftHand.undoDrawing,switchDrawMode:ce.a.actions.leftHand.switchDrawMode,penNextColor:ce.a.actions.leftHand.penNextColor,penPrevColor:ce.a.actions.leftHand.penPrevColor,scalePenTip:ce.a.actions.leftHand.scalePenTip},"right-cursor":{pose:ce.a.actions.cursor.right.pose,startDrawing:ce.a.actions.cursor.right.startDrawing,stopDrawing:ce.a.actions.cursor.right.stopDrawing,undoDrawing:ce.a.actions.cursor.right.undoDrawing,penNextColor:ce.a.actions.cursor.right.penNextColor,penPrevColor:ce.a.actions.cursor.right.penPrevColor,scalePenTip:ce.a.actions.cursor.right.scalePenTip},"left-cursor":{pose:ce.a.actions.cursor.left.pose,startDrawing:ce.a.actions.cursor.left.startDrawing,stopDrawing:ce.a.actions.cursor.left.stopDrawing,undoDrawing:ce.a.actions.cursor.left.undoDrawing,penNextColor:ce.a.actions.cursor.left.penNextColor,penPrevColor:ce.a.actions.cursor.left.penPrevColor,scalePenTip:ce.a.actions.cursor.left.scalePenTip}},qy=0,$y=1;function Yy(e,t,i){return Math.abs(t.x-i.x)<e&&Math.abs(t.y-i.y)<e&&Math.abs(t.z-i.z)<e}AFRAME.registerComponent("pen",{schema:{drawFrequency:{default:5},minDistanceBetweenPoints:{default:.01},camera:{type:"selector"},drawingManager:{type:"string"},color:{type:"color",default:"#FF0033"},availableColors:{default:["#FF0033","#FFFF00","#0099FF","#00FF33","#9900FF","#FF6600","#8D5524","#C68642","#E0AC69","#F1C27D","#FFDBAC","#FFFFFF","#222222","#111111","#000000"]},radius:{default:.01},minRadius:{default:.005},maxRadius:{default:.2},far:{default:100},near:{default:.01},drawMode:{default:qy,oneOf:[qy,$y]},penVisible:{default:!0},penTipPosition:{default:{x:0,y:0,z:0}}},init(){this.timeSinceLastDraw=0,this.lastPosition=new THREE.Vector3,this.lastPosition.copy(this.el.object3D.position),this.direction=new THREE.Vector3(1,0,0),this.currentDrawing=null,this.normal=new THREE.Vector3,this.worldPosition=new THREE.Vector3,this.colorIndex=0,this.grabbed=!1,this.raycaster=new THREE.Raycaster,this.raycaster.firstHitOnly=!0,this.originalPosition=this.el.object3D.position.clone(),this.lastIntersectionDistance=0,this.targets=[],this.setDirty=this.setDirty.bind(this),this.dirty=!0;let e=new THREE.MeshStandardMaterial;window.APP&&"low"===window.APP.quality&&(e=Zy.a.fromStandardMaterial(e)),this.penTip=new THREE.Mesh(new THREE.SphereBufferGeometry(1,16,12),e),this.penTip.scale.setScalar(this.data.radius/this.el.parentEl.object3D.scale.x),this.penTip.matrixNeedsUpdate=!0,this.el.setObject3D("mesh",this.penTip);const t=this.el.sceneEl.components["environment-map"];t&&t.applyEnvironmentMap(this.el.parentEl.object3D),this.penLaserAttributesUpdated=!1,this.penLaserAttributes={color:"#FF0033",laserVisible:!1,laserInHand:!1,laserOrigin:{x:0,y:0,z:0},remoteLaserOrigin:{x:0,y:0,z:0},laserTarget:{x:0,y:0,z:0}},this.observer=new MutationObserver(this.setDirty),Object(ne.a)().then(()=>{const e=document.querySelector("a-scene");this.observer.observe(e,{childList:!0,attributes:!0,subtree:!0}),e.addEventListener("object3dset",this.setDirty),e.addEventListener("object3dremove",this.setDirty)})},play(){this.drawingManager=document.querySelector(this.data.drawingManager).components["drawing-manager"]},update(e){e.color!=this.data.color&&(this.penTip.material.color.set(this.data.color),this.penLaserAttributes.color=this.data.color,this.el.setAttribute("pen-laser",{color:this.data.color})),e.radius!=this.data.radius&&this.el.setAttribute("radius",this.data.radius),this.raycaster.far=this.data.far,this.raycaster.near=this.data.near},tick(e,t){const i=this.el.parentEl.components.networked.initialized&&this.el.parentEl.components.networked.isMine();if(this.penTip.material.visible!==i&&(this.penTip.material.visible=i),i){this._handleInput();const e=this.data.drawMode!==$y||"right-cursor"!==this.grabberId&&"left-cursor"!==this.grabberId?null:AFRAME.scenes[0].systems.userinput.get(Gy[this.grabberId].pose),i=this._getIntersection(e);this._updatePenTip(i);const n=this.data.drawMode===$y&&!!i,a=this.el.sceneEl.is("vr-mode")&&n;this.penLaserAttributes.laserVisible!==n&&(this.penLaserAttributes.laserVisible=n,this.penLaserAttributesUpdated=!0),this.penLaserAttributes.laserInHand!==a&&(this.penLaserAttributes.laserInHand=a,this.penLaserAttributesUpdated=!0),n&&this._updateLaser(e,i);const s="left-cursor"!==this.grabberId&&"right-cursor"!==this.grabberId||!i;this._setPenVisible(s),this.el.setAttribute("pen",{penVisible:s}),this._doDraw(i,t),this.penLaserAttributesUpdated&&(this.penLaserAttributesUpdated=!1,this.el.setAttribute("pen-laser",this.penLaserAttributes,!0))}else this._setPenVisible(this.data.penVisible)},_handleInput(){const e=AFRAME.scenes[0].systems.userinput,t=AFRAME.scenes[0].systems.interaction;if(t.state.rightHand.held===this.el.parentNode?this.grabberId="player-right-controller":t.state.leftHand.held===this.el.parentNode?this.grabberId="player-left-controller":t.state.rightRemote.held===this.el.parentNode?(this.grabberId="right-cursor",this.data.drawMode=$y):t.state.leftRemote.held===this.el.parentNode?(this.grabberId="left-cursor",this.data.drawMode=$y):this.grabberId=null,this.grabberId&&Gy[this.grabberId]){const t=this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem,i=Gy[this.grabberId];e.get(i.startDrawing)&&(this._startDraw(),t.playSoundOneShot(v.j)),e.get(i.stopDrawing)&&(this._endDraw(),t.playSoundOneShot(v.k));const n=e.get(i.scalePenTip);n&&this._changeRadius(n),e.get(i.penNextColor)&&(this._changeColor(1),t.playSoundOneShot(v.i)),e.get(i.penPrevColor)&&(this._changeColor(-1),t.playSoundOneShot(v.i)),e.get(i.undoDrawing)&&(this._undoDraw(),t.playSoundOneShot(v.l)),i.switchDrawMode&&e.get(i.switchDrawMode)&&(this.data.drawMode=this.data.drawMode===qy?$y:qy)}},_getIntersection:(()=>{const e=[],t=new THREE.Quaternion;return function(i){return e.length=0,this.data.drawMode===$y&&(i?(this.raycaster.ray.origin.copy(i.position),this.raycaster.ray.direction.copy(i.direction)):null!==this.grabberId&&(Object(Ae.h)(this.el.parentEl.object3D,this.raycaster.ray.origin),Object(Ae.i)(this.el.parentEl.object3D,t),this.raycaster.ray.direction.set(0,-1,0),this.raycaster.ray.direction.applyQuaternion(t)),null!==this.grabberId)?(this.raycaster.intersectObjects(this.targets,!0,e),e[0]):null}})(),_updatePenTip(e){this.data.drawMode===$y&&e?(this.el.object3D.position.copy(e.point),this.el.parentEl.object3D.worldToLocal(this.el.object3D.position),this.el.object3D.matrixNeedsUpdate=!0,this.worldPosition.copy(e.point)):(this.el.object3D.position.copy(this.originalPosition),this.el.object3D.matrixNeedsUpdate=!0,Object(Ae.h)(this.el.object3D,this.worldPosition))},_updateLaser:(()=>{const e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Vector3;return function(a,s){a?e.copy(a.position):this.el.parentEl.object3D.getWorldPosition(e),t.copy(s.point),this.el.sceneEl.is("vr-mode")?n.copy(e):(this.data.camera.object3D.getWorldPosition(i),n.subVectors(t,i).normalize().multiplyScalar(.5),n.add(i)),Yy(.001,this.penLaserAttributes.laserOrigin,e)||(this.penLaserAttributes.laserOrigin.x=e.x,this.penLaserAttributes.laserOrigin.y=e.y,this.penLaserAttributes.laserOrigin.z=e.z,this.penLaserAttributesUpdated=!0),Yy(.001,this.penLaserAttributes.remoteLaserOrigin,n)||(this.penLaserAttributes.remoteLaserOrigin.x=n.x,this.penLaserAttributes.remoteLaserOrigin.y=n.y,this.penLaserAttributes.remoteLaserOrigin.z=n.z,this.penLaserAttributesUpdated=!0),Yy(.001,this.penLaserAttributes.laserTarget,t)||(this.penLaserAttributes.laserTarget.x=t.x,this.penLaserAttributes.laserTarget.y=t.y,this.penLaserAttributes.laserTarget.z=t.z,this.penLaserAttributesUpdated=!0)}})(),_doDraw(e,t){if(this.currentDrawing&&this.lastIntersectedObject!==(e?e.object:null)&&(!e||Math.abs(e.distance-this.lastIntersectionDistance)>1)&&(this.worldPosition.copy(this.lastPosition),this._endDraw()),this.lastIntersectionDistance=e?e.distance:0,this.lastIntersectedObject=e?e.object:null,Yy(.005,this.worldPosition,this.lastPosition)||(this.direction.subVectors(this.worldPosition,this.lastPosition).normalize(),this.lastPosition.copy(this.worldPosition)),this.currentDrawing){const e=this.timeSinceLastDraw+t;e>=this.data.drawFrequency&&this.currentDrawing.getLastPoint().distanceTo(this.worldPosition)>=this.data.minDistanceBetweenPoints&&(this._getNormal(this.normal,this.worldPosition,this.direction),this.currentDrawing.draw(this.worldPosition,this.direction,this.normal,this.data.color,this.data.radius)),this.timeSinceLastDraw=e%this.data.drawFrequency}this.currentDrawing&&!this.grabberId&&this._endDraw(),this.dirty&&(this.populateEntities(this.targets),this.dirty=!1)},_setPenVisible(e){this.el.parentEl.object3DMap.mesh&&this.el.parentEl.object3DMap.mesh.visible!==e&&(this.el.parentEl.object3DMap.mesh.visible=e)},_getNormal:(()=>{const e=new THREE.Vector3;return function(t,i,n){e.subVectors(i,this.data.camera.object3D.position).normalize(),t.crossVectors(n,e)}})(),_startDraw(){this.drawingManager.getDrawing(this).then(e=>{this.currentDrawing=e,this._getNormal(this.normal,this.worldPosition,this.direction),this.currentDrawing.startDraw(this.worldPosition,this.direction,this.normal,this.data.color,this.data.radius)})},_endDraw(){this.currentDrawing&&(this.timeSinceLastDraw=0,this._getNormal(this.normal,this.worldPosition,this.direction),this.currentDrawing.endDraw(this.worldPosition,this.direction,this.normal),this.drawingManager.returnDrawing(this),this.currentDrawing=null)},_undoDraw(){this.drawingManager.getDrawing(this).then(e=>{e.undoDraw(),this.drawingManager.returnDrawing(this)})},_changeColor(e){this.colorIndex=(this.colorIndex+e+this.data.availableColors.length)%this.data.availableColors.length,this.data.color=this.data.availableColors[this.colorIndex],this.penTip.material.color.set(this.data.color),this.penLaserAttributes.color=this.data.color,this.penLaserAttributesUpdated=!0},_changeRadius(e){this.data.radius=Math.max(this.data.minRadius,Math.min(this.data.radius+e,this.data.maxRadius)),this.penTip.scale.setScalar(this.data.radius/this.el.parentEl.object3D.scale.x),this.penTip.matrixNeedsUpdate=!0},setDirty(){this.dirty=!0},populateEntities(e){e.length=0;const t=AFRAME.scenes[0].querySelectorAll(".collidable, .interactable, #environment-root");for(let i=0;i<t.length;i++)!t[i].classList.contains("pen")&&t[i].object3D&&e.push(t[i].object3D)},remove(){this.observer.disconnect(),AFRAME.scenes[0].removeEventListener("object3dset",this.setDirty),AFRAME.scenes[0].removeEventListener("object3dremove",this.setDirty)}});const Xy=i(427);function Qy(e,t,i){return Math.abs(t.x-i.x)<e&&Math.abs(t.y-i.y)<e&&Math.abs(t.z-i.z)<e}AFRAME.registerComponent("pen-laser",{schema:{color:{type:"color",default:"#FF0033"},laserVisible:{default:!1},laserInHand:{default:!1},laserOrigin:{default:{x:0,y:0,z:0}},remoteLaserOrigin:{default:{x:0,y:0,z:0}},laserTarget:{default:{x:0,y:0,z:0}}},init(){let e=new THREE.MeshStandardMaterial({color:"red",opacity:.5,transparent:!0,visible:!0});window.APP&&"low"===window.APP.quality&&(e=Zy.a.fromStandardMaterial(e));const t=e.clone(),i=new THREE.LineCurve3(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,2)),n=new THREE.TubeBufferGeometry(i,2,.003,8,!0);this.laser=new THREE.Mesh(n,e),this.laserTip=new THREE.Mesh(new THREE.SphereBufferGeometry(1,8,6),t),this.laserTip.scale.setScalar(.01),this.laserTip.matrixNeedsUpdate=!0;const a=this.el.sceneEl.components["environment-map"];a&&(a.applyEnvironmentMap(this.laser),a.applyEnvironmentMap(this.laserTip)),this.laser.raycast=function(){},this.el.sceneEl.setObject3D(`pen-laser-${this.laser.uuid}`,this.laser),this.el.sceneEl.setObject3D(`pen-laser-tip-${this.laser.uuid}`,this.laserTip),this.originBuffer=new Xy(Xy.MODE_LERP,.1),this.targetBuffer=new Xy(Xy.MODE_LERP,.1)},update:(()=>{const e=new THREE.Vector3,t=new THREE.Vector3;return function(i){i.color!=this.data.color&&(this.laser.material.color.set(this.data.color),this.laserTip.material.color.set(this.data.color)),i.remoteLaserOrigin&&!Qy(.001,i.remoteLaserOrigin,this.data.remoteLaserOrigin)&&this.originBuffer.setPosition(e.set(this.data.remoteLaserOrigin.x,this.data.remoteLaserOrigin.y,this.data.remoteLaserOrigin.z)),i.laserTarget&&!Qy(.001,i.laserTarget,this.data.laserTarget)&&this.targetBuffer.setPosition(t.set(this.data.laserTarget.x,this.data.laserTarget.y,this.data.laserTarget.z))}})(),tick:(()=>{const e=new THREE.Vector3,t=new THREE.Vector3;return function(i,n){const a=this.el.parentEl.components.networked.initialized&&this.el.parentEl.components.networked.isMine();let s=!1;a&&this.data.laserVisible?(e.copy(this.data.laserOrigin),this.data.laserInHand||(e.y=e.y-.4),t.copy(this.data.laserTarget),s=!0):!a&&this.data.laserVisible&&(this.originBuffer.update(n),this.targetBuffer.update(n),e.copy(this.originBuffer.getPosition()),t.copy(this.targetBuffer.getPosition()),s=!0),s&&(this.laser.position.copy(e),this.laser.lookAt(t),this.laser.scale.set(1,1,e.distanceTo(t)),this.laser.matrixNeedsUpdate=!0,this.laserTip.position.copy(t),this.laserTip.matrixNeedsUpdate=!0),this.laser.material.visible!==s&&(this.laser.material.visible=s);const o=!!s&&!(a&&this.data.laserVisible);this.laserTip.material.visible!==o&&(this.laserTip.material.visible=o)}})(),remove(){this.el.sceneEl.removeObject3D(`pen-laser-${this.laser.uuid}`),this.el.sceneEl.removeObject3D(`pen-laser-tip-${this.laser.uuid}`)}});class Ky{constructor(e,t,i){this.material=e,this.primitiveMode=t,this.maxBufferSize=i,this.geometries=[],this.current=null,this.drawing=new THREE.Object3D,this.addBuffer()}restartPrimitive(){if(this.idx.position>=this.current.attributes.position.count)console.error("maxBufferSize limit exceeded");else if(0!==this.idx.position){let e=3*(this.idx.position-1);const t=this.current.attributes.position.array;this.addVertex(t[e++],t[e++],t[e++]),this.idx.color++,this.idx.normal++}}remove(e,t){if(this.idx.position>t.position)for(const i in this.idx){const n=3;let a=e[i]*n;const s=(t[i]+1)*n,o=this.idx[i]*n;for(let e=s;e<o;e++)this.current.attributes[i].array[a++]=this.current.attributes[i].array[e];const r=t[i]-e[i]+1;this.idx[i]-=r}else for(const i in this.idx){const n=t[i]-e[i];this.idx[i]-=n}this.update()}undo(e){this.idx=e,this.update()}addBuffer(){const e=new THREE.BufferGeometry,t=new Float32Array(3*this.maxBufferSize),i=new Float32Array(3*this.maxBufferSize),n=new Float32Array(3*this.maxBufferSize),a=new THREE.Mesh(e,this.material);a.drawMode=this.primitiveMode,a.frustumCulled=!1,a.vertices=t;const s=new THREE.Object3D;this.drawing.add(s),s.add(a),e.setDrawRange(0,0),e.addAttribute("position",new THREE.BufferAttribute(t,3).setDynamic(!0)),e.addAttribute("normal",new THREE.BufferAttribute(i,3).setDynamic(!0)),e.addAttribute("color",new THREE.BufferAttribute(n,3).setDynamic(!0)),this.previous=null,this.geometries.length>0&&(this.previous=this.current),this.idx={position:0,normal:0,color:0},this.geometries.push(e),this.current=e}addColor(e,t,i){this.current.attributes.color.setXYZ(this.idx.color++,e,t,i)}addNormal(e,t,i){this.current.attributes.normal.setXYZ(this.idx.normal++,e,t,i)}addVertex(e,t,i){const n=this.current.attributes.position;this.idx.position===n.count&&console.error("maxBufferSize limit exceeded"),n.setXYZ(this.idx.position++,e,t,i)}update(){this.current.setDrawRange(0,this.idx.position),this.current.attributes.color.needsUpdate=!0,this.current.attributes.normal.needsUpdate=!0,this.current.attributes.position.needsUpdate=!0}computeBoundingSpheres(){for(let e=0;e<this.geometries.length;e++)this.geometries[e].computeBoundingSphere()}}class Jy{constructor(){this.sharedBuffers={}}addSharedBuffer(e,t,i,n){this.sharedBuffers[e]=new Ky(t,i,n)}getSharedBuffer(e){return this.sharedBuffers[e]}}var e_=i(592);function t_(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function i_(e,t,i,n){let a=i-1,s=-1;for(;a+1<=n;)t[++s]=e[++a]}AFRAME.registerComponent("networked-drawing",{schema:{segments:{default:8},defaultRadius:{default:.01},maxDrawTimeout:{default:6e5},maxLines:{default:50},maxPointsPerLine:{default:250}},init(){this._receiveData=this._receiveData.bind(this),this.networkBuffer=[],this.sendNetworkBufferQueue=[],this.drawStarted=!1,this.lineStarted=!1,this.remoteLineStarted=!1,this.receivedBufferParts=0,this.bufferIndex=0,this.connectedToOwner=!1,this.networkBufferInitialized=!1;const e={vertexColors:THREE.VertexColors};this.color=new THREE.Color,this.radius=this.data.defaultRadius,this.segments=this.data.segments;let t=new THREE.MeshStandardMaterial(e);window.APP&&"low"===window.APP.quality&&(t=Zy.a.fromStandardMaterial(t)),this.sharedBufferGeometryManager=new Jy;const i=Math.round(20*this.data.maxPointsPerLine*(this.data.maxLines+1)*.333);this.sharedBufferGeometryManager.addSharedBuffer(0,t,THREE.TriangleStripDrawMode,i),this.lastPoint=new THREE.Vector3,this.lastSegments=[],this.currentSegments=[];for(let e=0;e<this.segments;e++)this.lastSegments[e]={position:new THREE.Vector3,normal:new THREE.Vector3},this.currentSegments[e]={position:new THREE.Vector3,normal:new THREE.Vector3};this.sharedBuffer=this.sharedBufferGeometryManager.getSharedBuffer(0),this.drawing=this.sharedBuffer.drawing,this.el.setObject3D("mesh",this.drawing);const n=this.el.sceneEl.components["environment-map"];n&&n.applyEnvironmentMap(this.drawing),this.prevIdx=Object.assign({},this.sharedBuffer.idx),this.idx=Object.assign({},this.sharedBuffer.idx),this.vertexCount=0,this.networkBufferCount=0,this.currentPointCount=0,this.invalidPointRead=!1,this.lastReadPointCount=0,this.networkBufferHistory=[],NAF.connection.onConnect(()=>{NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEl=e,this.networkId=NAF.utils.getNetworkId(this.networkedEl),this.drawingId="drawing-"+this.networkId,NAF.connection.subscribeToDataChannel(this.drawingId,this._receiveData)})})},play(){AFRAME.scenes[0].systems["hubs-systems"].drawingMenuSystem.registerDrawingMenu(this.el)},remove(){NAF.connection.unsubscribeToDataChannel(this.drawingId,this._receiveData),this.drawStarted=!1,this.el.removeObject3D("mesh"),this.el.sceneEl.querySelector("#drawing-manager").components["drawing-manager"].destroyDrawing(this),AFRAME.scenes[0].systems["hubs-systems"].drawingMenuSystem.unregisterDrawingMenu(this.el)},tick(e){const t=NAF.connection.isConnected()&&this.networkedEl,i=t&&NAF.utils.isMine(this.networkedEl);if(!this.connectedToOwner&&t){const e=NAF.utils.getNetworkOwner(this.networkedEl);!i&&NAF.connection.hasActiveDataChannel(e)&&(NAF.connection.sendDataGuaranteed(e,this.drawingId,{type:0,clientId:NAF.clientId}),this.connectedToOwner=!0)}if(this.networkBuffer.length>0&&t&&(i?this.bufferIndex<this.networkBuffer.length&&this._broadcastDrawing():this._drawFromNetwork()),i&&this.sendNetworkBufferQueue.length>0){const e=[];for(let t=0;t<this.sendNetworkBufferQueue.length;t++)NAF.connection.hasActiveDataChannel(this.sendNetworkBufferQueue[t])&&e.push(this.sendNetworkBufferQueue[t]);for(let t=0;t<e.length;t++){const i=this.sendNetworkBufferQueue.indexOf(e[t]);this._sendNetworkBuffer(e[t]),this.sendNetworkBufferQueue.splice(i,1)}}this._deleteExpiredLines(e)},serializeDrawing(){var e,t=this;return(e=function*(){const e=new e_.a,i=new THREE.MeshStandardMaterial({vertexColors:THREE.VertexColors}),n=t.convertToTriangles(t.sharedBuffer.current),a=new THREE.Mesh(n,i);a.userData.gltfExtensions={MOZ_hubs_components:{"networked-drawing-buffer":{buffer:t.networkBuffer}}};const s=yield new Promise(t=>{e.parseChunks(a,t,e=>{new Error(`Error serializing drawing. ${e}`)},{mode:"glb",includeCustomExtensions:!0})}),o=s.json;o.extensions||(o.extensions={}),o.extensions.MOZ_hubs_components={version:4},o.asset.generator="Mozilla Hubs Serialize Drawing";const r=yield new Promise((t,i)=>{e.createGLBBlob(s,t,e=>{i(new Error(`Error creating glb blob. ${e}`))})}),l=new File([r],"drawing.glb",{type:"model/gltf-binary"}),{entity:c}=Object(be.b)(l,"#interactable-media",Tt.a.FILE,"drawing",!1,!1),d=new THREE.Vector3(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),h=new THREE.Vector3(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),u=new THREE.Vector3,{start:p,count:m}=t.sharedBuffer.current.drawRange,g=t.sharedBuffer.current.attributes.position;for(let e=p;e<m;e++)u.set(g.getX(e),g.getY(e),g.getZ(e)),d.min(u),h.max(u);c.object3D.position.addVectors(d,h).multiplyScalar(.5),c.object3D.matrixNeedsUpdate=!0},function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){t_(s,n,a,o,r,"next",e)}function r(e){t_(s,n,a,o,r,"throw",e)}o(void 0)})})()},convertToTriangles(e){const t=new THREE.BufferGeometry,{start:i,count:n}=e.drawRange,a=e.getAttribute("position"),s=e.getAttribute("color"),o=e.getAttribute("normal"),r=3*n,l=new Float32Array(r),c=new Float32Array(r),d=new Float32Array(r),h=[];let u=0,p=0;const m=e=>{c[u]=s.getX(e),d[u]=o.getX(e),l[u]=a.getX(e),c[++u]=s.getY(e),d[u]=o.getY(e),l[u]=a.getY(e),c[++u]=s.getZ(e),d[u]=o.getZ(e),l[u]=a.getZ(e),u++};for(let e=i;e<n-2;e++){const t=e+1+p,i=e+2-p;0===e?(m(e),m(t),m(i)):m(t>i?t:i),h.push(e,t,i),p=(p+1)%2}return t.addAttribute("position",new THREE.BufferAttribute(l,3)),t.addAttribute("color",new THREE.BufferAttribute(c,3)),t.addAttribute("normal",new THREE.BufferAttribute(d,3)),t.setIndex(h),t},deserializeDrawing:(()=>{const e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3;return function(n){let a=n[0];for("-"===a&&(this._undoDraw(),n.shift(),a=n[0]);null!=a&&n.length>=11;)e.set(n[1],n[2],n[3]),t.set(n[4],n[5],n[6]),this.radius=Math.round(1e3*t.length())/1e3,t.normalize(),i.set(n[7],n[8],n[9]),this.color.setHex(Math.round(i.length())-1),i.normalize(),n.splice(0,10),this.drawStarted?null!==n[0]&&this.draw(e,t,i):this.startDraw(e,t,i),null===n[0]&&(this.endDraw(e,t,i),n.shift())}})(),_broadcastDrawing:(()=>{const e=[];return function(){e.length=0,i_(this.networkBuffer,e,this.bufferIndex,this.networkBuffer.length-1);let t=-1;for(;-1!=(t=this.networkBuffer.indexOf("-"));)this.networkBuffer.splice(t,1);this.bufferIndex=this.networkBuffer.length,NAF.connection.broadcastDataGuaranteed(this.drawingId,{type:1,buffer:e})}})(),_drawFromNetwork:(()=>{const e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3;return function(){let n=this.networkBuffer[0];"-"===n&&(this._undoDraw(),this.networkBuffer.shift(),n=this.networkBuffer[0]);let a=!1;for(;null!=n&&this.networkBuffer.length>=11;){const n=this.networkBuffer[0];n!==this.lastReadPointCount+1&&(this.invalidPointRead=!0,console.error(`Draw networking error: ID ${this.drawingId} expected point ${this.lastReadPointCount+1} but received ${n}`)),this.lastReadPointCount=n,e.set(this.networkBuffer[1],this.networkBuffer[2],this.networkBuffer[3]),t.set(this.networkBuffer[4],this.networkBuffer[5],this.networkBuffer[6]),this.radius=Math.round(1e3*t.length())/1e3,t.normalize(),i.set(this.networkBuffer[7],this.networkBuffer[8],this.networkBuffer[9]),this.color.setHex(Math.round(i.length())-1),i.normalize(),this.networkBuffer.splice(0,10),this.remoteLineStarted||(this.startDraw(e,t,i),this.remoteLineStarted=!0),null===this.networkBuffer[0]?(this.invalidPointRead||this._endDraw(e,t,i),this.remoteLineStarted=!1,this.networkBuffer.shift(),this.lastReadPointCount=0,this.invalidPointRead=!1):this.invalidPointRead||(this._draw(e,t,i),a=!0)}a&&this._updateBuffer()}})(),_deleteExpiredLines(e){const t=this.networkBufferHistory.length;if(t>0){const i=this.networkBufferHistory[0].time;if(t>this.data.maxLines||i+this.data.maxDrawTimeout<=e){const e=this.networkBufferHistory[0];t>1&&(e.idxLength+=2-this.segments%2,this.networkBufferHistory[1].idxLength-=2-this.segments%2),this.idx.position=e.idxLength,this.idx.uv=e.idxLength,this.idx.normal=e.idxLength,this.idx.color=e.idxLength,this.sharedBuffer.remove(this.prevIdx,this.idx),this.networkBufferHistory.shift(),this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&(this.networkBuffer.splice(0,e.networkBufferCount),this.bufferIndex-=e.networkBufferCount)}}},_sendNetworkBuffer:(()=>{const e=[];return function(t){if(NAF.utils.isMine(this.networkedEl))if(this.networkBuffer.length<=3e3)NAF.connection.sendDataGuaranteed(t,this.drawingId,{type:2,parts:1,buffer:this.networkBuffer});else{let i=0,n=0;for(;n<this.networkBuffer.length;)n=Math.min(n+3e3,this.networkBuffer.length),e.length=0,i_(this.networkBuffer,e,i,n-1),i=n,NAF.connection.sendDataGuaranteed(t,this.drawingId,{type:2,parts:Math.ceil(this.networkBuffer.length/3e3),buffer:e})}}})(),_receiveData(e,t,i){switch(i.type){case 0:this.sendNetworkBufferQueue.push(i.clientId);break;case 1:this.networkBufferInitialized&&this.networkBuffer.push.apply(this.networkBuffer,i.buffer);break;case 2:this.networkBuffer.push.apply(this.networkBuffer,i.buffer),++this.receivedBufferParts>=i.parts&&(this.networkBufferInitialized=!0)}},getLastPoint(){return this.lastPoint},startDraw(e,t,i,n,a){NAF.connection.isConnected()&&(this.drawStarted=!0,n&&this.color.set(n),a&&(this.radius=a),this.lastPoint.copy(e),this._addToNetworkBuffer(e,t,i))},draw(e,t,i,n,a){NAF.connection.isConnected()&&this.drawStarted&&(n&&n!="#"+this.color.getHexString().toUpperCase()&&this.color.set(n),a&&(this.radius=a),this._addToNetworkBuffer(e,t,i),this._draw(e,t,i),this._updateBuffer())},_draw:(()=>{const e=new THREE.Vector3;return function(t,i,n,a=1){if(this.lineStarted)this._generateSegments(this.currentSegments,t,i,n,this.radius*a),this._drawCylinder(),this.currentPointCount>this.data.maxPointsPerLine&&(this._drawEndCap(t,i),this._endLine());else{this._generateSegments(this.lastSegments,t,i,n,this.radius*a),0===this.networkBufferHistory.length?this._addDegenerateTriangle():(this._restartPrimitive(),this._addDegenerateTriangle(),this.segments%2==0&&this._addDegenerateTriangle()),e.copy(i).negate();for(let t=0;t<this.segments;t++)this.lastSegments[t].normal.add(e).multiplyScalar(.5);this._drawCap(this.lastPoint,this.lastSegments,e),this.segments%2!=0&&this._addDegenerateTriangle(),this.lineStarted=!0}this.lastPoint.copy(t)}})(),undoDraw(){NAF.connection.isConnected()&&!this.drawStarted&&(this._undoDraw(),this._pushToNetworkBuffer("-"))},_undoDraw(){const e=this.networkBufferHistory.length;if(e>0){const t=this.networkBufferHistory.pop();this.idx.position=0,this.idx.uv=0,this.idx.normal=0,this.idx.color=0,e>1&&(t.idxLength+=1-this.segments%2,this.idx.position=this.sharedBuffer.idx.position-t.idxLength,this.idx.uv=this.sharedBuffer.idx.uv-t.idxLength,this.idx.normal=this.sharedBuffer.idx.normal-t.idxLength,this.idx.color=this.sharedBuffer.idx.color-t.idxLength),this.sharedBuffer.remove(this.idx,this.sharedBuffer.idx),this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&(this.networkBuffer.splice(this.networkBuffer.length-t.networkBufferCount,t.networkBufferCount),this.bufferIndex-=t.networkBufferCount)}},endDraw(e,t,i){this._endDraw(e,t,i),this._updateBuffer()},_endDraw(e,t,i){!this.lineStarted&&this.drawStarted?this._drawPoint(e):this.lineStarted&&this.drawStarted&&(this._addToNetworkBuffer(e,t,i),this._draw(e,t,i),this._drawEndCap(e,t)),this._endLine()},_drawEndCap:(()=>{const e=new THREE.Vector3,t=new THREE.Vector3;return function(i,n){this.lineStarted&&this.drawStarted&&(e.copy(n).multiplyScalar(this.radius),t.copy(i).add(e),this._addDegenerateTriangle(),this._drawCap(t,this.lastSegments,n))}})(),_endLine(){if(!this.drawStarted)return;this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&this._pushToNetworkBuffer(null);const e={networkBufferCount:this.networkBufferCount,idxLength:this.vertexCount-1,time:1e3*this.el.sceneEl.clock.elapsedTime};this.networkBufferHistory.push(e),this.vertexCount=0,this.networkBufferCount=0,this.currentPointCount=0,this.lineStarted=!1,this.drawStarted=!1,this.sharedBuffer.computeBoundingSpheres()},_addToNetworkBuffer:(()=>{const e=new THREE.Vector3,t=new THREE.Vector3;return function(i,n,a){this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&(++this.currentPointCount,this._pushToNetworkBuffer(this.currentPointCount),this._pushToNetworkBuffer(i.x),this._pushToNetworkBuffer(i.y),this._pushToNetworkBuffer(i.z),e.copy(n),e.setLength(this.radius),this._pushToNetworkBuffer(e.x),this._pushToNetworkBuffer(e.y),this._pushToNetworkBuffer(e.z),t.copy(a),t.setLength(this.color.getHex()+1),this._pushToNetworkBuffer(t.x),this._pushToNetworkBuffer(t.y),this._pushToNetworkBuffer(t.z))}})(),_pushToNetworkBuffer(e){"-"!==e&&++this.networkBufferCount,this.networkBuffer.push(e)},_drawCylinder(){for(let e=0;e<this.segments;e++)this.currentSegments[e].normal.add(this.lastSegments[e].normal).multiplyScalar(.5);for(let e=0;e!=this.segments+1;e++)this._addVertex(this.lastSegments[e%this.segments]),this._addVertex(this.currentSegments[e%this.segments]);for(let e=0;e<this.segments;e++)this.lastSegments[e].position.copy(this.currentSegments[e].position),this.lastSegments[e].normal.copy(this.currentSegments[e].normal)},_drawPoint:(()=>{const e=new THREE.Vector3(0,1,0),t=new THREE.Vector3(0,-1,0),i=new THREE.Vector3(1,0,0),n=new THREE.Vector3,a=new THREE.Vector3;return function(s){n.copy(e).multiplyScalar(.75*this.radius),a.copy(s).add(n),this.lastPoint.copy(a),n.copy(e).multiplyScalar(.5*this.radius),a.copy(s).add(n),this._draw(a,t,i,.75),this._draw(s,t,i),n.copy(t).multiplyScalar(.5*this.radius),a.copy(s).add(n),this._draw(a,t,i,.75),n.copy(t).multiplyScalar(.75*this.radius),a.copy(s).add(n),this._addDegenerateTriangle(),this._drawCap(a,this.lastSegments,t)}})(),_drawCap(e,t,i){let n=0;for(let a=0;a<2*this.segments-this.segments%2;a++)(a-2)%4==0?this._addVertex({position:e,normal:i}):(this._addVertex(t[n%this.segments]),(a+1)%5!=0&&++n)},_restartPrimitive(){this.sharedBuffer.restartPrimitive(),++this.vertexCount},_updateBuffer(){this.sharedBuffer.update()},_addVertex(e){const t=e.position,i=e.normal;this.sharedBuffer.addVertex(t.x,t.y,t.z),this.sharedBuffer.addColor(this.color.r,this.color.g,this.color.b),i?this.sharedBuffer.addNormal(i.x,i.y,i.z):++this.sharedBuffer.idx.normal,++this.sharedBuffer.idx.uv,++this.vertexCount},_addDegenerateTriangle(){this._addVertex(this.lastSegments[0])},_generateSegments(e,t,i,n,a){const s=2*Math.PI/this.segments;for(let o=0;o<this.segments;o++){const r=e[o].position;this._rotatePointAroundAxis(r,t,i,n,s*o,a),e[o].normal.subVectors(r,t).normalize()}},_rotatePointAroundAxis:(()=>{const e=new THREE.Vector3;return function(t,i,n,a,s,o){e.copy(a),e.applyAxisAngle(n,s),t.copy(i).add(e.normalize().multiplyScalar(o))}})()}),AFRAME.registerComponent("networked-drawing-buffer",{schema:{buffer:{default:[]}},play(){const e=this._getDeserializeButton(this.el.parentEl);e&&(e.object3D.visible=!0,e.components["deserialize-drawing-button"].networkedDrawingBuffer=this)},_getDeserializeButton(e){return e.classList.contains("interactable")?e.querySelector(".deserialize-drawing"):e.parentEl?this._getDeserializeButton(e.parentEl):null}}),AFRAME.registerComponent("deserialize-drawing-button",{init(){const e=this.el.sceneEl.querySelector("#drawing-manager").components["drawing-manager"];this.networkedDrawingBuffer=null,this.onClick=()=>{if(!NAF.utils.isMine(this.targetEl)&&!NAF.utils.takeOwnership(this.targetEl))return;const t=()=>{e.drawing.deserializeDrawing(this.networkedDrawingBuffer.data.buffer),Object(be.c)(e.drawing.el.object3DMap.mesh,{x:.001,y:.001,z:.001}),this.targetEl.components.pinnable&&this.targetEl.components.pinnable.data.pinned&&this.targetEl.setAttribute("pinnable","pinned",!1),this.targetEl.parentEl.removeChild(this.targetEl),this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(v.j)};e.drawing?e.drawing.serializeDrawing().then(()=>{e.drawing.el.parentEl.removeChild(e.drawing.el),e.destroyDrawing(),e.createDrawing().then(t)}):e.createDrawing().then(t)},this._updateUI=this._updateUI.bind(this),this._updateUIOnStateChange=this._updateUIOnStateChange.bind(this),this.el.sceneEl.addEventListener("stateadded",this._updateUIOnStateChange),this.el.sceneEl.addEventListener("stateremoved",this._updateUIOnStateChange),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e,this._updateUI(),this.targetEl.addEventListener("pinned",this._updateUI),this.targetEl.addEventListener("unpinned",this._updateUI)})},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)},remove(){this.el.sceneEl.removeEventListener("stateadded",this._updateUIOnStateChange),this.el.sceneEl.removeEventListener("stateremoved",this._updateUIOnStateChange),this.targetEl&&(this.targetEl.removeEventListener("pinned",this._updateUI),this.targetEl.removeEventListener("unpinned",this._updateUI))},_updateUIOnStateChange(e){"frozen"===e.detail&&this._updateUI()},_updateUI(){if(this.networkedDrawingBuffer){const e=this.targetEl.components.pinnable&&this.targetEl.components.pinnable.data.pinned,t=window.APP.hubChannel.can("pin_objects")&&window.APP.hubChannel.signedIn;this.el.object3D.visible=(!e||t)&&window.APP.hubChannel.can("spawn_drawing")}else this.el.object3D.visible=!1}});i(1225);const n_=[$.ACTIVATION_STATE.ACTIVE_TAG,$.ACTIVATION_STATE.ISLAND_SLEEPING,$.ACTIVATION_STATE.WANTS_DEACTIVATION,$.ACTIVATION_STATE.DISABLE_DEACTIVATION,$.ACTIVATION_STATE.DISABLE_SIMULATION];AFRAME.registerComponent("body-helper",{schema:{loadedEvent:{default:""},mass:{default:1},gravity:{type:"vec3",default:{x:0,y:-9.8,z:0}},linearDamping:{default:.01},angularDamping:{default:.01},linearSleepingThreshold:{default:1.6},angularSleepingThreshold:{default:2.5},angularFactor:{type:"vec3",default:{x:1,y:1,z:1}},activationState:{default:$.ACTIVATION_STATE.ACTIVE_TAG,oneOf:n_},type:{default:"dynamic",oneOf:[$.TYPE.STATIC,$.TYPE.DYNAMIC,$.TYPE.KINEMATIC]},emitCollisionEvents:{default:!1},disableCollision:{default:!1},collisionFilterGroup:{default:1},collisionFilterMask:{default:1},scaleAutoUpdate:{default:!0}},init:function(){this.system=this.el.sceneEl.systems["hubs-systems"].physicsSystem,this.alive=!0,this.system.registerBodyHelper(this)},init2:function(){this.body=new $v.a(this.data,this.el.object3D,this.system.world),this.system.addBody(this.body)},update:function(e){null!==e&&this.body&&this.body.update(this.data)},remove:function(){this.body&&(this.system.removeBody(this.body),this.body.destroy(),this.body=null),this.alive=!1}});var a_=i(378);AFRAME.registerComponent("shape-helper",{schema:{type:{default:$.SHAPE.HULL,oneOf:[$.SHAPE.BOX,$.SHAPE.CYLINDER,$.SHAPE.SPHERE,$.SHAPE.CAPSULE,$.SHAPE.CONE,$.SHAPE.HULL,$.SHAPE.HACD,$.SHAPE.VHACD,$.SHAPE.MESH,$.SHAPE.HEIGHTFIELD]},fit:{default:$.FIT.ALL,oneOf:[$.FIT.ALL,$.FIT.MANUAL]},halfExtents:{type:"vec3",default:{x:1,y:1,z:1}},minHalfExtent:{default:0},maxHalfExtent:{default:Number.POSITIVE_INFINITY},sphereRadius:{default:NaN},cylinderAxis:{default:"y",oneOf:["x","y","z"]},margin:{default:.01},offset:{type:"vec3",default:{x:0,y:0,z:0}},orientation:{type:"vec4",default:{x:0,y:0,z:0,w:1}},heightfieldData:{default:[]},heightfieldDistance:{default:1},includeInvisible:{default:!1}},multiple:!0,init:function(){this.system=this.el.sceneEl.systems["hubs-systems"].physicsSystem,this.alive=!0,this.system.registerShapeHelper(this)},init2:function(){this.mesh=null;let e=this.el;for(this.bodyHelper=e.components["body-helper"]||null;!this.bodyHelper&&e.parentNode!=this.el.sceneEl;)(e=e.parentNode).components["body-helper"]&&(this.bodyHelper=e.components["body-helper"]);if(this.bodyHelper&&this.bodyHelper.body){if(this.data.fit!==$.FIT.MANUAL){if(!this.el.object3DMap.mesh)return void console.error("Cannot use FIT.ALL without object3DMap.mesh");this.mesh=this.el.object3DMap.mesh,this.mesh.updateMatrices()}this.shapes=a_.createCollisionShapes(this.mesh,this.data);for(let e=0;e<this.shapes.length;e++)this.bodyHelper.body.addShape(this.shapes[e])}else console.warn("body not found")},remove:function(){if(this.shapes)for(let e=0;e<this.shapes.length;e++)this.bodyHelper.body&&this.bodyHelper.body.removeShape(this.shapes[e]),this.shapes[e].destroy(),Ammo.destroy(this.shapes[e].localTransform);this.shapes=null,this.alive=!1}});var s_=function(){const e=e=>()=>{let t=null;return i=>null===t?(t=new THREE.Vector3(i.x,i.y,i.z),!0):!NAF.utils.almostEqualVec3(t,i,e)&&(t.copy(i),!0)};NAF.schemas.add({template:"#remote-avatar",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},{component:"scale",requiresNetworkUpdate:e(.001)},"player-info","networked-avatar",{selector:".camera",component:"position",requiresNetworkUpdate:e(.001)},{selector:".camera",component:"rotation",requiresNetworkUpdate:e(.5)},{selector:".left-controller",component:"position",requiresNetworkUpdate:e(.001)},{selector:".left-controller",component:"rotation",requiresNetworkUpdate:e(.5)},{selector:".left-controller",component:"visible"},{selector:".right-controller",component:"position",requiresNetworkUpdate:e(.001)},{selector:".right-controller",component:"rotation",requiresNetworkUpdate:e(.5)},{selector:".right-controller",component:"visible"}]}),NAF.schemas.add({template:"#interactable-media",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},{component:"scale",requiresNetworkUpdate:e(.001)},"media-loader",{component:"media-video",property:"time"},{component:"media-video",property:"videoPaused"},{component:"media-pdf",property:"index"},"pinnable"],nonAuthorizedComponents:[{component:"media-video",property:"time"},{component:"media-video",property:"videoPaused"},{component:"media-pager",property:"index"}]}),NAF.schemas.add({template:"#interactable-emoji-media",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},{component:"emoji",property:"emitEndTime"},{component:"emoji",property:"particleEmitterConfig"},{component:"scale",requiresNetworkUpdate:e(.001)},"media-loader","pinnable",{selector:".particle-emitter",component:"particle-emitter"}]}),NAF.schemas.add({template:"#static-media",components:["media-loader",{component:"media-video",property:"time"}],nonAuthorizedComponents:[{component:"media-video",property:"time"}]}),NAF.schemas.add({template:"#static-controlled-media",components:["media-loader",{component:"media-video",property:"time"},{component:"media-video",property:"videoPaused"},{component:"media-pdf",property:"index"}],nonAuthorizedComponents:[{component:"media-video",property:"time"},{component:"media-video",property:"videoPaused"},{component:"media-pager",property:"index"}]}),NAF.schemas.add({template:"#interactable-drawing",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},{component:"scale",requiresNetworkUpdate:e(.001)},"networked-drawing"]}),NAF.schemas.add({template:"#interactable-camera",components:["position","rotation",{component:"camera-tool",property:"isSnapping"},{component:"camera-tool",property:"isRecording"},{component:"camera-tool",property:"label"}]}),NAF.schemas.add({template:"#template-waypoint-avatar",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},{component:"scale",requiresNetworkUpdate:e(.001)},"waypoint"],nonAuthorizedComponents:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},{component:"scale",requiresNetworkUpdate:e(.001)},"waypoint"]}),NAF.schemas.add({template:"#interactable-pen",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},{component:"scale",requiresNetworkUpdate:e(.001)},{selector:"#pen",component:"pen",property:"radius"},{selector:"#pen",component:"pen",property:"color"},{selector:"#pen",component:"pen",property:"drawMode"},{selector:"#pen",component:"pen",property:"penVisible"},{selector:"#pen",component:"pen-laser",property:"laserVisible"},{selector:"#pen",component:"pen-laser",property:"remoteLaserOrigin",requiresNetworkUpdate:e(.001)},{selector:"#pen",component:"pen-laser",property:"laserTarget",requiresNetworkUpdate:e(.001)}]})},o_=i(64);function r_(e,t,i,n,a,s,o){try{var r=e[s](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,a)}function l_(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function o(e){r_(s,n,a,o,r,"next",e)}function r(e){r_(s,n,a,o,r,"throw",e)}o(void 0)})}}function c_(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),n.forEach(function(t){d_(e,t,i[t])})}return e}function d_(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}console.log(`App version: ${{NODE_ENV:"production",SHORTLINK_DOMAIN:"hub.link",RETICULUM_SERVER:"dev.reticulum.io",THUMBNAIL_SERVER:"nearspark-dev.reticulum.io",CORS_PROXY_SERVER:"cors-proxy-dev.reticulum.io",NON_CORS_PROXY_DOMAINS:"hubs.local,dev.reticulum.io",BASE_ASSETS_PATH:"/custom-hubs-template/"}.BUILD_VERSION||"?"}`),Object(c.a)(),window.APP=new Vy.a,window.APP.RENDER_ORDER={HUD_BACKGROUND:1,HUD_ICONS:2,CURSOR:3};const h_=window.APP.store,u_=window.APP.mediaSearchStore,p_=new URLSearchParams(location.search),m_=AFRAME.utils.device.isMobile(),g_=AFRAME.utils.device.isMobileVR(),f_=window.self!==window.top;if(f_&&!p_.get("embed_token"))throw new Error("no embed token");THREE.Object3D.DefaultMatrixAutoUpdate=!1,window.APP.quality="low"===window.APP.store.state.preferences.materialQualitySetting?"low":"high"===window.APP.store.state.preferences.materialQualitySetting?"high":m_||g_?"low":"high";NAF.options.firstSyncSource="phx-reliable",NAF.options.syncSource="phx-reliable";const v_=Object(Me.a)("bot"),b_=Object(Me.a)("disable_telemetry"),y_=Object(Me.a)("debug");v_||b_||Object(o_.a)("/hub","Room Landing Page"),Object(Xh.a)(),function(e="global"){const t=`___concurrent_load_detector_${e}`;localStorage.setItem(t,JSON.stringify({started_at:new Date}));const i=e=>{e.key===t&&(window.dispatchEvent(new CustomEvent("concurrentload")),window.removeEventListener("storage",i))};window.addEventListener("storage",i)}();let __={},w_=document.location.pathname.split("/").slice(0,2).join("/");document.location.pathname.includes("hub.html")&&(w_="/");const E_="/"===w_?Object(Ji.c)():Object(Ji.a)({basename:w_});window.APP.history=E_;const x_=p_.get("vr_entry_type");function S_(e){!function(e={}){const t=document.querySelector("a-scene"),i=Object(Me.a)("allow_idle")||!1,n=t&&(t.systems.userinput.activeSets.includes(Gi.rightCursorHoldingPen)||t.systems.userinput.activeSets.includes(Gi.leftCursorHoldingPen)),a=t&&!!t.systems["camera-tools"].getMyCamera(),s=x_;$i.a.render(Xi.a.createElement(Qi.a,{history:E_},Xi.a.createElement(Ki.a,{render:o=>Xi.a.createElement(Oh,c_({scene:t,isBotMode:v_,disableAutoExitOnIdle:i,forcedVREntryType:s,store:h_,mediaSearchStore:u_,isCursorHoldingPen:n,hasActiveCamera:a},e,o))})),document.getElementById("ui-root"))}(__=c_({},__,e))}function C_(e){return k_.apply(this,arguments)}function k_(){return(k_=l_(function*(e){S_({hubId:e.hub_id,hubName:e.name,hubDescription:e.description,hubMemberPermissions:e.member_permissions,hubAllowPromotion:e.allow_promotion,hubScene:e.scene,hubEntryCode:e.entry_code})})).apply(this,arguments)}function A_(e,t){return T_.apply(this,arguments)}function T_(){return(T_=l_(function*(e,t){let i,n;const a=()=>{S_({roomUnavailableReason:"scene_error"}),t.exitScene()},s=document.querySelector("#environment-scene"),o=document.querySelector("a-scene");if(e.scene)n=!1,i=e.scene.model_url;else if(null===e.scene)i=l.a;else{const t=e.topics[0],a=t.assets.find(e=>"glb"===e.asset_type),s=t.assets.find(e=>"gltf_bundle"===e.asset_type);i=(a||s).src||l.a;const o=/\.gltf/i.test(i)||/\.glb/i.test(i);n=!(a||o)}if(n){const e=yield fetch(i),t=yield e.json(),n=new URL(THREE.LoaderUtils.extractUrlBase(i),window.location.href);i=new URL(t.assets[0].src,n).href}else i=Object(Ne.i)(i);console.log(`Scene URL: ${i}`);let r=null;if(0===s.childNodes.length){const e=document.createElement("a-entity");e.addEventListener("model-loaded",()=>{e.removeEventListener("model-error",a),document.querySelector(".a-canvas").classList.remove("a-hidden"),o.addState("visible"),Jh(e)},{once:!0}),e.addEventListener("model-error",a,{once:!0}),e.setAttribute("gltf-model-plus",{src:i,useCache:!1,inflate:!0}),s.appendChild(e)}else{r=s.childNodes[0],THREE.Cache.clear();const e=o.systems["hubs-systems"].waypointSystem;e.releaseAnyOccupiedWaypoints(),r.addEventListener("model-loaded",()=>{r.addEventListener("model-loaded",()=>{r.removeEventListener("model-error",a),Jh(r),o.is("entered")&&e.moveToSpawnPoint();const t=document.getElementById("viewing-camera").components.fader;setTimeout(()=>t.fadeIn(),2e3)},{once:!0}),r.setAttribute("gltf-model-plus",{src:i})},{once:!0}),o.is("entered")||r.addEventListener("model-error",a,{once:!0}),r.setAttribute("gltf-model-plus",{src:l.a})}})).apply(this,arguments)}function M_(){return(M_=l_(function*(e,t){const i=()=>{};for(e.renderer={setAnimationLoop:i,render:i};!NAF.connection.isConnected();)yield Object(u.a)();t.enterSceneWhenLoaded(new MediaStream,!1)})).apply(this,arguments)}document.addEventListener("DOMContentLoaded",l_(function*(){if(yield h_.initProfile(),document.querySelector(".a-canvas").classList.add("a-hidden"),ul(),!window.WebAssembly)return void S_({showWebAssemblyDialog:!0});if("iOS"===Object(d.detectOS)(navigator.userAgent)&&!navigator.mediaDevices)return void S_({showSafariDialog:!0});const e=n.a.feature("default_room_id"),t=p_.get("hub_id")||("/"===document.location.pathname&&e?e:document.location.pathname.substring(1).split("/")[0]);console.log(`Hub ID: ${t}`),e||n.a.feature("require_account_for_join")&&(h_.state.credentials&&h_.state.credentials.token||(document.location=`/?sign_in&sign_in_destination=hub&sign_in_destination_url=${encodeURIComponent(document.location.toString())}`));const i=new _u(t);if(navigator.serviceWorker)try{navigator.serviceWorker.register("/hub.service.js").then(()=>{navigator.serviceWorker.ready.then(e=>i.setRegistration(e)).catch(()=>i.setRegistrationFailed())}).catch(()=>i.setRegistrationFailed())}catch(e){i.setRegistrationFailed()}else i.setRegistrationFailed();const a=document.querySelector("a-scene");a.setAttribute("shadow",{enabled:"low"!==window.APP.quality}),a.querySelector("#batch-prep").setAttribute("media-image",{batch:!0,src:o.a,contentType:"image/png"});const s=()=>{const e=a.systems["hubs-systems"].physicsSystem;e.setDebug(y_||e.debug),function(){const e=AFRAME.scenes[0].renderer,t=e.context;e.state.texImage2D=function(e,i,n,a,s,o,r,l,c){try{void 0===r?t.texImage2D(e,i,n,a,s,o):t.texImage2D(e,i,n,a,s,o,r,l,c)}catch(e){console.error("THREE.WebGLState:",e)}},e.state.compressedTexImage2D=function(e,i,n,a,s,o,r,l,c,d){try{void 0===l?t.compressedTexImage2D(e,i,n,a,s,o,r):void 0===c?t.compressedTexImage2D(e,i,n,a,s,o,r,l):void 0===d?t.compressedTexImage2D(e,i,n,a,s,o,r,l,c):t.compressedTexImage2D(e,i,n,a,s,o,r,l,c,d)}catch(e){console.error("THREE.WebGLState:",e)}}}()};a.hasLoaded?s():a.addEventListener("loaded",s,{once:!0}),(yield Object(ye.e)(h_.state.profile.avatarId))||(yield h_.resetToRandomDefaultAvatar());const r=new Hh.a(h_),l=new $h(h_,t),c=yield jn(),g=new mu(l,r,c,E_),b=function(){var e=l_(function*(e,t,i,n){if(e())return t();const s=a.is("vr-mode")?"entry.return-to-vr":"dialog.close";var o;yield ni(!0,()=>S_({showSignInDialog:!1})),S_({showSignInDialog:!0,signInMessageId:`sign-in.${i}`,signInCompleteMessageId:`sign-in.${i}-complete`,signInContinueTextId:s,onContinueAfterSignIn:(o=l_(function*(){S_({showSignInDialog:!1});let i=null;if(e())try{yield t()}catch(e){i=e}else i=new Error("Predicate failed post sign-in");i&&n&&n(i),si()}),function(){return o.apply(this,arguments)})})});return function(t,i,n,a){return e.apply(this,arguments)}}();window.addEventListener("action_create_avatar",()=>{b(()=>l.signedIn,()=>Object(en.e)(E_,"overlay","avatar-editor"),"create-avatar")}),a.addEventListener("scene_media_selected",e=>{const t=e.detail;b(()=>l.can("update_hub"),()=>l.updateScene(t),"change-scene")}),a.addEventListener("action_media_tweet",function(){var e=l_(function*(e){let t=!1,i=!1;const n=()=>{i=!1,h_.clearOnLoadActions(),S_({showOAuthDialog:!1,oauthInfo:null})};yield ni(!0,()=>{t&&E_.goBack(),i&&n()}),b(()=>l.signedIn,l_(function*(){const a={};if(Object.assign(a,e.detail),delete a.el,l.can("tweet"))t=!0,Object(en.e)(E_,"modal","tweet",a);else{e.detail.el&&e.detail.el.setAttribute("pinnable","pinned",!0);const t=yield l.getTwitterOAuthURL();i=!0,h_.enqueueOnLoadAction("emit_scene_event",{event:"action_media_tweet",detail:a}),S_({showOAuthDialog:!0,oauthInfo:[{type:"twitter",url:t}],onCloseOAuthDialog:()=>n()})}}),"tweet")});return function(t){return e.apply(this,arguments)}}()),S_({performConditionalSignIn:b,embed:f_,showPreload:f_}),g.performConditionalSignIn=b,g.init();const y=new Yh.a(h_);window.APP.scene=a,window.APP.hubChannel=l,window.dispatchEvent(new CustomEvent("hub_channel_ready"));const _=()=>!(!a.is("vr-mode")||a.is("vr-entered")||g_)&&(console.log("Pre-emptively exiting VR mode."),a.exitVR(),!0);a.addEventListener("enter-vr",()=>{if(_())return!0;g_&&S_({hide:!0}),document.body.classList.add("vr-mode"),(m_||g_)&&c.cardboard===On.yes||document.body.classList.add("vr-mode-stretch")}),_(),window.addEventListener("vrdisplaypresentchange",()=>{if(a.is("vr-entered"))return;if(a.is("vr-mode"))return;const e=AFRAME.utils.device.getVRDisplay();e&&e.isPresenting&&(a.is("vr-mode")||(console.warn("Hit A-Frame bug where VR display is presenting but A-Frame has not entered VR mode."),a.enterVR()))},{once:!0}),a.addEventListener("exit-vr",()=>{document.body.classList.remove("vr-mode"),document.body.classList.remove("vr-mode-stretch"),S_({hide:!1}),/OculusBrowser/i.test(window.navigator.userAgent)&&document.querySelectorAll("[media-video]").forEach(e=>{const t=e.components["media-video"];t&&(t._ignorePauseStateChanges=!0,setTimeout(()=>{const e=t.video;e&&e.paused&&!t.data.videoPaused&&e.play(),t._ignorePauseStateChanges=!1},1e3))})}),s_(),S_({authChannel:r,hubChannel:l,linkChannel:y,subscriptions:i,enterScene:g.enterScene,exitScene:e=>{g.exitScene(),e&&S_({roomUnavailableReason:e})},initialIsSubscribed:i.isSubscribed(),activeTips:a.systems.tips.activeTips}),a.addEventListener("action_focus_chat",()=>{const e=document.querySelector(".chat-focus-target");e&&e.focus()}),a.addEventListener("tips_changed",e=>{S_({activeTips:e.detail})}),a.addEventListener("leave_room_requested",()=>{g.exitScene("left"),S_({roomUnavailableReason:"left"})}),a.addEventListener("camera_toggled",()=>S_({})),a.addEventListener("camera_removed",()=>S_({})),a.addEventListener("hub_closed",()=>{a.exitVR(),g.exitScene("closed"),S_({roomUnavailableReason:"closed"})}),a.addEventListener("action_camera_recording_started",()=>l.beginRecording()),a.addEventListener("action_camera_recording_ended",()=>l.endRecording());const w="undefined"==typeof RTCDataChannelEvent?"no_data_channels":null;if(w)return S_({platformUnsupportedReason:w}),void g.exitScene();if(p_.get("required_version")&&{NODE_ENV:"production",SHORTLINK_DOMAIN:"hub.link",RETICULUM_SERVER:"dev.reticulum.io",THUMBNAIL_SERVER:"nearspark-dev.reticulum.io",CORS_PROXY_SERVER:"cors-proxy-dev.reticulum.io",NON_CORS_PROXY_DOMAINS:"hubs.local,dev.reticulum.io",BASE_ASSETS_PATH:"/custom-hubs-template/"}.BUILD_VERSION){const e={NODE_ENV:"production",SHORTLINK_DOMAIN:"hub.link",RETICULUM_SERVER:"dev.reticulum.io",THUMBNAIL_SERVER:"nearspark-dev.reticulum.io",CORS_PROXY_SERVER:"cors-proxy-dev.reticulum.io",NON_CORS_PROXY_DOMAINS:"hubs.local,dev.reticulum.io",BASE_ASSETS_PATH:"/custom-hubs-template/"}.BUILD_VERSION.split(" ",1)[0];if(p_.get("required_version")!==e)return S_({roomUnavailableReason:"version_mismatch"}),setTimeout(()=>document.location.reload(),5e3),void g.exitScene()}if(Object(h.i)().then(e=>{if(console.log(`Reticulum @ ${e.phx_host}: v${e.version} on ${e.pool}`),p_.get("required_ret_version")&&(p_.get("required_ret_version")!==e.version||p_.get("required_ret_pool")!==e.pool))return S_({roomUnavailableReason:"version_mismatch"}),setTimeout(()=>document.location.reload(),5e3),void g.exitScene()}),g_){if(S_({availableVREntryTypes:c,forcedVREntryType:"vr"}),/Oculus/.test(navigator.userAgent)){const e=yield navigator.getVRDisplays(),t=e.length&&e[0];AFRAME.utils.device.getVRDisplay=()=>t}}else{const e=c.cardboard!==On.no||c.generic!==On.no||c.daydream!==On.no;S_({availableVREntryTypes:c,forcedVREntryType:x_||(e?null:"2d")})}const E=document.querySelector("#environment-scene"),x=()=>{v_&&function(e,t){M_.apply(this,arguments)}(a,g),E.removeEventListener("model-loaded",x)};E.addEventListener("model-loaded",x),E.addEventListener("model-loaded",()=>{a.is("entered")||function(){const e=document.getElementById("viewing-camera"),t=document.getElementById("environment-scene").object3D.getObjectByName("scene-preview-camera");if(t)e.object3D.position.copy(t.position),e.object3D.rotation.copy(t.rotation),e.object3D.rotation.reorder("YXZ");else{const t=e.object3D.position;e.object3D.position.set(t.x,2.5,t.z)}e.object3D.matrixNeedsUpdate=!0,e.removeAttribute("scene-preview-camera"),e.setAttribute("scene-preview-camera","positionOnly: true; duration: 60")}(),S_({environmentSceneLoaded:!0}),a.emit("environment-scene-loaded"),document.querySelectorAll("a-entity[teleporter]").forEach(e=>e.components.teleporter.queryCollisionEntities());for(const e of E.children)Object(p.a)(e)});let S=!1;window.addEventListener("beforeunload",()=>S=!0);const C=yield Object(h.a)(y_);let k;C.onClose(e=>{1e3!==e.code||S||(g.exitScene(),S_({roomUnavailableReason:"disconnected"}))});let A=C.channel("ret",{hub_id:t});A.join().receive("ok",function(){var e=l_(function*(e){return i.setVapidPublicKey(e.vapid_public_key)});return function(t){return e.apply(this,arguments)}}()).receive("error",e=>{i.setVapidPublicKey(null),console.error(e)});const T=yield i.getCurrentEndpoint(),M=f.a.get("ret-oauth-flow-perms-token");M&&f.a.remove("ret-oauth-flow-perms-token");const L=e=>{const t={profile:h_.state.profile,push_subscription_endpoint:T,auth_token:null,perms_token:null,context:{mobile:m_||g_,embed:f_}};g_&&(t.context.hmd=!0),e&&(t.perms_token=e);const{token:i}=h_.state.credentials;return i&&(console.log(`Logged into account ${h_.credentialsAccountId}`),t.auth_token=i),t},R=function(){var e=l_(function*(e){console.log(`Reticulum deploy detected v${e.ret_version} on ${e.ret_pool}`),clearInterval(k),setTimeout(()=>{const t=function(){var t=l_(function*(){Object(h.k)();const t=yield Object(h.i)();if(t.pool===e.ret_pool&&t.version===e.ret_version){console.log("Reticulum reconnecting."),clearInterval(k);const e=A.socket,t=yield Object(h.a)(y_,e.params());A=yield Object(h.m)(A,t),yield l.migrateToSocket(t,L()),r.setSocket(t),y.setSocket(t),setTimeout(()=>{console.log("Reconnection complete. Disconnecting old reticulum socket."),e.teardown()},1e4)}});return function(){return t.apply(this,arguments)}}();k=setInterval(t,5e3),t()},Math.floor(15e3*Math.random()))});return function(t){return e.apply(this,arguments)}}();A.on("notice",function(){var e=l_(function*(e){"ret-deploy"===e.event&&(yield R(e))});return function(t){return e.apply(this,arguments)}}());const P=C.channel(`hub:${t}`,L(M)),D=[],O=e=>{e.key=Date.now().toString(),D.push(e),S_({presenceLogEntries:D}),"chat"===e.type&&a.is("loaded")&&a.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(v.c),setTimeout(()=>{e.expired=!0,S_({presenceLogEntries:D}),setTimeout(()=>{D.splice(D.indexOf(e),1),S_({presenceLogEntries:D})},5e3)},2e4)},H=new iu(a,g,l,O,S_,u_);document.getElementById("avatar-rig").messageDispatch=H;let j=!0,I=!1;const N={promise:null,resolve:null};l.setPhoenixChannel(P),P.join().receive("ok",function(){var e=l_(function*(e){C.params().session_id=e.session_id,C.params().session_token=e.session_token;const t=document.querySelector("#hud-presence-count");N.promise=new Promise(e=>{N.resolve=e}),j&&(h_.addEventListener("profilechanged",l.sendProfileUpdate.bind(l)),l.presence.onSync(()=>{const e=l.presence;S_({sessionId:C.params().session_id,presences:e.state});const i=Object.entries(e.state).length;t.setAttribute("text","value",i.toString());const n=Object.values(e.state).reduce((e,{metas:t})=>{const i=t[t.length-1];return e+("room"===i.presence||i.context&&i.context.entering?1:0)},0);i>1?a.addState("copresent"):a.removeState("copresent");const s=n>=24&&!l.canOrWillIfCreator("update_hub");I!==s&&S_({entryDisallowed:I=s}),e.__hadInitialSync=!0,N.resolve(),e.onJoin((e,t,i)=>{if(!l.presence.__hadInitialSync)return;const n=i.metas[i.metas.length-1];if(Object.entries(l.presence.state).length<=12)if(t){const i=e===C.params().session_id,a=t.metas[0];!i&&a.presence!==n.presence&&"room"===n.presence&&n.profile.displayName&&O({type:"entered",presence:n.presence,name:n.profile.displayName}),a.profile&&n.profile&&a.profile.displayName!==n.profile.displayName&&O({type:"display_name_changed",oldName:a.profile.displayName,newName:n.profile.displayName})}else if(1===i.metas.length){const e=i.metas[0];e.presence&&e.profile.displayName&&O({type:"join",presence:e.presence,name:e.profile.displayName})}a.emit("presence_updated",{sessionId:e,profile:n.profile,roles:n.roles,permissions:n.permissions,streaming:n.streaming,recording:n.recording})}),e.onLeave((e,t,i)=>{if(!l.presence.__hadInitialSync)return;if(t&&t.metas.length>0)return;if(Object.entries(l.presence.state).length>12)return;const n=i.metas[0];n.profile.displayName&&O({type:"leave",name:n.profile.displayName})})})),j=!1;const n=M||e.perms_token;l.setPermissionsFromToken(n),a.addEventListener("adapter-ready",function(){var t=l_(function*({detail:t}){const i=THREE.AudioContext.getContext(),n=i.createOscillator(),s=i.createGain();s.gain.setValueAtTime(.01,i.currentTime);const o=i.createMediaStreamDestination();n.connect(s),s.connect(o),n.start();const r=o.stream,c=r.getAudioTracks()[0];t.setClientId(C.params().session_id),t.setJoinToken(e.perms_token),l.addEventListener("permissions-refreshed",e=>t.setJoinToken(e.detail.permsToken)),a.addEventListener("didConnectToNetworkedScene",()=>{n.stop(),c.enabled=!1},{once:!0}),yield t.setLocalMediaStream(r)});return function(e){return t.apply(this,arguments)}}()),i.setHubChannel(l),i.setSubscribed(e.subscriptions.web_push),S_({hubIsBound:e.hub_requires_oauth,initialIsFavorited:e.subscriptions.favorites,initialIsSubscribed:i.isSubscribed()}),yield N.promise,function(e,t,i,n){const a=document.querySelector("a-scene");if(NAF.connection.isConnected())return a.is("entered")&&t.sendEnteredEvent(),void NAF.connection.entities.completeSync(null,!0);f_&&t.allowNAFTraffic(!1);const s=n.hubs[0];let o=s.embed_token;if(!o){const e=h_.state.embedTokens&&h_.state.embedTokens.find(e=>e.hubId===s.hub_id);e&&(o=e.embedToken)}console.log(`Janus host: ${s.host}:${s.port}`),S_({onSendMessage:i.dispatch,onLoaded:()=>h_.executeOnLoadActions(a),onMediaSearchResultEntrySelected:(e,t)=>a.emit("action_selected_media_result_entry",{entry:e,selectAction:t}),onMediaSearchCancelled:e=>a.emit("action_media_search_cancelled",e),onAvatarSaved:e=>a.emit("action_avatar_saved",e),embedToken:o}),a.addEventListener("action_selected_media_result_entry",e=>{const{entry:i,selectAction:n}=e.detail;"scene_listing"!==i.type&&"scene"!==i.type||"use"!==n||t.can("update_hub")&&t.updateScene(i.url)}),a.addEventListener("2d-interstitial-gesture-required",()=>{S_({showInterstitialPrompt:!0,onInterstitialPromptClicked:()=>{S_({showInterstitialPrompt:!1,onInterstitialPromptClicked:null}),a.emit("2d-interstitial-gesture-complete")}})});const r=document.querySelector("#objects-scene"),l=Object(h.h)(`/${s.hub_id}/objects.gltf`),c=document.createElement("a-entity");c.setAttribute("gltf-model-plus",{src:l,useCache:!1,inflate:!0}),v_||r.appendChild(c);const d=(p=l_(function*(){for(a.setAttribute("networked-scene",{room:s.hub_id,serverURL:`wss://${s.host}:${s.port}`,debug:!!y_});!a.components["networked-scene"]||!a.components["networked-scene"].data;)yield Object(u.a)();a.addEventListener("adapter-ready",({detail:e})=>{let i=null;e.setReconnectionListeners(()=>{i||(i=setInterval(l_(function*(){const i=NAF.connection.adapter.serverUrl,n=`wss://${yield t.getHost()}`;i!==n&&(console.log("Connecting to new Janus server "+n),a.setAttribute("networked-scene",{serverURL:n}),e.serverUrl=n)}),1e3))},()=>{clearInterval(i),i=null},null);const n=e=>(i,n,a)=>{const s={dataType:n,data:a};i&&(s.clientId=i);const o="open"===t.channel.socket.connectionState();(o||e)&&(o?t.channel.push("naf",s):t.channel.push("naf",AFRAME.utils.clone(s)))};e.reliableTransport=n(!0),e.unreliableTransport=n(!1)});const i=()=>{A_(s,e);const t=setTimeout(function(){console.error("Unknown error occurred while attempting to connect to networked scene."),S_({roomUnavailableReason:"connect_error"}),e.exitScene()},9e4);a.components["networked-scene"].connect().then(()=>{clearTimeout(t),a.emit("didConnectToNetworkedScene")}).catch(i=>{clearTimeout(t);const n=i.error&&i.error.msg.match(/\bfull\b/i);console.error(i),S_({roomUnavailableReason:n?"full":"connect_error"}),e.exitScene()})};C_(s),f_?S_({onPreloadLoadClicked:()=>{t.allowNAFTraffic(!0),S_({showPreload:!1}),i()}}):i()}),function(){return p.apply(this,arguments)});var p;v_?d():c.addEventListener("model-loaded",(m=l_(function*(e){e.target===c&&d()}),function(e){return m.apply(this,arguments)}));var m}(g,l,H,e)});return function(t){return e.apply(this,arguments)}}()).receive("error",e=>{"closed"===e.reason?(g.exitScene(),S_({roomUnavailableReason:"closed"})):"oauth_required"===e.reason?(g.exitScene(),S_({oauthInfo:e.oauth_info,showOAuthDialog:!0})):"join_denied"===e.reason&&(g.exitScene(),S_({roomUnavailableReason:"denied"})),console.error(e)}),P.on("naf",e=>{NAF.connection.adapter&&NAF.connection.adapter.onData(Object(m.b)(e),"phx-reliable")}),P.on("message",({session_id:e,type:t,body:i,from:n})=>{const s={name:(()=>{const t=l.presence.state[e];return n||(t?t.metas[0].profile.displayName:"Mystery user")})(),type:t,body:i,maySpawn:a.is("entered"),sessionId:e};a.is("vr-mode")&&function(e){Hl.apply(this,arguments)}(s),O(s)}),P.on("hub_refresh",({session_id:e,hubs:t,stale_fields:i})=>{const n=t[0],s=l.presence.state[e];if(C_(n),i.includes("scene")){document.getElementById("viewing-camera").components.fader.fadeOut().then(()=>{a.emit("reset_scene"),A_(n,g)}),O({type:"scene_changed",name:s.metas[0].profile.displayName,sceneName:n.scene?n.scene.name:"a custom URL"})}if(i.includes("member_permissions")&&l.fetchPermissions(),i.includes("name")){const e=document.title.split(" | ");e[0]=n.name,document.title=e.join(" | ");const t=E_.location.pathname.split("/")[1],{search:i,state:a}=E_.location,o=E_.location.pathname.replace(`/${t}`,`/${n.slug}`);E_.replace({pathname:o,search:i,state:a}),O({type:"hub_name_changed",name:s.metas[0].profile.displayName,hubName:n.name})}"deny"===n.entry_mode&&a.emit("hub_closed")}),P.on("permissions_updated",()=>l.fetchPermissions()),P.on("mute",({session_id:e})=>{e!==NAF.clientId||a.is("muted")||a.emit("action_mute")}),r.setSocket(C),y.setSocket(C)}))}]);
//# sourceMappingURL=hub-a5d1e801d30bb0dd261b.js.map